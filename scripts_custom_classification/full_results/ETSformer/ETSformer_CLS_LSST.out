Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6536474
	speed: 0.1121s/iter; left time: 1715.5266s
Epoch: 1 cost time: 15.556807279586792
Epoch: 1, Steps: 154 | Train Loss: 2.289 Vali Loss: 2.269 Vali Acc: 0.164 Test Loss: 2.269 Test Acc: 0.164
Validation loss decreased (inf --> -0.164211).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4165912
	speed: 0.3087s/iter; left time: 4675.9271s
Epoch: 2 cost time: 12.912010431289673
Epoch: 2, Steps: 154 | Train Loss: 2.184 Vali Loss: 2.314 Vali Acc: 0.325 Test Loss: 2.314 Test Acc: 0.325
Validation loss decreased (-0.164211 --> -0.324794).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7975767
	speed: 0.3245s/iter; left time: 4865.6243s
Epoch: 3 cost time: 12.83350396156311
Epoch: 3, Steps: 154 | Train Loss: 2.109 Vali Loss: 2.282 Vali Acc: 0.330 Test Loss: 2.282 Test Acc: 0.330
Validation loss decreased (-0.324794 --> -0.330066).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6541191
	speed: 0.3620s/iter; left time: 5371.5987s
Epoch: 4 cost time: 11.669670581817627
Epoch: 4, Steps: 154 | Train Loss: 2.059 Vali Loss: 2.421 Vali Acc: 0.328 Test Loss: 2.421 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8058840
	speed: 0.3738s/iter; left time: 5488.6747s
Epoch: 5 cost time: 14.47983431816101
Epoch: 5, Steps: 154 | Train Loss: 1.905 Vali Loss: 2.562 Vali Acc: 0.328 Test Loss: 2.562 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.5439181
	speed: 0.3712s/iter; left time: 5393.3167s
Epoch: 6 cost time: 12.504772663116455
Epoch: 6, Steps: 154 | Train Loss: 1.994 Vali Loss: 2.693 Vali Acc: 0.338 Test Loss: 2.693 Test Acc: 0.338
Validation loss decreased (-0.330066 --> -0.338173).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0827882
	speed: 0.3519s/iter; left time: 5059.6198s
Epoch: 7 cost time: 13.484856605529785
Epoch: 7, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.669 Vali Acc: 0.083 Test Loss: 2.669 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3027225
	speed: 0.3183s/iter; left time: 4527.3228s
Epoch: 8 cost time: 13.229001998901367
Epoch: 8, Steps: 154 | Train Loss: 1.856 Vali Loss: 2.853 Vali Acc: 0.118 Test Loss: 2.853 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.1915035
	speed: 0.2999s/iter; left time: 4219.1473s
Epoch: 9 cost time: 10.8605797290802
Epoch: 9, Steps: 154 | Train Loss: 1.895 Vali Loss: 3.547 Vali Acc: 0.060 Test Loss: 3.547 Test Acc: 0.060
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4073751
	speed: 0.3428s/iter; left time: 4770.6053s
Epoch: 10 cost time: 13.455589056015015
Epoch: 10, Steps: 154 | Train Loss: 1.782 Vali Loss: 3.327 Vali Acc: 0.056 Test Loss: 3.327 Test Acc: 0.056
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.4827821
	speed: 0.3558s/iter; left time: 4896.4557s
Epoch: 11 cost time: 12.832763433456421
Epoch: 11, Steps: 154 | Train Loss: 1.671 Vali Loss: 3.208 Vali Acc: 0.350 Test Loss: 3.208 Test Acc: 0.350
Validation loss decreased (-0.338173 --> -0.349927).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4024693
	speed: 0.3316s/iter; left time: 4511.9686s
Epoch: 12 cost time: 11.523597240447998
Epoch: 12, Steps: 154 | Train Loss: 1.755 Vali Loss: 3.491 Vali Acc: 0.114 Test Loss: 3.491 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1418127
	speed: 0.3574s/iter; left time: 4807.5766s
Epoch: 13 cost time: 14.21263837814331
Epoch: 13, Steps: 154 | Train Loss: 1.756 Vali Loss: 3.491 Vali Acc: 0.295 Test Loss: 3.491 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.0850881
	speed: 0.4243s/iter; left time: 5642.4036s
Epoch: 14 cost time: 16.691236972808838
Epoch: 14, Steps: 154 | Train Loss: 1.803 Vali Loss: 3.660 Vali Acc: 0.136 Test Loss: 3.660 Test Acc: 0.136
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.0489113
	speed: 0.3836s/iter; left time: 5041.9505s
Epoch: 15 cost time: 15.82893443107605
Epoch: 15, Steps: 154 | Train Loss: 1.726 Vali Loss: 3.539 Vali Acc: 0.361 Test Loss: 3.539 Test Acc: 0.361
Validation loss decreased (-0.349927 --> -0.360873).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.6113126
	speed: 0.4493s/iter; left time: 5836.9550s
Epoch: 16 cost time: 17.75518250465393
Epoch: 16, Steps: 154 | Train Loss: 1.844 Vali Loss: 4.492 Vali Acc: 0.061 Test Loss: 4.492 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.8410931
	speed: 0.4218s/iter; left time: 5414.9027s
Epoch: 17 cost time: 15.25503945350647
Epoch: 17, Steps: 154 | Train Loss: 1.587 Vali Loss: 4.333 Vali Acc: 0.063 Test Loss: 4.333 Test Acc: 0.063
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.3978962
	speed: 0.3774s/iter; left time: 4786.5193s
Epoch: 18 cost time: 15.060777187347412
Epoch: 18, Steps: 154 | Train Loss: 1.873 Vali Loss: 5.094 Vali Acc: 0.083 Test Loss: 5.094 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.6339549
	speed: 0.3453s/iter; left time: 4326.6850s
Epoch: 19 cost time: 10.831789493560791
Epoch: 19, Steps: 154 | Train Loss: 1.538 Vali Loss: 4.120 Vali Acc: 0.097 Test Loss: 4.120 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.0470190
	speed: 0.3451s/iter; left time: 4271.1119s
Epoch: 20 cost time: 15.922229290008545
Epoch: 20, Steps: 154 | Train Loss: 1.553 Vali Loss: 3.625 Vali Acc: 0.098 Test Loss: 3.625 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.3898512
	speed: 0.4117s/iter; left time: 5031.1400s
Epoch: 21 cost time: 17.376452922821045
Epoch: 21, Steps: 154 | Train Loss: 2.648 Vali Loss: 4.583 Vali Acc: 0.342 Test Loss: 4.583 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.2457304
	speed: 0.4636s/iter; left time: 5594.6151s
Epoch: 22 cost time: 18.29495334625244
Epoch: 22, Steps: 154 | Train Loss: 1.418 Vali Loss: 4.790 Vali Acc: 0.077 Test Loss: 4.790 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.1479359
	speed: 0.4377s/iter; left time: 5213.9867s
Epoch: 23 cost time: 15.032901287078857
Epoch: 23, Steps: 154 | Train Loss: 1.758 Vali Loss: 3.916 Vali Acc: 0.370 Test Loss: 3.916 Test Acc: 0.370
Validation loss decreased (-0.360873 --> -0.370196).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.2392944
	speed: 0.3866s/iter; left time: 4546.4172s
Epoch: 24 cost time: 15.263008117675781
Epoch: 24, Steps: 154 | Train Loss: 1.507 Vali Loss: 4.690 Vali Acc: 0.079 Test Loss: 4.690 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.2648394
	speed: 0.4146s/iter; left time: 4811.0354s
Epoch: 25 cost time: 14.583134412765503
Epoch: 25, Steps: 154 | Train Loss: 1.574 Vali Loss: 4.194 Vali Acc: 0.368 Test Loss: 4.194 Test Acc: 0.368
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.8447341
	speed: 0.4227s/iter; left time: 4840.4780s
Epoch: 26 cost time: 17.71978187561035
Epoch: 26, Steps: 154 | Train Loss: 1.446 Vali Loss: 4.942 Vali Acc: 0.101 Test Loss: 4.942 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.3102783
	speed: 0.4117s/iter; left time: 4651.1462s
Epoch: 27 cost time: 14.458188772201538
Epoch: 27, Steps: 154 | Train Loss: 1.496 Vali Loss: 4.502 Vali Acc: 0.216 Test Loss: 4.502 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.2743745
	speed: 0.3708s/iter; left time: 4131.6925s
Epoch: 28 cost time: 16.01937770843506
Epoch: 28, Steps: 154 | Train Loss: 1.513 Vali Loss: 4.549 Vali Acc: 0.191 Test Loss: 4.549 Test Acc: 0.191
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.7550352
	speed: 0.4271s/iter; left time: 4693.5343s
Epoch: 29 cost time: 15.518999099731445
Epoch: 29, Steps: 154 | Train Loss: 1.320 Vali Loss: 4.435 Vali Acc: 0.104 Test Loss: 4.435 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 1.1243163
	speed: 0.4059s/iter; left time: 4397.7233s
Epoch: 30 cost time: 16.524113655090332
Epoch: 30, Steps: 154 | Train Loss: 1.337 Vali Loss: 5.176 Vali Acc: 0.095 Test Loss: 5.176 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 1.5639133
	speed: 0.4156s/iter; left time: 4438.5319s
Epoch: 31 cost time: 16.558740615844727
Epoch: 31, Steps: 154 | Train Loss: 1.308 Vali Loss: 5.169 Vali Acc: 0.098 Test Loss: 5.169 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.6990693
	speed: 0.4265s/iter; left time: 4489.9862s
Epoch: 32 cost time: 16.748526334762573
Epoch: 32, Steps: 154 | Train Loss: 1.307 Vali Loss: 5.816 Vali Acc: 0.103 Test Loss: 5.816 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 1.1660013
	speed: 0.4275s/iter; left time: 4434.5309s
Epoch: 33 cost time: 19.043314218521118
Epoch: 33, Steps: 154 | Train Loss: 1.426 Vali Loss: 4.523 Vali Acc: 0.345 Test Loss: 4.523 Test Acc: 0.345
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.370235198702352
model parameter : 5532766
model size : 30.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6527551
	speed: 0.1390s/iter; left time: 2126.8113s
Epoch: 1 cost time: 18.679572343826294
Epoch: 1, Steps: 154 | Train Loss: 2.262 Vali Loss: 2.248 Vali Acc: 0.163 Test Loss: 2.248 Test Acc: 0.163
Validation loss decreased (inf --> -0.162995).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5251803
	speed: 0.3908s/iter; left time: 5918.7182s
Epoch: 2 cost time: 16.6874041557312
Epoch: 2, Steps: 154 | Train Loss: 2.141 Vali Loss: 2.297 Vali Acc: 0.328 Test Loss: 2.297 Test Acc: 0.328
Validation loss decreased (-0.162995 --> -0.327633).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7886260
	speed: 0.4018s/iter; left time: 6024.1401s
Epoch: 3 cost time: 15.197763442993164
Epoch: 3, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.289 Vali Acc: 0.335 Test Loss: 2.289 Test Acc: 0.335
Validation loss decreased (-0.327633 --> -0.334933).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6700678
	speed: 0.3934s/iter; left time: 5837.0450s
Epoch: 4 cost time: 16.011383771896362
Epoch: 4, Steps: 154 | Train Loss: 1.988 Vali Loss: 2.459 Vali Acc: 0.336 Test Loss: 2.459 Test Acc: 0.336
Validation loss decreased (-0.334933 --> -0.335742).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3081317
	speed: 0.4064s/iter; left time: 5967.4610s
Epoch: 5 cost time: 16.539357900619507
Epoch: 5, Steps: 154 | Train Loss: 1.860 Vali Loss: 2.490 Vali Acc: 0.337 Test Loss: 2.490 Test Acc: 0.337
Validation loss decreased (-0.335742 --> -0.336958).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6448514
	speed: 0.3769s/iter; left time: 5476.1826s
Epoch: 6 cost time: 13.475245475769043
Epoch: 6, Steps: 154 | Train Loss: 1.884 Vali Loss: 2.753 Vali Acc: 0.341 Test Loss: 2.753 Test Acc: 0.341
Validation loss decreased (-0.336958 --> -0.340605).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0251720
	speed: 0.4065s/iter; left time: 5844.6626s
Epoch: 7 cost time: 16.80892562866211
Epoch: 7, Steps: 154 | Train Loss: 1.826 Vali Loss: 2.831 Vali Acc: 0.081 Test Loss: 2.831 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3567123
	speed: 0.4334s/iter; left time: 6164.7087s
Epoch: 8 cost time: 17.551429271697998
Epoch: 8, Steps: 154 | Train Loss: 1.808 Vali Loss: 2.837 Vali Acc: 0.087 Test Loss: 2.837 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.1728888
	speed: 0.4238s/iter; left time: 5962.0157s
Epoch: 9 cost time: 17.254892110824585
Epoch: 9, Steps: 154 | Train Loss: 1.807 Vali Loss: 3.061 Vali Acc: 0.095 Test Loss: 3.061 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4771119
	speed: 0.4354s/iter; left time: 6057.9819s
Epoch: 10 cost time: 16.07758092880249
Epoch: 10, Steps: 154 | Train Loss: 1.832 Vali Loss: 3.059 Vali Acc: 0.127 Test Loss: 3.059 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.8184872
	speed: 0.4174s/iter; left time: 5743.9531s
Epoch: 11 cost time: 15.894543409347534
Epoch: 11, Steps: 154 | Train Loss: 1.757 Vali Loss: 3.009 Vali Acc: 0.349 Test Loss: 3.009 Test Acc: 0.349
Validation loss decreased (-0.340605 --> -0.348713).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4603695
	speed: 0.4563s/iter; left time: 6209.4445s
Epoch: 12 cost time: 18.322777032852173
Epoch: 12, Steps: 154 | Train Loss: 1.853 Vali Loss: 3.075 Vali Acc: 0.088 Test Loss: 3.075 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1312006
	speed: 0.4575s/iter; left time: 6154.7853s
Epoch: 13 cost time: 16.12641215324402
Epoch: 13, Steps: 154 | Train Loss: 1.637 Vali Loss: 3.057 Vali Acc: 0.354 Test Loss: 3.057 Test Acc: 0.354
Validation loss decreased (-0.348713 --> -0.353579).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.1610435
	speed: 0.5199s/iter; left time: 6914.5533s
Epoch: 14 cost time: 20.668988704681396
Epoch: 14, Steps: 154 | Train Loss: 1.757 Vali Loss: 3.291 Vali Acc: 0.359 Test Loss: 3.291 Test Acc: 0.359
Validation loss decreased (-0.353579 --> -0.358848).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.5842862
	speed: 0.5273s/iter; left time: 6931.5452s
Epoch: 15 cost time: 21.680439472198486
Epoch: 15, Steps: 154 | Train Loss: 1.689 Vali Loss: 3.353 Vali Acc: 0.221 Test Loss: 3.353 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.8045701
	speed: 0.5269s/iter; left time: 6845.1017s
Epoch: 16 cost time: 22.055334329605103
Epoch: 16, Steps: 154 | Train Loss: 1.826 Vali Loss: 3.535 Vali Acc: 0.072 Test Loss: 3.535 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.4941837
	speed: 0.5428s/iter; left time: 6967.3131s
Epoch: 17 cost time: 23.603137016296387
Epoch: 17, Steps: 154 | Train Loss: 1.542 Vali Loss: 3.581 Vali Acc: 0.352 Test Loss: 3.581 Test Acc: 0.352
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.2825682
	speed: 0.5573s/iter; left time: 7068.4652s
Epoch: 18 cost time: 22.031524181365967
Epoch: 18, Steps: 154 | Train Loss: 1.622 Vali Loss: 4.171 Vali Acc: 0.086 Test Loss: 4.171 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.7218124
	speed: 0.5815s/iter; left time: 7285.7054s
Epoch: 19 cost time: 22.438841342926025
Epoch: 19, Steps: 154 | Train Loss: 1.791 Vali Loss: 3.445 Vali Acc: 0.352 Test Loss: 3.445 Test Acc: 0.352
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.0524049
	speed: 0.5429s/iter; left time: 6718.1520s
Epoch: 20 cost time: 21.456034183502197
Epoch: 20, Steps: 154 | Train Loss: 1.495 Vali Loss: 3.979 Vali Acc: 0.086 Test Loss: 3.979 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.1028442
	speed: 0.5317s/iter; left time: 6497.6749s
Epoch: 21 cost time: 21.411175966262817
Epoch: 21, Steps: 154 | Train Loss: 1.814 Vali Loss: 4.524 Vali Acc: 0.089 Test Loss: 4.524 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.4696264
	speed: 0.5592s/iter; left time: 6747.9839s
Epoch: 22 cost time: 23.154256582260132
Epoch: 22, Steps: 154 | Train Loss: 1.596 Vali Loss: 4.084 Vali Acc: 0.360 Test Loss: 4.084 Test Acc: 0.360
Validation loss decreased (-0.358848 --> -0.360056).  Saving model ...
	iters: 100, epoch: 23 | loss: 4.7299795
	speed: 0.5705s/iter; left time: 6795.9788s
Epoch: 23 cost time: 20.277743101119995
Epoch: 23, Steps: 154 | Train Loss: 1.432 Vali Loss: 4.612 Vali Acc: 0.170 Test Loss: 4.612 Test Acc: 0.170
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.0258025
	speed: 0.5380s/iter; left time: 6326.3244s
Epoch: 24 cost time: 20.047351121902466
Epoch: 24, Steps: 154 | Train Loss: 1.787 Vali Loss: 4.641 Vali Acc: 0.086 Test Loss: 4.641 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.0680550
	speed: 0.5322s/iter; left time: 6175.6770s
Epoch: 25 cost time: 23.984747886657715
Epoch: 25, Steps: 154 | Train Loss: 1.440 Vali Loss: 4.478 Vali Acc: 0.182 Test Loss: 4.478 Test Acc: 0.182
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.6531206
	speed: 0.5646s/iter; left time: 6464.9711s
Epoch: 26 cost time: 20.40432071685791
Epoch: 26, Steps: 154 | Train Loss: 1.378 Vali Loss: 4.494 Vali Acc: 0.369 Test Loss: 4.494 Test Acc: 0.369
Validation loss decreased (-0.360056 --> -0.369379).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.4934187
	speed: 0.5483s/iter; left time: 6193.7133s
Epoch: 27 cost time: 23.443170309066772
Epoch: 27, Steps: 154 | Train Loss: 1.313 Vali Loss: 4.427 Vali Acc: 0.105 Test Loss: 4.427 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.2048273
	speed: 0.5432s/iter; left time: 6052.5959s
Epoch: 28 cost time: 21.184870958328247
Epoch: 28, Steps: 154 | Train Loss: 1.341 Vali Loss: 4.390 Vali Acc: 0.367 Test Loss: 4.390 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.1346799
	speed: 0.5603s/iter; left time: 6156.9903s
Epoch: 29 cost time: 19.50260877609253
Epoch: 29, Steps: 154 | Train Loss: 1.289 Vali Loss: 4.022 Vali Acc: 0.379 Test Loss: 4.022 Test Acc: 0.379
Validation loss decreased (-0.369379 --> -0.378711).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.8863700
	speed: 0.5567s/iter; left time: 6031.8076s
Epoch: 30 cost time: 22.124858617782593
Epoch: 30, Steps: 154 | Train Loss: 1.477 Vali Loss: 4.925 Vali Acc: 0.376 Test Loss: 4.925 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.0911690
	speed: 0.5318s/iter; left time: 5680.0209s
Epoch: 31 cost time: 20.235145092010498
Epoch: 31, Steps: 154 | Train Loss: 1.614 Vali Loss: 5.667 Vali Acc: 0.101 Test Loss: 5.667 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 2.4145107
	speed: 0.5477s/iter; left time: 5765.2122s
Epoch: 32 cost time: 21.11717438697815
Epoch: 32, Steps: 154 | Train Loss: 1.212 Vali Loss: 5.460 Vali Acc: 0.097 Test Loss: 5.460 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 1.1385943
	speed: 0.5141s/iter; left time: 5332.5898s
Epoch: 33 cost time: 20.032075881958008
Epoch: 33, Steps: 154 | Train Loss: 1.568 Vali Loss: 6.289 Vali Acc: 0.375 Test Loss: 6.289 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 1.0620021
	speed: 0.5824s/iter; left time: 5951.8557s
Epoch: 34 cost time: 22.958710193634033
Epoch: 34, Steps: 154 | Train Loss: 1.424 Vali Loss: 4.537 Vali Acc: 0.383 Test Loss: 4.537 Test Acc: 0.383
Validation loss decreased (-0.378711 --> -0.383166).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.8921008
	speed: 0.5873s/iter; left time: 5910.9011s
Epoch: 35 cost time: 24.09182333946228
Epoch: 35, Steps: 154 | Train Loss: 1.320 Vali Loss: 5.489 Vali Acc: 0.357 Test Loss: 5.489 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 1.4939607
	speed: 0.5604s/iter; left time: 5554.1474s
Epoch: 36 cost time: 20.185015439987183
Epoch: 36, Steps: 154 | Train Loss: 1.180 Vali Loss: 5.247 Vali Acc: 0.113 Test Loss: 5.247 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.8580627
	speed: 0.5433s/iter; left time: 5300.9468s
Epoch: 37 cost time: 22.719117164611816
Epoch: 37, Steps: 154 | Train Loss: 1.155 Vali Loss: 5.787 Vali Acc: 0.300 Test Loss: 5.787 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.8953966
	speed: 0.5024s/iter; left time: 4824.4616s
Epoch: 38 cost time: 20.537776231765747
Epoch: 38, Steps: 154 | Train Loss: 1.085 Vali Loss: 5.554 Vali Acc: 0.375 Test Loss: 5.554 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.7715232
	speed: 0.5631s/iter; left time: 5320.4981s
Epoch: 39 cost time: 21.3005850315094
Epoch: 39, Steps: 154 | Train Loss: 1.083 Vali Loss: 6.872 Vali Acc: 0.092 Test Loss: 6.872 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.7263051
	speed: 0.5646s/iter; left time: 5248.1030s
Epoch: 40 cost time: 21.598412036895752
Epoch: 40, Steps: 154 | Train Loss: 1.507 Vali Loss: 5.816 Vali Acc: 0.382 Test Loss: 5.816 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 1.2802535
	speed: 0.5441s/iter; left time: 4973.4449s
Epoch: 41 cost time: 24.11667227745056
Epoch: 41, Steps: 154 | Train Loss: 1.295 Vali Loss: 5.586 Vali Acc: 0.264 Test Loss: 5.586 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.4463823
	speed: 0.5508s/iter; left time: 4949.6051s
Epoch: 42 cost time: 21.00654125213623
Epoch: 42, Steps: 154 | Train Loss: 1.084 Vali Loss: 5.649 Vali Acc: 0.127 Test Loss: 5.649 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 1.6777745
	speed: 0.4901s/iter; left time: 4329.1635s
Epoch: 43 cost time: 17.7708420753479
Epoch: 43, Steps: 154 | Train Loss: 1.182 Vali Loss: 6.350 Vali Acc: 0.371 Test Loss: 6.350 Test Acc: 0.371
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.9086266
	speed: 0.4865s/iter; left time: 4222.4179s
Epoch: 44 cost time: 20.902667999267578
Epoch: 44, Steps: 154 | Train Loss: 1.115 Vali Loss: 6.364 Vali Acc: 0.233 Test Loss: 6.364 Test Acc: 0.233
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38321167883211676
model parameter : 5532766
model size : 30.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6816123
	speed: 0.1640s/iter; left time: 2508.8906s
Epoch: 1 cost time: 24.005113124847412
Epoch: 1, Steps: 154 | Train Loss: 2.241 Vali Loss: 2.279 Vali Acc: 0.163 Test Loss: 2.279 Test Acc: 0.163
Validation loss decreased (inf --> -0.162589).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4177649
	speed: 0.5253s/iter; left time: 7956.4281s
Epoch: 2 cost time: 18.45687198638916
Epoch: 2, Steps: 154 | Train Loss: 2.121 Vali Loss: 2.236 Vali Acc: 0.328 Test Loss: 2.236 Test Acc: 0.328
Validation loss decreased (-0.162589 --> -0.327634).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8536614
	speed: 0.5267s/iter; left time: 7897.0952s
Epoch: 3 cost time: 20.96123695373535
Epoch: 3, Steps: 154 | Train Loss: 2.012 Vali Loss: 2.280 Vali Acc: 0.350 Test Loss: 2.280 Test Acc: 0.350
Validation loss decreased (-0.327634 --> -0.349531).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6383699
	speed: 0.5481s/iter; left time: 8132.8449s
Epoch: 4 cost time: 21.67210841178894
Epoch: 4, Steps: 154 | Train Loss: 1.900 Vali Loss: 2.619 Vali Acc: 0.338 Test Loss: 2.619 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.1018705
	speed: 0.5386s/iter; left time: 7908.8292s
Epoch: 5 cost time: 20.018977880477905
Epoch: 5, Steps: 154 | Train Loss: 1.843 Vali Loss: 2.774 Vali Acc: 0.234 Test Loss: 2.774 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.7654839
	speed: 0.5479s/iter; left time: 7962.0091s
Epoch: 6 cost time: 21.901292085647583
Epoch: 6, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.825 Vali Acc: 0.342 Test Loss: 2.825 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.9342971
	speed: 0.5162s/iter; left time: 7420.9022s
Epoch: 7 cost time: 21.23891592025757
Epoch: 7, Steps: 154 | Train Loss: 1.841 Vali Loss: 2.594 Vali Acc: 0.101 Test Loss: 2.594 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.3183030
	speed: 0.5497s/iter; left time: 7818.0038s
Epoch: 8 cost time: 21.018682718276978
Epoch: 8, Steps: 154 | Train Loss: 1.826 Vali Loss: 2.954 Vali Acc: 0.146 Test Loss: 2.954 Test Acc: 0.146
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.2559260
	speed: 0.5821s/iter; left time: 8189.3427s
Epoch: 9 cost time: 23.861206531524658
Epoch: 9, Steps: 154 | Train Loss: 1.683 Vali Loss: 2.942 Vali Acc: 0.357 Test Loss: 2.942 Test Acc: 0.357
Validation loss decreased (-0.349531 --> -0.356824).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3475198
	speed: 0.5457s/iter; left time: 7593.7054s
Epoch: 10 cost time: 18.72880530357361
Epoch: 10, Steps: 154 | Train Loss: 1.741 Vali Loss: 2.962 Vali Acc: 0.357 Test Loss: 2.962 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.6091775
	speed: 0.5281s/iter; left time: 7267.7005s
Epoch: 11 cost time: 19.929877519607544
Epoch: 11, Steps: 154 | Train Loss: 1.756 Vali Loss: 3.236 Vali Acc: 0.082 Test Loss: 3.236 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.5387880
	speed: 0.4658s/iter; left time: 6337.9585s
Epoch: 12 cost time: 19.02311396598816
Epoch: 12, Steps: 154 | Train Loss: 1.710 Vali Loss: 3.286 Vali Acc: 0.096 Test Loss: 3.286 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.3745987
	speed: 0.5017s/iter; left time: 6749.7457s
Epoch: 13 cost time: 20.24212956428528
Epoch: 13, Steps: 154 | Train Loss: 1.570 Vali Loss: 3.439 Vali Acc: 0.243 Test Loss: 3.439 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.7818332
	speed: 0.5429s/iter; left time: 7219.9344s
Epoch: 14 cost time: 21.99965810775757
Epoch: 14, Steps: 154 | Train Loss: 1.739 Vali Loss: 3.764 Vali Acc: 0.204 Test Loss: 3.764 Test Acc: 0.204
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.8403634
	speed: 0.5271s/iter; left time: 6928.6318s
Epoch: 15 cost time: 20.34768295288086
Epoch: 15, Steps: 154 | Train Loss: 1.583 Vali Loss: 3.540 Vali Acc: 0.103 Test Loss: 3.540 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.6883106
	speed: 0.5030s/iter; left time: 6534.0291s
Epoch: 16 cost time: 18.39833950996399
Epoch: 16, Steps: 154 | Train Loss: 1.504 Vali Loss: 3.970 Vali Acc: 0.085 Test Loss: 3.970 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.3064065
	speed: 0.4688s/iter; left time: 6018.1396s
Epoch: 17 cost time: 18.232869625091553
Epoch: 17, Steps: 154 | Train Loss: 1.561 Vali Loss: 3.671 Vali Acc: 0.367 Test Loss: 3.671 Test Acc: 0.367
Validation loss decreased (-0.356824 --> -0.366549).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.0676535
	speed: 0.4934s/iter; left time: 6257.9379s
Epoch: 18 cost time: 18.006142377853394
Epoch: 18, Steps: 154 | Train Loss: 1.533 Vali Loss: 4.291 Vali Acc: 0.105 Test Loss: 4.291 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.9116753
	speed: 0.5021s/iter; left time: 6291.1964s
Epoch: 19 cost time: 19.888636589050293
Epoch: 19, Steps: 154 | Train Loss: 1.953 Vali Loss: 4.107 Vali Acc: 0.376 Test Loss: 4.107 Test Acc: 0.376
Validation loss decreased (-0.366549 --> -0.376277).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.4156843
	speed: 0.5394s/iter; left time: 6675.6650s
Epoch: 20 cost time: 20.037460565567017
Epoch: 20, Steps: 154 | Train Loss: 1.742 Vali Loss: 3.987 Vali Acc: 0.120 Test Loss: 3.987 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.8216058
	speed: 0.5154s/iter; left time: 6299.3111s
Epoch: 21 cost time: 18.391786336898804
Epoch: 21, Steps: 154 | Train Loss: 1.722 Vali Loss: 5.093 Vali Acc: 0.104 Test Loss: 5.093 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.0252407
	speed: 0.4853s/iter; left time: 5855.5377s
Epoch: 22 cost time: 20.39631676673889
Epoch: 22, Steps: 154 | Train Loss: 1.427 Vali Loss: 3.679 Vali Acc: 0.298 Test Loss: 3.679 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.8771492
	speed: 0.5029s/iter; left time: 5991.3216s
Epoch: 23 cost time: 19.697282552719116
Epoch: 23, Steps: 154 | Train Loss: 1.368 Vali Loss: 4.819 Vali Acc: 0.114 Test Loss: 4.819 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.1092386
	speed: 0.5034s/iter; left time: 5919.7175s
Epoch: 24 cost time: 19.4591281414032
Epoch: 24, Steps: 154 | Train Loss: 1.461 Vali Loss: 4.710 Vali Acc: 0.094 Test Loss: 4.710 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.9109773
	speed: 0.4826s/iter; left time: 5600.9975s
Epoch: 25 cost time: 20.417039155960083
Epoch: 25, Steps: 154 | Train Loss: 1.398 Vali Loss: 4.379 Vali Acc: 0.382 Test Loss: 4.379 Test Acc: 0.382
Validation loss decreased (-0.376277 --> -0.381546).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.7291459
	speed: 0.5212s/iter; left time: 5967.8744s
Epoch: 26 cost time: 18.491403818130493
Epoch: 26, Steps: 154 | Train Loss: 1.309 Vali Loss: 4.727 Vali Acc: 0.370 Test Loss: 4.727 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.7552094
	speed: 0.4820s/iter; left time: 5444.6172s
Epoch: 27 cost time: 17.674167156219482
Epoch: 27, Steps: 154 | Train Loss: 1.207 Vali Loss: 4.485 Vali Acc: 0.390 Test Loss: 4.485 Test Acc: 0.390
Validation loss decreased (-0.381546 --> -0.389655).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.9426300
	speed: 0.4906s/iter; left time: 5466.9045s
Epoch: 28 cost time: 18.27893900871277
Epoch: 28, Steps: 154 | Train Loss: 1.223 Vali Loss: 4.326 Vali Acc: 0.384 Test Loss: 4.326 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.2998587
	speed: 0.4982s/iter; left time: 5475.0902s
Epoch: 29 cost time: 18.94181728363037
Epoch: 29, Steps: 154 | Train Loss: 1.362 Vali Loss: 3.905 Vali Acc: 0.324 Test Loss: 3.905 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.7172042
	speed: 0.4993s/iter; left time: 5410.4308s
Epoch: 30 cost time: 21.277313947677612
Epoch: 30, Steps: 154 | Train Loss: 1.263 Vali Loss: 5.642 Vali Acc: 0.196 Test Loss: 5.642 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 4.4578156
	speed: 0.5090s/iter; left time: 5436.3171s
Epoch: 31 cost time: 17.453972339630127
Epoch: 31, Steps: 154 | Train Loss: 1.392 Vali Loss: 5.925 Vali Acc: 0.103 Test Loss: 5.925 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.4395729
	speed: 0.4902s/iter; left time: 5160.7325s
Epoch: 32 cost time: 20.315114974975586
Epoch: 32, Steps: 154 | Train Loss: 1.235 Vali Loss: 5.610 Vali Acc: 0.121 Test Loss: 5.610 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 1.2928314
	speed: 0.4941s/iter; left time: 5124.9048s
Epoch: 33 cost time: 18.82650351524353
Epoch: 33, Steps: 154 | Train Loss: 2.618 Vali Loss: 5.176 Vali Acc: 0.390 Test Loss: 5.176 Test Acc: 0.390
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.9490273
	speed: 0.4851s/iter; left time: 4956.9824s
Epoch: 34 cost time: 17.63002634048462
Epoch: 34, Steps: 154 | Train Loss: 1.364 Vali Loss: 5.691 Vali Acc: 0.311 Test Loss: 5.691 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 1.0205690
	speed: 0.4833s/iter; left time: 4864.2521s
Epoch: 35 cost time: 19.38217520713806
Epoch: 35, Steps: 154 | Train Loss: 1.016 Vali Loss: 5.796 Vali Acc: 0.105 Test Loss: 5.796 Test Acc: 0.105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 1.3814451
	speed: 0.4569s/iter; left time: 4528.0011s
Epoch: 36 cost time: 17.121773719787598
Epoch: 36, Steps: 154 | Train Loss: 1.360 Vali Loss: 5.577 Vali Acc: 0.242 Test Loss: 5.577 Test Acc: 0.242
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 1.0917997
	speed: 0.4938s/iter; left time: 4818.2862s
Epoch: 37 cost time: 16.57175064086914
Epoch: 37, Steps: 154 | Train Loss: 1.109 Vali Loss: 6.749 Vali Acc: 0.139 Test Loss: 6.749 Test Acc: 0.139
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3896999188969992
model parameter : 5532766
model size : 30.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6280469
	speed: 0.1403s/iter; left time: 2146.6787s
Epoch: 1 cost time: 20.404515027999878
Epoch: 1, Steps: 154 | Train Loss: 2.210 Vali Loss: 2.282 Vali Acc: 0.166 Test Loss: 2.282 Test Acc: 0.166
Validation loss decreased (inf --> -0.166238).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2530267
	speed: 0.4832s/iter; left time: 7318.5460s
Epoch: 2 cost time: 19.57150411605835
Epoch: 2, Steps: 154 | Train Loss: 2.045 Vali Loss: 2.192 Vali Acc: 0.335 Test Loss: 2.192 Test Acc: 0.335
Validation loss decreased (-0.166238 --> -0.334528).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8364176
	speed: 0.4596s/iter; left time: 6891.2849s
Epoch: 3 cost time: 16.182989358901978
Epoch: 3, Steps: 154 | Train Loss: 1.990 Vali Loss: 2.364 Vali Acc: 0.348 Test Loss: 2.364 Test Acc: 0.348
Validation loss decreased (-0.334528 --> -0.347503).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5110860
	speed: 0.4365s/iter; left time: 6477.4696s
Epoch: 4 cost time: 17.49379873275757
Epoch: 4, Steps: 154 | Train Loss: 1.785 Vali Loss: 2.766 Vali Acc: 0.339 Test Loss: 2.766 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 8.1897650
	speed: 0.4417s/iter; left time: 6485.7333s
Epoch: 5 cost time: 16.439629316329956
Epoch: 5, Steps: 154 | Train Loss: 1.824 Vali Loss: 2.481 Vali Acc: 0.165 Test Loss: 2.481 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.7970746
	speed: 0.4599s/iter; left time: 6682.9349s
Epoch: 6 cost time: 15.610395669937134
Epoch: 6, Steps: 154 | Train Loss: 1.733 Vali Loss: 2.620 Vali Acc: 0.348 Test Loss: 2.620 Test Acc: 0.348
Validation loss decreased (-0.347503 --> -0.347906).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7206178
	speed: 0.4708s/iter; left time: 6769.2917s
Epoch: 7 cost time: 19.315582990646362
Epoch: 7, Steps: 154 | Train Loss: 1.784 Vali Loss: 2.530 Vali Acc: 0.365 Test Loss: 2.530 Test Acc: 0.365
Validation loss decreased (-0.347906 --> -0.364938).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3560081
	speed: 0.4842s/iter; left time: 6886.6513s
Epoch: 8 cost time: 17.37852430343628
Epoch: 8, Steps: 154 | Train Loss: 1.721 Vali Loss: 2.972 Vali Acc: 0.204 Test Loss: 2.972 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8667390
	speed: 0.4570s/iter; left time: 6429.4208s
Epoch: 9 cost time: 17.042118310928345
Epoch: 9, Steps: 154 | Train Loss: 1.623 Vali Loss: 3.365 Vali Acc: 0.087 Test Loss: 3.365 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3197451
	speed: 0.4578s/iter; left time: 6369.8657s
Epoch: 10 cost time: 16.727017879486084
Epoch: 10, Steps: 154 | Train Loss: 1.883 Vali Loss: 2.886 Vali Acc: 0.300 Test Loss: 2.886 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.4265761
	speed: 0.4691s/iter; left time: 6455.3045s
Epoch: 11 cost time: 17.400099754333496
Epoch: 11, Steps: 154 | Train Loss: 1.599 Vali Loss: 3.127 Vali Acc: 0.133 Test Loss: 3.127 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.4899037
	speed: 0.4701s/iter; left time: 6397.0365s
Epoch: 12 cost time: 14.803253412246704
Epoch: 12, Steps: 154 | Train Loss: 1.601 Vali Loss: 3.509 Vali Acc: 0.209 Test Loss: 3.509 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.1127099
	speed: 0.4498s/iter; left time: 6050.6698s
Epoch: 13 cost time: 18.525344848632812
Epoch: 13, Steps: 154 | Train Loss: 1.615 Vali Loss: 4.027 Vali Acc: 0.201 Test Loss: 4.027 Test Acc: 0.201
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.8782359
	speed: 0.4458s/iter; left time: 5928.8762s
Epoch: 14 cost time: 18.710570573806763
Epoch: 14, Steps: 154 | Train Loss: 1.814 Vali Loss: 3.525 Vali Acc: 0.212 Test Loss: 3.525 Test Acc: 0.212
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.5283070
	speed: 0.4322s/iter; left time: 5681.5587s
Epoch: 15 cost time: 15.375313520431519
Epoch: 15, Steps: 154 | Train Loss: 1.591 Vali Loss: 3.269 Vali Acc: 0.381 Test Loss: 3.269 Test Acc: 0.381
Validation loss decreased (-0.364938 --> -0.381151).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4676287
	speed: 0.4627s/iter; left time: 6011.2149s
Epoch: 16 cost time: 19.375646114349365
Epoch: 16, Steps: 154 | Train Loss: 1.375 Vali Loss: 4.327 Vali Acc: 0.079 Test Loss: 4.327 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.8847871
	speed: 0.4842s/iter; left time: 6216.1657s
Epoch: 17 cost time: 17.668280124664307
Epoch: 17, Steps: 154 | Train Loss: 1.422 Vali Loss: 4.010 Vali Acc: 0.087 Test Loss: 4.010 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.0673940
	speed: 0.4948s/iter; left time: 6275.5514s
Epoch: 18 cost time: 17.658128261566162
Epoch: 18, Steps: 154 | Train Loss: 1.520 Vali Loss: 4.671 Vali Acc: 0.096 Test Loss: 4.671 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.3349078
	speed: 0.4807s/iter; left time: 6022.6118s
Epoch: 19 cost time: 18.481653451919556
Epoch: 19, Steps: 154 | Train Loss: 1.516 Vali Loss: 3.882 Vali Acc: 0.224 Test Loss: 3.882 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.4710180
	speed: 0.4417s/iter; left time: 5466.3187s
Epoch: 20 cost time: 15.669153213500977
Epoch: 20, Steps: 154 | Train Loss: 1.330 Vali Loss: 3.619 Vali Acc: 0.337 Test Loss: 3.619 Test Acc: 0.337
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.2996975
	speed: 0.4540s/iter; left time: 5547.8679s
Epoch: 21 cost time: 17.186103105545044
Epoch: 21, Steps: 154 | Train Loss: 1.374 Vali Loss: 4.625 Vali Acc: 0.318 Test Loss: 4.625 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.7658225
	speed: 0.4925s/iter; left time: 5942.4073s
Epoch: 22 cost time: 19.850215911865234
Epoch: 22, Steps: 154 | Train Loss: 1.449 Vali Loss: 4.839 Vali Acc: 0.129 Test Loss: 4.839 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.6482275
	speed: 0.4811s/iter; left time: 5730.9513s
Epoch: 23 cost time: 16.16781187057495
Epoch: 23, Steps: 154 | Train Loss: 1.552 Vali Loss: 5.990 Vali Acc: 0.349 Test Loss: 5.990 Test Acc: 0.349
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.9299809
	speed: 0.4823s/iter; left time: 5671.0428s
Epoch: 24 cost time: 18.992259979248047
Epoch: 24, Steps: 154 | Train Loss: 1.620 Vali Loss: 5.800 Vali Acc: 0.102 Test Loss: 5.800 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.3562027
	speed: 0.4669s/iter; left time: 5417.9096s
Epoch: 25 cost time: 17.79709219932556
Epoch: 25, Steps: 154 | Train Loss: 1.369 Vali Loss: 3.974 Vali Acc: 0.242 Test Loss: 3.974 Test Acc: 0.242
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38118410381184104
model parameter : 5532766
model size : 30.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6233373
	speed: 0.1351s/iter; left time: 2067.2168s
Epoch: 1 cost time: 19.624194860458374
Epoch: 1, Steps: 154 | Train Loss: 2.358 Vali Loss: 2.235 Vali Acc: 0.327 Test Loss: 2.235 Test Acc: 0.327
Validation loss decreased (inf --> -0.327228).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5118973
	speed: 0.4630s/iter; left time: 7013.6978s
Epoch: 2 cost time: 16.57921600341797
Epoch: 2, Steps: 154 | Train Loss: 2.140 Vali Loss: 2.311 Vali Acc: 0.330 Test Loss: 2.311 Test Acc: 0.330
Validation loss decreased (-0.327228 --> -0.330472).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6160278
	speed: 0.4577s/iter; left time: 6862.9634s
Epoch: 3 cost time: 18.539623975753784
Epoch: 3, Steps: 154 | Train Loss: 2.117 Vali Loss: 2.351 Vali Acc: 0.324 Test Loss: 2.351 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6519582
	speed: 0.4011s/iter; left time: 5952.6597s
Epoch: 4 cost time: 14.735222578048706
Epoch: 4, Steps: 154 | Train Loss: 1.963 Vali Loss: 2.526 Vali Acc: 0.056 Test Loss: 2.526 Test Acc: 0.056
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.6952500
	speed: 0.4545s/iter; left time: 6674.7257s
Epoch: 5 cost time: 18.03849744796753
Epoch: 5, Steps: 154 | Train Loss: 1.913 Vali Loss: 2.463 Vali Acc: 0.337 Test Loss: 2.463 Test Acc: 0.337
Validation loss decreased (-0.330472 --> -0.336958).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7728264
	speed: 0.4689s/iter; left time: 6814.3014s
Epoch: 6 cost time: 18.949427127838135
Epoch: 6, Steps: 154 | Train Loss: 1.924 Vali Loss: 2.723 Vali Acc: 0.068 Test Loss: 2.723 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4719627
	speed: 0.5025s/iter; left time: 7224.8943s
Epoch: 7 cost time: 19.00082492828369
Epoch: 7, Steps: 154 | Train Loss: 1.994 Vali Loss: 3.146 Vali Acc: 0.071 Test Loss: 3.146 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 4.8787298
	speed: 0.5103s/iter; left time: 7257.5904s
Epoch: 8 cost time: 19.839515209197998
Epoch: 8, Steps: 154 | Train Loss: 1.800 Vali Loss: 3.120 Vali Acc: 0.077 Test Loss: 3.120 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.4395047
	speed: 0.4804s/iter; left time: 6758.0814s
Epoch: 9 cost time: 17.89601421356201
Epoch: 9, Steps: 154 | Train Loss: 1.840 Vali Loss: 3.735 Vali Acc: 0.043 Test Loss: 3.735 Test Acc: 0.043
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.5767341
	speed: 0.4337s/iter; left time: 6035.5110s
Epoch: 10 cost time: 16.238032817840576
Epoch: 10, Steps: 154 | Train Loss: 1.834 Vali Loss: 3.308 Vali Acc: 0.088 Test Loss: 3.308 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.5445988
	speed: 0.4651s/iter; left time: 6399.8692s
Epoch: 11 cost time: 18.535969972610474
Epoch: 11, Steps: 154 | Train Loss: 1.717 Vali Loss: 3.237 Vali Acc: 0.357 Test Loss: 3.237 Test Acc: 0.357
Validation loss decreased (-0.336958 --> -0.357226).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5544271
	speed: 0.4654s/iter; left time: 6332.0263s
Epoch: 12 cost time: 18.759222745895386
Epoch: 12, Steps: 154 | Train Loss: 1.853 Vali Loss: 3.378 Vali Acc: 0.347 Test Loss: 3.378 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.0733241
	speed: 0.5088s/iter; left time: 6844.3324s
Epoch: 13 cost time: 18.17751431465149
Epoch: 13, Steps: 154 | Train Loss: 1.922 Vali Loss: 3.698 Vali Acc: 0.066 Test Loss: 3.698 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.5284516
	speed: 0.4795s/iter; left time: 6377.3367s
Epoch: 14 cost time: 19.199525833129883
Epoch: 14, Steps: 154 | Train Loss: 1.698 Vali Loss: 3.603 Vali Acc: 0.086 Test Loss: 3.603 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.5745010
	speed: 0.4813s/iter; left time: 6327.2338s
Epoch: 15 cost time: 17.30194067955017
Epoch: 15, Steps: 154 | Train Loss: 1.774 Vali Loss: 4.173 Vali Acc: 0.066 Test Loss: 4.173 Test Acc: 0.066
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.5486437
	speed: 0.4213s/iter; left time: 5473.7533s
Epoch: 16 cost time: 14.838492155075073
Epoch: 16, Steps: 154 | Train Loss: 2.080 Vali Loss: 3.465 Vali Acc: 0.083 Test Loss: 3.465 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.9238194
	speed: 0.4520s/iter; left time: 5802.4471s
Epoch: 17 cost time: 16.49720597267151
Epoch: 17, Steps: 154 | Train Loss: 1.683 Vali Loss: 3.313 Vali Acc: 0.363 Test Loss: 3.313 Test Acc: 0.363
Validation loss decreased (-0.357226 --> -0.363308).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.3248222
	speed: 0.5028s/iter; left time: 6376.6323s
Epoch: 18 cost time: 20.465826749801636
Epoch: 18, Steps: 154 | Train Loss: 1.832 Vali Loss: 3.532 Vali Acc: 0.283 Test Loss: 3.532 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.4034811
	speed: 0.4983s/iter; left time: 6242.9231s
Epoch: 19 cost time: 18.554710626602173
Epoch: 19, Steps: 154 | Train Loss: 1.736 Vali Loss: 3.841 Vali Acc: 0.098 Test Loss: 3.841 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.5636632
	speed: 0.4891s/iter; left time: 6052.4165s
Epoch: 20 cost time: 17.36225152015686
Epoch: 20, Steps: 154 | Train Loss: 1.717 Vali Loss: 3.657 Vali Acc: 0.367 Test Loss: 3.657 Test Acc: 0.367
Validation loss decreased (-0.363308 --> -0.366955).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.9101856
	speed: 0.4480s/iter; left time: 5474.6515s
Epoch: 21 cost time: 18.543683767318726
Epoch: 21, Steps: 154 | Train Loss: 1.695 Vali Loss: 3.759 Vali Acc: 0.364 Test Loss: 3.759 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.4692301
	speed: 0.4641s/iter; left time: 5599.7490s
Epoch: 22 cost time: 17.940221548080444
Epoch: 22, Steps: 154 | Train Loss: 1.596 Vali Loss: 3.680 Vali Acc: 0.361 Test Loss: 3.680 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.2455298
	speed: 0.4842s/iter; left time: 5768.2622s
Epoch: 23 cost time: 18.133323192596436
Epoch: 23, Steps: 154 | Train Loss: 1.570 Vali Loss: 4.444 Vali Acc: 0.362 Test Loss: 4.444 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.6391003
	speed: 0.5031s/iter; left time: 5916.2848s
Epoch: 24 cost time: 19.098971128463745
Epoch: 24, Steps: 154 | Train Loss: 1.694 Vali Loss: 4.049 Vali Acc: 0.363 Test Loss: 4.049 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.9366503
	speed: 0.4614s/iter; left time: 5354.1810s
Epoch: 25 cost time: 17.616913080215454
Epoch: 25, Steps: 154 | Train Loss: 1.509 Vali Loss: 4.429 Vali Acc: 0.088 Test Loss: 4.429 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 1.4329135
	speed: 0.4553s/iter; left time: 5213.8130s
Epoch: 26 cost time: 17.155239820480347
Epoch: 26, Steps: 154 | Train Loss: 1.670 Vali Loss: 4.041 Vali Acc: 0.099 Test Loss: 4.041 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 1.1223211
	speed: 0.4699s/iter; left time: 5308.8711s
Epoch: 27 cost time: 18.31390619277954
Epoch: 27, Steps: 154 | Train Loss: 1.510 Vali Loss: 4.193 Vali Acc: 0.363 Test Loss: 4.193 Test Acc: 0.363
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 1.5264797
	speed: 0.4658s/iter; left time: 5190.7328s
Epoch: 28 cost time: 17.928616046905518
Epoch: 28, Steps: 154 | Train Loss: 1.451 Vali Loss: 4.545 Vali Acc: 0.355 Test Loss: 4.545 Test Acc: 0.355
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 1.4073571
	speed: 0.4961s/iter; left time: 5451.8215s
Epoch: 29 cost time: 17.95175313949585
Epoch: 29, Steps: 154 | Train Loss: 1.268 Vali Loss: 4.608 Vali Acc: 0.101 Test Loss: 4.608 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.9810089
	speed: 0.4763s/iter; left time: 5160.4427s
Epoch: 30 cost time: 17.159900903701782
Epoch: 30, Steps: 154 | Train Loss: 1.338 Vali Loss: 4.566 Vali Acc: 0.150 Test Loss: 4.566 Test Acc: 0.150
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36699107866991076
model parameter : 3435614
model size : 22.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.5501498
	speed: 0.1315s/iter; left time: 2012.4876s
Epoch: 1 cost time: 18.39161205291748
Epoch: 1, Steps: 154 | Train Loss: 2.336 Vali Loss: 2.226 Vali Acc: 0.329 Test Loss: 2.226 Test Acc: 0.329
Validation loss decreased (inf --> -0.329256).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4965551
	speed: 0.4305s/iter; left time: 6520.5611s
Epoch: 2 cost time: 17.273284673690796
Epoch: 2, Steps: 154 | Train Loss: 2.141 Vali Loss: 2.307 Vali Acc: 0.330 Test Loss: 2.307 Test Acc: 0.330
Validation loss decreased (-0.329256 --> -0.330066).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1040542
	speed: 0.4731s/iter; left time: 7093.1661s
Epoch: 3 cost time: 17.25504779815674
Epoch: 3, Steps: 154 | Train Loss: 2.086 Vali Loss: 2.360 Vali Acc: 0.328 Test Loss: 2.360 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7363366
	speed: 0.4743s/iter; left time: 7037.9452s
Epoch: 4 cost time: 17.289427757263184
Epoch: 4, Steps: 154 | Train Loss: 1.929 Vali Loss: 2.485 Vali Acc: 0.076 Test Loss: 2.485 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.5323100
	speed: 0.4690s/iter; left time: 6887.7177s
Epoch: 5 cost time: 18.576584339141846
Epoch: 5, Steps: 154 | Train Loss: 1.854 Vali Loss: 2.398 Vali Acc: 0.340 Test Loss: 2.398 Test Acc: 0.340
Validation loss decreased (-0.330066 --> -0.340203).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4263133
	speed: 0.4757s/iter; left time: 6912.7413s
Epoch: 6 cost time: 17.4978666305542
Epoch: 6, Steps: 154 | Train Loss: 1.910 Vali Loss: 2.667 Vali Acc: 0.075 Test Loss: 2.667 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2648771
	speed: 0.4410s/iter; left time: 6340.7959s
Epoch: 7 cost time: 16.146936416625977
Epoch: 7, Steps: 154 | Train Loss: 1.767 Vali Loss: 2.510 Vali Acc: 0.346 Test Loss: 2.510 Test Acc: 0.346
Validation loss decreased (-0.340203 --> -0.346285).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6386043
	speed: 0.4068s/iter; left time: 5785.8631s
Epoch: 8 cost time: 16.055808067321777
Epoch: 8, Steps: 154 | Train Loss: 1.947 Vali Loss: 2.823 Vali Acc: 0.087 Test Loss: 2.823 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7034811
	speed: 0.4054s/iter; left time: 5703.1672s
Epoch: 9 cost time: 15.174679517745972
Epoch: 9, Steps: 154 | Train Loss: 2.105 Vali Loss: 3.137 Vali Acc: 0.066 Test Loss: 3.137 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3694949
	speed: 0.4246s/iter; left time: 5908.3911s
Epoch: 10 cost time: 14.720886707305908
Epoch: 10, Steps: 154 | Train Loss: 1.828 Vali Loss: 3.025 Vali Acc: 0.116 Test Loss: 3.025 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.7588599
	speed: 0.4311s/iter; left time: 5932.3008s
Epoch: 11 cost time: 17.939637899398804
Epoch: 11, Steps: 154 | Train Loss: 1.676 Vali Loss: 2.965 Vali Acc: 0.360 Test Loss: 2.965 Test Acc: 0.360
Validation loss decreased (-0.346285 --> -0.360068).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1346941
	speed: 0.4184s/iter; left time: 5693.1672s
Epoch: 12 cost time: 15.491272687911987
Epoch: 12, Steps: 154 | Train Loss: 1.737 Vali Loss: 3.033 Vali Acc: 0.365 Test Loss: 3.033 Test Acc: 0.365
Validation loss decreased (-0.360068 --> -0.365339).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0764773
	speed: 0.4194s/iter; left time: 5641.7476s
Epoch: 13 cost time: 16.495851755142212
Epoch: 13, Steps: 154 | Train Loss: 1.624 Vali Loss: 3.991 Vali Acc: 0.082 Test Loss: 3.991 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4963531
	speed: 0.4084s/iter; left time: 5431.7017s
Epoch: 14 cost time: 15.141113758087158
Epoch: 14, Steps: 154 | Train Loss: 1.608 Vali Loss: 3.390 Vali Acc: 0.372 Test Loss: 3.390 Test Acc: 0.372
Validation loss decreased (-0.365339 --> -0.372229).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.9334096
	speed: 0.4310s/iter; left time: 5665.2436s
Epoch: 15 cost time: 15.137670516967773
Epoch: 15, Steps: 154 | Train Loss: 1.755 Vali Loss: 4.866 Vali Acc: 0.061 Test Loss: 4.866 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.8857825
	speed: 0.4192s/iter; left time: 5445.2358s
Epoch: 16 cost time: 17.292388439178467
Epoch: 16, Steps: 154 | Train Loss: 1.708 Vali Loss: 3.395 Vali Acc: 0.372 Test Loss: 3.395 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.3496745
	speed: 0.4514s/iter; left time: 5794.0231s
Epoch: 17 cost time: 15.79107141494751
Epoch: 17, Steps: 154 | Train Loss: 1.741 Vali Loss: 4.136 Vali Acc: 0.087 Test Loss: 4.136 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.2961128
	speed: 0.4154s/iter; left time: 5268.2892s
Epoch: 18 cost time: 16.359257698059082
Epoch: 18, Steps: 154 | Train Loss: 2.158 Vali Loss: 3.525 Vali Acc: 0.375 Test Loss: 3.525 Test Acc: 0.375
Validation loss decreased (-0.372229 --> -0.375066).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.5560296
	speed: 0.4247s/iter; left time: 5321.0316s
Epoch: 19 cost time: 16.051465272903442
Epoch: 19, Steps: 154 | Train Loss: 1.553 Vali Loss: 3.584 Vali Acc: 0.100 Test Loss: 3.584 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1904020
	speed: 0.4424s/iter; left time: 5474.8425s
Epoch: 20 cost time: 17.1440167427063
Epoch: 20, Steps: 154 | Train Loss: 1.592 Vali Loss: 4.218 Vali Acc: 0.362 Test Loss: 4.218 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.4752188
	speed: 0.4461s/iter; left time: 5451.2322s
Epoch: 21 cost time: 16.930713891983032
Epoch: 21, Steps: 154 | Train Loss: 1.593 Vali Loss: 4.012 Vali Acc: 0.337 Test Loss: 4.012 Test Acc: 0.337
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.2613792
	speed: 0.4372s/iter; left time: 5275.8283s
Epoch: 22 cost time: 14.79667615890503
Epoch: 22, Steps: 154 | Train Loss: 1.482 Vali Loss: 3.875 Vali Acc: 0.363 Test Loss: 3.875 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.5618105
	speed: 0.4058s/iter; left time: 4833.8903s
Epoch: 23 cost time: 16.350719928741455
Epoch: 23, Steps: 154 | Train Loss: 1.555 Vali Loss: 4.123 Vali Acc: 0.363 Test Loss: 4.123 Test Acc: 0.363
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.3628786
	speed: 0.4350s/iter; left time: 5115.1277s
Epoch: 24 cost time: 15.434175968170166
Epoch: 24, Steps: 154 | Train Loss: 1.422 Vali Loss: 4.639 Vali Acc: 0.373 Test Loss: 4.639 Test Acc: 0.373
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.6627879
	speed: 0.4120s/iter; left time: 4781.4075s
Epoch: 25 cost time: 17.20926070213318
Epoch: 25, Steps: 154 | Train Loss: 1.681 Vali Loss: 4.110 Vali Acc: 0.100 Test Loss: 4.110 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.2330447
	speed: 0.4089s/iter; left time: 4682.3103s
Epoch: 26 cost time: 15.265739440917969
Epoch: 26, Steps: 154 | Train Loss: 1.670 Vali Loss: 4.805 Vali Acc: 0.092 Test Loss: 4.805 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.9026972
	speed: 0.3836s/iter; left time: 4333.9466s
Epoch: 27 cost time: 14.64650297164917
Epoch: 27, Steps: 154 | Train Loss: 1.439 Vali Loss: 4.504 Vali Acc: 0.173 Test Loss: 4.504 Test Acc: 0.173
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.2900169
	speed: 0.3997s/iter; left time: 4454.3611s
Epoch: 28 cost time: 16.14609456062317
Epoch: 28, Steps: 154 | Train Loss: 1.922 Vali Loss: 4.626 Vali Acc: 0.090 Test Loss: 4.626 Test Acc: 0.090
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3751013787510138
model parameter : 3435614
model size : 22.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6115024
	speed: 0.1330s/iter; left time: 2034.9476s
Epoch: 1 cost time: 19.658347368240356
Epoch: 1, Steps: 154 | Train Loss: 2.320 Vali Loss: 2.254 Vali Acc: 0.328 Test Loss: 2.254 Test Acc: 0.328
Validation loss decreased (inf --> -0.328445).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4554045
	speed: 0.4672s/iter; left time: 7077.0971s
Epoch: 2 cost time: 16.574787139892578
Epoch: 2, Steps: 154 | Train Loss: 2.111 Vali Loss: 2.291 Vali Acc: 0.331 Test Loss: 2.291 Test Acc: 0.331
Validation loss decreased (-0.328445 --> -0.331283).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9933913
	speed: 0.4456s/iter; left time: 6680.9301s
Epoch: 3 cost time: 17.11418128013611
Epoch: 3, Steps: 154 | Train Loss: 2.065 Vali Loss: 2.344 Vali Acc: 0.332 Test Loss: 2.344 Test Acc: 0.332
Validation loss decreased (-0.331283 --> -0.332093).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7893293
	speed: 0.4422s/iter; left time: 6561.7626s
Epoch: 4 cost time: 15.551008224487305
Epoch: 4, Steps: 154 | Train Loss: 1.900 Vali Loss: 2.455 Vali Acc: 0.202 Test Loss: 2.455 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5198963
	speed: 0.4571s/iter; left time: 6712.4756s
Epoch: 5 cost time: 16.895652294158936
Epoch: 5, Steps: 154 | Train Loss: 1.868 Vali Loss: 2.350 Vali Acc: 0.341 Test Loss: 2.350 Test Acc: 0.341
Validation loss decreased (-0.332093 --> -0.341420).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5159950
	speed: 0.4535s/iter; left time: 6589.6217s
Epoch: 6 cost time: 17.980693340301514
Epoch: 6, Steps: 154 | Train Loss: 1.781 Vali Loss: 2.771 Vali Acc: 0.074 Test Loss: 2.771 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.1858603
	speed: 0.4397s/iter; left time: 6321.0414s
Epoch: 7 cost time: 16.214901208877563
Epoch: 7, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.808 Vali Acc: 0.351 Test Loss: 2.808 Test Acc: 0.351
Validation loss decreased (-0.341420 --> -0.350742).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1920428
	speed: 0.4435s/iter; left time: 6307.7775s
Epoch: 8 cost time: 17.05148458480835
Epoch: 8, Steps: 154 | Train Loss: 1.933 Vali Loss: 2.753 Vali Acc: 0.093 Test Loss: 2.753 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.9592524
	speed: 0.4633s/iter; left time: 6517.4832s
Epoch: 9 cost time: 17.80251955986023
Epoch: 9, Steps: 154 | Train Loss: 1.748 Vali Loss: 3.308 Vali Acc: 0.083 Test Loss: 3.308 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4118943
	speed: 0.4726s/iter; left time: 6576.0190s
Epoch: 10 cost time: 16.61343002319336
Epoch: 10, Steps: 154 | Train Loss: 1.736 Vali Loss: 3.127 Vali Acc: 0.203 Test Loss: 3.127 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.3948710
	speed: 0.4386s/iter; left time: 6035.3729s
Epoch: 11 cost time: 18.01317596435547
Epoch: 11, Steps: 154 | Train Loss: 1.693 Vali Loss: 3.073 Vali Acc: 0.348 Test Loss: 3.073 Test Acc: 0.348
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.6144471
	speed: 0.4491s/iter; left time: 6110.5190s
Epoch: 12 cost time: 16.74850368499756
Epoch: 12, Steps: 154 | Train Loss: 1.641 Vali Loss: 3.048 Vali Acc: 0.095 Test Loss: 3.048 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.2082667
	speed: 0.4672s/iter; left time: 6285.2682s
Epoch: 13 cost time: 17.52281665802002
Epoch: 13, Steps: 154 | Train Loss: 1.712 Vali Loss: 3.376 Vali Acc: 0.086 Test Loss: 3.376 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.4525479
	speed: 0.4740s/iter; left time: 6303.7338s
Epoch: 14 cost time: 17.669761180877686
Epoch: 14, Steps: 154 | Train Loss: 1.861 Vali Loss: 3.498 Vali Acc: 0.160 Test Loss: 3.498 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.4586775
	speed: 0.4394s/iter; left time: 5775.4768s
Epoch: 15 cost time: 17.095305681228638
Epoch: 15, Steps: 154 | Train Loss: 1.639 Vali Loss: 3.347 Vali Acc: 0.314 Test Loss: 3.347 Test Acc: 0.314
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.2024360
	speed: 0.4744s/iter; left time: 6162.3267s
Epoch: 16 cost time: 17.82582378387451
Epoch: 16, Steps: 154 | Train Loss: 1.576 Vali Loss: 4.004 Vali Acc: 0.379 Test Loss: 4.004 Test Acc: 0.379
Validation loss decreased (-0.350742 --> -0.378711).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.5223256
	speed: 0.4719s/iter; left time: 6058.3523s
Epoch: 17 cost time: 18.23294734954834
Epoch: 17, Steps: 154 | Train Loss: 1.572 Vali Loss: 4.872 Vali Acc: 0.362 Test Loss: 4.872 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.1531270
	speed: 0.4471s/iter; left time: 5670.3540s
Epoch: 18 cost time: 15.698904514312744
Epoch: 18, Steps: 154 | Train Loss: 1.649 Vali Loss: 5.020 Vali Acc: 0.092 Test Loss: 5.020 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.2748001
	speed: 0.4488s/iter; left time: 5622.7480s
Epoch: 19 cost time: 17.947404861450195
Epoch: 19, Steps: 154 | Train Loss: 1.701 Vali Loss: 4.113 Vali Acc: 0.266 Test Loss: 4.113 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.9759573
	speed: 0.4261s/iter; left time: 5273.4576s
Epoch: 20 cost time: 16.596912622451782
Epoch: 20, Steps: 154 | Train Loss: 1.464 Vali Loss: 3.962 Vali Acc: 0.384 Test Loss: 3.962 Test Acc: 0.384
Validation loss decreased (-0.378711 --> -0.383983).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.8039985
	speed: 0.4559s/iter; left time: 5571.8462s
Epoch: 21 cost time: 16.307209730148315
Epoch: 21, Steps: 154 | Train Loss: 1.594 Vali Loss: 4.108 Vali Acc: 0.373 Test Loss: 4.108 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.2072065
	speed: 0.4522s/iter; left time: 5456.6673s
Epoch: 22 cost time: 16.669410705566406
Epoch: 22, Steps: 154 | Train Loss: 1.358 Vali Loss: 4.102 Vali Acc: 0.358 Test Loss: 4.102 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.3106340
	speed: 0.4419s/iter; left time: 5264.4832s
Epoch: 23 cost time: 15.889969825744629
Epoch: 23, Steps: 154 | Train Loss: 1.460 Vali Loss: 4.618 Vali Acc: 0.146 Test Loss: 4.618 Test Acc: 0.146
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.2288375
	speed: 0.4000s/iter; left time: 4703.5340s
Epoch: 24 cost time: 13.466979026794434
Epoch: 24, Steps: 154 | Train Loss: 1.404 Vali Loss: 4.452 Vali Acc: 0.391 Test Loss: 4.452 Test Acc: 0.391
Validation loss decreased (-0.383983 --> -0.390466).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.5471784
	speed: 0.4132s/iter; left time: 4795.6626s
Epoch: 25 cost time: 16.445026874542236
Epoch: 25, Steps: 154 | Train Loss: 1.353 Vali Loss: 4.188 Vali Acc: 0.366 Test Loss: 4.188 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.1294366
	speed: 0.4706s/iter; left time: 5389.0616s
Epoch: 26 cost time: 19.14622926712036
Epoch: 26, Steps: 154 | Train Loss: 1.295 Vali Loss: 4.280 Vali Acc: 0.385 Test Loss: 4.280 Test Acc: 0.385
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.7561178
	speed: 0.4525s/iter; left time: 5111.3800s
Epoch: 27 cost time: 14.65004301071167
Epoch: 27, Steps: 154 | Train Loss: 1.328 Vali Loss: 4.607 Vali Acc: 0.383 Test Loss: 4.607 Test Acc: 0.383
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.2036743
	speed: 0.4241s/iter; left time: 4726.2201s
Epoch: 28 cost time: 15.496888399124146
Epoch: 28, Steps: 154 | Train Loss: 2.277 Vali Loss: 4.318 Vali Acc: 0.375 Test Loss: 4.318 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 1.4856619
	speed: 0.4252s/iter; left time: 4672.6916s
Epoch: 29 cost time: 17.310351133346558
Epoch: 29, Steps: 154 | Train Loss: 2.189 Vali Loss: 4.618 Vali Acc: 0.122 Test Loss: 4.618 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 1.3233607
	speed: 0.4350s/iter; left time: 4713.7443s
Epoch: 30 cost time: 15.71581482887268
Epoch: 30, Steps: 154 | Train Loss: 1.682 Vali Loss: 5.931 Vali Acc: 0.150 Test Loss: 5.931 Test Acc: 0.150
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 1.4600126
	speed: 0.4568s/iter; left time: 4878.6681s
Epoch: 31 cost time: 20.15047335624695
Epoch: 31, Steps: 154 | Train Loss: 1.730 Vali Loss: 6.118 Vali Acc: 0.085 Test Loss: 6.118 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 1.0614767
	speed: 0.5019s/iter; left time: 5283.9901s
Epoch: 32 cost time: 20.671497583389282
Epoch: 32, Steps: 154 | Train Loss: 1.129 Vali Loss: 5.401 Vali Acc: 0.201 Test Loss: 5.401 Test Acc: 0.201
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 1.3028533
	speed: 0.4825s/iter; left time: 5005.0209s
Epoch: 33 cost time: 18.07284641265869
Epoch: 33, Steps: 154 | Train Loss: 1.073 Vali Loss: 6.757 Vali Acc: 0.105 Test Loss: 6.757 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 1.3452445
	speed: 0.4985s/iter; left time: 5093.6777s
Epoch: 34 cost time: 20.281776905059814
Epoch: 34, Steps: 154 | Train Loss: 1.597 Vali Loss: 6.772 Vali Acc: 0.129 Test Loss: 6.772 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3905109489051095
model parameter : 3435614
model size : 22.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6552523
	speed: 0.1553s/iter; left time: 2376.3385s
Epoch: 1 cost time: 21.459779024124146
Epoch: 1, Steps: 154 | Train Loss: 2.271 Vali Loss: 2.248 Vali Acc: 0.326 Test Loss: 2.248 Test Acc: 0.326
Validation loss decreased (inf --> -0.325606).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3460503
	speed: 0.4497s/iter; left time: 6811.8119s
Epoch: 2 cost time: 15.771154642105103
Epoch: 2, Steps: 154 | Train Loss: 2.046 Vali Loss: 2.366 Vali Acc: 0.333 Test Loss: 2.366 Test Acc: 0.333
Validation loss decreased (-0.325606 --> -0.332499).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3654563
	speed: 0.4887s/iter; left time: 7326.9570s
Epoch: 3 cost time: 18.073505401611328
Epoch: 3, Steps: 154 | Train Loss: 1.940 Vali Loss: 2.632 Vali Acc: 0.332 Test Loss: 2.632 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5341123
	speed: 0.4876s/iter; left time: 7235.7145s
Epoch: 4 cost time: 15.817925214767456
Epoch: 4, Steps: 154 | Train Loss: 1.858 Vali Loss: 2.583 Vali Acc: 0.315 Test Loss: 2.583 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.5479885
	speed: 0.4397s/iter; left time: 6456.3172s
Epoch: 5 cost time: 19.134923458099365
Epoch: 5, Steps: 154 | Train Loss: 1.793 Vali Loss: 2.597 Vali Acc: 0.348 Test Loss: 2.597 Test Acc: 0.348
Validation loss decreased (-0.332499 --> -0.348311).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0638047
	speed: 0.4529s/iter; left time: 6581.1064s
Epoch: 6 cost time: 14.85187029838562
Epoch: 6, Steps: 154 | Train Loss: 1.705 Vali Loss: 2.556 Vali Acc: 0.084 Test Loss: 2.556 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3423259
	speed: 0.4835s/iter; left time: 6951.5845s
Epoch: 7 cost time: 20.17998456954956
Epoch: 7, Steps: 154 | Train Loss: 1.670 Vali Loss: 2.745 Vali Acc: 0.359 Test Loss: 2.745 Test Acc: 0.359
Validation loss decreased (-0.348311 --> -0.359259).  Saving model ...
	iters: 100, epoch: 8 | loss: 5.8563366
	speed: 0.4843s/iter; left time: 6888.2416s
Epoch: 8 cost time: 16.103771924972534
Epoch: 8, Steps: 154 | Train Loss: 1.630 Vali Loss: 2.534 Vali Acc: 0.376 Test Loss: 2.534 Test Acc: 0.376
Validation loss decreased (-0.359259 --> -0.375887).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3644489
	speed: 0.4797s/iter; left time: 6749.4977s
Epoch: 9 cost time: 18.64766502380371
Epoch: 9, Steps: 154 | Train Loss: 1.648 Vali Loss: 2.802 Vali Acc: 0.368 Test Loss: 2.802 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5558292
	speed: 0.4585s/iter; left time: 6380.2148s
Epoch: 10 cost time: 17.315206050872803
Epoch: 10, Steps: 154 | Train Loss: 1.721 Vali Loss: 2.787 Vali Acc: 0.365 Test Loss: 2.787 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.1512771
	speed: 0.4491s/iter; left time: 6180.1109s
Epoch: 11 cost time: 16.848594188690186
Epoch: 11, Steps: 154 | Train Loss: 1.932 Vali Loss: 2.981 Vali Acc: 0.365 Test Loss: 2.981 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.2997340
	speed: 0.4380s/iter; left time: 5959.7432s
Epoch: 12 cost time: 14.724929094314575
Epoch: 12, Steps: 154 | Train Loss: 2.171 Vali Loss: 3.163 Vali Acc: 0.363 Test Loss: 3.163 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.0457097
	speed: 0.4730s/iter; left time: 6362.6336s
Epoch: 13 cost time: 20.98027801513672
Epoch: 13, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.939 Vali Acc: 0.380 Test Loss: 2.939 Test Acc: 0.380
Validation loss decreased (-0.375887 --> -0.380344).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4427600
	speed: 0.4567s/iter; left time: 6073.4176s
Epoch: 14 cost time: 16.471171140670776
Epoch: 14, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.920 Vali Acc: 0.395 Test Loss: 2.920 Test Acc: 0.395
Validation loss decreased (-0.380344 --> -0.394537).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2040929
	speed: 0.4937s/iter; left time: 6489.5042s
Epoch: 15 cost time: 17.91827964782715
Epoch: 15, Steps: 154 | Train Loss: 1.550 Vali Loss: 3.054 Vali Acc: 0.153 Test Loss: 3.054 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0254862
	speed: 0.4665s/iter; left time: 6060.0088s
Epoch: 16 cost time: 16.76662588119507
Epoch: 16, Steps: 154 | Train Loss: 1.628 Vali Loss: 3.208 Vali Acc: 0.376 Test Loss: 3.208 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.9354733
	speed: 0.4358s/iter; left time: 5594.9137s
Epoch: 17 cost time: 18.147177696228027
Epoch: 17, Steps: 154 | Train Loss: 1.541 Vali Loss: 3.443 Vali Acc: 0.382 Test Loss: 3.443 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.9220963
	speed: 0.4720s/iter; left time: 5986.6778s
Epoch: 18 cost time: 19.099290370941162
Epoch: 18, Steps: 154 | Train Loss: 1.670 Vali Loss: 3.876 Vali Acc: 0.265 Test Loss: 3.876 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.8655262
	speed: 0.5037s/iter; left time: 6310.3428s
Epoch: 19 cost time: 18.744725465774536
Epoch: 19, Steps: 154 | Train Loss: 1.639 Vali Loss: 3.424 Vali Acc: 0.386 Test Loss: 3.424 Test Acc: 0.386
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 39.6939583
	speed: 0.4641s/iter; left time: 5742.8582s
Epoch: 20 cost time: 18.00670051574707
Epoch: 20, Steps: 154 | Train Loss: 1.554 Vali Loss: 3.829 Vali Acc: 0.375 Test Loss: 3.829 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.6255327
	speed: 0.4527s/iter; left time: 5531.8981s
Epoch: 21 cost time: 15.921845197677612
Epoch: 21, Steps: 154 | Train Loss: 1.391 Vali Loss: 4.256 Vali Acc: 0.369 Test Loss: 4.256 Test Acc: 0.369
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.8998309
	speed: 0.4654s/iter; left time: 5615.9040s
Epoch: 22 cost time: 20.01615858078003
Epoch: 22, Steps: 154 | Train Loss: 1.421 Vali Loss: 3.947 Vali Acc: 0.393 Test Loss: 3.947 Test Acc: 0.393
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.6378126
	speed: 0.4416s/iter; left time: 5260.7964s
Epoch: 23 cost time: 15.363033056259155
Epoch: 23, Steps: 154 | Train Loss: 1.302 Vali Loss: 4.234 Vali Acc: 0.391 Test Loss: 4.234 Test Acc: 0.391
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.7684705
	speed: 0.4909s/iter; left time: 5772.6671s
Epoch: 24 cost time: 18.847593307495117
Epoch: 24, Steps: 154 | Train Loss: 1.542 Vali Loss: 4.131 Vali Acc: 0.384 Test Loss: 4.131 Test Acc: 0.384
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39456609894566097
model parameter : 3435614
model size : 22.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0042398
	speed: 0.1398s/iter; left time: 2138.8941s
Epoch: 1 cost time: 20.169997215270996
Epoch: 1, Steps: 154 | Train Loss: 2.278 Vali Loss: 2.227 Vali Acc: 0.323 Test Loss: 2.227 Test Acc: 0.323
Validation loss decreased (inf --> -0.322768).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9196811
	speed: 0.4443s/iter; left time: 6729.5663s
Epoch: 2 cost time: 18.178894758224487
Epoch: 2, Steps: 154 | Train Loss: 2.104 Vali Loss: 2.342 Vali Acc: 0.324 Test Loss: 2.342 Test Acc: 0.324
Validation loss decreased (-0.322768 --> -0.323578).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8229169
	speed: 0.4603s/iter; left time: 6901.5946s
Epoch: 3 cost time: 16.63906741142273
Epoch: 3, Steps: 154 | Train Loss: 2.065 Vali Loss: 2.373 Vali Acc: 0.327 Test Loss: 2.373 Test Acc: 0.327
Validation loss decreased (-0.323578 --> -0.326821).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4657042
	speed: 0.4469s/iter; left time: 6631.9150s
Epoch: 4 cost time: 19.5535945892334
Epoch: 4, Steps: 154 | Train Loss: 2.008 Vali Loss: 2.430 Vali Acc: 0.328 Test Loss: 2.430 Test Acc: 0.328
Validation loss decreased (-0.326821 --> -0.328443).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7861019
	speed: 0.4673s/iter; left time: 6861.6028s
Epoch: 5 cost time: 16.263861179351807
Epoch: 5, Steps: 154 | Train Loss: 1.890 Vali Loss: 2.509 Vali Acc: 0.334 Test Loss: 2.509 Test Acc: 0.334
Validation loss decreased (-0.328443 --> -0.333714).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4462072
	speed: 0.4230s/iter; left time: 6146.5707s
Epoch: 6 cost time: 16.750234127044678
Epoch: 6, Steps: 154 | Train Loss: 1.891 Vali Loss: 2.555 Vali Acc: 0.340 Test Loss: 2.555 Test Acc: 0.340
Validation loss decreased (-0.333714 --> -0.340202).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6830955
	speed: 0.4571s/iter; left time: 6571.5368s
Epoch: 7 cost time: 16.921430110931396
Epoch: 7, Steps: 154 | Train Loss: 1.941 Vali Loss: 2.861 Vali Acc: 0.338 Test Loss: 2.861 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7574806
	speed: 0.4367s/iter; left time: 6210.6134s
Epoch: 8 cost time: 18.222659826278687
Epoch: 8, Steps: 154 | Train Loss: 1.929 Vali Loss: 3.029 Vali Acc: 0.057 Test Loss: 3.029 Test Acc: 0.057
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9049643
	speed: 0.4357s/iter; left time: 6129.3517s
Epoch: 9 cost time: 16.896692991256714
Epoch: 9, Steps: 154 | Train Loss: 1.858 Vali Loss: 2.954 Vali Acc: 0.352 Test Loss: 2.954 Test Acc: 0.352
Validation loss decreased (-0.340202 --> -0.351552).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3277186
	speed: 0.4235s/iter; left time: 5893.3417s
Epoch: 10 cost time: 16.414117574691772
Epoch: 10, Steps: 154 | Train Loss: 1.976 Vali Loss: 3.494 Vali Acc: 0.074 Test Loss: 3.494 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.1959193
	speed: 0.4887s/iter; left time: 6725.6623s
Epoch: 11 cost time: 20.086472749710083
Epoch: 11, Steps: 154 | Train Loss: 1.739 Vali Loss: 3.804 Vali Acc: 0.073 Test Loss: 3.804 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1082041
	speed: 0.4632s/iter; left time: 6302.2320s
Epoch: 12 cost time: 15.89052963256836
Epoch: 12, Steps: 154 | Train Loss: 2.063 Vali Loss: 3.525 Vali Acc: 0.356 Test Loss: 3.525 Test Acc: 0.356
Validation loss decreased (-0.351552 --> -0.356007).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.8050765
	speed: 0.4350s/iter; left time: 5851.9583s
Epoch: 13 cost time: 17.63755774497986
Epoch: 13, Steps: 154 | Train Loss: 1.891 Vali Loss: 3.739 Vali Acc: 0.088 Test Loss: 3.739 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4090455
	speed: 0.4568s/iter; left time: 6075.4571s
Epoch: 14 cost time: 16.445645809173584
Epoch: 14, Steps: 154 | Train Loss: 1.867 Vali Loss: 3.282 Vali Acc: 0.309 Test Loss: 3.282 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.4339554
	speed: 0.4323s/iter; left time: 5682.3380s
Epoch: 15 cost time: 17.2242431640625
Epoch: 15, Steps: 154 | Train Loss: 1.761 Vali Loss: 3.841 Vali Acc: 0.072 Test Loss: 3.841 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.5127041
	speed: 0.4605s/iter; left time: 5982.9805s
Epoch: 16 cost time: 17.62172031402588
Epoch: 16, Steps: 154 | Train Loss: 1.706 Vali Loss: 4.187 Vali Acc: 0.094 Test Loss: 4.187 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 5.9135289
	speed: 0.4650s/iter; left time: 5968.7796s
Epoch: 17 cost time: 18.633755922317505
Epoch: 17, Steps: 154 | Train Loss: 1.700 Vali Loss: 4.404 Vali Acc: 0.084 Test Loss: 4.404 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.9967654
	speed: 0.4447s/iter; left time: 5640.0824s
Epoch: 18 cost time: 15.846041440963745
Epoch: 18, Steps: 154 | Train Loss: 1.683 Vali Loss: 3.720 Vali Acc: 0.360 Test Loss: 3.720 Test Acc: 0.360
Validation loss decreased (-0.356007 --> -0.359655).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.4410552
	speed: 0.4417s/iter; left time: 5534.2669s
Epoch: 19 cost time: 17.65692710876465
Epoch: 19, Steps: 154 | Train Loss: 1.902 Vali Loss: 3.501 Vali Acc: 0.363 Test Loss: 3.501 Test Acc: 0.363
Validation loss decreased (-0.359655 --> -0.362495).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.9875552
	speed: 0.4622s/iter; left time: 5720.2510s
Epoch: 20 cost time: 18.69219183921814
Epoch: 20, Steps: 154 | Train Loss: 1.558 Vali Loss: 3.759 Vali Acc: 0.364 Test Loss: 3.759 Test Acc: 0.364
Validation loss decreased (-0.362495 --> -0.364115).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.5455109
	speed: 0.4540s/iter; left time: 5548.3224s
Epoch: 21 cost time: 17.281848192214966
Epoch: 21, Steps: 154 | Train Loss: 1.915 Vali Loss: 4.020 Vali Acc: 0.093 Test Loss: 4.020 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.6124371
	speed: 0.4723s/iter; left time: 5698.8827s
Epoch: 22 cost time: 17.519176244735718
Epoch: 22, Steps: 154 | Train Loss: 1.749 Vali Loss: 4.710 Vali Acc: 0.081 Test Loss: 4.710 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.4153222
	speed: 0.4667s/iter; left time: 5559.2529s
Epoch: 23 cost time: 18.07719111442566
Epoch: 23, Steps: 154 | Train Loss: 1.530 Vali Loss: 4.320 Vali Acc: 0.384 Test Loss: 4.320 Test Acc: 0.384
Validation loss decreased (-0.364115 --> -0.384385).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.2509131
	speed: 0.4242s/iter; left time: 4988.6478s
Epoch: 24 cost time: 16.316662073135376
Epoch: 24, Steps: 154 | Train Loss: 1.728 Vali Loss: 4.388 Vali Acc: 0.090 Test Loss: 4.388 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.6610977
	speed: 0.4454s/iter; left time: 5169.3251s
Epoch: 25 cost time: 17.052799940109253
Epoch: 25, Steps: 154 | Train Loss: 1.427 Vali Loss: 4.239 Vali Acc: 0.294 Test Loss: 4.239 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.8649931
	speed: 0.4490s/iter; left time: 5141.5225s
Epoch: 26 cost time: 17.824438095092773
Epoch: 26, Steps: 154 | Train Loss: 1.470 Vali Loss: 4.404 Vali Acc: 0.376 Test Loss: 4.404 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.2955451
	speed: 0.4586s/iter; left time: 5181.1031s
Epoch: 27 cost time: 14.42637038230896
Epoch: 27, Steps: 154 | Train Loss: 1.513 Vali Loss: 4.478 Vali Acc: 0.189 Test Loss: 4.478 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.1636119
	speed: 0.4208s/iter; left time: 4689.1402s
Epoch: 28 cost time: 16.903068780899048
Epoch: 28, Steps: 154 | Train Loss: 1.387 Vali Loss: 4.666 Vali Acc: 0.214 Test Loss: 4.666 Test Acc: 0.214
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.9451467
	speed: 0.4023s/iter; left time: 4420.8088s
Epoch: 29 cost time: 16.058533906936646
Epoch: 29, Steps: 154 | Train Loss: 1.679 Vali Loss: 4.742 Vali Acc: 0.090 Test Loss: 4.742 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 1.3020329
	speed: 0.4392s/iter; left time: 4758.9020s
Epoch: 30 cost time: 17.01494860649109
Epoch: 30, Steps: 154 | Train Loss: 1.446 Vali Loss: 5.688 Vali Acc: 0.090 Test Loss: 5.688 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 1.0420185
	speed: 0.4316s/iter; left time: 4609.8902s
Epoch: 31 cost time: 17.10944128036499
Epoch: 31, Steps: 154 | Train Loss: 1.315 Vali Loss: 5.615 Vali Acc: 0.083 Test Loss: 5.615 Test Acc: 0.083
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 1.0293167
	speed: 0.4444s/iter; left time: 4677.8668s
Epoch: 32 cost time: 17.80711579322815
Epoch: 32, Steps: 154 | Train Loss: 1.539 Vali Loss: 5.318 Vali Acc: 0.107 Test Loss: 5.318 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 1.3913660
	speed: 0.4408s/iter; left time: 4572.3870s
Epoch: 33 cost time: 16.70849585533142
Epoch: 33, Steps: 154 | Train Loss: 1.346 Vali Loss: 5.070 Vali Acc: 0.384 Test Loss: 5.070 Test Acc: 0.384
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3844282238442822
model parameter : 2387038
model size : 18.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0363295
	speed: 0.1173s/iter; left time: 1794.5561s
Epoch: 1 cost time: 16.069822072982788
Epoch: 1, Steps: 154 | Train Loss: 2.268 Vali Loss: 2.214 Vali Acc: 0.323 Test Loss: 2.214 Test Acc: 0.323
Validation loss decreased (inf --> -0.322768).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9388247
	speed: 0.3832s/iter; left time: 5805.0855s
Epoch: 2 cost time: 14.533691167831421
Epoch: 2, Steps: 154 | Train Loss: 2.107 Vali Loss: 2.327 Vali Acc: 0.325 Test Loss: 2.327 Test Acc: 0.325
Validation loss decreased (-0.322768 --> -0.324794).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8559402
	speed: 0.3712s/iter; left time: 5565.3778s
Epoch: 3 cost time: 14.955663204193115
Epoch: 3, Steps: 154 | Train Loss: 2.039 Vali Loss: 2.367 Vali Acc: 0.333 Test Loss: 2.367 Test Acc: 0.333
Validation loss decreased (-0.324794 --> -0.333310).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3521292
	speed: 0.3950s/iter; left time: 5860.6696s
Epoch: 4 cost time: 15.441863059997559
Epoch: 4, Steps: 154 | Train Loss: 1.999 Vali Loss: 2.366 Vali Acc: 0.336 Test Loss: 2.366 Test Acc: 0.336
Validation loss decreased (-0.333310 --> -0.335743).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7175012
	speed: 0.3908s/iter; left time: 5739.2176s
Epoch: 5 cost time: 13.824957370758057
Epoch: 5, Steps: 154 | Train Loss: 1.903 Vali Loss: 2.541 Vali Acc: 0.335 Test Loss: 2.541 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5146519
	speed: 0.4677s/iter; left time: 6796.2212s
Epoch: 6 cost time: 18.0923969745636
Epoch: 6, Steps: 154 | Train Loss: 1.996 Vali Loss: 2.664 Vali Acc: 0.079 Test Loss: 2.664 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.6275871
	speed: 0.4663s/iter; left time: 6704.0124s
Epoch: 7 cost time: 18.890092134475708
Epoch: 7, Steps: 154 | Train Loss: 1.903 Vali Loss: 2.812 Vali Acc: 0.343 Test Loss: 2.812 Test Acc: 0.343
Validation loss decreased (-0.335743 --> -0.343038).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8946474
	speed: 0.4445s/iter; left time: 6322.0809s
Epoch: 8 cost time: 15.591158390045166
Epoch: 8, Steps: 154 | Train Loss: 1.865 Vali Loss: 2.850 Vali Acc: 0.184 Test Loss: 2.850 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.1105754
	speed: 0.3884s/iter; left time: 5463.8133s
Epoch: 9 cost time: 15.379542827606201
Epoch: 9, Steps: 154 | Train Loss: 1.820 Vali Loss: 2.786 Vali Acc: 0.352 Test Loss: 2.786 Test Acc: 0.352
Validation loss decreased (-0.343038 --> -0.352365).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8462447
	speed: 0.3721s/iter; left time: 5178.3123s
Epoch: 10 cost time: 13.555366516113281
Epoch: 10, Steps: 154 | Train Loss: 1.883 Vali Loss: 2.689 Vali Acc: 0.359 Test Loss: 2.689 Test Acc: 0.359
Validation loss decreased (-0.352365 --> -0.359259).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6798892
	speed: 0.3914s/iter; left time: 5386.1284s
Epoch: 11 cost time: 15.40258240699768
Epoch: 11, Steps: 154 | Train Loss: 1.667 Vali Loss: 3.189 Vali Acc: 0.107 Test Loss: 3.189 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1735299
	speed: 0.4294s/iter; left time: 5843.4537s
Epoch: 12 cost time: 16.459025382995605
Epoch: 12, Steps: 154 | Train Loss: 1.792 Vali Loss: 3.164 Vali Acc: 0.363 Test Loss: 3.164 Test Acc: 0.363
Validation loss decreased (-0.359259 --> -0.362904).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6425712
	speed: 0.4401s/iter; left time: 5920.0561s
Epoch: 13 cost time: 15.410502433776855
Epoch: 13, Steps: 154 | Train Loss: 1.760 Vali Loss: 3.674 Vali Acc: 0.065 Test Loss: 3.674 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.2235593
	speed: 0.3863s/iter; left time: 5137.5001s
Epoch: 14 cost time: 13.718571662902832
Epoch: 14, Steps: 154 | Train Loss: 1.905 Vali Loss: 3.971 Vali Acc: 0.070 Test Loss: 3.971 Test Acc: 0.070
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3436850
	speed: 0.4184s/iter; left time: 5500.1311s
Epoch: 15 cost time: 17.631802082061768
Epoch: 15, Steps: 154 | Train Loss: 2.313 Vali Loss: 3.521 Vali Acc: 0.094 Test Loss: 3.521 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.5280472
	speed: 0.4028s/iter; left time: 5232.3552s
Epoch: 16 cost time: 14.343088626861572
Epoch: 16, Steps: 154 | Train Loss: 1.824 Vali Loss: 3.690 Vali Acc: 0.076 Test Loss: 3.690 Test Acc: 0.076
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.7968930
	speed: 0.4040s/iter; left time: 5185.9319s
Epoch: 17 cost time: 14.932590246200562
Epoch: 17, Steps: 154 | Train Loss: 1.649 Vali Loss: 4.406 Vali Acc: 0.088 Test Loss: 4.406 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.7415254
	speed: 0.4002s/iter; left time: 5075.5567s
Epoch: 18 cost time: 17.043251752853394
Epoch: 18, Steps: 154 | Train Loss: 1.820 Vali Loss: 3.391 Vali Acc: 0.366 Test Loss: 3.391 Test Acc: 0.366
Validation loss decreased (-0.362904 --> -0.365741).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.5992223
	speed: 0.4112s/iter; left time: 5151.5567s
Epoch: 19 cost time: 14.37801194190979
Epoch: 19, Steps: 154 | Train Loss: 1.695 Vali Loss: 4.551 Vali Acc: 0.256 Test Loss: 4.551 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.8977181
	speed: 0.4046s/iter; left time: 5007.3390s
Epoch: 20 cost time: 15.822087526321411
Epoch: 20, Steps: 154 | Train Loss: 1.863 Vali Loss: 3.917 Vali Acc: 0.102 Test Loss: 3.917 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.2523257
	speed: 0.4000s/iter; left time: 4888.3569s
Epoch: 21 cost time: 14.49063515663147
Epoch: 21, Steps: 154 | Train Loss: 1.687 Vali Loss: 4.438 Vali Acc: 0.084 Test Loss: 4.438 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.8482035
	speed: 0.4116s/iter; left time: 4966.9459s
Epoch: 22 cost time: 15.563429594039917
Epoch: 22, Steps: 154 | Train Loss: 1.613 Vali Loss: 4.056 Vali Acc: 0.088 Test Loss: 4.056 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.3113801
	speed: 0.3991s/iter; left time: 4754.1034s
Epoch: 23 cost time: 15.190401077270508
Epoch: 23, Steps: 154 | Train Loss: 1.423 Vali Loss: 3.633 Vali Acc: 0.374 Test Loss: 3.633 Test Acc: 0.374
Validation loss decreased (-0.365741 --> -0.374254).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.0501537
	speed: 0.4096s/iter; left time: 4816.6551s
Epoch: 24 cost time: 15.356387615203857
Epoch: 24, Steps: 154 | Train Loss: 1.426 Vali Loss: 5.090 Vali Acc: 0.070 Test Loss: 5.090 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.5874501
	speed: 0.4127s/iter; left time: 4789.4865s
Epoch: 25 cost time: 14.25061559677124
Epoch: 25, Steps: 154 | Train Loss: 1.518 Vali Loss: 4.246 Vali Acc: 0.373 Test Loss: 4.246 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.5368927
	speed: 0.4091s/iter; left time: 4684.1189s
Epoch: 26 cost time: 17.734212160110474
Epoch: 26, Steps: 154 | Train Loss: 1.503 Vali Loss: 5.056 Vali Acc: 0.075 Test Loss: 5.056 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.7368145
	speed: 0.4020s/iter; left time: 4541.2934s
Epoch: 27 cost time: 15.971962451934814
Epoch: 27, Steps: 154 | Train Loss: 1.985 Vali Loss: 5.998 Vali Acc: 0.088 Test Loss: 5.998 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.7956330
	speed: 0.4383s/iter; left time: 4884.4943s
Epoch: 28 cost time: 17.08749222755432
Epoch: 28, Steps: 154 | Train Loss: 1.385 Vali Loss: 4.323 Vali Acc: 0.353 Test Loss: 4.323 Test Acc: 0.353
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.9069268
	speed: 0.4501s/iter; left time: 4946.5386s
Epoch: 29 cost time: 17.539969444274902
Epoch: 29, Steps: 154 | Train Loss: 1.328 Vali Loss: 4.809 Vali Acc: 0.137 Test Loss: 4.809 Test Acc: 0.137
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 1.2937140
	speed: 0.4489s/iter; left time: 4864.2784s
Epoch: 30 cost time: 15.824342250823975
Epoch: 30, Steps: 154 | Train Loss: 1.451 Vali Loss: 4.639 Vali Acc: 0.383 Test Loss: 4.639 Test Acc: 0.383
Validation loss decreased (-0.374254 --> -0.383165).  Saving model ...
	iters: 100, epoch: 31 | loss: 1.0565760
	speed: 0.4237s/iter; left time: 4525.7831s
Epoch: 31 cost time: 16.153773069381714
Epoch: 31, Steps: 154 | Train Loss: 1.305 Vali Loss: 4.508 Vali Acc: 0.334 Test Loss: 4.508 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.6423252
	speed: 0.4442s/iter; left time: 4675.6738s
Epoch: 32 cost time: 17.620821237564087
Epoch: 32, Steps: 154 | Train Loss: 1.697 Vali Loss: 5.056 Vali Acc: 0.087 Test Loss: 5.056 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 1.6171319
	speed: 0.3956s/iter; left time: 4103.8431s
Epoch: 33 cost time: 14.876608610153198
Epoch: 33, Steps: 154 | Train Loss: 1.327 Vali Loss: 4.666 Vali Acc: 0.381 Test Loss: 4.666 Test Acc: 0.381
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 1.0906819
	speed: 0.4340s/iter; left time: 4434.5759s
Epoch: 34 cost time: 15.661922216415405
Epoch: 34, Steps: 154 | Train Loss: 1.367 Vali Loss: 4.973 Vali Acc: 0.172 Test Loss: 4.973 Test Acc: 0.172
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 2.6957784
	speed: 0.4399s/iter; left time: 4427.2447s
Epoch: 35 cost time: 17.916250467300415
Epoch: 35, Steps: 154 | Train Loss: 1.195 Vali Loss: 4.778 Vali Acc: 0.389 Test Loss: 4.778 Test Acc: 0.389
Validation loss decreased (-0.383165 --> -0.388841).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.6610692
	speed: 0.4191s/iter; left time: 4153.8130s
Epoch: 36 cost time: 16.29280138015747
Epoch: 36, Steps: 154 | Train Loss: 1.218 Vali Loss: 4.402 Vali Acc: 0.152 Test Loss: 4.402 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 1.3362069
	speed: 0.4140s/iter; left time: 4039.8727s
Epoch: 37 cost time: 16.391621112823486
Epoch: 37, Steps: 154 | Train Loss: 2.074 Vali Loss: 6.176 Vali Acc: 0.100 Test Loss: 6.176 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 2.2084985
	speed: 0.4026s/iter; left time: 3865.7791s
Epoch: 38 cost time: 14.07639193534851
Epoch: 38, Steps: 154 | Train Loss: 1.829 Vali Loss: 5.870 Vali Acc: 0.388 Test Loss: 5.870 Test Acc: 0.388
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 1.0965952
	speed: 0.4150s/iter; left time: 3921.7533s
Epoch: 39 cost time: 15.797762632369995
Epoch: 39, Steps: 154 | Train Loss: 1.039 Vali Loss: 7.290 Vali Acc: 0.102 Test Loss: 7.290 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.2769281
	speed: 0.3935s/iter; left time: 3657.2774s
Epoch: 40 cost time: 15.635404109954834
Epoch: 40, Steps: 154 | Train Loss: 1.035 Vali Loss: 5.735 Vali Acc: 0.395 Test Loss: 5.735 Test Acc: 0.395
Validation loss decreased (-0.388841 --> -0.395320).  Saving model ...
	iters: 100, epoch: 41 | loss: 1.3785453
	speed: 0.4342s/iter; left time: 3968.7679s
Epoch: 41 cost time: 15.705538272857666
Epoch: 41, Steps: 154 | Train Loss: 1.109 Vali Loss: 5.991 Vali Acc: 0.210 Test Loss: 5.991 Test Acc: 0.210
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.6958135
	speed: 0.4101s/iter; left time: 3685.9865s
Epoch: 42 cost time: 15.968021869659424
Epoch: 42, Steps: 154 | Train Loss: 1.001 Vali Loss: 6.141 Vali Acc: 0.297 Test Loss: 6.141 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 1.0473528
	speed: 0.4090s/iter; left time: 3612.6432s
Epoch: 43 cost time: 16.61107039451599
Epoch: 43, Steps: 154 | Train Loss: 1.339 Vali Loss: 5.587 Vali Acc: 0.380 Test Loss: 5.587 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 1.2043651
	speed: 0.4124s/iter; left time: 3579.0338s
Epoch: 44 cost time: 15.350269317626953
Epoch: 44, Steps: 154 | Train Loss: 1.011 Vali Loss: 5.718 Vali Acc: 0.372 Test Loss: 5.718 Test Acc: 0.372
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 1.3717759
	speed: 0.4437s/iter; left time: 3782.6666s
Epoch: 45 cost time: 18.250410795211792
Epoch: 45, Steps: 154 | Train Loss: 0.966 Vali Loss: 6.968 Vali Acc: 0.295 Test Loss: 6.968 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.7847904
	speed: 0.4266s/iter; left time: 3570.7030s
Epoch: 46 cost time: 17.0765597820282
Epoch: 46, Steps: 154 | Train Loss: 4.039 Vali Loss: 6.836 Vali Acc: 0.292 Test Loss: 6.836 Test Acc: 0.292
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.4867082
	speed: 0.4313s/iter; left time: 3543.8504s
Epoch: 47 cost time: 15.602542161941528
Epoch: 47, Steps: 154 | Train Loss: 0.968 Vali Loss: 8.420 Vali Acc: 0.386 Test Loss: 8.420 Test Acc: 0.386
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.6293080
	speed: 0.4247s/iter; left time: 3424.6648s
Epoch: 48 cost time: 17.136646270751953
Epoch: 48, Steps: 154 | Train Loss: 1.017 Vali Loss: 6.788 Vali Acc: 0.378 Test Loss: 6.788 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.6531886
	speed: 0.4191s/iter; left time: 3314.4213s
Epoch: 49 cost time: 15.141627311706543
Epoch: 49, Steps: 154 | Train Loss: 0.944 Vali Loss: 6.393 Vali Acc: 0.243 Test Loss: 6.393 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 1.0555112
	speed: 0.4298s/iter; left time: 3333.2671s
Epoch: 50 cost time: 16.96984839439392
Epoch: 50, Steps: 154 | Train Loss: 0.876 Vali Loss: 7.455 Vali Acc: 0.381 Test Loss: 7.455 Test Acc: 0.381
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3953771289537713
model parameter : 2387038
model size : 18.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0139313
	speed: 0.1310s/iter; left time: 2004.8920s
Epoch: 1 cost time: 18.511515617370605
Epoch: 1, Steps: 154 | Train Loss: 2.252 Vali Loss: 2.209 Vali Acc: 0.324 Test Loss: 2.209 Test Acc: 0.324
Validation loss decreased (inf --> -0.323984).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9611344
	speed: 0.4087s/iter; left time: 6190.6914s
Epoch: 2 cost time: 15.567382097244263
Epoch: 2, Steps: 154 | Train Loss: 2.066 Vali Loss: 2.302 Vali Acc: 0.327 Test Loss: 2.302 Test Acc: 0.327
Validation loss decreased (-0.323984 --> -0.327228).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8652472
	speed: 0.3930s/iter; left time: 5892.1926s
Epoch: 3 cost time: 15.847772121429443
Epoch: 3, Steps: 154 | Train Loss: 2.003 Vali Loss: 2.384 Vali Acc: 0.180 Test Loss: 2.384 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.4154630
	speed: 0.4201s/iter; left time: 6233.6151s
Epoch: 4 cost time: 16.865933895111084
Epoch: 4, Steps: 154 | Train Loss: 1.889 Vali Loss: 2.432 Vali Acc: 0.338 Test Loss: 2.432 Test Acc: 0.338
Validation loss decreased (-0.327228 --> -0.337770).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8772172
	speed: 0.4289s/iter; left time: 6298.9664s
Epoch: 5 cost time: 15.973402261734009
Epoch: 5, Steps: 154 | Train Loss: 1.950 Vali Loss: 2.517 Vali Acc: 0.342 Test Loss: 2.517 Test Acc: 0.342
Validation loss decreased (-0.337770 --> -0.341824).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5035298
	speed: 0.4396s/iter; left time: 6388.0281s
Epoch: 6 cost time: 15.419182777404785
Epoch: 6, Steps: 154 | Train Loss: 1.950 Vali Loss: 2.633 Vali Acc: 0.347 Test Loss: 2.633 Test Acc: 0.347
Validation loss decreased (-0.341824 --> -0.346689).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3505211
	speed: 0.4225s/iter; left time: 6073.5944s
Epoch: 7 cost time: 15.707901000976562
Epoch: 7, Steps: 154 | Train Loss: 1.864 Vali Loss: 2.882 Vali Acc: 0.350 Test Loss: 2.882 Test Acc: 0.350
Validation loss decreased (-0.346689 --> -0.349525).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4719597
	speed: 0.4016s/iter; left time: 5711.6482s
Epoch: 8 cost time: 15.38216757774353
Epoch: 8, Steps: 154 | Train Loss: 1.842 Vali Loss: 2.694 Vali Acc: 0.364 Test Loss: 2.694 Test Acc: 0.364
Validation loss decreased (-0.349525 --> -0.363720).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9254187
	speed: 0.4221s/iter; left time: 5938.5463s
Epoch: 9 cost time: 16.804583311080933
Epoch: 9, Steps: 154 | Train Loss: 1.752 Vali Loss: 3.002 Vali Acc: 0.345 Test Loss: 3.002 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5700197
	speed: 0.4208s/iter; left time: 5855.9484s
Epoch: 10 cost time: 15.775490283966064
Epoch: 10, Steps: 154 | Train Loss: 1.682 Vali Loss: 3.023 Vali Acc: 0.193 Test Loss: 3.023 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.0791447
	speed: 0.4366s/iter; left time: 6008.7360s
Epoch: 11 cost time: 15.31706428527832
Epoch: 11, Steps: 154 | Train Loss: 1.704 Vali Loss: 2.715 Vali Acc: 0.373 Test Loss: 2.715 Test Acc: 0.373
Validation loss decreased (-0.363720 --> -0.373452).  Saving model ...
	iters: 100, epoch: 12 | loss: 3.7426167
	speed: 0.4118s/iter; left time: 5603.9887s
Epoch: 12 cost time: 16.7964084148407
Epoch: 12, Steps: 154 | Train Loss: 1.827 Vali Loss: 3.013 Vali Acc: 0.369 Test Loss: 3.013 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5022720
	speed: 0.4101s/iter; left time: 5516.9209s
Epoch: 13 cost time: 14.588302850723267
Epoch: 13, Steps: 154 | Train Loss: 1.799 Vali Loss: 3.193 Vali Acc: 0.112 Test Loss: 3.193 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.0623598
	speed: 0.4328s/iter; left time: 5755.1846s
Epoch: 14 cost time: 17.699645519256592
Epoch: 14, Steps: 154 | Train Loss: 1.717 Vali Loss: 3.651 Vali Acc: 0.084 Test Loss: 3.651 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.4555563
	speed: 0.4175s/iter; left time: 5487.8177s
Epoch: 15 cost time: 16.247152090072632
Epoch: 15, Steps: 154 | Train Loss: 1.595 Vali Loss: 3.740 Vali Acc: 0.118 Test Loss: 3.740 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 2.0716345
	speed: 0.4251s/iter; left time: 5522.0288s
Epoch: 16 cost time: 15.531905174255371
Epoch: 16, Steps: 154 | Train Loss: 1.542 Vali Loss: 3.490 Vali Acc: 0.358 Test Loss: 3.490 Test Acc: 0.358
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.9603950
	speed: 0.4465s/iter; left time: 5731.9660s
Epoch: 17 cost time: 16.77225637435913
Epoch: 17, Steps: 154 | Train Loss: 1.827 Vali Loss: 3.720 Vali Acc: 0.100 Test Loss: 3.720 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.1211514
	speed: 0.3763s/iter; left time: 4772.1475s
Epoch: 18 cost time: 15.824392795562744
Epoch: 18, Steps: 154 | Train Loss: 1.772 Vali Loss: 3.515 Vali Acc: 0.377 Test Loss: 3.515 Test Acc: 0.377
Validation loss decreased (-0.373452 --> -0.377094).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.3126631
	speed: 0.4070s/iter; left time: 5099.5362s
Epoch: 19 cost time: 15.007859706878662
Epoch: 19, Steps: 154 | Train Loss: 1.527 Vali Loss: 4.413 Vali Acc: 0.092 Test Loss: 4.413 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.7650104
	speed: 0.4041s/iter; left time: 5000.5248s
Epoch: 20 cost time: 15.259314060211182
Epoch: 20, Steps: 154 | Train Loss: 2.050 Vali Loss: 4.569 Vali Acc: 0.104 Test Loss: 4.569 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.3203502
	speed: 0.4213s/iter; left time: 5148.1337s
Epoch: 21 cost time: 16.848193883895874
Epoch: 21, Steps: 154 | Train Loss: 1.396 Vali Loss: 4.869 Vali Acc: 0.094 Test Loss: 4.869 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.5847977
	speed: 0.4206s/iter; left time: 5074.9800s
Epoch: 22 cost time: 15.491718769073486
Epoch: 22, Steps: 154 | Train Loss: 1.481 Vali Loss: 4.397 Vali Acc: 0.099 Test Loss: 4.397 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.2308494
	speed: 0.4345s/iter; left time: 5175.6226s
Epoch: 23 cost time: 16.98314929008484
Epoch: 23, Steps: 154 | Train Loss: 1.387 Vali Loss: 4.198 Vali Acc: 0.264 Test Loss: 4.198 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.8779312
	speed: 0.4056s/iter; left time: 4769.4125s
Epoch: 24 cost time: 16.032185554504395
Epoch: 24, Steps: 154 | Train Loss: 1.280 Vali Loss: 5.180 Vali Acc: 0.090 Test Loss: 5.180 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.6314801
	speed: 0.4259s/iter; left time: 4942.2862s
Epoch: 25 cost time: 14.756035804748535
Epoch: 25, Steps: 154 | Train Loss: 1.666 Vali Loss: 4.263 Vali Acc: 0.235 Test Loss: 4.263 Test Acc: 0.235
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.6815264
	speed: 0.4133s/iter; left time: 4732.3714s
Epoch: 26 cost time: 18.00086236000061
Epoch: 26, Steps: 154 | Train Loss: 1.703 Vali Loss: 4.569 Vali Acc: 0.152 Test Loss: 4.569 Test Acc: 0.152
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.9703748
	speed: 0.4358s/iter; left time: 4922.9700s
Epoch: 27 cost time: 15.089863061904907
Epoch: 27, Steps: 154 | Train Loss: 1.473 Vali Loss: 5.276 Vali Acc: 0.112 Test Loss: 5.276 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.0999671
	speed: 0.4198s/iter; left time: 4678.3115s
Epoch: 28 cost time: 14.957444190979004
Epoch: 28, Steps: 154 | Train Loss: 1.295 Vali Loss: 6.078 Vali Acc: 0.094 Test Loss: 6.078 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3771289537712895
model parameter : 2387038
model size : 18.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0045850
	speed: 0.0477s/iter; left time: 729.6188s
Epoch: 1 cost time: 6.740740776062012
Epoch: 1, Steps: 154 | Train Loss: 2.198 Vali Loss: 2.204 Vali Acc: 0.324 Test Loss: 2.204 Test Acc: 0.324
Validation loss decreased (inf --> -0.323984).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8537519
	speed: 0.1161s/iter; left time: 1758.6330s
Epoch: 2 cost time: 5.837433099746704
Epoch: 2, Steps: 154 | Train Loss: 2.016 Vali Loss: 2.326 Vali Acc: 0.329 Test Loss: 2.326 Test Acc: 0.329
Validation loss decreased (-0.323984 --> -0.329255).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8541213
	speed: 5.4154s/iter; left time: 81192.6651s
Epoch: 3 cost time: 5.450516700744629
Epoch: 3, Steps: 154 | Train Loss: 1.933 Vali Loss: 2.456 Vali Acc: 0.322 Test Loss: 2.456 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.3692646
	speed: 0.1038s/iter; left time: 1539.6687s
Epoch: 4 cost time: 5.277552604675293
Epoch: 4, Steps: 154 | Train Loss: 1.856 Vali Loss: 2.620 Vali Acc: 0.337 Test Loss: 2.620 Test Acc: 0.337
Validation loss decreased (-0.329255 --> -0.336957).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8652347
	speed: 4.7741s/iter; left time: 70108.0683s
Epoch: 5 cost time: 6.359904766082764
Epoch: 5, Steps: 154 | Train Loss: 1.701 Vali Loss: 2.635 Vali Acc: 0.252 Test Loss: 2.635 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7045817
	speed: 0.1181s/iter; left time: 1715.5439s
Epoch: 6 cost time: 5.666544437408447
Epoch: 6, Steps: 154 | Train Loss: 1.774 Vali Loss: 2.577 Vali Acc: 0.364 Test Loss: 2.577 Test Acc: 0.364
Validation loss decreased (-0.336957 --> -0.364127).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4321094
	speed: 2.9954s/iter; left time: 43065.5066s
Epoch: 7 cost time: 7.9387476444244385
Epoch: 7, Steps: 154 | Train Loss: 1.827 Vali Loss: 2.931 Vali Acc: 0.347 Test Loss: 2.931 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5217949
	speed: 0.1608s/iter; left time: 2287.1190s
Epoch: 8 cost time: 7.376568794250488
Epoch: 8, Steps: 154 | Train Loss: 1.731 Vali Loss: 3.020 Vali Acc: 0.357 Test Loss: 3.020 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.0333054
	speed: 0.2664s/iter; left time: 3748.1853s
Epoch: 9 cost time: 7.0747389793396
Epoch: 9, Steps: 154 | Train Loss: 1.656 Vali Loss: 3.022 Vali Acc: 0.358 Test Loss: 3.022 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4569674
	speed: 0.1778s/iter; left time: 2473.4051s
Epoch: 10 cost time: 5.702786445617676
Epoch: 10, Steps: 154 | Train Loss: 1.656 Vali Loss: 3.186 Vali Acc: 0.357 Test Loss: 3.186 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 8.4974546
	speed: 0.1311s/iter; left time: 1804.0136s
Epoch: 11 cost time: 5.980350017547607
Epoch: 11, Steps: 154 | Train Loss: 1.891 Vali Loss: 2.928 Vali Acc: 0.095 Test Loss: 2.928 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.3946247
	speed: 0.1844s/iter; left time: 2509.6058s
Epoch: 12 cost time: 6.672727584838867
Epoch: 12, Steps: 154 | Train Loss: 1.639 Vali Loss: 3.085 Vali Acc: 0.374 Test Loss: 3.085 Test Acc: 0.374
Validation loss decreased (-0.364127 --> -0.374259).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0409476
	speed: 0.4649s/iter; left time: 6254.8718s
Epoch: 13 cost time: 14.868598222732544
Epoch: 13, Steps: 154 | Train Loss: 1.888 Vali Loss: 3.001 Vali Acc: 0.371 Test Loss: 3.001 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4094235
	speed: 0.4417s/iter; left time: 5874.2739s
Epoch: 14 cost time: 16.32136058807373
Epoch: 14, Steps: 154 | Train Loss: 1.645 Vali Loss: 3.679 Vali Acc: 0.092 Test Loss: 3.679 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.5463200
	speed: 0.4430s/iter; left time: 5823.4269s
Epoch: 15 cost time: 15.490307569503784
Epoch: 15, Steps: 154 | Train Loss: 1.566 Vali Loss: 3.777 Vali Acc: 0.116 Test Loss: 3.777 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.4373498
	speed: 0.4446s/iter; left time: 5775.3836s
Epoch: 16 cost time: 16.538270950317383
Epoch: 16, Steps: 154 | Train Loss: 1.664 Vali Loss: 3.333 Vali Acc: 0.098 Test Loss: 3.333 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.8962079
	speed: 0.4381s/iter; left time: 5623.8146s
Epoch: 17 cost time: 15.30832314491272
Epoch: 17, Steps: 154 | Train Loss: 1.615 Vali Loss: 3.978 Vali Acc: 0.376 Test Loss: 3.978 Test Acc: 0.376
Validation loss decreased (-0.374259 --> -0.376278).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.2460883
	speed: 0.4598s/iter; left time: 5831.9655s
Epoch: 18 cost time: 16.16348648071289
Epoch: 18, Steps: 154 | Train Loss: 1.635 Vali Loss: 3.283 Vali Acc: 0.362 Test Loss: 3.283 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.1462243
	speed: 0.4212s/iter; left time: 5277.4455s
Epoch: 19 cost time: 14.195334196090698
Epoch: 19, Steps: 154 | Train Loss: 1.549 Vali Loss: 3.359 Vali Acc: 0.376 Test Loss: 3.359 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.7200952
	speed: 0.3893s/iter; left time: 4817.7052s
Epoch: 20 cost time: 13.671974182128906
Epoch: 20, Steps: 154 | Train Loss: 1.456 Vali Loss: 3.379 Vali Acc: 0.368 Test Loss: 3.379 Test Acc: 0.368
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.5989945
	speed: 0.3883s/iter; left time: 4745.6749s
Epoch: 21 cost time: 13.67284107208252
Epoch: 21, Steps: 154 | Train Loss: 1.486 Vali Loss: 5.586 Vali Acc: 0.114 Test Loss: 5.586 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.5644022
	speed: 0.3597s/iter; left time: 4340.9501s
Epoch: 22 cost time: 12.348502397537231
Epoch: 22, Steps: 154 | Train Loss: 1.557 Vali Loss: 3.744 Vali Acc: 0.382 Test Loss: 3.744 Test Acc: 0.382
Validation loss decreased (-0.376278 --> -0.381958).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.1653739
	speed: 0.4173s/iter; left time: 4970.8103s
Epoch: 23 cost time: 15.125890254974365
Epoch: 23, Steps: 154 | Train Loss: 1.901 Vali Loss: 4.083 Vali Acc: 0.218 Test Loss: 4.083 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.4375386
	speed: 0.3509s/iter; left time: 4125.8307s
Epoch: 24 cost time: 6.40057635307312
Epoch: 24, Steps: 154 | Train Loss: 1.521 Vali Loss: 4.744 Vali Acc: 0.320 Test Loss: 4.744 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.5984727
	speed: 0.2602s/iter; left time: 3019.8344s
Epoch: 25 cost time: 7.537931680679321
Epoch: 25, Steps: 154 | Train Loss: 1.513 Vali Loss: 4.373 Vali Acc: 0.395 Test Loss: 4.373 Test Acc: 0.395
Validation loss decreased (-0.381958 --> -0.395333).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.5835032
	speed: 0.3768s/iter; left time: 4314.8986s
Epoch: 26 cost time: 12.848819971084595
Epoch: 26, Steps: 154 | Train Loss: 1.696 Vali Loss: 4.479 Vali Acc: 0.377 Test Loss: 4.479 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.6266372
	speed: 0.3303s/iter; left time: 3731.3390s
Epoch: 27 cost time: 14.761239290237427
Epoch: 27, Steps: 154 | Train Loss: 1.290 Vali Loss: 4.622 Vali Acc: 0.152 Test Loss: 4.622 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.7185584
	speed: 0.4182s/iter; left time: 4659.8425s
Epoch: 28 cost time: 16.81963801383972
Epoch: 28, Steps: 154 | Train Loss: 1.161 Vali Loss: 4.592 Vali Acc: 0.382 Test Loss: 4.592 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.5725108
	speed: 0.4417s/iter; left time: 4853.9545s
Epoch: 29 cost time: 14.153407096862793
Epoch: 29, Steps: 154 | Train Loss: 1.231 Vali Loss: 5.316 Vali Acc: 0.119 Test Loss: 5.316 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.2131861
	speed: 0.4052s/iter; left time: 4390.6449s
Epoch: 30 cost time: 14.614114046096802
Epoch: 30, Steps: 154 | Train Loss: 1.250 Vali Loss: 5.041 Vali Acc: 0.396 Test Loss: 5.041 Test Acc: 0.396
Validation loss decreased (-0.395333 --> -0.395732).  Saving model ...
	iters: 100, epoch: 31 | loss: 1.1954123
	speed: 0.3877s/iter; left time: 4141.0853s
Epoch: 31 cost time: 13.857565641403198
Epoch: 31, Steps: 154 | Train Loss: 1.524 Vali Loss: 5.525 Vali Acc: 0.205 Test Loss: 5.525 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.8100035
	speed: 0.3981s/iter; left time: 4190.6597s
Epoch: 32 cost time: 13.947196960449219
Epoch: 32, Steps: 154 | Train Loss: 1.494 Vali Loss: 6.468 Vali Acc: 0.112 Test Loss: 6.468 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 1.0809529
	speed: 0.3765s/iter; left time: 3905.7481s
Epoch: 33 cost time: 13.937479734420776
Epoch: 33, Steps: 154 | Train Loss: 1.087 Vali Loss: 5.773 Vali Acc: 0.167 Test Loss: 5.773 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 1.0705564
	speed: 0.3607s/iter; left time: 3686.2881s
Epoch: 34 cost time: 11.972474813461304
Epoch: 34, Steps: 154 | Train Loss: 1.071 Vali Loss: 5.328 Vali Acc: 0.236 Test Loss: 5.328 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 1.0642040
	speed: 0.3663s/iter; left time: 3686.9650s
Epoch: 35 cost time: 14.686699628829956
Epoch: 35, Steps: 154 | Train Loss: 1.410 Vali Loss: 6.052 Vali Acc: 0.404 Test Loss: 6.052 Test Acc: 0.404
Validation loss decreased (-0.395732 --> -0.404238).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.5883668
	speed: 0.3460s/iter; left time: 3428.7460s
Epoch: 36 cost time: 11.390914678573608
Epoch: 36, Steps: 154 | Train Loss: 1.573 Vali Loss: 5.631 Vali Acc: 0.387 Test Loss: 5.631 Test Acc: 0.387
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 1.7244394
	speed: 0.3525s/iter; left time: 3439.5099s
Epoch: 37 cost time: 13.636777400970459
Epoch: 37, Steps: 154 | Train Loss: 1.939 Vali Loss: 9.201 Vali Acc: 0.386 Test Loss: 9.201 Test Acc: 0.386
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.5432888
	speed: 0.3725s/iter; left time: 3577.4670s
Epoch: 38 cost time: 13.6844322681427
Epoch: 38, Steps: 154 | Train Loss: 1.023 Vali Loss: 6.906 Vali Acc: 0.412 Test Loss: 6.906 Test Acc: 0.412
Validation loss decreased (-0.404238 --> -0.412340).  Saving model ...
	iters: 100, epoch: 39 | loss: 1.1617470
	speed: 0.4037s/iter; left time: 3814.6056s
Epoch: 39 cost time: 15.385529041290283
Epoch: 39, Steps: 154 | Train Loss: 0.952 Vali Loss: 7.369 Vali Acc: 0.171 Test Loss: 7.369 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 0.3504841
	speed: 0.4244s/iter; left time: 3945.2193s
Epoch: 40 cost time: 15.268458604812622
Epoch: 40, Steps: 154 | Train Loss: 1.276 Vali Loss: 7.893 Vali Acc: 0.259 Test Loss: 7.893 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 1.2536237
	speed: 0.4351s/iter; left time: 3977.4398s
Epoch: 41 cost time: 16.349380254745483
Epoch: 41, Steps: 154 | Train Loss: 0.903 Vali Loss: 8.604 Vali Acc: 0.234 Test Loss: 8.604 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 42 | loss: 0.9466458
	speed: 0.3916s/iter; left time: 3519.5065s
Epoch: 42 cost time: 13.42096734046936
Epoch: 42, Steps: 154 | Train Loss: 1.433 Vali Loss: 8.899 Vali Acc: 0.137 Test Loss: 8.899 Test Acc: 0.137
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 43 | loss: 1.1225451
	speed: 0.4076s/iter; left time: 3600.6994s
Epoch: 43 cost time: 14.192773818969727
Epoch: 43, Steps: 154 | Train Loss: 1.809 Vali Loss: 8.703 Vali Acc: 0.244 Test Loss: 8.703 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 44 | loss: 0.4146708
	speed: 0.3678s/iter; left time: 3192.4959s
Epoch: 44 cost time: 12.918636322021484
Epoch: 44, Steps: 154 | Train Loss: 0.907 Vali Loss: 8.769 Vali Acc: 0.137 Test Loss: 8.769 Test Acc: 0.137
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 45 | loss: 1.0978968
	speed: 0.3886s/iter; left time: 3312.9416s
Epoch: 45 cost time: 13.3072190284729
Epoch: 45, Steps: 154 | Train Loss: 1.169 Vali Loss: 8.580 Vali Acc: 0.396 Test Loss: 8.580 Test Acc: 0.396
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 46 | loss: 0.7689225
	speed: 0.3591s/iter; left time: 3005.6172s
Epoch: 46 cost time: 12.70596718788147
Epoch: 46, Steps: 154 | Train Loss: 1.639 Vali Loss: 8.670 Vali Acc: 0.390 Test Loss: 8.670 Test Acc: 0.390
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 47 | loss: 0.6197946
	speed: 0.3557s/iter; left time: 2922.6180s
Epoch: 47 cost time: 12.547872543334961
Epoch: 47, Steps: 154 | Train Loss: 0.884 Vali Loss: 9.272 Vali Acc: 0.235 Test Loss: 9.272 Test Acc: 0.235
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 48 | loss: 0.5202293
	speed: 0.3597s/iter; left time: 2900.2341s
Epoch: 48 cost time: 13.738019466400146
Epoch: 48, Steps: 154 | Train Loss: 0.702 Vali Loss: 10.555 Vali Acc: 0.238 Test Loss: 10.555 Test Acc: 0.238
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4124087591240876
model parameter : 2387038
model size : 18.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8694835
	speed: 0.1162s/iter; left time: 1778.6967s
Epoch: 1 cost time: 16.162529945373535
Epoch: 1, Steps: 154 | Train Loss: 2.357 Vali Loss: 2.271 Vali Acc: 0.324 Test Loss: 2.271 Test Acc: 0.324
Validation loss decreased (inf --> -0.323578).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8210456
	speed: 0.3592s/iter; left time: 5440.7929s
Epoch: 2 cost time: 13.920257091522217
Epoch: 2, Steps: 154 | Train Loss: 2.129 Vali Loss: 2.346 Vali Acc: 0.330 Test Loss: 2.346 Test Acc: 0.330
Validation loss decreased (-0.323578 --> -0.330066).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3949599
	speed: 0.3750s/iter; left time: 5622.8482s
Epoch: 3 cost time: 12.744843006134033
Epoch: 3, Steps: 154 | Train Loss: 2.085 Vali Loss: 2.335 Vali Acc: 0.325 Test Loss: 2.335 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8697410
	speed: 0.3668s/iter; left time: 5443.0878s
Epoch: 4 cost time: 14.170945167541504
Epoch: 4, Steps: 154 | Train Loss: 1.962 Vali Loss: 2.557 Vali Acc: 0.332 Test Loss: 2.557 Test Acc: 0.332
Validation loss decreased (-0.330066 --> -0.332091).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1900299
	speed: 0.3486s/iter; left time: 5119.8265s
Epoch: 5 cost time: 14.094331979751587
Epoch: 5, Steps: 154 | Train Loss: 1.965 Vali Loss: 2.558 Vali Acc: 0.337 Test Loss: 2.558 Test Acc: 0.337
Validation loss decreased (-0.332091 --> -0.336552).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1041472
	speed: 0.3770s/iter; left time: 5478.6433s
Epoch: 6 cost time: 13.75266408920288
Epoch: 6, Steps: 154 | Train Loss: 1.874 Vali Loss: 2.575 Vali Acc: 0.342 Test Loss: 2.575 Test Acc: 0.342
Validation loss decreased (-0.336552 --> -0.341823).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6196213
	speed: 0.4000s/iter; left time: 5751.0358s
Epoch: 7 cost time: 14.17999005317688
Epoch: 7, Steps: 154 | Train Loss: 1.934 Vali Loss: 3.021 Vali Acc: 0.339 Test Loss: 3.021 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7335945
	speed: 0.3688s/iter; left time: 5246.0394s
Epoch: 8 cost time: 15.363452911376953
Epoch: 8, Steps: 154 | Train Loss: 2.007 Vali Loss: 2.681 Vali Acc: 0.339 Test Loss: 2.681 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.6568749
	speed: 0.3974s/iter; left time: 5590.4717s
Epoch: 9 cost time: 14.290952444076538
Epoch: 9, Steps: 154 | Train Loss: 1.979 Vali Loss: 3.735 Vali Acc: 0.062 Test Loss: 3.735 Test Acc: 0.062
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.6502239
	speed: 0.3663s/iter; left time: 5097.3706s
Epoch: 10 cost time: 15.369040727615356
Epoch: 10, Steps: 154 | Train Loss: 2.082 Vali Loss: 3.267 Vali Acc: 0.071 Test Loss: 3.267 Test Acc: 0.071
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.9894904
	speed: 0.3724s/iter; left time: 5124.2970s
Epoch: 11 cost time: 14.301723957061768
Epoch: 11, Steps: 154 | Train Loss: 1.879 Vali Loss: 3.376 Vali Acc: 0.058 Test Loss: 3.376 Test Acc: 0.058
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.3018709
	speed: 0.3737s/iter; left time: 5084.3621s
Epoch: 12 cost time: 14.292034149169922
Epoch: 12, Steps: 154 | Train Loss: 1.733 Vali Loss: 3.823 Vali Acc: 0.052 Test Loss: 3.823 Test Acc: 0.052
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.9719996
	speed: 0.4089s/iter; left time: 5501.0298s
Epoch: 13 cost time: 14.766942024230957
Epoch: 13, Steps: 154 | Train Loss: 1.977 Vali Loss: 3.484 Vali Acc: 0.063 Test Loss: 3.484 Test Acc: 0.063
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.4312630
	speed: 0.3746s/iter; left time: 4982.2121s
Epoch: 14 cost time: 15.100810050964355
Epoch: 14, Steps: 154 | Train Loss: 1.750 Vali Loss: 3.664 Vali Acc: 0.088 Test Loss: 3.664 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.3716220
	speed: 0.3855s/iter; left time: 5067.7321s
Epoch: 15 cost time: 14.531505584716797
Epoch: 15, Steps: 154 | Train Loss: 1.677 Vali Loss: 4.061 Vali Acc: 0.083 Test Loss: 4.061 Test Acc: 0.083
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.4270464
	speed: 0.3888s/iter; left time: 5051.2099s
Epoch: 16 cost time: 14.618316411972046
Epoch: 16, Steps: 154 | Train Loss: 1.669 Vali Loss: 4.104 Vali Acc: 0.086 Test Loss: 4.104 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3418491484184915
model parameter : 1862750
model size : 16.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8475184
	speed: 0.1085s/iter; left time: 1660.0090s
Epoch: 1 cost time: 15.133615493774414
Epoch: 1, Steps: 154 | Train Loss: 2.342 Vali Loss: 2.284 Vali Acc: 0.322 Test Loss: 2.284 Test Acc: 0.322
Validation loss decreased (inf --> -0.322362).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8231550
	speed: 0.3538s/iter; left time: 5359.7374s
Epoch: 2 cost time: 14.955791234970093
Epoch: 2, Steps: 154 | Train Loss: 2.134 Vali Loss: 2.351 Vali Acc: 0.328 Test Loss: 2.351 Test Acc: 0.328
Validation loss decreased (-0.322362 --> -0.328038).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4012458
	speed: 0.3986s/iter; left time: 5976.1874s
Epoch: 3 cost time: 14.616501808166504
Epoch: 3, Steps: 154 | Train Loss: 1.976 Vali Loss: 2.419 Vali Acc: 0.242 Test Loss: 2.419 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.3181746
	speed: 0.3932s/iter; left time: 5834.7827s
Epoch: 4 cost time: 13.892675638198853
Epoch: 4, Steps: 154 | Train Loss: 2.062 Vali Loss: 2.428 Vali Acc: 0.343 Test Loss: 2.428 Test Acc: 0.343
Validation loss decreased (-0.328038 --> -0.342636).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0405176
	speed: 0.3730s/iter; left time: 5477.1473s
Epoch: 5 cost time: 14.234169483184814
Epoch: 5, Steps: 154 | Train Loss: 1.990 Vali Loss: 2.685 Vali Acc: 0.346 Test Loss: 2.685 Test Acc: 0.346
Validation loss decreased (-0.342636 --> -0.346283).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8188931
	speed: 0.3744s/iter; left time: 5440.1454s
Epoch: 6 cost time: 13.475176334381104
Epoch: 6, Steps: 154 | Train Loss: 1.876 Vali Loss: 2.564 Vali Acc: 0.344 Test Loss: 2.564 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.5794630
	speed: 0.3719s/iter; left time: 5346.5201s
Epoch: 7 cost time: 14.29313039779663
Epoch: 7, Steps: 154 | Train Loss: 1.920 Vali Loss: 3.089 Vali Acc: 0.230 Test Loss: 3.089 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.7214066
	speed: 0.4047s/iter; left time: 5756.1964s
Epoch: 8 cost time: 15.666383266448975
Epoch: 8, Steps: 154 | Train Loss: 1.923 Vali Loss: 2.729 Vali Acc: 0.349 Test Loss: 2.729 Test Acc: 0.349
Validation loss decreased (-0.346283 --> -0.349121).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6113259
	speed: 0.3880s/iter; left time: 5458.8027s
Epoch: 9 cost time: 13.788881778717041
Epoch: 9, Steps: 154 | Train Loss: 1.809 Vali Loss: 3.151 Vali Acc: 0.060 Test Loss: 3.151 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.9084228
	speed: 0.3908s/iter; left time: 5437.8122s
Epoch: 10 cost time: 14.580475807189941
Epoch: 10, Steps: 154 | Train Loss: 1.821 Vali Loss: 3.125 Vali Acc: 0.104 Test Loss: 3.125 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.0842149
	speed: 0.3718s/iter; left time: 5116.6272s
Epoch: 11 cost time: 14.417483806610107
Epoch: 11, Steps: 154 | Train Loss: 1.965 Vali Loss: 3.278 Vali Acc: 0.059 Test Loss: 3.278 Test Acc: 0.059
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.5517541
	speed: 0.3824s/iter; left time: 5203.5616s
Epoch: 12 cost time: 14.067484140396118
Epoch: 12, Steps: 154 | Train Loss: 2.102 Vali Loss: 3.758 Vali Acc: 0.055 Test Loss: 3.758 Test Acc: 0.055
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.9915116
	speed: 0.3779s/iter; left time: 5083.6882s
Epoch: 13 cost time: 14.331318616867065
Epoch: 13, Steps: 154 | Train Loss: 1.728 Vali Loss: 3.230 Vali Acc: 0.348 Test Loss: 3.230 Test Acc: 0.348
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.1466854
	speed: 0.3899s/iter; left time: 5185.2042s
Epoch: 14 cost time: 15.115732669830322
Epoch: 14, Steps: 154 | Train Loss: 1.781 Vali Loss: 3.535 Vali Acc: 0.081 Test Loss: 3.535 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.7599438
	speed: 0.3707s/iter; left time: 4873.2945s
Epoch: 15 cost time: 13.748181343078613
Epoch: 15, Steps: 154 | Train Loss: 1.797 Vali Loss: 3.979 Vali Acc: 0.093 Test Loss: 3.979 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.7266343
	speed: 0.3786s/iter; left time: 4918.1188s
Epoch: 16 cost time: 13.479498624801636
Epoch: 16, Steps: 154 | Train Loss: 1.757 Vali Loss: 3.853 Vali Acc: 0.085 Test Loss: 3.853 Test Acc: 0.085
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 2.2730598
	speed: 0.3765s/iter; left time: 4832.7663s
Epoch: 17 cost time: 14.76059889793396
Epoch: 17, Steps: 154 | Train Loss: 1.899 Vali Loss: 3.951 Vali Acc: 0.080 Test Loss: 3.951 Test Acc: 0.080
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.2313501
	speed: 0.3851s/iter; left time: 4884.0814s
Epoch: 18 cost time: 14.129530906677246
Epoch: 18, Steps: 154 | Train Loss: 1.589 Vali Loss: 3.994 Vali Acc: 0.096 Test Loss: 3.994 Test Acc: 0.096
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3491484184914842
model parameter : 1862750
model size : 16.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8430184
	speed: 0.1025s/iter; left time: 1568.4808s
Epoch: 1 cost time: 14.668969869613647
Epoch: 1, Steps: 154 | Train Loss: 2.333 Vali Loss: 2.279 Vali Acc: 0.323 Test Loss: 2.279 Test Acc: 0.323
Validation loss decreased (inf --> -0.322767).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8217472
	speed: 0.3256s/iter; left time: 4932.5630s
Epoch: 2 cost time: 11.493860006332397
Epoch: 2, Steps: 154 | Train Loss: 2.117 Vali Loss: 2.291 Vali Acc: 0.331 Test Loss: 2.291 Test Acc: 0.331
Validation loss decreased (-0.322767 --> -0.331283).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3584614
	speed: 0.3745s/iter; left time: 5615.0482s
Epoch: 3 cost time: 13.739530563354492
Epoch: 3, Steps: 154 | Train Loss: 1.926 Vali Loss: 2.199 Vali Acc: 0.351 Test Loss: 2.199 Test Acc: 0.351
Validation loss decreased (-0.331283 --> -0.351154).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2006049
	speed: 0.3616s/iter; left time: 5366.4035s
Epoch: 4 cost time: 14.17406153678894
Epoch: 4, Steps: 154 | Train Loss: 1.909 Vali Loss: 2.527 Vali Acc: 0.341 Test Loss: 2.527 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.1846213
	speed: 0.3539s/iter; left time: 5196.7597s
Epoch: 5 cost time: 13.329564332962036
Epoch: 5, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.521 Vali Acc: 0.345 Test Loss: 2.521 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.9031307
	speed: 0.3609s/iter; left time: 5244.8970s
Epoch: 6 cost time: 13.26012134552002
Epoch: 6, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.383 Vali Acc: 0.341 Test Loss: 2.383 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.1721823
	speed: 0.3827s/iter; left time: 5502.7417s
Epoch: 7 cost time: 13.795247554779053
Epoch: 7, Steps: 154 | Train Loss: 1.837 Vali Loss: 2.695 Vali Acc: 0.349 Test Loss: 2.695 Test Acc: 0.349
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.8187948
	speed: 0.3793s/iter; left time: 5394.2797s
Epoch: 8 cost time: 14.332271099090576
Epoch: 8, Steps: 154 | Train Loss: 1.995 Vali Loss: 2.620 Vali Acc: 0.354 Test Loss: 2.620 Test Acc: 0.354
Validation loss decreased (-0.351154 --> -0.353988).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9132364
	speed: 0.4007s/iter; left time: 5637.4219s
Epoch: 9 cost time: 13.46247386932373
Epoch: 9, Steps: 154 | Train Loss: 1.898 Vali Loss: 3.157 Vali Acc: 0.093 Test Loss: 3.157 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6645323
	speed: 0.3775s/iter; left time: 5253.2330s
Epoch: 10 cost time: 14.654028177261353
Epoch: 10, Steps: 154 | Train Loss: 1.753 Vali Loss: 3.116 Vali Acc: 0.166 Test Loss: 3.116 Test Acc: 0.166
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.2523451
	speed: 0.3642s/iter; left time: 5011.2994s
Epoch: 11 cost time: 13.331862211227417
Epoch: 11, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.680 Vali Acc: 0.369 Test Loss: 2.680 Test Acc: 0.369
Validation loss decreased (-0.353988 --> -0.368586).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.8856833
	speed: 0.3786s/iter; left time: 5151.3816s
Epoch: 12 cost time: 14.179364442825317
Epoch: 12, Steps: 154 | Train Loss: 1.806 Vali Loss: 3.231 Vali Acc: 0.094 Test Loss: 3.231 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.0838509
	speed: 0.4059s/iter; left time: 5460.4163s
Epoch: 13 cost time: 15.325471878051758
Epoch: 13, Steps: 154 | Train Loss: 1.676 Vali Loss: 3.333 Vali Acc: 0.356 Test Loss: 3.333 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.3820626
	speed: 0.4022s/iter; left time: 5348.6242s
Epoch: 14 cost time: 14.560518503189087
Epoch: 14, Steps: 154 | Train Loss: 1.765 Vali Loss: 3.287 Vali Acc: 0.106 Test Loss: 3.287 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.6848414
	speed: 0.3789s/iter; left time: 4980.3807s
Epoch: 15 cost time: 12.918719053268433
Epoch: 15, Steps: 154 | Train Loss: 1.857 Vali Loss: 3.379 Vali Acc: 0.091 Test Loss: 3.379 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.0026060
	speed: 0.3528s/iter; left time: 4583.4692s
Epoch: 16 cost time: 14.118785619735718
Epoch: 16, Steps: 154 | Train Loss: 1.515 Vali Loss: 3.674 Vali Acc: 0.097 Test Loss: 3.674 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.8065445
	speed: 0.3601s/iter; left time: 4622.3374s
Epoch: 17 cost time: 13.535733461380005
Epoch: 17, Steps: 154 | Train Loss: 1.692 Vali Loss: 3.857 Vali Acc: 0.084 Test Loss: 3.857 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.7253060
	speed: 0.3576s/iter; left time: 4534.8426s
Epoch: 18 cost time: 13.47235631942749
Epoch: 18, Steps: 154 | Train Loss: 2.198 Vali Loss: 3.855 Vali Acc: 0.087 Test Loss: 3.855 Test Acc: 0.087
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.4480765
	speed: 0.4006s/iter; left time: 5019.6275s
Epoch: 19 cost time: 14.921229124069214
Epoch: 19, Steps: 154 | Train Loss: 1.804 Vali Loss: 3.515 Vali Acc: 0.158 Test Loss: 3.515 Test Acc: 0.158
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.2548392
	speed: 0.3866s/iter; left time: 4784.6020s
Epoch: 20 cost time: 14.223862409591675
Epoch: 20, Steps: 154 | Train Loss: 1.811 Vali Loss: 4.003 Vali Acc: 0.362 Test Loss: 4.003 Test Acc: 0.362
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 2.7249663
	speed: 0.3860s/iter; left time: 4716.7023s
Epoch: 21 cost time: 13.789449214935303
Epoch: 21, Steps: 154 | Train Loss: 1.596 Vali Loss: 3.709 Vali Acc: 0.215 Test Loss: 3.709 Test Acc: 0.215
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3686131386861314
model parameter : 1862750
model size : 16.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9057226
	speed: 0.1006s/iter; left time: 1540.0149s
Epoch: 1 cost time: 14.538636207580566
Epoch: 1, Steps: 154 | Train Loss: 2.277 Vali Loss: 2.320 Vali Acc: 0.323 Test Loss: 2.320 Test Acc: 0.323
Validation loss decreased (inf --> -0.322767).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8055842
	speed: 0.3523s/iter; left time: 5335.6936s
Epoch: 2 cost time: 13.329386711120605
Epoch: 2, Steps: 154 | Train Loss: 2.039 Vali Loss: 2.306 Vali Acc: 0.334 Test Loss: 2.306 Test Acc: 0.334
Validation loss decreased (-0.322767 --> -0.333716).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2963219
	speed: 0.3602s/iter; left time: 5400.1622s
Epoch: 3 cost time: 14.053604364395142
Epoch: 3, Steps: 154 | Train Loss: 1.940 Vali Loss: 2.281 Vali Acc: 0.356 Test Loss: 2.281 Test Acc: 0.356
Validation loss decreased (-0.333716 --> -0.355614).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1840053
	speed: 0.3775s/iter; left time: 5601.4594s
Epoch: 4 cost time: 13.731767416000366
Epoch: 4, Steps: 154 | Train Loss: 1.820 Vali Loss: 2.731 Vali Acc: 0.341 Test Loss: 2.731 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7992693
	speed: 0.3731s/iter; left time: 5479.2150s
Epoch: 5 cost time: 13.671732187271118
Epoch: 5, Steps: 154 | Train Loss: 1.786 Vali Loss: 2.580 Vali Acc: 0.345 Test Loss: 2.580 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.7636789
	speed: 0.3534s/iter; left time: 5134.6429s
Epoch: 6 cost time: 14.24261474609375
Epoch: 6, Steps: 154 | Train Loss: 1.720 Vali Loss: 2.501 Vali Acc: 0.199 Test Loss: 2.501 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.1393516
	speed: 0.3629s/iter; left time: 5218.0372s
Epoch: 7 cost time: 13.164059162139893
Epoch: 7, Steps: 154 | Train Loss: 1.831 Vali Loss: 3.018 Vali Acc: 0.349 Test Loss: 3.018 Test Acc: 0.349
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.8204392
	speed: 0.3561s/iter; left time: 5064.8334s
Epoch: 8 cost time: 13.484133243560791
Epoch: 8, Steps: 154 | Train Loss: 1.770 Vali Loss: 2.650 Vali Acc: 0.356 Test Loss: 2.650 Test Acc: 0.356
Validation loss decreased (-0.355614 --> -0.356421).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5884385
	speed: 0.3625s/iter; left time: 5099.7695s
Epoch: 9 cost time: 14.672963619232178
Epoch: 9, Steps: 154 | Train Loss: 1.846 Vali Loss: 2.850 Vali Acc: 0.363 Test Loss: 2.850 Test Acc: 0.363
Validation loss decreased (-0.356421 --> -0.362907).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4694343
	speed: 0.3766s/iter; left time: 5240.5308s
Epoch: 10 cost time: 13.144866943359375
Epoch: 10, Steps: 154 | Train Loss: 1.956 Vali Loss: 2.831 Vali Acc: 0.365 Test Loss: 2.831 Test Acc: 0.365
Validation loss decreased (-0.362907 --> -0.364530).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6748364
	speed: 0.3909s/iter; left time: 5378.8804s
Epoch: 11 cost time: 13.363833665847778
Epoch: 11, Steps: 154 | Train Loss: 1.685 Vali Loss: 2.796 Vali Acc: 0.375 Test Loss: 2.796 Test Acc: 0.375
Validation loss decreased (-0.364530 --> -0.375073).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6295801
	speed: 0.3392s/iter; left time: 4615.1011s
Epoch: 12 cost time: 13.005308151245117
Epoch: 12, Steps: 154 | Train Loss: 1.658 Vali Loss: 2.805 Vali Acc: 0.208 Test Loss: 2.805 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.2547532
	speed: 0.3341s/iter; left time: 4494.3518s
Epoch: 13 cost time: 12.5649893283844
Epoch: 13, Steps: 154 | Train Loss: 1.664 Vali Loss: 3.218 Vali Acc: 0.257 Test Loss: 3.218 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2169795
	speed: 0.3362s/iter; left time: 4471.1979s
Epoch: 14 cost time: 13.074221134185791
Epoch: 14, Steps: 154 | Train Loss: 1.627 Vali Loss: 3.081 Vali Acc: 0.118 Test Loss: 3.081 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.0828252
	speed: 0.3330s/iter; left time: 4377.3217s
Epoch: 15 cost time: 13.848022937774658
Epoch: 15, Steps: 154 | Train Loss: 1.696 Vali Loss: 3.403 Vali Acc: 0.372 Test Loss: 3.403 Test Acc: 0.372
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.3421105
	speed: 0.3668s/iter; left time: 4765.5082s
Epoch: 16 cost time: 11.967393636703491
Epoch: 16, Steps: 154 | Train Loss: 1.500 Vali Loss: 3.177 Vali Acc: 0.367 Test Loss: 3.177 Test Acc: 0.367
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.2711791
	speed: 0.3629s/iter; left time: 4657.9835s
Epoch: 17 cost time: 13.841241836547852
Epoch: 17, Steps: 154 | Train Loss: 1.888 Vali Loss: 3.987 Vali Acc: 0.099 Test Loss: 3.987 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.3083308
	speed: 0.3326s/iter; left time: 4217.8019s
Epoch: 18 cost time: 12.189007997512817
Epoch: 18, Steps: 154 | Train Loss: 1.647 Vali Loss: 4.163 Vali Acc: 0.110 Test Loss: 4.163 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.7641529
	speed: 0.3253s/iter; left time: 4075.4310s
Epoch: 19 cost time: 11.630664110183716
Epoch: 19, Steps: 154 | Train Loss: 1.705 Vali Loss: 4.277 Vali Acc: 0.232 Test Loss: 4.277 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.9741542
	speed: 0.3347s/iter; left time: 4142.4158s
Epoch: 20 cost time: 13.882318496704102
Epoch: 20, Steps: 154 | Train Loss: 1.772 Vali Loss: 4.598 Vali Acc: 0.365 Test Loss: 4.598 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.7087448
	speed: 0.3730s/iter; left time: 4558.8194s
Epoch: 21 cost time: 14.240662336349487
Epoch: 21, Steps: 154 | Train Loss: 1.360 Vali Loss: 3.676 Vali Acc: 0.376 Test Loss: 3.676 Test Acc: 0.376
Validation loss decreased (-0.375073 --> -0.376281).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.7007244
	speed: 0.4678s/iter; left time: 5645.1439s
Epoch: 22 cost time: 19.13054609298706
Epoch: 22, Steps: 154 | Train Loss: 1.374 Vali Loss: 3.684 Vali Acc: 0.227 Test Loss: 3.684 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.6039748
	speed: 0.4938s/iter; left time: 5882.8814s
Epoch: 23 cost time: 18.135397911071777
Epoch: 23, Steps: 154 | Train Loss: 1.354 Vali Loss: 4.120 Vali Acc: 0.347 Test Loss: 4.120 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.4201130
	speed: 0.4044s/iter; left time: 4755.3172s
Epoch: 24 cost time: 14.55385971069336
Epoch: 24, Steps: 154 | Train Loss: 1.456 Vali Loss: 4.214 Vali Acc: 0.297 Test Loss: 4.214 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.7663435
	speed: 0.3974s/iter; left time: 4612.1408s
Epoch: 25 cost time: 15.166767120361328
Epoch: 25, Steps: 154 | Train Loss: 1.339 Vali Loss: 4.980 Vali Acc: 0.140 Test Loss: 4.980 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.4859451
	speed: 0.4581s/iter; left time: 5245.8392s
Epoch: 26 cost time: 16.951682090759277
Epoch: 26, Steps: 154 | Train Loss: 1.283 Vali Loss: 4.420 Vali Acc: 0.358 Test Loss: 4.420 Test Acc: 0.358
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.0589013
	speed: 0.4166s/iter; left time: 4706.6387s
Epoch: 27 cost time: 14.267350673675537
Epoch: 27, Steps: 154 | Train Loss: 1.566 Vali Loss: 5.214 Vali Acc: 0.101 Test Loss: 5.214 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 3.3756166
	speed: 0.3681s/iter; left time: 4101.2005s
Epoch: 28 cost time: 13.35107135772705
Epoch: 28, Steps: 154 | Train Loss: 1.527 Vali Loss: 6.011 Vali Acc: 0.322 Test Loss: 6.011 Test Acc: 0.322
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 2.0519555
	speed: 0.3709s/iter; left time: 4076.2416s
Epoch: 29 cost time: 13.556882619857788
Epoch: 29, Steps: 154 | Train Loss: 1.134 Vali Loss: 5.546 Vali Acc: 0.384 Test Loss: 5.546 Test Acc: 0.384
Validation loss decreased (-0.376281 --> -0.383562).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.1051464
	speed: 0.3567s/iter; left time: 3864.3054s
Epoch: 30 cost time: 12.082946538925171
Epoch: 30, Steps: 154 | Train Loss: 1.308 Vali Loss: 5.205 Vali Acc: 0.362 Test Loss: 5.205 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.9190105
	speed: 0.3432s/iter; left time: 3665.8667s
Epoch: 31 cost time: 13.225714683532715
Epoch: 31, Steps: 154 | Train Loss: 1.203 Vali Loss: 6.486 Vali Acc: 0.104 Test Loss: 6.486 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.7937350
	speed: 0.3299s/iter; left time: 3472.5683s
Epoch: 32 cost time: 12.821512460708618
Epoch: 32, Steps: 154 | Train Loss: 2.385 Vali Loss: 4.965 Vali Acc: 0.393 Test Loss: 4.965 Test Acc: 0.393
Validation loss decreased (-0.383562 --> -0.393300).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.9608030
	speed: 0.3363s/iter; left time: 3487.9520s
Epoch: 33 cost time: 12.10003113746643
Epoch: 33, Steps: 154 | Train Loss: 1.520 Vali Loss: 6.104 Vali Acc: 0.141 Test Loss: 6.104 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.9655716
	speed: 0.3454s/iter; left time: 3529.4790s
Epoch: 34 cost time: 11.83551287651062
Epoch: 34, Steps: 154 | Train Loss: 1.606 Vali Loss: 5.589 Vali Acc: 0.164 Test Loss: 5.589 Test Acc: 0.164
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 1.0845760
	speed: 0.3277s/iter; left time: 3298.0559s
Epoch: 35 cost time: 13.797083377838135
Epoch: 35, Steps: 154 | Train Loss: 1.061 Vali Loss: 4.625 Vali Acc: 0.378 Test Loss: 4.625 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.6082903
	speed: 0.3636s/iter; left time: 3603.2299s
Epoch: 36 cost time: 12.485732793807983
Epoch: 36, Steps: 154 | Train Loss: 1.210 Vali Loss: 6.542 Vali Acc: 0.166 Test Loss: 6.542 Test Acc: 0.166
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.9483069
	speed: 0.3411s/iter; left time: 3328.3713s
Epoch: 37 cost time: 12.988087177276611
Epoch: 37, Steps: 154 | Train Loss: 1.442 Vali Loss: 9.112 Vali Acc: 0.225 Test Loss: 9.112 Test Acc: 0.225
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 1.0859810
	speed: 0.3601s/iter; left time: 3457.6138s
Epoch: 38 cost time: 14.170584440231323
Epoch: 38, Steps: 154 | Train Loss: 3.340 Vali Loss: 9.648 Vali Acc: 0.365 Test Loss: 9.648 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.3701165
	speed: 0.3695s/iter; left time: 3491.0000s
Epoch: 39 cost time: 13.224098205566406
Epoch: 39, Steps: 154 | Train Loss: 1.061 Vali Loss: 9.732 Vali Acc: 0.273 Test Loss: 9.732 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.6405854
	speed: 0.3648s/iter; left time: 3391.0559s
Epoch: 40 cost time: 14.617022514343262
Epoch: 40, Steps: 154 | Train Loss: 1.411 Vali Loss: 8.168 Vali Acc: 0.398 Test Loss: 8.168 Test Acc: 0.398
Validation loss decreased (-0.393300 --> -0.398134).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.6133603
	speed: 0.3805s/iter; left time: 3477.9048s
Epoch: 41 cost time: 14.297709465026855
Epoch: 41, Steps: 154 | Train Loss: 0.854 Vali Loss: 9.083 Vali Acc: 0.383 Test Loss: 9.083 Test Acc: 0.383
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.2008766
	speed: 0.3846s/iter; left time: 3456.4694s
Epoch: 42 cost time: 14.84785509109497
Epoch: 42, Steps: 154 | Train Loss: 1.566 Vali Loss: 8.689 Vali Acc: 0.394 Test Loss: 8.689 Test Acc: 0.394
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 1.0621709
	speed: 0.3419s/iter; left time: 3019.7321s
Epoch: 43 cost time: 13.061347723007202
Epoch: 43, Steps: 154 | Train Loss: 0.808 Vali Loss: 9.390 Vali Acc: 0.385 Test Loss: 9.390 Test Acc: 0.385
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 1.1722920
	speed: 0.3476s/iter; left time: 3017.2210s
Epoch: 44 cost time: 12.864351749420166
Epoch: 44, Steps: 154 | Train Loss: 1.626 Vali Loss: 10.264 Vali Acc: 0.262 Test Loss: 10.264 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 1.1226306
	speed: 0.3599s/iter; left time: 3068.3124s
Epoch: 45 cost time: 13.476950645446777
Epoch: 45, Steps: 154 | Train Loss: 2.217 Vali Loss: 15.533 Vali Acc: 0.159 Test Loss: 15.533 Test Acc: 0.159
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.1254204
	speed: 0.3444s/iter; left time: 2883.2195s
Epoch: 46 cost time: 13.401718378067017
Epoch: 46, Steps: 154 | Train Loss: 1.329 Vali Loss: 9.809 Vali Acc: 0.238 Test Loss: 9.809 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.7873619
	speed: 0.3604s/iter; left time: 2961.5236s
Epoch: 47 cost time: 13.866222858428955
Epoch: 47, Steps: 154 | Train Loss: 0.861 Vali Loss: 10.926 Vali Acc: 0.339 Test Loss: 10.926 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.4610810
	speed: 0.3839s/iter; left time: 3095.3460s
Epoch: 48 cost time: 14.91663122177124
Epoch: 48, Steps: 154 | Train Loss: 2.006 Vali Loss: 11.060 Vali Acc: 0.293 Test Loss: 11.060 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.9004952
	speed: 0.3787s/iter; left time: 2994.9650s
Epoch: 49 cost time: 13.308143138885498
Epoch: 49, Steps: 154 | Train Loss: 1.991 Vali Loss: 10.492 Vali Acc: 0.215 Test Loss: 10.492 Test Acc: 0.215
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 0.3750938
	speed: 0.3663s/iter; left time: 2840.5940s
Epoch: 50 cost time: 13.873085021972656
Epoch: 50, Steps: 154 | Train Loss: 2.029 Vali Loss: 11.468 Vali Acc: 0.138 Test Loss: 11.468 Test Acc: 0.138
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3982157339821573
model parameter : 1862750
model size : 16.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7244364
	speed: 0.1092s/iter; left time: 1670.3714s
Epoch: 1 cost time: 15.442071437835693
Epoch: 1, Steps: 154 | Train Loss: 2.296 Vali Loss: 2.238 Vali Acc: 0.329 Test Loss: 2.238 Test Acc: 0.329
Validation loss decreased (inf --> -0.328850).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0517201
	speed: 0.3384s/iter; left time: 5126.2786s
Epoch: 2 cost time: 13.352656364440918
Epoch: 2, Steps: 154 | Train Loss: 2.145 Vali Loss: 2.340 Vali Acc: 0.322 Test Loss: 2.340 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.1319184
	speed: 0.3526s/iter; left time: 5286.9481s
Epoch: 3 cost time: 12.71566128730774
Epoch: 3, Steps: 154 | Train Loss: 2.077 Vali Loss: 2.348 Vali Acc: 0.328 Test Loss: 2.348 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.7495128
	speed: 0.3651s/iter; left time: 5417.4820s
Epoch: 4 cost time: 13.949948072433472
Epoch: 4, Steps: 154 | Train Loss: 1.954 Vali Loss: 2.665 Vali Acc: 0.333 Test Loss: 2.665 Test Acc: 0.333
Validation loss decreased (-0.328850 --> -0.333307).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1305189
	speed: 0.3437s/iter; left time: 5047.0674s
Epoch: 5 cost time: 12.540384769439697
Epoch: 5, Steps: 154 | Train Loss: 2.061 Vali Loss: 2.665 Vali Acc: 0.335 Test Loss: 2.665 Test Acc: 0.335
Validation loss decreased (-0.333307 --> -0.334523).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0464902
	speed: 0.3458s/iter; left time: 5024.8844s
Epoch: 6 cost time: 12.613383531570435
Epoch: 6, Steps: 154 | Train Loss: 1.903 Vali Loss: 2.706 Vali Acc: 0.256 Test Loss: 2.706 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.3768227
	speed: 0.3231s/iter; left time: 4645.5771s
Epoch: 7 cost time: 12.775763988494873
Epoch: 7, Steps: 154 | Train Loss: 1.894 Vali Loss: 2.588 Vali Acc: 0.341 Test Loss: 2.588 Test Acc: 0.341
Validation loss decreased (-0.334523 --> -0.341418).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0345259
	speed: 0.3549s/iter; left time: 5047.2823s
Epoch: 8 cost time: 13.415892362594604
Epoch: 8, Steps: 154 | Train Loss: 1.888 Vali Loss: 3.233 Vali Acc: 0.057 Test Loss: 3.233 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4737003
	speed: 0.3725s/iter; left time: 5241.2360s
Epoch: 9 cost time: 14.930291891098022
Epoch: 9, Steps: 154 | Train Loss: 1.955 Vali Loss: 2.987 Vali Acc: 0.070 Test Loss: 2.987 Test Acc: 0.070
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8237078
	speed: 0.3800s/iter; left time: 5287.1997s
Epoch: 10 cost time: 14.49365520477295
Epoch: 10, Steps: 154 | Train Loss: 1.972 Vali Loss: 2.674 Vali Acc: 0.354 Test Loss: 2.674 Test Acc: 0.354
Validation loss decreased (-0.341418 --> -0.354393).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.2000844
	speed: 0.3336s/iter; left time: 4591.1607s
Epoch: 11 cost time: 10.967922449111938
Epoch: 11, Steps: 154 | Train Loss: 1.850 Vali Loss: 2.891 Vali Acc: 0.120 Test Loss: 2.891 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 5.7706842
	speed: 0.3856s/iter; left time: 5247.3698s
Epoch: 12 cost time: 17.344630241394043
Epoch: 12, Steps: 154 | Train Loss: 1.819 Vali Loss: 4.074 Vali Acc: 0.087 Test Loss: 4.074 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2426052
	speed: 0.4337s/iter; left time: 5834.3234s
Epoch: 13 cost time: 17.526523113250732
Epoch: 13, Steps: 154 | Train Loss: 1.715 Vali Loss: 3.292 Vali Acc: 0.099 Test Loss: 3.292 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.9703580
	speed: 0.5181s/iter; left time: 6890.5690s
Epoch: 14 cost time: 21.550498247146606
Epoch: 14, Steps: 154 | Train Loss: 1.736 Vali Loss: 3.275 Vali Acc: 0.081 Test Loss: 3.275 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.4308021
	speed: 0.5977s/iter; left time: 7856.3139s
Epoch: 15 cost time: 24.442624807357788
Epoch: 15, Steps: 154 | Train Loss: 1.723 Vali Loss: 3.484 Vali Acc: 0.361 Test Loss: 3.484 Test Acc: 0.361
Validation loss decreased (-0.354393 --> -0.360874).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4704186
	speed: 0.6275s/iter; left time: 8151.9396s
Epoch: 16 cost time: 23.061691761016846
Epoch: 16, Steps: 154 | Train Loss: 1.815 Vali Loss: 3.893 Vali Acc: 0.136 Test Loss: 3.893 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.1913853
	speed: 0.5881s/iter; left time: 7549.9354s
Epoch: 17 cost time: 23.624197483062744
Epoch: 17, Steps: 154 | Train Loss: 1.687 Vali Loss: 3.336 Vali Acc: 0.097 Test Loss: 3.336 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 2.1448090
	speed: 0.5275s/iter; left time: 6690.0603s
Epoch: 18 cost time: 24.122291564941406
Epoch: 18, Steps: 154 | Train Loss: 1.996 Vali Loss: 4.772 Vali Acc: 0.077 Test Loss: 4.772 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.6272234
	speed: 0.5215s/iter; left time: 6534.0431s
Epoch: 19 cost time: 20.681482315063477
Epoch: 19, Steps: 154 | Train Loss: 1.859 Vali Loss: 4.622 Vali Acc: 0.064 Test Loss: 4.622 Test Acc: 0.064
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.6593635
	speed: 0.5550s/iter; left time: 6868.2884s
Epoch: 20 cost time: 21.891268253326416
Epoch: 20, Steps: 154 | Train Loss: 1.646 Vali Loss: 3.965 Vali Acc: 0.080 Test Loss: 3.965 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.3285772
	speed: 0.5524s/iter; left time: 6751.3441s
Epoch: 21 cost time: 23.28920578956604
Epoch: 21, Steps: 154 | Train Loss: 1.690 Vali Loss: 4.200 Vali Acc: 0.062 Test Loss: 4.200 Test Acc: 0.062
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.6331874
	speed: 0.5869s/iter; left time: 7082.1030s
Epoch: 22 cost time: 22.14721918106079
Epoch: 22, Steps: 154 | Train Loss: 1.703 Vali Loss: 4.609 Vali Acc: 0.366 Test Loss: 4.609 Test Acc: 0.366
Validation loss decreased (-0.360874 --> -0.366134).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.6281112
	speed: 0.5923s/iter; left time: 7055.9746s
Epoch: 23 cost time: 23.073971271514893
Epoch: 23, Steps: 154 | Train Loss: 1.549 Vali Loss: 4.089 Vali Acc: 0.095 Test Loss: 4.089 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.5274233
	speed: 0.5351s/iter; left time: 6291.7387s
Epoch: 24 cost time: 21.238374948501587
Epoch: 24, Steps: 154 | Train Loss: 1.546 Vali Loss: 4.095 Vali Acc: 0.097 Test Loss: 4.095 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.8346854
	speed: 0.5696s/iter; left time: 6610.2227s
Epoch: 25 cost time: 22.8033549785614
Epoch: 25, Steps: 154 | Train Loss: 1.452 Vali Loss: 4.469 Vali Acc: 0.140 Test Loss: 4.469 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.6261632
	speed: 0.5770s/iter; left time: 6607.1302s
Epoch: 26 cost time: 23.579211711883545
Epoch: 26, Steps: 154 | Train Loss: 1.511 Vali Loss: 4.844 Vali Acc: 0.083 Test Loss: 4.844 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.2246462
	speed: 0.5330s/iter; left time: 6021.6579s
Epoch: 27 cost time: 22.392497301101685
Epoch: 27, Steps: 154 | Train Loss: 2.011 Vali Loss: 3.947 Vali Acc: 0.367 Test Loss: 3.947 Test Acc: 0.367
Validation loss decreased (-0.366134 --> -0.366952).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.0799159
	speed: 0.5256s/iter; left time: 5856.3203s
Epoch: 28 cost time: 19.724740028381348
Epoch: 28, Steps: 154 | Train Loss: 1.644 Vali Loss: 4.169 Vali Acc: 0.219 Test Loss: 4.169 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.5854868
	speed: 0.6068s/iter; left time: 6668.4491s
Epoch: 29 cost time: 24.551928281784058
Epoch: 29, Steps: 154 | Train Loss: 1.667 Vali Loss: 3.906 Vali Acc: 0.376 Test Loss: 3.906 Test Acc: 0.376
Validation loss decreased (-0.366952 --> -0.375873).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.6227781
	speed: 0.5620s/iter; left time: 6089.7485s
Epoch: 30 cost time: 21.633699893951416
Epoch: 30, Steps: 154 | Train Loss: 1.409 Vali Loss: 5.421 Vali Acc: 0.093 Test Loss: 5.421 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.8620667
	speed: 0.5306s/iter; left time: 5667.6225s
Epoch: 31 cost time: 20.50308656692505
Epoch: 31, Steps: 154 | Train Loss: 1.313 Vali Loss: 4.050 Vali Acc: 0.148 Test Loss: 4.050 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 8.6137743
	speed: 0.5429s/iter; left time: 5714.8279s
Epoch: 32 cost time: 20.211521863937378
Epoch: 32, Steps: 154 | Train Loss: 1.310 Vali Loss: 4.975 Vali Acc: 0.122 Test Loss: 4.975 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.7577487
	speed: 0.4708s/iter; left time: 4883.1963s
Epoch: 33 cost time: 16.3729989528656
Epoch: 33, Steps: 154 | Train Loss: 1.535 Vali Loss: 5.329 Vali Acc: 0.080 Test Loss: 5.329 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 1.3032978
	speed: 0.5526s/iter; left time: 5646.9137s
Epoch: 34 cost time: 23.11339831352234
Epoch: 34, Steps: 154 | Train Loss: 1.489 Vali Loss: 4.299 Vali Acc: 0.125 Test Loss: 4.299 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.6324485
	speed: 0.5776s/iter; left time: 5813.4054s
Epoch: 35 cost time: 22.534452199935913
Epoch: 35, Steps: 154 | Train Loss: 1.243 Vali Loss: 4.350 Vali Acc: 0.138 Test Loss: 4.350 Test Acc: 0.138
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 1.7913301
	speed: 0.5634s/iter; left time: 5583.4156s
Epoch: 36 cost time: 22.411134958267212
Epoch: 36, Steps: 154 | Train Loss: 1.501 Vali Loss: 4.654 Vali Acc: 0.098 Test Loss: 4.654 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 1.0009320
	speed: 0.5679s/iter; left time: 5540.8462s
Epoch: 37 cost time: 23.341692447662354
Epoch: 37, Steps: 154 | Train Loss: 1.178 Vali Loss: 4.218 Vali Acc: 0.378 Test Loss: 4.218 Test Acc: 0.378
Validation loss decreased (-0.375873 --> -0.377898).  Saving model ...
	iters: 100, epoch: 38 | loss: 1.6803179
	speed: 0.5415s/iter; left time: 5199.9841s
Epoch: 38 cost time: 22.679818868637085
Epoch: 38, Steps: 154 | Train Loss: 1.438 Vali Loss: 4.895 Vali Acc: 0.116 Test Loss: 4.895 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 1.7937655
	speed: 0.5172s/iter; left time: 4886.8273s
Epoch: 39 cost time: 16.165585041046143
Epoch: 39, Steps: 154 | Train Loss: 2.573 Vali Loss: 6.027 Vali Acc: 0.213 Test Loss: 6.027 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 1.7859879
	speed: 0.5084s/iter; left time: 4725.3430s
Epoch: 40 cost time: 22.366637706756592
Epoch: 40, Steps: 154 | Train Loss: 2.067 Vali Loss: 5.953 Vali Acc: 0.120 Test Loss: 5.953 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 5.4094167
	speed: 0.5859s/iter; left time: 5355.8758s
Epoch: 41 cost time: 23.0321786403656
Epoch: 41, Steps: 154 | Train Loss: 1.291 Vali Loss: 5.643 Vali Acc: 0.187 Test Loss: 5.643 Test Acc: 0.187
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 42 | loss: 1.1107895
	speed: 0.5654s/iter; left time: 5081.1665s
Epoch: 42 cost time: 21.184979677200317
Epoch: 42, Steps: 154 | Train Loss: 1.252 Vali Loss: 4.795 Vali Acc: 0.388 Test Loss: 4.795 Test Acc: 0.388
Validation loss decreased (-0.377898 --> -0.387624).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.9758364
	speed: 0.5574s/iter; left time: 4923.3605s
Epoch: 43 cost time: 22.194262742996216
Epoch: 43, Steps: 154 | Train Loss: 1.203 Vali Loss: 5.967 Vali Acc: 0.105 Test Loss: 5.967 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 0.4336099
	speed: 0.5684s/iter; left time: 4933.0921s
Epoch: 44 cost time: 23.05585741996765
Epoch: 44, Steps: 154 | Train Loss: 1.073 Vali Loss: 4.999 Vali Acc: 0.395 Test Loss: 4.999 Test Acc: 0.395
Validation loss decreased (-0.387624 --> -0.394922).  Saving model ...
	iters: 100, epoch: 45 | loss: 2.0645533
	speed: 0.5321s/iter; left time: 4536.1463s
Epoch: 45 cost time: 21.8613224029541
Epoch: 45, Steps: 154 | Train Loss: 1.202 Vali Loss: 5.985 Vali Acc: 0.377 Test Loss: 5.985 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 46 | loss: 0.5287620
	speed: 0.5872s/iter; left time: 4915.1528s
Epoch: 46 cost time: 23.712571382522583
Epoch: 46, Steps: 154 | Train Loss: 1.359 Vali Loss: 8.412 Vali Acc: 0.183 Test Loss: 8.412 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 47 | loss: 1.5371404
	speed: 0.5314s/iter; left time: 4366.1165s
Epoch: 47 cost time: 23.05478072166443
Epoch: 47, Steps: 154 | Train Loss: 1.588 Vali Loss: 7.224 Vali Acc: 0.207 Test Loss: 7.224 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 48 | loss: 0.5725057
	speed: 0.5810s/iter; left time: 4684.8442s
Epoch: 48 cost time: 21.978386402130127
Epoch: 48, Steps: 154 | Train Loss: 1.762 Vali Loss: 7.646 Vali Acc: 0.111 Test Loss: 7.646 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 49 | loss: 1.0051514
	speed: 0.5813s/iter; left time: 4597.2044s
Epoch: 49 cost time: 20.525800704956055
Epoch: 49, Steps: 154 | Train Loss: 1.352 Vali Loss: 6.412 Vali Acc: 0.384 Test Loss: 6.412 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 50 | loss: 0.6042272
	speed: 0.5473s/iter; left time: 4244.3626s
Epoch: 50 cost time: 21.321982383728027
Epoch: 50, Steps: 154 | Train Loss: 1.063 Vali Loss: 7.059 Vali Acc: 0.092 Test Loss: 7.059 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 51 | loss: 0.5794756
	speed: 0.5395s/iter; left time: 4100.7778s
Epoch: 51 cost time: 20.87314772605896
Epoch: 51, Steps: 154 | Train Loss: 1.034 Vali Loss: 6.061 Vali Acc: 0.169 Test Loss: 6.061 Test Acc: 0.169
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 52 | loss: 0.7877649
	speed: 0.5543s/iter; left time: 4128.0139s
Epoch: 52 cost time: 22.41377902030945
Epoch: 52, Steps: 154 | Train Loss: 1.117 Vali Loss: 7.019 Vali Acc: 0.177 Test Loss: 7.019 Test Acc: 0.177
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 53 | loss: 0.6016896
	speed: 0.5105s/iter; left time: 3722.9430s
Epoch: 53 cost time: 20.24043893814087
Epoch: 53, Steps: 154 | Train Loss: 1.513 Vali Loss: 7.667 Vali Acc: 0.181 Test Loss: 7.667 Test Acc: 0.181
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 54 | loss: 3.3098218
	speed: 0.5788s/iter; left time: 4131.9958s
Epoch: 54 cost time: 23.989339113235474
Epoch: 54, Steps: 154 | Train Loss: 0.950 Vali Loss: 8.905 Vali Acc: 0.182 Test Loss: 8.905 Test Acc: 0.182
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39497161394971614
model parameter : 1600606
model size : 15.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7116550
	speed: 0.1353s/iter; left time: 2070.8312s
Epoch: 1 cost time: 21.41446304321289
Epoch: 1, Steps: 154 | Train Loss: 2.283 Vali Loss: 2.231 Vali Acc: 0.329 Test Loss: 2.231 Test Acc: 0.329
Validation loss decreased (inf --> -0.328850).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0074580
	speed: 0.5466s/iter; left time: 8278.9947s
Epoch: 2 cost time: 21.929763317108154
Epoch: 2, Steps: 154 | Train Loss: 2.134 Vali Loss: 2.318 Vali Acc: 0.322 Test Loss: 2.318 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.5084000
	speed: 0.5502s/iter; left time: 8248.6579s
Epoch: 3 cost time: 21.515958309173584
Epoch: 3, Steps: 154 | Train Loss: 2.028 Vali Loss: 2.360 Vali Acc: 0.336 Test Loss: 2.360 Test Acc: 0.336
Validation loss decreased (-0.328850 --> -0.335743).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7685895
	speed: 0.5454s/iter; left time: 8093.7276s
Epoch: 4 cost time: 22.589228868484497
Epoch: 4, Steps: 154 | Train Loss: 1.909 Vali Loss: 2.657 Vali Acc: 0.335 Test Loss: 2.657 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9318647
	speed: 0.5659s/iter; left time: 8310.1971s
Epoch: 5 cost time: 22.07323956489563
Epoch: 5, Steps: 154 | Train Loss: 1.834 Vali Loss: 2.657 Vali Acc: 0.339 Test Loss: 2.657 Test Acc: 0.339
Validation loss decreased (-0.335743 --> -0.338984).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2342157
	speed: 0.5048s/iter; left time: 7335.2738s
Epoch: 6 cost time: 19.92409348487854
Epoch: 6, Steps: 154 | Train Loss: 1.900 Vali Loss: 2.723 Vali Acc: 0.082 Test Loss: 2.723 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.0575519
	speed: 0.5967s/iter; left time: 8579.3135s
Epoch: 7 cost time: 22.81611180305481
Epoch: 7, Steps: 154 | Train Loss: 2.142 Vali Loss: 2.436 Vali Acc: 0.348 Test Loss: 2.436 Test Acc: 0.348
Validation loss decreased (-0.338984 --> -0.348313).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9243200
	speed: 0.5484s/iter; left time: 7799.8085s
Epoch: 8 cost time: 21.21911358833313
Epoch: 8, Steps: 154 | Train Loss: 1.793 Vali Loss: 2.817 Vali Acc: 0.363 Test Loss: 2.817 Test Acc: 0.363
Validation loss decreased (-0.348313 --> -0.362502).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.2661614
	speed: 0.5296s/iter; left time: 7451.3325s
Epoch: 9 cost time: 21.42285466194153
Epoch: 9, Steps: 154 | Train Loss: 1.813 Vali Loss: 2.841 Vali Acc: 0.099 Test Loss: 2.841 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.8205885
	speed: 0.5414s/iter; left time: 7533.7256s
Epoch: 10 cost time: 21.417792558670044
Epoch: 10, Steps: 154 | Train Loss: 1.747 Vali Loss: 2.635 Vali Acc: 0.359 Test Loss: 2.635 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.8694304
	speed: 0.5363s/iter; left time: 7380.3975s
Epoch: 11 cost time: 22.836983680725098
Epoch: 11, Steps: 154 | Train Loss: 1.743 Vali Loss: 3.047 Vali Acc: 0.350 Test Loss: 3.047 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 3.3632960
	speed: 0.5614s/iter; left time: 7638.5819s
Epoch: 12 cost time: 22.44354510307312
Epoch: 12, Steps: 154 | Train Loss: 1.760 Vali Loss: 2.865 Vali Acc: 0.110 Test Loss: 2.865 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.3547766
	speed: 0.5430s/iter; left time: 7305.4515s
Epoch: 13 cost time: 22.57534670829773
Epoch: 13, Steps: 154 | Train Loss: 1.669 Vali Loss: 3.314 Vali Acc: 0.087 Test Loss: 3.314 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.7836093
	speed: 0.5594s/iter; left time: 7440.0239s
Epoch: 14 cost time: 23.525580644607544
Epoch: 14, Steps: 154 | Train Loss: 1.728 Vali Loss: 3.635 Vali Acc: 0.067 Test Loss: 3.635 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.8602581
	speed: 0.5598s/iter; left time: 7358.5775s
Epoch: 15 cost time: 22.67572045326233
Epoch: 15, Steps: 154 | Train Loss: 1.719 Vali Loss: 3.277 Vali Acc: 0.349 Test Loss: 3.277 Test Acc: 0.349
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 2.5756836
	speed: 0.5325s/iter; left time: 6918.2371s
Epoch: 16 cost time: 21.82808256149292
Epoch: 16, Steps: 154 | Train Loss: 1.775 Vali Loss: 4.102 Vali Acc: 0.066 Test Loss: 4.102 Test Acc: 0.066
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 2.1140950
	speed: 0.5805s/iter; left time: 7451.3543s
Epoch: 17 cost time: 24.49443292617798
Epoch: 17, Steps: 154 | Train Loss: 2.355 Vali Loss: 3.787 Vali Acc: 0.093 Test Loss: 3.787 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 2.2597604
	speed: 0.5552s/iter; left time: 7041.0676s
Epoch: 18 cost time: 20.513646602630615
Epoch: 18, Steps: 154 | Train Loss: 1.629 Vali Loss: 4.282 Vali Acc: 0.086 Test Loss: 4.282 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36253041362530414
model parameter : 1600606
model size : 15.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7171028
	speed: 0.1140s/iter; left time: 1744.1113s
Epoch: 1 cost time: 15.399441957473755
Epoch: 1, Steps: 154 | Train Loss: 2.268 Vali Loss: 2.255 Vali Acc: 0.329 Test Loss: 2.255 Test Acc: 0.329
Validation loss decreased (inf --> -0.329256).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0396142
	speed: 0.3644s/iter; left time: 5519.3298s
Epoch: 2 cost time: 13.362926721572876
Epoch: 2, Steps: 154 | Train Loss: 2.107 Vali Loss: 2.388 Vali Acc: 0.322 Test Loss: 2.388 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8355073
	speed: 0.4038s/iter; left time: 6054.4005s
Epoch: 3 cost time: 15.586162090301514
Epoch: 3, Steps: 154 | Train Loss: 1.953 Vali Loss: 2.329 Vali Acc: 0.334 Test Loss: 2.329 Test Acc: 0.334
Validation loss decreased (-0.329256 --> -0.334121).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7283874
	speed: 0.4308s/iter; left time: 6392.6579s
Epoch: 4 cost time: 14.589764833450317
Epoch: 4, Steps: 154 | Train Loss: 1.918 Vali Loss: 2.830 Vali Acc: 0.335 Test Loss: 2.830 Test Acc: 0.335
Validation loss decreased (-0.334121 --> -0.335333).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0390029
	speed: 0.3877s/iter; left time: 5693.8941s
Epoch: 5 cost time: 13.87428092956543
Epoch: 5, Steps: 154 | Train Loss: 1.960 Vali Loss: 2.592 Vali Acc: 0.343 Test Loss: 2.592 Test Acc: 0.343
Validation loss decreased (-0.335333 --> -0.342634).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9829838
	speed: 0.3824s/iter; left time: 5556.9019s
Epoch: 6 cost time: 13.9058256149292
Epoch: 6, Steps: 154 | Train Loss: 1.778 Vali Loss: 2.586 Vali Acc: 0.358 Test Loss: 2.586 Test Acc: 0.358
Validation loss decreased (-0.342634 --> -0.358044).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.5125179
	speed: 0.4092s/iter; left time: 5883.2061s
Epoch: 7 cost time: 15.251508951187134
Epoch: 7, Steps: 154 | Train Loss: 1.806 Vali Loss: 2.647 Vali Acc: 0.349 Test Loss: 2.647 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9346998
	speed: 0.4060s/iter; left time: 5775.0359s
Epoch: 8 cost time: 14.070673704147339
Epoch: 8, Steps: 154 | Train Loss: 1.796 Vali Loss: 3.164 Vali Acc: 0.071 Test Loss: 3.164 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.2922643
	speed: 0.4116s/iter; left time: 5790.3560s
Epoch: 9 cost time: 15.701526403427124
Epoch: 9, Steps: 154 | Train Loss: 1.851 Vali Loss: 3.078 Vali Acc: 0.127 Test Loss: 3.078 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.7677104
	speed: 0.3874s/iter; left time: 5390.3636s
Epoch: 10 cost time: 14.059314966201782
Epoch: 10, Steps: 154 | Train Loss: 1.801 Vali Loss: 2.673 Vali Acc: 0.357 Test Loss: 2.673 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.4974312
	speed: 0.3791s/iter; left time: 5216.4857s
Epoch: 11 cost time: 14.907236337661743
Epoch: 11, Steps: 154 | Train Loss: 1.654 Vali Loss: 3.299 Vali Acc: 0.352 Test Loss: 3.299 Test Acc: 0.352
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 3.6055918
	speed: 0.3565s/iter; left time: 4850.2391s
Epoch: 12 cost time: 12.28304386138916
Epoch: 12, Steps: 154 | Train Loss: 1.997 Vali Loss: 3.283 Vali Acc: 0.281 Test Loss: 3.283 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.8001878
	speed: 0.3221s/iter; left time: 4333.7148s
Epoch: 13 cost time: 11.385935306549072
Epoch: 13, Steps: 154 | Train Loss: 1.732 Vali Loss: 3.442 Vali Acc: 0.362 Test Loss: 3.442 Test Acc: 0.362
Validation loss decreased (-0.358044 --> -0.361685).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0336235
	speed: 0.3298s/iter; left time: 4385.4126s
Epoch: 14 cost time: 13.076910734176636
Epoch: 14, Steps: 154 | Train Loss: 1.644 Vali Loss: 3.406 Vali Acc: 0.199 Test Loss: 3.406 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.9324647
	speed: 0.3636s/iter; left time: 4780.0713s
Epoch: 15 cost time: 12.363048315048218
Epoch: 15, Steps: 154 | Train Loss: 1.723 Vali Loss: 3.566 Vali Acc: 0.364 Test Loss: 3.566 Test Acc: 0.364
Validation loss decreased (-0.361685 --> -0.364117).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.1491923
	speed: 0.3612s/iter; left time: 4691.7743s
Epoch: 16 cost time: 13.68450117111206
Epoch: 16, Steps: 154 | Train Loss: 1.725 Vali Loss: 3.931 Vali Acc: 0.107 Test Loss: 3.931 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.5297810
	speed: 0.3262s/iter; left time: 4187.2110s
Epoch: 17 cost time: 11.333489894866943
Epoch: 17, Steps: 154 | Train Loss: 1.685 Vali Loss: 3.894 Vali Acc: 0.192 Test Loss: 3.894 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.9249007
	speed: 0.2953s/iter; left time: 3745.6065s
Epoch: 18 cost time: 10.979532718658447
Epoch: 18, Steps: 154 | Train Loss: 1.614 Vali Loss: 4.440 Vali Acc: 0.096 Test Loss: 4.440 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.6756727
	speed: 0.3316s/iter; left time: 4154.4012s
Epoch: 19 cost time: 11.640565156936646
Epoch: 19, Steps: 154 | Train Loss: 1.794 Vali Loss: 4.665 Vali Acc: 0.091 Test Loss: 4.665 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.7253069
	speed: 0.3298s/iter; left time: 4080.8650s
Epoch: 20 cost time: 13.654066562652588
Epoch: 20, Steps: 154 | Train Loss: 1.680 Vali Loss: 4.769 Vali Acc: 0.094 Test Loss: 4.769 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.2334666
	speed: 0.3707s/iter; left time: 4530.8666s
Epoch: 21 cost time: 12.677875518798828
Epoch: 21, Steps: 154 | Train Loss: 1.430 Vali Loss: 4.494 Vali Acc: 0.081 Test Loss: 4.494 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.5378532
	speed: 0.3469s/iter; left time: 4186.1751s
Epoch: 22 cost time: 13.097703218460083
Epoch: 22, Steps: 154 | Train Loss: 1.802 Vali Loss: 4.185 Vali Acc: 0.362 Test Loss: 4.185 Test Acc: 0.362
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.1633677
	speed: 0.3680s/iter; left time: 4384.3981s
Epoch: 23 cost time: 13.507736682891846
Epoch: 23, Steps: 154 | Train Loss: 1.401 Vali Loss: 4.428 Vali Acc: 0.123 Test Loss: 4.428 Test Acc: 0.123
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.4141781
	speed: 0.3423s/iter; left time: 4025.4431s
Epoch: 24 cost time: 12.55622148513794
Epoch: 24, Steps: 154 | Train Loss: 1.407 Vali Loss: 5.038 Vali Acc: 0.111 Test Loss: 5.038 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.6301264
	speed: 0.3404s/iter; left time: 3950.2194s
Epoch: 25 cost time: 12.304133892059326
Epoch: 25, Steps: 154 | Train Loss: 1.252 Vali Loss: 4.553 Vali Acc: 0.352 Test Loss: 4.553 Test Acc: 0.352
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36415247364152475
model parameter : 1600606
model size : 15.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7647003
	speed: 0.1615s/iter; left time: 2470.7709s
Epoch: 1 cost time: 23.477536916732788
Epoch: 1, Steps: 154 | Train Loss: 2.218 Vali Loss: 2.259 Vali Acc: 0.324 Test Loss: 2.259 Test Acc: 0.324
Validation loss decreased (inf --> -0.324389).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9769299
	speed: 0.5318s/iter; left time: 8054.5213s
Epoch: 2 cost time: 21.056756019592285
Epoch: 2, Steps: 154 | Train Loss: 2.080 Vali Loss: 2.572 Vali Acc: 0.326 Test Loss: 2.572 Test Acc: 0.326
Validation loss decreased (-0.324389 --> -0.326008).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9520035
	speed: 0.5056s/iter; left time: 7580.1857s
Epoch: 3 cost time: 19.984802722930908
Epoch: 3, Steps: 154 | Train Loss: 1.922 Vali Loss: 2.355 Vali Acc: 0.339 Test Loss: 2.355 Test Acc: 0.339
Validation loss decreased (-0.326008 --> -0.338987).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5342113
	speed: 0.5185s/iter; left time: 7693.4275s
Epoch: 4 cost time: 19.856483697891235
Epoch: 4, Steps: 154 | Train Loss: 1.876 Vali Loss: 2.847 Vali Acc: 0.335 Test Loss: 2.847 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6653125
	speed: 0.4934s/iter; left time: 7245.7681s
Epoch: 5 cost time: 21.897523641586304
Epoch: 5, Steps: 154 | Train Loss: 1.867 Vali Loss: 2.653 Vali Acc: 0.350 Test Loss: 2.653 Test Acc: 0.350
Validation loss decreased (-0.338987 --> -0.349527).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7720996
	speed: 0.5231s/iter; left time: 7600.9821s
Epoch: 6 cost time: 20.266359329223633
Epoch: 6, Steps: 154 | Train Loss: 1.753 Vali Loss: 2.551 Vali Acc: 0.353 Test Loss: 2.551 Test Acc: 0.353
Validation loss decreased (-0.349527 --> -0.352773).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2447937
	speed: 0.5049s/iter; left time: 7259.3988s
Epoch: 7 cost time: 21.284510135650635
Epoch: 7, Steps: 154 | Train Loss: 1.757 Vali Loss: 2.681 Vali Acc: 0.351 Test Loss: 2.681 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9213272
	speed: 0.5281s/iter; left time: 7510.7128s
Epoch: 8 cost time: 20.17727565765381
Epoch: 8, Steps: 154 | Train Loss: 1.747 Vali Loss: 2.905 Vali Acc: 0.363 Test Loss: 2.905 Test Acc: 0.363
Validation loss decreased (-0.352773 --> -0.362501).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.0077636
	speed: 0.4833s/iter; left time: 6799.3912s
Epoch: 9 cost time: 19.093918800354004
Epoch: 9, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.736 Vali Acc: 0.355 Test Loss: 2.736 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.0081480
	speed: 0.5100s/iter; left time: 7097.1600s
Epoch: 10 cost time: 22.311235189437866
Epoch: 10, Steps: 154 | Train Loss: 1.721 Vali Loss: 2.977 Vali Acc: 0.362 Test Loss: 2.977 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2917696
	speed: 0.5093s/iter; left time: 7009.0524s
Epoch: 11 cost time: 19.604771852493286
Epoch: 11, Steps: 154 | Train Loss: 1.714 Vali Loss: 3.345 Vali Acc: 0.355 Test Loss: 3.345 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 4.0638337
	speed: 0.4926s/iter; left time: 6703.3545s
Epoch: 12 cost time: 21.183370351791382
Epoch: 12, Steps: 154 | Train Loss: 1.884 Vali Loss: 3.188 Vali Acc: 0.363 Test Loss: 3.188 Test Acc: 0.363
Validation loss decreased (-0.362501 --> -0.362904).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3562387
	speed: 0.5346s/iter; left time: 7191.8243s
Epoch: 13 cost time: 20.940649271011353
Epoch: 13, Steps: 154 | Train Loss: 1.558 Vali Loss: 3.702 Vali Acc: 0.359 Test Loss: 3.702 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.9059891
	speed: 0.5370s/iter; left time: 7141.0321s
Epoch: 14 cost time: 18.631776571273804
Epoch: 14, Steps: 154 | Train Loss: 1.734 Vali Loss: 3.453 Vali Acc: 0.363 Test Loss: 3.453 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.2742594
	speed: 0.4536s/iter; left time: 5962.0760s
Epoch: 15 cost time: 20.228250980377197
Epoch: 15, Steps: 154 | Train Loss: 1.522 Vali Loss: 3.522 Vali Acc: 0.366 Test Loss: 3.522 Test Acc: 0.366
Validation loss decreased (-0.362904 --> -0.365739).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3383992
	speed: 0.4987s/iter; left time: 6479.2232s
Epoch: 16 cost time: 19.54085421562195
Epoch: 16, Steps: 154 | Train Loss: 1.572 Vali Loss: 3.862 Vali Acc: 0.385 Test Loss: 3.862 Test Acc: 0.385
Validation loss decreased (-0.365739 --> -0.384795).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.9328302
	speed: 0.4989s/iter; left time: 6404.5628s
Epoch: 17 cost time: 20.326934814453125
Epoch: 17, Steps: 154 | Train Loss: 1.509 Vali Loss: 4.445 Vali Acc: 0.109 Test Loss: 4.445 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.1945698
	speed: 0.4793s/iter; left time: 6078.4554s
Epoch: 18 cost time: 18.715131282806396
Epoch: 18, Steps: 154 | Train Loss: 1.678 Vali Loss: 3.690 Vali Acc: 0.341 Test Loss: 3.690 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 2.1611152
	speed: 0.5026s/iter; left time: 6297.5351s
Epoch: 19 cost time: 20.889659881591797
Epoch: 19, Steps: 154 | Train Loss: 1.438 Vali Loss: 3.769 Vali Acc: 0.373 Test Loss: 3.769 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.0283588
	speed: 0.5144s/iter; left time: 6365.7907s
Epoch: 20 cost time: 19.274484157562256
Epoch: 20, Steps: 154 | Train Loss: 1.587 Vali Loss: 3.923 Vali Acc: 0.222 Test Loss: 3.923 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.6130923
	speed: 0.5146s/iter; left time: 6289.0751s
Epoch: 21 cost time: 19.3112154006958
Epoch: 21, Steps: 154 | Train Loss: 1.667 Vali Loss: 4.214 Vali Acc: 0.375 Test Loss: 4.214 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.3130163
	speed: 0.4937s/iter; left time: 5958.0411s
Epoch: 22 cost time: 19.383203506469727
Epoch: 22, Steps: 154 | Train Loss: 1.560 Vali Loss: 4.368 Vali Acc: 0.373 Test Loss: 4.368 Test Acc: 0.373
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.0077609
	speed: 0.4718s/iter; left time: 5620.6816s
Epoch: 23 cost time: 18.81583523750305
Epoch: 23, Steps: 154 | Train Loss: 1.324 Vali Loss: 3.578 Vali Acc: 0.380 Test Loss: 3.578 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.2269715
	speed: 0.4858s/iter; left time: 5713.0739s
Epoch: 24 cost time: 18.085330963134766
Epoch: 24, Steps: 154 | Train Loss: 1.306 Vali Loss: 4.568 Vali Acc: 0.377 Test Loss: 4.568 Test Acc: 0.377
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.7280867
	speed: 0.4426s/iter; left time: 5136.6416s
Epoch: 25 cost time: 19.61549186706543
Epoch: 25, Steps: 154 | Train Loss: 1.402 Vali Loss: 3.995 Vali Acc: 0.386 Test Loss: 3.995 Test Acc: 0.386
Validation loss decreased (-0.384795 --> -0.386416).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.0635512
	speed: 0.5086s/iter; left time: 5823.7301s
Epoch: 26 cost time: 18.199485301971436
Epoch: 26, Steps: 154 | Train Loss: 1.240 Vali Loss: 5.430 Vali Acc: 0.113 Test Loss: 5.430 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.5926524
	speed: 0.5059s/iter; left time: 5714.8585s
Epoch: 27 cost time: 21.564176559448242
Epoch: 27, Steps: 154 | Train Loss: 1.518 Vali Loss: 4.248 Vali Acc: 0.389 Test Loss: 4.248 Test Acc: 0.389
Validation loss decreased (-0.386416 --> -0.388846).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.9741369
	speed: 0.5010s/iter; left time: 5582.6857s
Epoch: 28 cost time: 19.313016653060913
Epoch: 28, Steps: 154 | Train Loss: 1.271 Vali Loss: 5.346 Vali Acc: 0.245 Test Loss: 5.346 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.8368168
	speed: 0.4817s/iter; left time: 5292.9881s
Epoch: 29 cost time: 20.244325160980225
Epoch: 29, Steps: 154 | Train Loss: 1.459 Vali Loss: 4.949 Vali Acc: 0.393 Test Loss: 4.949 Test Acc: 0.393
Validation loss decreased (-0.388846 --> -0.393300).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.3392342
	speed: 0.4740s/iter; left time: 5136.3077s
Epoch: 30 cost time: 19.167407035827637
Epoch: 30, Steps: 154 | Train Loss: 1.655 Vali Loss: 5.067 Vali Acc: 0.139 Test Loss: 5.067 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 15.6688251
	speed: 0.4769s/iter; left time: 5094.0446s
Epoch: 31 cost time: 18.488375186920166
Epoch: 31, Steps: 154 | Train Loss: 1.392 Vali Loss: 4.657 Vali Acc: 0.136 Test Loss: 4.657 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.1531525
	speed: 0.4686s/iter; left time: 4933.0683s
Epoch: 32 cost time: 21.91257381439209
Epoch: 32, Steps: 154 | Train Loss: 1.251 Vali Loss: 6.053 Vali Acc: 0.138 Test Loss: 6.053 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.6943737
	speed: 0.5118s/iter; left time: 5309.3387s
Epoch: 33 cost time: 20.13828206062317
Epoch: 33, Steps: 154 | Train Loss: 1.899 Vali Loss: 6.012 Vali Acc: 0.305 Test Loss: 6.012 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 1.3119836
	speed: 0.5202s/iter; left time: 5316.2331s
Epoch: 34 cost time: 20.675941467285156
Epoch: 34, Steps: 154 | Train Loss: 1.997 Vali Loss: 4.607 Vali Acc: 0.232 Test Loss: 4.607 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.3222176
	speed: 0.4776s/iter; left time: 4806.8133s
Epoch: 35 cost time: 19.40339231491089
Epoch: 35, Steps: 154 | Train Loss: 0.909 Vali Loss: 5.836 Vali Acc: 0.242 Test Loss: 5.836 Test Acc: 0.242
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 1.3223267
	speed: 0.4951s/iter; left time: 4906.7598s
Epoch: 36 cost time: 20.121614694595337
Epoch: 36, Steps: 154 | Train Loss: 1.035 Vali Loss: 6.594 Vali Acc: 0.391 Test Loss: 6.594 Test Acc: 0.391
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.5611335
	speed: 0.5076s/iter; left time: 4952.6860s
Epoch: 37 cost time: 21.20124650001526
Epoch: 37, Steps: 154 | Train Loss: 1.068 Vali Loss: 6.746 Vali Acc: 0.379 Test Loss: 6.746 Test Acc: 0.379
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 1.0783203
	speed: 0.4997s/iter; left time: 4798.7060s
Epoch: 38 cost time: 18.687056064605713
Epoch: 38, Steps: 154 | Train Loss: 0.844 Vali Loss: 7.143 Vali Acc: 0.378 Test Loss: 7.143 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 1.0044338
	speed: 0.4651s/iter; left time: 4394.4297s
Epoch: 39 cost time: 16.215609550476074
Epoch: 39, Steps: 154 | Train Loss: 0.836 Vali Loss: 8.985 Vali Acc: 0.209 Test Loss: 8.985 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3933495539334955
model parameter : 1600606
model size : 15.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1650538
	speed: 0.1497s/iter; left time: 2290.7842s
Epoch: 1 cost time: 22.178126573562622
Epoch: 1, Steps: 154 | Train Loss: 2.271 Vali Loss: 2.366 Vali Acc: 0.322 Test Loss: 2.366 Test Acc: 0.322
Validation loss decreased (inf --> -0.321550).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7500000
	speed: 0.4722s/iter; left time: 7152.6774s
Epoch: 2 cost time: 18.92180633544922
Epoch: 2, Steps: 154 | Train Loss: 2.131 Vali Loss: 2.301 Vali Acc: 0.339 Test Loss: 2.301 Test Acc: 0.339
Validation loss decreased (-0.321550 --> -0.339393).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5781828
	speed: 0.5014s/iter; left time: 7516.9925s
Epoch: 3 cost time: 19.82968258857727
Epoch: 3, Steps: 154 | Train Loss: 2.016 Vali Loss: 2.581 Vali Acc: 0.326 Test Loss: 2.581 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 5.0002513
	speed: 0.4824s/iter; left time: 7158.7228s
Epoch: 4 cost time: 19.926034688949585
Epoch: 4, Steps: 154 | Train Loss: 1.970 Vali Loss: 2.710 Vali Acc: 0.333 Test Loss: 2.710 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.8601499
	speed: 0.4842s/iter; left time: 7111.1658s
Epoch: 5 cost time: 19.68586039543152
Epoch: 5, Steps: 154 | Train Loss: 1.911 Vali Loss: 2.571 Vali Acc: 0.339 Test Loss: 2.571 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.3973471
	speed: 0.4647s/iter; left time: 6752.3627s
Epoch: 6 cost time: 20.272042512893677
Epoch: 6, Steps: 154 | Train Loss: 1.905 Vali Loss: 2.775 Vali Acc: 0.330 Test Loss: 2.775 Test Acc: 0.330
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.5092171
	speed: 0.5090s/iter; left time: 7317.7705s
Epoch: 7 cost time: 20.314494132995605
Epoch: 7, Steps: 154 | Train Loss: 1.752 Vali Loss: 3.140 Vali Acc: 0.344 Test Loss: 3.140 Test Acc: 0.344
Validation loss decreased (-0.339393 --> -0.344251).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3730668
	speed: 0.4973s/iter; left time: 7073.4103s
Epoch: 8 cost time: 18.793983697891235
Epoch: 8, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.863 Vali Acc: 0.351 Test Loss: 2.863 Test Acc: 0.351
Validation loss decreased (-0.344251 --> -0.351147).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8230872
	speed: 0.4787s/iter; left time: 6734.2650s
Epoch: 9 cost time: 19.545554399490356
Epoch: 9, Steps: 154 | Train Loss: 1.759 Vali Loss: 3.245 Vali Acc: 0.350 Test Loss: 3.245 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4374101
	speed: 0.4857s/iter; left time: 6758.5836s
Epoch: 10 cost time: 18.973732948303223
Epoch: 10, Steps: 154 | Train Loss: 2.082 Vali Loss: 2.801 Vali Acc: 0.339 Test Loss: 2.801 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.7931551
	speed: 0.4732s/iter; left time: 6512.2572s
Epoch: 11 cost time: 18.356120109558105
Epoch: 11, Steps: 154 | Train Loss: 1.783 Vali Loss: 3.097 Vali Acc: 0.088 Test Loss: 3.097 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.2037449
	speed: 0.4792s/iter; left time: 6519.8092s
Epoch: 12 cost time: 18.54409646987915
Epoch: 12, Steps: 154 | Train Loss: 1.682 Vali Loss: 3.354 Vali Acc: 0.317 Test Loss: 3.354 Test Acc: 0.317
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.2653508
	speed: 0.4535s/iter; left time: 6100.3693s
Epoch: 13 cost time: 12.422086954116821
Epoch: 13, Steps: 154 | Train Loss: 1.803 Vali Loss: 3.377 Vali Acc: 0.077 Test Loss: 3.377 Test Acc: 0.077
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 7.8946495
	speed: 0.4546s/iter; left time: 6046.2515s
Epoch: 14 cost time: 19.03658390045166
Epoch: 14, Steps: 154 | Train Loss: 1.849 Vali Loss: 3.382 Vali Acc: 0.352 Test Loss: 3.382 Test Acc: 0.352
Validation loss decreased (-0.351147 --> -0.352359).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.1904457
	speed: 0.4806s/iter; left time: 6317.8618s
Epoch: 15 cost time: 19.703466176986694
Epoch: 15, Steps: 154 | Train Loss: 1.818 Vali Loss: 3.308 Vali Acc: 0.150 Test Loss: 3.308 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.2417488
	speed: 0.4775s/iter; left time: 6203.2793s
Epoch: 16 cost time: 18.782759428024292
Epoch: 16, Steps: 154 | Train Loss: 1.757 Vali Loss: 3.364 Vali Acc: 0.363 Test Loss: 3.364 Test Acc: 0.363
Validation loss decreased (-0.352359 --> -0.363308).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.5502195
	speed: 0.4693s/iter; left time: 6024.0509s
Epoch: 17 cost time: 18.81348705291748
Epoch: 17, Steps: 154 | Train Loss: 1.593 Vali Loss: 3.499 Vali Acc: 0.164 Test Loss: 3.499 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.4213434
	speed: 0.4720s/iter; left time: 5986.0653s
Epoch: 18 cost time: 19.821969270706177
Epoch: 18, Steps: 154 | Train Loss: 1.662 Vali Loss: 3.414 Vali Acc: 0.372 Test Loss: 3.414 Test Acc: 0.372
Validation loss decreased (-0.363308 --> -0.372229).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.7138642
	speed: 0.4605s/iter; left time: 5769.0464s
Epoch: 19 cost time: 18.944725275039673
Epoch: 19, Steps: 154 | Train Loss: 1.604 Vali Loss: 3.854 Vali Acc: 0.197 Test Loss: 3.854 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1124860
	speed: 0.5178s/iter; left time: 6407.1738s
Epoch: 20 cost time: 20.677428245544434
Epoch: 20, Steps: 154 | Train Loss: 1.458 Vali Loss: 4.147 Vali Acc: 0.091 Test Loss: 4.147 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.9517765
	speed: 0.4760s/iter; left time: 5816.9953s
Epoch: 21 cost time: 19.07541012763977
Epoch: 21, Steps: 154 | Train Loss: 1.594 Vali Loss: 3.828 Vali Acc: 0.194 Test Loss: 3.828 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.4958602
	speed: 0.4640s/iter; left time: 5599.6705s
Epoch: 22 cost time: 18.02745747566223
Epoch: 22, Steps: 154 | Train Loss: 1.570 Vali Loss: 3.904 Vali Acc: 0.099 Test Loss: 3.904 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.3396080
	speed: 0.4407s/iter; left time: 5250.6478s
Epoch: 23 cost time: 16.603835344314575
Epoch: 23, Steps: 154 | Train Loss: 1.487 Vali Loss: 4.100 Vali Acc: 0.210 Test Loss: 4.100 Test Acc: 0.210
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.2924018
	speed: 0.4507s/iter; left time: 5300.1857s
Epoch: 24 cost time: 18.43752908706665
Epoch: 24, Steps: 154 | Train Loss: 1.617 Vali Loss: 5.072 Vali Acc: 0.127 Test Loss: 5.072 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.4140577
	speed: 0.5053s/iter; left time: 5863.6205s
Epoch: 25 cost time: 18.940025568008423
Epoch: 25, Steps: 154 | Train Loss: 1.536 Vali Loss: 5.599 Vali Acc: 0.087 Test Loss: 5.599 Test Acc: 0.087
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.4144382
	speed: 0.4936s/iter; left time: 5652.4472s
Epoch: 26 cost time: 20.688199758529663
Epoch: 26, Steps: 154 | Train Loss: 1.379 Vali Loss: 4.671 Vali Acc: 0.087 Test Loss: 4.671 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.7109505
	speed: 0.4692s/iter; left time: 5301.0691s
Epoch: 27 cost time: 18.368257522583008
Epoch: 27, Steps: 154 | Train Loss: 1.513 Vali Loss: 4.368 Vali Acc: 0.111 Test Loss: 4.368 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.1058939
	speed: 0.4389s/iter; left time: 4890.7193s
Epoch: 28 cost time: 15.5497465133667
Epoch: 28, Steps: 154 | Train Loss: 2.228 Vali Loss: 4.326 Vali Acc: 0.133 Test Loss: 4.326 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3722627737226277
model parameter : 1469534
model size : 15.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1371684
	speed: 0.1256s/iter; left time: 1921.8196s
Epoch: 1 cost time: 18.2947359085083
Epoch: 1, Steps: 154 | Train Loss: 2.257 Vali Loss: 2.362 Vali Acc: 0.322 Test Loss: 2.362 Test Acc: 0.322
Validation loss decreased (inf --> -0.322361).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7541015
	speed: 0.4722s/iter; left time: 7152.4718s
Epoch: 2 cost time: 19.161717891693115
Epoch: 2, Steps: 154 | Train Loss: 2.070 Vali Loss: 2.304 Vali Acc: 0.333 Test Loss: 2.304 Test Acc: 0.333
Validation loss decreased (-0.322361 --> -0.332499).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6812285
	speed: 0.4721s/iter; left time: 7077.9333s
Epoch: 3 cost time: 17.86026430130005
Epoch: 3, Steps: 154 | Train Loss: 1.955 Vali Loss: 2.634 Vali Acc: 0.328 Test Loss: 2.634 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.2882365
	speed: 0.4667s/iter; left time: 6925.5530s
Epoch: 4 cost time: 18.683534622192383
Epoch: 4, Steps: 154 | Train Loss: 2.014 Vali Loss: 2.882 Vali Acc: 0.333 Test Loss: 2.882 Test Acc: 0.333
Validation loss decreased (-0.332499 --> -0.332899).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8680116
	speed: 0.4264s/iter; left time: 6261.2408s
Epoch: 5 cost time: 17.48660135269165
Epoch: 5, Steps: 154 | Train Loss: 1.974 Vali Loss: 2.598 Vali Acc: 0.341 Test Loss: 2.598 Test Acc: 0.341
Validation loss decreased (-0.332899 --> -0.341418).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2225150
	speed: 0.4396s/iter; left time: 6388.3443s
Epoch: 6 cost time: 17.721168279647827
Epoch: 6, Steps: 154 | Train Loss: 1.875 Vali Loss: 2.932 Vali Acc: 0.095 Test Loss: 2.932 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8136617
	speed: 0.4606s/iter; left time: 6621.8460s
Epoch: 7 cost time: 18.069955825805664
Epoch: 7, Steps: 154 | Train Loss: 1.741 Vali Loss: 2.866 Vali Acc: 0.354 Test Loss: 2.866 Test Acc: 0.354
Validation loss decreased (-0.341418 --> -0.353580).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3953489
	speed: 0.4611s/iter; left time: 6558.6853s
Epoch: 8 cost time: 18.9141104221344
Epoch: 8, Steps: 154 | Train Loss: 1.737 Vali Loss: 2.874 Vali Acc: 0.354 Test Loss: 2.874 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6920090
	speed: 0.4702s/iter; left time: 6615.3297s
Epoch: 9 cost time: 16.707377910614014
Epoch: 9, Steps: 154 | Train Loss: 1.754 Vali Loss: 3.066 Vali Acc: 0.359 Test Loss: 3.066 Test Acc: 0.359
Validation loss decreased (-0.353580 --> -0.359256).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5682486
	speed: 0.4533s/iter; left time: 6307.6299s
Epoch: 10 cost time: 17.48663067817688
Epoch: 10, Steps: 154 | Train Loss: 1.778 Vali Loss: 2.650 Vali Acc: 0.365 Test Loss: 2.650 Test Acc: 0.365
Validation loss decreased (-0.359256 --> -0.365343).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9277238
	speed: 0.4330s/iter; left time: 5958.0543s
Epoch: 11 cost time: 18.315747022628784
Epoch: 11, Steps: 154 | Train Loss: 1.673 Vali Loss: 2.800 Vali Acc: 0.371 Test Loss: 2.800 Test Acc: 0.371
Validation loss decreased (-0.365343 --> -0.371018).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5448229
	speed: 0.4725s/iter; left time: 6429.5519s
Epoch: 12 cost time: 18.061843395233154
Epoch: 12, Steps: 154 | Train Loss: 1.662 Vali Loss: 3.314 Vali Acc: 0.176 Test Loss: 3.314 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.0092005
	speed: 0.4684s/iter; left time: 6301.6934s
Epoch: 13 cost time: 19.369465351104736
Epoch: 13, Steps: 154 | Train Loss: 2.070 Vali Loss: 3.338 Vali Acc: 0.098 Test Loss: 3.338 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.6406544
	speed: 0.4674s/iter; left time: 6216.1627s
Epoch: 14 cost time: 18.224285125732422
Epoch: 14, Steps: 154 | Train Loss: 1.645 Vali Loss: 3.375 Vali Acc: 0.360 Test Loss: 3.375 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.6323320
	speed: 0.4495s/iter; left time: 5908.3762s
Epoch: 15 cost time: 17.787657737731934
Epoch: 15, Steps: 154 | Train Loss: 1.576 Vali Loss: 3.385 Vali Acc: 0.151 Test Loss: 3.385 Test Acc: 0.151
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.6327345
	speed: 0.4628s/iter; left time: 6012.6212s
Epoch: 16 cost time: 18.52013325691223
Epoch: 16, Steps: 154 | Train Loss: 1.558 Vali Loss: 3.363 Vali Acc: 0.373 Test Loss: 3.363 Test Acc: 0.373
Validation loss decreased (-0.371018 --> -0.373040).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.4316527
	speed: 0.4410s/iter; left time: 5661.1644s
Epoch: 17 cost time: 17.28240656852722
Epoch: 17, Steps: 154 | Train Loss: 1.565 Vali Loss: 3.091 Vali Acc: 0.361 Test Loss: 3.091 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.0562814
	speed: 0.4517s/iter; left time: 5728.2781s
Epoch: 18 cost time: 17.195719480514526
Epoch: 18, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.950 Vali Acc: 0.378 Test Loss: 2.950 Test Acc: 0.378
Validation loss decreased (-0.373040 --> -0.377910).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.3038112
	speed: 0.4541s/iter; left time: 5689.4956s
Epoch: 19 cost time: 18.145591020584106
Epoch: 19, Steps: 154 | Train Loss: 1.534 Vali Loss: 3.189 Vali Acc: 0.212 Test Loss: 3.189 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1947113
	speed: 0.4810s/iter; left time: 5952.2633s
Epoch: 20 cost time: 17.224194765090942
Epoch: 20, Steps: 154 | Train Loss: 1.539 Vali Loss: 3.491 Vali Acc: 0.097 Test Loss: 3.491 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.9037757
	speed: 0.4401s/iter; left time: 5378.7462s
Epoch: 21 cost time: 19.080113172531128
Epoch: 21, Steps: 154 | Train Loss: 1.507 Vali Loss: 3.480 Vali Acc: 0.101 Test Loss: 3.480 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.1355374
	speed: 0.4512s/iter; left time: 5444.9337s
Epoch: 22 cost time: 16.65105891227722
Epoch: 22, Steps: 154 | Train Loss: 2.064 Vali Loss: 3.788 Vali Acc: 0.316 Test Loss: 3.788 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.9466658
	speed: 0.4477s/iter; left time: 5333.4624s
Epoch: 23 cost time: 17.532378911972046
Epoch: 23, Steps: 154 | Train Loss: 1.436 Vali Loss: 4.100 Vali Acc: 0.159 Test Loss: 4.100 Test Acc: 0.159
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.8350209
	speed: 0.4515s/iter; left time: 5309.4971s
Epoch: 24 cost time: 18.51669144630432
Epoch: 24, Steps: 154 | Train Loss: 1.764 Vali Loss: 4.775 Vali Acc: 0.074 Test Loss: 4.775 Test Acc: 0.074
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.5359938
	speed: 0.3952s/iter; left time: 4586.6505s
Epoch: 25 cost time: 16.49644422531128
Epoch: 25, Steps: 154 | Train Loss: 1.390 Vali Loss: 4.901 Vali Acc: 0.363 Test Loss: 4.901 Test Acc: 0.363
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.1466516
	speed: 0.4506s/iter; left time: 5159.4676s
Epoch: 26 cost time: 17.21149754524231
Epoch: 26, Steps: 154 | Train Loss: 1.595 Vali Loss: 4.897 Vali Acc: 0.084 Test Loss: 4.897 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.9483750
	speed: 0.4589s/iter; left time: 5184.2166s
Epoch: 27 cost time: 18.017078399658203
Epoch: 27, Steps: 154 | Train Loss: 1.213 Vali Loss: 4.709 Vali Acc: 0.127 Test Loss: 4.709 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.0825862
	speed: 0.4693s/iter; left time: 5229.7112s
Epoch: 28 cost time: 15.782577991485596
Epoch: 28, Steps: 154 | Train Loss: 1.356 Vali Loss: 4.894 Vali Acc: 0.189 Test Loss: 4.894 Test Acc: 0.189
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37793998377939986
model parameter : 1469534
model size : 15.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1477611
	speed: 0.1204s/iter; left time: 1842.6571s
Epoch: 1 cost time: 17.56987166404724
Epoch: 1, Steps: 154 | Train Loss: 2.239 Vali Loss: 2.386 Vali Acc: 0.322 Test Loss: 2.386 Test Acc: 0.322
Validation loss decreased (inf --> -0.321955).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8663764
	speed: 0.4118s/iter; left time: 6237.6619s
Epoch: 2 cost time: 15.87942624092102
Epoch: 2, Steps: 154 | Train Loss: 2.054 Vali Loss: 2.350 Vali Acc: 0.328 Test Loss: 2.350 Test Acc: 0.328
Validation loss decreased (-0.321955 --> -0.327633).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8473097
	speed: 0.4453s/iter; left time: 6675.6856s
Epoch: 3 cost time: 17.74403190612793
Epoch: 3, Steps: 154 | Train Loss: 1.987 Vali Loss: 2.750 Vali Acc: 0.332 Test Loss: 2.750 Test Acc: 0.332
Validation loss decreased (-0.327633 --> -0.332089).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6688130
	speed: 0.4794s/iter; left time: 7114.5346s
Epoch: 4 cost time: 18.34841752052307
Epoch: 4, Steps: 154 | Train Loss: 1.862 Vali Loss: 2.885 Vali Acc: 0.336 Test Loss: 2.885 Test Acc: 0.336
Validation loss decreased (-0.332089 --> -0.336143).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7840741
	speed: 0.4727s/iter; left time: 6941.0887s
Epoch: 5 cost time: 16.30574107170105
Epoch: 5, Steps: 154 | Train Loss: 1.877 Vali Loss: 2.506 Vali Acc: 0.341 Test Loss: 2.506 Test Acc: 0.341
Validation loss decreased (-0.336143 --> -0.341419).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2281241
	speed: 0.4219s/iter; left time: 6130.6690s
Epoch: 6 cost time: 16.895034551620483
Epoch: 6, Steps: 154 | Train Loss: 1.823 Vali Loss: 2.868 Vali Acc: 0.353 Test Loss: 2.868 Test Acc: 0.353
Validation loss decreased (-0.341419 --> -0.352769).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7290478
	speed: 0.4493s/iter; left time: 6458.9331s
Epoch: 7 cost time: 17.429022550582886
Epoch: 7, Steps: 154 | Train Loss: 1.768 Vali Loss: 2.899 Vali Acc: 0.343 Test Loss: 2.899 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3997890
	speed: 0.4328s/iter; left time: 6156.1571s
Epoch: 8 cost time: 16.641247510910034
Epoch: 8, Steps: 154 | Train Loss: 1.673 Vali Loss: 2.875 Vali Acc: 0.352 Test Loss: 2.875 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.2841108
	speed: 0.3707s/iter; left time: 5215.3256s
Epoch: 9 cost time: 17.168993711471558
Epoch: 9, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.867 Vali Acc: 0.359 Test Loss: 2.867 Test Acc: 0.359
Validation loss decreased (-0.352769 --> -0.359258).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2381390
	speed: 0.4313s/iter; left time: 6001.2822s
Epoch: 10 cost time: 17.075143098831177
Epoch: 10, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.700 Vali Acc: 0.365 Test Loss: 2.700 Test Acc: 0.365
Validation loss decreased (-0.359258 --> -0.364937).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9238356
	speed: 0.4620s/iter; left time: 6358.2624s
Epoch: 11 cost time: 18.205111980438232
Epoch: 11, Steps: 154 | Train Loss: 1.848 Vali Loss: 2.964 Vali Acc: 0.363 Test Loss: 2.964 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4182426
	speed: 0.4281s/iter; left time: 5824.8763s
Epoch: 12 cost time: 17.274831533432007
Epoch: 12, Steps: 154 | Train Loss: 1.785 Vali Loss: 3.423 Vali Acc: 0.093 Test Loss: 3.423 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.8420199
	speed: 0.4274s/iter; left time: 5749.3050s
Epoch: 13 cost time: 16.262421131134033
Epoch: 13, Steps: 154 | Train Loss: 1.620 Vali Loss: 3.706 Vali Acc: 0.090 Test Loss: 3.706 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.7258432
	speed: 0.4117s/iter; left time: 5474.9282s
Epoch: 14 cost time: 15.52143144607544
Epoch: 14, Steps: 154 | Train Loss: 1.611 Vali Loss: 3.889 Vali Acc: 0.326 Test Loss: 3.889 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.7134098
	speed: 0.4104s/iter; left time: 5394.3166s
Epoch: 15 cost time: 16.64702320098877
Epoch: 15, Steps: 154 | Train Loss: 1.838 Vali Loss: 3.715 Vali Acc: 0.378 Test Loss: 3.715 Test Acc: 0.378
Validation loss decreased (-0.364937 --> -0.378308).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.2939394
	speed: 0.4337s/iter; left time: 5634.1617s
Epoch: 16 cost time: 16.143258571624756
Epoch: 16, Steps: 154 | Train Loss: 1.475 Vali Loss: 3.399 Vali Acc: 0.375 Test Loss: 3.399 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.2076358
	speed: 0.4502s/iter; left time: 5779.6102s
Epoch: 17 cost time: 17.632339477539062
Epoch: 17, Steps: 154 | Train Loss: 1.572 Vali Loss: 3.992 Vali Acc: 0.099 Test Loss: 3.992 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.1584357
	speed: 0.3975s/iter; left time: 5040.9127s
Epoch: 18 cost time: 14.966167211532593
Epoch: 18, Steps: 154 | Train Loss: 1.595 Vali Loss: 3.283 Vali Acc: 0.393 Test Loss: 3.283 Test Acc: 0.393
Validation loss decreased (-0.378308 --> -0.393317).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.4597366
	speed: 0.4499s/iter; left time: 5636.7535s
Epoch: 19 cost time: 15.452386856079102
Epoch: 19, Steps: 154 | Train Loss: 1.513 Vali Loss: 3.983 Vali Acc: 0.210 Test Loss: 3.983 Test Acc: 0.210
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1914178
	speed: 0.4399s/iter; left time: 5443.1923s
Epoch: 20 cost time: 18.38205623626709
Epoch: 20, Steps: 154 | Train Loss: 1.516 Vali Loss: 4.031 Vali Acc: 0.398 Test Loss: 4.031 Test Acc: 0.398
Validation loss decreased (-0.393317 --> -0.397770).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.6469839
	speed: 0.4406s/iter; left time: 5385.0641s
Epoch: 21 cost time: 17.574336767196655
Epoch: 21, Steps: 154 | Train Loss: 1.804 Vali Loss: 4.032 Vali Acc: 0.153 Test Loss: 4.032 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.3847784
	speed: 0.4377s/iter; left time: 5281.1651s
Epoch: 22 cost time: 17.471940755844116
Epoch: 22, Steps: 154 | Train Loss: 1.571 Vali Loss: 4.577 Vali Acc: 0.265 Test Loss: 4.577 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.3436949
	speed: 0.4389s/iter; left time: 5228.2422s
Epoch: 23 cost time: 17.987653732299805
Epoch: 23, Steps: 154 | Train Loss: 1.996 Vali Loss: 5.142 Vali Acc: 0.374 Test Loss: 5.142 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.1707997
	speed: 0.4234s/iter; left time: 4979.0160s
Epoch: 24 cost time: 12.875843524932861
Epoch: 24, Steps: 154 | Train Loss: 1.258 Vali Loss: 4.617 Vali Acc: 0.239 Test Loss: 4.617 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 1.7495533
	speed: 0.4292s/iter; left time: 4980.8866s
Epoch: 25 cost time: 17.194183826446533
Epoch: 25, Steps: 154 | Train Loss: 1.268 Vali Loss: 4.991 Vali Acc: 0.380 Test Loss: 4.991 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 1.1764315
	speed: 0.4420s/iter; left time: 5061.0494s
Epoch: 26 cost time: 16.75502061843872
Epoch: 26, Steps: 154 | Train Loss: 1.175 Vali Loss: 5.919 Vali Acc: 0.116 Test Loss: 5.919 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.6910077
	speed: 0.4303s/iter; left time: 4860.6966s
Epoch: 27 cost time: 16.184412956237793
Epoch: 27, Steps: 154 | Train Loss: 1.167 Vali Loss: 4.789 Vali Acc: 0.377 Test Loss: 4.789 Test Acc: 0.377
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 1.6910919
	speed: 0.4484s/iter; left time: 4996.6146s
Epoch: 28 cost time: 17.050477981567383
Epoch: 28, Steps: 154 | Train Loss: 1.181 Vali Loss: 5.210 Vali Acc: 0.190 Test Loss: 5.210 Test Acc: 0.190
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.5294742
	speed: 0.3856s/iter; left time: 4237.6961s
Epoch: 29 cost time: 14.367405891418457
Epoch: 29, Steps: 154 | Train Loss: 1.205 Vali Loss: 5.112 Vali Acc: 0.384 Test Loss: 5.112 Test Acc: 0.384
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.9490480
	speed: 0.4459s/iter; left time: 4831.2723s
Epoch: 30 cost time: 16.91027593612671
Epoch: 30, Steps: 154 | Train Loss: 1.851 Vali Loss: 4.500 Vali Acc: 0.394 Test Loss: 4.500 Test Acc: 0.394
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3978102189781022
model parameter : 1469534
model size : 15.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1536345
	speed: 0.1276s/iter; left time: 1952.2164s
Epoch: 1 cost time: 17.798534154891968
Epoch: 1, Steps: 154 | Train Loss: 2.211 Vali Loss: 2.432 Vali Acc: 0.323 Test Loss: 2.432 Test Acc: 0.323
Validation loss decreased (inf --> -0.323171).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9704777
	speed: 0.4074s/iter; left time: 6170.9770s
Epoch: 2 cost time: 17.142277717590332
Epoch: 2, Steps: 154 | Train Loss: 2.065 Vali Loss: 2.208 Vali Acc: 0.333 Test Loss: 2.208 Test Acc: 0.333
Validation loss decreased (-0.323171 --> -0.333311).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5580878
	speed: 0.4203s/iter; left time: 6301.6038s
Epoch: 3 cost time: 15.187180042266846
Epoch: 3, Steps: 154 | Train Loss: 1.898 Vali Loss: 3.079 Vali Acc: 0.333 Test Loss: 3.079 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1755674
	speed: 0.4186s/iter; left time: 6210.9430s
Epoch: 4 cost time: 15.055577993392944
Epoch: 4, Steps: 154 | Train Loss: 1.960 Vali Loss: 3.263 Vali Acc: 0.335 Test Loss: 3.263 Test Acc: 0.335
Validation loss decreased (-0.333311 --> -0.334923).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7698145
	speed: 0.4171s/iter; left time: 6124.5647s
Epoch: 5 cost time: 19.074939727783203
Epoch: 5, Steps: 154 | Train Loss: 1.715 Vali Loss: 2.628 Vali Acc: 0.349 Test Loss: 2.628 Test Acc: 0.349
Validation loss decreased (-0.334923 --> -0.349122).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1414620
	speed: 0.4771s/iter; left time: 6932.6714s
Epoch: 6 cost time: 17.89164972305298
Epoch: 6, Steps: 154 | Train Loss: 1.713 Vali Loss: 3.039 Vali Acc: 0.354 Test Loss: 3.039 Test Acc: 0.354
Validation loss decreased (-0.349122 --> -0.353984).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4263599
	speed: 0.4727s/iter; left time: 6795.9101s
Epoch: 7 cost time: 16.241844177246094
Epoch: 7, Steps: 154 | Train Loss: 1.703 Vali Loss: 3.493 Vali Acc: 0.342 Test Loss: 3.493 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.1709738
	speed: 0.4393s/iter; left time: 6248.0933s
Epoch: 8 cost time: 18.276453495025635
Epoch: 8, Steps: 154 | Train Loss: 1.746 Vali Loss: 3.155 Vali Acc: 0.352 Test Loss: 3.155 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7215704
	speed: 0.4366s/iter; left time: 6142.5503s
Epoch: 9 cost time: 15.898589611053467
Epoch: 9, Steps: 154 | Train Loss: 1.651 Vali Loss: 2.854 Vali Acc: 0.357 Test Loss: 2.854 Test Acc: 0.357
Validation loss decreased (-0.353984 --> -0.356825).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3534430
	speed: 0.4547s/iter; left time: 6327.4019s
Epoch: 10 cost time: 18.892802000045776
Epoch: 10, Steps: 154 | Train Loss: 1.801 Vali Loss: 2.567 Vali Acc: 0.377 Test Loss: 2.567 Test Acc: 0.377
Validation loss decreased (-0.356825 --> -0.377103).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7570060
	speed: 0.4706s/iter; left time: 6476.3891s
Epoch: 11 cost time: 18.56988215446472
Epoch: 11, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.727 Vali Acc: 0.252 Test Loss: 2.727 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.5824982
	speed: 0.4729s/iter; left time: 6435.2812s
Epoch: 12 cost time: 17.876179933547974
Epoch: 12, Steps: 154 | Train Loss: 1.502 Vali Loss: 3.503 Vali Acc: 0.293 Test Loss: 3.503 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5334370
	speed: 0.5068s/iter; left time: 6817.3313s
Epoch: 13 cost time: 19.79574990272522
Epoch: 13, Steps: 154 | Train Loss: 1.634 Vali Loss: 3.107 Vali Acc: 0.112 Test Loss: 3.107 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.9391154
	speed: 0.4503s/iter; left time: 5988.5620s
Epoch: 14 cost time: 16.406341075897217
Epoch: 14, Steps: 154 | Train Loss: 1.562 Vali Loss: 3.487 Vali Acc: 0.162 Test Loss: 3.487 Test Acc: 0.162
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.0605211
	speed: 0.4470s/iter; left time: 5875.2194s
Epoch: 15 cost time: 16.67046546936035
Epoch: 15, Steps: 154 | Train Loss: 2.068 Vali Loss: 3.935 Vali Acc: 0.100 Test Loss: 3.935 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.9077246
	speed: 0.4427s/iter; left time: 5750.6746s
Epoch: 16 cost time: 17.507136821746826
Epoch: 16, Steps: 154 | Train Loss: 1.532 Vali Loss: 3.425 Vali Acc: 0.387 Test Loss: 3.425 Test Acc: 0.387
Validation loss decreased (-0.377103 --> -0.386827).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0828373
	speed: 0.4064s/iter; left time: 5217.5099s
Epoch: 17 cost time: 12.792579174041748
Epoch: 17, Steps: 154 | Train Loss: 1.350 Vali Loss: 3.663 Vali Acc: 0.358 Test Loss: 3.663 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 3.5293555
	speed: 0.4453s/iter; left time: 5647.2876s
Epoch: 18 cost time: 17.121691465377808
Epoch: 18, Steps: 154 | Train Loss: 1.411 Vali Loss: 3.638 Vali Acc: 0.377 Test Loss: 3.638 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.4229205
	speed: 0.4801s/iter; left time: 6014.5818s
Epoch: 19 cost time: 17.879217386245728
Epoch: 19, Steps: 154 | Train Loss: 1.481 Vali Loss: 3.857 Vali Acc: 0.219 Test Loss: 3.857 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.0152735
	speed: 0.4281s/iter; left time: 5298.1465s
Epoch: 20 cost time: 18.654696941375732
Epoch: 20, Steps: 154 | Train Loss: 1.608 Vali Loss: 3.649 Vali Acc: 0.232 Test Loss: 3.649 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.6272377
	speed: 0.4280s/iter; left time: 5230.2615s
Epoch: 21 cost time: 16.57007360458374
Epoch: 21, Steps: 154 | Train Loss: 1.252 Vali Loss: 3.608 Vali Acc: 0.154 Test Loss: 3.608 Test Acc: 0.154
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.1157799
	speed: 0.4464s/iter; left time: 5386.3143s
Epoch: 22 cost time: 16.760350704193115
Epoch: 22, Steps: 154 | Train Loss: 1.539 Vali Loss: 3.858 Vali Acc: 0.376 Test Loss: 3.858 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.2739940
	speed: 0.4318s/iter; left time: 5144.0398s
Epoch: 23 cost time: 18.567877292633057
Epoch: 23, Steps: 154 | Train Loss: 1.390 Vali Loss: 4.632 Vali Acc: 0.369 Test Loss: 4.632 Test Acc: 0.369
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.6089891
	speed: 0.4431s/iter; left time: 5209.8851s
Epoch: 24 cost time: 15.338754892349243
Epoch: 24, Steps: 154 | Train Loss: 1.463 Vali Loss: 3.997 Vali Acc: 0.226 Test Loss: 3.997 Test Acc: 0.226
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.1718402
	speed: 0.4324s/iter; left time: 5017.4241s
Epoch: 25 cost time: 16.7335844039917
Epoch: 25, Steps: 154 | Train Loss: 1.277 Vali Loss: 4.323 Vali Acc: 0.389 Test Loss: 4.323 Test Acc: 0.389
Validation loss decreased (-0.386827 --> -0.389251).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.1737446
	speed: 0.4163s/iter; left time: 4767.4234s
Epoch: 26 cost time: 13.550269603729248
Epoch: 26, Steps: 154 | Train Loss: 1.223 Vali Loss: 5.585 Vali Acc: 0.220 Test Loss: 5.585 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.6124084
	speed: 0.4129s/iter; left time: 4664.0097s
Epoch: 27 cost time: 16.374147176742554
Epoch: 27, Steps: 154 | Train Loss: 1.162 Vali Loss: 4.184 Vali Acc: 0.393 Test Loss: 4.184 Test Acc: 0.393
Validation loss decreased (-0.389251 --> -0.392902).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.2942221
	speed: 0.4122s/iter; left time: 4592.9189s
Epoch: 28 cost time: 15.45522689819336
Epoch: 28, Steps: 154 | Train Loss: 1.023 Vali Loss: 4.656 Vali Acc: 0.388 Test Loss: 4.656 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.7951925
	speed: 0.4498s/iter; left time: 4943.0426s
Epoch: 29 cost time: 17.81035017967224
Epoch: 29, Steps: 154 | Train Loss: 1.067 Vali Loss: 5.650 Vali Acc: 0.373 Test Loss: 5.650 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.9138359
	speed: 0.4350s/iter; left time: 4712.9164s
Epoch: 30 cost time: 18.13591694831848
Epoch: 30, Steps: 154 | Train Loss: 0.928 Vali Loss: 5.799 Vali Acc: 0.388 Test Loss: 5.799 Test Acc: 0.388
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.6197971
	speed: 0.4814s/iter; left time: 5141.6205s
Epoch: 31 cost time: 17.85895538330078
Epoch: 31, Steps: 154 | Train Loss: 1.099 Vali Loss: 5.019 Vali Acc: 0.378 Test Loss: 5.019 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.9023186
	speed: 0.4492s/iter; left time: 4729.2437s
Epoch: 32 cost time: 17.44273829460144
Epoch: 32, Steps: 154 | Train Loss: 1.045 Vali Loss: 6.831 Vali Acc: 0.251 Test Loss: 6.831 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.7681924
	speed: 0.4506s/iter; left time: 4674.2018s
Epoch: 33 cost time: 17.218152284622192
Epoch: 33, Steps: 154 | Train Loss: 1.544 Vali Loss: 5.705 Vali Acc: 0.380 Test Loss: 5.705 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.8381838
	speed: 0.4597s/iter; left time: 4697.5271s
Epoch: 34 cost time: 15.853054285049438
Epoch: 34, Steps: 154 | Train Loss: 1.174 Vali Loss: 7.414 Vali Acc: 0.201 Test Loss: 7.414 Test Acc: 0.201
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.7800717
	speed: 0.4193s/iter; left time: 4220.3189s
Epoch: 35 cost time: 17.666749238967896
Epoch: 35, Steps: 154 | Train Loss: 1.064 Vali Loss: 5.695 Vali Acc: 0.253 Test Loss: 5.695 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.6495962
	speed: 0.4650s/iter; left time: 4608.5078s
Epoch: 36 cost time: 18.055898904800415
Epoch: 36, Steps: 154 | Train Loss: 1.560 Vali Loss: 6.510 Vali Acc: 0.362 Test Loss: 6.510 Test Acc: 0.362
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 180.0648499
	speed: 0.4735s/iter; left time: 4619.6258s
Epoch: 37 cost time: 17.340167760849
Epoch: 37, Steps: 154 | Train Loss: 2.336 Vali Loss: 7.547 Vali Acc: 0.375 Test Loss: 7.547 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3929440389294404
model parameter : 1469534
model size : 15.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7914336
	speed: 0.1232s/iter; left time: 1884.9575s
Epoch: 1 cost time: 17.956899642944336
Epoch: 1, Steps: 154 | Train Loss: 2.214 Vali Loss: 2.155 Vali Acc: 0.323 Test Loss: 2.155 Test Acc: 0.323
Validation loss decreased (inf --> -0.322768).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8014586
	speed: 0.4143s/iter; left time: 6275.6908s
Epoch: 2 cost time: 16.197723388671875
Epoch: 2, Steps: 154 | Train Loss: 2.067 Vali Loss: 2.179 Vali Acc: 0.326 Test Loss: 2.179 Test Acc: 0.326
Validation loss decreased (-0.322768 --> -0.325607).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0888515
	speed: 0.3951s/iter; left time: 5924.1254s
Epoch: 3 cost time: 13.842274904251099
Epoch: 3, Steps: 154 | Train Loss: 2.001 Vali Loss: 2.426 Vali Acc: 0.328 Test Loss: 2.426 Test Acc: 0.328
Validation loss decreased (-0.325607 --> -0.327632).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8485914
	speed: 0.3976s/iter; left time: 5899.6443s
Epoch: 4 cost time: 15.872490406036377
Epoch: 4, Steps: 154 | Train Loss: 1.935 Vali Loss: 2.302 Vali Acc: 0.345 Test Loss: 2.302 Test Acc: 0.345
Validation loss decreased (-0.327632 --> -0.345070).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4537548
	speed: 0.4228s/iter; left time: 6208.8583s
Epoch: 5 cost time: 15.874196290969849
Epoch: 5, Steps: 154 | Train Loss: 1.816 Vali Loss: 2.337 Vali Acc: 0.353 Test Loss: 2.337 Test Acc: 0.353
Validation loss decreased (-0.345070 --> -0.353180).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7234699
	speed: 0.4278s/iter; left time: 6216.0514s
Epoch: 6 cost time: 15.227344274520874
Epoch: 6, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.362 Vali Acc: 0.348 Test Loss: 2.362 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.8465958
	speed: 0.3947s/iter; left time: 5675.2389s
Epoch: 7 cost time: 14.17165470123291
Epoch: 7, Steps: 154 | Train Loss: 1.671 Vali Loss: 2.517 Vali Acc: 0.357 Test Loss: 2.517 Test Acc: 0.357
Validation loss decreased (-0.353180 --> -0.356828).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0061765
	speed: 0.3610s/iter; left time: 5135.1074s
Epoch: 8 cost time: 11.366982698440552
Epoch: 8, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.566 Vali Acc: 0.353 Test Loss: 2.566 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6493789
	speed: 0.3967s/iter; left time: 5580.7256s
Epoch: 9 cost time: 15.999096632003784
Epoch: 9, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.520 Vali Acc: 0.365 Test Loss: 2.520 Test Acc: 0.365
Validation loss decreased (-0.356828 --> -0.364533).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6967061
	speed: 0.4616s/iter; left time: 6423.2993s
Epoch: 10 cost time: 18.358891248703003
Epoch: 10, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.730 Vali Acc: 0.367 Test Loss: 2.730 Test Acc: 0.367
Validation loss decreased (-0.364533 --> -0.366558).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5585169
	speed: 0.4478s/iter; left time: 6162.0753s
Epoch: 11 cost time: 17.6614511013031
Epoch: 11, Steps: 154 | Train Loss: 1.729 Vali Loss: 3.011 Vali Acc: 0.114 Test Loss: 3.011 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1991791
	speed: 0.4294s/iter; left time: 5843.2517s
Epoch: 12 cost time: 17.821640014648438
Epoch: 12, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.644 Vali Acc: 0.367 Test Loss: 2.644 Test Acc: 0.367
Validation loss decreased (-0.366558 --> -0.367370).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3959122
	speed: 0.4379s/iter; left time: 5891.2878s
Epoch: 13 cost time: 16.255893230438232
Epoch: 13, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.912 Vali Acc: 0.352 Test Loss: 2.912 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.9555675
	speed: 0.4372s/iter; left time: 5813.6602s
Epoch: 14 cost time: 16.611857891082764
Epoch: 14, Steps: 154 | Train Loss: 1.404 Vali Loss: 2.853 Vali Acc: 0.208 Test Loss: 2.853 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.4520882
	speed: 0.4355s/iter; left time: 5724.1536s
Epoch: 15 cost time: 17.04141402244568
Epoch: 15, Steps: 154 | Train Loss: 1.382 Vali Loss: 3.095 Vali Acc: 0.105 Test Loss: 3.095 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.7277340
	speed: 0.4704s/iter; left time: 6110.3233s
Epoch: 16 cost time: 17.43717885017395
Epoch: 16, Steps: 154 | Train Loss: 1.388 Vali Loss: 3.237 Vali Acc: 0.198 Test Loss: 3.237 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.3297704
	speed: 0.4615s/iter; left time: 5924.2385s
Epoch: 17 cost time: 15.719138145446777
Epoch: 17, Steps: 154 | Train Loss: 1.401 Vali Loss: 3.543 Vali Acc: 0.070 Test Loss: 3.543 Test Acc: 0.070
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.2227356
	speed: 0.3893s/iter; left time: 4937.4710s
Epoch: 18 cost time: 14.686411142349243
Epoch: 18, Steps: 154 | Train Loss: 1.541 Vali Loss: 3.515 Vali Acc: 0.086 Test Loss: 3.515 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.2926886
	speed: 0.4117s/iter; left time: 5157.9035s
Epoch: 19 cost time: 17.29991602897644
Epoch: 19, Steps: 154 | Train Loss: 1.341 Vali Loss: 3.650 Vali Acc: 0.088 Test Loss: 3.650 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.1635537
	speed: 0.4174s/iter; left time: 5165.6857s
Epoch: 20 cost time: 15.974669218063354
Epoch: 20, Steps: 154 | Train Loss: 1.306 Vali Loss: 3.191 Vali Acc: 0.371 Test Loss: 3.191 Test Acc: 0.371
Validation loss decreased (-0.367370 --> -0.371014).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.1712998
	speed: 0.4326s/iter; left time: 5286.3319s
Epoch: 21 cost time: 17.59864902496338
Epoch: 21, Steps: 154 | Train Loss: 1.283 Vali Loss: 3.713 Vali Acc: 0.097 Test Loss: 3.713 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.9490664
	speed: 0.4560s/iter; left time: 5502.5958s
Epoch: 22 cost time: 17.236677169799805
Epoch: 22, Steps: 154 | Train Loss: 1.232 Vali Loss: 3.703 Vali Acc: 0.083 Test Loss: 3.703 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.0755739
	speed: 0.4669s/iter; left time: 5562.0359s
Epoch: 23 cost time: 16.33293056488037
Epoch: 23, Steps: 154 | Train Loss: 1.308 Vali Loss: 3.876 Vali Acc: 0.072 Test Loss: 3.876 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.2334398
	speed: 0.3863s/iter; left time: 4542.6236s
Epoch: 24 cost time: 16.685099601745605
Epoch: 24, Steps: 154 | Train Loss: 1.141 Vali Loss: 3.493 Vali Acc: 0.153 Test Loss: 3.493 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.9365586
	speed: 0.4318s/iter; left time: 5011.2258s
Epoch: 25 cost time: 16.15450620651245
Epoch: 25, Steps: 154 | Train Loss: 1.151 Vali Loss: 3.580 Vali Acc: 0.379 Test Loss: 3.580 Test Acc: 0.379
Validation loss decreased (-0.371014 --> -0.378715).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.3133738
	speed: 0.4493s/iter; left time: 5144.4216s
Epoch: 26 cost time: 17.41373300552368
Epoch: 26, Steps: 154 | Train Loss: 1.122 Vali Loss: 3.434 Vali Acc: 0.378 Test Loss: 3.434 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.1296132
	speed: 0.4508s/iter; left time: 5092.4631s
Epoch: 27 cost time: 15.952614545822144
Epoch: 27, Steps: 154 | Train Loss: 1.264 Vali Loss: 3.831 Vali Acc: 0.322 Test Loss: 3.831 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.3017832
	speed: 0.4218s/iter; left time: 4700.4213s
Epoch: 28 cost time: 16.403822898864746
Epoch: 28, Steps: 154 | Train Loss: 1.566 Vali Loss: 3.504 Vali Acc: 0.336 Test Loss: 3.504 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.6544278
	speed: 0.4437s/iter; left time: 4875.4896s
Epoch: 29 cost time: 16.43993878364563
Epoch: 29, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.765 Vali Acc: 0.265 Test Loss: 3.765 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.1861616
	speed: 0.4058s/iter; left time: 4396.8966s
Epoch: 30 cost time: 13.943708658218384
Epoch: 30, Steps: 154 | Train Loss: 1.078 Vali Loss: 4.226 Vali Acc: 0.090 Test Loss: 4.226 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.7862430
	speed: 0.4107s/iter; left time: 4386.7539s
Epoch: 31 cost time: 16.67875647544861
Epoch: 31, Steps: 154 | Train Loss: 1.302 Vali Loss: 4.149 Vali Acc: 0.235 Test Loss: 4.149 Test Acc: 0.235
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.7965320
	speed: 0.4403s/iter; left time: 4634.7975s
Epoch: 32 cost time: 16.39465045928955
Epoch: 32, Steps: 154 | Train Loss: 1.101 Vali Loss: 3.802 Vali Acc: 0.097 Test Loss: 3.802 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.9079180
	speed: 0.4316s/iter; left time: 4476.6448s
Epoch: 33 cost time: 16.594972610473633
Epoch: 33, Steps: 154 | Train Loss: 1.057 Vali Loss: 3.998 Vali Acc: 0.098 Test Loss: 3.998 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.8668161
	speed: 0.4435s/iter; left time: 4532.3291s
Epoch: 34 cost time: 17.414814233779907
Epoch: 34, Steps: 154 | Train Loss: 0.993 Vali Loss: 4.197 Vali Acc: 0.091 Test Loss: 4.197 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.7950340
	speed: 0.4481s/iter; left time: 4509.8382s
Epoch: 35 cost time: 15.79633116722107
Epoch: 35, Steps: 154 | Train Loss: 1.094 Vali Loss: 3.902 Vali Acc: 0.129 Test Loss: 3.902 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37875101378751014
model parameter : 2504286
model size : 14.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7778635
	speed: 0.1151s/iter; left time: 1760.4477s
Epoch: 1 cost time: 16.585688829421997
Epoch: 1, Steps: 154 | Train Loss: 2.201 Vali Loss: 2.153 Vali Acc: 0.322 Test Loss: 2.153 Test Acc: 0.322
Validation loss decreased (inf --> -0.322363).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8184880
	speed: 0.4119s/iter; left time: 6238.9530s
Epoch: 2 cost time: 16.299824476242065
Epoch: 2, Steps: 154 | Train Loss: 2.067 Vali Loss: 2.178 Vali Acc: 0.325 Test Loss: 2.178 Test Acc: 0.325
Validation loss decreased (-0.322363 --> -0.325201).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0185769
	speed: 0.4030s/iter; left time: 6042.4504s
Epoch: 3 cost time: 13.605729103088379
Epoch: 3, Steps: 154 | Train Loss: 1.957 Vali Loss: 2.438 Vali Acc: 0.335 Test Loss: 2.438 Test Acc: 0.335
Validation loss decreased (-0.325201 --> -0.334931).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7360113
	speed: 0.4277s/iter; left time: 6346.9435s
Epoch: 4 cost time: 16.791977882385254
Epoch: 4, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.310 Vali Acc: 0.351 Test Loss: 2.310 Test Acc: 0.351
Validation loss decreased (-0.334931 --> -0.351153).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5752044
	speed: 0.4408s/iter; left time: 6472.5590s
Epoch: 5 cost time: 16.45885396003723
Epoch: 5, Steps: 154 | Train Loss: 1.768 Vali Loss: 2.305 Vali Acc: 0.356 Test Loss: 2.305 Test Acc: 0.356
Validation loss decreased (-0.351153 --> -0.356019).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6853826
	speed: 0.3866s/iter; left time: 5617.2637s
Epoch: 6 cost time: 13.009599447250366
Epoch: 6, Steps: 154 | Train Loss: 1.689 Vali Loss: 2.426 Vali Acc: 0.365 Test Loss: 2.426 Test Acc: 0.365
Validation loss decreased (-0.356019 --> -0.365345).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3589404
	speed: 0.4020s/iter; left time: 5779.5873s
Epoch: 7 cost time: 16.14315962791443
Epoch: 7, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.403 Vali Acc: 0.364 Test Loss: 2.403 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.1073525
	speed: 0.3798s/iter; left time: 5402.2807s
Epoch: 8 cost time: 14.29507064819336
Epoch: 8, Steps: 154 | Train Loss: 1.561 Vali Loss: 2.407 Vali Acc: 0.347 Test Loss: 2.407 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9097881
	speed: 0.3853s/iter; left time: 5421.2293s
Epoch: 9 cost time: 15.208940267562866
Epoch: 9, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.491 Vali Acc: 0.367 Test Loss: 2.491 Test Acc: 0.367
Validation loss decreased (-0.365345 --> -0.367372).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7033463
	speed: 0.4016s/iter; left time: 5587.7601s
Epoch: 10 cost time: 15.512280464172363
Epoch: 10, Steps: 154 | Train Loss: 1.609 Vali Loss: 2.647 Vali Acc: 0.364 Test Loss: 2.647 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.8642378
	speed: 0.4238s/iter; left time: 5831.2952s
Epoch: 11 cost time: 15.55202603340149
Epoch: 11, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.903 Vali Acc: 0.092 Test Loss: 2.903 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.0183127
	speed: 0.4233s/iter; left time: 5759.3089s
Epoch: 12 cost time: 16.726871013641357
Epoch: 12, Steps: 154 | Train Loss: 1.411 Vali Loss: 2.648 Vali Acc: 0.356 Test Loss: 2.648 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.2098993
	speed: 0.4214s/iter; left time: 5669.7232s
Epoch: 13 cost time: 15.00160527229309
Epoch: 13, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.689 Vali Acc: 0.376 Test Loss: 2.689 Test Acc: 0.376
Validation loss decreased (-0.367372 --> -0.375480).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.8578761
	speed: 0.3894s/iter; left time: 5178.9970s
Epoch: 14 cost time: 15.097264289855957
Epoch: 14, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.798 Vali Acc: 0.365 Test Loss: 2.798 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.0989428
	speed: 0.4189s/iter; left time: 5506.9725s
Epoch: 15 cost time: 16.500916004180908
Epoch: 15, Steps: 154 | Train Loss: 1.356 Vali Loss: 3.042 Vali Acc: 0.116 Test Loss: 3.042 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.4204365
	speed: 0.4263s/iter; left time: 5538.5711s
Epoch: 16 cost time: 16.06743311882019
Epoch: 16, Steps: 154 | Train Loss: 1.377 Vali Loss: 2.956 Vali Acc: 0.207 Test Loss: 2.956 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.2656382
	speed: 0.4366s/iter; left time: 5604.5379s
Epoch: 17 cost time: 16.237051010131836
Epoch: 17, Steps: 154 | Train Loss: 1.226 Vali Loss: 3.218 Vali Acc: 0.202 Test Loss: 3.218 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.0874858
	speed: 0.4097s/iter; left time: 5196.5647s
Epoch: 18 cost time: 14.72907567024231
Epoch: 18, Steps: 154 | Train Loss: 1.272 Vali Loss: 3.054 Vali Acc: 0.305 Test Loss: 3.054 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.9738970
	speed: 0.3962s/iter; left time: 4963.4680s
Epoch: 19 cost time: 13.43543004989624
Epoch: 19, Steps: 154 | Train Loss: 1.194 Vali Loss: 3.392 Vali Acc: 0.099 Test Loss: 3.392 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.8445390
	speed: 0.3749s/iter; left time: 4639.5007s
Epoch: 20 cost time: 15.455458164215088
Epoch: 20, Steps: 154 | Train Loss: 1.469 Vali Loss: 3.418 Vali Acc: 0.090 Test Loss: 3.418 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.4493665
	speed: 0.4210s/iter; left time: 5145.5108s
Epoch: 21 cost time: 15.720154047012329
Epoch: 21, Steps: 154 | Train Loss: 1.272 Vali Loss: 3.611 Vali Acc: 0.097 Test Loss: 3.611 Test Acc: 0.097
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.1727426
	speed: 0.4840s/iter; left time: 5840.6644s
Epoch: 22 cost time: 19.3536057472229
Epoch: 22, Steps: 154 | Train Loss: 1.164 Vali Loss: 3.741 Vali Acc: 0.093 Test Loss: 3.741 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.0337098
	speed: 0.4212s/iter; left time: 5017.6682s
Epoch: 23 cost time: 16.162078380584717
Epoch: 23, Steps: 154 | Train Loss: 1.161 Vali Loss: 4.036 Vali Acc: 0.086 Test Loss: 4.036 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37550689375506896
model parameter : 2504286
model size : 14.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7918127
	speed: 0.1151s/iter; left time: 1761.8825s
Epoch: 1 cost time: 17.537010431289673
Epoch: 1, Steps: 154 | Train Loss: 2.194 Vali Loss: 2.161 Vali Acc: 0.322 Test Loss: 2.161 Test Acc: 0.322
Validation loss decreased (inf --> -0.321957).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8298444
	speed: 0.4284s/iter; left time: 6489.4480s
Epoch: 2 cost time: 15.208028316497803
Epoch: 2, Steps: 154 | Train Loss: 2.032 Vali Loss: 2.143 Vali Acc: 0.326 Test Loss: 2.143 Test Acc: 0.326
Validation loss decreased (-0.321957 --> -0.325607).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0876696
	speed: 0.4185s/iter; left time: 6274.6808s
Epoch: 3 cost time: 17.674713850021362
Epoch: 3, Steps: 154 | Train Loss: 1.910 Vali Loss: 2.473 Vali Acc: 0.340 Test Loss: 2.473 Test Acc: 0.340
Validation loss decreased (-0.325607 --> -0.339797).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8121234
	speed: 0.4296s/iter; left time: 6375.4758s
Epoch: 4 cost time: 18.16256070137024
Epoch: 4, Steps: 154 | Train Loss: 1.783 Vali Loss: 2.312 Vali Acc: 0.360 Test Loss: 2.312 Test Acc: 0.360
Validation loss decreased (-0.339797 --> -0.359669).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4365836
	speed: 0.4496s/iter; left time: 6602.8323s
Epoch: 5 cost time: 16.586125373840332
Epoch: 5, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.327 Vali Acc: 0.360 Test Loss: 2.327 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6475216
	speed: 0.4259s/iter; left time: 6188.9156s
Epoch: 6 cost time: 14.867383241653442
Epoch: 6, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.388 Vali Acc: 0.356 Test Loss: 2.388 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.1722225
	speed: 0.3756s/iter; left time: 5399.3851s
Epoch: 7 cost time: 16.174909830093384
Epoch: 7, Steps: 154 | Train Loss: 1.592 Vali Loss: 2.638 Vali Acc: 0.363 Test Loss: 2.638 Test Acc: 0.363
Validation loss decreased (-0.359669 --> -0.362910).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1063967
	speed: 0.4336s/iter; left time: 6167.3302s
Epoch: 8 cost time: 15.9314284324646
Epoch: 8, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.607 Vali Acc: 0.347 Test Loss: 2.607 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8160652
	speed: 0.3971s/iter; left time: 5586.2860s
Epoch: 9 cost time: 16.863916635513306
Epoch: 9, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.702 Vali Acc: 0.216 Test Loss: 2.702 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.5656589
	speed: 0.4442s/iter; left time: 6180.7319s
Epoch: 10 cost time: 17.157119274139404
Epoch: 10, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.478 Vali Acc: 0.376 Test Loss: 2.478 Test Acc: 0.376
Validation loss decreased (-0.362910 --> -0.376293).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9646047
	speed: 0.4353s/iter; left time: 5990.7985s
Epoch: 11 cost time: 15.486644983291626
Epoch: 11, Steps: 154 | Train Loss: 1.423 Vali Loss: 3.188 Vali Acc: 0.086 Test Loss: 3.188 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.7622030
	speed: 0.4072s/iter; left time: 5540.4937s
Epoch: 12 cost time: 17.976522207260132
Epoch: 12, Steps: 154 | Train Loss: 1.357 Vali Loss: 2.598 Vali Acc: 0.288 Test Loss: 2.598 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0976361
	speed: 0.4419s/iter; left time: 5944.7390s
Epoch: 13 cost time: 15.661268711090088
Epoch: 13, Steps: 154 | Train Loss: 1.344 Vali Loss: 3.001 Vali Acc: 0.219 Test Loss: 3.001 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.6437441
	speed: 0.4196s/iter; left time: 5580.8811s
Epoch: 14 cost time: 14.94868278503418
Epoch: 14, Steps: 154 | Train Loss: 1.299 Vali Loss: 3.019 Vali Acc: 0.309 Test Loss: 3.019 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.2628371
	speed: 0.3954s/iter; left time: 5197.3263s
Epoch: 15 cost time: 16.065147638320923
Epoch: 15, Steps: 154 | Train Loss: 1.308 Vali Loss: 2.918 Vali Acc: 0.384 Test Loss: 2.918 Test Acc: 0.384
Validation loss decreased (-0.376293 --> -0.383994).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.1734946
	speed: 0.4418s/iter; left time: 5739.7458s
Epoch: 16 cost time: 15.1126070022583
Epoch: 16, Steps: 154 | Train Loss: 1.188 Vali Loss: 2.952 Vali Acc: 0.221 Test Loss: 2.952 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.6535233
	speed: 0.4507s/iter; left time: 5785.3828s
Epoch: 17 cost time: 17.173293590545654
Epoch: 17, Steps: 154 | Train Loss: 1.266 Vali Loss: 3.297 Vali Acc: 0.206 Test Loss: 3.297 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 2.3321774
	speed: 0.4129s/iter; left time: 5237.1848s
Epoch: 18 cost time: 15.75516963005066
Epoch: 18, Steps: 154 | Train Loss: 1.188 Vali Loss: 3.063 Vali Acc: 0.358 Test Loss: 3.063 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.4821811
	speed: 0.4178s/iter; left time: 5234.3448s
Epoch: 19 cost time: 16.254637956619263
Epoch: 19, Steps: 154 | Train Loss: 1.213 Vali Loss: 4.364 Vali Acc: 0.204 Test Loss: 4.364 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.7467974
	speed: 0.4257s/iter; left time: 5267.8486s
Epoch: 20 cost time: 17.44448208808899
Epoch: 20, Steps: 154 | Train Loss: 1.331 Vali Loss: 3.147 Vali Acc: 0.378 Test Loss: 3.147 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.7473471
	speed: 0.4089s/iter; left time: 4996.7801s
Epoch: 21 cost time: 15.738116025924683
Epoch: 21, Steps: 154 | Train Loss: 1.224 Vali Loss: 3.299 Vali Acc: 0.331 Test Loss: 3.299 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.9039708
	speed: 0.4448s/iter; left time: 5367.1703s
Epoch: 22 cost time: 18.101056337356567
Epoch: 22, Steps: 154 | Train Loss: 1.154 Vali Loss: 3.231 Vali Acc: 0.301 Test Loss: 3.231 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.5322697
	speed: 0.4465s/iter; left time: 5319.4793s
Epoch: 23 cost time: 16.928675651550293
Epoch: 23, Steps: 154 | Train Loss: 1.052 Vali Loss: 4.237 Vali Acc: 0.103 Test Loss: 4.237 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.7241507
	speed: 0.3923s/iter; left time: 4612.6357s
Epoch: 24 cost time: 11.68733024597168
Epoch: 24, Steps: 154 | Train Loss: 0.991 Vali Loss: 3.328 Vali Acc: 0.227 Test Loss: 3.328 Test Acc: 0.227
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.7183681
	speed: 0.4321s/iter; left time: 5014.6955s
Epoch: 25 cost time: 18.47903037071228
Epoch: 25, Steps: 154 | Train Loss: 1.159 Vali Loss: 3.460 Vali Acc: 0.392 Test Loss: 3.460 Test Acc: 0.392
Validation loss decreased (-0.383994 --> -0.392098).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.6808038
	speed: 0.4386s/iter; left time: 5022.3465s
Epoch: 26 cost time: 15.913890838623047
Epoch: 26, Steps: 154 | Train Loss: 0.996 Vali Loss: 3.735 Vali Acc: 0.350 Test Loss: 3.735 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.8623095
	speed: 0.4226s/iter; left time: 4773.8165s
Epoch: 27 cost time: 18.283908367156982
Epoch: 27, Steps: 154 | Train Loss: 0.978 Vali Loss: 3.611 Vali Acc: 0.137 Test Loss: 3.611 Test Acc: 0.137
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.2040608
	speed: 0.4450s/iter; left time: 4958.4370s
Epoch: 28 cost time: 14.860700368881226
Epoch: 28, Steps: 154 | Train Loss: 1.302 Vali Loss: 4.682 Vali Acc: 0.206 Test Loss: 4.682 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.6620568
	speed: 0.4196s/iter; left time: 4610.8735s
Epoch: 29 cost time: 15.250059604644775
Epoch: 29, Steps: 154 | Train Loss: 1.179 Vali Loss: 3.804 Vali Acc: 0.245 Test Loss: 3.804 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.3303397
	speed: 0.4393s/iter; left time: 4759.5316s
Epoch: 30 cost time: 16.74707007408142
Epoch: 30, Steps: 154 | Train Loss: 0.950 Vali Loss: 4.204 Vali Acc: 0.241 Test Loss: 4.204 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.6434219
	speed: 0.4234s/iter; left time: 4521.9974s
Epoch: 31 cost time: 16.052180767059326
Epoch: 31, Steps: 154 | Train Loss: 1.029 Vali Loss: 4.508 Vali Acc: 0.229 Test Loss: 4.508 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.7508232
	speed: 0.4311s/iter; left time: 4537.7501s
Epoch: 32 cost time: 15.233757019042969
Epoch: 32, Steps: 154 | Train Loss: 1.024 Vali Loss: 4.979 Vali Acc: 0.096 Test Loss: 4.979 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.5715310
	speed: 0.3872s/iter; left time: 4016.1750s
Epoch: 33 cost time: 15.124934434890747
Epoch: 33, Steps: 154 | Train Loss: 0.921 Vali Loss: 4.865 Vali Acc: 0.119 Test Loss: 4.865 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.6036066
	speed: 0.4327s/iter; left time: 4422.1429s
Epoch: 34 cost time: 15.32108211517334
Epoch: 34, Steps: 154 | Train Loss: 0.974 Vali Loss: 4.692 Vali Acc: 0.105 Test Loss: 4.692 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 1.0630524
	speed: 0.4351s/iter; left time: 4379.5286s
Epoch: 35 cost time: 17.7924644947052
Epoch: 35, Steps: 154 | Train Loss: 0.875 Vali Loss: 4.027 Vali Acc: 0.388 Test Loss: 4.027 Test Acc: 0.388
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3921330089213301
model parameter : 2504286
model size : 14.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7881217
	speed: 0.1152s/iter; left time: 1762.0915s
Epoch: 1 cost time: 16.868479013442993
Epoch: 1, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.213 Vali Acc: 0.321 Test Loss: 2.213 Test Acc: 0.321
Validation loss decreased (inf --> -0.321146).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8343461
	speed: 0.4064s/iter; left time: 6155.8641s
Epoch: 2 cost time: 14.856799364089966
Epoch: 2, Steps: 154 | Train Loss: 1.998 Vali Loss: 2.155 Vali Acc: 0.330 Test Loss: 2.155 Test Acc: 0.330
Validation loss decreased (-0.321146 --> -0.329662).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0119777
	speed: 0.4278s/iter; left time: 6413.9997s
Epoch: 3 cost time: 14.82468056678772
Epoch: 3, Steps: 154 | Train Loss: 1.849 Vali Loss: 2.593 Vali Acc: 0.345 Test Loss: 2.593 Test Acc: 0.345
Validation loss decreased (-0.329662 --> -0.345067).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5446939
	speed: 0.4157s/iter; left time: 6167.9914s
Epoch: 4 cost time: 17.494548797607422
Epoch: 4, Steps: 154 | Train Loss: 1.768 Vali Loss: 2.302 Vali Acc: 0.358 Test Loss: 2.302 Test Acc: 0.358
Validation loss decreased (-0.345067 --> -0.358452).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6417415
	speed: 0.4394s/iter; left time: 6453.1103s
Epoch: 5 cost time: 17.144055366516113
Epoch: 5, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.710 Vali Acc: 0.358 Test Loss: 2.710 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5749952
	speed: 0.4215s/iter; left time: 6124.8310s
Epoch: 6 cost time: 18.083462953567505
Epoch: 6, Steps: 154 | Train Loss: 1.597 Vali Loss: 2.381 Vali Acc: 0.353 Test Loss: 2.381 Test Acc: 0.353
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.9403830
	speed: 0.4005s/iter; left time: 5758.5921s
Epoch: 7 cost time: 12.721305131912231
Epoch: 7, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.537 Vali Acc: 0.367 Test Loss: 2.537 Test Acc: 0.367
Validation loss decreased (-0.358452 --> -0.366966).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9672962
	speed: 0.4014s/iter; left time: 5709.3836s
Epoch: 8 cost time: 15.802650690078735
Epoch: 8, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.365 Vali Acc: 0.363 Test Loss: 2.365 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4406430
	speed: 0.4139s/iter; left time: 5822.9959s
Epoch: 9 cost time: 15.787728548049927
Epoch: 9, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.580 Vali Acc: 0.334 Test Loss: 2.580 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6294999
	speed: 0.4300s/iter; left time: 5983.6823s
Epoch: 10 cost time: 17.183055877685547
Epoch: 10, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.411 Vali Acc: 0.374 Test Loss: 2.411 Test Acc: 0.374
Validation loss decreased (-0.366966 --> -0.374266).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8719742
	speed: 0.3875s/iter; left time: 5331.9243s
Epoch: 11 cost time: 16.280866146087646
Epoch: 11, Steps: 154 | Train Loss: 1.376 Vali Loss: 3.066 Vali Acc: 0.350 Test Loss: 3.066 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0066757
	speed: 0.4100s/iter; left time: 5579.3127s
Epoch: 12 cost time: 14.598414421081543
Epoch: 12, Steps: 154 | Train Loss: 1.260 Vali Loss: 2.443 Vali Acc: 0.395 Test Loss: 2.443 Test Acc: 0.395
Validation loss decreased (-0.374266 --> -0.394542).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8174495
	speed: 0.4091s/iter; left time: 5503.8044s
Epoch: 13 cost time: 14.992817640304565
Epoch: 13, Steps: 154 | Train Loss: 1.304 Vali Loss: 2.663 Vali Acc: 0.223 Test Loss: 2.663 Test Acc: 0.223
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3331939
	speed: 0.3947s/iter; left time: 5249.0992s
Epoch: 14 cost time: 14.852505207061768
Epoch: 14, Steps: 154 | Train Loss: 1.207 Vali Loss: 2.985 Vali Acc: 0.244 Test Loss: 2.985 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.2528696
	speed: 0.4017s/iter; left time: 5280.1188s
Epoch: 15 cost time: 16.26786994934082
Epoch: 15, Steps: 154 | Train Loss: 1.130 Vali Loss: 2.892 Vali Acc: 0.262 Test Loss: 2.892 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.8842915
	speed: 0.3969s/iter; left time: 5155.4958s
Epoch: 16 cost time: 16.69746732711792
Epoch: 16, Steps: 154 | Train Loss: 1.153 Vali Loss: 2.676 Vali Acc: 0.271 Test Loss: 2.676 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 2.1671937
	speed: 0.4193s/iter; left time: 5382.1429s
Epoch: 17 cost time: 15.440953969955444
Epoch: 17, Steps: 154 | Train Loss: 1.134 Vali Loss: 3.317 Vali Acc: 0.209 Test Loss: 3.317 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.2747185
	speed: 0.4043s/iter; left time: 5127.5537s
Epoch: 18 cost time: 15.103927373886108
Epoch: 18, Steps: 154 | Train Loss: 1.079 Vali Loss: 2.792 Vali Acc: 0.380 Test Loss: 2.792 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.9027199
	speed: 0.3639s/iter; left time: 4558.8504s
Epoch: 19 cost time: 13.092637062072754
Epoch: 19, Steps: 154 | Train Loss: 1.077 Vali Loss: 3.347 Vali Acc: 0.100 Test Loss: 3.347 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.8125183
	speed: 0.3971s/iter; left time: 4914.6538s
Epoch: 20 cost time: 14.925115823745728
Epoch: 20, Steps: 154 | Train Loss: 1.053 Vali Loss: 3.160 Vali Acc: 0.333 Test Loss: 3.160 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.8151773
	speed: 0.4050s/iter; left time: 4949.6321s
Epoch: 21 cost time: 16.47333312034607
Epoch: 21, Steps: 154 | Train Loss: 1.038 Vali Loss: 3.175 Vali Acc: 0.339 Test Loss: 3.175 Test Acc: 0.339
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.8697639
	speed: 0.4015s/iter; left time: 4844.9649s
Epoch: 22 cost time: 16.080471992492676
Epoch: 22, Steps: 154 | Train Loss: 1.033 Vali Loss: 3.826 Vali Acc: 0.103 Test Loss: 3.826 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39456609894566097
model parameter : 2504286
model size : 14.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7936212
	speed: 0.1172s/iter; left time: 1792.6433s
Epoch: 1 cost time: 16.97352886199951
Epoch: 1, Steps: 154 | Train Loss: 2.223 Vali Loss: 2.223 Vali Acc: 0.321 Test Loss: 2.223 Test Acc: 0.321
Validation loss decreased (inf --> -0.321146).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4273818
	speed: 0.4214s/iter; left time: 6382.4735s
Epoch: 2 cost time: 15.598905086517334
Epoch: 2, Steps: 154 | Train Loss: 2.047 Vali Loss: 2.168 Vali Acc: 0.323 Test Loss: 2.168 Test Acc: 0.323
Validation loss decreased (-0.321146 --> -0.322768).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6298516
	speed: 0.4120s/iter; left time: 6176.4715s
Epoch: 3 cost time: 15.41928744316101
Epoch: 3, Steps: 154 | Train Loss: 2.044 Vali Loss: 2.245 Vali Acc: 0.328 Test Loss: 2.245 Test Acc: 0.328
Validation loss decreased (-0.322768 --> -0.327634).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6561953
	speed: 0.4019s/iter; left time: 5963.5921s
Epoch: 4 cost time: 16.2015118598938
Epoch: 4, Steps: 154 | Train Loss: 1.932 Vali Loss: 2.279 Vali Acc: 0.333 Test Loss: 2.279 Test Acc: 0.333
Validation loss decreased (-0.327634 --> -0.332500).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8186769
	speed: 0.4258s/iter; left time: 6252.4591s
Epoch: 5 cost time: 17.057449102401733
Epoch: 5, Steps: 154 | Train Loss: 1.811 Vali Loss: 2.443 Vali Acc: 0.335 Test Loss: 2.443 Test Acc: 0.335
Validation loss decreased (-0.332500 --> -0.335336).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6291767
	speed: 0.4093s/iter; left time: 5947.6939s
Epoch: 6 cost time: 14.907703638076782
Epoch: 6, Steps: 154 | Train Loss: 1.730 Vali Loss: 2.280 Vali Acc: 0.346 Test Loss: 2.280 Test Acc: 0.346
Validation loss decreased (-0.335336 --> -0.345881).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8702101
	speed: 0.4038s/iter; left time: 5804.9243s
Epoch: 7 cost time: 14.640772819519043
Epoch: 7, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.518 Vali Acc: 0.347 Test Loss: 2.518 Test Acc: 0.347
Validation loss decreased (-0.345881 --> -0.346690).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7607546
	speed: 0.3907s/iter; left time: 5557.3820s
Epoch: 8 cost time: 15.153753280639648
Epoch: 8, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.720 Vali Acc: 0.347 Test Loss: 2.720 Test Acc: 0.347
Validation loss decreased (-0.346690 --> -0.347094).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6262174
	speed: 0.3833s/iter; left time: 5392.8488s
Epoch: 9 cost time: 15.948832988739014
Epoch: 9, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.893 Vali Acc: 0.373 Test Loss: 2.893 Test Acc: 0.373
Validation loss decreased (-0.347094 --> -0.372639).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1252532
	speed: 0.3893s/iter; left time: 5417.2198s
Epoch: 10 cost time: 13.745896577835083
Epoch: 10, Steps: 154 | Train Loss: 1.651 Vali Loss: 2.760 Vali Acc: 0.192 Test Loss: 2.760 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.6865079
	speed: 0.4029s/iter; left time: 5544.1345s
Epoch: 11 cost time: 15.908155679702759
Epoch: 11, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.570 Vali Acc: 0.368 Test Loss: 2.570 Test Acc: 0.368
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.2706699
	speed: 0.3920s/iter; left time: 5333.8527s
Epoch: 12 cost time: 15.651553392410278
Epoch: 12, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.912 Vali Acc: 0.187 Test Loss: 2.912 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.3767433
	speed: 0.4111s/iter; left time: 5530.4112s
Epoch: 13 cost time: 15.15028429031372
Epoch: 13, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.977 Vali Acc: 0.080 Test Loss: 2.977 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 2.0163622
	speed: 0.4017s/iter; left time: 5341.8286s
Epoch: 14 cost time: 13.88727355003357
Epoch: 14, Steps: 154 | Train Loss: 1.433 Vali Loss: 3.177 Vali Acc: 0.092 Test Loss: 3.177 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.4836522
	speed: 0.3739s/iter; left time: 4914.3540s
Epoch: 15 cost time: 15.28991436958313
Epoch: 15, Steps: 154 | Train Loss: 1.402 Vali Loss: 3.094 Vali Acc: 0.203 Test Loss: 3.094 Test Acc: 0.203
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.2858711
	speed: 0.4022s/iter; left time: 5225.2323s
Epoch: 16 cost time: 14.923147916793823
Epoch: 16, Steps: 154 | Train Loss: 1.596 Vali Loss: 3.378 Vali Acc: 0.159 Test Loss: 3.378 Test Acc: 0.159
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.4259353
	speed: 0.3844s/iter; left time: 4933.9643s
Epoch: 17 cost time: 16.189006328582764
Epoch: 17, Steps: 154 | Train Loss: 1.391 Vali Loss: 3.256 Vali Acc: 0.093 Test Loss: 3.256 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.3205914
	speed: 0.4178s/iter; left time: 5298.4434s
Epoch: 18 cost time: 15.175291538238525
Epoch: 18, Steps: 154 | Train Loss: 1.344 Vali Loss: 3.224 Vali Acc: 0.207 Test Loss: 3.224 Test Acc: 0.207
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.7808945
	speed: 0.4013s/iter; left time: 5028.0219s
Epoch: 19 cost time: 15.104451417922974
Epoch: 19, Steps: 154 | Train Loss: 1.460 Vali Loss: 3.294 Vali Acc: 0.208 Test Loss: 3.294 Test Acc: 0.208
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3726682887266829
model parameter : 1455710
model size : 10.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7771389
	speed: 0.1164s/iter; left time: 1781.7238s
Epoch: 1 cost time: 16.551745414733887
Epoch: 1, Steps: 154 | Train Loss: 2.219 Vali Loss: 2.230 Vali Acc: 0.322 Test Loss: 2.230 Test Acc: 0.322
Validation loss decreased (inf --> -0.322362).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8511157
	speed: 0.3783s/iter; left time: 5730.8270s
Epoch: 2 cost time: 14.298621654510498
Epoch: 2, Steps: 154 | Train Loss: 2.049 Vali Loss: 2.183 Vali Acc: 0.323 Test Loss: 2.183 Test Acc: 0.323
Validation loss decreased (-0.322362 --> -0.323174).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6190944
	speed: 0.3837s/iter; left time: 5752.8819s
Epoch: 3 cost time: 13.68795657157898
Epoch: 3, Steps: 154 | Train Loss: 1.991 Vali Loss: 2.242 Vali Acc: 0.328 Test Loss: 2.242 Test Acc: 0.328
Validation loss decreased (-0.323174 --> -0.328445).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5501653
	speed: 0.4110s/iter; left time: 6098.7889s
Epoch: 4 cost time: 15.780949592590332
Epoch: 4, Steps: 154 | Train Loss: 1.859 Vali Loss: 2.221 Vali Acc: 0.341 Test Loss: 2.221 Test Acc: 0.341
Validation loss decreased (-0.328445 --> -0.341016).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7223676
	speed: 0.3874s/iter; left time: 5688.4635s
Epoch: 5 cost time: 13.749911546707153
Epoch: 5, Steps: 154 | Train Loss: 1.785 Vali Loss: 2.328 Vali Acc: 0.350 Test Loss: 2.328 Test Acc: 0.350
Validation loss decreased (-0.341016 --> -0.349531).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0498972
	speed: 0.4134s/iter; left time: 6006.6544s
Epoch: 6 cost time: 15.815507650375366
Epoch: 6, Steps: 154 | Train Loss: 1.670 Vali Loss: 2.376 Vali Acc: 0.352 Test Loss: 2.376 Test Acc: 0.352
Validation loss decreased (-0.349531 --> -0.351558).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4135129
	speed: 0.3961s/iter; left time: 5694.5388s
Epoch: 7 cost time: 14.961636543273926
Epoch: 7, Steps: 154 | Train Loss: 1.630 Vali Loss: 2.471 Vali Acc: 0.357 Test Loss: 2.471 Test Acc: 0.357
Validation loss decreased (-0.351558 --> -0.357234).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8835104
	speed: 0.3978s/iter; left time: 5657.3077s
Epoch: 8 cost time: 14.73417353630066
Epoch: 8, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.744 Vali Acc: 0.353 Test Loss: 2.744 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5869130
	speed: 0.3985s/iter; left time: 5606.9292s
Epoch: 9 cost time: 15.413733720779419
Epoch: 9, Steps: 154 | Train Loss: 1.690 Vali Loss: 3.017 Vali Acc: 0.080 Test Loss: 3.017 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.9610720
	speed: 0.4108s/iter; left time: 5716.1956s
Epoch: 10 cost time: 16.323532342910767
Epoch: 10, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.918 Vali Acc: 0.177 Test Loss: 2.918 Test Acc: 0.177
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.7011905
	speed: 0.3807s/iter; left time: 5239.2914s
Epoch: 11 cost time: 15.305970668792725
Epoch: 11, Steps: 154 | Train Loss: 1.590 Vali Loss: 2.648 Vali Acc: 0.359 Test Loss: 2.648 Test Acc: 0.359
Validation loss decreased (-0.357234 --> -0.358854).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2784455
	speed: 0.4080s/iter; left time: 5551.8866s
Epoch: 12 cost time: 14.797023057937622
Epoch: 12, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.768 Vali Acc: 0.361 Test Loss: 2.768 Test Acc: 0.361
Validation loss decreased (-0.358854 --> -0.360881).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2838882
	speed: 0.3944s/iter; left time: 5305.2429s
Epoch: 13 cost time: 15.674237489700317
Epoch: 13, Steps: 154 | Train Loss: 1.336 Vali Loss: 2.927 Vali Acc: 0.328 Test Loss: 2.927 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4505888
	speed: 0.4134s/iter; left time: 5497.6402s
Epoch: 14 cost time: 14.11011028289795
Epoch: 14, Steps: 154 | Train Loss: 1.338 Vali Loss: 3.255 Vali Acc: 0.097 Test Loss: 3.255 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.4441476
	speed: 0.3847s/iter; left time: 5056.5234s
Epoch: 15 cost time: 15.276509523391724
Epoch: 15, Steps: 154 | Train Loss: 1.332 Vali Loss: 3.119 Vali Acc: 0.359 Test Loss: 3.119 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.2987289
	speed: 0.3959s/iter; left time: 5142.8837s
Epoch: 16 cost time: 15.46289610862732
Epoch: 16, Steps: 154 | Train Loss: 1.415 Vali Loss: 3.352 Vali Acc: 0.088 Test Loss: 3.352 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.3703249
	speed: 0.3836s/iter; left time: 4924.3428s
Epoch: 17 cost time: 14.461640357971191
Epoch: 17, Steps: 154 | Train Loss: 1.263 Vali Loss: 3.090 Vali Acc: 0.364 Test Loss: 3.090 Test Acc: 0.364
Validation loss decreased (-0.360881 --> -0.363716).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.3224375
	speed: 0.3906s/iter; left time: 4954.0377s
Epoch: 18 cost time: 15.242127180099487
Epoch: 18, Steps: 154 | Train Loss: 1.246 Vali Loss: 3.268 Vali Acc: 0.095 Test Loss: 3.268 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.8688525
	speed: 0.4004s/iter; left time: 5016.3298s
Epoch: 19 cost time: 15.27482008934021
Epoch: 19, Steps: 154 | Train Loss: 1.434 Vali Loss: 4.021 Vali Acc: 0.179 Test Loss: 4.021 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.8077410
	speed: 0.3915s/iter; left time: 4844.2228s
Epoch: 20 cost time: 15.184072732925415
Epoch: 20, Steps: 154 | Train Loss: 1.271 Vali Loss: 3.969 Vali Acc: 0.088 Test Loss: 3.969 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 9.6988354
	speed: 0.3750s/iter; left time: 4582.6991s
Epoch: 21 cost time: 12.578807830810547
Epoch: 21, Steps: 154 | Train Loss: 1.574 Vali Loss: 3.936 Vali Acc: 0.202 Test Loss: 3.936 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.9069869
	speed: 0.3875s/iter; left time: 4675.4651s
Epoch: 22 cost time: 14.346077680587769
Epoch: 22, Steps: 154 | Train Loss: 1.169 Vali Loss: 4.506 Vali Acc: 0.104 Test Loss: 4.506 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.4818757
	speed: 0.3908s/iter; left time: 4655.6059s
Epoch: 23 cost time: 15.25371527671814
Epoch: 23, Steps: 154 | Train Loss: 1.123 Vali Loss: 3.663 Vali Acc: 0.253 Test Loss: 3.663 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.6486701
	speed: 0.3821s/iter; left time: 4493.4755s
Epoch: 24 cost time: 13.637019157409668
Epoch: 24, Steps: 154 | Train Loss: 1.120 Vali Loss: 3.824 Vali Acc: 0.091 Test Loss: 3.824 Test Acc: 0.091
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.9279782
	speed: 0.3845s/iter; left time: 4462.3743s
Epoch: 25 cost time: 14.22114086151123
Epoch: 25, Steps: 154 | Train Loss: 1.199 Vali Loss: 4.040 Vali Acc: 0.118 Test Loss: 4.040 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.9847171
	speed: 0.3874s/iter; left time: 4435.5636s
Epoch: 26 cost time: 14.341800451278687
Epoch: 26, Steps: 154 | Train Loss: 1.427 Vali Loss: 4.715 Vali Acc: 0.094 Test Loss: 4.715 Test Acc: 0.094
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.1371371
	speed: 0.3657s/iter; left time: 4130.9294s
Epoch: 27 cost time: 14.019103765487671
Epoch: 27, Steps: 154 | Train Loss: 1.072 Vali Loss: 4.601 Vali Acc: 0.101 Test Loss: 4.601 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3637469586374696
model parameter : 1455710
model size : 10.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7833283
	speed: 0.1085s/iter; left time: 1659.5684s
Epoch: 1 cost time: 16.22594404220581
Epoch: 1, Steps: 154 | Train Loss: 2.203 Vali Loss: 2.252 Vali Acc: 0.319 Test Loss: 2.252 Test Acc: 0.319
Validation loss decreased (inf --> -0.319118).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8763323
	speed: 0.3931s/iter; left time: 5954.0411s
Epoch: 2 cost time: 13.578595638275146
Epoch: 2, Steps: 154 | Train Loss: 2.041 Vali Loss: 2.163 Vali Acc: 0.325 Test Loss: 2.163 Test Acc: 0.325
Validation loss decreased (-0.319118 --> -0.325201).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5943097
	speed: 0.3597s/iter; left time: 5392.3459s
Epoch: 3 cost time: 14.417206287384033
Epoch: 3, Steps: 154 | Train Loss: 1.943 Vali Loss: 2.235 Vali Acc: 0.331 Test Loss: 2.235 Test Acc: 0.331
Validation loss decreased (-0.325201 --> -0.330878).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5428915
	speed: 0.3684s/iter; left time: 5466.8209s
Epoch: 4 cost time: 13.71238923072815
Epoch: 4, Steps: 154 | Train Loss: 1.792 Vali Loss: 2.326 Vali Acc: 0.346 Test Loss: 2.326 Test Acc: 0.346
Validation loss decreased (-0.330878 --> -0.346287).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6802135
	speed: 0.3604s/iter; left time: 5292.1215s
Epoch: 5 cost time: 13.022254943847656
Epoch: 5, Steps: 154 | Train Loss: 1.703 Vali Loss: 2.373 Vali Acc: 0.354 Test Loss: 2.373 Test Acc: 0.354
Validation loss decreased (-0.346287 --> -0.354396).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6030532
	speed: 0.3780s/iter; left time: 5493.1842s
Epoch: 6 cost time: 14.6050443649292
Epoch: 6, Steps: 154 | Train Loss: 1.691 Vali Loss: 2.326 Vali Acc: 0.360 Test Loss: 2.326 Test Acc: 0.360
Validation loss decreased (-0.354396 --> -0.359669).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6088123
	speed: 0.3883s/iter; left time: 5582.6538s
Epoch: 7 cost time: 13.287500381469727
Epoch: 7, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.448 Vali Acc: 0.371 Test Loss: 2.448 Test Acc: 0.371
Validation loss decreased (-0.359669 --> -0.371022).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9202105
	speed: 0.3601s/iter; left time: 5121.9051s
Epoch: 8 cost time: 13.925870418548584
Epoch: 8, Steps: 154 | Train Loss: 1.538 Vali Loss: 2.677 Vali Acc: 0.302 Test Loss: 2.677 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5829085
	speed: 0.3692s/iter; left time: 5193.9929s
Epoch: 9 cost time: 15.330171823501587
Epoch: 9, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.616 Vali Acc: 0.273 Test Loss: 2.616 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8263593
	speed: 0.3772s/iter; left time: 5249.4092s
Epoch: 10 cost time: 13.88720154762268
Epoch: 10, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.888 Vali Acc: 0.215 Test Loss: 2.888 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.5027552
	speed: 0.3896s/iter; left time: 5361.4131s
Epoch: 11 cost time: 13.403888702392578
Epoch: 11, Steps: 154 | Train Loss: 1.405 Vali Loss: 2.378 Vali Acc: 0.388 Test Loss: 2.378 Test Acc: 0.388
Validation loss decreased (-0.371022 --> -0.387649).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0818930
	speed: 0.3788s/iter; left time: 5154.0626s
Epoch: 12 cost time: 14.255964517593384
Epoch: 12, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.786 Vali Acc: 0.330 Test Loss: 2.786 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4774915
	speed: 0.3723s/iter; left time: 5008.4579s
Epoch: 13 cost time: 13.736680030822754
Epoch: 13, Steps: 154 | Train Loss: 1.331 Vali Loss: 2.912 Vali Acc: 0.189 Test Loss: 2.912 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.4683946
	speed: 0.3691s/iter; left time: 4908.0612s
Epoch: 14 cost time: 13.240309238433838
Epoch: 14, Steps: 154 | Train Loss: 1.310 Vali Loss: 2.887 Vali Acc: 0.345 Test Loss: 2.887 Test Acc: 0.345
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.4601032
	speed: 0.3744s/iter; left time: 4922.0362s
Epoch: 15 cost time: 14.573831558227539
Epoch: 15, Steps: 154 | Train Loss: 1.405 Vali Loss: 3.041 Vali Acc: 0.215 Test Loss: 3.041 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.4185232
	speed: 0.3788s/iter; left time: 4921.4001s
Epoch: 16 cost time: 13.931375980377197
Epoch: 16, Steps: 154 | Train Loss: 1.247 Vali Loss: 2.844 Vali Acc: 0.381 Test Loss: 2.844 Test Acc: 0.381
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.1420389
	speed: 0.3646s/iter; left time: 4680.9068s
Epoch: 17 cost time: 11.853143215179443
Epoch: 17, Steps: 154 | Train Loss: 1.242 Vali Loss: 3.211 Vali Acc: 0.380 Test Loss: 3.211 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.6507177
	speed: 0.3629s/iter; left time: 4603.0603s
Epoch: 18 cost time: 12.556989431381226
Epoch: 18, Steps: 154 | Train Loss: 1.178 Vali Loss: 3.525 Vali Acc: 0.344 Test Loss: 3.525 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.0983022
	speed: 0.3551s/iter; left time: 4448.8426s
Epoch: 19 cost time: 13.976326942443848
Epoch: 19, Steps: 154 | Train Loss: 1.241 Vali Loss: 3.061 Vali Acc: 0.235 Test Loss: 3.061 Test Acc: 0.235
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.6996576
	speed: 0.3490s/iter; left time: 4318.4637s
Epoch: 20 cost time: 13.787378311157227
Epoch: 20, Steps: 154 | Train Loss: 1.112 Vali Loss: 3.724 Vali Acc: 0.174 Test Loss: 3.724 Test Acc: 0.174
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.2145743
	speed: 0.3855s/iter; left time: 4710.7050s
Epoch: 21 cost time: 12.757899045944214
Epoch: 21, Steps: 154 | Train Loss: 1.046 Vali Loss: 3.730 Vali Acc: 0.217 Test Loss: 3.730 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38767234387672345
model parameter : 1455710
model size : 10.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8072739
	speed: 0.1036s/iter; left time: 1585.5695s
Epoch: 1 cost time: 14.374927282333374
Epoch: 1, Steps: 154 | Train Loss: 2.175 Vali Loss: 2.295 Vali Acc: 0.319 Test Loss: 2.295 Test Acc: 0.319
Validation loss decreased (inf --> -0.319117).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3256030
	speed: 0.3582s/iter; left time: 5426.3229s
Epoch: 2 cost time: 14.131383895874023
Epoch: 2, Steps: 154 | Train Loss: 1.996 Vali Loss: 2.194 Vali Acc: 0.330 Test Loss: 2.194 Test Acc: 0.330
Validation loss decreased (-0.319117 --> -0.329662).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6428404
	speed: 0.3873s/iter; left time: 5806.2772s
Epoch: 3 cost time: 15.218615770339966
Epoch: 3, Steps: 154 | Train Loss: 1.868 Vali Loss: 2.181 Vali Acc: 0.333 Test Loss: 2.181 Test Acc: 0.333
Validation loss decreased (-0.329662 --> -0.332906).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2924876
	speed: 0.3814s/iter; left time: 5659.0247s
Epoch: 4 cost time: 13.538984775543213
Epoch: 4, Steps: 154 | Train Loss: 1.721 Vali Loss: 2.381 Vali Acc: 0.346 Test Loss: 2.381 Test Acc: 0.346
Validation loss decreased (-0.332906 --> -0.346286).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5355078
	speed: 0.3740s/iter; left time: 5492.1739s
Epoch: 5 cost time: 13.685355424880981
Epoch: 5, Steps: 154 | Train Loss: 1.640 Vali Loss: 3.024 Vali Acc: 0.189 Test Loss: 3.024 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6059870
	speed: 0.3551s/iter; left time: 5160.6220s
Epoch: 6 cost time: 14.061465740203857
Epoch: 6, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.451 Vali Acc: 0.367 Test Loss: 2.451 Test Acc: 0.367
Validation loss decreased (-0.346286 --> -0.367372).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4343489
	speed: 0.3970s/iter; left time: 5707.1548s
Epoch: 7 cost time: 13.433615922927856
Epoch: 7, Steps: 154 | Train Loss: 1.524 Vali Loss: 2.507 Vali Acc: 0.353 Test Loss: 2.507 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1423668
	speed: 0.3851s/iter; left time: 5477.9841s
Epoch: 8 cost time: 13.830782413482666
Epoch: 8, Steps: 154 | Train Loss: 1.448 Vali Loss: 2.807 Vali Acc: 0.373 Test Loss: 2.807 Test Acc: 0.373
Validation loss decreased (-0.367372 --> -0.372640).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5005610
	speed: 0.3560s/iter; left time: 5009.2464s
Epoch: 9 cost time: 15.264397144317627
Epoch: 9, Steps: 154 | Train Loss: 1.411 Vali Loss: 2.540 Vali Acc: 0.369 Test Loss: 2.540 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5466559
	speed: 0.3405s/iter; left time: 4737.5129s
Epoch: 10 cost time: 13.019659996032715
Epoch: 10, Steps: 154 | Train Loss: 1.342 Vali Loss: 2.824 Vali Acc: 0.378 Test Loss: 2.824 Test Acc: 0.378
Validation loss decreased (-0.372640 --> -0.377912).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4635873
	speed: 0.3598s/iter; left time: 4951.5927s
Epoch: 11 cost time: 13.62813663482666
Epoch: 11, Steps: 154 | Train Loss: 1.371 Vali Loss: 2.725 Vali Acc: 0.381 Test Loss: 2.725 Test Acc: 0.381
Validation loss decreased (-0.377912 --> -0.380751).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9233699
	speed: 0.3551s/iter; left time: 4831.3032s
Epoch: 12 cost time: 12.686798334121704
Epoch: 12, Steps: 154 | Train Loss: 1.237 Vali Loss: 2.825 Vali Acc: 0.283 Test Loss: 2.825 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.2351983
	speed: 0.3390s/iter; left time: 4560.5875s
Epoch: 13 cost time: 12.336572408676147
Epoch: 13, Steps: 154 | Train Loss: 1.305 Vali Loss: 2.540 Vali Acc: 0.378 Test Loss: 2.540 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.3405006
	speed: 0.3416s/iter; left time: 4542.8961s
Epoch: 14 cost time: 12.566669702529907
Epoch: 14, Steps: 154 | Train Loss: 1.200 Vali Loss: 2.704 Vali Acc: 0.385 Test Loss: 2.704 Test Acc: 0.385
Validation loss decreased (-0.380751 --> -0.385212).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2490063
	speed: 0.3312s/iter; left time: 4353.1998s
Epoch: 15 cost time: 13.098388433456421
Epoch: 15, Steps: 154 | Train Loss: 1.271 Vali Loss: 3.238 Vali Acc: 0.224 Test Loss: 3.238 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.4532816
	speed: 0.3624s/iter; left time: 4708.5205s
Epoch: 16 cost time: 13.040330171585083
Epoch: 16, Steps: 154 | Train Loss: 1.230 Vali Loss: 2.446 Vali Acc: 0.382 Test Loss: 2.446 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.9866422
	speed: 0.3652s/iter; left time: 4687.8703s
Epoch: 17 cost time: 13.042065382003784
Epoch: 17, Steps: 154 | Train Loss: 1.156 Vali Loss: 2.634 Vali Acc: 0.384 Test Loss: 2.634 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.3624549
	speed: 0.3509s/iter; left time: 4450.6903s
Epoch: 18 cost time: 13.438616037368774
Epoch: 18, Steps: 154 | Train Loss: 1.139 Vali Loss: 2.957 Vali Acc: 0.240 Test Loss: 2.957 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.7364843
	speed: 0.3130s/iter; left time: 3921.2457s
Epoch: 19 cost time: 12.057925462722778
Epoch: 19, Steps: 154 | Train Loss: 1.040 Vali Loss: 2.931 Vali Acc: 0.216 Test Loss: 2.931 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.4768353
	speed: 0.3591s/iter; left time: 4443.3650s
Epoch: 20 cost time: 13.53744101524353
Epoch: 20, Steps: 154 | Train Loss: 1.105 Vali Loss: 3.547 Vali Acc: 0.107 Test Loss: 3.547 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.0515392
	speed: 0.3647s/iter; left time: 4456.8015s
Epoch: 21 cost time: 13.361079692840576
Epoch: 21, Steps: 154 | Train Loss: 1.049 Vali Loss: 3.002 Vali Acc: 0.329 Test Loss: 3.002 Test Acc: 0.329
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.7136430
	speed: 0.3214s/iter; left time: 3878.8734s
Epoch: 22 cost time: 12.70524549484253
Epoch: 22, Steps: 154 | Train Loss: 1.071 Vali Loss: 2.899 Vali Acc: 0.380 Test Loss: 2.899 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.2716817
	speed: 0.3353s/iter; left time: 3994.6475s
Epoch: 23 cost time: 11.777555704116821
Epoch: 23, Steps: 154 | Train Loss: 1.036 Vali Loss: 2.959 Vali Acc: 0.239 Test Loss: 2.959 Test Acc: 0.239
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.6993061
	speed: 0.3152s/iter; left time: 3707.0195s
Epoch: 24 cost time: 10.810742139816284
Epoch: 24, Steps: 154 | Train Loss: 1.021 Vali Loss: 3.706 Vali Acc: 0.103 Test Loss: 3.706 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38523925385239255
model parameter : 1455710
model size : 10.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5625002
	speed: 0.0983s/iter; left time: 1503.6710s
Epoch: 1 cost time: 13.768361330032349
Epoch: 1, Steps: 154 | Train Loss: 2.213 Vali Loss: 2.238 Vali Acc: 0.324 Test Loss: 2.238 Test Acc: 0.324
Validation loss decreased (inf --> -0.323984).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9407229
	speed: 0.3219s/iter; left time: 4876.5401s
Epoch: 2 cost time: 12.517028093338013
Epoch: 2, Steps: 154 | Train Loss: 2.090 Vali Loss: 2.180 Vali Acc: 0.326 Test Loss: 2.180 Test Acc: 0.326
Validation loss decreased (-0.323984 --> -0.325607).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9839894
	speed: 0.3252s/iter; left time: 4875.8184s
Epoch: 3 cost time: 12.110826253890991
Epoch: 3, Steps: 154 | Train Loss: 2.022 Vali Loss: 2.224 Vali Acc: 0.331 Test Loss: 2.224 Test Acc: 0.331
Validation loss decreased (-0.325607 --> -0.330878).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9659641
	speed: 0.3022s/iter; left time: 4483.8216s
Epoch: 4 cost time: 12.036538124084473
Epoch: 4, Steps: 154 | Train Loss: 1.904 Vali Loss: 2.291 Vali Acc: 0.329 Test Loss: 2.291 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.0174794
	speed: 0.3438s/iter; left time: 5048.3696s
Epoch: 5 cost time: 12.613154172897339
Epoch: 5, Steps: 154 | Train Loss: 1.853 Vali Loss: 2.255 Vali Acc: 0.348 Test Loss: 2.255 Test Acc: 0.348
Validation loss decreased (-0.330878 --> -0.347504).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4505302
	speed: 0.3303s/iter; left time: 4799.7344s
Epoch: 6 cost time: 12.28774905204773
Epoch: 6, Steps: 154 | Train Loss: 1.747 Vali Loss: 2.414 Vali Acc: 0.345 Test Loss: 2.414 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.9840034
	speed: 0.3352s/iter; left time: 4818.8711s
Epoch: 7 cost time: 12.986550331115723
Epoch: 7, Steps: 154 | Train Loss: 1.728 Vali Loss: 2.602 Vali Acc: 0.363 Test Loss: 2.602 Test Acc: 0.363
Validation loss decreased (-0.347504 --> -0.362504).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3079500
	speed: 0.3220s/iter; left time: 4580.2551s
Epoch: 8 cost time: 11.740291833877563
Epoch: 8, Steps: 154 | Train Loss: 1.715 Vali Loss: 2.581 Vali Acc: 0.351 Test Loss: 2.581 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0752344
	speed: 0.3271s/iter; left time: 4601.3458s
Epoch: 9 cost time: 12.516915559768677
Epoch: 9, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.776 Vali Acc: 0.360 Test Loss: 2.776 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4940445
	speed: 0.3508s/iter; left time: 4880.7468s
Epoch: 10 cost time: 12.49026346206665
Epoch: 10, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.815 Vali Acc: 0.363 Test Loss: 2.815 Test Acc: 0.363
Validation loss decreased (-0.362504 --> -0.363313).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3081369
	speed: 0.3249s/iter; left time: 4470.8043s
Epoch: 11 cost time: 12.793621063232422
Epoch: 11, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.739 Vali Acc: 0.365 Test Loss: 2.739 Test Acc: 0.365
Validation loss decreased (-0.363313 --> -0.364936).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4536971
	speed: 0.3225s/iter; left time: 4387.6236s
Epoch: 12 cost time: 12.544891595840454
Epoch: 12, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.808 Vali Acc: 0.361 Test Loss: 2.808 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.8801340
	speed: 0.3369s/iter; left time: 4531.7371s
Epoch: 13 cost time: 13.004480361938477
Epoch: 13, Steps: 154 | Train Loss: 1.558 Vali Loss: 3.037 Vali Acc: 0.310 Test Loss: 3.037 Test Acc: 0.310
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.7742534
	speed: 0.3305s/iter; left time: 4395.3132s
Epoch: 14 cost time: 12.316827774047852
Epoch: 14, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.660 Vali Acc: 0.214 Test Loss: 2.660 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.1195142
	speed: 0.3204s/iter; left time: 4211.4144s
Epoch: 15 cost time: 12.594557523727417
Epoch: 15, Steps: 154 | Train Loss: 1.438 Vali Loss: 3.170 Vali Acc: 0.082 Test Loss: 3.170 Test Acc: 0.082
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 2.5813313
	speed: 0.3308s/iter; left time: 4297.1977s
Epoch: 16 cost time: 11.132989406585693
Epoch: 16, Steps: 154 | Train Loss: 1.334 Vali Loss: 3.016 Vali Acc: 0.356 Test Loss: 3.016 Test Acc: 0.356
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.2818735
	speed: 0.3117s/iter; left time: 4001.1066s
Epoch: 17 cost time: 11.798157930374146
Epoch: 17, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.588 Vali Acc: 0.075 Test Loss: 3.588 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.8402509
	speed: 0.2955s/iter; left time: 3747.2855s
Epoch: 18 cost time: 10.728965759277344
Epoch: 18, Steps: 154 | Train Loss: 1.361 Vali Loss: 3.648 Vali Acc: 0.065 Test Loss: 3.648 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.3352946
	speed: 0.3174s/iter; left time: 3976.1902s
Epoch: 19 cost time: 11.913727283477783
Epoch: 19, Steps: 154 | Train Loss: 1.321 Vali Loss: 3.532 Vali Acc: 0.095 Test Loss: 3.532 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.9767186
	speed: 0.3208s/iter; left time: 3969.9157s
Epoch: 20 cost time: 12.364806652069092
Epoch: 20, Steps: 154 | Train Loss: 1.372 Vali Loss: 3.844 Vali Acc: 0.070 Test Loss: 3.844 Test Acc: 0.070
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.5598952
	speed: 0.3279s/iter; left time: 4007.0422s
Epoch: 21 cost time: 12.891839504241943
Epoch: 21, Steps: 154 | Train Loss: 1.373 Vali Loss: 3.525 Vali Acc: 0.105 Test Loss: 3.525 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36496350364963503
model parameter : 931422
model size : 8.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5326405
	speed: 0.0965s/iter; left time: 1477.3075s
Epoch: 1 cost time: 13.88796591758728
Epoch: 1, Steps: 154 | Train Loss: 2.211 Vali Loss: 2.221 Vali Acc: 0.324 Test Loss: 2.221 Test Acc: 0.324
Validation loss decreased (inf --> -0.323579).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9279172
	speed: 0.3301s/iter; left time: 5000.0059s
Epoch: 2 cost time: 12.85068678855896
Epoch: 2, Steps: 154 | Train Loss: 2.083 Vali Loss: 2.192 Vali Acc: 0.324 Test Loss: 2.192 Test Acc: 0.324
Validation loss decreased (-0.323579 --> -0.324390).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9766017
	speed: 0.3161s/iter; left time: 4739.2237s
Epoch: 3 cost time: 12.208134412765503
Epoch: 3, Steps: 154 | Train Loss: 1.983 Vali Loss: 2.207 Vali Acc: 0.327 Test Loss: 2.207 Test Acc: 0.327
Validation loss decreased (-0.324390 --> -0.327229).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0245633
	speed: 0.3218s/iter; left time: 4774.8549s
Epoch: 4 cost time: 12.037042617797852
Epoch: 4, Steps: 154 | Train Loss: 1.867 Vali Loss: 2.247 Vali Acc: 0.333 Test Loss: 2.247 Test Acc: 0.333
Validation loss decreased (-0.327229 --> -0.332500).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0195980
	speed: 0.3419s/iter; left time: 5020.7289s
Epoch: 5 cost time: 12.970290422439575
Epoch: 5, Steps: 154 | Train Loss: 1.851 Vali Loss: 2.269 Vali Acc: 0.344 Test Loss: 2.269 Test Acc: 0.344
Validation loss decreased (-0.332500 --> -0.344260).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4373709
	speed: 0.3426s/iter; left time: 4978.3097s
Epoch: 6 cost time: 12.285982370376587
Epoch: 6, Steps: 154 | Train Loss: 1.705 Vali Loss: 2.291 Vali Acc: 0.342 Test Loss: 2.291 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0146525
	speed: 0.3027s/iter; left time: 4352.1158s
Epoch: 7 cost time: 12.141906023025513
Epoch: 7, Steps: 154 | Train Loss: 1.698 Vali Loss: 2.507 Vali Acc: 0.214 Test Loss: 2.507 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.2124859
	speed: 0.3207s/iter; left time: 4561.4901s
Epoch: 8 cost time: 11.23744511604309
Epoch: 8, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.549 Vali Acc: 0.352 Test Loss: 2.549 Test Acc: 0.352
Validation loss decreased (-0.344260 --> -0.351962).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0294404
	speed: 0.3133s/iter; left time: 4407.2611s
Epoch: 9 cost time: 12.283177852630615
Epoch: 9, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.562 Vali Acc: 0.350 Test Loss: 2.562 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5733360
	speed: 0.3130s/iter; left time: 4355.3208s
Epoch: 10 cost time: 10.886303424835205
Epoch: 10, Steps: 154 | Train Loss: 1.538 Vali Loss: 2.836 Vali Acc: 0.185 Test Loss: 2.836 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4215310
	speed: 0.2555s/iter; left time: 3516.3380s
Epoch: 11 cost time: 12.195125102996826
Epoch: 11, Steps: 154 | Train Loss: 1.610 Vali Loss: 2.742 Vali Acc: 0.367 Test Loss: 2.742 Test Acc: 0.367
Validation loss decreased (-0.351962 --> -0.366964).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2829955
	speed: 0.3105s/iter; left time: 4224.3582s
Epoch: 12 cost time: 11.983450412750244
Epoch: 12, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.907 Vali Acc: 0.361 Test Loss: 2.907 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9492472
	speed: 0.3096s/iter; left time: 4165.2831s
Epoch: 13 cost time: 11.720035552978516
Epoch: 13, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.988 Vali Acc: 0.360 Test Loss: 2.988 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.8911891
	speed: 0.3093s/iter; left time: 4112.9345s
Epoch: 14 cost time: 12.563000917434692
Epoch: 14, Steps: 154 | Train Loss: 1.410 Vali Loss: 3.176 Vali Acc: 0.190 Test Loss: 3.176 Test Acc: 0.190
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.3231329
	speed: 0.3266s/iter; left time: 4293.0116s
Epoch: 15 cost time: 11.33968734741211
Epoch: 15, Steps: 154 | Train Loss: 1.377 Vali Loss: 2.913 Vali Acc: 0.356 Test Loss: 2.913 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.9911894
	speed: 0.3201s/iter; left time: 4158.6927s
Epoch: 16 cost time: 12.810338735580444
Epoch: 16, Steps: 154 | Train Loss: 1.362 Vali Loss: 2.962 Vali Acc: 0.196 Test Loss: 2.962 Test Acc: 0.196
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.0543299
	speed: 0.3177s/iter; left time: 4078.3536s
Epoch: 17 cost time: 11.766091346740723
Epoch: 17, Steps: 154 | Train Loss: 1.303 Vali Loss: 3.282 Vali Acc: 0.082 Test Loss: 3.282 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.8763759
	speed: 0.3077s/iter; left time: 3902.0377s
Epoch: 18 cost time: 11.244216442108154
Epoch: 18, Steps: 154 | Train Loss: 1.303 Vali Loss: 4.222 Vali Acc: 0.079 Test Loss: 4.222 Test Acc: 0.079
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.5132282
	speed: 0.3032s/iter; left time: 3799.0261s
Epoch: 19 cost time: 12.044967412948608
Epoch: 19, Steps: 154 | Train Loss: 1.323 Vali Loss: 3.457 Vali Acc: 0.210 Test Loss: 3.457 Test Acc: 0.210
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.8152475
	speed: 0.3120s/iter; left time: 3861.1521s
Epoch: 20 cost time: 11.900324821472168
Epoch: 20, Steps: 154 | Train Loss: 1.186 Vali Loss: 3.957 Vali Acc: 0.151 Test Loss: 3.957 Test Acc: 0.151
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.1896740
	speed: 0.3230s/iter; left time: 3947.1813s
Epoch: 21 cost time: 12.639452695846558
Epoch: 21, Steps: 154 | Train Loss: 1.255 Vali Loss: 3.692 Vali Acc: 0.099 Test Loss: 3.692 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36699107866991076
model parameter : 931422
model size : 8.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4288092
	speed: 0.0767s/iter; left time: 1173.5011s
Epoch: 1 cost time: 11.03996729850769
Epoch: 1, Steps: 154 | Train Loss: 2.208 Vali Loss: 2.211 Vali Acc: 0.324 Test Loss: 2.211 Test Acc: 0.324
Validation loss decreased (inf --> -0.323579).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9269516
	speed: 0.3042s/iter; left time: 4608.2844s
Epoch: 2 cost time: 11.720303058624268
Epoch: 2, Steps: 154 | Train Loss: 2.085 Vali Loss: 2.177 Vali Acc: 0.324 Test Loss: 2.177 Test Acc: 0.324
Validation loss decreased (-0.323579 --> -0.323579).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0819569
	speed: 0.3045s/iter; left time: 4565.2892s
Epoch: 3 cost time: 11.681576251983643
Epoch: 3, Steps: 154 | Train Loss: 1.969 Vali Loss: 2.232 Vali Acc: 0.333 Test Loss: 2.232 Test Acc: 0.333
Validation loss decreased (-0.323579 --> -0.333311).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8729508
	speed: 0.3178s/iter; left time: 4716.2272s
Epoch: 4 cost time: 11.42235541343689
Epoch: 4, Steps: 154 | Train Loss: 1.806 Vali Loss: 2.265 Vali Acc: 0.337 Test Loss: 2.265 Test Acc: 0.337
Validation loss decreased (-0.333311 --> -0.337366).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9308586
	speed: 0.3295s/iter; left time: 4838.3437s
Epoch: 5 cost time: 12.477676630020142
Epoch: 5, Steps: 154 | Train Loss: 1.791 Vali Loss: 2.234 Vali Acc: 0.352 Test Loss: 2.234 Test Acc: 0.352
Validation loss decreased (-0.337366 --> -0.352370).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2887869
	speed: 0.3292s/iter; left time: 4783.1971s
Epoch: 6 cost time: 12.2453293800354
Epoch: 6, Steps: 154 | Train Loss: 1.699 Vali Loss: 2.340 Vali Acc: 0.347 Test Loss: 2.340 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3940787
	speed: 0.3048s/iter; left time: 4382.2991s
Epoch: 7 cost time: 12.593138456344604
Epoch: 7, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.533 Vali Acc: 0.200 Test Loss: 2.533 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.2966522
	speed: 0.3129s/iter; left time: 4450.5302s
Epoch: 8 cost time: 12.145081520080566
Epoch: 8, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.567 Vali Acc: 0.358 Test Loss: 2.567 Test Acc: 0.358
Validation loss decreased (-0.352370 --> -0.358044).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8846488
	speed: 0.3109s/iter; left time: 4373.3776s
Epoch: 9 cost time: 11.978682279586792
Epoch: 9, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.914 Vali Acc: 0.360 Test Loss: 2.914 Test Acc: 0.360
Validation loss decreased (-0.358044 --> -0.359663).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7967157
	speed: 0.3197s/iter; left time: 4448.7487s
Epoch: 10 cost time: 11.33761215209961
Epoch: 10, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.765 Vali Acc: 0.366 Test Loss: 2.765 Test Acc: 0.366
Validation loss decreased (-0.359663 --> -0.366152).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3399900
	speed: 0.3073s/iter; left time: 4228.6763s
Epoch: 11 cost time: 12.341630935668945
Epoch: 11, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.600 Vali Acc: 0.375 Test Loss: 2.600 Test Acc: 0.375
Validation loss decreased (-0.366152 --> -0.374670).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4042617
	speed: 0.3160s/iter; left time: 4299.7555s
Epoch: 12 cost time: 11.661388158798218
Epoch: 12, Steps: 154 | Train Loss: 1.367 Vali Loss: 2.650 Vali Acc: 0.372 Test Loss: 2.650 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9929091
	speed: 0.2694s/iter; left time: 3623.6296s
Epoch: 13 cost time: 10.426610946655273
Epoch: 13, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.805 Vali Acc: 0.256 Test Loss: 2.805 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.6185533
	speed: 0.2886s/iter; left time: 3838.3581s
Epoch: 14 cost time: 11.412034034729004
Epoch: 14, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.917 Vali Acc: 0.213 Test Loss: 2.917 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.1196345
	speed: 0.3195s/iter; left time: 4200.0483s
Epoch: 15 cost time: 11.693607568740845
Epoch: 15, Steps: 154 | Train Loss: 1.276 Vali Loss: 2.915 Vali Acc: 0.373 Test Loss: 2.915 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.8190292
	speed: 0.3225s/iter; left time: 4189.9537s
Epoch: 16 cost time: 12.068647623062134
Epoch: 16, Steps: 154 | Train Loss: 1.315 Vali Loss: 3.195 Vali Acc: 0.193 Test Loss: 3.195 Test Acc: 0.193
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.3848057
	speed: 0.3327s/iter; left time: 4270.7962s
Epoch: 17 cost time: 11.662514686584473
Epoch: 17, Steps: 154 | Train Loss: 1.300 Vali Loss: 3.233 Vali Acc: 0.214 Test Loss: 3.233 Test Acc: 0.214
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.9130450
	speed: 0.3024s/iter; left time: 3834.9069s
Epoch: 18 cost time: 11.559030294418335
Epoch: 18, Steps: 154 | Train Loss: 1.188 Vali Loss: 3.617 Vali Acc: 0.079 Test Loss: 3.617 Test Acc: 0.079
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.4056466
	speed: 0.3138s/iter; left time: 3932.1702s
Epoch: 19 cost time: 11.627510070800781
Epoch: 19, Steps: 154 | Train Loss: 1.232 Vali Loss: 3.248 Vali Acc: 0.221 Test Loss: 3.248 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.6705411
	speed: 0.3035s/iter; left time: 3755.4335s
Epoch: 20 cost time: 12.426200151443481
Epoch: 20, Steps: 154 | Train Loss: 1.360 Vali Loss: 3.981 Vali Acc: 0.182 Test Loss: 3.981 Test Acc: 0.182
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.8138879
	speed: 0.3196s/iter; left time: 3905.7261s
Epoch: 21 cost time: 10.998578786849976
Epoch: 21, Steps: 154 | Train Loss: 1.420 Vali Loss: 3.784 Vali Acc: 0.103 Test Loss: 3.784 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3746958637469586
model parameter : 931422
model size : 8.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4532988
	speed: 0.0967s/iter; left time: 1479.9267s
Epoch: 1 cost time: 13.955593585968018
Epoch: 1, Steps: 154 | Train Loss: 2.185 Vali Loss: 2.243 Vali Acc: 0.322 Test Loss: 2.243 Test Acc: 0.322
Validation loss decreased (inf --> -0.322362).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9432276
	speed: 0.3294s/iter; left time: 4989.0975s
Epoch: 2 cost time: 11.311398029327393
Epoch: 2, Steps: 154 | Train Loss: 2.055 Vali Loss: 2.224 Vali Acc: 0.324 Test Loss: 2.224 Test Acc: 0.324
Validation loss decreased (-0.322362 --> -0.324390).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1031921
	speed: 0.3666s/iter; left time: 5495.8652s
Epoch: 3 cost time: 14.502922534942627
Epoch: 3, Steps: 154 | Train Loss: 1.878 Vali Loss: 2.283 Vali Acc: 0.338 Test Loss: 2.283 Test Acc: 0.338
Validation loss decreased (-0.324390 --> -0.338177).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9768003
	speed: 0.4125s/iter; left time: 6121.2367s
Epoch: 4 cost time: 13.374850511550903
Epoch: 4, Steps: 154 | Train Loss: 1.718 Vali Loss: 2.895 Vali Acc: 0.340 Test Loss: 2.895 Test Acc: 0.340
Validation loss decreased (-0.338177 --> -0.340198).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8704362
	speed: 0.4247s/iter; left time: 6237.2782s
Epoch: 5 cost time: 14.925328016281128
Epoch: 5, Steps: 154 | Train Loss: 1.666 Vali Loss: 2.506 Vali Acc: 0.281 Test Loss: 2.506 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3057125
	speed: 0.4167s/iter; left time: 6054.8284s
Epoch: 6 cost time: 14.392462253570557
Epoch: 6, Steps: 154 | Train Loss: 1.686 Vali Loss: 2.282 Vali Acc: 0.358 Test Loss: 2.282 Test Acc: 0.358
Validation loss decreased (-0.340198 --> -0.358047).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1507938
	speed: 0.4213s/iter; left time: 6057.2383s
Epoch: 7 cost time: 14.188422679901123
Epoch: 7, Steps: 154 | Train Loss: 1.578 Vali Loss: 2.642 Vali Acc: 0.198 Test Loss: 2.642 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.2468505
	speed: 0.3780s/iter; left time: 5375.8717s
Epoch: 8 cost time: 13.540587902069092
Epoch: 8, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.715 Vali Acc: 0.368 Test Loss: 2.715 Test Acc: 0.368
Validation loss decreased (-0.358047 --> -0.367775).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7405851
	speed: 0.3937s/iter; left time: 5538.4656s
Epoch: 9 cost time: 13.187165975570679
Epoch: 9, Steps: 154 | Train Loss: 1.393 Vali Loss: 2.896 Vali Acc: 0.357 Test Loss: 2.896 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.3059673
	speed: 0.3732s/iter; left time: 5193.6864s
Epoch: 10 cost time: 13.894729375839233
Epoch: 10, Steps: 154 | Train Loss: 1.364 Vali Loss: 2.962 Vali Acc: 0.369 Test Loss: 2.962 Test Acc: 0.369
Validation loss decreased (-0.367775 --> -0.368989).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.1362159
	speed: 0.4037s/iter; left time: 5555.1819s
Epoch: 11 cost time: 14.234512329101562
Epoch: 11, Steps: 154 | Train Loss: 1.338 Vali Loss: 2.461 Vali Acc: 0.396 Test Loss: 2.461 Test Acc: 0.396
Validation loss decreased (-0.368989 --> -0.396164).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2637109
	speed: 0.3616s/iter; left time: 4919.9127s
Epoch: 12 cost time: 13.34935712814331
Epoch: 12, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.921 Vali Acc: 0.370 Test Loss: 2.921 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9354957
	speed: 0.3697s/iter; left time: 4973.3107s
Epoch: 13 cost time: 12.830124616622925
Epoch: 13, Steps: 154 | Train Loss: 1.310 Vali Loss: 2.944 Vali Acc: 0.374 Test Loss: 2.944 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.5145035
	speed: 0.3222s/iter; left time: 4284.3856s
Epoch: 14 cost time: 12.928326845169067
Epoch: 14, Steps: 154 | Train Loss: 1.251 Vali Loss: 2.962 Vali Acc: 0.245 Test Loss: 2.962 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.9796662
	speed: 0.3898s/iter; left time: 5123.9921s
Epoch: 15 cost time: 13.676573753356934
Epoch: 15, Steps: 154 | Train Loss: 1.168 Vali Loss: 2.927 Vali Acc: 0.377 Test Loss: 2.927 Test Acc: 0.377
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 2.2017908
	speed: 0.3966s/iter; left time: 5152.1611s
Epoch: 16 cost time: 13.93879747390747
Epoch: 16, Steps: 154 | Train Loss: 1.180 Vali Loss: 2.858 Vali Acc: 0.388 Test Loss: 2.858 Test Acc: 0.388
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.3511616
	speed: 0.3962s/iter; left time: 5086.1063s
Epoch: 17 cost time: 14.287287950515747
Epoch: 17, Steps: 154 | Train Loss: 1.243 Vali Loss: 2.837 Vali Acc: 0.253 Test Loss: 2.837 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.9277813
	speed: 0.3969s/iter; left time: 5033.9110s
Epoch: 18 cost time: 14.066791296005249
Epoch: 18, Steps: 154 | Train Loss: 1.293 Vali Loss: 2.806 Vali Acc: 0.380 Test Loss: 2.806 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.1788981
	speed: 0.3648s/iter; left time: 4570.2225s
Epoch: 19 cost time: 13.798273801803589
Epoch: 19, Steps: 154 | Train Loss: 1.175 Vali Loss: 3.147 Vali Acc: 0.397 Test Loss: 3.147 Test Acc: 0.397
Validation loss decreased (-0.396164 --> -0.396968).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.6151329
	speed: 0.4239s/iter; left time: 5245.9199s
Epoch: 20 cost time: 14.488911390304565
Epoch: 20, Steps: 154 | Train Loss: 1.082 Vali Loss: 3.436 Vali Acc: 0.350 Test Loss: 3.436 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.8389239
	speed: 0.3814s/iter; left time: 4661.4764s
Epoch: 21 cost time: 13.680697917938232
Epoch: 21, Steps: 154 | Train Loss: 1.058 Vali Loss: 3.226 Vali Acc: 0.237 Test Loss: 3.226 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.0616937
	speed: 0.3714s/iter; left time: 4481.7151s
Epoch: 22 cost time: 13.238308191299438
Epoch: 22, Steps: 154 | Train Loss: 1.103 Vali Loss: 3.178 Vali Acc: 0.370 Test Loss: 3.178 Test Acc: 0.370
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.0425677
	speed: 0.3820s/iter; left time: 4550.3230s
Epoch: 23 cost time: 14.327280759811401
Epoch: 23, Steps: 154 | Train Loss: 1.050 Vali Loss: 3.915 Vali Acc: 0.198 Test Loss: 3.915 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.0783966
	speed: 0.3963s/iter; left time: 4660.3526s
Epoch: 24 cost time: 13.876038551330566
Epoch: 24, Steps: 154 | Train Loss: 1.018 Vali Loss: 3.513 Vali Acc: 0.328 Test Loss: 3.513 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.9720365
	speed: 0.3693s/iter; left time: 4285.9692s
Epoch: 25 cost time: 15.10448431968689
Epoch: 25, Steps: 154 | Train Loss: 1.025 Vali Loss: 3.362 Vali Acc: 0.331 Test Loss: 3.362 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.9572088
	speed: 0.3913s/iter; left time: 4480.4012s
Epoch: 26 cost time: 13.577626943588257
Epoch: 26, Steps: 154 | Train Loss: 0.897 Vali Loss: 3.326 Vali Acc: 0.234 Test Loss: 3.326 Test Acc: 0.234
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.8403012
	speed: 0.3684s/iter; left time: 4162.2249s
Epoch: 27 cost time: 12.452917575836182
Epoch: 27, Steps: 154 | Train Loss: 0.898 Vali Loss: 3.639 Vali Acc: 0.147 Test Loss: 3.639 Test Acc: 0.147
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.5045674
	speed: 0.3657s/iter; left time: 4074.6395s
Epoch: 28 cost time: 12.218222618103027
Epoch: 28, Steps: 154 | Train Loss: 1.020 Vali Loss: 3.266 Vali Acc: 0.386 Test Loss: 3.266 Test Acc: 0.386
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.0109639
	speed: 0.3924s/iter; left time: 4311.7943s
Epoch: 29 cost time: 14.266449213027954
Epoch: 29, Steps: 154 | Train Loss: 0.941 Vali Loss: 3.363 Vali Acc: 0.399 Test Loss: 3.363 Test Acc: 0.399
Validation loss decreased (-0.396968 --> -0.398588).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.7764338
	speed: 0.3816s/iter; left time: 4134.7592s
Epoch: 30 cost time: 13.426689386367798
Epoch: 30, Steps: 154 | Train Loss: 0.929 Vali Loss: 3.602 Vali Acc: 0.393 Test Loss: 3.602 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.6609783
	speed: 0.3892s/iter; left time: 4156.8514s
Epoch: 31 cost time: 14.616301774978638
Epoch: 31, Steps: 154 | Train Loss: 0.871 Vali Loss: 3.841 Vali Acc: 0.206 Test Loss: 3.841 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.0038857
	speed: 0.4124s/iter; left time: 4340.8961s
Epoch: 32 cost time: 13.948954820632935
Epoch: 32, Steps: 154 | Train Loss: 0.867 Vali Loss: 3.482 Vali Acc: 0.231 Test Loss: 3.482 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.8821949
	speed: 0.4016s/iter; left time: 4165.6416s
Epoch: 33 cost time: 13.952583074569702
Epoch: 33, Steps: 154 | Train Loss: 0.897 Vali Loss: 4.386 Vali Acc: 0.121 Test Loss: 4.386 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.6525464
	speed: 0.4292s/iter; left time: 4386.4075s
Epoch: 34 cost time: 15.911107301712036
Epoch: 34, Steps: 154 | Train Loss: 0.885 Vali Loss: 3.690 Vali Acc: 0.399 Test Loss: 3.690 Test Acc: 0.399
Validation loss decreased (-0.398588 --> -0.399395).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.7775918
	speed: 0.4394s/iter; left time: 4422.1078s
Epoch: 35 cost time: 15.688851594924927
Epoch: 35, Steps: 154 | Train Loss: 0.845 Vali Loss: 4.791 Vali Acc: 0.121 Test Loss: 4.791 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.5184696
	speed: 0.4446s/iter; left time: 4405.9375s
Epoch: 36 cost time: 15.861230850219727
Epoch: 36, Steps: 154 | Train Loss: 0.813 Vali Loss: 4.227 Vali Acc: 0.137 Test Loss: 4.227 Test Acc: 0.137
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.5062250
	speed: 0.4421s/iter; left time: 4313.6706s
Epoch: 37 cost time: 15.847413063049316
Epoch: 37, Steps: 154 | Train Loss: 0.899 Vali Loss: 4.351 Vali Acc: 0.122 Test Loss: 4.351 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.7351655
	speed: 0.4175s/iter; left time: 4009.2240s
Epoch: 38 cost time: 15.083231687545776
Epoch: 38, Steps: 154 | Train Loss: 0.746 Vali Loss: 4.506 Vali Acc: 0.116 Test Loss: 4.506 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.6238519
	speed: 0.3968s/iter; left time: 3749.2995s
Epoch: 39 cost time: 14.140464544296265
Epoch: 39, Steps: 154 | Train Loss: 0.786 Vali Loss: 4.472 Vali Acc: 0.138 Test Loss: 4.472 Test Acc: 0.138
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.4907166
	speed: 0.4108s/iter; left time: 3818.0027s
Epoch: 40 cost time: 14.588103771209717
Epoch: 40, Steps: 154 | Train Loss: 0.788 Vali Loss: 4.909 Vali Acc: 0.130 Test Loss: 4.909 Test Acc: 0.130
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.9088490
	speed: 0.3965s/iter; left time: 3624.3393s
Epoch: 41 cost time: 14.068891525268555
Epoch: 41, Steps: 154 | Train Loss: 1.472 Vali Loss: 4.594 Vali Acc: 0.122 Test Loss: 4.594 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.4136963
	speed: 0.4092s/iter; left time: 3677.0739s
Epoch: 42 cost time: 14.175884485244751
Epoch: 42, Steps: 154 | Train Loss: 0.868 Vali Loss: 4.144 Vali Acc: 0.190 Test Loss: 4.144 Test Acc: 0.190
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.8465075
	speed: 0.3937s/iter; left time: 3477.7224s
Epoch: 43 cost time: 14.719353199005127
Epoch: 43, Steps: 154 | Train Loss: 1.186 Vali Loss: 4.482 Vali Acc: 0.375 Test Loss: 4.482 Test Acc: 0.375
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 1.2130432
	speed: 0.4005s/iter; left time: 3475.7329s
Epoch: 44 cost time: 13.637126445770264
Epoch: 44, Steps: 154 | Train Loss: 0.732 Vali Loss: 4.508 Vali Acc: 0.135 Test Loss: 4.508 Test Acc: 0.135
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39943227899432276
model parameter : 931422
model size : 8.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9690547
	speed: 0.1174s/iter; left time: 1796.0605s
Epoch: 1 cost time: 16.50575280189514
Epoch: 1, Steps: 154 | Train Loss: 2.255 Vali Loss: 2.151 Vali Acc: 0.325 Test Loss: 2.151 Test Acc: 0.325
Validation loss decreased (inf --> -0.325202).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2320330
	speed: 0.3696s/iter; left time: 5598.9535s
Epoch: 2 cost time: 14.391661643981934
Epoch: 2, Steps: 154 | Train Loss: 2.064 Vali Loss: 2.221 Vali Acc: 0.324 Test Loss: 2.221 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.5963968
	speed: 0.3425s/iter; left time: 5135.8462s
Epoch: 3 cost time: 15.785560846328735
Epoch: 3, Steps: 154 | Train Loss: 1.956 Vali Loss: 2.235 Vali Acc: 0.328 Test Loss: 2.235 Test Acc: 0.328
Validation loss decreased (-0.325202 --> -0.328039).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2817020
	speed: 0.3919s/iter; left time: 5814.8165s
Epoch: 4 cost time: 15.095115900039673
Epoch: 4, Steps: 154 | Train Loss: 1.899 Vali Loss: 2.268 Vali Acc: 0.330 Test Loss: 2.268 Test Acc: 0.330
Validation loss decreased (-0.328039 --> -0.330067).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6921145
	speed: 0.3879s/iter; left time: 5696.8596s
Epoch: 5 cost time: 14.646810054779053
Epoch: 5, Steps: 154 | Train Loss: 1.820 Vali Loss: 2.429 Vali Acc: 0.339 Test Loss: 2.429 Test Acc: 0.339
Validation loss decreased (-0.330067 --> -0.339392).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8394436
	speed: 0.3751s/iter; left time: 5450.7262s
Epoch: 6 cost time: 15.681691646575928
Epoch: 6, Steps: 154 | Train Loss: 1.730 Vali Loss: 2.535 Vali Acc: 0.349 Test Loss: 2.535 Test Acc: 0.349
Validation loss decreased (-0.339392 --> -0.349123).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6670913
	speed: 0.3703s/iter; left time: 5324.2795s
Epoch: 7 cost time: 14.218342065811157
Epoch: 7, Steps: 154 | Train Loss: 1.743 Vali Loss: 2.587 Vali Acc: 0.352 Test Loss: 2.587 Test Acc: 0.352
Validation loss decreased (-0.349123 --> -0.351556).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1391504
	speed: 0.3244s/iter; left time: 4614.2084s
Epoch: 8 cost time: 10.971405267715454
Epoch: 8, Steps: 154 | Train Loss: 1.662 Vali Loss: 2.770 Vali Acc: 0.361 Test Loss: 2.770 Test Acc: 0.361
Validation loss decreased (-0.351556 --> -0.360881).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9527924
	speed: 0.3584s/iter; left time: 5042.6984s
Epoch: 9 cost time: 14.224870681762695
Epoch: 9, Steps: 154 | Train Loss: 1.631 Vali Loss: 2.681 Vali Acc: 0.145 Test Loss: 2.681 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2944109
	speed: 0.3603s/iter; left time: 5013.0447s
Epoch: 10 cost time: 14.23237919807434
Epoch: 10, Steps: 154 | Train Loss: 1.537 Vali Loss: 3.031 Vali Acc: 0.083 Test Loss: 3.031 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.3677223
	speed: 0.3324s/iter; left time: 4573.9256s
Epoch: 11 cost time: 11.593261480331421
Epoch: 11, Steps: 154 | Train Loss: 1.571 Vali Loss: 3.087 Vali Acc: 0.072 Test Loss: 3.087 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.1605012
	speed: 0.3610s/iter; left time: 4911.6756s
Epoch: 12 cost time: 14.182908773422241
Epoch: 12, Steps: 154 | Train Loss: 1.457 Vali Loss: 3.073 Vali Acc: 0.083 Test Loss: 3.073 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.5485953
	speed: 0.3582s/iter; left time: 4818.2950s
Epoch: 13 cost time: 14.370255947113037
Epoch: 13, Steps: 154 | Train Loss: 1.427 Vali Loss: 3.050 Vali Acc: 0.084 Test Loss: 3.050 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.7020928
	speed: 0.3548s/iter; left time: 4718.3271s
Epoch: 14 cost time: 13.113160848617554
Epoch: 14, Steps: 154 | Train Loss: 1.618 Vali Loss: 3.069 Vali Acc: 0.084 Test Loss: 3.069 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.7490691
	speed: 0.3297s/iter; left time: 4334.3267s
Epoch: 15 cost time: 9.904112577438354
Epoch: 15, Steps: 154 | Train Loss: 1.400 Vali Loss: 3.386 Vali Acc: 0.089 Test Loss: 3.386 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.0853250
	speed: 0.3298s/iter; left time: 4284.1435s
Epoch: 16 cost time: 16.064934730529785
Epoch: 16, Steps: 154 | Train Loss: 1.430 Vali Loss: 3.537 Vali Acc: 0.094 Test Loss: 3.537 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.2993590
	speed: 0.3794s/iter; left time: 4870.0122s
Epoch: 17 cost time: 15.307621479034424
Epoch: 17, Steps: 154 | Train Loss: 1.428 Vali Loss: 4.107 Vali Acc: 0.071 Test Loss: 4.107 Test Acc: 0.071
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.7346973
	speed: 0.3799s/iter; left time: 4818.0211s
Epoch: 18 cost time: 15.303397417068481
Epoch: 18, Steps: 154 | Train Loss: 1.316 Vali Loss: 2.804 Vali Acc: 0.376 Test Loss: 2.804 Test Acc: 0.376
Validation loss decreased (-0.360881 --> -0.375884).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.6528679
	speed: 0.3906s/iter; left time: 4894.1363s
Epoch: 19 cost time: 16.154919624328613
Epoch: 19, Steps: 154 | Train Loss: 1.330 Vali Loss: 3.480 Vali Acc: 0.172 Test Loss: 3.480 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.9894853
	speed: 0.3804s/iter; left time: 4707.4562s
Epoch: 20 cost time: 15.14889144897461
Epoch: 20, Steps: 154 | Train Loss: 1.270 Vali Loss: 3.370 Vali Acc: 0.086 Test Loss: 3.370 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.4580333
	speed: 0.3939s/iter; left time: 4813.9591s
Epoch: 21 cost time: 14.53122591972351
Epoch: 21, Steps: 154 | Train Loss: 1.259 Vali Loss: 3.540 Vali Acc: 0.086 Test Loss: 3.540 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.4141419
	speed: 0.3859s/iter; left time: 4656.1292s
Epoch: 22 cost time: 13.71009111404419
Epoch: 22, Steps: 154 | Train Loss: 1.208 Vali Loss: 3.295 Vali Acc: 0.189 Test Loss: 3.295 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.8233175
	speed: 0.3238s/iter; left time: 3856.8556s
Epoch: 23 cost time: 14.938621759414673
Epoch: 23, Steps: 154 | Train Loss: 1.206 Vali Loss: 4.224 Vali Acc: 0.085 Test Loss: 4.224 Test Acc: 0.085
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.8009238
	speed: 0.3667s/iter; left time: 4312.5283s
Epoch: 24 cost time: 13.620370149612427
Epoch: 24, Steps: 154 | Train Loss: 1.211 Vali Loss: 4.798 Vali Acc: 0.085 Test Loss: 4.798 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.6155728
	speed: 0.3650s/iter; left time: 4236.4014s
Epoch: 25 cost time: 13.95679521560669
Epoch: 25, Steps: 154 | Train Loss: 1.312 Vali Loss: 4.899 Vali Acc: 0.079 Test Loss: 4.899 Test Acc: 0.079
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.8716714
	speed: 0.3756s/iter; left time: 4300.4371s
Epoch: 26 cost time: 15.263793706893921
Epoch: 26, Steps: 154 | Train Loss: 1.451 Vali Loss: 4.964 Vali Acc: 0.075 Test Loss: 4.964 Test Acc: 0.075
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.8678662
	speed: 0.3713s/iter; left time: 4194.4606s
Epoch: 27 cost time: 14.354864120483398
Epoch: 27, Steps: 154 | Train Loss: 1.197 Vali Loss: 4.827 Vali Acc: 0.099 Test Loss: 4.827 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.7792168
	speed: 0.3319s/iter; left time: 3698.3008s
Epoch: 28 cost time: 14.356078863143921
Epoch: 28, Steps: 154 | Train Loss: 1.253 Vali Loss: 5.083 Vali Acc: 0.094 Test Loss: 5.083 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3759124087591241
model parameter : 669278
model size : 7.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9748752
	speed: 0.1046s/iter; left time: 1599.8158s
Epoch: 1 cost time: 14.906288146972656
Epoch: 1, Steps: 154 | Train Loss: 2.245 Vali Loss: 2.154 Vali Acc: 0.325 Test Loss: 2.154 Test Acc: 0.325
Validation loss decreased (inf --> -0.324796).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2430432
	speed: 0.3397s/iter; left time: 5145.3427s
Epoch: 2 cost time: 12.220337629318237
Epoch: 2, Steps: 154 | Train Loss: 2.068 Vali Loss: 2.237 Vali Acc: 0.324 Test Loss: 2.237 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6585590
	speed: 0.3425s/iter; left time: 5134.9221s
Epoch: 3 cost time: 13.953696727752686
Epoch: 3, Steps: 154 | Train Loss: 1.938 Vali Loss: 2.233 Vali Acc: 0.328 Test Loss: 2.233 Test Acc: 0.328
Validation loss decreased (-0.324796 --> -0.328039).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0555036
	speed: 0.3215s/iter; left time: 4770.6103s
Epoch: 4 cost time: 9.973530054092407
Epoch: 4, Steps: 154 | Train Loss: 1.873 Vali Loss: 2.255 Vali Acc: 0.333 Test Loss: 2.255 Test Acc: 0.333
Validation loss decreased (-0.328039 --> -0.332905).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6413027
	speed: 0.3220s/iter; left time: 4728.9106s
Epoch: 5 cost time: 13.053494930267334
Epoch: 5, Steps: 154 | Train Loss: 1.843 Vali Loss: 2.448 Vali Acc: 0.339 Test Loss: 2.448 Test Acc: 0.339
Validation loss decreased (-0.332905 --> -0.339392).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6961191
	speed: 0.3417s/iter; left time: 4965.2648s
Epoch: 6 cost time: 14.37851357460022
Epoch: 6, Steps: 154 | Train Loss: 1.724 Vali Loss: 2.580 Vali Acc: 0.343 Test Loss: 2.580 Test Acc: 0.343
Validation loss decreased (-0.339392 --> -0.343040).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4782082
	speed: 0.3367s/iter; left time: 4841.1220s
Epoch: 7 cost time: 12.275673866271973
Epoch: 7, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.395 Vali Acc: 0.354 Test Loss: 2.395 Test Acc: 0.354
Validation loss decreased (-0.343040 --> -0.353991).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2945229
	speed: 0.3339s/iter; left time: 4749.4394s
Epoch: 8 cost time: 14.869178056716919
Epoch: 8, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.657 Vali Acc: 0.360 Test Loss: 2.657 Test Acc: 0.360
Validation loss decreased (-0.353991 --> -0.359665).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8292800
	speed: 0.3787s/iter; left time: 5327.3602s
Epoch: 9 cost time: 15.09528112411499
Epoch: 9, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.455 Vali Acc: 0.372 Test Loss: 2.455 Test Acc: 0.372
Validation loss decreased (-0.359665 --> -0.371833).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2236041
	speed: 0.3686s/iter; left time: 5129.7580s
Epoch: 10 cost time: 15.161199808120728
Epoch: 10, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.938 Vali Acc: 0.333 Test Loss: 2.938 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.2416849
	speed: 0.3083s/iter; left time: 4242.5882s
Epoch: 11 cost time: 12.001121282577515
Epoch: 11, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.677 Vali Acc: 0.360 Test Loss: 2.677 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.2001822
	speed: 0.3467s/iter; left time: 4718.1631s
Epoch: 12 cost time: 13.647998809814453
Epoch: 12, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.071 Vali Acc: 0.094 Test Loss: 3.071 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.0840576
	speed: 0.3377s/iter; left time: 4543.2394s
Epoch: 13 cost time: 13.299795866012573
Epoch: 13, Steps: 154 | Train Loss: 1.381 Vali Loss: 3.026 Vali Acc: 0.299 Test Loss: 3.026 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.5449027
	speed: 0.3326s/iter; left time: 4423.7825s
Epoch: 14 cost time: 14.039077043533325
Epoch: 14, Steps: 154 | Train Loss: 1.365 Vali Loss: 3.030 Vali Acc: 0.084 Test Loss: 3.030 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.6681323
	speed: 0.3461s/iter; left time: 4549.7160s
Epoch: 15 cost time: 13.958187103271484
Epoch: 15, Steps: 154 | Train Loss: 1.361 Vali Loss: 3.399 Vali Acc: 0.209 Test Loss: 3.399 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.3129429
	speed: 0.3595s/iter; left time: 4670.4322s
Epoch: 16 cost time: 14.56775164604187
Epoch: 16, Steps: 154 | Train Loss: 1.384 Vali Loss: 3.796 Vali Acc: 0.082 Test Loss: 3.796 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.3450757
	speed: 0.3131s/iter; left time: 4019.8052s
Epoch: 17 cost time: 12.031799077987671
Epoch: 17, Steps: 154 | Train Loss: 1.300 Vali Loss: 3.657 Vali Acc: 0.078 Test Loss: 3.657 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.1610856
	speed: 0.3249s/iter; left time: 4120.8928s
Epoch: 18 cost time: 14.262381792068481
Epoch: 18, Steps: 154 | Train Loss: 1.261 Vali Loss: 2.772 Vali Acc: 0.385 Test Loss: 2.772 Test Acc: 0.385
Validation loss decreased (-0.371833 --> -0.384806).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.1664808
	speed: 0.3476s/iter; left time: 4355.5208s
Epoch: 19 cost time: 14.027887105941772
Epoch: 19, Steps: 154 | Train Loss: 1.622 Vali Loss: 3.468 Vali Acc: 0.201 Test Loss: 3.468 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 2.2214935
	speed: 0.3564s/iter; left time: 4410.4496s
Epoch: 20 cost time: 12.756343841552734
Epoch: 20, Steps: 154 | Train Loss: 1.323 Vali Loss: 3.307 Vali Acc: 0.217 Test Loss: 3.307 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.7671686
	speed: 0.3042s/iter; left time: 3717.7915s
Epoch: 21 cost time: 12.962644577026367
Epoch: 21, Steps: 154 | Train Loss: 1.183 Vali Loss: 3.202 Vali Acc: 0.123 Test Loss: 3.202 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.1649795
	speed: 0.3526s/iter; left time: 4254.7580s
Epoch: 22 cost time: 13.64366364479065
Epoch: 22, Steps: 154 | Train Loss: 1.350 Vali Loss: 3.276 Vali Acc: 0.181 Test Loss: 3.276 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.5461652
	speed: 0.3506s/iter; left time: 4177.0964s
Epoch: 23 cost time: 13.51624083518982
Epoch: 23, Steps: 154 | Train Loss: 1.256 Vali Loss: 3.793 Vali Acc: 0.084 Test Loss: 3.793 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.8014765
	speed: 0.3500s/iter; left time: 4115.7154s
Epoch: 24 cost time: 12.507309913635254
Epoch: 24, Steps: 154 | Train Loss: 1.157 Vali Loss: 3.914 Vali Acc: 0.104 Test Loss: 3.914 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.4008447
	speed: 0.3129s/iter; left time: 3630.7684s
Epoch: 25 cost time: 14.52386212348938
Epoch: 25, Steps: 154 | Train Loss: 1.053 Vali Loss: 4.059 Vali Acc: 0.099 Test Loss: 4.059 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.5986460
	speed: 0.3575s/iter; left time: 4093.8749s
Epoch: 26 cost time: 15.058397054672241
Epoch: 26, Steps: 154 | Train Loss: 1.078 Vali Loss: 4.578 Vali Acc: 0.079 Test Loss: 4.578 Test Acc: 0.079
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.2539346
	speed: 0.3636s/iter; left time: 4107.9372s
Epoch: 27 cost time: 13.148885488510132
Epoch: 27, Steps: 154 | Train Loss: 1.087 Vali Loss: 3.903 Vali Acc: 0.120 Test Loss: 3.903 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 2.6008093
	speed: 0.3135s/iter; left time: 3492.9043s
Epoch: 28 cost time: 11.173474550247192
Epoch: 28, Steps: 154 | Train Loss: 1.129 Vali Loss: 4.335 Vali Acc: 0.109 Test Loss: 4.335 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3848337388483374
model parameter : 669278
model size : 7.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9542015
	speed: 0.1122s/iter; left time: 1716.5562s
Epoch: 1 cost time: 16.115855932235718
Epoch: 1, Steps: 154 | Train Loss: 2.226 Vali Loss: 2.159 Vali Acc: 0.325 Test Loss: 2.159 Test Acc: 0.325
Validation loss decreased (inf --> -0.325201).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2386322
	speed: 0.3643s/iter; left time: 5517.4753s
Epoch: 2 cost time: 14.662036657333374
Epoch: 2, Steps: 154 | Train Loss: 2.065 Vali Loss: 2.234 Vali Acc: 0.324 Test Loss: 2.234 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6368523
	speed: 0.3585s/iter; left time: 5375.6086s
Epoch: 3 cost time: 15.096349716186523
Epoch: 3, Steps: 154 | Train Loss: 1.933 Vali Loss: 2.214 Vali Acc: 0.332 Test Loss: 2.214 Test Acc: 0.332
Validation loss decreased (-0.325201 --> -0.332095).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8935021
	speed: 0.3489s/iter; left time: 5176.7469s
Epoch: 4 cost time: 10.744340658187866
Epoch: 4, Steps: 154 | Train Loss: 1.809 Vali Loss: 2.298 Vali Acc: 0.341 Test Loss: 2.298 Test Acc: 0.341
Validation loss decreased (-0.332095 --> -0.340610).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5188231
	speed: 0.3332s/iter; left time: 4893.2148s
Epoch: 5 cost time: 13.655007123947144
Epoch: 5, Steps: 154 | Train Loss: 1.725 Vali Loss: 2.411 Vali Acc: 0.347 Test Loss: 2.411 Test Acc: 0.347
Validation loss decreased (-0.340610 --> -0.346691).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6937296
	speed: 0.3532s/iter; left time: 5132.6259s
Epoch: 6 cost time: 14.331766605377197
Epoch: 6, Steps: 154 | Train Loss: 1.652 Vali Loss: 2.406 Vali Acc: 0.353 Test Loss: 2.406 Test Acc: 0.353
Validation loss decreased (-0.346691 --> -0.353180).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5561304
	speed: 0.3573s/iter; left time: 5136.8572s
Epoch: 7 cost time: 14.66403865814209
Epoch: 7, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.331 Vali Acc: 0.367 Test Loss: 2.331 Test Acc: 0.367
Validation loss decreased (-0.353180 --> -0.366562).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9665219
	speed: 0.3616s/iter; left time: 5142.9436s
Epoch: 8 cost time: 13.849102973937988
Epoch: 8, Steps: 154 | Train Loss: 1.625 Vali Loss: 2.822 Vali Acc: 0.353 Test Loss: 2.822 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8216664
	speed: 0.3261s/iter; left time: 4587.2104s
Epoch: 9 cost time: 9.943880319595337
Epoch: 9, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.361 Vali Acc: 0.382 Test Loss: 2.361 Test Acc: 0.382
Validation loss decreased (-0.366562 --> -0.381566).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0740782
	speed: 0.3405s/iter; left time: 4738.4324s
Epoch: 10 cost time: 14.061476945877075
Epoch: 10, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.977 Vali Acc: 0.357 Test Loss: 2.977 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3460802
	speed: 0.3455s/iter; left time: 4754.4556s
Epoch: 11 cost time: 13.395705938339233
Epoch: 11, Steps: 154 | Train Loss: 1.404 Vali Loss: 2.630 Vali Acc: 0.354 Test Loss: 2.630 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1401600
	speed: 0.3053s/iter; left time: 4153.7572s
Epoch: 12 cost time: 11.285982847213745
Epoch: 12, Steps: 154 | Train Loss: 1.317 Vali Loss: 2.994 Vali Acc: 0.094 Test Loss: 2.994 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.0713423
	speed: 0.3236s/iter; left time: 4353.8148s
Epoch: 13 cost time: 12.346816062927246
Epoch: 13, Steps: 154 | Train Loss: 1.339 Vali Loss: 3.105 Vali Acc: 0.283 Test Loss: 3.105 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.6673549
	speed: 0.2932s/iter; left time: 3899.1981s
Epoch: 14 cost time: 13.40349268913269
Epoch: 14, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.859 Vali Acc: 0.364 Test Loss: 2.859 Test Acc: 0.364
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.3602179
	speed: 0.3385s/iter; left time: 4449.3181s
Epoch: 15 cost time: 13.616797685623169
Epoch: 15, Steps: 154 | Train Loss: 1.285 Vali Loss: 3.088 Vali Acc: 0.213 Test Loss: 3.088 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.8921478
	speed: 0.3290s/iter; left time: 4273.6043s
Epoch: 16 cost time: 13.17898154258728
Epoch: 16, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.980 Vali Acc: 0.235 Test Loss: 2.980 Test Acc: 0.235
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.1821191
	speed: 0.3339s/iter; left time: 4285.8258s
Epoch: 17 cost time: 13.170971155166626
Epoch: 17, Steps: 154 | Train Loss: 1.433 Vali Loss: 3.074 Vali Acc: 0.357 Test Loss: 3.074 Test Acc: 0.357
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.7716668
	speed: 0.3155s/iter; left time: 4001.6428s
Epoch: 18 cost time: 9.86251425743103
Epoch: 18, Steps: 154 | Train Loss: 1.167 Vali Loss: 2.942 Vali Acc: 0.389 Test Loss: 2.942 Test Acc: 0.389
Validation loss decreased (-0.381566 --> -0.389265).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.1756256
	speed: 0.3162s/iter; left time: 3961.3987s
Epoch: 19 cost time: 13.526866912841797
Epoch: 19, Steps: 154 | Train Loss: 1.206 Vali Loss: 3.573 Vali Acc: 0.211 Test Loss: 3.573 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.8517633
	speed: 0.3288s/iter; left time: 4069.3230s
Epoch: 20 cost time: 12.461809158325195
Epoch: 20, Steps: 154 | Train Loss: 1.161 Vali Loss: 3.288 Vali Acc: 0.223 Test Loss: 3.288 Test Acc: 0.223
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.2616260
	speed: 0.3359s/iter; left time: 4104.8559s
Epoch: 21 cost time: 12.520548105239868
Epoch: 21, Steps: 154 | Train Loss: 1.142 Vali Loss: 4.079 Vali Acc: 0.200 Test Loss: 4.079 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.0628886
	speed: 0.3361s/iter; left time: 4055.9969s
Epoch: 22 cost time: 13.088786125183105
Epoch: 22, Steps: 154 | Train Loss: 1.176 Vali Loss: 3.207 Vali Acc: 0.372 Test Loss: 3.207 Test Acc: 0.372
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.5533274
	speed: 0.3134s/iter; left time: 3733.1062s
Epoch: 23 cost time: 10.717530488967896
Epoch: 23, Steps: 154 | Train Loss: 1.132 Vali Loss: 3.689 Vali Acc: 0.100 Test Loss: 3.689 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.5393516
	speed: 0.3157s/iter; left time: 3712.2499s
Epoch: 24 cost time: 12.958171129226685
Epoch: 24, Steps: 154 | Train Loss: 1.034 Vali Loss: 2.916 Vali Acc: 0.380 Test Loss: 2.916 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 2.7595544
	speed: 0.3228s/iter; left time: 3746.5112s
Epoch: 25 cost time: 12.367880821228027
Epoch: 25, Steps: 154 | Train Loss: 1.193 Vali Loss: 3.128 Vali Acc: 0.377 Test Loss: 3.128 Test Acc: 0.377
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.6916679
	speed: 0.3016s/iter; left time: 3453.4273s
Epoch: 26 cost time: 10.538576126098633
Epoch: 26, Steps: 154 | Train Loss: 1.030 Vali Loss: 3.908 Vali Acc: 0.208 Test Loss: 3.908 Test Acc: 0.208
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.8354853
	speed: 0.3263s/iter; left time: 3685.9750s
Epoch: 27 cost time: 13.068063259124756
Epoch: 27, Steps: 154 | Train Loss: 1.111 Vali Loss: 3.750 Vali Acc: 0.120 Test Loss: 3.750 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.8445637
	speed: 0.3260s/iter; left time: 3632.6475s
Epoch: 28 cost time: 11.3815336227417
Epoch: 28, Steps: 154 | Train Loss: 0.925 Vali Loss: 3.909 Vali Acc: 0.170 Test Loss: 3.909 Test Acc: 0.170
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38929440389294406
model parameter : 669278
model size : 7.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0389128
	speed: 0.1000s/iter; left time: 1529.4598s
Epoch: 1 cost time: 14.047030210494995
Epoch: 1, Steps: 154 | Train Loss: 2.195 Vali Loss: 2.157 Vali Acc: 0.323 Test Loss: 2.157 Test Acc: 0.323
Validation loss decreased (inf --> -0.322768).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2031424
	speed: 0.3112s/iter; left time: 4713.6671s
Epoch: 2 cost time: 10.37540602684021
Epoch: 2, Steps: 154 | Train Loss: 2.024 Vali Loss: 2.348 Vali Acc: 0.324 Test Loss: 2.348 Test Acc: 0.324
Validation loss decreased (-0.322768 --> -0.323983).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6243875
	speed: 0.3021s/iter; left time: 4529.3100s
Epoch: 3 cost time: 11.162750482559204
Epoch: 3, Steps: 154 | Train Loss: 1.903 Vali Loss: 2.355 Vali Acc: 0.339 Test Loss: 2.355 Test Acc: 0.339
Validation loss decreased (-0.323983 --> -0.338581).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6008894
	speed: 0.3028s/iter; left time: 4493.3321s
Epoch: 4 cost time: 11.218750238418579
Epoch: 4, Steps: 154 | Train Loss: 1.761 Vali Loss: 2.770 Vali Acc: 0.341 Test Loss: 2.770 Test Acc: 0.341
Validation loss decreased (-0.338581 --> -0.341010).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3487586
	speed: 0.2991s/iter; left time: 4391.5608s
Epoch: 5 cost time: 10.904459953308105
Epoch: 5, Steps: 154 | Train Loss: 1.654 Vali Loss: 3.017 Vali Acc: 0.350 Test Loss: 3.017 Test Acc: 0.350
Validation loss decreased (-0.341010 --> -0.349929).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5720747
	speed: 0.3168s/iter; left time: 4603.1759s
Epoch: 6 cost time: 11.356275796890259
Epoch: 6, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.649 Vali Acc: 0.349 Test Loss: 2.649 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4728818
	speed: 0.3078s/iter; left time: 4425.0474s
Epoch: 7 cost time: 11.027252674102783
Epoch: 7, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.409 Vali Acc: 0.358 Test Loss: 2.409 Test Acc: 0.358
Validation loss decreased (-0.349929 --> -0.357640).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2220435
	speed: 0.3142s/iter; left time: 4468.4117s
Epoch: 8 cost time: 10.65238356590271
Epoch: 8, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.802 Vali Acc: 0.352 Test Loss: 2.802 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5696648
	speed: 0.3074s/iter; left time: 4324.8744s
Epoch: 9 cost time: 11.490989208221436
Epoch: 9, Steps: 154 | Train Loss: 1.427 Vali Loss: 2.640 Vali Acc: 0.389 Test Loss: 2.640 Test Acc: 0.389
Validation loss decreased (-0.357640 --> -0.388862).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3403389
	speed: 0.3161s/iter; left time: 4398.3898s
Epoch: 10 cost time: 11.271054744720459
Epoch: 10, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.763 Vali Acc: 0.376 Test Loss: 2.763 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0386705
	speed: 0.3053s/iter; left time: 4200.6028s
Epoch: 11 cost time: 11.130592823028564
Epoch: 11, Steps: 154 | Train Loss: 1.356 Vali Loss: 2.676 Vali Acc: 0.377 Test Loss: 2.676 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.0207858
	speed: 0.3247s/iter; left time: 4418.4139s
Epoch: 12 cost time: 10.98330807685852
Epoch: 12, Steps: 154 | Train Loss: 1.269 Vali Loss: 2.682 Vali Acc: 0.314 Test Loss: 2.682 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.7215672
	speed: 0.3201s/iter; left time: 4305.7447s
Epoch: 13 cost time: 11.676064729690552
Epoch: 13, Steps: 154 | Train Loss: 1.364 Vali Loss: 2.543 Vali Acc: 0.387 Test Loss: 2.543 Test Acc: 0.387
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.8708308
	speed: 0.3247s/iter; left time: 4318.7282s
Epoch: 14 cost time: 10.983536005020142
Epoch: 14, Steps: 154 | Train Loss: 1.295 Vali Loss: 2.536 Vali Acc: 0.371 Test Loss: 2.536 Test Acc: 0.371
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.1838706
	speed: 0.3048s/iter; left time: 4007.2151s
Epoch: 15 cost time: 11.36460828781128
Epoch: 15, Steps: 154 | Train Loss: 1.286 Vali Loss: 2.655 Vali Acc: 0.385 Test Loss: 2.655 Test Acc: 0.385
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.6971244
	speed: 0.3244s/iter; left time: 4214.1858s
Epoch: 16 cost time: 11.04662013053894
Epoch: 16, Steps: 154 | Train Loss: 1.298 Vali Loss: 2.833 Vali Acc: 0.204 Test Loss: 2.833 Test Acc: 0.204
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.0305057
	speed: 0.3016s/iter; left time: 3871.7936s
Epoch: 17 cost time: 10.418959617614746
Epoch: 17, Steps: 154 | Train Loss: 1.170 Vali Loss: 3.171 Vali Acc: 0.331 Test Loss: 3.171 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.9781905
	speed: 0.3052s/iter; left time: 3870.5009s
Epoch: 18 cost time: 10.730412006378174
Epoch: 18, Steps: 154 | Train Loss: 1.128 Vali Loss: 3.063 Vali Acc: 0.399 Test Loss: 3.063 Test Acc: 0.399
Validation loss decreased (-0.388862 --> -0.399402).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.4129068
	speed: 0.3021s/iter; left time: 3785.5653s
Epoch: 19 cost time: 11.489524364471436
Epoch: 19, Steps: 154 | Train Loss: 1.158 Vali Loss: 3.066 Vali Acc: 0.252 Test Loss: 3.066 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.8376588
	speed: 0.3036s/iter; left time: 3757.4546s
Epoch: 20 cost time: 10.955414056777954
Epoch: 20, Steps: 154 | Train Loss: 1.117 Vali Loss: 2.793 Vali Acc: 0.385 Test Loss: 2.793 Test Acc: 0.385
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.6147316
	speed: 0.3121s/iter; left time: 3813.6372s
Epoch: 21 cost time: 10.660073280334473
Epoch: 21, Steps: 154 | Train Loss: 1.072 Vali Loss: 2.906 Vali Acc: 0.239 Test Loss: 2.906 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.9831854
	speed: 0.3239s/iter; left time: 3907.9560s
Epoch: 22 cost time: 11.269423961639404
Epoch: 22, Steps: 154 | Train Loss: 1.036 Vali Loss: 2.978 Vali Acc: 0.385 Test Loss: 2.978 Test Acc: 0.385
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.5664697
	speed: 0.3119s/iter; left time: 3715.6268s
Epoch: 23 cost time: 11.505606651306152
Epoch: 23, Steps: 154 | Train Loss: 0.989 Vali Loss: 3.486 Vali Acc: 0.133 Test Loss: 3.486 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.9551026
	speed: 0.3330s/iter; left time: 3915.9641s
Epoch: 24 cost time: 12.331947565078735
Epoch: 24, Steps: 154 | Train Loss: 0.962 Vali Loss: 3.685 Vali Acc: 0.171 Test Loss: 3.685 Test Acc: 0.171
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.5237350
	speed: 0.3669s/iter; left time: 4258.2996s
Epoch: 25 cost time: 15.106103658676147
Epoch: 25, Steps: 154 | Train Loss: 1.218 Vali Loss: 3.072 Vali Acc: 0.382 Test Loss: 3.072 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.6194816
	speed: 0.4325s/iter; left time: 4951.9890s
Epoch: 26 cost time: 15.624055862426758
Epoch: 26, Steps: 154 | Train Loss: 0.972 Vali Loss: 3.773 Vali Acc: 0.109 Test Loss: 3.773 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.7095450
	speed: 0.4540s/iter; left time: 5128.4368s
Epoch: 27 cost time: 15.96680498123169
Epoch: 27, Steps: 154 | Train Loss: 1.049 Vali Loss: 3.506 Vali Acc: 0.240 Test Loss: 3.506 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.6226531
	speed: 0.4167s/iter; left time: 4642.9996s
Epoch: 28 cost time: 15.140239953994751
Epoch: 28, Steps: 154 | Train Loss: 0.959 Vali Loss: 3.294 Vali Acc: 0.388 Test Loss: 3.294 Test Acc: 0.388
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39943227899432276
model parameter : 669278
model size : 7.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1479647
	speed: 0.1057s/iter; left time: 1617.1164s
Epoch: 1 cost time: 14.719064950942993
Epoch: 1, Steps: 154 | Train Loss: 2.251 Vali Loss: 2.162 Vali Acc: 0.324 Test Loss: 2.162 Test Acc: 0.324
Validation loss decreased (inf --> -0.323579).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8625782
	speed: 0.3012s/iter; left time: 4561.5444s
Epoch: 2 cost time: 12.589226245880127
Epoch: 2, Steps: 154 | Train Loss: 2.065 Vali Loss: 2.197 Vali Acc: 0.326 Test Loss: 2.197 Test Acc: 0.326
Validation loss decreased (-0.323579 --> -0.325607).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0573010
	speed: 0.3254s/iter; left time: 4879.4417s
Epoch: 3 cost time: 11.103037595748901
Epoch: 3, Steps: 154 | Train Loss: 1.979 Vali Loss: 2.283 Vali Acc: 0.326 Test Loss: 2.283 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9803714
	speed: 0.3161s/iter; left time: 4690.6677s
Epoch: 4 cost time: 11.733078002929688
Epoch: 4, Steps: 154 | Train Loss: 1.934 Vali Loss: 2.321 Vali Acc: 0.329 Test Loss: 2.321 Test Acc: 0.329
Validation loss decreased (-0.325607 --> -0.329255).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6379644
	speed: 0.3076s/iter; left time: 4517.0809s
Epoch: 5 cost time: 12.900363445281982
Epoch: 5, Steps: 154 | Train Loss: 1.860 Vali Loss: 2.194 Vali Acc: 0.335 Test Loss: 2.194 Test Acc: 0.335
Validation loss decreased (-0.329255 --> -0.335339).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6116073
	speed: 0.2905s/iter; left time: 4221.2467s
Epoch: 6 cost time: 11.86475133895874
Epoch: 6, Steps: 154 | Train Loss: 1.771 Vali Loss: 2.414 Vali Acc: 0.337 Test Loss: 2.414 Test Acc: 0.337
Validation loss decreased (-0.335339 --> -0.337364).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0098751
	speed: 0.3251s/iter; left time: 4674.3982s
Epoch: 7 cost time: 12.976629495620728
Epoch: 7, Steps: 154 | Train Loss: 1.728 Vali Loss: 2.438 Vali Acc: 0.341 Test Loss: 2.438 Test Acc: 0.341
Validation loss decreased (-0.337364 --> -0.341014).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4108360
	speed: 0.3360s/iter; left time: 4778.2958s
Epoch: 8 cost time: 14.007514715194702
Epoch: 8, Steps: 154 | Train Loss: 1.717 Vali Loss: 2.496 Vali Acc: 0.359 Test Loss: 2.496 Test Acc: 0.359
Validation loss decreased (-0.341014 --> -0.359261).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.2207240
	speed: 0.3014s/iter; left time: 4239.7343s
Epoch: 9 cost time: 10.738112926483154
Epoch: 9, Steps: 154 | Train Loss: 1.630 Vali Loss: 2.557 Vali Acc: 0.358 Test Loss: 2.557 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.0848527
	speed: 0.3358s/iter; left time: 4672.0122s
Epoch: 10 cost time: 12.719846487045288
Epoch: 10, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.846 Vali Acc: 0.236 Test Loss: 2.846 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.8224859
	speed: 0.3332s/iter; left time: 4584.6889s
Epoch: 11 cost time: 13.184263467788696
Epoch: 11, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.594 Vali Acc: 0.363 Test Loss: 2.594 Test Acc: 0.363
Validation loss decreased (-0.359261 --> -0.362504).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4376748
	speed: 0.3290s/iter; left time: 4476.0955s
Epoch: 12 cost time: 12.465336084365845
Epoch: 12, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.847 Vali Acc: 0.127 Test Loss: 2.847 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1282312
	speed: 0.2688s/iter; left time: 3615.8523s
Epoch: 13 cost time: 8.900247812271118
Epoch: 13, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.843 Vali Acc: 0.361 Test Loss: 2.843 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.6870351
	speed: 0.3176s/iter; left time: 4223.9658s
Epoch: 14 cost time: 11.999832391738892
Epoch: 14, Steps: 154 | Train Loss: 1.472 Vali Loss: 3.114 Vali Acc: 0.079 Test Loss: 3.114 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.0984201
	speed: 0.3224s/iter; left time: 4237.3917s
Epoch: 15 cost time: 13.006322622299194
Epoch: 15, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.849 Vali Acc: 0.208 Test Loss: 2.849 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.7418286
	speed: 0.3140s/iter; left time: 4079.0264s
Epoch: 16 cost time: 13.070211410522461
Epoch: 16, Steps: 154 | Train Loss: 1.411 Vali Loss: 2.885 Vali Acc: 0.369 Test Loss: 2.885 Test Acc: 0.369
Validation loss decreased (-0.362504 --> -0.369395).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.1295135
	speed: 0.3210s/iter; left time: 4120.8048s
Epoch: 17 cost time: 12.640138864517212
Epoch: 17, Steps: 154 | Train Loss: 1.370 Vali Loss: 3.210 Vali Acc: 0.079 Test Loss: 3.210 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.8260188
	speed: 0.2912s/iter; left time: 3693.4339s
Epoch: 18 cost time: 12.089847326278687
Epoch: 18, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.868 Vali Acc: 0.373 Test Loss: 2.868 Test Acc: 0.373
Validation loss decreased (-0.369395 --> -0.373045).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.0001781
	speed: 0.3152s/iter; left time: 3949.2324s
Epoch: 19 cost time: 12.876847267150879
Epoch: 19, Steps: 154 | Train Loss: 1.402 Vali Loss: 3.603 Vali Acc: 0.082 Test Loss: 3.603 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.3249068
	speed: 0.3054s/iter; left time: 3779.4273s
Epoch: 20 cost time: 10.270076990127563
Epoch: 20, Steps: 154 | Train Loss: 1.463 Vali Loss: 3.570 Vali Acc: 0.082 Test Loss: 3.570 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.0135467
	speed: 0.3244s/iter; left time: 3964.9064s
Epoch: 21 cost time: 13.011292219161987
Epoch: 21, Steps: 154 | Train Loss: 1.377 Vali Loss: 3.232 Vali Acc: 0.179 Test Loss: 3.232 Test Acc: 0.179
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.5307088
	speed: 0.3421s/iter; left time: 4128.2597s
Epoch: 22 cost time: 13.538921117782593
Epoch: 22, Steps: 154 | Train Loss: 1.279 Vali Loss: 3.445 Vali Acc: 0.080 Test Loss: 3.445 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.0000347
	speed: 0.3245s/iter; left time: 3865.9745s
Epoch: 23 cost time: 12.203592777252197
Epoch: 23, Steps: 154 | Train Loss: 1.326 Vali Loss: 3.609 Vali Acc: 0.094 Test Loss: 3.609 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.2138158
	speed: 0.3021s/iter; left time: 3552.0695s
Epoch: 24 cost time: 12.554611444473267
Epoch: 24, Steps: 154 | Train Loss: 1.269 Vali Loss: 4.162 Vali Acc: 0.088 Test Loss: 4.162 Test Acc: 0.088
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.6268374
	speed: 0.3306s/iter; left time: 3837.0599s
Epoch: 25 cost time: 12.53778338432312
Epoch: 25, Steps: 154 | Train Loss: 1.197 Vali Loss: 3.976 Vali Acc: 0.095 Test Loss: 3.976 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.8267213
	speed: 0.3150s/iter; left time: 3607.6202s
Epoch: 26 cost time: 10.283041000366211
Epoch: 26, Steps: 154 | Train Loss: 1.192 Vali Loss: 3.340 Vali Acc: 0.219 Test Loss: 3.340 Test Acc: 0.219
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.6026306
	speed: 0.2910s/iter; left time: 3287.9647s
Epoch: 27 cost time: 12.207963943481445
Epoch: 27, Steps: 154 | Train Loss: 1.163 Vali Loss: 4.540 Vali Acc: 0.079 Test Loss: 4.540 Test Acc: 0.079
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.5427235
	speed: 0.3038s/iter; left time: 3385.7183s
Epoch: 28 cost time: 12.84656286239624
Epoch: 28, Steps: 154 | Train Loss: 1.278 Vali Loss: 3.644 Vali Acc: 0.112 Test Loss: 3.644 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37307380373073806
model parameter : 538206
model size : 6.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1685171
	speed: 0.0873s/iter; left time: 1335.5399s
Epoch: 1 cost time: 12.576846599578857
Epoch: 1, Steps: 154 | Train Loss: 2.239 Vali Loss: 2.170 Vali Acc: 0.323 Test Loss: 2.170 Test Acc: 0.323
Validation loss decreased (inf --> -0.323174).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7900605
	speed: 0.2973s/iter; left time: 4503.6475s
Epoch: 2 cost time: 11.143644571304321
Epoch: 2, Steps: 154 | Train Loss: 2.051 Vali Loss: 2.196 Vali Acc: 0.325 Test Loss: 2.196 Test Acc: 0.325
Validation loss decreased (-0.323174 --> -0.325201).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8019130
	speed: 0.3309s/iter; left time: 4960.5972s
Epoch: 3 cost time: 11.904423713684082
Epoch: 3, Steps: 154 | Train Loss: 1.981 Vali Loss: 2.276 Vali Acc: 0.327 Test Loss: 2.276 Test Acc: 0.327
Validation loss decreased (-0.325201 --> -0.326822).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0108054
	speed: 0.3001s/iter; left time: 4452.9460s
Epoch: 4 cost time: 11.678980350494385
Epoch: 4, Steps: 154 | Train Loss: 1.947 Vali Loss: 2.370 Vali Acc: 0.328 Test Loss: 2.370 Test Acc: 0.328
Validation loss decreased (-0.326822 --> -0.328443).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6588362
	speed: 0.2900s/iter; left time: 4258.4705s
Epoch: 5 cost time: 12.554126977920532
Epoch: 5, Steps: 154 | Train Loss: 1.846 Vali Loss: 2.177 Vali Acc: 0.342 Test Loss: 2.177 Test Acc: 0.342
Validation loss decreased (-0.328443 --> -0.341827).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7013460
	speed: 0.3286s/iter; left time: 4774.4339s
Epoch: 6 cost time: 12.58662462234497
Epoch: 6, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.418 Vali Acc: 0.341 Test Loss: 2.418 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8205317
	speed: 0.3324s/iter; left time: 4778.7666s
Epoch: 7 cost time: 13.46213150024414
Epoch: 7, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.441 Vali Acc: 0.350 Test Loss: 2.441 Test Acc: 0.350
Validation loss decreased (-0.341827 --> -0.349530).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5214857
	speed: 0.3303s/iter; left time: 4697.4266s
Epoch: 8 cost time: 13.207748413085938
Epoch: 8, Steps: 154 | Train Loss: 1.724 Vali Loss: 2.427 Vali Acc: 0.362 Test Loss: 2.427 Test Acc: 0.362
Validation loss decreased (-0.349530 --> -0.362101).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3174850
	speed: 0.3084s/iter; left time: 4339.3170s
Epoch: 9 cost time: 12.664997816085815
Epoch: 9, Steps: 154 | Train Loss: 1.650 Vali Loss: 2.588 Vali Acc: 0.354 Test Loss: 2.588 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.9211284
	speed: 0.3063s/iter; left time: 4262.2171s
Epoch: 10 cost time: 10.974897146224976
Epoch: 10, Steps: 154 | Train Loss: 1.552 Vali Loss: 2.615 Vali Acc: 0.357 Test Loss: 2.615 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5821326
	speed: 0.3163s/iter; left time: 4352.7806s
Epoch: 11 cost time: 12.494277477264404
Epoch: 11, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.647 Vali Acc: 0.368 Test Loss: 2.647 Test Acc: 0.368
Validation loss decreased (-0.362101 --> -0.368181).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6163176
	speed: 0.3219s/iter; left time: 4379.4511s
Epoch: 12 cost time: 12.77211046218872
Epoch: 12, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.733 Vali Acc: 0.362 Test Loss: 2.733 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.8195707
	speed: 0.2993s/iter; left time: 4025.8210s
Epoch: 13 cost time: 9.586364030838013
Epoch: 13, Steps: 154 | Train Loss: 1.578 Vali Loss: 3.032 Vali Acc: 0.365 Test Loss: 3.032 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2511790
	speed: 0.3106s/iter; left time: 4131.1498s
Epoch: 14 cost time: 11.20556116104126
Epoch: 14, Steps: 154 | Train Loss: 1.647 Vali Loss: 3.095 Vali Acc: 0.149 Test Loss: 3.095 Test Acc: 0.149
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.0260391
	speed: 0.3113s/iter; left time: 4091.7367s
Epoch: 15 cost time: 12.329853296279907
Epoch: 15, Steps: 154 | Train Loss: 1.415 Vali Loss: 2.876 Vali Acc: 0.213 Test Loss: 2.876 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.8050408
	speed: 0.2900s/iter; left time: 3767.2905s
Epoch: 16 cost time: 10.812873840332031
Epoch: 16, Steps: 154 | Train Loss: 1.390 Vali Loss: 3.067 Vali Acc: 0.369 Test Loss: 3.067 Test Acc: 0.369
Validation loss decreased (-0.368181 --> -0.369393).  Saving model ...
	iters: 100, epoch: 17 | loss: 3.0743353
	speed: 0.2896s/iter; left time: 3717.8580s
Epoch: 17 cost time: 11.750672340393066
Epoch: 17, Steps: 154 | Train Loss: 1.616 Vali Loss: 3.017 Vali Acc: 0.129 Test Loss: 3.017 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.4997078
	speed: 0.2798s/iter; left time: 3548.4557s
Epoch: 18 cost time: 11.007469654083252
Epoch: 18, Steps: 154 | Train Loss: 1.351 Vali Loss: 3.193 Vali Acc: 0.358 Test Loss: 3.193 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.8897212
	speed: 0.2974s/iter; left time: 3725.6855s
Epoch: 19 cost time: 10.507831811904907
Epoch: 19, Steps: 154 | Train Loss: 1.284 Vali Loss: 3.467 Vali Acc: 0.090 Test Loss: 3.467 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.6755341
	speed: 0.3152s/iter; left time: 3901.1227s
Epoch: 20 cost time: 12.525968074798584
Epoch: 20, Steps: 154 | Train Loss: 1.251 Vali Loss: 3.558 Vali Acc: 0.079 Test Loss: 3.558 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.0342766
	speed: 0.2979s/iter; left time: 3640.7040s
Epoch: 21 cost time: 9.946228504180908
Epoch: 21, Steps: 154 | Train Loss: 1.430 Vali Loss: 3.148 Vali Acc: 0.099 Test Loss: 3.148 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.9089550
	speed: 0.3084s/iter; left time: 3720.9211s
Epoch: 22 cost time: 12.002892017364502
Epoch: 22, Steps: 154 | Train Loss: 1.337 Vali Loss: 3.603 Vali Acc: 0.084 Test Loss: 3.603 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.8983710
	speed: 0.3114s/iter; left time: 3709.2640s
Epoch: 23 cost time: 12.756383180618286
Epoch: 23, Steps: 154 | Train Loss: 1.511 Vali Loss: 3.502 Vali Acc: 0.120 Test Loss: 3.502 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.1482153
	speed: 0.3041s/iter; left time: 3575.3252s
Epoch: 24 cost time: 12.400173425674438
Epoch: 24, Steps: 154 | Train Loss: 1.193 Vali Loss: 4.175 Vali Acc: 0.096 Test Loss: 4.175 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.5251893
	speed: 0.2969s/iter; left time: 3445.9280s
Epoch: 25 cost time: 10.955044746398926
Epoch: 25, Steps: 154 | Train Loss: 1.285 Vali Loss: 4.572 Vali Acc: 0.085 Test Loss: 4.572 Test Acc: 0.085
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.9476753
	speed: 0.3019s/iter; left time: 3456.7145s
Epoch: 26 cost time: 11.497212409973145
Epoch: 26, Steps: 154 | Train Loss: 1.243 Vali Loss: 3.950 Vali Acc: 0.110 Test Loss: 3.950 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36942416869424166
model parameter : 538206
model size : 6.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1313608
	speed: 0.0934s/iter; left time: 1428.5663s
Epoch: 1 cost time: 13.416678667068481
Epoch: 1, Steps: 154 | Train Loss: 2.225 Vali Loss: 2.180 Vali Acc: 0.323 Test Loss: 2.180 Test Acc: 0.323
Validation loss decreased (inf --> -0.323174).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7933969
	speed: 0.3130s/iter; left time: 4741.3406s
Epoch: 2 cost time: 11.997322082519531
Epoch: 2, Steps: 154 | Train Loss: 2.059 Vali Loss: 2.195 Vali Acc: 0.326 Test Loss: 2.195 Test Acc: 0.326
Validation loss decreased (-0.323174 --> -0.326418).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6491101
	speed: 0.3157s/iter; left time: 4732.7784s
Epoch: 3 cost time: 12.581480503082275
Epoch: 3, Steps: 154 | Train Loss: 1.951 Vali Loss: 2.239 Vali Acc: 0.328 Test Loss: 2.239 Test Acc: 0.328
Validation loss decreased (-0.326418 --> -0.328445).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0245950
	speed: 0.2952s/iter; left time: 4380.1144s
Epoch: 4 cost time: 9.755252599716187
Epoch: 4, Steps: 154 | Train Loss: 1.883 Vali Loss: 2.422 Vali Acc: 0.333 Test Loss: 2.422 Test Acc: 0.333
Validation loss decreased (-0.328445 --> -0.332904).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5911474
	speed: 0.2683s/iter; left time: 3939.9927s
Epoch: 5 cost time: 10.762939691543579
Epoch: 5, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.244 Vali Acc: 0.341 Test Loss: 2.244 Test Acc: 0.341
Validation loss decreased (-0.332904 --> -0.341421).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6552895
	speed: 0.2692s/iter; left time: 3912.0997s
Epoch: 6 cost time: 9.39562726020813
Epoch: 6, Steps: 154 | Train Loss: 1.715 Vali Loss: 2.381 Vali Acc: 0.346 Test Loss: 2.381 Test Acc: 0.346
Validation loss decreased (-0.341421 --> -0.345880).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7492230
	speed: 0.2780s/iter; left time: 3997.0962s
Epoch: 7 cost time: 11.479655504226685
Epoch: 7, Steps: 154 | Train Loss: 1.663 Vali Loss: 2.442 Vali Acc: 0.354 Test Loss: 2.442 Test Acc: 0.354
Validation loss decreased (-0.345880 --> -0.354396).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5669490
	speed: 0.2915s/iter; left time: 4146.6161s
Epoch: 8 cost time: 12.078271627426147
Epoch: 8, Steps: 154 | Train Loss: 1.658 Vali Loss: 2.363 Vali Acc: 0.367 Test Loss: 2.363 Test Acc: 0.367
Validation loss decreased (-0.354396 --> -0.367373).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4990284
	speed: 0.2852s/iter; left time: 4012.3383s
Epoch: 9 cost time: 9.880269527435303
Epoch: 9, Steps: 154 | Train Loss: 1.564 Vali Loss: 2.425 Vali Acc: 0.366 Test Loss: 2.425 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.0004921
	speed: 0.2879s/iter; left time: 4005.5956s
Epoch: 10 cost time: 11.117448806762695
Epoch: 10, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.585 Vali Acc: 0.352 Test Loss: 2.585 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4129431
	speed: 0.3021s/iter; left time: 4157.8391s
Epoch: 11 cost time: 11.5995774269104
Epoch: 11, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.521 Vali Acc: 0.369 Test Loss: 2.521 Test Acc: 0.369
Validation loss decreased (-0.367373 --> -0.369399).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3242986
	speed: 0.2887s/iter; left time: 3928.8780s
Epoch: 12 cost time: 10.176203489303589
Epoch: 12, Steps: 154 | Train Loss: 1.448 Vali Loss: 2.520 Vali Acc: 0.227 Test Loss: 2.520 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5902188
	speed: 0.2822s/iter; left time: 3796.7689s
Epoch: 13 cost time: 11.114848136901855
Epoch: 13, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.479 Vali Acc: 0.377 Test Loss: 2.479 Test Acc: 0.377
Validation loss decreased (-0.369399 --> -0.377104).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4400940
	speed: 0.2964s/iter; left time: 3941.2376s
Epoch: 14 cost time: 10.389716148376465
Epoch: 14, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.668 Vali Acc: 0.366 Test Loss: 2.668 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9733178
	speed: 0.2802s/iter; left time: 3683.8534s
Epoch: 15 cost time: 11.045002460479736
Epoch: 15, Steps: 154 | Train Loss: 1.333 Vali Loss: 2.832 Vali Acc: 0.342 Test Loss: 2.832 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.4247661
	speed: 0.3005s/iter; left time: 3903.2656s
Epoch: 16 cost time: 11.849703311920166
Epoch: 16, Steps: 154 | Train Loss: 1.397 Vali Loss: 2.681 Vali Acc: 0.390 Test Loss: 2.681 Test Acc: 0.390
Validation loss decreased (-0.377104 --> -0.389673).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.2996765
	speed: 0.2775s/iter; left time: 3562.0035s
Epoch: 17 cost time: 11.187409400939941
Epoch: 17, Steps: 154 | Train Loss: 1.256 Vali Loss: 3.280 Vali Acc: 0.094 Test Loss: 3.280 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.6854310
	speed: 0.2396s/iter; left time: 3038.9455s
Epoch: 18 cost time: 8.592017889022827
Epoch: 18, Steps: 154 | Train Loss: 1.210 Vali Loss: 2.837 Vali Acc: 0.373 Test Loss: 2.837 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.9927365
	speed: 0.2833s/iter; left time: 3549.0060s
Epoch: 19 cost time: 11.044137716293335
Epoch: 19, Steps: 154 | Train Loss: 1.215 Vali Loss: 3.157 Vali Acc: 0.110 Test Loss: 3.157 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.5383968
	speed: 0.2919s/iter; left time: 3612.7987s
Epoch: 20 cost time: 12.017341136932373
Epoch: 20, Steps: 154 | Train Loss: 1.339 Vali Loss: 3.513 Vali Acc: 0.084 Test Loss: 3.513 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.8743168
	speed: 0.2735s/iter; left time: 3342.4492s
Epoch: 21 cost time: 9.841962099075317
Epoch: 21, Steps: 154 | Train Loss: 1.240 Vali Loss: 3.057 Vali Acc: 0.346 Test Loss: 3.057 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.8963664
	speed: 0.2995s/iter; left time: 3614.2832s
Epoch: 22 cost time: 11.494651317596436
Epoch: 22, Steps: 154 | Train Loss: 1.312 Vali Loss: 3.473 Vali Acc: 0.133 Test Loss: 3.473 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.7225562
	speed: 0.3036s/iter; left time: 3616.5698s
Epoch: 23 cost time: 11.01057243347168
Epoch: 23, Steps: 154 | Train Loss: 1.230 Vali Loss: 3.227 Vali Acc: 0.131 Test Loss: 3.227 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.3017972
	speed: 0.3059s/iter; left time: 3596.9396s
Epoch: 24 cost time: 10.563615322113037
Epoch: 24, Steps: 154 | Train Loss: 1.127 Vali Loss: 3.681 Vali Acc: 0.144 Test Loss: 3.681 Test Acc: 0.144
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.5237840
	speed: 0.2760s/iter; left time: 3203.5033s
Epoch: 25 cost time: 11.516362190246582
Epoch: 25, Steps: 154 | Train Loss: 1.172 Vali Loss: 3.632 Vali Acc: 0.122 Test Loss: 3.632 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.8153927
	speed: 0.2925s/iter; left time: 3349.4828s
Epoch: 26 cost time: 11.184953927993774
Epoch: 26, Steps: 154 | Train Loss: 1.080 Vali Loss: 3.435 Vali Acc: 0.114 Test Loss: 3.435 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3896999188969992
model parameter : 538206
model size : 6.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1257679
	speed: 0.0849s/iter; left time: 1299.2999s
Epoch: 1 cost time: 12.170139789581299
Epoch: 1, Steps: 154 | Train Loss: 2.194 Vali Loss: 2.201 Vali Acc: 0.323 Test Loss: 2.201 Test Acc: 0.323
Validation loss decreased (inf --> -0.323173).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4822738
	speed: 0.2750s/iter; left time: 4165.0422s
Epoch: 2 cost time: 10.21638798713684
Epoch: 2, Steps: 154 | Train Loss: 2.032 Vali Loss: 2.209 Vali Acc: 0.328 Test Loss: 2.209 Test Acc: 0.328
Validation loss decreased (-0.323173 --> -0.328040).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3489431
	speed: 0.2761s/iter; left time: 4139.8770s
Epoch: 3 cost time: 10.275397300720215
Epoch: 3, Steps: 154 | Train Loss: 1.960 Vali Loss: 2.264 Vali Acc: 0.338 Test Loss: 2.264 Test Acc: 0.338
Validation loss decreased (-0.328040 --> -0.337771).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9017323
	speed: 0.2617s/iter; left time: 3883.2000s
Epoch: 4 cost time: 10.034087419509888
Epoch: 4, Steps: 154 | Train Loss: 1.847 Vali Loss: 2.510 Vali Acc: 0.339 Test Loss: 2.510 Test Acc: 0.339
Validation loss decreased (-0.337771 --> -0.338580).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8150171
	speed: 0.2765s/iter; left time: 4059.9571s
Epoch: 5 cost time: 10.926239967346191
Epoch: 5, Steps: 154 | Train Loss: 1.752 Vali Loss: 2.312 Vali Acc: 0.348 Test Loss: 2.312 Test Acc: 0.348
Validation loss decreased (-0.338580 --> -0.348314).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5821993
	speed: 0.3012s/iter; left time: 4376.3439s
Epoch: 6 cost time: 11.062446117401123
Epoch: 6, Steps: 154 | Train Loss: 1.653 Vali Loss: 2.533 Vali Acc: 0.353 Test Loss: 2.533 Test Acc: 0.353
Validation loss decreased (-0.348314 --> -0.352773).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7119498
	speed: 0.2734s/iter; left time: 3930.5142s
Epoch: 7 cost time: 10.743326902389526
Epoch: 7, Steps: 154 | Train Loss: 1.554 Vali Loss: 2.504 Vali Acc: 0.358 Test Loss: 2.504 Test Acc: 0.358
Validation loss decreased (-0.352773 --> -0.358450).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4813379
	speed: 0.3025s/iter; left time: 4302.6327s
Epoch: 8 cost time: 11.872795104980469
Epoch: 8, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.385 Vali Acc: 0.362 Test Loss: 2.385 Test Acc: 0.362
Validation loss decreased (-0.358450 --> -0.362101).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6690316
	speed: 0.3047s/iter; left time: 4287.0989s
Epoch: 9 cost time: 11.107320070266724
Epoch: 9, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.588 Vali Acc: 0.368 Test Loss: 2.588 Test Acc: 0.368
Validation loss decreased (-0.362101 --> -0.368182).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8769649
	speed: 0.2781s/iter; left time: 3870.0099s
Epoch: 10 cost time: 11.723063945770264
Epoch: 10, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.530 Vali Acc: 0.378 Test Loss: 2.530 Test Acc: 0.378
Validation loss decreased (-0.368182 --> -0.377915).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1826640
	speed: 0.2958s/iter; left time: 4070.4930s
Epoch: 11 cost time: 11.30239987373352
Epoch: 11, Steps: 154 | Train Loss: 1.404 Vali Loss: 2.434 Vali Acc: 0.381 Test Loss: 2.434 Test Acc: 0.381
Validation loss decreased (-0.377915 --> -0.380754).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2554220
	speed: 0.2736s/iter; left time: 3722.2692s
Epoch: 12 cost time: 10.490103960037231
Epoch: 12, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.955 Vali Acc: 0.213 Test Loss: 2.955 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.1141729
	speed: 0.2922s/iter; left time: 3931.0740s
Epoch: 13 cost time: 11.693936586380005
Epoch: 13, Steps: 154 | Train Loss: 1.322 Vali Loss: 2.820 Vali Acc: 0.378 Test Loss: 2.820 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.1394979
	speed: 0.2696s/iter; left time: 3585.1531s
Epoch: 14 cost time: 8.937154054641724
Epoch: 14, Steps: 154 | Train Loss: 1.233 Vali Loss: 2.823 Vali Acc: 0.222 Test Loss: 2.823 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.1326408
	speed: 0.2694s/iter; left time: 3541.1583s
Epoch: 15 cost time: 11.399049282073975
Epoch: 15, Steps: 154 | Train Loss: 1.270 Vali Loss: 2.983 Vali Acc: 0.373 Test Loss: 2.983 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.7060215
	speed: 0.2917s/iter; left time: 3789.0199s
Epoch: 16 cost time: 11.426980257034302
Epoch: 16, Steps: 154 | Train Loss: 1.272 Vali Loss: 3.191 Vali Acc: 0.329 Test Loss: 3.191 Test Acc: 0.329
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.9779201
	speed: 0.2725s/iter; left time: 3497.5750s
Epoch: 17 cost time: 10.451904535293579
Epoch: 17, Steps: 154 | Train Loss: 1.163 Vali Loss: 3.037 Vali Acc: 0.212 Test Loss: 3.037 Test Acc: 0.212
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.0628787
	speed: 0.3018s/iter; left time: 3827.8145s
Epoch: 18 cost time: 11.868785381317139
Epoch: 18, Steps: 154 | Train Loss: 1.151 Vali Loss: 3.204 Vali Acc: 0.371 Test Loss: 3.204 Test Acc: 0.371
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.6872818
	speed: 0.3046s/iter; left time: 3816.4628s
Epoch: 19 cost time: 11.332181930541992
Epoch: 19, Steps: 154 | Train Loss: 1.196 Vali Loss: 3.285 Vali Acc: 0.111 Test Loss: 3.285 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.4234865
	speed: 0.2581s/iter; left time: 3194.0076s
Epoch: 20 cost time: 10.28952670097351
Epoch: 20, Steps: 154 | Train Loss: 1.153 Vali Loss: 3.773 Vali Acc: 0.114 Test Loss: 3.773 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.0904996
	speed: 0.3134s/iter; left time: 3830.6142s
Epoch: 21 cost time: 11.337602853775024
Epoch: 21, Steps: 154 | Train Loss: 1.169 Vali Loss: 3.184 Vali Acc: 0.375 Test Loss: 3.184 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38077858880778587
model parameter : 538206
model size : 6.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3135867
	speed: 0.0818s/iter; left time: 1250.8717s
Epoch: 1 cost time: 11.757249593734741
Epoch: 1, Steps: 154 | Train Loss: 2.213 Vali Loss: 2.196 Vali Acc: 0.324 Test Loss: 2.196 Test Acc: 0.324
Validation loss decreased (inf --> -0.323579).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9689389
	speed: 0.2914s/iter; left time: 4413.1530s
Epoch: 2 cost time: 11.326555252075195
Epoch: 2, Steps: 154 | Train Loss: 2.050 Vali Loss: 2.287 Vali Acc: 0.323 Test Loss: 2.287 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.1513064
	speed: 0.2989s/iter; left time: 4481.0643s
Epoch: 3 cost time: 11.394534826278687
Epoch: 3, Steps: 154 | Train Loss: 1.960 Vali Loss: 2.277 Vali Acc: 0.326 Test Loss: 2.277 Test Acc: 0.326
Validation loss decreased (-0.323579 --> -0.326417).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6089841
	speed: 0.3001s/iter; left time: 4453.4923s
Epoch: 4 cost time: 11.206531524658203
Epoch: 4, Steps: 154 | Train Loss: 1.903 Vali Loss: 2.266 Vali Acc: 0.338 Test Loss: 2.266 Test Acc: 0.338
Validation loss decreased (-0.326417 --> -0.337771).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7901114
	speed: 0.3075s/iter; left time: 4516.1625s
Epoch: 5 cost time: 10.875822305679321
Epoch: 5, Steps: 154 | Train Loss: 1.792 Vali Loss: 2.503 Vali Acc: 0.333 Test Loss: 2.503 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9572878
	speed: 0.2842s/iter; left time: 4129.6331s
Epoch: 6 cost time: 11.39142632484436
Epoch: 6, Steps: 154 | Train Loss: 1.750 Vali Loss: 2.411 Vali Acc: 0.349 Test Loss: 2.411 Test Acc: 0.349
Validation loss decreased (-0.337771 --> -0.348719).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5232292
	speed: 0.3108s/iter; left time: 4468.1343s
Epoch: 7 cost time: 12.457879543304443
Epoch: 7, Steps: 154 | Train Loss: 1.730 Vali Loss: 2.540 Vali Acc: 0.124 Test Loss: 2.540 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6828430
	speed: 0.3133s/iter; left time: 4456.3796s
Epoch: 8 cost time: 11.456624269485474
Epoch: 8, Steps: 154 | Train Loss: 1.651 Vali Loss: 2.499 Vali Acc: 0.352 Test Loss: 2.499 Test Acc: 0.352
Validation loss decreased (-0.348719 --> -0.351962).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9551432
	speed: 0.3126s/iter; left time: 4398.5560s
Epoch: 9 cost time: 12.073750257492065
Epoch: 9, Steps: 154 | Train Loss: 1.603 Vali Loss: 2.818 Vali Acc: 0.075 Test Loss: 2.818 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4579120
	speed: 0.2890s/iter; left time: 4021.5535s
Epoch: 10 cost time: 10.50486946105957
Epoch: 10, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.863 Vali Acc: 0.374 Test Loss: 2.863 Test Acc: 0.374
Validation loss decreased (-0.351962 --> -0.373856).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4784911
	speed: 0.3008s/iter; left time: 4139.0573s
Epoch: 11 cost time: 11.31507158279419
Epoch: 11, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.812 Vali Acc: 0.362 Test Loss: 2.812 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8583282
	speed: 0.3030s/iter; left time: 4122.2966s
Epoch: 12 cost time: 11.339123964309692
Epoch: 12, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.851 Vali Acc: 0.374 Test Loss: 2.851 Test Acc: 0.374
Validation loss decreased (-0.373856 --> -0.373856).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3306698
	speed: 0.2866s/iter; left time: 3855.3656s
Epoch: 13 cost time: 10.643084287643433
Epoch: 13, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.636 Vali Acc: 0.269 Test Loss: 2.636 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.2289910
	speed: 0.2710s/iter; left time: 3603.6407s
Epoch: 14 cost time: 10.994859218597412
Epoch: 14, Steps: 154 | Train Loss: 1.503 Vali Loss: 3.107 Vali Acc: 0.195 Test Loss: 3.107 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.1829016
	speed: 0.2918s/iter; left time: 3835.9475s
Epoch: 15 cost time: 10.810773611068726
Epoch: 15, Steps: 154 | Train Loss: 1.426 Vali Loss: 3.954 Vali Acc: 0.083 Test Loss: 3.954 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.3149102
	speed: 0.2673s/iter; left time: 3472.7321s
Epoch: 16 cost time: 10.201303958892822
Epoch: 16, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.866 Vali Acc: 0.279 Test Loss: 2.866 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.6684519
	speed: 0.2770s/iter; left time: 3555.8110s
Epoch: 17 cost time: 10.054916143417358
Epoch: 17, Steps: 154 | Train Loss: 1.404 Vali Loss: 3.260 Vali Acc: 0.083 Test Loss: 3.260 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.2614553
	speed: 0.2686s/iter; left time: 3406.1951s
Epoch: 18 cost time: 11.681317329406738
Epoch: 18, Steps: 154 | Train Loss: 1.351 Vali Loss: 3.133 Vali Acc: 0.285 Test Loss: 3.133 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.9238448
	speed: 0.2816s/iter; left time: 3527.8873s
Epoch: 19 cost time: 11.728031635284424
Epoch: 19, Steps: 154 | Train Loss: 1.289 Vali Loss: 3.902 Vali Acc: 0.075 Test Loss: 3.902 Test Acc: 0.075
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.0640709
	speed: 0.2816s/iter; left time: 3485.2133s
Epoch: 20 cost time: 10.966377973556519
Epoch: 20, Steps: 154 | Train Loss: 1.313 Vali Loss: 3.362 Vali Acc: 0.092 Test Loss: 3.362 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.6028097
	speed: 0.2767s/iter; left time: 3381.9453s
Epoch: 21 cost time: 9.826506614685059
Epoch: 21, Steps: 154 | Train Loss: 1.256 Vali Loss: 3.100 Vali Acc: 0.094 Test Loss: 3.100 Test Acc: 0.094
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.5753734
	speed: 0.2888s/iter; left time: 3484.8834s
Epoch: 22 cost time: 11.481081485748291
Epoch: 22, Steps: 154 | Train Loss: 1.291 Vali Loss: 3.282 Vali Acc: 0.199 Test Loss: 3.282 Test Acc: 0.199
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37388483373884834
model parameter : 472670
model size : 6.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2564664
	speed: 0.0942s/iter; left time: 1441.2692s
Epoch: 1 cost time: 13.450128078460693
Epoch: 1, Steps: 154 | Train Loss: 2.208 Vali Loss: 2.206 Vali Acc: 0.323 Test Loss: 2.206 Test Acc: 0.323
Validation loss decreased (inf --> -0.323173).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9641163
	speed: 0.2817s/iter; left time: 4267.0691s
Epoch: 2 cost time: 11.01736831665039
Epoch: 2, Steps: 154 | Train Loss: 2.059 Vali Loss: 2.323 Vali Acc: 0.324 Test Loss: 2.323 Test Acc: 0.324
Validation loss decreased (-0.323173 --> -0.323578).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1408131
	speed: 0.2740s/iter; left time: 4107.9044s
Epoch: 3 cost time: 9.373647212982178
Epoch: 3, Steps: 154 | Train Loss: 1.952 Vali Loss: 2.324 Vali Acc: 0.328 Test Loss: 2.324 Test Acc: 0.328
Validation loss decreased (-0.323578 --> -0.327633).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6317947
	speed: 0.2765s/iter; left time: 4102.5273s
Epoch: 4 cost time: 11.634063243865967
Epoch: 4, Steps: 154 | Train Loss: 1.911 Vali Loss: 2.217 Vali Acc: 0.339 Test Loss: 2.217 Test Acc: 0.339
Validation loss decreased (-0.327633 --> -0.338988).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5987848
	speed: 0.2837s/iter; left time: 4166.2716s
Epoch: 5 cost time: 11.097902059555054
Epoch: 5, Steps: 154 | Train Loss: 1.780 Vali Loss: 2.450 Vali Acc: 0.339 Test Loss: 2.450 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9468985
	speed: 0.2717s/iter; left time: 3948.5267s
Epoch: 6 cost time: 10.300185918807983
Epoch: 6, Steps: 154 | Train Loss: 1.730 Vali Loss: 2.394 Vali Acc: 0.349 Test Loss: 2.394 Test Acc: 0.349
Validation loss decreased (-0.338988 --> -0.348719).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5983396
	speed: 0.2857s/iter; left time: 4106.8313s
Epoch: 7 cost time: 11.894357204437256
Epoch: 7, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.538 Vali Acc: 0.198 Test Loss: 2.538 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6209743
	speed: 0.2768s/iter; left time: 3937.2773s
Epoch: 8 cost time: 9.810042381286621
Epoch: 8, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.601 Vali Acc: 0.352 Test Loss: 2.601 Test Acc: 0.352
Validation loss decreased (-0.348719 --> -0.351556).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9884077
	speed: 0.2755s/iter; left time: 3875.4664s
Epoch: 9 cost time: 10.815155506134033
Epoch: 9, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.779 Vali Acc: 0.290 Test Loss: 2.779 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4117362
	speed: 0.2946s/iter; left time: 4099.2701s
Epoch: 10 cost time: 11.39037799835205
Epoch: 10, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.886 Vali Acc: 0.348 Test Loss: 2.886 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.0256312
	speed: 0.2668s/iter; left time: 3671.1630s
Epoch: 11 cost time: 11.467604875564575
Epoch: 11, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.655 Vali Acc: 0.362 Test Loss: 2.655 Test Acc: 0.362
Validation loss decreased (-0.351556 --> -0.362098).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9797912
	speed: 0.2797s/iter; left time: 3805.9428s
Epoch: 12 cost time: 10.739360809326172
Epoch: 12, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.651 Vali Acc: 0.365 Test Loss: 2.651 Test Acc: 0.365
Validation loss decreased (-0.362098 --> -0.365343).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2360368
	speed: 0.2556s/iter; left time: 3439.1638s
Epoch: 13 cost time: 8.321224689483643
Epoch: 13, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.689 Vali Acc: 0.333 Test Loss: 2.689 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.1967459
	speed: 0.2405s/iter; left time: 3198.6490s
Epoch: 14 cost time: 11.154726505279541
Epoch: 14, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.094 Vali Acc: 0.098 Test Loss: 3.094 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.4940335
	speed: 0.2819s/iter; left time: 3706.2197s
Epoch: 15 cost time: 10.94683051109314
Epoch: 15, Steps: 154 | Train Loss: 1.396 Vali Loss: 3.832 Vali Acc: 0.091 Test Loss: 3.832 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.6014314
	speed: 0.2605s/iter; left time: 3383.9773s
Epoch: 16 cost time: 8.624608516693115
Epoch: 16, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.840 Vali Acc: 0.281 Test Loss: 2.840 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.3215134
	speed: 0.2679s/iter; left time: 3439.0257s
Epoch: 17 cost time: 10.614384889602661
Epoch: 17, Steps: 154 | Train Loss: 1.353 Vali Loss: 3.030 Vali Acc: 0.157 Test Loss: 3.030 Test Acc: 0.157
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.1030245
	speed: 0.2745s/iter; left time: 3481.2602s
Epoch: 18 cost time: 11.667431592941284
Epoch: 18, Steps: 154 | Train Loss: 1.319 Vali Loss: 3.115 Vali Acc: 0.369 Test Loss: 3.115 Test Acc: 0.369
Validation loss decreased (-0.365343 --> -0.369393).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.6782191
	speed: 0.2616s/iter; left time: 3277.4341s
Epoch: 19 cost time: 10.704853057861328
Epoch: 19, Steps: 154 | Train Loss: 1.334 Vali Loss: 4.063 Vali Acc: 0.073 Test Loss: 4.063 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1025745
	speed: 0.2749s/iter; left time: 3401.4666s
Epoch: 20 cost time: 10.273231029510498
Epoch: 20, Steps: 154 | Train Loss: 1.451 Vali Loss: 3.219 Vali Acc: 0.366 Test Loss: 3.219 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.1912353
	speed: 0.2743s/iter; left time: 3352.4937s
Epoch: 21 cost time: 10.191617965698242
Epoch: 21, Steps: 154 | Train Loss: 1.229 Vali Loss: 2.851 Vali Acc: 0.377 Test Loss: 2.851 Test Acc: 0.377
Validation loss decreased (-0.369393 --> -0.376695).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.5530802
	speed: 0.2775s/iter; left time: 3348.3550s
Epoch: 22 cost time: 9.979500532150269
Epoch: 22, Steps: 154 | Train Loss: 1.214 Vali Loss: 3.352 Vali Acc: 0.302 Test Loss: 3.352 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.2535524
	speed: 0.2641s/iter; left time: 3146.1017s
Epoch: 23 cost time: 11.109235286712646
Epoch: 23, Steps: 154 | Train Loss: 1.212 Vali Loss: 3.250 Vali Acc: 0.224 Test Loss: 3.250 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.2059538
	speed: 0.2814s/iter; left time: 3308.4219s
Epoch: 24 cost time: 10.972584962844849
Epoch: 24, Steps: 154 | Train Loss: 1.255 Vali Loss: 3.477 Vali Acc: 0.165 Test Loss: 3.477 Test Acc: 0.165
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.8748575
	speed: 0.2735s/iter; left time: 3174.1778s
Epoch: 25 cost time: 9.917311668395996
Epoch: 25, Steps: 154 | Train Loss: 1.235 Vali Loss: 4.141 Vali Acc: 0.182 Test Loss: 4.141 Test Acc: 0.182
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.3389238
	speed: 0.2837s/iter; left time: 3249.1032s
Epoch: 26 cost time: 11.43578052520752
Epoch: 26, Steps: 154 | Train Loss: 1.150 Vali Loss: 3.600 Vali Acc: 0.246 Test Loss: 3.600 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.1907551
	speed: 0.2882s/iter; left time: 3255.6728s
Epoch: 27 cost time: 10.658618211746216
Epoch: 27, Steps: 154 | Train Loss: 1.137 Vali Loss: 3.735 Vali Acc: 0.229 Test Loss: 3.735 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.9247484
	speed: 0.2676s/iter; left time: 2981.7997s
Epoch: 28 cost time: 9.106056690216064
Epoch: 28, Steps: 154 | Train Loss: 1.092 Vali Loss: 3.604 Vali Acc: 0.328 Test Loss: 3.604 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.7584577
	speed: 0.2538s/iter; left time: 2788.6570s
Epoch: 29 cost time: 9.656270265579224
Epoch: 29, Steps: 154 | Train Loss: 1.066 Vali Loss: 5.465 Vali Acc: 0.100 Test Loss: 5.465 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.0136526
	speed: 0.2469s/iter; left time: 2674.8510s
Epoch: 30 cost time: 10.884355783462524
Epoch: 30, Steps: 154 | Train Loss: 1.171 Vali Loss: 5.125 Vali Acc: 0.091 Test Loss: 5.125 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.8682972
	speed: 0.2639s/iter; left time: 2818.4263s
Epoch: 31 cost time: 10.080626964569092
Epoch: 31, Steps: 154 | Train Loss: 1.219 Vali Loss: 4.611 Vali Acc: 0.095 Test Loss: 4.611 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3767234387672344
model parameter : 472670
model size : 6.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2595899
	speed: 0.0757s/iter; left time: 1157.5964s
Epoch: 1 cost time: 10.87082552909851
Epoch: 1, Steps: 154 | Train Loss: 2.200 Vali Loss: 2.218 Vali Acc: 0.322 Test Loss: 2.218 Test Acc: 0.322
Validation loss decreased (inf --> -0.322362).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0200267
	speed: 0.2403s/iter; left time: 3639.0817s
Epoch: 2 cost time: 10.226066827774048
Epoch: 2, Steps: 154 | Train Loss: 2.040 Vali Loss: 2.328 Vali Acc: 0.323 Test Loss: 2.328 Test Acc: 0.323
Validation loss decreased (-0.322362 --> -0.323172).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2292974
	speed: 0.2669s/iter; left time: 4002.1541s
Epoch: 3 cost time: 10.53704833984375
Epoch: 3, Steps: 154 | Train Loss: 1.944 Vali Loss: 2.389 Vali Acc: 0.326 Test Loss: 2.389 Test Acc: 0.326
Validation loss decreased (-0.323172 --> -0.326010).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6168836
	speed: 0.2611s/iter; left time: 3873.8608s
Epoch: 4 cost time: 10.341910600662231
Epoch: 4, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.292 Vali Acc: 0.346 Test Loss: 2.292 Test Acc: 0.346
Validation loss decreased (-0.326010 --> -0.345881).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6743186
	speed: 0.2712s/iter; left time: 3982.5424s
Epoch: 5 cost time: 10.803879499435425
Epoch: 5, Steps: 154 | Train Loss: 1.763 Vali Loss: 2.609 Vali Acc: 0.345 Test Loss: 2.609 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7833129
	speed: 0.2678s/iter; left time: 3891.0359s
Epoch: 6 cost time: 10.42833662033081
Epoch: 6, Steps: 154 | Train Loss: 1.709 Vali Loss: 2.449 Vali Acc: 0.349 Test Loss: 2.449 Test Acc: 0.349
Validation loss decreased (-0.345881 --> -0.349124).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2406033
	speed: 0.2701s/iter; left time: 3883.8551s
Epoch: 7 cost time: 9.839239358901978
Epoch: 7, Steps: 154 | Train Loss: 1.658 Vali Loss: 2.411 Vali Acc: 0.357 Test Loss: 2.411 Test Acc: 0.357
Validation loss decreased (-0.349124 --> -0.356829).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6832616
	speed: 0.2556s/iter; left time: 3635.5306s
Epoch: 8 cost time: 9.735679626464844
Epoch: 8, Steps: 154 | Train Loss: 1.681 Vali Loss: 2.648 Vali Acc: 0.352 Test Loss: 2.648 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.9919780
	speed: 0.2638s/iter; left time: 3711.7554s
Epoch: 9 cost time: 10.591267824172974
Epoch: 9, Steps: 154 | Train Loss: 1.585 Vali Loss: 2.758 Vali Acc: 0.356 Test Loss: 2.758 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.2737830
	speed: 0.2623s/iter; left time: 3649.5171s
Epoch: 10 cost time: 10.653432607650757
Epoch: 10, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.649 Vali Acc: 0.370 Test Loss: 2.649 Test Acc: 0.370
Validation loss decreased (-0.356829 --> -0.370209).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4348612
	speed: 0.2527s/iter; left time: 3477.4723s
Epoch: 11 cost time: 10.022623538970947
Epoch: 11, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.595 Vali Acc: 0.378 Test Loss: 2.595 Test Acc: 0.378
Validation loss decreased (-0.370209 --> -0.378320).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4508653
	speed: 0.2744s/iter; left time: 3733.9694s
Epoch: 12 cost time: 10.274050235748291
Epoch: 12, Steps: 154 | Train Loss: 1.400 Vali Loss: 3.167 Vali Acc: 0.225 Test Loss: 3.167 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.0320733
	speed: 0.2745s/iter; left time: 3692.3693s
Epoch: 13 cost time: 10.702624559402466
Epoch: 13, Steps: 154 | Train Loss: 1.390 Vali Loss: 2.616 Vali Acc: 0.382 Test Loss: 2.616 Test Acc: 0.382
Validation loss decreased (-0.378320 --> -0.381563).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.8252053
	speed: 0.2659s/iter; left time: 3536.7985s
Epoch: 14 cost time: 10.15164303779602
Epoch: 14, Steps: 154 | Train Loss: 1.480 Vali Loss: 3.464 Vali Acc: 0.206 Test Loss: 3.464 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1151230
	speed: 0.2609s/iter; left time: 3429.2143s
Epoch: 15 cost time: 9.744139194488525
Epoch: 15, Steps: 154 | Train Loss: 1.344 Vali Loss: 3.297 Vali Acc: 0.290 Test Loss: 3.297 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.1822722
	speed: 0.2473s/iter; left time: 3212.0917s
Epoch: 16 cost time: 10.25110673904419
Epoch: 16, Steps: 154 | Train Loss: 1.262 Vali Loss: 3.218 Vali Acc: 0.206 Test Loss: 3.218 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.3191772
	speed: 0.2544s/iter; left time: 3266.3015s
Epoch: 17 cost time: 10.5940523147583
Epoch: 17, Steps: 154 | Train Loss: 1.297 Vali Loss: 3.102 Vali Acc: 0.383 Test Loss: 3.102 Test Acc: 0.383
Validation loss decreased (-0.381563 --> -0.383181).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.9844869
	speed: 0.2692s/iter; left time: 3414.1507s
Epoch: 18 cost time: 9.886280298233032
Epoch: 18, Steps: 154 | Train Loss: 1.625 Vali Loss: 3.368 Vali Acc: 0.373 Test Loss: 3.368 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.6385338
	speed: 0.2612s/iter; left time: 3272.3752s
Epoch: 19 cost time: 9.561150789260864
Epoch: 19, Steps: 154 | Train Loss: 1.206 Vali Loss: 4.203 Vali Acc: 0.095 Test Loss: 4.203 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.0520617
	speed: 0.2611s/iter; left time: 3231.4508s
Epoch: 20 cost time: 11.218804359436035
Epoch: 20, Steps: 154 | Train Loss: 1.216 Vali Loss: 3.861 Vali Acc: 0.165 Test Loss: 3.861 Test Acc: 0.165
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.4262054
	speed: 0.2789s/iter; left time: 3408.7788s
Epoch: 21 cost time: 11.443130016326904
Epoch: 21, Steps: 154 | Train Loss: 1.175 Vali Loss: 3.627 Vali Acc: 0.194 Test Loss: 3.627 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.3240350
	speed: 0.2538s/iter; left time: 3062.3016s
Epoch: 22 cost time: 9.839743852615356
Epoch: 22, Steps: 154 | Train Loss: 1.105 Vali Loss: 4.060 Vali Acc: 0.183 Test Loss: 4.060 Test Acc: 0.183
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.2922006
	speed: 0.2711s/iter; left time: 3229.2961s
Epoch: 23 cost time: 10.238879203796387
Epoch: 23, Steps: 154 | Train Loss: 1.157 Vali Loss: 3.751 Vali Acc: 0.209 Test Loss: 3.751 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.1688253
	speed: 0.2646s/iter; left time: 3110.9438s
Epoch: 24 cost time: 10.267375707626343
Epoch: 24, Steps: 154 | Train Loss: 1.038 Vali Loss: 4.203 Vali Acc: 0.092 Test Loss: 4.203 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.9074749
	speed: 0.2600s/iter; left time: 3017.6882s
Epoch: 25 cost time: 9.554436683654785
Epoch: 25, Steps: 154 | Train Loss: 1.120 Vali Loss: 4.564 Vali Acc: 0.193 Test Loss: 4.564 Test Acc: 0.193
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 1.2370631
	speed: 0.2452s/iter; left time: 2808.3503s
Epoch: 26 cost time: 9.07243037223816
Epoch: 26, Steps: 154 | Train Loss: 1.035 Vali Loss: 4.333 Vali Acc: 0.142 Test Loss: 4.333 Test Acc: 0.142
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.0694946
	speed: 0.2437s/iter; left time: 2753.6198s
Epoch: 27 cost time: 10.459689617156982
Epoch: 27, Steps: 154 | Train Loss: 1.133 Vali Loss: 5.225 Vali Acc: 0.110 Test Loss: 5.225 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38321167883211676
model parameter : 472670
model size : 6.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1889973
	speed: 0.0770s/iter; left time: 1178.7835s
Epoch: 1 cost time: 10.75215768814087
Epoch: 1, Steps: 154 | Train Loss: 2.190 Vali Loss: 2.220 Vali Acc: 0.321 Test Loss: 2.220 Test Acc: 0.321
Validation loss decreased (inf --> -0.320740).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9361393
	speed: 0.2560s/iter; left time: 3876.9162s
Epoch: 2 cost time: 10.243046998977661
Epoch: 2, Steps: 154 | Train Loss: 2.021 Vali Loss: 2.399 Vali Acc: 0.326 Test Loss: 2.399 Test Acc: 0.326
Validation loss decreased (-0.320740 --> -0.326010).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0875175
	speed: 0.2704s/iter; left time: 4054.2456s
Epoch: 3 cost time: 10.278593063354492
Epoch: 3, Steps: 154 | Train Loss: 1.912 Vali Loss: 2.496 Vali Acc: 0.328 Test Loss: 2.496 Test Acc: 0.328
Validation loss decreased (-0.326010 --> -0.328037).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7681949
	speed: 0.2626s/iter; left time: 3896.1716s
Epoch: 4 cost time: 9.276468515396118
Epoch: 4, Steps: 154 | Train Loss: 1.847 Vali Loss: 2.392 Vali Acc: 0.347 Test Loss: 2.392 Test Acc: 0.347
Validation loss decreased (-0.328037 --> -0.347097).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4559419
	speed: 0.2293s/iter; left time: 3367.6847s
Epoch: 5 cost time: 10.180138349533081
Epoch: 5, Steps: 154 | Train Loss: 1.691 Vali Loss: 2.893 Vali Acc: 0.347 Test Loss: 2.893 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6433026
	speed: 0.2634s/iter; left time: 3828.0517s
Epoch: 6 cost time: 10.715211868286133
Epoch: 6, Steps: 154 | Train Loss: 1.636 Vali Loss: 2.743 Vali Acc: 0.352 Test Loss: 2.743 Test Acc: 0.352
Validation loss decreased (-0.347097 --> -0.351960).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2211723
	speed: 0.2559s/iter; left time: 3678.6938s
Epoch: 7 cost time: 10.31703495979309
Epoch: 7, Steps: 154 | Train Loss: 1.572 Vali Loss: 2.470 Vali Acc: 0.369 Test Loss: 2.470 Test Acc: 0.369
Validation loss decreased (-0.351960 --> -0.368994).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3019063
	speed: 0.2669s/iter; left time: 3795.6536s
Epoch: 8 cost time: 9.882597208023071
Epoch: 8, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.731 Vali Acc: 0.354 Test Loss: 2.731 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7015896
	speed: 0.2630s/iter; left time: 3700.2737s
Epoch: 9 cost time: 9.763250350952148
Epoch: 9, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.629 Vali Acc: 0.367 Test Loss: 2.629 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1126101
	speed: 0.2623s/iter; left time: 3649.5926s
Epoch: 10 cost time: 11.057736873626709
Epoch: 10, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.751 Vali Acc: 0.371 Test Loss: 2.751 Test Acc: 0.371
Validation loss decreased (-0.368994 --> -0.370613).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1455400
	speed: 0.2422s/iter; left time: 3332.3279s
Epoch: 11 cost time: 8.85029149055481
Epoch: 11, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.711 Vali Acc: 0.383 Test Loss: 2.711 Test Acc: 0.383
Validation loss decreased (-0.370613 --> -0.383185).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2718579
	speed: 0.2450s/iter; left time: 3333.5416s
Epoch: 12 cost time: 9.488522052764893
Epoch: 12, Steps: 154 | Train Loss: 1.341 Vali Loss: 3.150 Vali Acc: 0.366 Test Loss: 3.150 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9214602
	speed: 0.2374s/iter; left time: 3193.3253s
Epoch: 13 cost time: 9.390065431594849
Epoch: 13, Steps: 154 | Train Loss: 1.272 Vali Loss: 2.559 Vali Acc: 0.383 Test Loss: 2.559 Test Acc: 0.383
Validation loss decreased (-0.383185 --> -0.383186).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.1028242
	speed: 0.2450s/iter; left time: 3258.1910s
Epoch: 14 cost time: 10.353803634643555
Epoch: 14, Steps: 154 | Train Loss: 1.239 Vali Loss: 2.965 Vali Acc: 0.387 Test Loss: 2.965 Test Acc: 0.387
Validation loss decreased (-0.383186 --> -0.387237).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.8210569
	speed: 0.2638s/iter; left time: 3467.2723s
Epoch: 15 cost time: 10.266683340072632
Epoch: 15, Steps: 154 | Train Loss: 1.295 Vali Loss: 2.880 Vali Acc: 0.361 Test Loss: 2.880 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.6422101
	speed: 0.2440s/iter; left time: 3169.9296s
Epoch: 16 cost time: 8.901672601699829
Epoch: 16, Steps: 154 | Train Loss: 1.195 Vali Loss: 2.594 Vali Acc: 0.401 Test Loss: 2.594 Test Acc: 0.401
Validation loss decreased (-0.387237 --> -0.401434).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0931458
	speed: 0.2548s/iter; left time: 3271.1289s
Epoch: 17 cost time: 9.351899147033691
Epoch: 17, Steps: 154 | Train Loss: 1.192 Vali Loss: 3.093 Vali Acc: 0.386 Test Loss: 3.093 Test Acc: 0.386
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.1898344
	speed: 0.2484s/iter; left time: 3150.7884s
Epoch: 18 cost time: 10.168953657150269
Epoch: 18, Steps: 154 | Train Loss: 1.406 Vali Loss: 3.145 Vali Acc: 0.383 Test Loss: 3.145 Test Acc: 0.383
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.8552673
	speed: 0.2432s/iter; left time: 3046.9089s
Epoch: 19 cost time: 9.475003004074097
Epoch: 19, Steps: 154 | Train Loss: 1.105 Vali Loss: 3.448 Vali Acc: 0.116 Test Loss: 3.448 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.1363634
	speed: 0.2487s/iter; left time: 3078.1729s
Epoch: 20 cost time: 9.776695251464844
Epoch: 20, Steps: 154 | Train Loss: 1.091 Vali Loss: 3.120 Vali Acc: 0.390 Test Loss: 3.120 Test Acc: 0.390
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.2389992
	speed: 0.2553s/iter; left time: 3119.6842s
Epoch: 21 cost time: 9.079054594039917
Epoch: 21, Steps: 154 | Train Loss: 1.043 Vali Loss: 3.192 Vali Acc: 0.223 Test Loss: 3.192 Test Acc: 0.223
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.4621429
	speed: 0.2554s/iter; left time: 3081.7963s
Epoch: 22 cost time: 10.202470064163208
Epoch: 22, Steps: 154 | Train Loss: 1.108 Vali Loss: 3.016 Vali Acc: 0.389 Test Loss: 3.016 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 4.6502366
	speed: 0.2684s/iter; left time: 3196.9443s
Epoch: 23 cost time: 9.66277027130127
Epoch: 23, Steps: 154 | Train Loss: 1.090 Vali Loss: 3.122 Vali Acc: 0.393 Test Loss: 3.122 Test Acc: 0.393
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.0285560
	speed: 0.2563s/iter; left time: 3013.8752s
Epoch: 24 cost time: 9.657716035842896
Epoch: 24, Steps: 154 | Train Loss: 1.081 Vali Loss: 3.003 Vali Acc: 0.199 Test Loss: 3.003 Test Acc: 0.199
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.1190531
	speed: 0.2408s/iter; left time: 2794.2558s
Epoch: 25 cost time: 9.277163743972778
Epoch: 25, Steps: 154 | Train Loss: 1.051 Vali Loss: 3.384 Vali Acc: 0.224 Test Loss: 3.384 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.8045816
	speed: 0.2401s/iter; left time: 2749.5593s
Epoch: 26 cost time: 10.017382621765137
Epoch: 26, Steps: 154 | Train Loss: 0.893 Vali Loss: 3.503 Vali Acc: 0.276 Test Loss: 3.503 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.40145985401459855
model parameter : 472670
model size : 6.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2543097
	speed: 0.0751s/iter; left time: 1149.1037s
Epoch: 1 cost time: 10.490405082702637
Epoch: 1, Steps: 154 | Train Loss: 2.276 Vali Loss: 2.166 Vali Acc: 0.320 Test Loss: 2.166 Test Acc: 0.320
Validation loss decreased (inf --> -0.319524).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8813107
	speed: 0.2439s/iter; left time: 3694.1729s
Epoch: 2 cost time: 8.954132795333862
Epoch: 2, Steps: 154 | Train Loss: 2.043 Vali Loss: 2.147 Vali Acc: 0.326 Test Loss: 2.147 Test Acc: 0.326
Validation loss decreased (-0.319524 --> -0.326418).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8331635
	speed: 0.2371s/iter; left time: 3555.3061s
Epoch: 3 cost time: 9.159472942352295
Epoch: 3, Steps: 154 | Train Loss: 1.956 Vali Loss: 2.151 Vali Acc: 0.327 Test Loss: 2.151 Test Acc: 0.327
Validation loss decreased (-0.326418 --> -0.327229).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1959386
	speed: 0.2449s/iter; left time: 3633.7917s
Epoch: 4 cost time: 9.427754163742065
Epoch: 4, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.204 Vali Acc: 0.331 Test Loss: 2.204 Test Acc: 0.331
Validation loss decreased (-0.327229 --> -0.330878).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0430331
	speed: 0.2494s/iter; left time: 3662.0062s
Epoch: 5 cost time: 10.052996397018433
Epoch: 5, Steps: 154 | Train Loss: 1.819 Vali Loss: 2.240 Vali Acc: 0.341 Test Loss: 2.240 Test Acc: 0.341
Validation loss decreased (-0.330878 --> -0.340610).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9809608
	speed: 0.2551s/iter; left time: 3707.3403s
Epoch: 6 cost time: 9.6171293258667
Epoch: 6, Steps: 154 | Train Loss: 1.713 Vali Loss: 2.297 Vali Acc: 0.340 Test Loss: 2.297 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8466151
	speed: 0.2288s/iter; left time: 3289.5616s
Epoch: 7 cost time: 8.86079716682434
Epoch: 7, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.363 Vali Acc: 0.346 Test Loss: 2.363 Test Acc: 0.346
Validation loss decreased (-0.340610 --> -0.345881).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2353601
	speed: 0.2596s/iter; left time: 3692.7922s
Epoch: 8 cost time: 9.718087434768677
Epoch: 8, Steps: 154 | Train Loss: 1.654 Vali Loss: 2.388 Vali Acc: 0.354 Test Loss: 2.388 Test Acc: 0.354
Validation loss decreased (-0.345881 --> -0.353585).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0214863
	speed: 0.2657s/iter; left time: 3737.4966s
Epoch: 9 cost time: 10.277951955795288
Epoch: 9, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.425 Vali Acc: 0.356 Test Loss: 2.425 Test Acc: 0.356
Validation loss decreased (-0.353585 --> -0.356423).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6504900
	speed: 0.2520s/iter; left time: 3507.1086s
Epoch: 10 cost time: 9.801900148391724
Epoch: 10, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.482 Vali Acc: 0.364 Test Loss: 2.482 Test Acc: 0.364
Validation loss decreased (-0.356423 --> -0.363722).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2962415
	speed: 0.2504s/iter; left time: 3445.9136s
Epoch: 11 cost time: 9.149528980255127
Epoch: 11, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.484 Vali Acc: 0.197 Test Loss: 2.484 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2212662
	speed: 0.2581s/iter; left time: 3512.0329s
Epoch: 12 cost time: 10.555208444595337
Epoch: 12, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.479 Vali Acc: 0.359 Test Loss: 2.479 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0159011
	speed: 0.2666s/iter; left time: 3585.9723s
Epoch: 13 cost time: 10.267974376678467
Epoch: 13, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.688 Vali Acc: 0.207 Test Loss: 2.688 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.1320491
	speed: 0.2767s/iter; left time: 3679.9963s
Epoch: 14 cost time: 9.950831413269043
Epoch: 14, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.803 Vali Acc: 0.352 Test Loss: 2.803 Test Acc: 0.352
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.3789068
	speed: 0.2701s/iter; left time: 3549.8408s
Epoch: 15 cost time: 10.635622501373291
Epoch: 15, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.569 Vali Acc: 0.366 Test Loss: 2.569 Test Acc: 0.366
Validation loss decreased (-0.363722 --> -0.365749).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5513134
	speed: 0.2664s/iter; left time: 3460.5230s
Epoch: 16 cost time: 10.812766790390015
Epoch: 16, Steps: 154 | Train Loss: 1.333 Vali Loss: 2.747 Vali Acc: 0.105 Test Loss: 2.747 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.8366570
	speed: 0.2622s/iter; left time: 3366.3575s
Epoch: 17 cost time: 10.012741327285767
Epoch: 17, Steps: 154 | Train Loss: 1.330 Vali Loss: 3.040 Vali Acc: 0.091 Test Loss: 3.040 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.3514514
	speed: 0.2570s/iter; left time: 3259.6100s
Epoch: 18 cost time: 9.539572715759277
Epoch: 18, Steps: 154 | Train Loss: 1.278 Vali Loss: 2.870 Vali Acc: 0.193 Test Loss: 2.870 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.8791997
	speed: 0.2478s/iter; left time: 3104.4841s
Epoch: 19 cost time: 10.142650842666626
Epoch: 19, Steps: 154 | Train Loss: 1.281 Vali Loss: 2.901 Vali Acc: 0.219 Test Loss: 2.901 Test Acc: 0.219
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.3993058
	speed: 0.2585s/iter; left time: 3199.4013s
Epoch: 20 cost time: 9.499332666397095
Epoch: 20, Steps: 154 | Train Loss: 1.209 Vali Loss: 3.026 Vali Acc: 0.188 Test Loss: 3.026 Test Acc: 0.188
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.8316221
	speed: 0.2630s/iter; left time: 3214.0571s
Epoch: 21 cost time: 12.436708927154541
Epoch: 21, Steps: 154 | Train Loss: 1.201 Vali Loss: 2.818 Vali Acc: 0.210 Test Loss: 2.818 Test Acc: 0.210
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.7666573
	speed: 0.3989s/iter; left time: 4813.3490s
Epoch: 22 cost time: 16.27590560913086
Epoch: 22, Steps: 154 | Train Loss: 1.237 Vali Loss: 3.413 Vali Acc: 0.079 Test Loss: 3.413 Test Acc: 0.079
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.0386140
	speed: 0.3939s/iter; left time: 4692.2717s
Epoch: 23 cost time: 15.563783407211304
Epoch: 23, Steps: 154 | Train Loss: 1.138 Vali Loss: 3.068 Vali Acc: 0.208 Test Loss: 3.068 Test Acc: 0.208
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.9120262
	speed: 0.4031s/iter; left time: 4740.2502s
Epoch: 24 cost time: 15.88854718208313
Epoch: 24, Steps: 154 | Train Loss: 1.132 Vali Loss: 2.874 Vali Acc: 0.370 Test Loss: 2.874 Test Acc: 0.370
Validation loss decreased (-0.365749 --> -0.370206).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.0701603
	speed: 0.3929s/iter; left time: 4559.4723s
Epoch: 25 cost time: 15.808135271072388
Epoch: 25, Steps: 154 | Train Loss: 1.147 Vali Loss: 3.587 Vali Acc: 0.080 Test Loss: 3.587 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.9848154
	speed: 0.3992s/iter; left time: 4571.4754s
Epoch: 26 cost time: 16.143179655075073
Epoch: 26, Steps: 154 | Train Loss: 1.108 Vali Loss: 3.505 Vali Acc: 0.099 Test Loss: 3.505 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.6134148
	speed: 0.3866s/iter; left time: 4367.8196s
Epoch: 27 cost time: 11.42733097076416
Epoch: 27, Steps: 154 | Train Loss: 1.131 Vali Loss: 3.822 Vali Acc: 0.107 Test Loss: 3.822 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.9094764
	speed: 0.3477s/iter; left time: 3873.9440s
Epoch: 28 cost time: 15.8370943069458
Epoch: 28, Steps: 154 | Train Loss: 1.090 Vali Loss: 3.394 Vali Acc: 0.094 Test Loss: 3.394 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.6816747
	speed: 0.3917s/iter; left time: 4304.1601s
Epoch: 29 cost time: 15.280347347259521
Epoch: 29, Steps: 154 | Train Loss: 1.035 Vali Loss: 3.995 Vali Acc: 0.093 Test Loss: 3.995 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.9641563
	speed: 0.3878s/iter; left time: 4201.5550s
Epoch: 30 cost time: 14.29998230934143
Epoch: 30, Steps: 154 | Train Loss: 1.172 Vali Loss: 4.063 Vali Acc: 0.085 Test Loss: 4.063 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.6763533
	speed: 0.3792s/iter; left time: 4049.8543s
Epoch: 31 cost time: 13.800899505615234
Epoch: 31, Steps: 154 | Train Loss: 1.019 Vali Loss: 3.600 Vali Acc: 0.185 Test Loss: 3.600 Test Acc: 0.185
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 1.3673556
	speed: 0.3760s/iter; left time: 3958.6314s
Epoch: 32 cost time: 15.02298641204834
Epoch: 32, Steps: 154 | Train Loss: 1.061 Vali Loss: 3.418 Vali Acc: 0.110 Test Loss: 3.418 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.9269777
	speed: 0.3827s/iter; left time: 3970.2159s
Epoch: 33 cost time: 13.769768714904785
Epoch: 33, Steps: 154 | Train Loss: 0.993 Vali Loss: 3.095 Vali Acc: 0.196 Test Loss: 3.095 Test Acc: 0.196
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.6359184
	speed: 0.3272s/iter; left time: 3343.6421s
Epoch: 34 cost time: 15.385329961776733
Epoch: 34, Steps: 154 | Train Loss: 1.049 Vali Loss: 4.220 Vali Acc: 0.076 Test Loss: 4.220 Test Acc: 0.076
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.370235198702352
model parameter : 1186654
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2446704
	speed: 0.1169s/iter; left time: 1788.9436s
Epoch: 1 cost time: 17.436684131622314
Epoch: 1, Steps: 154 | Train Loss: 2.273 Vali Loss: 2.158 Vali Acc: 0.318 Test Loss: 2.158 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9001515
	speed: 0.3752s/iter; left time: 5683.3527s
Epoch: 2 cost time: 13.665173292160034
Epoch: 2, Steps: 154 | Train Loss: 2.025 Vali Loss: 2.145 Vali Acc: 0.327 Test Loss: 2.145 Test Acc: 0.327
Validation loss decreased (-0.318308 --> -0.327229).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7924567
	speed: 0.3516s/iter; left time: 5271.4313s
Epoch: 3 cost time: 13.162837743759155
Epoch: 3, Steps: 154 | Train Loss: 1.968 Vali Loss: 2.136 Vali Acc: 0.335 Test Loss: 2.136 Test Acc: 0.335
Validation loss decreased (-0.327229 --> -0.335340).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1451845
	speed: 0.3641s/iter; left time: 5403.5870s
Epoch: 4 cost time: 15.14607572555542
Epoch: 4, Steps: 154 | Train Loss: 1.865 Vali Loss: 2.181 Vali Acc: 0.337 Test Loss: 2.181 Test Acc: 0.337
Validation loss decreased (-0.335340 --> -0.337367).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0741191
	speed: 0.3622s/iter; left time: 5319.2703s
Epoch: 5 cost time: 14.451634883880615
Epoch: 5, Steps: 154 | Train Loss: 1.783 Vali Loss: 2.256 Vali Acc: 0.343 Test Loss: 2.256 Test Acc: 0.343
Validation loss decreased (-0.337367 --> -0.343449).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9647498
	speed: 0.3562s/iter; left time: 5176.5154s
Epoch: 6 cost time: 11.242697477340698
Epoch: 6, Steps: 154 | Train Loss: 1.681 Vali Loss: 2.304 Vali Acc: 0.341 Test Loss: 2.304 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9328288
	speed: 0.3028s/iter; left time: 4353.9253s
Epoch: 7 cost time: 13.978941202163696
Epoch: 7, Steps: 154 | Train Loss: 1.630 Vali Loss: 2.367 Vali Acc: 0.348 Test Loss: 2.367 Test Acc: 0.348
Validation loss decreased (-0.343449 --> -0.347503).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9671590
	speed: 0.3666s/iter; left time: 5214.7557s
Epoch: 8 cost time: 14.559511423110962
Epoch: 8, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.419 Vali Acc: 0.351 Test Loss: 2.419 Test Acc: 0.351
Validation loss decreased (-0.347503 --> -0.351152).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8562145
	speed: 0.3687s/iter; left time: 5187.4443s
Epoch: 9 cost time: 14.785964488983154
Epoch: 9, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.384 Vali Acc: 0.363 Test Loss: 2.384 Test Acc: 0.363
Validation loss decreased (-0.351152 --> -0.362507).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6898999
	speed: 0.3871s/iter; left time: 5387.1467s
Epoch: 10 cost time: 14.622618913650513
Epoch: 10, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.407 Vali Acc: 0.378 Test Loss: 2.407 Test Acc: 0.378
Validation loss decreased (-0.362507 --> -0.377510).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2332745
	speed: 0.3733s/iter; left time: 5136.4158s
Epoch: 11 cost time: 15.243764638900757
Epoch: 11, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.383 Vali Acc: 0.256 Test Loss: 2.383 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1992106
	speed: 0.3400s/iter; left time: 4626.1225s
Epoch: 12 cost time: 10.117790937423706
Epoch: 12, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.423 Vali Acc: 0.370 Test Loss: 2.423 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.4430822
	speed: 0.3297s/iter; left time: 4434.8087s
Epoch: 13 cost time: 14.691951274871826
Epoch: 13, Steps: 154 | Train Loss: 1.340 Vali Loss: 2.566 Vali Acc: 0.208 Test Loss: 2.566 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4383687
	speed: 0.3899s/iter; left time: 5184.8673s
Epoch: 14 cost time: 15.067463636398315
Epoch: 14, Steps: 154 | Train Loss: 1.332 Vali Loss: 2.475 Vali Acc: 0.368 Test Loss: 2.475 Test Acc: 0.368
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.5093274
	speed: 0.3682s/iter; left time: 4839.9575s
Epoch: 15 cost time: 14.834428548812866
Epoch: 15, Steps: 154 | Train Loss: 1.289 Vali Loss: 2.642 Vali Acc: 0.369 Test Loss: 2.642 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.3080225
	speed: 0.3503s/iter; left time: 4551.1808s
Epoch: 16 cost time: 10.366464138031006
Epoch: 16, Steps: 154 | Train Loss: 1.277 Vali Loss: 2.824 Vali Acc: 0.236 Test Loss: 2.824 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.6392758
	speed: 0.3135s/iter; left time: 4024.5544s
Epoch: 17 cost time: 14.704575300216675
Epoch: 17, Steps: 154 | Train Loss: 1.273 Vali Loss: 2.856 Vali Acc: 0.135 Test Loss: 2.856 Test Acc: 0.135
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.2737941
	speed: 0.3539s/iter; left time: 4489.1153s
Epoch: 18 cost time: 14.514370679855347
Epoch: 18, Steps: 154 | Train Loss: 1.338 Vali Loss: 2.591 Vali Acc: 0.268 Test Loss: 2.591 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.9768066
	speed: 0.3517s/iter; left time: 4406.0684s
Epoch: 19 cost time: 14.985189199447632
Epoch: 19, Steps: 154 | Train Loss: 1.259 Vali Loss: 2.736 Vali Acc: 0.210 Test Loss: 2.736 Test Acc: 0.210
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.2116231
	speed: 0.3547s/iter; left time: 4389.5823s
Epoch: 20 cost time: 14.06367015838623
Epoch: 20, Steps: 154 | Train Loss: 1.163 Vali Loss: 3.075 Vali Acc: 0.175 Test Loss: 3.075 Test Acc: 0.175
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3775344687753447
model parameter : 1186654
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2789125
	speed: 0.1155s/iter; left time: 1766.6465s
Epoch: 1 cost time: 16.23094129562378
Epoch: 1, Steps: 154 | Train Loss: 2.262 Vali Loss: 2.169 Vali Acc: 0.318 Test Loss: 2.169 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8717334
	speed: 0.3526s/iter; left time: 5340.4556s
Epoch: 2 cost time: 13.889598369598389
Epoch: 2, Steps: 154 | Train Loss: 2.017 Vali Loss: 2.155 Vali Acc: 0.325 Test Loss: 2.155 Test Acc: 0.325
Validation loss decreased (-0.317902 --> -0.325201).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7901856
	speed: 0.3526s/iter; left time: 5286.6437s
Epoch: 3 cost time: 13.711941957473755
Epoch: 3, Steps: 154 | Train Loss: 1.917 Vali Loss: 2.140 Vali Acc: 0.341 Test Loss: 2.140 Test Acc: 0.341
Validation loss decreased (-0.325201 --> -0.340611).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1542022
	speed: 0.3527s/iter; left time: 5234.2875s
Epoch: 4 cost time: 14.033524990081787
Epoch: 4, Steps: 154 | Train Loss: 1.827 Vali Loss: 2.175 Vali Acc: 0.339 Test Loss: 2.175 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9891986
	speed: 0.3001s/iter; left time: 4407.3260s
Epoch: 5 cost time: 13.22106409072876
Epoch: 5, Steps: 154 | Train Loss: 1.760 Vali Loss: 2.273 Vali Acc: 0.351 Test Loss: 2.273 Test Acc: 0.351
Validation loss decreased (-0.340611 --> -0.351153).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0423167
	speed: 0.3590s/iter; left time: 5216.4849s
Epoch: 6 cost time: 14.251274108886719
Epoch: 6, Steps: 154 | Train Loss: 1.648 Vali Loss: 2.366 Vali Acc: 0.341 Test Loss: 2.366 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7596786
	speed: 0.3631s/iter; left time: 5220.8954s
Epoch: 7 cost time: 13.645546674728394
Epoch: 7, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.445 Vali Acc: 0.356 Test Loss: 2.445 Test Acc: 0.356
Validation loss decreased (-0.351153 --> -0.355612).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2244151
	speed: 0.3586s/iter; left time: 5100.9512s
Epoch: 8 cost time: 14.53743600845337
Epoch: 8, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.324 Vali Acc: 0.367 Test Loss: 2.324 Test Acc: 0.367
Validation loss decreased (-0.355612 --> -0.367373).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6314143
	speed: 0.3477s/iter; left time: 4892.0421s
Epoch: 9 cost time: 14.490580081939697
Epoch: 9, Steps: 154 | Train Loss: 1.538 Vali Loss: 2.574 Vali Acc: 0.205 Test Loss: 2.574 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.7141665
	speed: 0.3648s/iter; left time: 5075.5687s
Epoch: 10 cost time: 13.510084390640259
Epoch: 10, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.642 Vali Acc: 0.208 Test Loss: 2.642 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.0984161
	speed: 0.3522s/iter; left time: 4846.3047s
Epoch: 11 cost time: 13.894954442977905
Epoch: 11, Steps: 154 | Train Loss: 1.392 Vali Loss: 2.610 Vali Acc: 0.211 Test Loss: 2.610 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.2372633
	speed: 0.3053s/iter; left time: 4154.2137s
Epoch: 12 cost time: 10.574290990829468
Epoch: 12, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.584 Vali Acc: 0.220 Test Loss: 2.584 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.2246234
	speed: 0.3287s/iter; left time: 4422.3110s
Epoch: 13 cost time: 13.073631048202515
Epoch: 13, Steps: 154 | Train Loss: 1.302 Vali Loss: 2.896 Vali Acc: 0.207 Test Loss: 2.896 Test Acc: 0.207
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.0092038
	speed: 0.3464s/iter; left time: 4606.9995s
Epoch: 14 cost time: 12.811995029449463
Epoch: 14, Steps: 154 | Train Loss: 1.278 Vali Loss: 2.941 Vali Acc: 0.087 Test Loss: 2.941 Test Acc: 0.087
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.1598294
	speed: 0.3461s/iter; left time: 4550.1173s
Epoch: 15 cost time: 13.334609270095825
Epoch: 15, Steps: 154 | Train Loss: 1.329 Vali Loss: 2.863 Vali Acc: 0.201 Test Loss: 2.863 Test Acc: 0.201
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.2956345
	speed: 0.3545s/iter; left time: 4605.6842s
Epoch: 16 cost time: 14.046020984649658
Epoch: 16, Steps: 154 | Train Loss: 1.228 Vali Loss: 3.347 Vali Acc: 0.087 Test Loss: 3.347 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.6074677
	speed: 0.3476s/iter; left time: 4462.7289s
Epoch: 17 cost time: 13.360562562942505
Epoch: 17, Steps: 154 | Train Loss: 1.184 Vali Loss: 3.118 Vali Acc: 0.100 Test Loss: 3.118 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.2114456
	speed: 0.3253s/iter; left time: 4126.3388s
Epoch: 18 cost time: 12.790228366851807
Epoch: 18, Steps: 154 | Train Loss: 1.163 Vali Loss: 3.540 Vali Acc: 0.087 Test Loss: 3.540 Test Acc: 0.087
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36739659367396593
model parameter : 1186654
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2293572
	speed: 0.1011s/iter; left time: 1546.9608s
Epoch: 1 cost time: 14.848552465438843
Epoch: 1, Steps: 154 | Train Loss: 2.237 Vali Loss: 2.150 Vali Acc: 0.318 Test Loss: 2.150 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7823040
	speed: 0.3362s/iter; left time: 5091.8313s
Epoch: 2 cost time: 12.046555042266846
Epoch: 2, Steps: 154 | Train Loss: 2.001 Vali Loss: 2.234 Vali Acc: 0.325 Test Loss: 2.234 Test Acc: 0.325
Validation loss decreased (-0.317902 --> -0.325201).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7809137
	speed: 0.3374s/iter; left time: 5058.9489s
Epoch: 3 cost time: 12.27572774887085
Epoch: 3, Steps: 154 | Train Loss: 1.860 Vali Loss: 2.329 Vali Acc: 0.343 Test Loss: 2.329 Test Acc: 0.343
Validation loss decreased (-0.325201 --> -0.342637).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0117455
	speed: 0.3307s/iter; left time: 4907.9684s
Epoch: 4 cost time: 12.391895771026611
Epoch: 4, Steps: 154 | Train Loss: 1.737 Vali Loss: 2.213 Vali Acc: 0.350 Test Loss: 2.213 Test Acc: 0.350
Validation loss decreased (-0.342637 --> -0.349937).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9957787
	speed: 0.3382s/iter; left time: 4967.0288s
Epoch: 5 cost time: 12.152214527130127
Epoch: 5, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.500 Vali Acc: 0.358 Test Loss: 2.500 Test Acc: 0.358
Validation loss decreased (-0.349937 --> -0.358045).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9756454
	speed: 0.3115s/iter; left time: 4526.1658s
Epoch: 6 cost time: 8.948526620864868
Epoch: 6, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.409 Vali Acc: 0.351 Test Loss: 2.409 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6094509
	speed: 0.3102s/iter; left time: 4459.7042s
Epoch: 7 cost time: 12.037823915481567
Epoch: 7, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.560 Vali Acc: 0.354 Test Loss: 2.560 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.7996004
	speed: 0.3123s/iter; left time: 4442.0782s
Epoch: 8 cost time: 12.026666402816772
Epoch: 8, Steps: 154 | Train Loss: 1.473 Vali Loss: 2.131 Vali Acc: 0.371 Test Loss: 2.131 Test Acc: 0.371
Validation loss decreased (-0.358045 --> -0.371025).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9016089
	speed: 0.3251s/iter; left time: 4573.7825s
Epoch: 9 cost time: 11.92960500717163
Epoch: 9, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.418 Vali Acc: 0.264 Test Loss: 2.418 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1616473
	speed: 0.3225s/iter; left time: 4487.6979s
Epoch: 10 cost time: 12.153233289718628
Epoch: 10, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.207 Vali Acc: 0.382 Test Loss: 2.207 Test Acc: 0.382
Validation loss decreased (-0.371025 --> -0.381568).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0811292
	speed: 0.3122s/iter; left time: 4295.8937s
Epoch: 11 cost time: 11.758193492889404
Epoch: 11, Steps: 154 | Train Loss: 1.322 Vali Loss: 2.194 Vali Acc: 0.376 Test Loss: 2.194 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0039098
	speed: 0.2480s/iter; left time: 3374.4869s
Epoch: 12 cost time: 9.663013458251953
Epoch: 12, Steps: 154 | Train Loss: 1.270 Vali Loss: 2.470 Vali Acc: 0.374 Test Loss: 2.470 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0103188
	speed: 0.3041s/iter; left time: 4091.1746s
Epoch: 13 cost time: 10.839740753173828
Epoch: 13, Steps: 154 | Train Loss: 1.274 Vali Loss: 2.812 Vali Acc: 0.209 Test Loss: 2.812 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.9803556
	speed: 0.3001s/iter; left time: 3990.7897s
Epoch: 14 cost time: 12.359015464782715
Epoch: 14, Steps: 154 | Train Loss: 1.216 Vali Loss: 2.599 Vali Acc: 0.209 Test Loss: 2.599 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.2982758
	speed: 0.3102s/iter; left time: 4077.3138s
Epoch: 15 cost time: 11.547058820724487
Epoch: 15, Steps: 154 | Train Loss: 1.245 Vali Loss: 2.430 Vali Acc: 0.387 Test Loss: 2.430 Test Acc: 0.387
Validation loss decreased (-0.381568 --> -0.386837).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.0758313
	speed: 0.2508s/iter; left time: 3257.7459s
Epoch: 16 cost time: 10.44866681098938
Epoch: 16, Steps: 154 | Train Loss: 1.162 Vali Loss: 2.553 Vali Acc: 0.369 Test Loss: 2.553 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.2701712
	speed: 0.3081s/iter; left time: 3954.9935s
Epoch: 17 cost time: 11.748944282531738
Epoch: 17, Steps: 154 | Train Loss: 1.115 Vali Loss: 2.552 Vali Acc: 0.157 Test Loss: 2.552 Test Acc: 0.157
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.9233048
	speed: 0.3039s/iter; left time: 3854.0849s
Epoch: 18 cost time: 11.791853427886963
Epoch: 18, Steps: 154 | Train Loss: 1.095 Vali Loss: 2.727 Vali Acc: 0.270 Test Loss: 2.727 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.8013658
	speed: 0.3142s/iter; left time: 3936.5852s
Epoch: 19 cost time: 11.374973058700562
Epoch: 19, Steps: 154 | Train Loss: 1.090 Vali Loss: 2.576 Vali Acc: 0.373 Test Loss: 2.576 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.9246425
	speed: 0.3106s/iter; left time: 3843.2982s
Epoch: 20 cost time: 10.395889282226562
Epoch: 20, Steps: 154 | Train Loss: 1.110 Vali Loss: 3.091 Vali Acc: 0.116 Test Loss: 3.091 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.8790868
	speed: 0.2764s/iter; left time: 3378.1245s
Epoch: 21 cost time: 12.596033096313477
Epoch: 21, Steps: 154 | Train Loss: 0.999 Vali Loss: 3.007 Vali Acc: 0.219 Test Loss: 3.007 Test Acc: 0.219
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.5618083
	speed: 0.3259s/iter; left time: 3932.0879s
Epoch: 22 cost time: 12.039374589920044
Epoch: 22, Steps: 154 | Train Loss: 1.023 Vali Loss: 3.464 Vali Acc: 0.104 Test Loss: 3.464 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.8619336
	speed: 0.3298s/iter; left time: 3928.4652s
Epoch: 23 cost time: 12.014223575592041
Epoch: 23, Steps: 154 | Train Loss: 1.066 Vali Loss: 3.223 Vali Acc: 0.216 Test Loss: 3.223 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.6437614
	speed: 0.3194s/iter; left time: 3755.5197s
Epoch: 24 cost time: 12.503705263137817
Epoch: 24, Steps: 154 | Train Loss: 1.096 Vali Loss: 3.342 Vali Acc: 0.356 Test Loss: 3.342 Test Acc: 0.356
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.1128931
	speed: 0.2560s/iter; left time: 2970.5410s
Epoch: 25 cost time: 8.894383430480957
Epoch: 25, Steps: 154 | Train Loss: 1.108 Vali Loss: 3.399 Vali Acc: 0.099 Test Loss: 3.399 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38686131386861317
model parameter : 1186654
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0214036
	speed: 0.1048s/iter; left time: 1603.0985s
Epoch: 1 cost time: 15.63881254196167
Epoch: 1, Steps: 154 | Train Loss: 2.248 Vali Loss: 2.122 Vali Acc: 0.318 Test Loss: 2.122 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1304820
	speed: 0.3383s/iter; left time: 5124.7588s
Epoch: 2 cost time: 12.142279386520386
Epoch: 2, Steps: 154 | Train Loss: 2.046 Vali Loss: 2.199 Vali Acc: 0.320 Test Loss: 2.199 Test Acc: 0.320
Validation loss decreased (-0.318308 --> -0.319929).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1111307
	speed: 0.3204s/iter; left time: 4803.1773s
Epoch: 3 cost time: 12.716839075088501
Epoch: 3, Steps: 154 | Train Loss: 1.955 Vali Loss: 2.146 Vali Acc: 0.326 Test Loss: 2.146 Test Acc: 0.326
Validation loss decreased (-0.319929 --> -0.326013).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4100556
	speed: 0.3211s/iter; left time: 4764.8528s
Epoch: 4 cost time: 13.654517412185669
Epoch: 4, Steps: 154 | Train Loss: 1.902 Vali Loss: 2.140 Vali Acc: 0.334 Test Loss: 2.140 Test Acc: 0.334
Validation loss decreased (-0.326013 --> -0.333717).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5315698
	speed: 0.3122s/iter; left time: 4585.2408s
Epoch: 5 cost time: 11.92850112915039
Epoch: 5, Steps: 154 | Train Loss: 1.818 Vali Loss: 2.212 Vali Acc: 0.347 Test Loss: 2.212 Test Acc: 0.347
Validation loss decreased (-0.333717 --> -0.346693).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6035452
	speed: 0.3123s/iter; left time: 4537.4785s
Epoch: 6 cost time: 11.824063062667847
Epoch: 6, Steps: 154 | Train Loss: 1.692 Vali Loss: 2.465 Vali Acc: 0.348 Test Loss: 2.465 Test Acc: 0.348
Validation loss decreased (-0.346693 --> -0.347907).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6644397
	speed: 0.3216s/iter; left time: 4622.9632s
Epoch: 7 cost time: 12.299420595169067
Epoch: 7, Steps: 154 | Train Loss: 1.665 Vali Loss: 2.636 Vali Acc: 0.276 Test Loss: 2.636 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1820800
	speed: 0.3186s/iter; left time: 4531.6759s
Epoch: 8 cost time: 13.049928665161133
Epoch: 8, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.474 Vali Acc: 0.358 Test Loss: 2.474 Test Acc: 0.358
Validation loss decreased (-0.347907 --> -0.358451).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9462783
	speed: 0.3128s/iter; left time: 4400.6532s
Epoch: 9 cost time: 10.815898418426514
Epoch: 9, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.398 Vali Acc: 0.350 Test Loss: 2.398 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.7591116
	speed: 0.2451s/iter; left time: 3410.6797s
Epoch: 10 cost time: 12.362380504608154
Epoch: 10, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.435 Vali Acc: 0.360 Test Loss: 2.435 Test Acc: 0.360
Validation loss decreased (-0.358451 --> -0.359667).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6630543
	speed: 0.3248s/iter; left time: 4469.2170s
Epoch: 11 cost time: 13.159418106079102
Epoch: 11, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.875 Vali Acc: 0.077 Test Loss: 2.875 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2257321
	speed: 0.3137s/iter; left time: 4268.1023s
Epoch: 12 cost time: 12.178861856460571
Epoch: 12, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.742 Vali Acc: 0.200 Test Loss: 2.742 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.1313586
	speed: 0.3053s/iter; left time: 4107.0171s
Epoch: 13 cost time: 12.826172828674316
Epoch: 13, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.818 Vali Acc: 0.138 Test Loss: 2.818 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.7444295
	speed: 0.3240s/iter; left time: 4309.0825s
Epoch: 14 cost time: 12.249417066574097
Epoch: 14, Steps: 154 | Train Loss: 1.368 Vali Loss: 2.851 Vali Acc: 0.076 Test Loss: 2.851 Test Acc: 0.076
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.4545417
	speed: 0.3302s/iter; left time: 4341.0988s
Epoch: 15 cost time: 12.912708520889282
Epoch: 15, Steps: 154 | Train Loss: 1.383 Vali Loss: 2.576 Vali Acc: 0.200 Test Loss: 2.576 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.2301550
	speed: 0.2705s/iter; left time: 3513.6175s
Epoch: 16 cost time: 11.123284101486206
Epoch: 16, Steps: 154 | Train Loss: 1.297 Vali Loss: 2.952 Vali Acc: 0.199 Test Loss: 2.952 Test Acc: 0.199
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 3.2715886
	speed: 0.3191s/iter; left time: 4096.3608s
Epoch: 17 cost time: 12.284787654876709
Epoch: 17, Steps: 154 | Train Loss: 1.318 Vali Loss: 3.018 Vali Acc: 0.200 Test Loss: 3.018 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.4419134
	speed: 0.3094s/iter; left time: 3924.2659s
Epoch: 18 cost time: 12.692256689071655
Epoch: 18, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.897 Vali Acc: 0.200 Test Loss: 2.897 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 2.1455698
	speed: 0.3131s/iter; left time: 3923.2429s
Epoch: 19 cost time: 12.661561489105225
Epoch: 19, Steps: 154 | Train Loss: 1.224 Vali Loss: 3.228 Vali Acc: 0.205 Test Loss: 3.228 Test Acc: 0.205
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.3802118
	speed: 0.3173s/iter; left time: 3926.9390s
Epoch: 20 cost time: 11.967917442321777
Epoch: 20, Steps: 154 | Train Loss: 1.219 Vali Loss: 3.303 Vali Acc: 0.080 Test Loss: 3.303 Test Acc: 0.080
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3596918085969181
model parameter : 662366
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9844930
	speed: 0.1072s/iter; left time: 1639.6538s
Epoch: 1 cost time: 15.813063859939575
Epoch: 1, Steps: 154 | Train Loss: 2.240 Vali Loss: 2.121 Vali Acc: 0.318 Test Loss: 2.121 Test Acc: 0.318
Validation loss decreased (inf --> -0.317903).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1323411
	speed: 0.3511s/iter; left time: 5318.7503s
Epoch: 2 cost time: 13.647045135498047
Epoch: 2, Steps: 154 | Train Loss: 2.056 Vali Loss: 2.195 Vali Acc: 0.320 Test Loss: 2.195 Test Acc: 0.320
Validation loss decreased (-0.317903 --> -0.319929).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1566281
	speed: 0.3531s/iter; left time: 5293.4992s
Epoch: 3 cost time: 13.400501728057861
Epoch: 3, Steps: 154 | Train Loss: 1.960 Vali Loss: 2.151 Vali Acc: 0.328 Test Loss: 2.151 Test Acc: 0.328
Validation loss decreased (-0.319929 --> -0.327635).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4473329
	speed: 0.3387s/iter; left time: 5025.8018s
Epoch: 4 cost time: 13.628146171569824
Epoch: 4, Steps: 154 | Train Loss: 1.868 Vali Loss: 2.208 Vali Acc: 0.340 Test Loss: 2.208 Test Acc: 0.340
Validation loss decreased (-0.327635 --> -0.340205).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5516044
	speed: 0.3395s/iter; left time: 4985.6115s
Epoch: 5 cost time: 13.58556056022644
Epoch: 5, Steps: 154 | Train Loss: 1.786 Vali Loss: 2.192 Vali Acc: 0.352 Test Loss: 2.192 Test Acc: 0.352
Validation loss decreased (-0.340205 --> -0.351560).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5355390
	speed: 0.3413s/iter; left time: 4958.9391s
Epoch: 6 cost time: 13.912108898162842
Epoch: 6, Steps: 154 | Train Loss: 1.663 Vali Loss: 2.367 Vali Acc: 0.354 Test Loss: 2.367 Test Acc: 0.354
Validation loss decreased (-0.351560 --> -0.353585).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5108385
	speed: 0.3251s/iter; left time: 4673.5960s
Epoch: 7 cost time: 11.833211183547974
Epoch: 7, Steps: 154 | Train Loss: 1.653 Vali Loss: 2.626 Vali Acc: 0.356 Test Loss: 2.626 Test Acc: 0.356
Validation loss decreased (-0.353585 --> -0.356016).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1432571
	speed: 0.3321s/iter; left time: 4723.3053s
Epoch: 8 cost time: 12.980257272720337
Epoch: 8, Steps: 154 | Train Loss: 1.572 Vali Loss: 2.522 Vali Acc: 0.361 Test Loss: 2.522 Test Acc: 0.361
Validation loss decreased (-0.356016 --> -0.360478).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9555156
	speed: 0.3432s/iter; left time: 4828.9866s
Epoch: 9 cost time: 13.697628259658813
Epoch: 9, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.513 Vali Acc: 0.349 Test Loss: 2.513 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.9542838
	speed: 0.2830s/iter; left time: 3938.0168s
Epoch: 10 cost time: 11.954103469848633
Epoch: 10, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.582 Vali Acc: 0.346 Test Loss: 2.582 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4129437
	speed: 0.3410s/iter; left time: 4691.8228s
Epoch: 11 cost time: 12.932565212249756
Epoch: 11, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.602 Vali Acc: 0.367 Test Loss: 2.602 Test Acc: 0.367
Validation loss decreased (-0.360478 --> -0.366965).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2851515
	speed: 0.3372s/iter; left time: 4588.0422s
Epoch: 12 cost time: 12.884958982467651
Epoch: 12, Steps: 154 | Train Loss: 1.397 Vali Loss: 2.667 Vali Acc: 0.191 Test Loss: 2.667 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5446866
	speed: 0.3306s/iter; left time: 4447.5832s
Epoch: 13 cost time: 13.000671625137329
Epoch: 13, Steps: 154 | Train Loss: 1.376 Vali Loss: 2.778 Vali Acc: 0.082 Test Loss: 2.778 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2619611
	speed: 0.3182s/iter; left time: 4232.0206s
Epoch: 14 cost time: 13.176948070526123
Epoch: 14, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.864 Vali Acc: 0.080 Test Loss: 2.864 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.3045743
	speed: 0.3351s/iter; left time: 4404.9148s
Epoch: 15 cost time: 12.733131885528564
Epoch: 15, Steps: 154 | Train Loss: 1.396 Vali Loss: 2.696 Vali Acc: 0.201 Test Loss: 2.696 Test Acc: 0.201
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.3516529
	speed: 0.3022s/iter; left time: 3926.2006s
Epoch: 16 cost time: 9.390896081924438
Epoch: 16, Steps: 154 | Train Loss: 1.259 Vali Loss: 2.765 Vali Acc: 0.270 Test Loss: 2.765 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.2071021
	speed: 0.2473s/iter; left time: 3175.0693s
Epoch: 17 cost time: 12.61633563041687
Epoch: 17, Steps: 154 | Train Loss: 1.252 Vali Loss: 2.877 Vali Acc: 0.202 Test Loss: 2.877 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.4311906
	speed: 0.3261s/iter; left time: 4135.4369s
Epoch: 18 cost time: 11.9023118019104
Epoch: 18, Steps: 154 | Train Loss: 1.239 Vali Loss: 2.944 Vali Acc: 0.201 Test Loss: 2.944 Test Acc: 0.201
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.7145644
	speed: 0.3287s/iter; left time: 4117.9998s
Epoch: 19 cost time: 12.384149074554443
Epoch: 19, Steps: 154 | Train Loss: 1.220 Vali Loss: 3.042 Vali Acc: 0.200 Test Loss: 3.042 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.4345672
	speed: 0.3227s/iter; left time: 3993.0043s
Epoch: 20 cost time: 13.68886113166809
Epoch: 20, Steps: 154 | Train Loss: 1.209 Vali Loss: 3.710 Vali Acc: 0.079 Test Loss: 3.710 Test Acc: 0.079
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.9068952
	speed: 0.3227s/iter; left time: 3943.5799s
Epoch: 21 cost time: 10.57413101196289
Epoch: 21, Steps: 154 | Train Loss: 1.149 Vali Loss: 3.151 Vali Acc: 0.174 Test Loss: 3.151 Test Acc: 0.174
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36699107866991076
model parameter : 662366
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9978391
	speed: 0.0930s/iter; left time: 1423.2313s
Epoch: 1 cost time: 13.392281293869019
Epoch: 1, Steps: 154 | Train Loss: 2.236 Vali Loss: 2.121 Vali Acc: 0.319 Test Loss: 2.121 Test Acc: 0.319
Validation loss decreased (inf --> -0.319119).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1418962
	speed: 0.3049s/iter; left time: 4617.5698s
Epoch: 2 cost time: 11.131970643997192
Epoch: 2, Steps: 154 | Train Loss: 2.038 Vali Loss: 2.205 Vali Acc: 0.321 Test Loss: 2.205 Test Acc: 0.321
Validation loss decreased (-0.319119 --> -0.320740).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3767335
	speed: 0.3054s/iter; left time: 4578.1854s
Epoch: 3 cost time: 11.53610873222351
Epoch: 3, Steps: 154 | Train Loss: 1.940 Vali Loss: 2.163 Vali Acc: 0.330 Test Loss: 2.163 Test Acc: 0.330
Validation loss decreased (-0.320740 --> -0.330473).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3417091
	speed: 0.2989s/iter; left time: 4435.5252s
Epoch: 4 cost time: 12.357411623001099
Epoch: 4, Steps: 154 | Train Loss: 1.828 Vali Loss: 2.230 Vali Acc: 0.339 Test Loss: 2.230 Test Acc: 0.339
Validation loss decreased (-0.330473 --> -0.339394).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3092879
	speed: 0.3121s/iter; left time: 4583.7850s
Epoch: 5 cost time: 11.455730438232422
Epoch: 5, Steps: 154 | Train Loss: 1.729 Vali Loss: 2.235 Vali Acc: 0.351 Test Loss: 2.235 Test Acc: 0.351
Validation loss decreased (-0.339394 --> -0.350748).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4936736
	speed: 0.3163s/iter; left time: 4596.4720s
Epoch: 6 cost time: 12.014188051223755
Epoch: 6, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.345 Vali Acc: 0.352 Test Loss: 2.345 Test Acc: 0.352
Validation loss decreased (-0.350748 --> -0.352369).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6888137
	speed: 0.2445s/iter; left time: 3515.1736s
Epoch: 7 cost time: 10.307918787002563
Epoch: 7, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.507 Vali Acc: 0.267 Test Loss: 2.507 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1418459
	speed: 0.3340s/iter; left time: 4750.3991s
Epoch: 8 cost time: 13.898123741149902
Epoch: 8, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.412 Vali Acc: 0.349 Test Loss: 2.412 Test Acc: 0.349
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.8088627
	speed: 0.3518s/iter; left time: 4949.2028s
Epoch: 9 cost time: 13.310060501098633
Epoch: 9, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.289 Vali Acc: 0.356 Test Loss: 2.289 Test Acc: 0.356
Validation loss decreased (-0.352369 --> -0.356019).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0317813
	speed: 0.3459s/iter; left time: 4812.6830s
Epoch: 10 cost time: 13.616635799407959
Epoch: 10, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.392 Vali Acc: 0.365 Test Loss: 2.392 Test Acc: 0.365
Validation loss decreased (-0.356019 --> -0.364534).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4660903
	speed: 0.3388s/iter; left time: 4662.7790s
Epoch: 11 cost time: 13.191413640975952
Epoch: 11, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.415 Vali Acc: 0.360 Test Loss: 2.415 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0954721
	speed: 0.3127s/iter; left time: 4254.4790s
Epoch: 12 cost time: 8.843626976013184
Epoch: 12, Steps: 154 | Train Loss: 1.336 Vali Loss: 2.734 Vali Acc: 0.191 Test Loss: 2.734 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2010227
	speed: 0.3121s/iter; left time: 4198.6327s
Epoch: 13 cost time: 13.166527032852173
Epoch: 13, Steps: 154 | Train Loss: 1.441 Vali Loss: 2.661 Vali Acc: 0.179 Test Loss: 2.661 Test Acc: 0.179
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.1069297
	speed: 0.3321s/iter; left time: 4417.2057s
Epoch: 14 cost time: 13.174209833145142
Epoch: 14, Steps: 154 | Train Loss: 1.323 Vali Loss: 2.929 Vali Acc: 0.111 Test Loss: 2.929 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.2829417
	speed: 0.3486s/iter; left time: 4582.3765s
Epoch: 15 cost time: 12.617346286773682
Epoch: 15, Steps: 154 | Train Loss: 1.261 Vali Loss: 2.729 Vali Acc: 0.201 Test Loss: 2.729 Test Acc: 0.201
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.3020408
	speed: 0.3493s/iter; left time: 4537.4953s
Epoch: 16 cost time: 13.560932874679565
Epoch: 16, Steps: 154 | Train Loss: 1.254 Vali Loss: 2.942 Vali Acc: 0.200 Test Loss: 2.942 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.0552945
	speed: 0.2815s/iter; left time: 3614.1725s
Epoch: 17 cost time: 13.657886266708374
Epoch: 17, Steps: 154 | Train Loss: 1.188 Vali Loss: 2.730 Vali Acc: 0.203 Test Loss: 2.730 Test Acc: 0.203
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.1721635
	speed: 0.3340s/iter; left time: 4236.6585s
Epoch: 18 cost time: 13.075484991073608
Epoch: 18, Steps: 154 | Train Loss: 1.196 Vali Loss: 3.115 Vali Acc: 0.203 Test Loss: 3.115 Test Acc: 0.203
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.8443390
	speed: 0.3331s/iter; left time: 4173.9458s
Epoch: 19 cost time: 12.786248922348022
Epoch: 19, Steps: 154 | Train Loss: 1.138 Vali Loss: 3.355 Vali Acc: 0.195 Test Loss: 3.355 Test Acc: 0.195
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.0813780
	speed: 0.3360s/iter; left time: 4158.0106s
Epoch: 20 cost time: 13.574951887130737
Epoch: 20, Steps: 154 | Train Loss: 1.166 Vali Loss: 3.337 Vali Acc: 0.132 Test Loss: 3.337 Test Acc: 0.132
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36455798864557987
model parameter : 662366
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0299230
	speed: 0.0880s/iter; left time: 1346.9955s
Epoch: 1 cost time: 12.941899538040161
Epoch: 1, Steps: 154 | Train Loss: 2.202 Vali Loss: 2.120 Vali Acc: 0.319 Test Loss: 2.120 Test Acc: 0.319
Validation loss decreased (inf --> -0.318714).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1207874
	speed: 0.3038s/iter; left time: 4602.0906s
Epoch: 2 cost time: 9.793737411499023
Epoch: 2, Steps: 154 | Train Loss: 2.000 Vali Loss: 2.384 Vali Acc: 0.324 Test Loss: 2.384 Test Acc: 0.324
Validation loss decreased (-0.318714 --> -0.323577).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1076355
	speed: 0.2588s/iter; left time: 3879.5656s
Epoch: 3 cost time: 10.92495584487915
Epoch: 3, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.473 Vali Acc: 0.335 Test Loss: 2.473 Test Acc: 0.335
Validation loss decreased (-0.323577 --> -0.334931).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2966208
	speed: 0.3041s/iter; left time: 4512.1956s
Epoch: 4 cost time: 11.18339991569519
Epoch: 4, Steps: 154 | Train Loss: 1.765 Vali Loss: 2.523 Vali Acc: 0.341 Test Loss: 2.523 Test Acc: 0.341
Validation loss decreased (-0.334931 --> -0.340607).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3338927
	speed: 0.2994s/iter; left time: 4397.0526s
Epoch: 5 cost time: 12.183525562286377
Epoch: 5, Steps: 154 | Train Loss: 1.646 Vali Loss: 2.435 Vali Acc: 0.353 Test Loss: 2.435 Test Acc: 0.353
Validation loss decreased (-0.340607 --> -0.352774).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5967833
	speed: 0.3162s/iter; left time: 4595.0458s
Epoch: 6 cost time: 11.568419218063354
Epoch: 6, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.397 Vali Acc: 0.357 Test Loss: 2.397 Test Acc: 0.357
Validation loss decreased (-0.352774 --> -0.357235).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5067281
	speed: 0.2872s/iter; left time: 4128.3816s
Epoch: 7 cost time: 8.560443878173828
Epoch: 7, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.429 Vali Acc: 0.358 Test Loss: 2.429 Test Acc: 0.358
Validation loss decreased (-0.357235 --> -0.357640).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0494660
	speed: 0.2848s/iter; left time: 4051.1300s
Epoch: 8 cost time: 11.26114797592163
Epoch: 8, Steps: 154 | Train Loss: 1.448 Vali Loss: 2.389 Vali Acc: 0.367 Test Loss: 2.389 Test Acc: 0.367
Validation loss decreased (-0.357640 --> -0.367373).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6767126
	speed: 0.2926s/iter; left time: 4116.5933s
Epoch: 9 cost time: 11.744702339172363
Epoch: 9, Steps: 154 | Train Loss: 1.412 Vali Loss: 2.264 Vali Acc: 0.358 Test Loss: 2.264 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3400786
	speed: 0.3102s/iter; left time: 4316.2424s
Epoch: 10 cost time: 11.541330099105835
Epoch: 10, Steps: 154 | Train Loss: 1.362 Vali Loss: 2.301 Vali Acc: 0.369 Test Loss: 2.301 Test Acc: 0.369
Validation loss decreased (-0.367373 --> -0.369401).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7800955
	speed: 0.3124s/iter; left time: 4299.0446s
Epoch: 11 cost time: 11.065239191055298
Epoch: 11, Steps: 154 | Train Loss: 1.331 Vali Loss: 2.540 Vali Acc: 0.223 Test Loss: 2.540 Test Acc: 0.223
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3828701
	speed: 0.3092s/iter; left time: 4207.0316s
Epoch: 12 cost time: 11.753073930740356
Epoch: 12, Steps: 154 | Train Loss: 1.278 Vali Loss: 2.636 Vali Acc: 0.207 Test Loss: 2.636 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.1553162
	speed: 0.3084s/iter; left time: 4149.4010s
Epoch: 13 cost time: 11.422016382217407
Epoch: 13, Steps: 154 | Train Loss: 1.241 Vali Loss: 2.374 Vali Acc: 0.393 Test Loss: 2.374 Test Acc: 0.393
Validation loss decreased (-0.369401 --> -0.392920).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3161287
	speed: 0.2512s/iter; left time: 3340.8249s
Epoch: 14 cost time: 11.159008026123047
Epoch: 14, Steps: 154 | Train Loss: 1.275 Vali Loss: 2.557 Vali Acc: 0.379 Test Loss: 2.557 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.2517526
	speed: 0.3060s/iter; left time: 4022.5739s
Epoch: 15 cost time: 10.683638095855713
Epoch: 15, Steps: 154 | Train Loss: 1.249 Vali Loss: 2.660 Vali Acc: 0.253 Test Loss: 2.660 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0383624
	speed: 0.3088s/iter; left time: 4012.1811s
Epoch: 16 cost time: 11.430891990661621
Epoch: 16, Steps: 154 | Train Loss: 1.179 Vali Loss: 2.726 Vali Acc: 0.226 Test Loss: 2.726 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.1402946
	speed: 0.3048s/iter; left time: 3912.5551s
Epoch: 17 cost time: 11.066519498825073
Epoch: 17, Steps: 154 | Train Loss: 1.110 Vali Loss: 2.849 Vali Acc: 0.206 Test Loss: 2.849 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.2151623
	speed: 0.3009s/iter; left time: 3816.8933s
Epoch: 18 cost time: 11.125289678573608
Epoch: 18, Steps: 154 | Train Loss: 1.099 Vali Loss: 2.682 Vali Acc: 0.224 Test Loss: 2.682 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.6744885
	speed: 0.2444s/iter; left time: 3062.6617s
Epoch: 19 cost time: 10.189164400100708
Epoch: 19, Steps: 154 | Train Loss: 1.037 Vali Loss: 2.965 Vali Acc: 0.220 Test Loss: 2.965 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.0744252
	speed: 0.2911s/iter; left time: 3602.5737s
Epoch: 20 cost time: 11.091374635696411
Epoch: 20, Steps: 154 | Train Loss: 1.049 Vali Loss: 2.707 Vali Acc: 0.251 Test Loss: 2.707 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.6115844
	speed: 0.2944s/iter; left time: 3598.2912s
Epoch: 21 cost time: 10.955854177474976
Epoch: 21, Steps: 154 | Train Loss: 1.025 Vali Loss: 2.903 Vali Acc: 0.214 Test Loss: 2.903 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.8907371
	speed: 0.3088s/iter; left time: 3726.0584s
Epoch: 22 cost time: 11.082713603973389
Epoch: 22, Steps: 154 | Train Loss: 1.059 Vali Loss: 2.944 Vali Acc: 0.221 Test Loss: 2.944 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.9071791
	speed: 0.2916s/iter; left time: 3474.2579s
Epoch: 23 cost time: 9.06374979019165
Epoch: 23, Steps: 154 | Train Loss: 1.002 Vali Loss: 3.228 Vali Acc: 0.210 Test Loss: 3.228 Test Acc: 0.210
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3929440389294404
model parameter : 662366
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9381840
	speed: 0.0998s/iter; left time: 1526.5933s
Epoch: 1 cost time: 14.683174848556519
Epoch: 1, Steps: 154 | Train Loss: 2.253 Vali Loss: 2.184 Vali Acc: 0.318 Test Loss: 2.184 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7079284
	speed: 0.3054s/iter; left time: 4626.5690s
Epoch: 2 cost time: 12.221930265426636
Epoch: 2, Steps: 154 | Train Loss: 2.068 Vali Loss: 2.164 Vali Acc: 0.322 Test Loss: 2.164 Test Acc: 0.322
Validation loss decreased (-0.317902 --> -0.321552).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9285555
	speed: 0.3063s/iter; left time: 4591.6555s
Epoch: 3 cost time: 11.129453182220459
Epoch: 3, Steps: 154 | Train Loss: 1.961 Vali Loss: 2.144 Vali Acc: 0.325 Test Loss: 2.144 Test Acc: 0.325
Validation loss decreased (-0.321552 --> -0.324796).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1801183
	speed: 0.2745s/iter; left time: 4072.9815s
Epoch: 4 cost time: 9.078308820724487
Epoch: 4, Steps: 154 | Train Loss: 1.901 Vali Loss: 2.196 Vali Acc: 0.327 Test Loss: 2.196 Test Acc: 0.327
Validation loss decreased (-0.324796 --> -0.327229).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8209043
	speed: 0.3090s/iter; left time: 4537.1787s
Epoch: 5 cost time: 12.037415266036987
Epoch: 5, Steps: 154 | Train Loss: 1.831 Vali Loss: 2.267 Vali Acc: 0.329 Test Loss: 2.267 Test Acc: 0.329
Validation loss decreased (-0.327229 --> -0.328850).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8231983
	speed: 0.2931s/iter; left time: 4259.6637s
Epoch: 6 cost time: 11.156963348388672
Epoch: 6, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.395 Vali Acc: 0.341 Test Loss: 2.395 Test Acc: 0.341
Validation loss decreased (-0.328850 --> -0.341420).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9771335
	speed: 0.3038s/iter; left time: 4367.3913s
Epoch: 7 cost time: 12.390701293945312
Epoch: 7, Steps: 154 | Train Loss: 1.730 Vali Loss: 2.362 Vali Acc: 0.350 Test Loss: 2.362 Test Acc: 0.350
Validation loss decreased (-0.341420 --> -0.349530).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6643469
	speed: 0.3111s/iter; left time: 4424.8704s
Epoch: 8 cost time: 12.606298208236694
Epoch: 8, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.440 Vali Acc: 0.372 Test Loss: 2.440 Test Acc: 0.372
Validation loss decreased (-0.349530 --> -0.371833).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4433641
	speed: 0.3135s/iter; left time: 4410.4801s
Epoch: 9 cost time: 12.399900197982788
Epoch: 9, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.530 Vali Acc: 0.356 Test Loss: 2.530 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2012358
	speed: 0.2785s/iter; left time: 3875.3370s
Epoch: 10 cost time: 8.698551177978516
Epoch: 10, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.964 Vali Acc: 0.086 Test Loss: 2.964 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.1689219
	speed: 0.3078s/iter; left time: 4235.6613s
Epoch: 11 cost time: 12.57284927368164
Epoch: 11, Steps: 154 | Train Loss: 1.561 Vali Loss: 2.712 Vali Acc: 0.356 Test Loss: 2.712 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.5890400
	speed: 0.3084s/iter; left time: 4196.7537s
Epoch: 12 cost time: 12.56587266921997
Epoch: 12, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.991 Vali Acc: 0.076 Test Loss: 2.991 Test Acc: 0.076
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.6986020
	speed: 0.3074s/iter; left time: 4134.8448s
Epoch: 13 cost time: 11.992642402648926
Epoch: 13, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.920 Vali Acc: 0.191 Test Loss: 2.920 Test Acc: 0.191
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.2091206
	speed: 0.3097s/iter; left time: 4118.8202s
Epoch: 14 cost time: 11.799700498580933
Epoch: 14, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.999 Vali Acc: 0.072 Test Loss: 2.999 Test Acc: 0.072
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.0752977
	speed: 0.2551s/iter; left time: 3352.6943s
Epoch: 15 cost time: 11.392048835754395
Epoch: 15, Steps: 154 | Train Loss: 1.399 Vali Loss: 3.078 Vali Acc: 0.195 Test Loss: 3.078 Test Acc: 0.195
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.2647076
	speed: 0.2798s/iter; left time: 3635.2465s
Epoch: 16 cost time: 11.921773433685303
Epoch: 16, Steps: 154 | Train Loss: 1.348 Vali Loss: 2.800 Vali Acc: 0.194 Test Loss: 2.800 Test Acc: 0.194
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.2937242
	speed: 0.3024s/iter; left time: 3882.2307s
Epoch: 17 cost time: 11.387399673461914
Epoch: 17, Steps: 154 | Train Loss: 1.329 Vali Loss: 2.914 Vali Acc: 0.206 Test Loss: 2.914 Test Acc: 0.206
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.5592856
	speed: 0.2920s/iter; left time: 3703.5828s
Epoch: 18 cost time: 11.802047729492188
Epoch: 18, Steps: 154 | Train Loss: 1.273 Vali Loss: 3.712 Vali Acc: 0.064 Test Loss: 3.712 Test Acc: 0.064
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3718572587185726
model parameter : 400222
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9188225
	speed: 0.0888s/iter; left time: 1358.1559s
Epoch: 1 cost time: 13.186617374420166
Epoch: 1, Steps: 154 | Train Loss: 2.257 Vali Loss: 2.186 Vali Acc: 0.318 Test Loss: 2.186 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6973190
	speed: 0.2941s/iter; left time: 4455.1836s
Epoch: 2 cost time: 10.952598571777344
Epoch: 2, Steps: 154 | Train Loss: 2.072 Vali Loss: 2.162 Vali Acc: 0.322 Test Loss: 2.162 Test Acc: 0.322
Validation loss decreased (-0.317902 --> -0.321552).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9084640
	speed: 0.2950s/iter; left time: 4423.6487s
Epoch: 3 cost time: 11.355829238891602
Epoch: 3, Steps: 154 | Train Loss: 1.957 Vali Loss: 2.154 Vali Acc: 0.325 Test Loss: 2.154 Test Acc: 0.325
Validation loss decreased (-0.321552 --> -0.325201).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1443455
	speed: 0.2913s/iter; left time: 4322.2614s
Epoch: 4 cost time: 11.597092866897583
Epoch: 4, Steps: 154 | Train Loss: 1.893 Vali Loss: 2.217 Vali Acc: 0.330 Test Loss: 2.217 Test Acc: 0.330
Validation loss decreased (-0.325201 --> -0.330067).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8464903
	speed: 0.2378s/iter; left time: 3491.5406s
Epoch: 5 cost time: 10.374193906784058
Epoch: 5, Steps: 154 | Train Loss: 1.807 Vali Loss: 2.316 Vali Acc: 0.332 Test Loss: 2.316 Test Acc: 0.332
Validation loss decreased (-0.330067 --> -0.331688).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6897686
	speed: 0.2985s/iter; left time: 4337.2291s
Epoch: 6 cost time: 11.6673743724823
Epoch: 6, Steps: 154 | Train Loss: 1.753 Vali Loss: 2.441 Vali Acc: 0.341 Test Loss: 2.441 Test Acc: 0.341
Validation loss decreased (-0.331688 --> -0.341014).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9139246
	speed: 0.2980s/iter; left time: 4284.6772s
Epoch: 7 cost time: 12.093806743621826
Epoch: 7, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.412 Vali Acc: 0.349 Test Loss: 2.412 Test Acc: 0.349
Validation loss decreased (-0.341014 --> -0.348719).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8267221
	speed: 0.2796s/iter; left time: 3977.2686s
Epoch: 8 cost time: 8.753854990005493
Epoch: 8, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.520 Vali Acc: 0.201 Test Loss: 2.520 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3750030
	speed: 0.2814s/iter; left time: 3959.2761s
Epoch: 9 cost time: 11.425812721252441
Epoch: 9, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.723 Vali Acc: 0.362 Test Loss: 2.723 Test Acc: 0.362
Validation loss decreased (-0.348719 --> -0.362098).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3020149
	speed: 0.3099s/iter; left time: 4311.5841s
Epoch: 10 cost time: 12.286603689193726
Epoch: 10, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.874 Vali Acc: 0.091 Test Loss: 2.874 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.9735836
	speed: 0.3042s/iter; left time: 4185.7053s
Epoch: 11 cost time: 12.508904695510864
Epoch: 11, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.658 Vali Acc: 0.373 Test Loss: 2.658 Test Acc: 0.373
Validation loss decreased (-0.362098 --> -0.372642).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8473996
	speed: 0.2992s/iter; left time: 4070.8715s
Epoch: 12 cost time: 12.381334781646729
Epoch: 12, Steps: 154 | Train Loss: 1.471 Vali Loss: 3.008 Vali Acc: 0.087 Test Loss: 3.008 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6078904
	speed: 0.2590s/iter; left time: 3484.2586s
Epoch: 13 cost time: 9.223204612731934
Epoch: 13, Steps: 154 | Train Loss: 1.486 Vali Loss: 3.349 Vali Acc: 0.083 Test Loss: 3.349 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2334627
	speed: 0.2974s/iter; left time: 3955.0022s
Epoch: 14 cost time: 11.212697744369507
Epoch: 14, Steps: 154 | Train Loss: 1.362 Vali Loss: 2.861 Vali Acc: 0.187 Test Loss: 2.861 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.2965947
	speed: 0.2847s/iter; left time: 3743.0061s
Epoch: 15 cost time: 11.110393047332764
Epoch: 15, Steps: 154 | Train Loss: 1.327 Vali Loss: 2.805 Vali Acc: 0.199 Test Loss: 2.805 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.2883767
	speed: 0.2908s/iter; left time: 3778.1041s
Epoch: 16 cost time: 10.884744644165039
Epoch: 16, Steps: 154 | Train Loss: 1.293 Vali Loss: 3.067 Vali Acc: 0.195 Test Loss: 3.067 Test Acc: 0.195
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.2829012
	speed: 0.2880s/iter; left time: 3697.6838s
Epoch: 17 cost time: 11.301571130752563
Epoch: 17, Steps: 154 | Train Loss: 1.264 Vali Loss: 3.168 Vali Acc: 0.185 Test Loss: 3.168 Test Acc: 0.185
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.6841230
	speed: 0.2351s/iter; left time: 2982.1455s
Epoch: 18 cost time: 11.154633283615112
Epoch: 18, Steps: 154 | Train Loss: 1.217 Vali Loss: 3.699 Vali Acc: 0.163 Test Loss: 3.699 Test Acc: 0.163
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.1725093
	speed: 0.2776s/iter; left time: 3478.1477s
Epoch: 19 cost time: 10.742525100708008
Epoch: 19, Steps: 154 | Train Loss: 1.176 Vali Loss: 3.525 Vali Acc: 0.200 Test Loss: 3.525 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.2431626
	speed: 0.2712s/iter; left time: 3355.6515s
Epoch: 20 cost time: 10.813130378723145
Epoch: 20, Steps: 154 | Train Loss: 1.205 Vali Loss: 3.794 Vali Acc: 0.143 Test Loss: 3.794 Test Acc: 0.143
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.6156365
	speed: 0.2929s/iter; left time: 3579.0434s
Epoch: 21 cost time: 11.01242971420288
Epoch: 21, Steps: 154 | Train Loss: 1.201 Vali Loss: 3.760 Vali Acc: 0.184 Test Loss: 3.760 Test Acc: 0.184
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3726682887266829
model parameter : 400222
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9728199
	speed: 0.0889s/iter; left time: 1360.5583s
Epoch: 1 cost time: 12.78789234161377
Epoch: 1, Steps: 154 | Train Loss: 2.243 Vali Loss: 2.187 Vali Acc: 0.317 Test Loss: 2.187 Test Acc: 0.317
Validation loss decreased (inf --> -0.316685).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7308755
	speed: 0.2495s/iter; left time: 3779.4255s
Epoch: 2 cost time: 8.072366714477539
Epoch: 2, Steps: 154 | Train Loss: 2.051 Vali Loss: 2.159 Vali Acc: 0.321 Test Loss: 2.159 Test Acc: 0.321
Validation loss decreased (-0.316685 --> -0.320741).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7418694
	speed: 0.2861s/iter; left time: 4288.7517s
Epoch: 3 cost time: 11.409241437911987
Epoch: 3, Steps: 154 | Train Loss: 1.934 Vali Loss: 2.172 Vali Acc: 0.327 Test Loss: 2.172 Test Acc: 0.327
Validation loss decreased (-0.320741 --> -0.327229).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0823581
	speed: 0.3004s/iter; left time: 4458.1570s
Epoch: 4 cost time: 11.69676160812378
Epoch: 4, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.231 Vali Acc: 0.338 Test Loss: 2.231 Test Acc: 0.338
Validation loss decreased (-0.327229 --> -0.338177).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6914839
	speed: 0.3054s/iter; left time: 4484.8400s
Epoch: 5 cost time: 11.509807109832764
Epoch: 5, Steps: 154 | Train Loss: 1.782 Vali Loss: 2.365 Vali Acc: 0.334 Test Loss: 2.365 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8506505
	speed: 0.3025s/iter; left time: 4396.0758s
Epoch: 6 cost time: 11.80297064781189
Epoch: 6, Steps: 154 | Train Loss: 1.718 Vali Loss: 2.459 Vali Acc: 0.347 Test Loss: 2.459 Test Acc: 0.347
Validation loss decreased (-0.338177 --> -0.346691).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9184625
	speed: 0.2508s/iter; left time: 3606.3637s
Epoch: 7 cost time: 8.091065645217896
Epoch: 7, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.462 Vali Acc: 0.355 Test Loss: 2.462 Test Acc: 0.355
Validation loss decreased (-0.346691 --> -0.355207).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9057956
	speed: 0.2673s/iter; left time: 3802.0623s
Epoch: 8 cost time: 11.86396336555481
Epoch: 8, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.547 Vali Acc: 0.281 Test Loss: 2.547 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4073216
	speed: 0.2983s/iter; left time: 4197.1155s
Epoch: 9 cost time: 11.708250284194946
Epoch: 9, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.836 Vali Acc: 0.356 Test Loss: 2.836 Test Acc: 0.356
Validation loss decreased (-0.355207 --> -0.355608).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4008055
	speed: 0.3061s/iter; left time: 4259.0738s
Epoch: 10 cost time: 12.114304304122925
Epoch: 10, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.509 Vali Acc: 0.248 Test Loss: 2.509 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.2532969
	speed: 0.3037s/iter; left time: 4179.5188s
Epoch: 11 cost time: 11.213370561599731
Epoch: 11, Steps: 154 | Train Loss: 1.396 Vali Loss: 2.771 Vali Acc: 0.195 Test Loss: 2.771 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.9634908
	speed: 0.2970s/iter; left time: 4041.6078s
Epoch: 12 cost time: 11.467398881912231
Epoch: 12, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.802 Vali Acc: 0.225 Test Loss: 2.802 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.6830097
	speed: 0.2903s/iter; left time: 3905.1463s
Epoch: 13 cost time: 11.137861013412476
Epoch: 13, Steps: 154 | Train Loss: 1.362 Vali Loss: 3.233 Vali Acc: 0.152 Test Loss: 3.233 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.2212266
	speed: 0.2314s/iter; left time: 3077.7869s
Epoch: 14 cost time: 11.281418323516846
Epoch: 14, Steps: 154 | Train Loss: 1.319 Vali Loss: 2.597 Vali Acc: 0.367 Test Loss: 2.597 Test Acc: 0.367
Validation loss decreased (-0.355608 --> -0.366560).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.9965297
	speed: 0.2849s/iter; left time: 3744.4328s
Epoch: 15 cost time: 11.051067113876343
Epoch: 15, Steps: 154 | Train Loss: 1.255 Vali Loss: 2.831 Vali Acc: 0.211 Test Loss: 2.831 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.8424519
	speed: 0.2900s/iter; left time: 3767.0072s
Epoch: 16 cost time: 10.961046934127808
Epoch: 16, Steps: 154 | Train Loss: 1.209 Vali Loss: 3.036 Vali Acc: 0.202 Test Loss: 3.036 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.2754509
	speed: 0.2706s/iter; left time: 3473.8033s
Epoch: 17 cost time: 8.97044825553894
Epoch: 17, Steps: 154 | Train Loss: 1.184 Vali Loss: 3.156 Vali Acc: 0.175 Test Loss: 3.156 Test Acc: 0.175
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.5140796
	speed: 0.2673s/iter; left time: 3389.5462s
Epoch: 18 cost time: 11.431732177734375
Epoch: 18, Steps: 154 | Train Loss: 1.157 Vali Loss: 3.715 Vali Acc: 0.084 Test Loss: 3.715 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.0084951
	speed: 0.2829s/iter; left time: 3543.9714s
Epoch: 19 cost time: 11.00525975227356
Epoch: 19, Steps: 154 | Train Loss: 1.137 Vali Loss: 3.751 Vali Acc: 0.195 Test Loss: 3.751 Test Acc: 0.195
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.9192470
	speed: 0.2837s/iter; left time: 3511.0562s
Epoch: 20 cost time: 11.385653972625732
Epoch: 20, Steps: 154 | Train Loss: 1.269 Vali Loss: 3.968 Vali Acc: 0.162 Test Loss: 3.968 Test Acc: 0.162
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.4443531
	speed: 0.2558s/iter; left time: 3126.0813s
Epoch: 21 cost time: 8.27403450012207
Epoch: 21, Steps: 154 | Train Loss: 1.112 Vali Loss: 3.582 Vali Acc: 0.196 Test Loss: 3.582 Test Acc: 0.196
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.3749564
	speed: 0.2746s/iter; left time: 3313.0776s
Epoch: 22 cost time: 10.470690727233887
Epoch: 22, Steps: 154 | Train Loss: 1.066 Vali Loss: 3.701 Vali Acc: 0.131 Test Loss: 3.701 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.1294161
	speed: 0.2996s/iter; left time: 3569.4860s
Epoch: 23 cost time: 11.242034435272217
Epoch: 23, Steps: 154 | Train Loss: 1.072 Vali Loss: 3.652 Vali Acc: 0.092 Test Loss: 3.652 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.1969987
	speed: 0.2978s/iter; left time: 3502.3463s
Epoch: 24 cost time: 10.703271865844727
Epoch: 24, Steps: 154 | Train Loss: 1.134 Vali Loss: 4.280 Vali Acc: 0.106 Test Loss: 4.280 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36658556366585565
model parameter : 400222
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9570549
	speed: 0.0839s/iter; left time: 1283.3045s
Epoch: 1 cost time: 12.085006475448608
Epoch: 1, Steps: 154 | Train Loss: 2.227 Vali Loss: 2.199 Vali Acc: 0.317 Test Loss: 2.199 Test Acc: 0.317
Validation loss decreased (inf --> -0.317091).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7856299
	speed: 0.2819s/iter; left time: 4269.4589s
Epoch: 2 cost time: 10.756061792373657
Epoch: 2, Steps: 154 | Train Loss: 2.031 Vali Loss: 2.168 Vali Acc: 0.322 Test Loss: 2.168 Test Acc: 0.322
Validation loss decreased (-0.317091 --> -0.321552).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7572755
	speed: 0.2804s/iter; left time: 4204.2036s
Epoch: 3 cost time: 10.308396100997925
Epoch: 3, Steps: 154 | Train Loss: 1.896 Vali Loss: 2.324 Vali Acc: 0.328 Test Loss: 2.324 Test Acc: 0.328
Validation loss decreased (-0.321552 --> -0.328444).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0172536
	speed: 0.2853s/iter; left time: 4233.2615s
Epoch: 4 cost time: 10.591313362121582
Epoch: 4, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.316 Vali Acc: 0.340 Test Loss: 2.316 Test Acc: 0.340
Validation loss decreased (-0.328444 --> -0.340204).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5571427
	speed: 0.2424s/iter; left time: 3559.9416s
Epoch: 5 cost time: 9.969188451766968
Epoch: 5, Steps: 154 | Train Loss: 1.721 Vali Loss: 2.653 Vali Acc: 0.339 Test Loss: 2.653 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7659187
	speed: 0.2317s/iter; left time: 3367.3952s
Epoch: 6 cost time: 9.592993021011353
Epoch: 6, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.466 Vali Acc: 0.357 Test Loss: 2.466 Test Acc: 0.357
Validation loss decreased (-0.340204 --> -0.356829).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7939034
	speed: 0.2607s/iter; left time: 3747.4624s
Epoch: 7 cost time: 9.31449007987976
Epoch: 7, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.443 Vali Acc: 0.360 Test Loss: 2.443 Test Acc: 0.360
Validation loss decreased (-0.356829 --> -0.359667).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8362426
	speed: 0.2620s/iter; left time: 3726.1897s
Epoch: 8 cost time: 9.645858764648438
Epoch: 8, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.461 Vali Acc: 0.289 Test Loss: 2.461 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1647224
	speed: 0.2579s/iter; left time: 3628.7801s
Epoch: 9 cost time: 10.029619455337524
Epoch: 9, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.524 Vali Acc: 0.363 Test Loss: 2.524 Test Acc: 0.363
Validation loss decreased (-0.359667 --> -0.362505).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3190511
	speed: 0.2685s/iter; left time: 3736.6339s
Epoch: 10 cost time: 9.795249938964844
Epoch: 10, Steps: 154 | Train Loss: 1.404 Vali Loss: 2.494 Vali Acc: 0.361 Test Loss: 2.494 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4117671
	speed: 0.2747s/iter; left time: 3780.0147s
Epoch: 11 cost time: 9.502361059188843
Epoch: 11, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.598 Vali Acc: 0.371 Test Loss: 2.598 Test Acc: 0.371
Validation loss decreased (-0.362505 --> -0.371426).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4176347
	speed: 0.2293s/iter; left time: 3120.5755s
Epoch: 12 cost time: 10.022615432739258
Epoch: 12, Steps: 154 | Train Loss: 1.310 Vali Loss: 2.481 Vali Acc: 0.380 Test Loss: 2.481 Test Acc: 0.380
Validation loss decreased (-0.371426 --> -0.379537).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4353645
	speed: 0.2667s/iter; left time: 3587.8945s
Epoch: 13 cost time: 9.906985998153687
Epoch: 13, Steps: 154 | Train Loss: 1.265 Vali Loss: 2.670 Vali Acc: 0.352 Test Loss: 2.670 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1601317
	speed: 0.2510s/iter; left time: 3337.8052s
Epoch: 14 cost time: 9.180681467056274
Epoch: 14, Steps: 154 | Train Loss: 1.256 Vali Loss: 2.573 Vali Acc: 0.373 Test Loss: 2.573 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.1775280
	speed: 0.2497s/iter; left time: 3282.4150s
Epoch: 15 cost time: 10.247835397720337
Epoch: 15, Steps: 154 | Train Loss: 1.288 Vali Loss: 2.669 Vali Acc: 0.238 Test Loss: 2.669 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.9486675
	speed: 0.2568s/iter; left time: 3335.7800s
Epoch: 16 cost time: 9.37941288948059
Epoch: 16, Steps: 154 | Train Loss: 1.245 Vali Loss: 2.928 Vali Acc: 0.210 Test Loss: 2.928 Test Acc: 0.210
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.9310922
	speed: 0.2454s/iter; left time: 3150.4289s
Epoch: 17 cost time: 8.005489826202393
Epoch: 17, Steps: 154 | Train Loss: 1.140 Vali Loss: 2.657 Vali Acc: 0.390 Test Loss: 2.657 Test Acc: 0.390
Validation loss decreased (-0.379537 --> -0.389673).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.4854436
	speed: 0.2540s/iter; left time: 3221.8536s
Epoch: 18 cost time: 10.53159761428833
Epoch: 18, Steps: 154 | Train Loss: 1.108 Vali Loss: 2.830 Vali Acc: 0.388 Test Loss: 2.830 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.4224252
	speed: 0.2776s/iter; left time: 3478.4721s
Epoch: 19 cost time: 9.627227544784546
Epoch: 19, Steps: 154 | Train Loss: 1.123 Vali Loss: 2.779 Vali Acc: 0.245 Test Loss: 2.779 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.9140882
	speed: 0.2710s/iter; left time: 3353.3036s
Epoch: 20 cost time: 10.015712261199951
Epoch: 20, Steps: 154 | Train Loss: 1.026 Vali Loss: 2.875 Vali Acc: 0.217 Test Loss: 2.875 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.0939718
	speed: 0.2723s/iter; left time: 3327.2172s
Epoch: 21 cost time: 10.809645891189575
Epoch: 21, Steps: 154 | Train Loss: 1.118 Vali Loss: 2.986 Vali Acc: 0.206 Test Loss: 2.986 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.5001065
	speed: 0.2803s/iter; left time: 3382.8537s
Epoch: 22 cost time: 10.713792324066162
Epoch: 22, Steps: 154 | Train Loss: 1.069 Vali Loss: 2.944 Vali Acc: 0.236 Test Loss: 2.944 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.9831265
	speed: 0.2769s/iter; left time: 3298.7325s
Epoch: 23 cost time: 10.40913462638855
Epoch: 23, Steps: 154 | Train Loss: 1.006 Vali Loss: 3.094 Vali Acc: 0.212 Test Loss: 3.094 Test Acc: 0.212
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.3702894
	speed: 0.2819s/iter; left time: 3314.4687s
Epoch: 24 cost time: 10.787795066833496
Epoch: 24, Steps: 154 | Train Loss: 1.021 Vali Loss: 3.052 Vali Acc: 0.232 Test Loss: 3.052 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 2.1552794
	speed: 0.2520s/iter; left time: 2924.1313s
Epoch: 25 cost time: 8.078511714935303
Epoch: 25, Steps: 154 | Train Loss: 0.962 Vali Loss: 3.093 Vali Acc: 0.189 Test Loss: 3.093 Test Acc: 0.189
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 1.2665745
	speed: 0.2707s/iter; left time: 3099.8672s
Epoch: 26 cost time: 10.076478242874146
Epoch: 26, Steps: 154 | Train Loss: 0.966 Vali Loss: 2.889 Vali Acc: 0.377 Test Loss: 2.889 Test Acc: 0.377
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.7672809
	speed: 0.2810s/iter; left time: 3174.0738s
Epoch: 27 cost time: 10.83394169807434
Epoch: 27, Steps: 154 | Train Loss: 0.908 Vali Loss: 3.560 Vali Acc: 0.146 Test Loss: 3.560 Test Acc: 0.146
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3896999188969992
model parameter : 400222
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2138536
	speed: 0.0886s/iter; left time: 1355.0298s
Epoch: 1 cost time: 12.461462259292603
Epoch: 1, Steps: 154 | Train Loss: 2.254 Vali Loss: 2.148 Vali Acc: 0.320 Test Loss: 2.148 Test Acc: 0.320
Validation loss decreased (inf --> -0.319524).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3032696
	speed: 0.2856s/iter; left time: 4325.3541s
Epoch: 2 cost time: 11.289283752441406
Epoch: 2, Steps: 154 | Train Loss: 2.056 Vali Loss: 2.187 Vali Acc: 0.323 Test Loss: 2.187 Test Acc: 0.323
Validation loss decreased (-0.319524 --> -0.322768).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7127542
	speed: 0.2845s/iter; left time: 4266.2403s
Epoch: 3 cost time: 9.74833083152771
Epoch: 3, Steps: 154 | Train Loss: 1.958 Vali Loss: 2.184 Vali Acc: 0.324 Test Loss: 2.184 Test Acc: 0.324
Validation loss decreased (-0.322768 --> -0.323579).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2134597
	speed: 0.2423s/iter; left time: 3594.8390s
Epoch: 4 cost time: 10.697073698043823
Epoch: 4, Steps: 154 | Train Loss: 1.925 Vali Loss: 2.198 Vali Acc: 0.327 Test Loss: 2.198 Test Acc: 0.327
Validation loss decreased (-0.323579 --> -0.327229).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7800856
	speed: 0.2852s/iter; left time: 4187.5542s
Epoch: 5 cost time: 11.40092658996582
Epoch: 5, Steps: 154 | Train Loss: 1.830 Vali Loss: 2.205 Vali Acc: 0.339 Test Loss: 2.205 Test Acc: 0.339
Validation loss decreased (-0.327229 --> -0.338988).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7829164
	speed: 0.2729s/iter; left time: 3965.4298s
Epoch: 6 cost time: 9.627876281738281
Epoch: 6, Steps: 154 | Train Loss: 1.767 Vali Loss: 2.334 Vali Acc: 0.342 Test Loss: 2.334 Test Acc: 0.342
Validation loss decreased (-0.338988 --> -0.342231).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6126758
	speed: 0.2059s/iter; left time: 2959.8321s
Epoch: 7 cost time: 10.555717468261719
Epoch: 7, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.406 Vali Acc: 0.348 Test Loss: 2.406 Test Acc: 0.348
Validation loss decreased (-0.342231 --> -0.348313).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3680018
	speed: 0.2766s/iter; left time: 3934.4918s
Epoch: 8 cost time: 10.636399507522583
Epoch: 8, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.358 Vali Acc: 0.356 Test Loss: 2.358 Test Acc: 0.356
Validation loss decreased (-0.348313 --> -0.356019).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8343749
	speed: 0.2753s/iter; left time: 3873.4082s
Epoch: 9 cost time: 10.612589597702026
Epoch: 9, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.775 Vali Acc: 0.081 Test Loss: 2.775 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2696130
	speed: 0.2902s/iter; left time: 4037.6850s
Epoch: 10 cost time: 11.221521139144897
Epoch: 10, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.635 Vali Acc: 0.196 Test Loss: 2.635 Test Acc: 0.196
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5933964
	speed: 0.2316s/iter; left time: 3187.1422s
Epoch: 11 cost time: 10.30711030960083
Epoch: 11, Steps: 154 | Train Loss: 1.489 Vali Loss: 2.851 Vali Acc: 0.077 Test Loss: 2.851 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.7347430
	speed: 0.2690s/iter; left time: 3660.2844s
Epoch: 12 cost time: 10.429922819137573
Epoch: 12, Steps: 154 | Train Loss: 1.567 Vali Loss: 3.330 Vali Acc: 0.083 Test Loss: 3.330 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.2559429
	speed: 0.2749s/iter; left time: 3697.8082s
Epoch: 13 cost time: 11.109676361083984
Epoch: 13, Steps: 154 | Train Loss: 1.437 Vali Loss: 2.797 Vali Acc: 0.080 Test Loss: 2.797 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.5611150
	speed: 0.2432s/iter; left time: 3234.0121s
Epoch: 14 cost time: 9.797790288925171
Epoch: 14, Steps: 154 | Train Loss: 1.366 Vali Loss: 3.150 Vali Acc: 0.079 Test Loss: 3.150 Test Acc: 0.079
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.4666989
	speed: 0.2789s/iter; left time: 3665.9212s
Epoch: 15 cost time: 10.466080665588379
Epoch: 15, Steps: 154 | Train Loss: 1.319 Vali Loss: 3.948 Vali Acc: 0.084 Test Loss: 3.948 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.2319142
	speed: 0.2764s/iter; left time: 3590.8145s
Epoch: 16 cost time: 10.812902450561523
Epoch: 16, Steps: 154 | Train Loss: 1.291 Vali Loss: 3.567 Vali Acc: 0.083 Test Loss: 3.567 Test Acc: 0.083
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.1178699
	speed: 0.2668s/iter; left time: 3424.7924s
Epoch: 17 cost time: 10.79202389717102
Epoch: 17, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.974 Vali Acc: 0.084 Test Loss: 2.974 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.3827809
	speed: 0.2121s/iter; left time: 2689.6027s
Epoch: 18 cost time: 8.972230911254883
Epoch: 18, Steps: 154 | Train Loss: 1.272 Vali Loss: 3.172 Vali Acc: 0.090 Test Loss: 3.172 Test Acc: 0.090
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3560421735604217
model parameter : 269150
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2158663
	speed: 0.0822s/iter; left time: 1257.1532s
Epoch: 1 cost time: 11.885053873062134
Epoch: 1, Steps: 154 | Train Loss: 2.242 Vali Loss: 2.142 Vali Acc: 0.321 Test Loss: 2.142 Test Acc: 0.321
Validation loss decreased (inf --> -0.320741).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3319046
	speed: 0.2672s/iter; left time: 4047.0751s
Epoch: 2 cost time: 10.037806749343872
Epoch: 2, Steps: 154 | Train Loss: 2.053 Vali Loss: 2.185 Vali Acc: 0.322 Test Loss: 2.185 Test Acc: 0.322
Validation loss decreased (-0.320741 --> -0.322363).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6520053
	speed: 0.2261s/iter; left time: 3389.6390s
Epoch: 3 cost time: 9.591494798660278
Epoch: 3, Steps: 154 | Train Loss: 1.943 Vali Loss: 2.168 Vali Acc: 0.324 Test Loss: 2.168 Test Acc: 0.324
Validation loss decreased (-0.322363 --> -0.324390).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1330433
	speed: 0.2811s/iter; left time: 4170.5548s
Epoch: 4 cost time: 11.274794578552246
Epoch: 4, Steps: 154 | Train Loss: 1.916 Vali Loss: 2.182 Vali Acc: 0.330 Test Loss: 2.182 Test Acc: 0.330
Validation loss decreased (-0.324390 --> -0.330473).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6582671
	speed: 0.2805s/iter; left time: 4119.3006s
Epoch: 5 cost time: 11.186061143875122
Epoch: 5, Steps: 154 | Train Loss: 1.822 Vali Loss: 2.195 Vali Acc: 0.343 Test Loss: 2.195 Test Acc: 0.343
Validation loss decreased (-0.330473 --> -0.343044).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9210246
	speed: 0.2685s/iter; left time: 3900.9052s
Epoch: 6 cost time: 9.197986602783203
Epoch: 6, Steps: 154 | Train Loss: 1.738 Vali Loss: 2.425 Vali Acc: 0.342 Test Loss: 2.425 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6576465
	speed: 0.2302s/iter; left time: 3309.2092s
Epoch: 7 cost time: 9.885453224182129
Epoch: 7, Steps: 154 | Train Loss: 1.658 Vali Loss: 2.393 Vali Acc: 0.350 Test Loss: 2.393 Test Acc: 0.350
Validation loss decreased (-0.343044 --> -0.349530).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2545986
	speed: 0.2740s/iter; left time: 3896.6140s
Epoch: 8 cost time: 10.874130725860596
Epoch: 8, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.380 Vali Acc: 0.358 Test Loss: 2.380 Test Acc: 0.358
Validation loss decreased (-0.349530 --> -0.358046).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8538516
	speed: 0.2788s/iter; left time: 3923.1244s
Epoch: 9 cost time: 10.652599096298218
Epoch: 9, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.597 Vali Acc: 0.374 Test Loss: 2.597 Test Acc: 0.374
Validation loss decreased (-0.358046 --> -0.374264).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2835414
	speed: 0.2645s/iter; left time: 3681.0024s
Epoch: 10 cost time: 10.322643756866455
Epoch: 10, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.624 Vali Acc: 0.354 Test Loss: 2.624 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4744511
	speed: 0.2675s/iter; left time: 3681.4849s
Epoch: 11 cost time: 9.86082124710083
Epoch: 11, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.618 Vali Acc: 0.202 Test Loss: 2.618 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.6525152
	speed: 0.2327s/iter; left time: 3165.9898s
Epoch: 12 cost time: 10.48221755027771
Epoch: 12, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.804 Vali Acc: 0.236 Test Loss: 2.804 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.1206247
	speed: 0.2692s/iter; left time: 3622.1906s
Epoch: 13 cost time: 10.374953031539917
Epoch: 13, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.860 Vali Acc: 0.337 Test Loss: 2.860 Test Acc: 0.337
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.5873275
	speed: 0.2550s/iter; left time: 3391.7172s
Epoch: 14 cost time: 8.325145244598389
Epoch: 14, Steps: 154 | Train Loss: 1.380 Vali Loss: 3.027 Vali Acc: 0.077 Test Loss: 3.027 Test Acc: 0.077
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.3612000
	speed: 0.2422s/iter; left time: 3183.8702s
Epoch: 15 cost time: 10.288702249526978
Epoch: 15, Steps: 154 | Train Loss: 1.325 Vali Loss: 3.356 Vali Acc: 0.079 Test Loss: 3.356 Test Acc: 0.079
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.3234034
	speed: 0.2664s/iter; left time: 3460.6141s
Epoch: 16 cost time: 10.524315357208252
Epoch: 16, Steps: 154 | Train Loss: 1.248 Vali Loss: 3.733 Vali Acc: 0.074 Test Loss: 3.733 Test Acc: 0.074
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.2131088
	speed: 0.2500s/iter; left time: 3209.8173s
Epoch: 17 cost time: 8.078916788101196
Epoch: 17, Steps: 154 | Train Loss: 1.249 Vali Loss: 2.936 Vali Acc: 0.200 Test Loss: 2.936 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.1794776
	speed: 0.2504s/iter; left time: 3175.8341s
Epoch: 18 cost time: 10.332430124282837
Epoch: 18, Steps: 154 | Train Loss: 1.190 Vali Loss: 3.320 Vali Acc: 0.206 Test Loss: 3.320 Test Acc: 0.206
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.1001703
	speed: 0.2661s/iter; left time: 3333.8071s
Epoch: 19 cost time: 10.677500247955322
Epoch: 19, Steps: 154 | Train Loss: 1.205 Vali Loss: 3.251 Vali Acc: 0.189 Test Loss: 3.251 Test Acc: 0.189
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3742903487429035
model parameter : 269150
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2476573
	speed: 0.0838s/iter; left time: 1282.9256s
Epoch: 1 cost time: 11.780354976654053
Epoch: 1, Steps: 154 | Train Loss: 2.230 Vali Loss: 2.141 Vali Acc: 0.320 Test Loss: 2.141 Test Acc: 0.320
Validation loss decreased (inf --> -0.320335).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3178463
	speed: 0.2684s/iter; left time: 4065.7326s
Epoch: 2 cost time: 9.81429409980774
Epoch: 2, Steps: 154 | Train Loss: 2.048 Vali Loss: 2.168 Vali Acc: 0.320 Test Loss: 2.168 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6894186
	speed: 0.2402s/iter; left time: 3600.9489s
Epoch: 3 cost time: 10.833728075027466
Epoch: 3, Steps: 154 | Train Loss: 1.941 Vali Loss: 2.150 Vali Acc: 0.325 Test Loss: 2.150 Test Acc: 0.325
Validation loss decreased (-0.320335 --> -0.324796).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1609292
	speed: 0.2225s/iter; left time: 3301.5049s
Epoch: 4 cost time: 8.476080179214478
Epoch: 4, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.239 Vali Acc: 0.340 Test Loss: 2.239 Test Acc: 0.340
Validation loss decreased (-0.324796 --> -0.340205).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6745871
	speed: 0.2622s/iter; left time: 3850.5618s
Epoch: 5 cost time: 10.239025354385376
Epoch: 5, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.257 Vali Acc: 0.349 Test Loss: 2.257 Test Acc: 0.349
Validation loss decreased (-0.340205 --> -0.348720).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9421644
	speed: 0.2623s/iter; left time: 3812.0362s
Epoch: 6 cost time: 9.538935661315918
Epoch: 6, Steps: 154 | Train Loss: 1.705 Vali Loss: 2.500 Vali Acc: 0.343 Test Loss: 2.500 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5088822
	speed: 0.2372s/iter; left time: 3410.6275s
Epoch: 7 cost time: 9.877901792526245
Epoch: 7, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.506 Vali Acc: 0.354 Test Loss: 2.506 Test Acc: 0.354
Validation loss decreased (-0.348720 --> -0.353990).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1824806
	speed: 0.2414s/iter; left time: 3433.5255s
Epoch: 8 cost time: 8.057130098342896
Epoch: 8, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.305 Vali Acc: 0.361 Test Loss: 2.305 Test Acc: 0.361
Validation loss decreased (-0.353990 --> -0.360885).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5979607
	speed: 0.2478s/iter; left time: 3485.7829s
Epoch: 9 cost time: 9.653754711151123
Epoch: 9, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.598 Vali Acc: 0.371 Test Loss: 2.598 Test Acc: 0.371
Validation loss decreased (-0.360885 --> -0.370615).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0873306
	speed: 0.2555s/iter; left time: 3554.8399s
Epoch: 10 cost time: 10.15090560913086
Epoch: 10, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.707 Vali Acc: 0.351 Test Loss: 2.707 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5743566
	speed: 0.2650s/iter; left time: 3646.0291s
Epoch: 11 cost time: 10.527740240097046
Epoch: 11, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.684 Vali Acc: 0.202 Test Loss: 2.684 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.6937747
	speed: 0.2653s/iter; left time: 3610.2611s
Epoch: 12 cost time: 9.902776956558228
Epoch: 12, Steps: 154 | Train Loss: 1.353 Vali Loss: 2.793 Vali Acc: 0.199 Test Loss: 2.793 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.9274631
	speed: 0.2428s/iter; left time: 3266.7813s
Epoch: 13 cost time: 8.035793781280518
Epoch: 13, Steps: 154 | Train Loss: 1.315 Vali Loss: 2.696 Vali Acc: 0.222 Test Loss: 2.696 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 2.5372291
	speed: 0.2282s/iter; left time: 3035.1153s
Epoch: 14 cost time: 9.55749773979187
Epoch: 14, Steps: 154 | Train Loss: 1.291 Vali Loss: 3.198 Vali Acc: 0.105 Test Loss: 3.198 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.5394287
	speed: 0.2433s/iter; left time: 3198.4407s
Epoch: 15 cost time: 10.757675409317017
Epoch: 15, Steps: 154 | Train Loss: 1.262 Vali Loss: 3.434 Vali Acc: 0.165 Test Loss: 3.434 Test Acc: 0.165
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.4223045
	speed: 0.2491s/iter; left time: 3236.6003s
Epoch: 16 cost time: 9.409085988998413
Epoch: 16, Steps: 154 | Train Loss: 1.227 Vali Loss: 3.194 Vali Acc: 0.180 Test Loss: 3.194 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.9194676
	speed: 0.2251s/iter; left time: 2889.4989s
Epoch: 17 cost time: 9.442592144012451
Epoch: 17, Steps: 154 | Train Loss: 1.198 Vali Loss: 3.038 Vali Acc: 0.128 Test Loss: 3.038 Test Acc: 0.128
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.3991010
	speed: 0.2568s/iter; left time: 3256.7143s
Epoch: 18 cost time: 10.339643478393555
Epoch: 18, Steps: 154 | Train Loss: 1.264 Vali Loss: 3.305 Vali Acc: 0.203 Test Loss: 3.305 Test Acc: 0.203
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.2164013
	speed: 0.2629s/iter; left time: 3294.3760s
Epoch: 19 cost time: 10.708217859268188
Epoch: 19, Steps: 154 | Train Loss: 1.130 Vali Loss: 3.331 Vali Acc: 0.152 Test Loss: 3.331 Test Acc: 0.152
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3706407137064071
model parameter : 269150
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2290859
	speed: 0.0759s/iter; left time: 1160.8324s
Epoch: 1 cost time: 10.866943836212158
Epoch: 1, Steps: 154 | Train Loss: 2.207 Vali Loss: 2.154 Vali Acc: 0.320 Test Loss: 2.154 Test Acc: 0.320
Validation loss decreased (inf --> -0.320335).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3245816
	speed: 0.2423s/iter; left time: 3669.4149s
Epoch: 2 cost time: 8.358128070831299
Epoch: 2, Steps: 154 | Train Loss: 2.034 Vali Loss: 2.271 Vali Acc: 0.324 Test Loss: 2.271 Test Acc: 0.324
Validation loss decreased (-0.320335 --> -0.324389).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6346067
	speed: 0.2414s/iter; left time: 3619.1023s
Epoch: 3 cost time: 10.0853910446167
Epoch: 3, Steps: 154 | Train Loss: 1.906 Vali Loss: 2.252 Vali Acc: 0.328 Test Loss: 2.252 Test Acc: 0.328
Validation loss decreased (-0.324389 --> -0.328039).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1796291
	speed: 0.2616s/iter; left time: 3881.3661s
Epoch: 4 cost time: 9.441572904586792
Epoch: 4, Steps: 154 | Train Loss: 1.800 Vali Loss: 2.527 Vali Acc: 0.343 Test Loss: 2.527 Test Acc: 0.343
Validation loss decreased (-0.328039 --> -0.343040).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6459347
	speed: 0.2456s/iter; left time: 3607.0095s
Epoch: 5 cost time: 8.830386638641357
Epoch: 5, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.646 Vali Acc: 0.350 Test Loss: 2.646 Test Acc: 0.350
Validation loss decreased (-0.343040 --> -0.349527).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7849119
	speed: 0.2602s/iter; left time: 3781.5792s
Epoch: 6 cost time: 10.100590705871582
Epoch: 6, Steps: 154 | Train Loss: 1.613 Vali Loss: 3.000 Vali Acc: 0.347 Test Loss: 3.000 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5188830
	speed: 0.2582s/iter; left time: 3712.4164s
Epoch: 7 cost time: 9.53959584236145
Epoch: 7, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.824 Vali Acc: 0.350 Test Loss: 2.824 Test Acc: 0.350
Validation loss decreased (-0.349527 --> -0.349931).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0988085
	speed: 0.2452s/iter; left time: 3486.9945s
Epoch: 8 cost time: 8.111299991607666
Epoch: 8, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.445 Vali Acc: 0.358 Test Loss: 2.445 Test Acc: 0.358
Validation loss decreased (-0.349931 --> -0.357640).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.2628428
	speed: 0.2397s/iter; left time: 3372.0024s
Epoch: 9 cost time: 9.63402509689331
Epoch: 9, Steps: 154 | Train Loss: 1.417 Vali Loss: 2.485 Vali Acc: 0.377 Test Loss: 2.485 Test Acc: 0.377
Validation loss decreased (-0.357640 --> -0.376699).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0111880
	speed: 0.2654s/iter; left time: 3693.7296s
Epoch: 10 cost time: 10.115484952926636
Epoch: 10, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.512 Vali Acc: 0.367 Test Loss: 2.512 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4169009
	speed: 0.2346s/iter; left time: 3228.7188s
Epoch: 11 cost time: 8.373634099960327
Epoch: 11, Steps: 154 | Train Loss: 1.329 Vali Loss: 2.422 Vali Acc: 0.277 Test Loss: 2.422 Test Acc: 0.277
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.7461879
	speed: 0.2468s/iter; left time: 3358.7846s
Epoch: 12 cost time: 9.264694929122925
Epoch: 12, Steps: 154 | Train Loss: 1.385 Vali Loss: 2.585 Vali Acc: 0.378 Test Loss: 2.585 Test Acc: 0.378
Validation loss decreased (-0.376699 --> -0.378320).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9663419
	speed: 0.2565s/iter; left time: 3450.9355s
Epoch: 13 cost time: 9.24994444847107
Epoch: 13, Steps: 154 | Train Loss: 1.257 Vali Loss: 2.349 Vali Acc: 0.382 Test Loss: 2.349 Test Acc: 0.382
Validation loss decreased (-0.378320 --> -0.382377).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4745827
	speed: 0.2614s/iter; left time: 3475.9085s
Epoch: 14 cost time: 9.973102807998657
Epoch: 14, Steps: 154 | Train Loss: 1.223 Vali Loss: 2.447 Vali Acc: 0.382 Test Loss: 2.447 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.5512650
	speed: 0.2346s/iter; left time: 3083.3741s
Epoch: 15 cost time: 8.237345218658447
Epoch: 15, Steps: 154 | Train Loss: 1.214 Vali Loss: 2.518 Vali Acc: 0.317 Test Loss: 2.518 Test Acc: 0.317
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.2225417
	speed: 0.2549s/iter; left time: 3310.7730s
Epoch: 16 cost time: 9.627153635025024
Epoch: 16, Steps: 154 | Train Loss: 1.130 Vali Loss: 2.776 Vali Acc: 0.284 Test Loss: 2.776 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.1387243
	speed: 0.2650s/iter; left time: 3402.3449s
Epoch: 17 cost time: 9.968442440032959
Epoch: 17, Steps: 154 | Train Loss: 1.110 Vali Loss: 2.906 Vali Acc: 0.348 Test Loss: 2.906 Test Acc: 0.348
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.0081973
	speed: 0.2481s/iter; left time: 3147.0797s
Epoch: 18 cost time: 9.153146505355835
Epoch: 18, Steps: 154 | Train Loss: 1.144 Vali Loss: 2.738 Vali Acc: 0.386 Test Loss: 2.738 Test Acc: 0.386
Validation loss decreased (-0.382377 --> -0.386428).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.9094656
	speed: 0.2503s/iter; left time: 3135.6409s
Epoch: 19 cost time: 10.314249515533447
Epoch: 19, Steps: 154 | Train Loss: 1.070 Vali Loss: 2.758 Vali Acc: 0.380 Test Loss: 2.758 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.7303157
	speed: 0.2750s/iter; left time: 3402.7599s
Epoch: 20 cost time: 10.190598726272583
Epoch: 20, Steps: 154 | Train Loss: 1.025 Vali Loss: 2.843 Vali Acc: 0.221 Test Loss: 2.843 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.7681372
	speed: 0.2633s/iter; left time: 3217.7646s
Epoch: 21 cost time: 9.942110061645508
Epoch: 21, Steps: 154 | Train Loss: 1.027 Vali Loss: 2.793 Vali Acc: 0.212 Test Loss: 2.793 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.8023600
	speed: 0.2330s/iter; left time: 2811.7617s
Epoch: 22 cost time: 9.759052276611328
Epoch: 22, Steps: 154 | Train Loss: 1.068 Vali Loss: 3.585 Vali Acc: 0.088 Test Loss: 3.585 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.4096874
	speed: 0.2596s/iter; left time: 3093.0529s
Epoch: 23 cost time: 10.235609531402588
Epoch: 23, Steps: 154 | Train Loss: 1.011 Vali Loss: 2.964 Vali Acc: 0.281 Test Loss: 2.964 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.9915646
	speed: 0.2673s/iter; left time: 3143.6241s
Epoch: 24 cost time: 9.846418142318726
Epoch: 24, Steps: 154 | Train Loss: 1.106 Vali Loss: 3.089 Vali Acc: 0.106 Test Loss: 3.089 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.1447219
	speed: 0.2617s/iter; left time: 3036.4751s
Epoch: 25 cost time: 9.573732614517212
Epoch: 25, Steps: 154 | Train Loss: 0.922 Vali Loss: 3.441 Vali Acc: 0.134 Test Loss: 3.441 Test Acc: 0.134
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.4156449
	speed: 0.2671s/iter; left time: 3059.0202s
Epoch: 26 cost time: 9.980504989624023
Epoch: 26, Steps: 154 | Train Loss: 0.935 Vali Loss: 3.057 Vali Acc: 0.297 Test Loss: 3.057 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.0177083
	speed: 0.2442s/iter; left time: 2758.5937s
Epoch: 27 cost time: 8.410061597824097
Epoch: 27, Steps: 154 | Train Loss: 0.912 Vali Loss: 3.444 Vali Acc: 0.104 Test Loss: 3.444 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.9726107
	speed: 0.2522s/iter; left time: 2810.5151s
Epoch: 28 cost time: 9.668291091918945
Epoch: 28, Steps: 154 | Train Loss: 0.892 Vali Loss: 3.520 Vali Acc: 0.091 Test Loss: 3.520 Test Acc: 0.091
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.386455798864558
model parameter : 269150
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2899394
	speed: 0.0799s/iter; left time: 1221.7867s
Epoch: 1 cost time: 11.561788558959961
Epoch: 1, Steps: 154 | Train Loss: 2.278 Vali Loss: 2.137 Vali Acc: 0.320 Test Loss: 2.137 Test Acc: 0.320
Validation loss decreased (inf --> -0.319524).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6458960
	speed: 0.2285s/iter; left time: 3460.4735s
Epoch: 2 cost time: 9.07417368888855
Epoch: 2, Steps: 154 | Train Loss: 2.059 Vali Loss: 2.174 Vali Acc: 0.324 Test Loss: 2.174 Test Acc: 0.324
Validation loss decreased (-0.319524 --> -0.323985).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0958834
	speed: 0.2488s/iter; left time: 3729.6174s
Epoch: 3 cost time: 9.45372200012207
Epoch: 3, Steps: 154 | Train Loss: 1.982 Vali Loss: 2.149 Vali Acc: 0.324 Test Loss: 2.149 Test Acc: 0.324
Validation loss decreased (-0.323985 --> -0.324391).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8268932
	speed: 0.2670s/iter; left time: 3961.9892s
Epoch: 4 cost time: 9.746790409088135
Epoch: 4, Steps: 154 | Train Loss: 1.899 Vali Loss: 2.195 Vali Acc: 0.330 Test Loss: 2.195 Test Acc: 0.330
Validation loss decreased (-0.324391 --> -0.329662).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0899632
	speed: 0.2341s/iter; left time: 3438.4037s
Epoch: 5 cost time: 10.765666007995605
Epoch: 5, Steps: 154 | Train Loss: 1.855 Vali Loss: 2.205 Vali Acc: 0.330 Test Loss: 2.205 Test Acc: 0.330
Validation loss decreased (-0.329662 --> -0.330067).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4503368
	speed: 0.2650s/iter; left time: 3850.4649s
Epoch: 6 cost time: 10.457823991775513
Epoch: 6, Steps: 154 | Train Loss: 1.880 Vali Loss: 2.260 Vali Acc: 0.336 Test Loss: 2.260 Test Acc: 0.336
Validation loss decreased (-0.330067 --> -0.335744).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4864488
	speed: 0.2640s/iter; left time: 3795.8862s
Epoch: 7 cost time: 10.550200939178467
Epoch: 7, Steps: 154 | Train Loss: 1.733 Vali Loss: 2.292 Vali Acc: 0.353 Test Loss: 2.292 Test Acc: 0.353
Validation loss decreased (-0.335744 --> -0.353181).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4277768
	speed: 0.2660s/iter; left time: 3783.4631s
Epoch: 8 cost time: 10.72063684463501
Epoch: 8, Steps: 154 | Train Loss: 1.648 Vali Loss: 2.378 Vali Acc: 0.354 Test Loss: 2.378 Test Acc: 0.354
Validation loss decreased (-0.353181 --> -0.354396).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5782219
	speed: 0.2791s/iter; left time: 3926.0968s
Epoch: 9 cost time: 10.364439725875854
Epoch: 9, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.391 Vali Acc: 0.368 Test Loss: 2.391 Test Acc: 0.368
Validation loss decreased (-0.354396 --> -0.367778).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6034608
	speed: 0.2680s/iter; left time: 3728.5606s
Epoch: 10 cost time: 10.082690477371216
Epoch: 10, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.436 Vali Acc: 0.373 Test Loss: 2.436 Test Acc: 0.373
Validation loss decreased (-0.367778 --> -0.373455).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5561281
	speed: 0.2226s/iter; left time: 3063.5842s
Epoch: 11 cost time: 8.665732860565186
Epoch: 11, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.591 Vali Acc: 0.361 Test Loss: 2.591 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7154430
	speed: 0.2418s/iter; left time: 3290.7756s
Epoch: 12 cost time: 9.085272550582886
Epoch: 12, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.671 Vali Acc: 0.204 Test Loss: 2.671 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5047792
	speed: 0.2552s/iter; left time: 3432.6474s
Epoch: 13 cost time: 9.86846375465393
Epoch: 13, Steps: 154 | Train Loss: 1.481 Vali Loss: 2.485 Vali Acc: 0.369 Test Loss: 2.485 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4814134
	speed: 0.2269s/iter; left time: 3017.9150s
Epoch: 14 cost time: 8.140723943710327
Epoch: 14, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.811 Vali Acc: 0.208 Test Loss: 2.811 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.4049369
	speed: 0.2366s/iter; left time: 3110.2874s
Epoch: 15 cost time: 10.324096918106079
Epoch: 15, Steps: 154 | Train Loss: 1.396 Vali Loss: 2.765 Vali Acc: 0.074 Test Loss: 2.765 Test Acc: 0.074
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.3287042
	speed: 0.2481s/iter; left time: 3223.1199s
Epoch: 16 cost time: 9.295378684997559
Epoch: 16, Steps: 154 | Train Loss: 1.342 Vali Loss: 2.795 Vali Acc: 0.082 Test Loss: 2.795 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.2936015
	speed: 0.2564s/iter; left time: 3291.3407s
Epoch: 17 cost time: 9.961648941040039
Epoch: 17, Steps: 154 | Train Loss: 1.314 Vali Loss: 3.017 Vali Acc: 0.176 Test Loss: 3.017 Test Acc: 0.176
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.2182460
	speed: 0.2398s/iter; left time: 3041.7918s
Epoch: 18 cost time: 10.027659177780151
Epoch: 18, Steps: 154 | Train Loss: 1.316 Vali Loss: 3.290 Vali Acc: 0.081 Test Loss: 3.290 Test Acc: 0.081
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.3196630
	speed: 0.2478s/iter; left time: 3105.0058s
Epoch: 19 cost time: 9.54731273651123
Epoch: 19, Steps: 154 | Train Loss: 1.306 Vali Loss: 3.614 Vali Acc: 0.081 Test Loss: 3.614 Test Acc: 0.081
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.1757194
	speed: 0.2352s/iter; left time: 2910.2416s
Epoch: 20 cost time: 8.347206830978394
Epoch: 20, Steps: 154 | Train Loss: 1.311 Vali Loss: 2.979 Vali Acc: 0.107 Test Loss: 2.979 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3734793187347932
model parameter : 203614
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2667513
	speed: 0.0830s/iter; left time: 1269.7637s
Epoch: 1 cost time: 11.654331684112549
Epoch: 1, Steps: 154 | Train Loss: 2.273 Vali Loss: 2.139 Vali Acc: 0.318 Test Loss: 2.139 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6101197
	speed: 0.2691s/iter; left time: 4076.3748s
Epoch: 2 cost time: 10.104891777038574
Epoch: 2, Steps: 154 | Train Loss: 2.059 Vali Loss: 2.177 Vali Acc: 0.324 Test Loss: 2.177 Test Acc: 0.324
Validation loss decreased (-0.317902 --> -0.323985).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0966511
	speed: 0.2570s/iter; left time: 3852.6136s
Epoch: 3 cost time: 10.335388422012329
Epoch: 3, Steps: 154 | Train Loss: 1.995 Vali Loss: 2.138 Vali Acc: 0.326 Test Loss: 2.138 Test Acc: 0.326
Validation loss decreased (-0.323985 --> -0.325607).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8288116
	speed: 0.2479s/iter; left time: 3678.9302s
Epoch: 4 cost time: 9.614147901535034
Epoch: 4, Steps: 154 | Train Loss: 1.887 Vali Loss: 2.208 Vali Acc: 0.331 Test Loss: 2.208 Test Acc: 0.331
Validation loss decreased (-0.325607 --> -0.330878).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0684369
	speed: 0.2179s/iter; left time: 3199.1663s
Epoch: 5 cost time: 9.776006937026978
Epoch: 5, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.199 Vali Acc: 0.332 Test Loss: 2.199 Test Acc: 0.332
Validation loss decreased (-0.330878 --> -0.331689).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4068117
	speed: 0.2600s/iter; left time: 3777.4010s
Epoch: 6 cost time: 10.11640977859497
Epoch: 6, Steps: 154 | Train Loss: 1.829 Vali Loss: 2.215 Vali Acc: 0.346 Test Loss: 2.215 Test Acc: 0.346
Validation loss decreased (-0.331689 --> -0.345882).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5311340
	speed: 0.2565s/iter; left time: 3687.7971s
Epoch: 7 cost time: 9.368075370788574
Epoch: 7, Steps: 154 | Train Loss: 1.668 Vali Loss: 2.328 Vali Acc: 0.351 Test Loss: 2.328 Test Acc: 0.351
Validation loss decreased (-0.345882 --> -0.351153).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3962606
	speed: 0.1925s/iter; left time: 2737.2464s
Epoch: 8 cost time: 8.823156595230103
Epoch: 8, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.395 Vali Acc: 0.255 Test Loss: 2.395 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4782246
	speed: 0.2343s/iter; left time: 3295.8525s
Epoch: 9 cost time: 8.437900066375732
Epoch: 9, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.377 Vali Acc: 0.287 Test Loss: 2.377 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6746354
	speed: 0.2417s/iter; left time: 3363.7277s
Epoch: 10 cost time: 9.441058158874512
Epoch: 10, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.455 Vali Acc: 0.294 Test Loss: 2.455 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6950537
	speed: 0.2516s/iter; left time: 3461.8490s
Epoch: 11 cost time: 9.668421506881714
Epoch: 11, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.550 Vali Acc: 0.361 Test Loss: 2.550 Test Acc: 0.361
Validation loss decreased (-0.351153 --> -0.360477).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4796475
	speed: 0.2147s/iter; left time: 2920.9825s
Epoch: 12 cost time: 9.886026620864868
Epoch: 12, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.573 Vali Acc: 0.201 Test Loss: 2.573 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.8597108
	speed: 0.2468s/iter; left time: 3319.7969s
Epoch: 13 cost time: 9.480520963668823
Epoch: 13, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.509 Vali Acc: 0.325 Test Loss: 2.509 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.3005182
	speed: 0.2473s/iter; left time: 3288.2449s
Epoch: 14 cost time: 9.7388756275177
Epoch: 14, Steps: 154 | Train Loss: 1.349 Vali Loss: 2.909 Vali Acc: 0.204 Test Loss: 2.909 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.0544304
	speed: 0.2548s/iter; left time: 3349.7784s
Epoch: 15 cost time: 8.732394218444824
Epoch: 15, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.855 Vali Acc: 0.129 Test Loss: 2.855 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.4380366
	speed: 0.2433s/iter; left time: 3161.2581s
Epoch: 16 cost time: 9.630497217178345
Epoch: 16, Steps: 154 | Train Loss: 1.287 Vali Loss: 2.775 Vali Acc: 0.202 Test Loss: 2.775 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.0166481
	speed: 0.2413s/iter; left time: 3097.7870s
Epoch: 17 cost time: 9.313976764678955
Epoch: 17, Steps: 154 | Train Loss: 1.291 Vali Loss: 3.462 Vali Acc: 0.072 Test Loss: 3.462 Test Acc: 0.072
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.4443210
	speed: 0.2452s/iter; left time: 3109.3034s
Epoch: 18 cost time: 9.693674564361572
Epoch: 18, Steps: 154 | Train Loss: 1.241 Vali Loss: 3.423 Vali Acc: 0.077 Test Loss: 3.423 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.4695777
	speed: 0.2385s/iter; left time: 2987.7624s
Epoch: 19 cost time: 9.770694732666016
Epoch: 19, Steps: 154 | Train Loss: 1.218 Vali Loss: 3.632 Vali Acc: 0.077 Test Loss: 3.632 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.0420632
	speed: 0.2473s/iter; left time: 3060.2504s
Epoch: 20 cost time: 8.315005779266357
Epoch: 20, Steps: 154 | Train Loss: 1.250 Vali Loss: 2.993 Vali Acc: 0.199 Test Loss: 2.993 Test Acc: 0.199
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.9754317
	speed: 0.2407s/iter; left time: 2941.1320s
Epoch: 21 cost time: 8.531770706176758
Epoch: 21, Steps: 154 | Train Loss: 1.151 Vali Loss: 3.233 Vali Acc: 0.095 Test Loss: 3.233 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3605028386050284
model parameter : 203614
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2324638
	speed: 0.0762s/iter; left time: 1165.6782s
Epoch: 1 cost time: 10.869218111038208
Epoch: 1, Steps: 154 | Train Loss: 2.256 Vali Loss: 2.142 Vali Acc: 0.318 Test Loss: 2.142 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6038939
	speed: 0.2330s/iter; left time: 3529.8250s
Epoch: 2 cost time: 8.195645809173584
Epoch: 2, Steps: 154 | Train Loss: 2.047 Vali Loss: 2.188 Vali Acc: 0.321 Test Loss: 2.188 Test Acc: 0.321
Validation loss decreased (-0.318308 --> -0.320740).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1479630
	speed: 0.2320s/iter; left time: 3478.6102s
Epoch: 3 cost time: 9.214230298995972
Epoch: 3, Steps: 154 | Train Loss: 1.981 Vali Loss: 2.126 Vali Acc: 0.327 Test Loss: 2.126 Test Acc: 0.327
Validation loss decreased (-0.320740 --> -0.327229).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7892190
	speed: 0.2239s/iter; left time: 3322.0147s
Epoch: 4 cost time: 8.88412094116211
Epoch: 4, Steps: 154 | Train Loss: 1.855 Vali Loss: 2.285 Vali Acc: 0.337 Test Loss: 2.285 Test Acc: 0.337
Validation loss decreased (-0.327229 --> -0.337366).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0374534
	speed: 0.2376s/iter; left time: 3489.0448s
Epoch: 5 cost time: 8.505180835723877
Epoch: 5, Steps: 154 | Train Loss: 1.797 Vali Loss: 2.329 Vali Acc: 0.339 Test Loss: 2.329 Test Acc: 0.339
Validation loss decreased (-0.337366 --> -0.338987).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4141949
	speed: 0.2116s/iter; left time: 3075.1109s
Epoch: 6 cost time: 8.330218315124512
Epoch: 6, Steps: 154 | Train Loss: 1.719 Vali Loss: 2.321 Vali Acc: 0.344 Test Loss: 2.321 Test Acc: 0.344
Validation loss decreased (-0.338987 --> -0.343854).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4360491
	speed: 0.2275s/iter; left time: 3270.6526s
Epoch: 7 cost time: 9.198952674865723
Epoch: 7, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.443 Vali Acc: 0.352 Test Loss: 2.443 Test Acc: 0.352
Validation loss decreased (-0.343854 --> -0.352368).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4849907
	speed: 0.2370s/iter; left time: 3370.3440s
Epoch: 8 cost time: 8.666669368743896
Epoch: 8, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.431 Vali Acc: 0.352 Test Loss: 2.431 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3971113
	speed: 0.2209s/iter; left time: 3107.3279s
Epoch: 9 cost time: 9.481441497802734
Epoch: 9, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.322 Vali Acc: 0.367 Test Loss: 2.322 Test Acc: 0.367
Validation loss decreased (-0.352368 --> -0.366562).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4217104
	speed: 0.2357s/iter; left time: 3279.6788s
Epoch: 10 cost time: 9.148439407348633
Epoch: 10, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.412 Vali Acc: 0.348 Test Loss: 2.412 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.7504877
	speed: 0.2441s/iter; left time: 3359.2766s
Epoch: 11 cost time: 9.367633819580078
Epoch: 11, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.671 Vali Acc: 0.374 Test Loss: 2.671 Test Acc: 0.374
Validation loss decreased (-0.366562 --> -0.373858).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5796033
	speed: 0.2275s/iter; left time: 3095.8927s
Epoch: 12 cost time: 8.623371601104736
Epoch: 12, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.753 Vali Acc: 0.205 Test Loss: 2.753 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6505274
	speed: 0.2380s/iter; left time: 3201.1645s
Epoch: 13 cost time: 9.263057231903076
Epoch: 13, Steps: 154 | Train Loss: 1.333 Vali Loss: 2.689 Vali Acc: 0.365 Test Loss: 2.689 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2433045
	speed: 0.2417s/iter; left time: 3214.8628s
Epoch: 14 cost time: 9.175344705581665
Epoch: 14, Steps: 154 | Train Loss: 1.339 Vali Loss: 2.850 Vali Acc: 0.206 Test Loss: 2.850 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.9191024
	speed: 0.2347s/iter; left time: 3084.9126s
Epoch: 15 cost time: 9.423277854919434
Epoch: 15, Steps: 154 | Train Loss: 1.249 Vali Loss: 2.891 Vali Acc: 0.204 Test Loss: 2.891 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.0966036
	speed: 0.2214s/iter; left time: 2876.0905s
Epoch: 16 cost time: 7.968904495239258
Epoch: 16, Steps: 154 | Train Loss: 1.249 Vali Loss: 3.151 Vali Acc: 0.196 Test Loss: 3.151 Test Acc: 0.196
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.0308042
	speed: 0.2242s/iter; left time: 2878.6586s
Epoch: 17 cost time: 9.113950252532959
Epoch: 17, Steps: 154 | Train Loss: 1.240 Vali Loss: 3.617 Vali Acc: 0.077 Test Loss: 3.617 Test Acc: 0.077
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.3343283
	speed: 0.2336s/iter; left time: 2963.1861s
Epoch: 18 cost time: 8.66873025894165
Epoch: 18, Steps: 154 | Train Loss: 1.192 Vali Loss: 3.049 Vali Acc: 0.170 Test Loss: 3.049 Test Acc: 0.170
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.4573091
	speed: 0.2402s/iter; left time: 3008.9989s
Epoch: 19 cost time: 9.112274885177612
Epoch: 19, Steps: 154 | Train Loss: 1.167 Vali Loss: 3.691 Vali Acc: 0.080 Test Loss: 3.691 Test Acc: 0.080
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.1325135
	speed: 0.1986s/iter; left time: 2457.3850s
Epoch: 20 cost time: 8.746750116348267
Epoch: 20, Steps: 154 | Train Loss: 1.141 Vali Loss: 3.158 Vali Acc: 0.115 Test Loss: 3.158 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.9181669
	speed: 0.2086s/iter; left time: 2548.8552s
Epoch: 21 cost time: 8.63612174987793
Epoch: 21, Steps: 154 | Train Loss: 1.072 Vali Loss: 2.991 Vali Acc: 0.185 Test Loss: 2.991 Test Acc: 0.185
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37388483373884834
model parameter : 203614
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2427340
	speed: 0.0652s/iter; left time: 997.9164s
Epoch: 1 cost time: 9.027711868286133
Epoch: 1, Steps: 154 | Train Loss: 2.229 Vali Loss: 2.156 Vali Acc: 0.318 Test Loss: 2.156 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5707012
	speed: 0.2150s/iter; left time: 3256.2669s
Epoch: 2 cost time: 8.84081745147705
Epoch: 2, Steps: 154 | Train Loss: 2.042 Vali Loss: 2.220 Vali Acc: 0.321 Test Loss: 2.220 Test Acc: 0.321
Validation loss decreased (-0.318308 --> -0.320740).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1505089
	speed: 0.2345s/iter; left time: 3516.3020s
Epoch: 3 cost time: 8.575550079345703
Epoch: 3, Steps: 154 | Train Loss: 1.952 Vali Loss: 2.166 Vali Acc: 0.327 Test Loss: 2.166 Test Acc: 0.327
Validation loss decreased (-0.320740 --> -0.326823).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6437871
	speed: 0.2219s/iter; left time: 3292.7076s
Epoch: 4 cost time: 8.636490106582642
Epoch: 4, Steps: 154 | Train Loss: 1.802 Vali Loss: 2.560 Vali Acc: 0.337 Test Loss: 2.560 Test Acc: 0.337
Validation loss decreased (-0.326823 --> -0.337363).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0507996
	speed: 0.2322s/iter; left time: 3410.4723s
Epoch: 5 cost time: 8.691451787948608
Epoch: 5, Steps: 154 | Train Loss: 1.720 Vali Loss: 2.559 Vali Acc: 0.345 Test Loss: 2.559 Test Acc: 0.345
Validation loss decreased (-0.337363 --> -0.345473).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2634391
	speed: 0.2350s/iter; left time: 3414.9574s
Epoch: 6 cost time: 8.911297798156738
Epoch: 6, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.472 Vali Acc: 0.352 Test Loss: 2.472 Test Acc: 0.352
Validation loss decreased (-0.345473 --> -0.351557).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2828966
	speed: 0.2316s/iter; left time: 3329.1612s
Epoch: 7 cost time: 8.834931373596191
Epoch: 7, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.402 Vali Acc: 0.352 Test Loss: 2.402 Test Acc: 0.352
Validation loss decreased (-0.351557 --> -0.352369).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5344614
	speed: 0.2137s/iter; left time: 3039.1493s
Epoch: 8 cost time: 8.848435640335083
Epoch: 8, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.411 Vali Acc: 0.358 Test Loss: 2.411 Test Acc: 0.358
Validation loss decreased (-0.352369 --> -0.358046).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4829015
	speed: 0.2322s/iter; left time: 3267.2772s
Epoch: 9 cost time: 9.007638454437256
Epoch: 9, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.400 Vali Acc: 0.371 Test Loss: 2.400 Test Acc: 0.371
Validation loss decreased (-0.358046 --> -0.371022).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2800815
	speed: 0.2163s/iter; left time: 3010.1252s
Epoch: 10 cost time: 7.843889951705933
Epoch: 10, Steps: 154 | Train Loss: 1.409 Vali Loss: 2.337 Vali Acc: 0.374 Test Loss: 2.337 Test Acc: 0.374
Validation loss decreased (-0.371022 --> -0.374267).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5104270
	speed: 0.2255s/iter; left time: 3103.1079s
Epoch: 11 cost time: 8.353656768798828
Epoch: 11, Steps: 154 | Train Loss: 1.371 Vali Loss: 2.530 Vali Acc: 0.379 Test Loss: 2.530 Test Acc: 0.379
Validation loss decreased (-0.374267 --> -0.379131).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6332356
	speed: 0.2257s/iter; left time: 3070.8847s
Epoch: 12 cost time: 9.085275411605835
Epoch: 12, Steps: 154 | Train Loss: 1.309 Vali Loss: 2.629 Vali Acc: 0.214 Test Loss: 2.629 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6225396
	speed: 0.2262s/iter; left time: 3042.9805s
Epoch: 13 cost time: 7.990571737289429
Epoch: 13, Steps: 154 | Train Loss: 1.328 Vali Loss: 2.470 Vali Acc: 0.373 Test Loss: 2.470 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.0762012
	speed: 0.2044s/iter; left time: 2718.1463s
Epoch: 14 cost time: 8.451772451400757
Epoch: 14, Steps: 154 | Train Loss: 1.316 Vali Loss: 2.525 Vali Acc: 0.381 Test Loss: 2.525 Test Acc: 0.381
Validation loss decreased (-0.379131 --> -0.381159).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4498582
	speed: 0.2365s/iter; left time: 3108.9534s
Epoch: 15 cost time: 8.804983854293823
Epoch: 15, Steps: 154 | Train Loss: 1.309 Vali Loss: 2.612 Vali Acc: 0.361 Test Loss: 2.612 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.1980649
	speed: 0.2296s/iter; left time: 2983.1796s
Epoch: 16 cost time: 8.224120378494263
Epoch: 16, Steps: 154 | Train Loss: 1.220 Vali Loss: 2.696 Vali Acc: 0.370 Test Loss: 2.696 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.1585385
	speed: 0.2343s/iter; left time: 3007.5665s
Epoch: 17 cost time: 9.295124053955078
Epoch: 17, Steps: 154 | Train Loss: 1.145 Vali Loss: 2.459 Vali Acc: 0.388 Test Loss: 2.459 Test Acc: 0.388
Validation loss decreased (-0.381159 --> -0.388053).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.3994787
	speed: 0.2403s/iter; left time: 3047.9351s
Epoch: 18 cost time: 8.983189582824707
Epoch: 18, Steps: 154 | Train Loss: 1.094 Vali Loss: 2.707 Vali Acc: 0.232 Test Loss: 2.707 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.4178814
	speed: 0.2117s/iter; left time: 2652.3462s
Epoch: 19 cost time: 8.055662393569946
Epoch: 19, Steps: 154 | Train Loss: 1.102 Vali Loss: 2.732 Vali Acc: 0.179 Test Loss: 2.732 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.1801504
	speed: 0.2357s/iter; left time: 2916.8019s
Epoch: 20 cost time: 8.699248552322388
Epoch: 20, Steps: 154 | Train Loss: 1.109 Vali Loss: 2.528 Vali Acc: 0.371 Test Loss: 2.528 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.9323350
	speed: 0.2379s/iter; left time: 2907.7410s
Epoch: 21 cost time: 9.166028499603271
Epoch: 21, Steps: 154 | Train Loss: 1.162 Vali Loss: 2.924 Vali Acc: 0.116 Test Loss: 2.924 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.8077112
	speed: 0.2328s/iter; left time: 2808.8816s
Epoch: 22 cost time: 8.680629253387451
Epoch: 22, Steps: 154 | Train Loss: 1.034 Vali Loss: 2.873 Vali Acc: 0.187 Test Loss: 2.873 Test Acc: 0.187
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.4466982
	speed: 0.2371s/iter; left time: 2824.2295s
Epoch: 23 cost time: 8.599759817123413
Epoch: 23, Steps: 154 | Train Loss: 1.097 Vali Loss: 2.799 Vali Acc: 0.335 Test Loss: 2.799 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.0249175
	speed: 0.2080s/iter; left time: 2445.6231s
Epoch: 24 cost time: 8.285314559936523
Epoch: 24, Steps: 154 | Train Loss: 1.007 Vali Loss: 3.076 Vali Acc: 0.242 Test Loss: 3.076 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.9848835
	speed: 0.2265s/iter; left time: 2628.1889s
Epoch: 25 cost time: 9.034358978271484
Epoch: 25, Steps: 154 | Train Loss: 0.953 Vali Loss: 3.127 Vali Acc: 0.236 Test Loss: 3.127 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.8406473
	speed: 0.2250s/iter; left time: 2576.3937s
Epoch: 26 cost time: 8.630767583847046
Epoch: 26, Steps: 154 | Train Loss: 1.137 Vali Loss: 2.837 Vali Acc: 0.220 Test Loss: 2.837 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.7675878
	speed: 0.2262s/iter; left time: 2554.9255s
Epoch: 27 cost time: 8.735507726669312
Epoch: 27, Steps: 154 | Train Loss: 0.979 Vali Loss: 3.029 Vali Acc: 0.227 Test Loss: 3.029 Test Acc: 0.227
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3880778588807786
model parameter : 203614
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8940142
	speed: 0.0720s/iter; left time: 1101.2443s
Epoch: 1 cost time: 10.205468654632568
Epoch: 1, Steps: 154 | Train Loss: 2.248 Vali Loss: 2.151 Vali Acc: 0.316 Test Loss: 2.151 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2062852
	speed: 0.2065s/iter; left time: 3128.5560s
Epoch: 2 cost time: 8.610210180282593
Epoch: 2, Steps: 154 | Train Loss: 2.056 Vali Loss: 2.161 Vali Acc: 0.328 Test Loss: 2.161 Test Acc: 0.328
Validation loss decreased (-0.315875 --> -0.327635).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7444202
	speed: 0.2137s/iter; left time: 3204.3034s
Epoch: 3 cost time: 8.09437370300293
Epoch: 3, Steps: 154 | Train Loss: 2.001 Vali Loss: 2.196 Vali Acc: 0.326 Test Loss: 2.196 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5432041
	speed: 0.2242s/iter; left time: 3326.5533s
Epoch: 4 cost time: 8.907617807388306
Epoch: 4, Steps: 154 | Train Loss: 1.919 Vali Loss: 2.218 Vali Acc: 0.323 Test Loss: 2.218 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.3097754
	speed: 0.2382s/iter; left time: 3497.4624s
Epoch: 5 cost time: 9.120623588562012
Epoch: 5, Steps: 154 | Train Loss: 1.910 Vali Loss: 2.203 Vali Acc: 0.328 Test Loss: 2.203 Test Acc: 0.328
Validation loss decreased (-0.327635 --> -0.328040).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8678665
	speed: 0.2258s/iter; left time: 3281.3283s
Epoch: 6 cost time: 9.410975456237793
Epoch: 6, Steps: 154 | Train Loss: 1.764 Vali Loss: 2.243 Vali Acc: 0.339 Test Loss: 2.243 Test Acc: 0.339
Validation loss decreased (-0.328040 --> -0.338583).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2970524
	speed: 0.2395s/iter; left time: 3443.4157s
Epoch: 7 cost time: 9.033032894134521
Epoch: 7, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.428 Vali Acc: 0.348 Test Loss: 2.428 Test Acc: 0.348
Validation loss decreased (-0.338583 --> -0.348313).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5764604
	speed: 0.2323s/iter; left time: 3304.5561s
Epoch: 8 cost time: 8.510818243026733
Epoch: 8, Steps: 154 | Train Loss: 1.692 Vali Loss: 2.369 Vali Acc: 0.357 Test Loss: 2.369 Test Acc: 0.357
Validation loss decreased (-0.348313 --> -0.356830).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3442227
	speed: 0.2186s/iter; left time: 3075.3486s
Epoch: 9 cost time: 9.618099451065063
Epoch: 9, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.573 Vali Acc: 0.351 Test Loss: 2.573 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6580669
	speed: 0.2312s/iter; left time: 3217.1675s
Epoch: 10 cost time: 9.047584772109985
Epoch: 10, Steps: 154 | Train Loss: 1.578 Vali Loss: 2.775 Vali Acc: 0.069 Test Loss: 2.775 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4315239
	speed: 0.2265s/iter; left time: 3117.4828s
Epoch: 11 cost time: 8.00377893447876
Epoch: 11, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.474 Vali Acc: 0.210 Test Loss: 2.474 Test Acc: 0.210
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.0286342
	speed: 0.2271s/iter; left time: 3089.9134s
Epoch: 12 cost time: 9.135364532470703
Epoch: 12, Steps: 154 | Train Loss: 1.481 Vali Loss: 2.977 Vali Acc: 0.073 Test Loss: 2.977 Test Acc: 0.073
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.3679219
	speed: 0.2381s/iter; left time: 3203.1658s
Epoch: 13 cost time: 9.247325658798218
Epoch: 13, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.883 Vali Acc: 0.083 Test Loss: 2.883 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.8299587
	speed: 0.2319s/iter; left time: 3084.5044s
Epoch: 14 cost time: 8.790640592575073
Epoch: 14, Steps: 154 | Train Loss: 1.410 Vali Loss: 2.805 Vali Acc: 0.199 Test Loss: 2.805 Test Acc: 0.199
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.5765387
	speed: 0.2185s/iter; left time: 2872.8043s
Epoch: 15 cost time: 7.702436208724976
Epoch: 15, Steps: 154 | Train Loss: 1.421 Vali Loss: 2.809 Vali Acc: 0.098 Test Loss: 2.809 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.4522098
	speed: 0.2280s/iter; left time: 2962.3620s
Epoch: 16 cost time: 9.196476221084595
Epoch: 16, Steps: 154 | Train Loss: 1.456 Vali Loss: 3.109 Vali Acc: 0.076 Test Loss: 3.109 Test Acc: 0.076
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.6055437
	speed: 0.2351s/iter; left time: 3017.7519s
Epoch: 17 cost time: 9.490469455718994
Epoch: 17, Steps: 154 | Train Loss: 1.381 Vali Loss: 3.145 Vali Acc: 0.086 Test Loss: 3.145 Test Acc: 0.086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.3836673
	speed: 0.2296s/iter; left time: 2911.4082s
Epoch: 18 cost time: 8.0793616771698
Epoch: 18, Steps: 154 | Train Loss: 1.344 Vali Loss: 2.990 Vali Acc: 0.196 Test Loss: 2.990 Test Acc: 0.196
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35685320356853206
model parameter : 170846
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9463574
	speed: 0.0727s/iter; left time: 1112.8209s
Epoch: 1 cost time: 10.455568552017212
Epoch: 1, Steps: 154 | Train Loss: 2.248 Vali Loss: 2.151 Vali Acc: 0.316 Test Loss: 2.151 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1967132
	speed: 0.2284s/iter; left time: 3458.9019s
Epoch: 2 cost time: 9.057773113250732
Epoch: 2, Steps: 154 | Train Loss: 2.063 Vali Loss: 2.160 Vali Acc: 0.326 Test Loss: 2.160 Test Acc: 0.326
Validation loss decreased (-0.315875 --> -0.326418).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7458282
	speed: 0.2266s/iter; left time: 3397.4614s
Epoch: 3 cost time: 8.112654209136963
Epoch: 3, Steps: 154 | Train Loss: 1.989 Vali Loss: 2.178 Vali Acc: 0.329 Test Loss: 2.178 Test Acc: 0.329
Validation loss decreased (-0.326418 --> -0.328851).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5765581
	speed: 0.2175s/iter; left time: 3227.8361s
Epoch: 4 cost time: 9.097784996032715
Epoch: 4, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.221 Vali Acc: 0.329 Test Loss: 2.221 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3225851
	speed: 0.2265s/iter; left time: 3326.2366s
Epoch: 5 cost time: 9.16034483909607
Epoch: 5, Steps: 154 | Train Loss: 1.883 Vali Loss: 2.199 Vali Acc: 0.333 Test Loss: 2.199 Test Acc: 0.333
Validation loss decreased (-0.328851 --> -0.333311).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7335026
	speed: 0.2291s/iter; left time: 3328.4665s
Epoch: 6 cost time: 7.911114692687988
Epoch: 6, Steps: 154 | Train Loss: 1.749 Vali Loss: 2.196 Vali Acc: 0.348 Test Loss: 2.196 Test Acc: 0.348
Validation loss decreased (-0.333311 --> -0.347504).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3540989
	speed: 0.2301s/iter; left time: 3308.3706s
Epoch: 7 cost time: 8.81235384941101
Epoch: 7, Steps: 154 | Train Loss: 1.675 Vali Loss: 2.356 Vali Acc: 0.328 Test Loss: 2.356 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5849528
	speed: 0.2268s/iter; left time: 3225.0776s
Epoch: 8 cost time: 8.683239459991455
Epoch: 8, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.348 Vali Acc: 0.347 Test Loss: 2.348 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.2433561
	speed: 0.1940s/iter; left time: 2729.7119s
Epoch: 9 cost time: 9.322350263595581
Epoch: 9, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.518 Vali Acc: 0.358 Test Loss: 2.518 Test Acc: 0.358
Validation loss decreased (-0.347504 --> -0.357639).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4424554
	speed: 0.2329s/iter; left time: 3241.0513s
Epoch: 10 cost time: 9.389040470123291
Epoch: 10, Steps: 154 | Train Loss: 1.561 Vali Loss: 2.534 Vali Acc: 0.361 Test Loss: 2.534 Test Acc: 0.361
Validation loss decreased (-0.357639 --> -0.361289).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7041726
	speed: 0.2183s/iter; left time: 3003.7735s
Epoch: 11 cost time: 8.093031406402588
Epoch: 11, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.407 Vali Acc: 0.369 Test Loss: 2.407 Test Acc: 0.369
Validation loss decreased (-0.361289 --> -0.369400).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.8518362
	speed: 0.2468s/iter; left time: 3357.7550s
Epoch: 12 cost time: 9.08727502822876
Epoch: 12, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.628 Vali Acc: 0.212 Test Loss: 2.628 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.3324113
	speed: 0.2249s/iter; left time: 3025.8536s
Epoch: 13 cost time: 8.706793546676636
Epoch: 13, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.679 Vali Acc: 0.366 Test Loss: 2.679 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.4360278
	speed: 0.2133s/iter; left time: 2837.0941s
Epoch: 14 cost time: 8.481024980545044
Epoch: 14, Steps: 154 | Train Loss: 1.401 Vali Loss: 2.810 Vali Acc: 0.195 Test Loss: 2.810 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.7507026
	speed: 0.2242s/iter; left time: 2946.7613s
Epoch: 15 cost time: 8.547184705734253
Epoch: 15, Steps: 154 | Train Loss: 1.349 Vali Loss: 2.672 Vali Acc: 0.204 Test Loss: 2.672 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.3082998
	speed: 0.2069s/iter; left time: 2687.4842s
Epoch: 16 cost time: 7.82454252243042
Epoch: 16, Steps: 154 | Train Loss: 1.322 Vali Loss: 2.922 Vali Acc: 0.146 Test Loss: 2.922 Test Acc: 0.146
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.4309311
	speed: 0.2190s/iter; left time: 2811.9440s
Epoch: 17 cost time: 9.1370267868042
Epoch: 17, Steps: 154 | Train Loss: 1.283 Vali Loss: 3.076 Vali Acc: 0.089 Test Loss: 3.076 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.5157071
	speed: 0.2264s/iter; left time: 2871.1391s
Epoch: 18 cost time: 8.975879430770874
Epoch: 18, Steps: 154 | Train Loss: 1.277 Vali Loss: 2.845 Vali Acc: 0.202 Test Loss: 2.845 Test Acc: 0.202
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.1615515
	speed: 0.2171s/iter; left time: 2720.2864s
Epoch: 19 cost time: 7.837764024734497
Epoch: 19, Steps: 154 | Train Loss: 1.343 Vali Loss: 3.083 Vali Acc: 0.083 Test Loss: 3.083 Test Acc: 0.083
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.1064723
	speed: 0.2255s/iter; left time: 2790.3316s
Epoch: 20 cost time: 8.680782079696655
Epoch: 20, Steps: 154 | Train Loss: 1.214 Vali Loss: 2.758 Vali Acc: 0.212 Test Loss: 2.758 Test Acc: 0.212
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.1387001
	speed: 0.2286s/iter; left time: 2793.7982s
Epoch: 21 cost time: 9.124138116836548
Epoch: 21, Steps: 154 | Train Loss: 1.207 Vali Loss: 3.086 Vali Acc: 0.087 Test Loss: 3.086 Test Acc: 0.087
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36942416869424166
model parameter : 170846
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9224887
	speed: 0.0707s/iter; left time: 1081.3433s
Epoch: 1 cost time: 9.929861545562744
Epoch: 1, Steps: 154 | Train Loss: 2.225 Vali Loss: 2.151 Vali Acc: 0.316 Test Loss: 2.151 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2014594
	speed: 0.2262s/iter; left time: 3426.7209s
Epoch: 2 cost time: 9.030208110809326
Epoch: 2, Steps: 154 | Train Loss: 2.058 Vali Loss: 2.142 Vali Acc: 0.326 Test Loss: 2.142 Test Acc: 0.326
Validation loss decreased (-0.316280 --> -0.326418).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7162799
	speed: 0.2335s/iter; left time: 3500.2850s
Epoch: 3 cost time: 8.607971429824829
Epoch: 3, Steps: 154 | Train Loss: 1.973 Vali Loss: 2.179 Vali Acc: 0.325 Test Loss: 2.179 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6127061
	speed: 0.2094s/iter; left time: 3107.2072s
Epoch: 4 cost time: 8.551447868347168
Epoch: 4, Steps: 154 | Train Loss: 1.877 Vali Loss: 2.232 Vali Acc: 0.328 Test Loss: 2.232 Test Acc: 0.328
Validation loss decreased (-0.326418 --> -0.328039).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3301287
	speed: 0.2156s/iter; left time: 3165.9844s
Epoch: 5 cost time: 8.55911660194397
Epoch: 5, Steps: 154 | Train Loss: 1.865 Vali Loss: 2.217 Vali Acc: 0.338 Test Loss: 2.217 Test Acc: 0.338
Validation loss decreased (-0.328039 --> -0.337772).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6334964
	speed: 0.2127s/iter; left time: 3090.6359s
Epoch: 6 cost time: 8.429234504699707
Epoch: 6, Steps: 154 | Train Loss: 1.705 Vali Loss: 2.245 Vali Acc: 0.354 Test Loss: 2.245 Test Acc: 0.354
Validation loss decreased (-0.337772 --> -0.353587).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2723451
	speed: 0.2099s/iter; left time: 3017.1683s
Epoch: 7 cost time: 8.435186386108398
Epoch: 7, Steps: 154 | Train Loss: 1.632 Vali Loss: 2.356 Vali Acc: 0.351 Test Loss: 2.356 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5405055
	speed: 0.1993s/iter; left time: 2834.3408s
Epoch: 8 cost time: 6.970763683319092
Epoch: 8, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.358 Vali Acc: 0.343 Test Loss: 2.358 Test Acc: 0.343
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.2071781
	speed: 0.2000s/iter; left time: 2813.2291s
Epoch: 9 cost time: 8.456493139266968
Epoch: 9, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.563 Vali Acc: 0.353 Test Loss: 2.563 Test Acc: 0.353
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2893972
	speed: 0.2228s/iter; left time: 3100.2682s
Epoch: 10 cost time: 8.408958911895752
Epoch: 10, Steps: 154 | Train Loss: 1.473 Vali Loss: 2.472 Vali Acc: 0.365 Test Loss: 2.472 Test Acc: 0.365
Validation loss decreased (-0.353587 --> -0.364939).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5990696
	speed: 0.2293s/iter; left time: 3155.7090s
Epoch: 11 cost time: 8.210526704788208
Epoch: 11, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.454 Vali Acc: 0.367 Test Loss: 2.454 Test Acc: 0.367
Validation loss decreased (-0.364939 --> -0.366561).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0219103
	speed: 0.2106s/iter; left time: 2865.2387s
Epoch: 12 cost time: 8.440500259399414
Epoch: 12, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.553 Vali Acc: 0.205 Test Loss: 2.553 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4694743
	speed: 0.2151s/iter; left time: 2894.1067s
Epoch: 13 cost time: 8.40720248222351
Epoch: 13, Steps: 154 | Train Loss: 1.367 Vali Loss: 2.672 Vali Acc: 0.350 Test Loss: 2.672 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.4653029
	speed: 0.2023s/iter; left time: 2690.6349s
Epoch: 14 cost time: 8.603970050811768
Epoch: 14, Steps: 154 | Train Loss: 1.335 Vali Loss: 2.723 Vali Acc: 0.200 Test Loss: 2.723 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.4114288
	speed: 0.2183s/iter; left time: 2869.7283s
Epoch: 15 cost time: 8.740534543991089
Epoch: 15, Steps: 154 | Train Loss: 1.348 Vali Loss: 2.664 Vali Acc: 0.197 Test Loss: 2.664 Test Acc: 0.197
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.3967208
	speed: 0.2323s/iter; left time: 3018.2817s
Epoch: 16 cost time: 8.325211524963379
Epoch: 16, Steps: 154 | Train Loss: 1.250 Vali Loss: 2.893 Vali Acc: 0.206 Test Loss: 2.893 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.6439333
	speed: 0.2096s/iter; left time: 2690.1166s
Epoch: 17 cost time: 8.749517917633057
Epoch: 17, Steps: 154 | Train Loss: 1.226 Vali Loss: 2.631 Vali Acc: 0.221 Test Loss: 2.631 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.3322623
	speed: 0.2223s/iter; left time: 2820.0067s
Epoch: 18 cost time: 8.431148052215576
Epoch: 18, Steps: 154 | Train Loss: 1.258 Vali Loss: 2.902 Vali Acc: 0.207 Test Loss: 2.902 Test Acc: 0.207
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.0027758
	speed: 0.2139s/iter; left time: 2679.7781s
Epoch: 19 cost time: 8.316367864608765
Epoch: 19, Steps: 154 | Train Loss: 1.216 Vali Loss: 3.078 Vali Acc: 0.163 Test Loss: 3.078 Test Acc: 0.163
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.1451379
	speed: 0.2071s/iter; left time: 2563.0768s
Epoch: 20 cost time: 8.269829511642456
Epoch: 20, Steps: 154 | Train Loss: 1.161 Vali Loss: 2.823 Vali Acc: 0.214 Test Loss: 2.823 Test Acc: 0.214
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.0699594
	speed: 0.2072s/iter; left time: 2532.3475s
Epoch: 21 cost time: 7.957040786743164
Epoch: 21, Steps: 154 | Train Loss: 1.158 Vali Loss: 3.045 Vali Acc: 0.201 Test Loss: 3.045 Test Acc: 0.201
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36658556366585565
model parameter : 170846
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8810968
	speed: 0.0681s/iter; left time: 1041.7143s
Epoch: 1 cost time: 9.48187804222107
Epoch: 1, Steps: 154 | Train Loss: 2.203 Vali Loss: 2.158 Vali Acc: 0.317 Test Loss: 2.158 Test Acc: 0.317
Validation loss decreased (inf --> -0.317091).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1401308
	speed: 0.2141s/iter; left time: 3242.3183s
Epoch: 2 cost time: 8.321828126907349
Epoch: 2, Steps: 154 | Train Loss: 2.058 Vali Loss: 2.139 Vali Acc: 0.326 Test Loss: 2.139 Test Acc: 0.326
Validation loss decreased (-0.317091 --> -0.326013).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6654129
	speed: 0.1896s/iter; left time: 2842.0553s
Epoch: 3 cost time: 7.433379411697388
Epoch: 3, Steps: 154 | Train Loss: 1.961 Vali Loss: 2.361 Vali Acc: 0.324 Test Loss: 2.361 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.4363827
	speed: 0.1945s/iter; left time: 2885.6548s
Epoch: 4 cost time: 8.034560918807983
Epoch: 4, Steps: 154 | Train Loss: 1.856 Vali Loss: 2.483 Vali Acc: 0.333 Test Loss: 2.483 Test Acc: 0.333
Validation loss decreased (-0.326013 --> -0.332903).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9611375
	speed: 0.2081s/iter; left time: 3056.4701s
Epoch: 5 cost time: 8.186757564544678
Epoch: 5, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.663 Vali Acc: 0.344 Test Loss: 2.663 Test Acc: 0.344
Validation loss decreased (-0.332903 --> -0.343850).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5013341
	speed: 0.2186s/iter; left time: 3176.7363s
Epoch: 6 cost time: 8.245465278625488
Epoch: 6, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.577 Vali Acc: 0.350 Test Loss: 2.577 Test Acc: 0.350
Validation loss decreased (-0.343850 --> -0.349934).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1015499
	speed: 0.2289s/iter; left time: 3291.2644s
Epoch: 7 cost time: 8.52452301979065
Epoch: 7, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.568 Vali Acc: 0.358 Test Loss: 2.568 Test Acc: 0.358
Validation loss decreased (-0.349934 --> -0.358044).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5347284
	speed: 0.2031s/iter; left time: 2888.8370s
Epoch: 8 cost time: 7.687147378921509
Epoch: 8, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.403 Vali Acc: 0.365 Test Loss: 2.403 Test Acc: 0.365
Validation loss decreased (-0.358044 --> -0.364534).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.0446098
	speed: 0.2325s/iter; left time: 3270.9427s
Epoch: 9 cost time: 8.419463872909546
Epoch: 9, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.728 Vali Acc: 0.354 Test Loss: 2.728 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2940097
	speed: 0.2148s/iter; left time: 2989.0191s
Epoch: 10 cost time: 8.239988088607788
Epoch: 10, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.561 Vali Acc: 0.360 Test Loss: 2.561 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.3038005
	speed: 0.2010s/iter; left time: 2766.0080s
Epoch: 11 cost time: 8.283694982528687
Epoch: 11, Steps: 154 | Train Loss: 1.357 Vali Loss: 2.611 Vali Acc: 0.375 Test Loss: 2.611 Test Acc: 0.375
Validation loss decreased (-0.364534 --> -0.375075).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9244648
	speed: 0.2082s/iter; left time: 2832.7859s
Epoch: 12 cost time: 8.129323244094849
Epoch: 12, Steps: 154 | Train Loss: 1.336 Vali Loss: 2.714 Vali Acc: 0.376 Test Loss: 2.714 Test Acc: 0.376
Validation loss decreased (-0.375075 --> -0.376291).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.9011598
	speed: 0.2052s/iter; left time: 2760.2980s
Epoch: 13 cost time: 7.867441415786743
Epoch: 13, Steps: 154 | Train Loss: 1.294 Vali Loss: 2.719 Vali Acc: 0.371 Test Loss: 2.719 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3174527
	speed: 0.2211s/iter; left time: 2940.0181s
Epoch: 14 cost time: 8.33894157409668
Epoch: 14, Steps: 154 | Train Loss: 1.323 Vali Loss: 2.799 Vali Acc: 0.212 Test Loss: 2.799 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3155344
	speed: 0.2262s/iter; left time: 2973.8668s
Epoch: 15 cost time: 8.587528705596924
Epoch: 15, Steps: 154 | Train Loss: 1.269 Vali Loss: 2.786 Vali Acc: 0.208 Test Loss: 2.786 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.2176278
	speed: 0.2038s/iter; left time: 2646.9495s
Epoch: 16 cost time: 7.233289480209351
Epoch: 16, Steps: 154 | Train Loss: 1.229 Vali Loss: 2.672 Vali Acc: 0.380 Test Loss: 2.672 Test Acc: 0.380
Validation loss decreased (-0.376291 --> -0.379535).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.2422578
	speed: 0.2039s/iter; left time: 2617.6202s
Epoch: 17 cost time: 7.5914530754089355
Epoch: 17, Steps: 154 | Train Loss: 1.188 Vali Loss: 2.694 Vali Acc: 0.379 Test Loss: 2.694 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.5194908
	speed: 0.1879s/iter; left time: 2383.6781s
Epoch: 18 cost time: 8.398614645004272
Epoch: 18, Steps: 154 | Train Loss: 1.176 Vali Loss: 2.914 Vali Acc: 0.352 Test Loss: 2.914 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.1879873
	speed: 0.2093s/iter; left time: 2622.7618s
Epoch: 19 cost time: 8.072690486907959
Epoch: 19, Steps: 154 | Train Loss: 1.105 Vali Loss: 2.940 Vali Acc: 0.272 Test Loss: 2.940 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.0558594
	speed: 0.2112s/iter; left time: 2613.3506s
Epoch: 20 cost time: 8.475038528442383
Epoch: 20, Steps: 154 | Train Loss: 1.085 Vali Loss: 2.666 Vali Acc: 0.292 Test Loss: 2.666 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.8735654
	speed: 0.1993s/iter; left time: 2435.7260s
Epoch: 21 cost time: 7.81866192817688
Epoch: 21, Steps: 154 | Train Loss: 1.092 Vali Loss: 2.850 Vali Acc: 0.238 Test Loss: 2.850 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.8039994
	speed: 0.2149s/iter; left time: 2592.9644s
Epoch: 22 cost time: 8.831925868988037
Epoch: 22, Steps: 154 | Train Loss: 1.058 Vali Loss: 2.825 Vali Acc: 0.387 Test Loss: 2.825 Test Acc: 0.387
Validation loss decreased (-0.379535 --> -0.386833).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.7610496
	speed: 0.2274s/iter; left time: 2708.4344s
Epoch: 23 cost time: 8.778257846832275
Epoch: 23, Steps: 154 | Train Loss: 1.234 Vali Loss: 3.469 Vali Acc: 0.116 Test Loss: 3.469 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.8463759
	speed: 0.2156s/iter; left time: 2535.1339s
Epoch: 24 cost time: 8.592962980270386
Epoch: 24, Steps: 154 | Train Loss: 1.019 Vali Loss: 3.013 Vali Acc: 0.175 Test Loss: 3.013 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.7189741
	speed: 0.2124s/iter; left time: 2465.2747s
Epoch: 25 cost time: 8.083086252212524
Epoch: 25, Steps: 154 | Train Loss: 1.070 Vali Loss: 3.084 Vali Acc: 0.291 Test Loss: 3.084 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.2562932
	speed: 0.2045s/iter; left time: 2341.4347s
Epoch: 26 cost time: 7.962474822998047
Epoch: 26, Steps: 154 | Train Loss: 1.015 Vali Loss: 2.960 Vali Acc: 0.362 Test Loss: 2.960 Test Acc: 0.362
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.5329186
	speed: 0.1933s/iter; left time: 2183.2777s
Epoch: 27 cost time: 7.887458562850952
Epoch: 27, Steps: 154 | Train Loss: 0.980 Vali Loss: 3.385 Vali Acc: 0.226 Test Loss: 3.385 Test Acc: 0.226
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.6217693
	speed: 0.2020s/iter; left time: 2251.1863s
Epoch: 28 cost time: 8.013159990310669
Epoch: 28, Steps: 154 | Train Loss: 0.911 Vali Loss: 3.329 Vali Acc: 0.126 Test Loss: 3.329 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.6328509
	speed: 0.1908s/iter; left time: 2096.3370s
Epoch: 29 cost time: 7.3170342445373535
Epoch: 29, Steps: 154 | Train Loss: 0.958 Vali Loss: 3.071 Vali Acc: 0.217 Test Loss: 3.071 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.5713835
	speed: 0.1902s/iter; left time: 2060.4347s
Epoch: 30 cost time: 7.858593702316284
Epoch: 30, Steps: 154 | Train Loss: 0.999 Vali Loss: 3.038 Vali Acc: 0.291 Test Loss: 3.038 Test Acc: 0.291
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.8774101
	speed: 0.2147s/iter; left time: 2292.9596s
Epoch: 31 cost time: 8.148120880126953
Epoch: 31, Steps: 154 | Train Loss: 0.898 Vali Loss: 3.234 Vali Acc: 0.109 Test Loss: 3.234 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.5561008
	speed: 0.2175s/iter; left time: 2289.5164s
Epoch: 32 cost time: 9.979785442352295
Epoch: 32, Steps: 154 | Train Loss: 0.952 Vali Loss: 3.467 Vali Acc: 0.122 Test Loss: 3.467 Test Acc: 0.122
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38686131386861317
model parameter : 170846
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2017951
	speed: 0.0896s/iter; left time: 1371.0287s
Epoch: 1 cost time: 12.646947383880615
Epoch: 1, Steps: 154 | Train Loss: 2.265 Vali Loss: 2.167 Vali Acc: 0.318 Test Loss: 2.167 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6719168
	speed: 0.2770s/iter; left time: 4196.0970s
Epoch: 2 cost time: 12.441741704940796
Epoch: 2, Steps: 154 | Train Loss: 2.048 Vali Loss: 2.154 Vali Acc: 0.320 Test Loss: 2.154 Test Acc: 0.320
Validation loss decreased (-0.317497 --> -0.320335).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5768492
	speed: 0.2654s/iter; left time: 3978.5829s
Epoch: 3 cost time: 10.808552980422974
Epoch: 3, Steps: 154 | Train Loss: 2.002 Vali Loss: 2.126 Vali Acc: 0.323 Test Loss: 2.126 Test Acc: 0.323
Validation loss decreased (-0.320335 --> -0.322769).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5803317
	speed: 0.2695s/iter; left time: 3999.5922s
Epoch: 4 cost time: 10.557246685028076
Epoch: 4, Steps: 154 | Train Loss: 1.921 Vali Loss: 2.207 Vali Acc: 0.324 Test Loss: 2.207 Test Acc: 0.324
Validation loss decreased (-0.322769 --> -0.324390).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9065254
	speed: 0.2478s/iter; left time: 3639.2948s
Epoch: 5 cost time: 8.785338878631592
Epoch: 5, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.157 Vali Acc: 0.335 Test Loss: 2.157 Test Acc: 0.335
Validation loss decreased (-0.324390 --> -0.334528).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6639931
	speed: 0.2001s/iter; left time: 2907.4632s
Epoch: 6 cost time: 10.76533317565918
Epoch: 6, Steps: 154 | Train Loss: 1.798 Vali Loss: 2.229 Vali Acc: 0.333 Test Loss: 2.229 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.0997267
	speed: 0.2755s/iter; left time: 3961.5668s
Epoch: 7 cost time: 11.653927087783813
Epoch: 7, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.277 Vali Acc: 0.345 Test Loss: 2.277 Test Acc: 0.345
Validation loss decreased (-0.334528 --> -0.345070).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9507222
	speed: 0.2839s/iter; left time: 4037.3870s
Epoch: 8 cost time: 12.595081567764282
Epoch: 8, Steps: 154 | Train Loss: 1.661 Vali Loss: 2.262 Vali Acc: 0.350 Test Loss: 2.262 Test Acc: 0.350
Validation loss decreased (-0.345070 --> -0.350342).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8663465
	speed: 0.2794s/iter; left time: 3931.3520s
Epoch: 9 cost time: 11.087726593017578
Epoch: 9, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.401 Vali Acc: 0.351 Test Loss: 2.401 Test Acc: 0.351
Validation loss decreased (-0.350342 --> -0.350746).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0788231
	speed: 0.1869s/iter; left time: 2600.9419s
Epoch: 10 cost time: 8.018904447555542
Epoch: 10, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.356 Vali Acc: 0.352 Test Loss: 2.356 Test Acc: 0.352
Validation loss decreased (-0.350746 --> -0.351558).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1997067
	speed: 0.2435s/iter; left time: 3350.2071s
Epoch: 11 cost time: 10.374035120010376
Epoch: 11, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.536 Vali Acc: 0.350 Test Loss: 2.536 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2534456
	speed: 0.2414s/iter; left time: 3285.2343s
Epoch: 12 cost time: 9.526504039764404
Epoch: 12, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.458 Vali Acc: 0.353 Test Loss: 2.458 Test Acc: 0.353
Validation loss decreased (-0.351558 --> -0.353179).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8958397
	speed: 0.2516s/iter; left time: 3384.1432s
Epoch: 13 cost time: 11.625616312026978
Epoch: 13, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.599 Vali Acc: 0.200 Test Loss: 2.599 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.6014117
	speed: 0.2551s/iter; left time: 3392.0293s
Epoch: 14 cost time: 10.120893001556396
Epoch: 14, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.596 Vali Acc: 0.222 Test Loss: 2.596 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.1791922
	speed: 0.1909s/iter; left time: 2509.1251s
Epoch: 15 cost time: 8.611536264419556
Epoch: 15, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.612 Vali Acc: 0.359 Test Loss: 2.612 Test Acc: 0.359
Validation loss decreased (-0.353179 --> -0.358855).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.1472452
	speed: 0.2492s/iter; left time: 3237.8228s
Epoch: 16 cost time: 11.013783693313599
Epoch: 16, Steps: 154 | Train Loss: 1.388 Vali Loss: 2.576 Vali Acc: 0.200 Test Loss: 2.576 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.0836549
	speed: 0.2565s/iter; left time: 3292.8337s
Epoch: 17 cost time: 10.903767108917236
Epoch: 17, Steps: 154 | Train Loss: 1.340 Vali Loss: 2.633 Vali Acc: 0.362 Test Loss: 2.633 Test Acc: 0.362
Validation loss decreased (-0.358855 --> -0.362099).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.2873610
	speed: 0.2257s/iter; left time: 2862.0834s
Epoch: 18 cost time: 6.851867914199829
Epoch: 18, Steps: 154 | Train Loss: 1.328 Vali Loss: 2.619 Vali Acc: 0.360 Test Loss: 2.619 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.5730478
	speed: 0.2046s/iter; left time: 2563.2916s
Epoch: 19 cost time: 11.671892881393433
Epoch: 19, Steps: 154 | Train Loss: 1.322 Vali Loss: 2.870 Vali Acc: 0.200 Test Loss: 2.870 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.4694408
	speed: 0.2604s/iter; left time: 3222.4138s
Epoch: 20 cost time: 10.399816274642944
Epoch: 20, Steps: 154 | Train Loss: 1.278 Vali Loss: 2.908 Vali Acc: 0.207 Test Loss: 2.908 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.1710856
	speed: 0.2676s/iter; left time: 3270.1441s
Epoch: 21 cost time: 11.182589769363403
Epoch: 21, Steps: 154 | Train Loss: 1.312 Vali Loss: 2.842 Vali Acc: 0.204 Test Loss: 2.842 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.3538047
	speed: 0.2612s/iter; left time: 3152.2759s
Epoch: 22 cost time: 11.33816146850586
Epoch: 22, Steps: 154 | Train Loss: 1.252 Vali Loss: 2.994 Vali Acc: 0.194 Test Loss: 2.994 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.3235376
	speed: 0.1986s/iter; left time: 2365.8537s
Epoch: 23 cost time: 7.365330219268799
Epoch: 23, Steps: 154 | Train Loss: 1.241 Vali Loss: 2.870 Vali Acc: 0.202 Test Loss: 2.870 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.4177811
	speed: 0.2479s/iter; left time: 2915.3569s
Epoch: 24 cost time: 11.32588529586792
Epoch: 24, Steps: 154 | Train Loss: 1.222 Vali Loss: 3.167 Vali Acc: 0.073 Test Loss: 3.167 Test Acc: 0.073
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.9579546
	speed: 0.2523s/iter; left time: 2927.5987s
Epoch: 25 cost time: 10.152037620544434
Epoch: 25, Steps: 154 | Train Loss: 1.225 Vali Loss: 3.058 Vali Acc: 0.138 Test Loss: 3.058 Test Acc: 0.138
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 1.2650324
	speed: 0.2423s/iter; left time: 2774.3781s
Epoch: 26 cost time: 7.267562389373779
Epoch: 26, Steps: 154 | Train Loss: 1.272 Vali Loss: 2.906 Vali Acc: 0.210 Test Loss: 2.906 Test Acc: 0.210
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.4387550
	speed: 0.1998s/iter; left time: 2256.9313s
Epoch: 27 cost time: 11.217504501342773
Epoch: 27, Steps: 154 | Train Loss: 1.187 Vali Loss: 3.084 Vali Acc: 0.209 Test Loss: 3.084 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36212489862124897
model parameter : 576990
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2069135
	speed: 0.0924s/iter; left time: 1413.4023s
Epoch: 1 cost time: 13.183627128601074
Epoch: 1, Steps: 154 | Train Loss: 2.263 Vali Loss: 2.166 Vali Acc: 0.318 Test Loss: 2.166 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6828442
	speed: 0.2542s/iter; left time: 3850.4993s
Epoch: 2 cost time: 10.688256978988647
Epoch: 2, Steps: 154 | Train Loss: 2.042 Vali Loss: 2.155 Vali Acc: 0.320 Test Loss: 2.155 Test Acc: 0.320
Validation loss decreased (-0.318308 --> -0.320335).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5639681
	speed: 0.2350s/iter; left time: 3523.5779s
Epoch: 3 cost time: 7.276769399642944
Epoch: 3, Steps: 154 | Train Loss: 1.988 Vali Loss: 2.142 Vali Acc: 0.325 Test Loss: 2.142 Test Acc: 0.325
Validation loss decreased (-0.320335 --> -0.325202).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6580374
	speed: 0.2003s/iter; left time: 2972.6619s
Epoch: 4 cost time: 10.384408712387085
Epoch: 4, Steps: 154 | Train Loss: 1.924 Vali Loss: 2.179 Vali Acc: 0.327 Test Loss: 2.179 Test Acc: 0.327
Validation loss decreased (-0.325202 --> -0.327229).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9235393
	speed: 0.2312s/iter; left time: 3395.3691s
Epoch: 5 cost time: 10.111419200897217
Epoch: 5, Steps: 154 | Train Loss: 1.859 Vali Loss: 2.177 Vali Acc: 0.335 Test Loss: 2.177 Test Acc: 0.335
Validation loss decreased (-0.327229 --> -0.334934).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7056123
	speed: 0.2399s/iter; left time: 3486.5206s
Epoch: 6 cost time: 9.625285148620605
Epoch: 6, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.192 Vali Acc: 0.341 Test Loss: 2.192 Test Acc: 0.341
Validation loss decreased (-0.334934 --> -0.341016).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0494196
	speed: 0.2324s/iter; left time: 3340.5315s
Epoch: 7 cost time: 10.2809579372406
Epoch: 7, Steps: 154 | Train Loss: 1.716 Vali Loss: 2.366 Vali Acc: 0.341 Test Loss: 2.366 Test Acc: 0.341
Validation loss decreased (-0.341016 --> -0.341420).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8123351
	speed: 0.1931s/iter; left time: 2746.8367s
Epoch: 8 cost time: 6.427898645401001
Epoch: 8, Steps: 154 | Train Loss: 1.649 Vali Loss: 2.247 Vali Acc: 0.350 Test Loss: 2.247 Test Acc: 0.350
Validation loss decreased (-0.341420 --> -0.349531).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8087966
	speed: 0.2182s/iter; left time: 3069.7255s
Epoch: 9 cost time: 10.157509326934814
Epoch: 9, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.419 Vali Acc: 0.348 Test Loss: 2.419 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.9720070
	speed: 0.2663s/iter; left time: 3706.1543s
Epoch: 10 cost time: 10.798874855041504
Epoch: 10, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.385 Vali Acc: 0.352 Test Loss: 2.385 Test Acc: 0.352
Validation loss decreased (-0.349531 --> -0.351963).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1462989
	speed: 0.2568s/iter; left time: 3534.1556s
Epoch: 11 cost time: 11.132479429244995
Epoch: 11, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.509 Vali Acc: 0.347 Test Loss: 2.509 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0638809
	speed: 0.1856s/iter; left time: 2525.7411s
Epoch: 12 cost time: 8.521771430969238
Epoch: 12, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.435 Vali Acc: 0.356 Test Loss: 2.435 Test Acc: 0.356
Validation loss decreased (-0.351963 --> -0.356018).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8440955
	speed: 0.2438s/iter; left time: 3280.3863s
Epoch: 13 cost time: 10.28500247001648
Epoch: 13, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.584 Vali Acc: 0.198 Test Loss: 2.584 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4721668
	speed: 0.2330s/iter; left time: 3098.0996s
Epoch: 14 cost time: 10.081867933273315
Epoch: 14, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.512 Vali Acc: 0.361 Test Loss: 2.512 Test Acc: 0.361
Validation loss decreased (-0.356018 --> -0.361289).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2210259
	speed: 0.2292s/iter; left time: 3012.8933s
Epoch: 15 cost time: 7.751973390579224
Epoch: 15, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.605 Vali Acc: 0.357 Test Loss: 2.605 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0531725
	speed: 0.1886s/iter; left time: 2450.0515s
Epoch: 16 cost time: 10.693947076797485
Epoch: 16, Steps: 154 | Train Loss: 1.362 Vali Loss: 2.561 Vali Acc: 0.214 Test Loss: 2.561 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.1665322
	speed: 0.2245s/iter; left time: 2881.3712s
Epoch: 17 cost time: 9.70421028137207
Epoch: 17, Steps: 154 | Train Loss: 1.348 Vali Loss: 2.610 Vali Acc: 0.367 Test Loss: 2.610 Test Acc: 0.367
Validation loss decreased (-0.361289 --> -0.366559).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.1191190
	speed: 0.2499s/iter; left time: 3169.2745s
Epoch: 18 cost time: 9.956113576889038
Epoch: 18, Steps: 154 | Train Loss: 1.300 Vali Loss: 2.590 Vali Acc: 0.377 Test Loss: 2.590 Test Acc: 0.377
Validation loss decreased (-0.366559 --> -0.376698).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.5053132
	speed: 0.2390s/iter; left time: 2994.8704s
Epoch: 19 cost time: 10.329811573028564
Epoch: 19, Steps: 154 | Train Loss: 1.329 Vali Loss: 2.945 Vali Acc: 0.197 Test Loss: 2.945 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1516289
	speed: 0.2379s/iter; left time: 2943.9379s
Epoch: 20 cost time: 9.448405265808105
Epoch: 20, Steps: 154 | Train Loss: 1.293 Vali Loss: 2.948 Vali Acc: 0.203 Test Loss: 2.948 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.9971211
	speed: 0.1797s/iter; left time: 2196.5799s
Epoch: 21 cost time: 9.550790786743164
Epoch: 21, Steps: 154 | Train Loss: 1.251 Vali Loss: 3.056 Vali Acc: 0.198 Test Loss: 3.056 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 2.9936709
	speed: 0.2281s/iter; left time: 2752.6491s
Epoch: 22 cost time: 9.949250936508179
Epoch: 22, Steps: 154 | Train Loss: 1.230 Vali Loss: 2.939 Vali Acc: 0.183 Test Loss: 2.939 Test Acc: 0.183
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.2545007
	speed: 0.2488s/iter; left time: 2964.1917s
Epoch: 23 cost time: 9.751878023147583
Epoch: 23, Steps: 154 | Train Loss: 1.189 Vali Loss: 2.851 Vali Acc: 0.203 Test Loss: 2.851 Test Acc: 0.203
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.3438971
	speed: 0.2076s/iter; left time: 2441.7107s
Epoch: 24 cost time: 7.37148380279541
Epoch: 24, Steps: 154 | Train Loss: 1.164 Vali Loss: 3.307 Vali Acc: 0.077 Test Loss: 3.307 Test Acc: 0.077
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.0633965
	speed: 0.2258s/iter; left time: 2620.8203s
Epoch: 25 cost time: 10.612725257873535
Epoch: 25, Steps: 154 | Train Loss: 1.202 Vali Loss: 3.413 Vali Acc: 0.084 Test Loss: 3.413 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.9822869
	speed: 0.2594s/iter; left time: 2970.0860s
Epoch: 26 cost time: 10.020174026489258
Epoch: 26, Steps: 154 | Train Loss: 1.164 Vali Loss: 3.205 Vali Acc: 0.204 Test Loss: 3.205 Test Acc: 0.204
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 6.0393958
	speed: 0.2417s/iter; left time: 2730.8840s
Epoch: 27 cost time: 10.130296230316162
Epoch: 27, Steps: 154 | Train Loss: 1.200 Vali Loss: 3.446 Vali Acc: 0.150 Test Loss: 3.446 Test Acc: 0.150
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.7020721
	speed: 0.1830s/iter; left time: 2039.6950s
Epoch: 28 cost time: 6.259766101837158
Epoch: 28, Steps: 154 | Train Loss: 1.093 Vali Loss: 3.262 Vali Acc: 0.186 Test Loss: 3.262 Test Acc: 0.186
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3767234387672344
model parameter : 576990
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1876037
	speed: 0.0728s/iter; left time: 1114.4994s
Epoch: 1 cost time: 10.755558490753174
Epoch: 1, Steps: 154 | Train Loss: 2.258 Vali Loss: 2.156 Vali Acc: 0.318 Test Loss: 2.156 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6848158
	speed: 0.2374s/iter; left time: 3596.0919s
Epoch: 2 cost time: 9.839428186416626
Epoch: 2, Steps: 154 | Train Loss: 2.042 Vali Loss: 2.157 Vali Acc: 0.320 Test Loss: 2.157 Test Acc: 0.320
Validation loss decreased (-0.317902 --> -0.320335).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5745956
	speed: 0.2477s/iter; left time: 3714.3855s
Epoch: 3 cost time: 10.19498896598816
Epoch: 3, Steps: 154 | Train Loss: 1.976 Vali Loss: 2.133 Vali Acc: 0.326 Test Loss: 2.133 Test Acc: 0.326
Validation loss decreased (-0.320335 --> -0.326418).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6509290
	speed: 0.1969s/iter; left time: 2922.1937s
Epoch: 4 cost time: 7.795889377593994
Epoch: 4, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.173 Vali Acc: 0.329 Test Loss: 2.173 Test Acc: 0.329
Validation loss decreased (-0.326418 --> -0.329256).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8536490
	speed: 0.2304s/iter; left time: 3383.4417s
Epoch: 5 cost time: 9.336757183074951
Epoch: 5, Steps: 154 | Train Loss: 1.806 Vali Loss: 2.187 Vali Acc: 0.338 Test Loss: 2.187 Test Acc: 0.338
Validation loss decreased (-0.329256 --> -0.337772).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7184629
	speed: 0.2311s/iter; left time: 3358.5440s
Epoch: 6 cost time: 9.041089534759521
Epoch: 6, Steps: 154 | Train Loss: 1.755 Vali Loss: 2.180 Vali Acc: 0.347 Test Loss: 2.180 Test Acc: 0.347
Validation loss decreased (-0.337772 --> -0.347099).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1196935
	speed: 0.2190s/iter; left time: 3149.0197s
Epoch: 7 cost time: 9.13077425956726
Epoch: 7, Steps: 154 | Train Loss: 1.709 Vali Loss: 2.327 Vali Acc: 0.349 Test Loss: 2.327 Test Acc: 0.349
Validation loss decreased (-0.347099 --> -0.348720).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7726432
	speed: 0.1930s/iter; left time: 2744.6362s
Epoch: 8 cost time: 6.456122398376465
Epoch: 8, Steps: 154 | Train Loss: 1.656 Vali Loss: 2.245 Vali Acc: 0.352 Test Loss: 2.245 Test Acc: 0.352
Validation loss decreased (-0.348720 --> -0.351559).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9321043
	speed: 0.1986s/iter; left time: 2793.9457s
Epoch: 9 cost time: 9.452244520187378
Epoch: 9, Steps: 154 | Train Loss: 1.564 Vali Loss: 2.451 Vali Acc: 0.356 Test Loss: 2.451 Test Acc: 0.356
Validation loss decreased (-0.351559 --> -0.356423).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9419317
	speed: 0.2285s/iter; left time: 3179.7915s
Epoch: 10 cost time: 8.825840473175049
Epoch: 10, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.331 Vali Acc: 0.356 Test Loss: 2.331 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3591034
	speed: 0.2278s/iter; left time: 3135.0755s
Epoch: 11 cost time: 8.753312110900879
Epoch: 11, Steps: 154 | Train Loss: 1.466 Vali Loss: 2.317 Vali Acc: 0.362 Test Loss: 2.317 Test Acc: 0.362
Validation loss decreased (-0.356423 --> -0.362102).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1186832
	speed: 0.1994s/iter; left time: 2713.0186s
Epoch: 12 cost time: 7.1254048347473145
Epoch: 12, Steps: 154 | Train Loss: 1.437 Vali Loss: 2.275 Vali Acc: 0.368 Test Loss: 2.275 Test Acc: 0.368
Validation loss decreased (-0.362102 --> -0.367779).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0720899
	speed: 0.2183s/iter; left time: 2936.2758s
Epoch: 13 cost time: 9.98808765411377
Epoch: 13, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.457 Vali Acc: 0.208 Test Loss: 2.457 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4217751
	speed: 0.2473s/iter; left time: 3288.6025s
Epoch: 14 cost time: 10.492666006088257
Epoch: 14, Steps: 154 | Train Loss: 1.397 Vali Loss: 2.453 Vali Acc: 0.373 Test Loss: 2.453 Test Acc: 0.373
Validation loss decreased (-0.367779 --> -0.373049).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.3147815
	speed: 0.2464s/iter; left time: 3239.0700s
Epoch: 15 cost time: 9.92909574508667
Epoch: 15, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.425 Vali Acc: 0.346 Test Loss: 2.425 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0435662
	speed: 0.2293s/iter; left time: 2978.6853s
Epoch: 16 cost time: 7.06820011138916
Epoch: 16, Steps: 154 | Train Loss: 1.306 Vali Loss: 2.532 Vali Acc: 0.226 Test Loss: 2.532 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.1498179
	speed: 0.2027s/iter; left time: 2602.6766s
Epoch: 17 cost time: 10.027393341064453
Epoch: 17, Steps: 154 | Train Loss: 1.280 Vali Loss: 2.538 Vali Acc: 0.380 Test Loss: 2.538 Test Acc: 0.380
Validation loss decreased (-0.373049 --> -0.380348).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.1912394
	speed: 0.2393s/iter; left time: 3035.6724s
Epoch: 18 cost time: 9.51572036743164
Epoch: 18, Steps: 154 | Train Loss: 1.263 Vali Loss: 2.702 Vali Acc: 0.358 Test Loss: 2.702 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 2.2383316
	speed: 0.2377s/iter; left time: 2977.8173s
Epoch: 19 cost time: 9.282727241516113
Epoch: 19, Steps: 154 | Train Loss: 1.227 Vali Loss: 2.912 Vali Acc: 0.208 Test Loss: 2.912 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.1858740
	speed: 0.2274s/iter; left time: 2814.5454s
Epoch: 20 cost time: 9.635347366333008
Epoch: 20, Steps: 154 | Train Loss: 1.198 Vali Loss: 2.702 Vali Acc: 0.213 Test Loss: 2.702 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.3558891
	speed: 0.2379s/iter; left time: 2907.6985s
Epoch: 21 cost time: 8.835470914840698
Epoch: 21, Steps: 154 | Train Loss: 1.166 Vali Loss: 3.209 Vali Acc: 0.193 Test Loss: 3.209 Test Acc: 0.193
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.2828915
	speed: 0.2267s/iter; left time: 2735.6742s
Epoch: 22 cost time: 9.924529790878296
Epoch: 22, Steps: 154 | Train Loss: 1.168 Vali Loss: 2.899 Vali Acc: 0.140 Test Loss: 2.899 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.0924152
	speed: 0.2250s/iter; left time: 2680.9538s
Epoch: 23 cost time: 9.145252227783203
Epoch: 23, Steps: 154 | Train Loss: 1.143 Vali Loss: 3.229 Vali Acc: 0.211 Test Loss: 3.229 Test Acc: 0.211
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.3876789
	speed: 0.1727s/iter; left time: 2030.5029s
Epoch: 24 cost time: 7.144323110580444
Epoch: 24, Steps: 154 | Train Loss: 1.160 Vali Loss: 3.385 Vali Acc: 0.085 Test Loss: 3.385 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.7720829
	speed: 0.2226s/iter; left time: 2583.0683s
Epoch: 25 cost time: 10.175224542617798
Epoch: 25, Steps: 154 | Train Loss: 1.114 Vali Loss: 3.355 Vali Acc: 0.150 Test Loss: 3.355 Test Acc: 0.150
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.8325922
	speed: 0.2357s/iter; left time: 2698.8730s
Epoch: 26 cost time: 9.373523712158203
Epoch: 26, Steps: 154 | Train Loss: 1.121 Vali Loss: 3.167 Vali Acc: 0.207 Test Loss: 3.167 Test Acc: 0.207
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 11.6771240
	speed: 0.2446s/iter; left time: 2762.9212s
Epoch: 27 cost time: 10.03492546081543
Epoch: 27, Steps: 154 | Train Loss: 1.210 Vali Loss: 3.496 Vali Acc: 0.205 Test Loss: 3.496 Test Acc: 0.205
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38037307380373075
model parameter : 576990
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2287815
	speed: 0.0692s/iter; left time: 1058.4199s
Epoch: 1 cost time: 8.997522115707397
Epoch: 1, Steps: 154 | Train Loss: 2.221 Vali Loss: 2.173 Vali Acc: 0.319 Test Loss: 2.173 Test Acc: 0.319
Validation loss decreased (inf --> -0.319119).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6474928
	speed: 0.1521s/iter; left time: 2303.8597s
Epoch: 2 cost time: 8.433639287948608
Epoch: 2, Steps: 154 | Train Loss: 2.027 Vali Loss: 2.271 Vali Acc: 0.322 Test Loss: 2.271 Test Acc: 0.322
Validation loss decreased (-0.319119 --> -0.322362).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5724189
	speed: 0.2176s/iter; left time: 3262.2737s
Epoch: 3 cost time: 8.810691595077515
Epoch: 3, Steps: 154 | Train Loss: 1.950 Vali Loss: 2.175 Vali Acc: 0.329 Test Loss: 2.175 Test Acc: 0.329
Validation loss decreased (-0.322362 --> -0.329256).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6765369
	speed: 0.2229s/iter; left time: 3308.3282s
Epoch: 4 cost time: 9.110537052154541
Epoch: 4, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.199 Vali Acc: 0.338 Test Loss: 2.199 Test Acc: 0.338
Validation loss decreased (-0.329256 --> -0.338178).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7409245
	speed: 0.1771s/iter; left time: 2601.0339s
Epoch: 5 cost time: 6.479568004608154
Epoch: 5, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.258 Vali Acc: 0.342 Test Loss: 2.258 Test Acc: 0.342
Validation loss decreased (-0.338178 --> -0.341827).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6827027
	speed: 0.2139s/iter; left time: 3107.7863s
Epoch: 6 cost time: 9.63273811340332
Epoch: 6, Steps: 154 | Train Loss: 1.666 Vali Loss: 2.386 Vali Acc: 0.349 Test Loss: 2.386 Test Acc: 0.349
Validation loss decreased (-0.341827 --> -0.349125).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0420687
	speed: 0.2648s/iter; left time: 3806.4267s
Epoch: 7 cost time: 10.443085670471191
Epoch: 7, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.527 Vali Acc: 0.350 Test Loss: 2.527 Test Acc: 0.350
Validation loss decreased (-0.349125 --> -0.349934).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7646860
	speed: 0.2405s/iter; left time: 3421.2864s
Epoch: 8 cost time: 9.474951028823853
Epoch: 8, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.285 Vali Acc: 0.363 Test Loss: 2.285 Test Acc: 0.363
Validation loss decreased (-0.349934 --> -0.363319).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6618177
	speed: 0.1823s/iter; left time: 2565.0256s
Epoch: 9 cost time: 9.359244346618652
Epoch: 9, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.377 Vali Acc: 0.362 Test Loss: 2.377 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.9300767
	speed: 0.2379s/iter; left time: 3310.2709s
Epoch: 10 cost time: 10.301359415054321
Epoch: 10, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.338 Vali Acc: 0.360 Test Loss: 2.338 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2490973
	speed: 0.2361s/iter; left time: 3249.0759s
Epoch: 11 cost time: 9.081949234008789
Epoch: 11, Steps: 154 | Train Loss: 1.404 Vali Loss: 2.330 Vali Acc: 0.361 Test Loss: 2.330 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.0587549
	speed: 0.2390s/iter; left time: 3252.2584s
Epoch: 12 cost time: 8.755603551864624
Epoch: 12, Steps: 154 | Train Loss: 1.376 Vali Loss: 2.247 Vali Acc: 0.366 Test Loss: 2.247 Test Acc: 0.366
Validation loss decreased (-0.363319 --> -0.366158).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0387886
	speed: 0.1701s/iter; left time: 2288.0117s
Epoch: 13 cost time: 8.852091073989868
Epoch: 13, Steps: 154 | Train Loss: 1.336 Vali Loss: 2.418 Vali Acc: 0.232 Test Loss: 2.418 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1992369
	speed: 0.2181s/iter; left time: 2900.9331s
Epoch: 14 cost time: 9.053609848022461
Epoch: 14, Steps: 154 | Train Loss: 1.321 Vali Loss: 2.211 Vali Acc: 0.381 Test Loss: 2.211 Test Acc: 0.381
Validation loss decreased (-0.366158 --> -0.381162).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4230863
	speed: 0.2222s/iter; left time: 2921.2776s
Epoch: 15 cost time: 9.066464900970459
Epoch: 15, Steps: 154 | Train Loss: 1.286 Vali Loss: 2.441 Vali Acc: 0.348 Test Loss: 2.441 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.8227137
	speed: 0.2141s/iter; left time: 2780.9002s
Epoch: 16 cost time: 7.19909930229187
Epoch: 16, Steps: 154 | Train Loss: 1.257 Vali Loss: 2.426 Vali Acc: 0.360 Test Loss: 2.426 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.9932749
	speed: 0.1691s/iter; left time: 2170.8373s
Epoch: 17 cost time: 8.079991102218628
Epoch: 17, Steps: 154 | Train Loss: 1.265 Vali Loss: 2.640 Vali Acc: 0.234 Test Loss: 2.640 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.1566869
	speed: 0.2103s/iter; left time: 2667.2099s
Epoch: 18 cost time: 8.937272310256958
Epoch: 18, Steps: 154 | Train Loss: 1.209 Vali Loss: 2.531 Vali Acc: 0.247 Test Loss: 2.531 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.6469561
	speed: 0.2134s/iter; left time: 2674.3006s
Epoch: 19 cost time: 8.64717411994934
Epoch: 19, Steps: 154 | Train Loss: 1.186 Vali Loss: 2.602 Vali Acc: 0.218 Test Loss: 2.602 Test Acc: 0.218
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.1152617
	speed: 0.1682s/iter; left time: 2081.3294s
Epoch: 20 cost time: 7.744060277938843
Epoch: 20, Steps: 154 | Train Loss: 1.143 Vali Loss: 2.703 Vali Acc: 0.224 Test Loss: 2.703 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.9446533
	speed: 0.2094s/iter; left time: 2559.2244s
Epoch: 21 cost time: 9.133039951324463
Epoch: 21, Steps: 154 | Train Loss: 1.152 Vali Loss: 2.756 Vali Acc: 0.225 Test Loss: 2.756 Test Acc: 0.225
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.3156517
	speed: 0.2259s/iter; left time: 2725.9984s
Epoch: 22 cost time: 8.60775899887085
Epoch: 22, Steps: 154 | Train Loss: 1.095 Vali Loss: 3.008 Vali Acc: 0.155 Test Loss: 3.008 Test Acc: 0.155
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.0900815
	speed: 0.1763s/iter; left time: 2100.7372s
Epoch: 23 cost time: 8.723169565200806
Epoch: 23, Steps: 154 | Train Loss: 1.085 Vali Loss: 3.061 Vali Acc: 0.217 Test Loss: 3.061 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.5788682
	speed: 0.2307s/iter; left time: 2713.0557s
Epoch: 24 cost time: 8.903281450271606
Epoch: 24, Steps: 154 | Train Loss: 1.081 Vali Loss: 3.233 Vali Acc: 0.124 Test Loss: 3.233 Test Acc: 0.124
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38118410381184104
model parameter : 576990
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8802536
	speed: 0.0807s/iter; left time: 1234.4659s
Epoch: 1 cost time: 11.07636284828186
Epoch: 1, Steps: 154 | Train Loss: 2.246 Vali Loss: 2.184 Vali Acc: 0.318 Test Loss: 2.184 Test Acc: 0.318
Validation loss decreased (inf --> -0.318307).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2303259
	speed: 0.2036s/iter; left time: 3084.4128s
Epoch: 2 cost time: 8.857655048370361
Epoch: 2, Steps: 154 | Train Loss: 2.063 Vali Loss: 2.168 Vali Acc: 0.322 Test Loss: 2.168 Test Acc: 0.322
Validation loss decreased (-0.318307 --> -0.321552).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6854008
	speed: 0.1910s/iter; left time: 2863.0863s
Epoch: 3 cost time: 6.453150272369385
Epoch: 3, Steps: 154 | Train Loss: 1.980 Vali Loss: 2.206 Vali Acc: 0.322 Test Loss: 2.206 Test Acc: 0.322
Validation loss decreased (-0.321552 --> -0.322362).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5149183
	speed: 0.2042s/iter; left time: 3030.7657s
Epoch: 4 cost time: 9.340677738189697
Epoch: 4, Steps: 154 | Train Loss: 1.947 Vali Loss: 2.135 Vali Acc: 0.329 Test Loss: 2.135 Test Acc: 0.329
Validation loss decreased (-0.322362 --> -0.329257).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6860723
	speed: 0.2122s/iter; left time: 3115.6319s
Epoch: 5 cost time: 9.043118238449097
Epoch: 5, Steps: 154 | Train Loss: 1.876 Vali Loss: 2.170 Vali Acc: 0.331 Test Loss: 2.170 Test Acc: 0.331
Validation loss decreased (-0.329257 --> -0.330879).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7378333
	speed: 0.2114s/iter; left time: 3071.3783s
Epoch: 6 cost time: 8.754461765289307
Epoch: 6, Steps: 154 | Train Loss: 1.810 Vali Loss: 2.216 Vali Acc: 0.337 Test Loss: 2.216 Test Acc: 0.337
Validation loss decreased (-0.330879 --> -0.336961).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6887331
	speed: 0.2132s/iter; left time: 3065.0401s
Epoch: 7 cost time: 9.020342350006104
Epoch: 7, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.243 Vali Acc: 0.339 Test Loss: 2.243 Test Acc: 0.339
Validation loss decreased (-0.336961 --> -0.338583).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7351955
	speed: 0.2070s/iter; left time: 2944.2696s
Epoch: 8 cost time: 8.490641355514526
Epoch: 8, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.261 Vali Acc: 0.346 Test Loss: 2.261 Test Acc: 0.346
Validation loss decreased (-0.338583 --> -0.345882).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4945225
	speed: 0.2056s/iter; left time: 2891.9803s
Epoch: 9 cost time: 8.655050039291382
Epoch: 9, Steps: 154 | Train Loss: 1.624 Vali Loss: 2.263 Vali Acc: 0.352 Test Loss: 2.263 Test Acc: 0.352
Validation loss decreased (-0.345882 --> -0.351964).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6922047
	speed: 0.1715s/iter; left time: 2386.6758s
Epoch: 10 cost time: 7.420472860336304
Epoch: 10, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.436 Vali Acc: 0.356 Test Loss: 2.436 Test Acc: 0.356
Validation loss decreased (-0.351964 --> -0.356018).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2032583
	speed: 0.2221s/iter; left time: 3056.0954s
Epoch: 11 cost time: 10.06719970703125
Epoch: 11, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.470 Vali Acc: 0.361 Test Loss: 2.470 Test Acc: 0.361
Validation loss decreased (-0.356018 --> -0.361289).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2323644
	speed: 0.2238s/iter; left time: 3044.6585s
Epoch: 12 cost time: 8.746796131134033
Epoch: 12, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.690 Vali Acc: 0.213 Test Loss: 2.690 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.0122685
	speed: 0.2278s/iter; left time: 3064.8572s
Epoch: 13 cost time: 9.457958459854126
Epoch: 13, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.667 Vali Acc: 0.367 Test Loss: 2.667 Test Acc: 0.367
Validation loss decreased (-0.361289 --> -0.367370).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.1882119
	speed: 0.1691s/iter; left time: 2248.5514s
Epoch: 14 cost time: 6.981349945068359
Epoch: 14, Steps: 154 | Train Loss: 1.437 Vali Loss: 2.513 Vali Acc: 0.358 Test Loss: 2.513 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.5349369
	speed: 0.2179s/iter; left time: 2864.4312s
Epoch: 15 cost time: 8.947327613830566
Epoch: 15, Steps: 154 | Train Loss: 1.425 Vali Loss: 2.775 Vali Acc: 0.361 Test Loss: 2.775 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0726331
	speed: 0.2197s/iter; left time: 2854.2704s
Epoch: 16 cost time: 9.414572477340698
Epoch: 16, Steps: 154 | Train Loss: 1.411 Vali Loss: 2.733 Vali Acc: 0.335 Test Loss: 2.733 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.3158550
	speed: 0.2086s/iter; left time: 2677.6107s
Epoch: 17 cost time: 6.782350778579712
Epoch: 17, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.769 Vali Acc: 0.371 Test Loss: 2.769 Test Acc: 0.371
Validation loss decreased (-0.367370 --> -0.371019).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6941042
	speed: 0.1946s/iter; left time: 2468.3967s
Epoch: 18 cost time: 9.456312894821167
Epoch: 18, Steps: 154 | Train Loss: 1.417 Vali Loss: 2.876 Vali Acc: 0.203 Test Loss: 2.876 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.4093454
	speed: 0.2314s/iter; left time: 2899.6537s
Epoch: 19 cost time: 10.406185388565063
Epoch: 19, Steps: 154 | Train Loss: 1.374 Vali Loss: 3.219 Vali Acc: 0.211 Test Loss: 3.219 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.9821261
	speed: 0.2287s/iter; left time: 2830.1924s
Epoch: 20 cost time: 9.181201696395874
Epoch: 20, Steps: 154 | Train Loss: 1.287 Vali Loss: 3.164 Vali Acc: 0.194 Test Loss: 3.164 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.0356802
	speed: 0.2386s/iter; left time: 2915.6825s
Epoch: 21 cost time: 8.914015054702759
Epoch: 21, Steps: 154 | Train Loss: 1.276 Vali Loss: 3.105 Vali Acc: 0.201 Test Loss: 3.105 Test Acc: 0.201
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.4041331
	speed: 0.1746s/iter; left time: 2106.3112s
Epoch: 22 cost time: 8.965121984481812
Epoch: 22, Steps: 154 | Train Loss: 1.303 Vali Loss: 3.172 Vali Acc: 0.161 Test Loss: 3.172 Test Acc: 0.161
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.2777233
	speed: 0.2076s/iter; left time: 2473.3522s
Epoch: 23 cost time: 8.259931564331055
Epoch: 23, Steps: 154 | Train Loss: 1.254 Vali Loss: 3.437 Vali Acc: 0.205 Test Loss: 3.437 Test Acc: 0.205
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.5113566
	speed: 0.2002s/iter; left time: 2354.7342s
Epoch: 24 cost time: 8.303361415863037
Epoch: 24, Steps: 154 | Train Loss: 1.211 Vali Loss: 3.419 Vali Acc: 0.108 Test Loss: 3.419 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 1.1948673
	speed: 0.2067s/iter; left time: 2398.8958s
Epoch: 25 cost time: 8.884906530380249
Epoch: 25, Steps: 154 | Train Loss: 1.195 Vali Loss: 3.491 Vali Acc: 0.131 Test Loss: 3.491 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.6253632
	speed: 0.2101s/iter; left time: 2405.7615s
Epoch: 26 cost time: 8.48002815246582
Epoch: 26, Steps: 154 | Train Loss: 1.256 Vali Loss: 3.172 Vali Acc: 0.191 Test Loss: 3.172 Test Acc: 0.191
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.0300283
	speed: 0.2142s/iter; left time: 2419.9835s
Epoch: 27 cost time: 9.292832612991333
Epoch: 27, Steps: 154 | Train Loss: 1.198 Vali Loss: 3.554 Vali Acc: 0.189 Test Loss: 3.554 Test Acc: 0.189
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3710462287104623
model parameter : 314846
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8983684
	speed: 0.0653s/iter; left time: 999.5147s
Epoch: 1 cost time: 9.190552234649658
Epoch: 1, Steps: 154 | Train Loss: 2.242 Vali Loss: 2.171 Vali Acc: 0.317 Test Loss: 2.171 Test Acc: 0.317
Validation loss decreased (inf --> -0.317091).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2216883
	speed: 0.1989s/iter; left time: 3013.1772s
Epoch: 2 cost time: 8.811491012573242
Epoch: 2, Steps: 154 | Train Loss: 2.061 Vali Loss: 2.161 Vali Acc: 0.322 Test Loss: 2.161 Test Acc: 0.322
Validation loss decreased (-0.317091 --> -0.322363).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6921836
	speed: 0.1937s/iter; left time: 2903.5651s
Epoch: 3 cost time: 6.676049709320068
Epoch: 3, Steps: 154 | Train Loss: 1.976 Vali Loss: 2.193 Vali Acc: 0.325 Test Loss: 2.193 Test Acc: 0.325
Validation loss decreased (-0.322363 --> -0.324796).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4095452
	speed: 0.1823s/iter; left time: 2705.1956s
Epoch: 4 cost time: 9.53295373916626
Epoch: 4, Steps: 154 | Train Loss: 1.934 Vali Loss: 2.128 Vali Acc: 0.332 Test Loss: 2.128 Test Acc: 0.332
Validation loss decreased (-0.324796 --> -0.332096).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6225361
	speed: 0.2263s/iter; left time: 3322.8463s
Epoch: 5 cost time: 9.806029558181763
Epoch: 5, Steps: 154 | Train Loss: 1.860 Vali Loss: 2.158 Vali Acc: 0.338 Test Loss: 2.158 Test Acc: 0.338
Validation loss decreased (-0.332096 --> -0.338178).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7499549
	speed: 0.1960s/iter; left time: 2848.4756s
Epoch: 6 cost time: 7.708745241165161
Epoch: 6, Steps: 154 | Train Loss: 1.784 Vali Loss: 2.227 Vali Acc: 0.341 Test Loss: 2.227 Test Acc: 0.341
Validation loss decreased (-0.338178 --> -0.341421).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7977288
	speed: 0.1913s/iter; left time: 2750.5718s
Epoch: 7 cost time: 6.921851396560669
Epoch: 7, Steps: 154 | Train Loss: 1.754 Vali Loss: 2.206 Vali Acc: 0.345 Test Loss: 2.206 Test Acc: 0.345
Validation loss decreased (-0.341421 --> -0.344666).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9066824
	speed: 0.1933s/iter; left time: 2749.4587s
Epoch: 8 cost time: 9.35789155960083
Epoch: 8, Steps: 154 | Train Loss: 1.654 Vali Loss: 2.237 Vali Acc: 0.351 Test Loss: 2.237 Test Acc: 0.351
Validation loss decreased (-0.344666 --> -0.350748).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4378415
	speed: 0.2177s/iter; left time: 3063.3644s
Epoch: 9 cost time: 8.854954719543457
Epoch: 9, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.342 Vali Acc: 0.360 Test Loss: 2.342 Test Acc: 0.360
Validation loss decreased (-0.350748 --> -0.359668).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6746495
	speed: 0.2221s/iter; left time: 3090.0566s
Epoch: 10 cost time: 9.435774326324463
Epoch: 10, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.475 Vali Acc: 0.358 Test Loss: 2.475 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1107306
	speed: 0.2149s/iter; left time: 2956.9685s
Epoch: 11 cost time: 8.849318742752075
Epoch: 11, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.618 Vali Acc: 0.367 Test Loss: 2.618 Test Acc: 0.367
Validation loss decreased (-0.359668 --> -0.366559).  Saving model ...
	iters: 100, epoch: 12 | loss: 3.9087965
	speed: 0.1807s/iter; left time: 2458.3258s
Epoch: 12 cost time: 6.271327257156372
Epoch: 12, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.752 Vali Acc: 0.279 Test Loss: 2.752 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.0676541
	speed: 0.1879s/iter; left time: 2527.4939s
Epoch: 13 cost time: 9.426982641220093
Epoch: 13, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.803 Vali Acc: 0.216 Test Loss: 2.803 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.1838647
	speed: 0.2095s/iter; left time: 2786.4570s
Epoch: 14 cost time: 8.799196243286133
Epoch: 14, Steps: 154 | Train Loss: 1.448 Vali Loss: 2.746 Vali Acc: 0.380 Test Loss: 2.746 Test Acc: 0.380
Validation loss decreased (-0.366559 --> -0.379940).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4360294
	speed: 0.2181s/iter; left time: 2866.3468s
Epoch: 15 cost time: 7.267535448074341
Epoch: 15, Steps: 154 | Train Loss: 1.390 Vali Loss: 3.070 Vali Acc: 0.197 Test Loss: 3.070 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.8522403
	speed: 0.1871s/iter; left time: 2430.2281s
Epoch: 16 cost time: 9.478339195251465
Epoch: 16, Steps: 154 | Train Loss: 1.364 Vali Loss: 3.027 Vali Acc: 0.204 Test Loss: 3.027 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.2625175
	speed: 0.2061s/iter; left time: 2645.7125s
Epoch: 17 cost time: 8.270557880401611
Epoch: 17, Steps: 154 | Train Loss: 1.337 Vali Loss: 3.316 Vali Acc: 0.102 Test Loss: 3.316 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.8355143
	speed: 0.2067s/iter; left time: 2621.0547s
Epoch: 18 cost time: 8.74702262878418
Epoch: 18, Steps: 154 | Train Loss: 1.317 Vali Loss: 3.374 Vali Acc: 0.113 Test Loss: 3.374 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.6648047
	speed: 0.1874s/iter; left time: 2348.5533s
Epoch: 19 cost time: 6.666531324386597
Epoch: 19, Steps: 154 | Train Loss: 1.308 Vali Loss: 3.734 Vali Acc: 0.095 Test Loss: 3.734 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.1977248
	speed: 0.1855s/iter; left time: 2295.6511s
Epoch: 20 cost time: 8.619915246963501
Epoch: 20, Steps: 154 | Train Loss: 1.282 Vali Loss: 3.572 Vali Acc: 0.168 Test Loss: 3.572 Test Acc: 0.168
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.9430962
	speed: 0.2198s/iter; left time: 2686.1971s
Epoch: 21 cost time: 9.36741590499878
Epoch: 21, Steps: 154 | Train Loss: 1.288 Vali Loss: 3.995 Vali Acc: 0.118 Test Loss: 3.995 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.5059123
	speed: 0.2132s/iter; left time: 2572.9822s
Epoch: 22 cost time: 9.43045711517334
Epoch: 22, Steps: 154 | Train Loss: 1.246 Vali Loss: 3.809 Vali Acc: 0.082 Test Loss: 3.809 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.0202048
	speed: 0.1800s/iter; left time: 2144.6380s
Epoch: 23 cost time: 7.785776138305664
Epoch: 23, Steps: 154 | Train Loss: 1.229 Vali Loss: 4.394 Vali Acc: 0.088 Test Loss: 4.394 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.2233313
	speed: 0.2257s/iter; left time: 2654.0402s
Epoch: 24 cost time: 10.20944595336914
Epoch: 24, Steps: 154 | Train Loss: 1.167 Vali Loss: 4.071 Vali Acc: 0.077 Test Loss: 4.071 Test Acc: 0.077
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 314846
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9216549
	speed: 0.0624s/iter; left time: 954.2701s
Epoch: 1 cost time: 8.339942693710327
Epoch: 1, Steps: 154 | Train Loss: 2.226 Vali Loss: 2.178 Vali Acc: 0.318 Test Loss: 2.178 Test Acc: 0.318
Validation loss decreased (inf --> -0.318307).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2494483
	speed: 0.1782s/iter; left time: 2698.8860s
Epoch: 2 cost time: 8.657827377319336
Epoch: 2, Steps: 154 | Train Loss: 2.058 Vali Loss: 2.156 Vali Acc: 0.322 Test Loss: 2.156 Test Acc: 0.322
Validation loss decreased (-0.318307 --> -0.321957).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6973522
	speed: 0.2067s/iter; left time: 3098.3603s
Epoch: 3 cost time: 8.298631191253662
Epoch: 3, Steps: 154 | Train Loss: 1.970 Vali Loss: 2.193 Vali Acc: 0.325 Test Loss: 2.193 Test Acc: 0.325
Validation loss decreased (-0.321957 --> -0.325201).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3507195
	speed: 0.1973s/iter; left time: 2928.0694s
Epoch: 4 cost time: 7.8944091796875
Epoch: 4, Steps: 154 | Train Loss: 1.921 Vali Loss: 2.118 Vali Acc: 0.333 Test Loss: 2.118 Test Acc: 0.333
Validation loss decreased (-0.325201 --> -0.332501).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5349579
	speed: 0.1590s/iter; left time: 2334.6374s
Epoch: 5 cost time: 7.353349447250366
Epoch: 5, Steps: 154 | Train Loss: 1.822 Vali Loss: 2.199 Vali Acc: 0.337 Test Loss: 2.199 Test Acc: 0.337
Validation loss decreased (-0.332501 --> -0.336961).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6847966
	speed: 0.1915s/iter; left time: 2782.2161s
Epoch: 6 cost time: 7.623517036437988
Epoch: 6, Steps: 154 | Train Loss: 1.756 Vali Loss: 2.301 Vali Acc: 0.349 Test Loss: 2.301 Test Acc: 0.349
Validation loss decreased (-0.336961 --> -0.348720).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8873640
	speed: 0.1852s/iter; left time: 2662.1717s
Epoch: 7 cost time: 8.142733573913574
Epoch: 7, Steps: 154 | Train Loss: 1.681 Vali Loss: 2.227 Vali Acc: 0.347 Test Loss: 2.227 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7093081
	speed: 0.1871s/iter; left time: 2661.2708s
Epoch: 8 cost time: 7.461805582046509
Epoch: 8, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.254 Vali Acc: 0.351 Test Loss: 2.254 Test Acc: 0.351
Validation loss decreased (-0.348720 --> -0.351153).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3004222
	speed: 0.1604s/iter; left time: 2256.7594s
Epoch: 9 cost time: 7.709854602813721
Epoch: 9, Steps: 154 | Train Loss: 1.605 Vali Loss: 2.344 Vali Acc: 0.361 Test Loss: 2.344 Test Acc: 0.361
Validation loss decreased (-0.351153 --> -0.360479).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4452876
	speed: 0.2025s/iter; left time: 2817.6439s
Epoch: 10 cost time: 8.599344491958618
Epoch: 10, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.397 Vali Acc: 0.357 Test Loss: 2.397 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1114531
	speed: 0.2109s/iter; left time: 2902.2345s
Epoch: 11 cost time: 8.307153940200806
Epoch: 11, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.372 Vali Acc: 0.372 Test Loss: 2.372 Test Acc: 0.372
Validation loss decreased (-0.360479 --> -0.371834).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1668483
	speed: 0.1880s/iter; left time: 2558.1364s
Epoch: 12 cost time: 6.656625986099243
Epoch: 12, Steps: 154 | Train Loss: 1.441 Vali Loss: 2.607 Vali Acc: 0.220 Test Loss: 2.607 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.7924175
	speed: 0.1835s/iter; left time: 2468.2288s
Epoch: 13 cost time: 8.549254417419434
Epoch: 13, Steps: 154 | Train Loss: 1.385 Vali Loss: 2.416 Vali Acc: 0.387 Test Loss: 2.416 Test Acc: 0.387
Validation loss decreased (-0.371834 --> -0.386837).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.1902748
	speed: 0.2115s/iter; left time: 2812.4192s
Epoch: 14 cost time: 8.72094440460205
Epoch: 14, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.346 Vali Acc: 0.372 Test Loss: 2.346 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.4474485
	speed: 0.1983s/iter; left time: 2606.0678s
Epoch: 15 cost time: 6.539959907531738
Epoch: 15, Steps: 154 | Train Loss: 1.321 Vali Loss: 2.489 Vali Acc: 0.378 Test Loss: 2.489 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.8953829
	speed: 0.1757s/iter; left time: 2282.8837s
Epoch: 16 cost time: 7.944760799407959
Epoch: 16, Steps: 154 | Train Loss: 1.294 Vali Loss: 2.551 Vali Acc: 0.221 Test Loss: 2.551 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.1311858
	speed: 0.2045s/iter; left time: 2625.6253s
Epoch: 17 cost time: 7.914228200912476
Epoch: 17, Steps: 154 | Train Loss: 1.279 Vali Loss: 2.435 Vali Acc: 0.384 Test Loss: 2.435 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.4176853
	speed: 0.1668s/iter; left time: 2116.1494s
Epoch: 18 cost time: 5.895275831222534
Epoch: 18, Steps: 154 | Train Loss: 1.242 Vali Loss: 2.718 Vali Acc: 0.217 Test Loss: 2.718 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.3408588
	speed: 0.1703s/iter; left time: 2133.6171s
Epoch: 19 cost time: 7.390497207641602
Epoch: 19, Steps: 154 | Train Loss: 1.215 Vali Loss: 2.665 Vali Acc: 0.221 Test Loss: 2.665 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.0283155
	speed: 0.1838s/iter; left time: 2274.7627s
Epoch: 20 cost time: 7.656327486038208
Epoch: 20, Steps: 154 | Train Loss: 1.225 Vali Loss: 2.729 Vali Acc: 0.213 Test Loss: 2.729 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.2649281
	speed: 0.1949s/iter; left time: 2381.4678s
Epoch: 21 cost time: 8.161191940307617
Epoch: 21, Steps: 154 | Train Loss: 1.165 Vali Loss: 3.352 Vali Acc: 0.201 Test Loss: 3.352 Test Acc: 0.201
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.4682965
	speed: 0.1690s/iter; left time: 2039.9045s
Epoch: 22 cost time: 6.759024381637573
Epoch: 22, Steps: 154 | Train Loss: 1.198 Vali Loss: 2.929 Vali Acc: 0.217 Test Loss: 2.929 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.1563697
	speed: 0.2094s/iter; left time: 2494.2703s
Epoch: 23 cost time: 8.70724606513977
Epoch: 23, Steps: 154 | Train Loss: 1.189 Vali Loss: 3.215 Vali Acc: 0.220 Test Loss: 3.215 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38686131386861317
model parameter : 314846
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9410591
	speed: 0.0586s/iter; left time: 896.2829s
Epoch: 1 cost time: 8.113577127456665
Epoch: 1, Steps: 154 | Train Loss: 2.206 Vali Loss: 2.196 Vali Acc: 0.318 Test Loss: 2.196 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2211471
	speed: 0.1793s/iter; left time: 2715.6086s
Epoch: 2 cost time: 7.936418294906616
Epoch: 2, Steps: 154 | Train Loss: 2.038 Vali Loss: 2.253 Vali Acc: 0.321 Test Loss: 2.253 Test Acc: 0.321
Validation loss decreased (-0.317902 --> -0.321145).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6343857
	speed: 0.2053s/iter; left time: 3077.6677s
Epoch: 3 cost time: 8.462591409683228
Epoch: 3, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.315 Vali Acc: 0.325 Test Loss: 2.315 Test Acc: 0.325
Validation loss decreased (-0.321145 --> -0.325200).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1447887
	speed: 0.1872s/iter; left time: 2778.2699s
Epoch: 4 cost time: 6.468649864196777
Epoch: 4, Steps: 154 | Train Loss: 1.872 Vali Loss: 2.331 Vali Acc: 0.335 Test Loss: 2.331 Test Acc: 0.335
Validation loss decreased (-0.325200 --> -0.334527).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5100969
	speed: 0.1829s/iter; left time: 2686.3450s
Epoch: 5 cost time: 8.16983962059021
Epoch: 5, Steps: 154 | Train Loss: 1.756 Vali Loss: 2.533 Vali Acc: 0.339 Test Loss: 2.533 Test Acc: 0.339
Validation loss decreased (-0.334527 --> -0.339391).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7993281
	speed: 0.1972s/iter; left time: 2864.9993s
Epoch: 6 cost time: 8.30141806602478
Epoch: 6, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.714 Vali Acc: 0.349 Test Loss: 2.714 Test Acc: 0.349
Validation loss decreased (-0.339391 --> -0.349121).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6491961
	speed: 0.1816s/iter; left time: 2611.0537s
Epoch: 7 cost time: 5.973609447479248
Epoch: 7, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.502 Vali Acc: 0.348 Test Loss: 2.502 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7905310
	speed: 0.1795s/iter; left time: 2552.3332s
Epoch: 8 cost time: 8.20271611213684
Epoch: 8, Steps: 154 | Train Loss: 1.547 Vali Loss: 2.382 Vali Acc: 0.362 Test Loss: 2.382 Test Acc: 0.362
Validation loss decreased (-0.349121 --> -0.361696).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3884370
	speed: 0.1837s/iter; left time: 2584.6742s
Epoch: 9 cost time: 7.44405198097229
Epoch: 9, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.552 Vali Acc: 0.363 Test Loss: 2.552 Test Acc: 0.363
Validation loss decreased (-0.361696 --> -0.362505).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2413232
	speed: 0.1820s/iter; left time: 2532.4574s
Epoch: 10 cost time: 6.678993463516235
Epoch: 10, Steps: 154 | Train Loss: 1.466 Vali Loss: 2.426 Vali Acc: 0.363 Test Loss: 2.426 Test Acc: 0.363
Validation loss decreased (-0.362505 --> -0.362506).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.8535510
	speed: 0.1641s/iter; left time: 2257.6202s
Epoch: 11 cost time: 8.372053384780884
Epoch: 11, Steps: 154 | Train Loss: 1.393 Vali Loss: 2.609 Vali Acc: 0.269 Test Loss: 2.609 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0834500
	speed: 0.1912s/iter; left time: 2601.9110s
Epoch: 12 cost time: 7.867100477218628
Epoch: 12, Steps: 154 | Train Loss: 1.376 Vali Loss: 2.385 Vali Acc: 0.379 Test Loss: 2.385 Test Acc: 0.379
Validation loss decreased (-0.362506 --> -0.379133).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.8835905
	speed: 0.1962s/iter; left time: 2638.9946s
Epoch: 13 cost time: 6.685822486877441
Epoch: 13, Steps: 154 | Train Loss: 1.347 Vali Loss: 2.289 Vali Acc: 0.389 Test Loss: 2.289 Test Acc: 0.389
Validation loss decreased (-0.379133 --> -0.388866).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.1557274
	speed: 0.1808s/iter; left time: 2403.8660s
Epoch: 14 cost time: 8.413697481155396
Epoch: 14, Steps: 154 | Train Loss: 1.350 Vali Loss: 2.192 Vali Acc: 0.381 Test Loss: 2.192 Test Acc: 0.381
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.3655320
	speed: 0.1975s/iter; left time: 2595.9835s
Epoch: 15 cost time: 7.733022689819336
Epoch: 15, Steps: 154 | Train Loss: 1.284 Vali Loss: 2.406 Vali Acc: 0.384 Test Loss: 2.406 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.8714935
	speed: 0.1833s/iter; left time: 2381.1202s
Epoch: 16 cost time: 6.862794637680054
Epoch: 16, Steps: 154 | Train Loss: 1.238 Vali Loss: 2.445 Vali Acc: 0.232 Test Loss: 2.445 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.0441368
	speed: 0.1694s/iter; left time: 2174.4752s
Epoch: 17 cost time: 7.197342157363892
Epoch: 17, Steps: 154 | Train Loss: 1.224 Vali Loss: 2.326 Vali Acc: 0.285 Test Loss: 2.326 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.1812843
	speed: 0.1847s/iter; left time: 2342.1905s
Epoch: 18 cost time: 7.302913427352905
Epoch: 18, Steps: 154 | Train Loss: 1.188 Vali Loss: 2.531 Vali Acc: 0.374 Test Loss: 2.531 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.1749322
	speed: 0.1815s/iter; left time: 2273.5212s
Epoch: 19 cost time: 8.000653266906738
Epoch: 19, Steps: 154 | Train Loss: 1.170 Vali Loss: 2.704 Vali Acc: 0.276 Test Loss: 2.704 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.2595781
	speed: 0.1770s/iter; left time: 2189.9995s
Epoch: 20 cost time: 6.185669183731079
Epoch: 20, Steps: 154 | Train Loss: 1.137 Vali Loss: 2.529 Vali Acc: 0.221 Test Loss: 2.529 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.1153620
	speed: 0.1678s/iter; left time: 2050.8898s
Epoch: 21 cost time: 7.900626182556152
Epoch: 21, Steps: 154 | Train Loss: 1.126 Vali Loss: 2.721 Vali Acc: 0.207 Test Loss: 2.721 Test Acc: 0.207
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.0436341
	speed: 0.1900s/iter; left time: 2292.8497s
Epoch: 22 cost time: 8.130571365356445
Epoch: 22, Steps: 154 | Train Loss: 1.126 Vali Loss: 2.964 Vali Acc: 0.228 Test Loss: 2.964 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.0612633
	speed: 0.1760s/iter; left time: 2096.7100s
Epoch: 23 cost time: 6.632615804672241
Epoch: 23, Steps: 154 | Train Loss: 1.085 Vali Loss: 2.885 Vali Acc: 0.165 Test Loss: 2.885 Test Acc: 0.165
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3888888888888889
model parameter : 314846
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0756357
	speed: 0.0675s/iter; left time: 1032.9590s
Epoch: 1 cost time: 9.589176416397095
Epoch: 1, Steps: 154 | Train Loss: 2.246 Vali Loss: 2.156 Vali Acc: 0.318 Test Loss: 2.156 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9758193
	speed: 0.1742s/iter; left time: 2639.0626s
Epoch: 2 cost time: 6.272460699081421
Epoch: 2, Steps: 154 | Train Loss: 2.074 Vali Loss: 2.172 Vali Acc: 0.319 Test Loss: 2.172 Test Acc: 0.319
Validation loss decreased (-0.318308 --> -0.319119).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9129777
	speed: 0.1652s/iter; left time: 2476.3930s
Epoch: 3 cost time: 7.707051038742065
Epoch: 3, Steps: 154 | Train Loss: 2.002 Vali Loss: 2.164 Vali Acc: 0.322 Test Loss: 2.164 Test Acc: 0.322
Validation loss decreased (-0.319119 --> -0.322363).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0186751
	speed: 0.1875s/iter; left time: 2781.7817s
Epoch: 4 cost time: 7.612630605697632
Epoch: 4, Steps: 154 | Train Loss: 1.943 Vali Loss: 2.134 Vali Acc: 0.327 Test Loss: 2.134 Test Acc: 0.327
Validation loss decreased (-0.322363 --> -0.327229).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8380920
	speed: 0.1704s/iter; left time: 2501.9086s
Epoch: 5 cost time: 6.750961780548096
Epoch: 5, Steps: 154 | Train Loss: 1.908 Vali Loss: 2.142 Vali Acc: 0.334 Test Loss: 2.142 Test Acc: 0.334
Validation loss decreased (-0.327229 --> -0.334123).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7551687
	speed: 0.1752s/iter; left time: 2546.1235s
Epoch: 6 cost time: 7.666628837585449
Epoch: 6, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.207 Vali Acc: 0.334 Test Loss: 2.207 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9396560
	speed: 0.1831s/iter; left time: 2632.0211s
Epoch: 7 cost time: 6.99286150932312
Epoch: 7, Steps: 154 | Train Loss: 1.755 Vali Loss: 2.287 Vali Acc: 0.343 Test Loss: 2.287 Test Acc: 0.343
Validation loss decreased (-0.334123 --> -0.342637).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8798356
	speed: 0.1566s/iter; left time: 2227.6043s
Epoch: 8 cost time: 7.809085130691528
Epoch: 8, Steps: 154 | Train Loss: 1.696 Vali Loss: 2.288 Vali Acc: 0.346 Test Loss: 2.288 Test Acc: 0.346
Validation loss decreased (-0.342637 --> -0.345881).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6148909
	speed: 0.1965s/iter; left time: 2764.2521s
Epoch: 9 cost time: 8.165050029754639
Epoch: 9, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.401 Vali Acc: 0.349 Test Loss: 2.401 Test Acc: 0.349
Validation loss decreased (-0.345881 --> -0.349124).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9183729
	speed: 0.1697s/iter; left time: 2361.8394s
Epoch: 10 cost time: 6.801965951919556
Epoch: 10, Steps: 154 | Train Loss: 1.603 Vali Loss: 2.347 Vali Acc: 0.354 Test Loss: 2.347 Test Acc: 0.354
Validation loss decreased (-0.349124 --> -0.354397).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2195457
	speed: 0.1783s/iter; left time: 2453.2663s
Epoch: 11 cost time: 7.6537721157073975
Epoch: 11, Steps: 154 | Train Loss: 1.557 Vali Loss: 2.510 Vali Acc: 0.358 Test Loss: 2.510 Test Acc: 0.358
Validation loss decreased (-0.354397 --> -0.358450).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8881791
	speed: 0.1888s/iter; left time: 2568.8544s
Epoch: 12 cost time: 7.478574752807617
Epoch: 12, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.443 Vali Acc: 0.364 Test Loss: 2.443 Test Acc: 0.364
Validation loss decreased (-0.358450 --> -0.363723).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4928316
	speed: 0.1942s/iter; left time: 2612.9978s
Epoch: 13 cost time: 8.57542610168457
Epoch: 13, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.520 Vali Acc: 0.367 Test Loss: 2.520 Test Acc: 0.367
Validation loss decreased (-0.363723 --> -0.366966).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2942059
	speed: 0.1644s/iter; left time: 2186.2659s
Epoch: 14 cost time: 6.754511833190918
Epoch: 14, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.617 Vali Acc: 0.360 Test Loss: 2.617 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.7458093
	speed: 0.1880s/iter; left time: 2471.5546s
Epoch: 15 cost time: 7.9838526248931885
Epoch: 15, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.732 Vali Acc: 0.190 Test Loss: 2.732 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.6217755
	speed: 0.1926s/iter; left time: 2502.1134s
Epoch: 16 cost time: 8.126722574234009
Epoch: 16, Steps: 154 | Train Loss: 1.360 Vali Loss: 2.740 Vali Acc: 0.329 Test Loss: 2.740 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.0289965
	speed: 0.1839s/iter; left time: 2360.7688s
Epoch: 17 cost time: 7.521222352981567
Epoch: 17, Steps: 154 | Train Loss: 1.397 Vali Loss: 2.744 Vali Acc: 0.211 Test Loss: 2.744 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.2865731
	speed: 0.1602s/iter; left time: 2031.5643s
Epoch: 18 cost time: 6.50373101234436
Epoch: 18, Steps: 154 | Train Loss: 1.338 Vali Loss: 2.767 Vali Acc: 0.206 Test Loss: 2.767 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.2677466
	speed: 0.1717s/iter; left time: 2151.6901s
Epoch: 19 cost time: 8.020967721939087
Epoch: 19, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.735 Vali Acc: 0.202 Test Loss: 2.735 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.1865728
	speed: 0.1835s/iter; left time: 2271.2356s
Epoch: 20 cost time: 7.5177130699157715
Epoch: 20, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.791 Vali Acc: 0.376 Test Loss: 2.791 Test Acc: 0.376
Validation loss decreased (-0.366966 --> -0.375884).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.0134717
	speed: 0.1949s/iter; left time: 2381.4443s
Epoch: 21 cost time: 8.290265083312988
Epoch: 21, Steps: 154 | Train Loss: 1.270 Vali Loss: 2.897 Vali Acc: 0.224 Test Loss: 2.897 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.7261970
	speed: 0.1628s/iter; left time: 1964.4416s
Epoch: 22 cost time: 7.34073805809021
Epoch: 22, Steps: 154 | Train Loss: 1.254 Vali Loss: 2.958 Vali Acc: 0.198 Test Loss: 2.958 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.0045546
	speed: 0.1989s/iter; left time: 2369.6963s
Epoch: 23 cost time: 8.083679676055908
Epoch: 23, Steps: 154 | Train Loss: 1.251 Vali Loss: 3.161 Vali Acc: 0.202 Test Loss: 3.161 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.4045210
	speed: 0.1992s/iter; left time: 2342.8647s
Epoch: 24 cost time: 8.497605562210083
Epoch: 24, Steps: 154 | Train Loss: 1.230 Vali Loss: 2.914 Vali Acc: 0.206 Test Loss: 2.914 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 1.1982716
	speed: 0.1726s/iter; left time: 2002.7627s
Epoch: 25 cost time: 6.441296100616455
Epoch: 25, Steps: 154 | Train Loss: 1.200 Vali Loss: 3.125 Vali Acc: 0.200 Test Loss: 3.125 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.6885627
	speed: 0.1701s/iter; left time: 1948.2735s
Epoch: 26 cost time: 7.502399921417236
Epoch: 26, Steps: 154 | Train Loss: 1.248 Vali Loss: 3.151 Vali Acc: 0.191 Test Loss: 3.151 Test Acc: 0.191
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 1.5815765
	speed: 0.1849s/iter; left time: 2088.3911s
Epoch: 27 cost time: 8.246622323989868
Epoch: 27, Steps: 154 | Train Loss: 1.168 Vali Loss: 3.257 Vali Acc: 0.198 Test Loss: 3.257 Test Acc: 0.198
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 1.5095475
	speed: 0.1677s/iter; left time: 1869.2337s
Epoch: 28 cost time: 6.275693655014038
Epoch: 28, Steps: 154 | Train Loss: 1.185 Vali Loss: 3.403 Vali Acc: 0.111 Test Loss: 3.403 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 1.2661638
	speed: 0.1701s/iter; left time: 1869.4053s
Epoch: 29 cost time: 8.04835319519043
Epoch: 29, Steps: 154 | Train Loss: 1.187 Vali Loss: 3.826 Vali Acc: 0.075 Test Loss: 3.826 Test Acc: 0.075
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 1.0703213
	speed: 0.1852s/iter; left time: 2006.5728s
Epoch: 30 cost time: 8.267981767654419
Epoch: 30, Steps: 154 | Train Loss: 1.159 Vali Loss: 3.416 Vali Acc: 0.180 Test Loss: 3.416 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3759124087591241
model parameter : 183774
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1315048
	speed: 0.0601s/iter; left time: 919.2896s
Epoch: 1 cost time: 8.300695180892944
Epoch: 1, Steps: 154 | Train Loss: 2.247 Vali Loss: 2.149 Vali Acc: 0.319 Test Loss: 2.149 Test Acc: 0.319
Validation loss decreased (inf --> -0.318713).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0114563
	speed: 0.1761s/iter; left time: 2667.4282s
Epoch: 2 cost time: 7.824464797973633
Epoch: 2, Steps: 154 | Train Loss: 2.080 Vali Loss: 2.179 Vali Acc: 0.320 Test Loss: 2.179 Test Acc: 0.320
Validation loss decreased (-0.318713 --> -0.319524).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8832532
	speed: 0.1814s/iter; left time: 2719.3105s
Epoch: 3 cost time: 7.0474464893341064
Epoch: 3, Steps: 154 | Train Loss: 2.006 Vali Loss: 2.172 Vali Acc: 0.324 Test Loss: 2.172 Test Acc: 0.324
Validation loss decreased (-0.319524 --> -0.324390).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0012515
	speed: 0.1787s/iter; left time: 2652.4387s
Epoch: 4 cost time: 7.8711769580841064
Epoch: 4, Steps: 154 | Train Loss: 1.948 Vali Loss: 2.122 Vali Acc: 0.328 Test Loss: 2.122 Test Acc: 0.328
Validation loss decreased (-0.324390 --> -0.328040).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8757229
	speed: 0.1580s/iter; left time: 2319.6903s
Epoch: 5 cost time: 6.337960243225098
Epoch: 5, Steps: 154 | Train Loss: 1.871 Vali Loss: 2.125 Vali Acc: 0.338 Test Loss: 2.125 Test Acc: 0.338
Validation loss decreased (-0.328040 --> -0.338178).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7839895
	speed: 0.1614s/iter; left time: 2344.9005s
Epoch: 6 cost time: 6.7674338817596436
Epoch: 6, Steps: 154 | Train Loss: 1.799 Vali Loss: 2.182 Vali Acc: 0.340 Test Loss: 2.182 Test Acc: 0.340
Validation loss decreased (-0.338178 --> -0.339800).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9201361
	speed: 0.1784s/iter; left time: 2564.6987s
Epoch: 7 cost time: 8.000356912612915
Epoch: 7, Steps: 154 | Train Loss: 1.743 Vali Loss: 2.261 Vali Acc: 0.346 Test Loss: 2.261 Test Acc: 0.346
Validation loss decreased (-0.339800 --> -0.346287).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9259379
	speed: 0.1702s/iter; left time: 2420.5460s
Epoch: 8 cost time: 6.417919158935547
Epoch: 8, Steps: 154 | Train Loss: 1.675 Vali Loss: 2.279 Vali Acc: 0.350 Test Loss: 2.279 Test Acc: 0.350
Validation loss decreased (-0.346287 --> -0.349937).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5009067
	speed: 0.1689s/iter; left time: 2376.6277s
Epoch: 9 cost time: 8.10133695602417
Epoch: 9, Steps: 154 | Train Loss: 1.612 Vali Loss: 2.440 Vali Acc: 0.356 Test Loss: 2.440 Test Acc: 0.356
Validation loss decreased (-0.349937 --> -0.355612).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0489192
	speed: 0.1924s/iter; left time: 2676.7507s
Epoch: 10 cost time: 7.850797176361084
Epoch: 10, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.356 Vali Acc: 0.359 Test Loss: 2.356 Test Acc: 0.359
Validation loss decreased (-0.355612 --> -0.359263).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1922154
	speed: 0.1694s/iter; left time: 2331.5612s
Epoch: 11 cost time: 5.8391735553741455
Epoch: 11, Steps: 154 | Train Loss: 1.572 Vali Loss: 2.435 Vali Acc: 0.356 Test Loss: 2.435 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.0211058
	speed: 0.1583s/iter; left time: 2153.8474s
Epoch: 12 cost time: 7.875705242156982
Epoch: 12, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.507 Vali Acc: 0.369 Test Loss: 2.507 Test Acc: 0.369
Validation loss decreased (-0.359263 --> -0.368588).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6745679
	speed: 0.1873s/iter; left time: 2519.7067s
Epoch: 13 cost time: 7.9315361976623535
Epoch: 13, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.432 Vali Acc: 0.358 Test Loss: 2.432 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3544688
	speed: 0.1997s/iter; left time: 2656.3940s
Epoch: 14 cost time: 7.297985076904297
Epoch: 14, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.505 Vali Acc: 0.360 Test Loss: 2.505 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.8390818
	speed: 0.1813s/iter; left time: 2383.4228s
Epoch: 15 cost time: 9.16556453704834
Epoch: 15, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.672 Vali Acc: 0.195 Test Loss: 2.672 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.5532053
	speed: 0.2007s/iter; left time: 2607.6975s
Epoch: 16 cost time: 8.280218124389648
Epoch: 16, Steps: 154 | Train Loss: 1.372 Vali Loss: 2.594 Vali Acc: 0.356 Test Loss: 2.594 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.9891061
	speed: 0.2034s/iter; left time: 2611.3936s
Epoch: 17 cost time: 8.144281387329102
Epoch: 17, Steps: 154 | Train Loss: 1.368 Vali Loss: 2.778 Vali Acc: 0.119 Test Loss: 2.778 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.3454779
	speed: 0.1855s/iter; left time: 2353.0535s
Epoch: 18 cost time: 7.735161304473877
Epoch: 18, Steps: 154 | Train Loss: 1.306 Vali Loss: 2.863 Vali Acc: 0.197 Test Loss: 2.863 Test Acc: 0.197
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.2945611
	speed: 0.1709s/iter; left time: 2140.8727s
Epoch: 19 cost time: 6.32025146484375
Epoch: 19, Steps: 154 | Train Loss: 1.305 Vali Loss: 2.769 Vali Acc: 0.205 Test Loss: 2.769 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.0134583
	speed: 0.1715s/iter; left time: 2122.2814s
Epoch: 20 cost time: 7.96865177154541
Epoch: 20, Steps: 154 | Train Loss: 1.267 Vali Loss: 2.814 Vali Acc: 0.369 Test Loss: 2.814 Test Acc: 0.369
Validation loss decreased (-0.368588 --> -0.369396).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.9194816
	speed: 0.1776s/iter; left time: 2170.4246s
Epoch: 21 cost time: 7.208194017410278
Epoch: 21, Steps: 154 | Train Loss: 1.250 Vali Loss: 2.984 Vali Acc: 0.202 Test Loss: 2.984 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.5007260
	speed: 0.1755s/iter; left time: 2117.9369s
Epoch: 22 cost time: 6.994802474975586
Epoch: 22, Steps: 154 | Train Loss: 1.213 Vali Loss: 3.227 Vali Acc: 0.176 Test Loss: 3.227 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.9903280
	speed: 0.1886s/iter; left time: 2246.9599s
Epoch: 23 cost time: 8.657915353775024
Epoch: 23, Steps: 154 | Train Loss: 1.259 Vali Loss: 3.250 Vali Acc: 0.207 Test Loss: 3.250 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.6223127
	speed: 0.2122s/iter; left time: 2495.4386s
Epoch: 24 cost time: 8.738890886306763
Epoch: 24, Steps: 154 | Train Loss: 1.238 Vali Loss: 2.894 Vali Acc: 0.201 Test Loss: 2.894 Test Acc: 0.201
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 1.4904728
	speed: 0.1891s/iter; left time: 2194.3922s
Epoch: 25 cost time: 7.813919544219971
Epoch: 25, Steps: 154 | Train Loss: 1.151 Vali Loss: 3.107 Vali Acc: 0.206 Test Loss: 3.107 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.9025327
	speed: 0.1957s/iter; left time: 2240.9228s
Epoch: 26 cost time: 8.156564235687256
Epoch: 26, Steps: 154 | Train Loss: 1.172 Vali Loss: 3.472 Vali Acc: 0.080 Test Loss: 3.472 Test Acc: 0.080
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 1.5640534
	speed: 0.1968s/iter; left time: 2223.7195s
Epoch: 27 cost time: 7.163562297821045
Epoch: 27, Steps: 154 | Train Loss: 1.156 Vali Loss: 3.323 Vali Acc: 0.193 Test Loss: 3.323 Test Acc: 0.193
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 1.5326221
	speed: 0.1740s/iter; left time: 1938.4135s
Epoch: 28 cost time: 8.892438411712646
Epoch: 28, Steps: 154 | Train Loss: 1.134 Vali Loss: 3.293 Vali Acc: 0.110 Test Loss: 3.293 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 1.1364772
	speed: 0.1905s/iter; left time: 2093.7011s
Epoch: 29 cost time: 7.656802654266357
Epoch: 29, Steps: 154 | Train Loss: 1.105 Vali Loss: 3.471 Vali Acc: 0.203 Test Loss: 3.471 Test Acc: 0.203
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 1.0048289
	speed: 0.1911s/iter; left time: 2071.0468s
Epoch: 30 cost time: 7.088522911071777
Epoch: 30, Steps: 154 | Train Loss: 1.081 Vali Loss: 3.511 Vali Acc: 0.191 Test Loss: 3.511 Test Acc: 0.191
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36942416869424166
model parameter : 183774
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0892491
	speed: 0.0669s/iter; left time: 1023.7821s
Epoch: 1 cost time: 9.36196494102478
Epoch: 1, Steps: 154 | Train Loss: 2.234 Vali Loss: 2.148 Vali Acc: 0.319 Test Loss: 2.148 Test Acc: 0.319
Validation loss decreased (inf --> -0.318713).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0062382
	speed: 0.1638s/iter; left time: 2481.1434s
Epoch: 2 cost time: 7.108977794647217
Epoch: 2, Steps: 154 | Train Loss: 2.079 Vali Loss: 2.189 Vali Acc: 0.318 Test Loss: 2.189 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8924317
	speed: 0.1797s/iter; left time: 2694.3481s
Epoch: 3 cost time: 7.226870775222778
Epoch: 3, Steps: 154 | Train Loss: 2.000 Vali Loss: 2.176 Vali Acc: 0.325 Test Loss: 2.176 Test Acc: 0.325
Validation loss decreased (-0.318713 --> -0.324796).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0358424
	speed: 0.1746s/iter; left time: 2590.2965s
Epoch: 4 cost time: 7.0948615074157715
Epoch: 4, Steps: 154 | Train Loss: 1.921 Vali Loss: 2.120 Vali Acc: 0.332 Test Loss: 2.120 Test Acc: 0.332
Validation loss decreased (-0.324796 --> -0.331690).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9625688
	speed: 0.1572s/iter; left time: 2308.4420s
Epoch: 5 cost time: 6.943918466567993
Epoch: 5, Steps: 154 | Train Loss: 1.850 Vali Loss: 2.126 Vali Acc: 0.341 Test Loss: 2.126 Test Acc: 0.341
Validation loss decreased (-0.331690 --> -0.341017).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7282166
	speed: 0.1812s/iter; left time: 2632.3192s
Epoch: 6 cost time: 7.612218618392944
Epoch: 6, Steps: 154 | Train Loss: 1.770 Vali Loss: 2.246 Vali Acc: 0.341 Test Loss: 2.246 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8282777
	speed: 0.2006s/iter; left time: 2883.5083s
Epoch: 7 cost time: 8.099467992782593
Epoch: 7, Steps: 154 | Train Loss: 1.713 Vali Loss: 2.237 Vali Acc: 0.347 Test Loss: 2.237 Test Acc: 0.347
Validation loss decreased (-0.341017 --> -0.346693).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8830730
	speed: 0.1843s/iter; left time: 2620.7291s
Epoch: 8 cost time: 7.612547159194946
Epoch: 8, Steps: 154 | Train Loss: 1.678 Vali Loss: 2.262 Vali Acc: 0.356 Test Loss: 2.262 Test Acc: 0.356
Validation loss decreased (-0.346693 --> -0.356425).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5355145
	speed: 0.1660s/iter; left time: 2335.7851s
Epoch: 9 cost time: 6.7075066566467285
Epoch: 9, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.463 Vali Acc: 0.361 Test Loss: 2.463 Test Acc: 0.361
Validation loss decreased (-0.356425 --> -0.360884).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9213810
	speed: 0.1822s/iter; left time: 2535.8201s
Epoch: 10 cost time: 7.57419490814209
Epoch: 10, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.386 Vali Acc: 0.364 Test Loss: 2.386 Test Acc: 0.364
Validation loss decreased (-0.360884 --> -0.363723).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.9823729
	speed: 0.1757s/iter; left time: 2417.4088s
Epoch: 11 cost time: 7.458000659942627
Epoch: 11, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.463 Vali Acc: 0.362 Test Loss: 2.463 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6601896
	speed: 0.1733s/iter; left time: 2357.6192s
Epoch: 12 cost time: 7.165631532669067
Epoch: 12, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.327 Vali Acc: 0.375 Test Loss: 2.327 Test Acc: 0.375
Validation loss decreased (-0.363723 --> -0.375078).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5615510
	speed: 0.1727s/iter; left time: 2323.5026s
Epoch: 13 cost time: 7.285231828689575
Epoch: 13, Steps: 154 | Train Loss: 1.462 Vali Loss: 2.280 Vali Acc: 0.371 Test Loss: 2.280 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3259714
	speed: 0.1623s/iter; left time: 2158.5404s
Epoch: 14 cost time: 7.0875163078308105
Epoch: 14, Steps: 154 | Train Loss: 1.381 Vali Loss: 2.441 Vali Acc: 0.365 Test Loss: 2.441 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.5251546
	speed: 0.1846s/iter; left time: 2426.4005s
Epoch: 15 cost time: 7.995574951171875
Epoch: 15, Steps: 154 | Train Loss: 1.349 Vali Loss: 2.573 Vali Acc: 0.224 Test Loss: 2.573 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.6194799
	speed: 0.1791s/iter; left time: 2327.1560s
Epoch: 16 cost time: 7.586589574813843
Epoch: 16, Steps: 154 | Train Loss: 1.336 Vali Loss: 2.455 Vali Acc: 0.373 Test Loss: 2.455 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.9588418
	speed: 0.1701s/iter; left time: 2183.1250s
Epoch: 17 cost time: 7.186877250671387
Epoch: 17, Steps: 154 | Train Loss: 1.348 Vali Loss: 2.537 Vali Acc: 0.217 Test Loss: 2.537 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.5924270
	speed: 0.1857s/iter; left time: 2354.9357s
Epoch: 18 cost time: 7.618168354034424
Epoch: 18, Steps: 154 | Train Loss: 1.313 Vali Loss: 2.574 Vali Acc: 0.209 Test Loss: 2.574 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.9428232
	speed: 0.1825s/iter; left time: 2286.9422s
Epoch: 19 cost time: 7.654269456863403
Epoch: 19, Steps: 154 | Train Loss: 1.294 Vali Loss: 2.631 Vali Acc: 0.206 Test Loss: 2.631 Test Acc: 0.206
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.1078761
	speed: 0.1646s/iter; left time: 2036.9360s
Epoch: 20 cost time: 6.825649976730347
Epoch: 20, Steps: 154 | Train Loss: 1.226 Vali Loss: 2.746 Vali Acc: 0.216 Test Loss: 2.746 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.9085482
	speed: 0.1683s/iter; left time: 2057.0642s
Epoch: 21 cost time: 7.0295891761779785
Epoch: 21, Steps: 154 | Train Loss: 1.201 Vali Loss: 2.804 Vali Acc: 0.212 Test Loss: 2.804 Test Acc: 0.212
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.5285612
	speed: 0.1862s/iter; left time: 2246.5773s
Epoch: 22 cost time: 7.38641357421875
Epoch: 22, Steps: 154 | Train Loss: 1.165 Vali Loss: 2.918 Vali Acc: 0.210 Test Loss: 2.918 Test Acc: 0.210
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3751013787510138
model parameter : 183774
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0756564
	speed: 0.0645s/iter; left time: 987.2705s
Epoch: 1 cost time: 8.963290214538574
Epoch: 1, Steps: 154 | Train Loss: 2.199 Vali Loss: 2.150 Vali Acc: 0.318 Test Loss: 2.150 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0060117
	speed: 0.1850s/iter; left time: 2801.9876s
Epoch: 2 cost time: 7.282040357589722
Epoch: 2, Steps: 154 | Train Loss: 2.055 Vali Loss: 2.218 Vali Acc: 0.319 Test Loss: 2.218 Test Acc: 0.319
Validation loss decreased (-0.318308 --> -0.318713).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8272468
	speed: 0.1731s/iter; left time: 2595.2167s
Epoch: 3 cost time: 6.580872058868408
Epoch: 3, Steps: 154 | Train Loss: 1.977 Vali Loss: 2.358 Vali Acc: 0.327 Test Loss: 2.358 Test Acc: 0.327
Validation loss decreased (-0.318713 --> -0.326822).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9939374
	speed: 0.1559s/iter; left time: 2312.7559s
Epoch: 4 cost time: 6.812947511672974
Epoch: 4, Steps: 154 | Train Loss: 1.864 Vali Loss: 2.146 Vali Acc: 0.336 Test Loss: 2.146 Test Acc: 0.336
Validation loss decreased (-0.326822 --> -0.336150).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8734275
	speed: 0.1673s/iter; left time: 2456.5605s
Epoch: 5 cost time: 7.396721124649048
Epoch: 5, Steps: 154 | Train Loss: 1.789 Vali Loss: 2.263 Vali Acc: 0.346 Test Loss: 2.263 Test Acc: 0.346
Validation loss decreased (-0.336150 --> -0.345882).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6317323
	speed: 0.1703s/iter; left time: 2474.3118s
Epoch: 6 cost time: 6.534804582595825
Epoch: 6, Steps: 154 | Train Loss: 1.697 Vali Loss: 2.368 Vali Acc: 0.356 Test Loss: 2.368 Test Acc: 0.356
Validation loss decreased (-0.345882 --> -0.356018).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7642109
	speed: 0.1629s/iter; left time: 2341.4187s
Epoch: 7 cost time: 7.842130661010742
Epoch: 7, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.272 Vali Acc: 0.361 Test Loss: 2.272 Test Acc: 0.361
Validation loss decreased (-0.356018 --> -0.360480).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6229398
	speed: 0.1824s/iter; left time: 2594.0020s
Epoch: 8 cost time: 7.131526708602905
Epoch: 8, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.328 Vali Acc: 0.367 Test Loss: 2.328 Test Acc: 0.367
Validation loss decreased (-0.360480 --> -0.366562).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1734799
	speed: 0.1349s/iter; left time: 1898.5145s
Epoch: 9 cost time: 6.130041837692261
Epoch: 9, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.401 Vali Acc: 0.364 Test Loss: 2.401 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.9783346
	speed: 0.1662s/iter; left time: 2312.8988s
Epoch: 10 cost time: 7.413980722427368
Epoch: 10, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.454 Vali Acc: 0.367 Test Loss: 2.454 Test Acc: 0.367
Validation loss decreased (-0.366562 --> -0.367372).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0385638
	speed: 0.1760s/iter; left time: 2422.2329s
Epoch: 11 cost time: 7.533301115036011
Epoch: 11, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.304 Vali Acc: 0.364 Test Loss: 2.304 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7519544
	speed: 0.1684s/iter; left time: 2290.8424s
Epoch: 12 cost time: 6.586699724197388
Epoch: 12, Steps: 154 | Train Loss: 1.390 Vali Loss: 2.303 Vali Acc: 0.376 Test Loss: 2.303 Test Acc: 0.376
Validation loss decreased (-0.367372 --> -0.375484).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6166201
	speed: 0.1721s/iter; left time: 2314.6470s
Epoch: 13 cost time: 7.402015924453735
Epoch: 13, Steps: 154 | Train Loss: 1.370 Vali Loss: 2.367 Vali Acc: 0.369 Test Loss: 2.367 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3300318
	speed: 0.1723s/iter; left time: 2291.8903s
Epoch: 14 cost time: 7.202550888061523
Epoch: 14, Steps: 154 | Train Loss: 1.340 Vali Loss: 2.236 Vali Acc: 0.369 Test Loss: 2.236 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.5152438
	speed: 0.1724s/iter; left time: 2265.8661s
Epoch: 15 cost time: 7.2407753467559814
Epoch: 15, Steps: 154 | Train Loss: 1.310 Vali Loss: 2.390 Vali Acc: 0.380 Test Loss: 2.390 Test Acc: 0.380
Validation loss decreased (-0.375484 --> -0.379944).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3033391
	speed: 0.1628s/iter; left time: 2114.3869s
Epoch: 16 cost time: 6.708702564239502
Epoch: 16, Steps: 154 | Train Loss: 1.237 Vali Loss: 2.348 Vali Acc: 0.380 Test Loss: 2.348 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.9711146
	speed: 0.1652s/iter; left time: 2120.2995s
Epoch: 17 cost time: 6.819467306137085
Epoch: 17, Steps: 154 | Train Loss: 1.276 Vali Loss: 2.352 Vali Acc: 0.376 Test Loss: 2.352 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.3459296
	speed: 0.1752s/iter; left time: 2221.9842s
Epoch: 18 cost time: 7.411199331283569
Epoch: 18, Steps: 154 | Train Loss: 1.210 Vali Loss: 2.392 Vali Acc: 0.384 Test Loss: 2.392 Test Acc: 0.384
Validation loss decreased (-0.379944 --> -0.383999).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.0654293
	speed: 0.1742s/iter; left time: 2183.1239s
Epoch: 19 cost time: 7.440272569656372
Epoch: 19, Steps: 154 | Train Loss: 1.237 Vali Loss: 2.446 Vali Acc: 0.372 Test Loss: 2.446 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.2331370
	speed: 0.1649s/iter; left time: 2040.6540s
Epoch: 20 cost time: 6.4512038230896
Epoch: 20, Steps: 154 | Train Loss: 1.135 Vali Loss: 2.470 Vali Acc: 0.380 Test Loss: 2.470 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.1506529
	speed: 0.1756s/iter; left time: 2145.7679s
Epoch: 21 cost time: 7.516954660415649
Epoch: 21, Steps: 154 | Train Loss: 1.125 Vali Loss: 2.552 Vali Acc: 0.234 Test Loss: 2.552 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.4395131
	speed: 0.1755s/iter; left time: 2117.3071s
Epoch: 22 cost time: 7.34835958480835
Epoch: 22, Steps: 154 | Train Loss: 1.128 Vali Loss: 2.565 Vali Acc: 0.229 Test Loss: 2.565 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.9173728
	speed: 0.1694s/iter; left time: 2017.5151s
Epoch: 23 cost time: 6.364880084991455
Epoch: 23, Steps: 154 | Train Loss: 1.130 Vali Loss: 2.665 Vali Acc: 0.235 Test Loss: 2.665 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.0784237
	speed: 0.1594s/iter; left time: 1874.6590s
Epoch: 24 cost time: 7.274794816970825
Epoch: 24, Steps: 154 | Train Loss: 1.151 Vali Loss: 2.624 Vali Acc: 0.369 Test Loss: 2.624 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.1063488
	speed: 0.1690s/iter; left time: 1961.3215s
Epoch: 25 cost time: 6.908596754074097
Epoch: 25, Steps: 154 | Train Loss: 1.056 Vali Loss: 2.390 Vali Acc: 0.380 Test Loss: 2.390 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.6684614
	speed: 0.1670s/iter; left time: 1912.6675s
Epoch: 26 cost time: 6.571838855743408
Epoch: 26, Steps: 154 | Train Loss: 1.173 Vali Loss: 2.753 Vali Acc: 0.296 Test Loss: 2.753 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.1866546
	speed: 0.1628s/iter; left time: 1839.1537s
Epoch: 27 cost time: 7.495139122009277
Epoch: 27, Steps: 154 | Train Loss: 1.019 Vali Loss: 2.986 Vali Acc: 0.215 Test Loss: 2.986 Test Acc: 0.215
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.5502824
	speed: 0.1687s/iter; left time: 1879.5252s
Epoch: 28 cost time: 6.876672744750977
Epoch: 28, Steps: 154 | Train Loss: 1.041 Vali Loss: 2.832 Vali Acc: 0.380 Test Loss: 2.832 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3840227088402271
model parameter : 183774
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9934962
	speed: 0.0610s/iter; left time: 933.4512s
Epoch: 1 cost time: 8.510206460952759
Epoch: 1, Steps: 154 | Train Loss: 2.287 Vali Loss: 2.154 Vali Acc: 0.318 Test Loss: 2.154 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1855774
	speed: 0.1700s/iter; left time: 2574.6202s
Epoch: 2 cost time: 7.09787917137146
Epoch: 2, Steps: 154 | Train Loss: 2.072 Vali Loss: 2.165 Vali Acc: 0.318 Test Loss: 2.165 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6666150
	speed: 0.1714s/iter; left time: 2569.1013s
Epoch: 3 cost time: 6.992280721664429
Epoch: 3, Steps: 154 | Train Loss: 1.977 Vali Loss: 2.180 Vali Acc: 0.320 Test Loss: 2.180 Test Acc: 0.320
Validation loss decreased (-0.318308 --> -0.320335).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2970257
	speed: 0.1544s/iter; left time: 2290.8204s
Epoch: 4 cost time: 7.191517114639282
Epoch: 4, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.165 Vali Acc: 0.323 Test Loss: 2.165 Test Acc: 0.323
Validation loss decreased (-0.320335 --> -0.322768).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4632819
	speed: 0.1771s/iter; left time: 2600.2979s
Epoch: 5 cost time: 7.583374738693237
Epoch: 5, Steps: 154 | Train Loss: 1.890 Vali Loss: 2.174 Vali Acc: 0.330 Test Loss: 2.174 Test Acc: 0.330
Validation loss decreased (-0.322768 --> -0.329662).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9692868
	speed: 0.1589s/iter; left time: 2308.5166s
Epoch: 6 cost time: 6.503964185714722
Epoch: 6, Steps: 154 | Train Loss: 1.826 Vali Loss: 2.129 Vali Acc: 0.338 Test Loss: 2.129 Test Acc: 0.338
Validation loss decreased (-0.329662 --> -0.338178).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8800166
	speed: 0.1752s/iter; left time: 2518.9049s
Epoch: 7 cost time: 7.289383888244629
Epoch: 7, Steps: 154 | Train Loss: 1.759 Vali Loss: 2.231 Vali Acc: 0.342 Test Loss: 2.231 Test Acc: 0.342
Validation loss decreased (-0.338178 --> -0.341827).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7790443
	speed: 0.1770s/iter; left time: 2517.1081s
Epoch: 8 cost time: 7.639549732208252
Epoch: 8, Steps: 154 | Train Loss: 1.712 Vali Loss: 2.338 Vali Acc: 0.353 Test Loss: 2.338 Test Acc: 0.353
Validation loss decreased (-0.341827 --> -0.353180).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.1731775
	speed: 0.1777s/iter; left time: 2500.0421s
Epoch: 9 cost time: 7.6709606647491455
Epoch: 9, Steps: 154 | Train Loss: 1.654 Vali Loss: 2.421 Vali Acc: 0.354 Test Loss: 2.421 Test Acc: 0.354
Validation loss decreased (-0.353180 --> -0.353585).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6749835
	speed: 0.1736s/iter; left time: 2416.0652s
Epoch: 10 cost time: 6.797203302383423
Epoch: 10, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.514 Vali Acc: 0.366 Test Loss: 2.514 Test Acc: 0.366
Validation loss decreased (-0.353585 --> -0.365749).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5337659
	speed: 0.1692s/iter; left time: 2328.2946s
Epoch: 11 cost time: 7.523780345916748
Epoch: 11, Steps: 154 | Train Loss: 1.564 Vali Loss: 2.727 Vali Acc: 0.095 Test Loss: 2.727 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3461896
	speed: 0.1697s/iter; left time: 2308.8820s
Epoch: 12 cost time: 6.5330517292022705
Epoch: 12, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.664 Vali Acc: 0.366 Test Loss: 2.664 Test Acc: 0.366
Validation loss decreased (-0.365749 --> -0.366153).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2086364
	speed: 0.1648s/iter; left time: 2217.1488s
Epoch: 13 cost time: 7.292038440704346
Epoch: 13, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.952 Vali Acc: 0.145 Test Loss: 2.952 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4098991
	speed: 0.1674s/iter; left time: 2226.7580s
Epoch: 14 cost time: 7.382699728012085
Epoch: 14, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.626 Vali Acc: 0.176 Test Loss: 2.626 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3846158
	speed: 0.1703s/iter; left time: 2238.6228s
Epoch: 15 cost time: 6.6840386390686035
Epoch: 15, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.795 Vali Acc: 0.199 Test Loss: 2.795 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.7217127
	speed: 0.1581s/iter; left time: 2053.8069s
Epoch: 16 cost time: 7.610835790634155
Epoch: 16, Steps: 154 | Train Loss: 1.400 Vali Loss: 3.072 Vali Acc: 0.099 Test Loss: 3.072 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.7958211
	speed: 0.1835s/iter; left time: 2355.0316s
Epoch: 17 cost time: 7.643219709396362
Epoch: 17, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.975 Vali Acc: 0.079 Test Loss: 2.975 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.4965247
	speed: 0.1681s/iter; left time: 2131.4938s
Epoch: 18 cost time: 6.453554630279541
Epoch: 18, Steps: 154 | Train Loss: 1.349 Vali Loss: 2.934 Vali Acc: 0.206 Test Loss: 2.934 Test Acc: 0.206
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.4503824
	speed: 0.1578s/iter; left time: 1977.1378s
Epoch: 19 cost time: 7.071066856384277
Epoch: 19, Steps: 154 | Train Loss: 1.376 Vali Loss: 2.864 Vali Acc: 0.221 Test Loss: 2.864 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.8122597
	speed: 0.1721s/iter; left time: 2129.6028s
Epoch: 20 cost time: 7.369618654251099
Epoch: 20, Steps: 154 | Train Loss: 1.375 Vali Loss: 3.205 Vali Acc: 0.073 Test Loss: 3.205 Test Acc: 0.073
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.4325165
	speed: 0.1743s/iter; left time: 2129.9376s
Epoch: 21 cost time: 7.351627349853516
Epoch: 21, Steps: 154 | Train Loss: 1.337 Vali Loss: 3.266 Vali Acc: 0.069 Test Loss: 3.266 Test Acc: 0.069
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.1103894
	speed: 0.1561s/iter; left time: 1883.8295s
Epoch: 22 cost time: 7.301082611083984
Epoch: 22, Steps: 154 | Train Loss: 1.268 Vali Loss: 3.226 Vali Acc: 0.075 Test Loss: 3.226 Test Acc: 0.075
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3661800486618005
model parameter : 118238
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9930866
	speed: 0.0653s/iter; left time: 999.1483s
Epoch: 1 cost time: 9.210490703582764
Epoch: 1, Steps: 154 | Train Loss: 2.282 Vali Loss: 2.154 Vali Acc: 0.318 Test Loss: 2.154 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2050903
	speed: 0.1814s/iter; left time: 2747.2259s
Epoch: 2 cost time: 7.028068542480469
Epoch: 2, Steps: 154 | Train Loss: 2.073 Vali Loss: 2.170 Vali Acc: 0.317 Test Loss: 2.170 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6512026
	speed: 0.1572s/iter; left time: 2356.4452s
Epoch: 3 cost time: 7.1452882289886475
Epoch: 3, Steps: 154 | Train Loss: 1.985 Vali Loss: 2.191 Vali Acc: 0.321 Test Loss: 2.191 Test Acc: 0.321
Validation loss decreased (-0.317902 --> -0.320740).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2427404
	speed: 0.1601s/iter; left time: 2375.6571s
Epoch: 4 cost time: 6.688492059707642
Epoch: 4, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.173 Vali Acc: 0.322 Test Loss: 2.173 Test Acc: 0.322
Validation loss decreased (-0.320740 --> -0.322363).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4831281
	speed: 0.1558s/iter; left time: 2288.3920s
Epoch: 5 cost time: 6.477697134017944
Epoch: 5, Steps: 154 | Train Loss: 1.868 Vali Loss: 2.162 Vali Acc: 0.334 Test Loss: 2.162 Test Acc: 0.334
Validation loss decreased (-0.322363 --> -0.334123).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9492420
	speed: 0.1622s/iter; left time: 2356.7616s
Epoch: 6 cost time: 6.845024347305298
Epoch: 6, Steps: 154 | Train Loss: 1.804 Vali Loss: 2.127 Vali Acc: 0.343 Test Loss: 2.127 Test Acc: 0.343
Validation loss decreased (-0.334123 --> -0.342639).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8508489
	speed: 0.1502s/iter; left time: 2159.6722s
Epoch: 7 cost time: 5.98487401008606
Epoch: 7, Steps: 154 | Train Loss: 1.758 Vali Loss: 2.215 Vali Acc: 0.348 Test Loss: 2.215 Test Acc: 0.348
Validation loss decreased (-0.342639 --> -0.348315).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7926759
	speed: 0.1672s/iter; left time: 2378.1570s
Epoch: 8 cost time: 7.330188512802124
Epoch: 8, Steps: 154 | Train Loss: 1.702 Vali Loss: 2.273 Vali Acc: 0.354 Test Loss: 2.273 Test Acc: 0.354
Validation loss decreased (-0.348315 --> -0.354397).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2708361
	speed: 0.1749s/iter; left time: 2460.5453s
Epoch: 9 cost time: 7.595274209976196
Epoch: 9, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.374 Vali Acc: 0.357 Test Loss: 2.374 Test Acc: 0.357
Validation loss decreased (-0.354397 --> -0.357235).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5736208
	speed: 0.1868s/iter; left time: 2598.8000s
Epoch: 10 cost time: 7.696151971817017
Epoch: 10, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.472 Vali Acc: 0.369 Test Loss: 2.472 Test Acc: 0.369
Validation loss decreased (-0.357235 --> -0.368588).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5891989
	speed: 0.1721s/iter; left time: 2367.8283s
Epoch: 11 cost time: 6.702008485794067
Epoch: 11, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.675 Vali Acc: 0.257 Test Loss: 2.675 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3596492
	speed: 0.1638s/iter; left time: 2228.4324s
Epoch: 12 cost time: 7.230474948883057
Epoch: 12, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.682 Vali Acc: 0.369 Test Loss: 2.682 Test Acc: 0.369
Validation loss decreased (-0.368588 --> -0.369397).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2449944
	speed: 0.1701s/iter; left time: 2287.9247s
Epoch: 13 cost time: 6.7477638721466064
Epoch: 13, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.710 Vali Acc: 0.195 Test Loss: 2.710 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5925987
	speed: 0.1658s/iter; left time: 2204.4539s
Epoch: 14 cost time: 6.854351282119751
Epoch: 14, Steps: 154 | Train Loss: 1.458 Vali Loss: 2.555 Vali Acc: 0.378 Test Loss: 2.555 Test Acc: 0.378
Validation loss decreased (-0.369397 --> -0.377509).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.1973366
	speed: 0.1523s/iter; left time: 2002.0643s
Epoch: 15 cost time: 6.869907855987549
Epoch: 15, Steps: 154 | Train Loss: 1.425 Vali Loss: 2.782 Vali Acc: 0.206 Test Loss: 2.782 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.7189562
	speed: 0.1730s/iter; left time: 2247.5882s
Epoch: 16 cost time: 7.021867275238037
Epoch: 16, Steps: 154 | Train Loss: 1.377 Vali Loss: 3.001 Vali Acc: 0.117 Test Loss: 3.001 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.6858956
	speed: 0.1636s/iter; left time: 2099.5655s
Epoch: 17 cost time: 6.709381341934204
Epoch: 17, Steps: 154 | Train Loss: 1.381 Vali Loss: 3.185 Vali Acc: 0.076 Test Loss: 3.185 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.3994451
	speed: 0.1609s/iter; left time: 2041.2927s
Epoch: 18 cost time: 7.209271192550659
Epoch: 18, Steps: 154 | Train Loss: 1.318 Vali Loss: 3.094 Vali Acc: 0.082 Test Loss: 3.094 Test Acc: 0.082
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.1269546
	speed: 0.1743s/iter; left time: 2183.2727s
Epoch: 19 cost time: 6.8761889934539795
Epoch: 19, Steps: 154 | Train Loss: 1.312 Vali Loss: 3.052 Vali Acc: 0.113 Test Loss: 3.052 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.8652170
	speed: 0.1724s/iter; left time: 2134.0297s
Epoch: 20 cost time: 7.418614387512207
Epoch: 20, Steps: 154 | Train Loss: 1.340 Vali Loss: 2.903 Vali Acc: 0.202 Test Loss: 2.903 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.8383450
	speed: 0.1644s/iter; left time: 2009.6446s
Epoch: 21 cost time: 6.852639198303223
Epoch: 21, Steps: 154 | Train Loss: 1.265 Vali Loss: 3.213 Vali Acc: 0.080 Test Loss: 3.213 Test Acc: 0.080
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.1275268
	speed: 0.1572s/iter; left time: 1896.8279s
Epoch: 22 cost time: 7.135124444961548
Epoch: 22, Steps: 154 | Train Loss: 1.279 Vali Loss: 2.961 Vali Acc: 0.088 Test Loss: 2.961 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.0300061
	speed: 0.1678s/iter; left time: 1999.4988s
Epoch: 23 cost time: 7.2866833209991455
Epoch: 23, Steps: 154 | Train Loss: 1.281 Vali Loss: 3.094 Vali Acc: 0.088 Test Loss: 3.094 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.1275116
	speed: 0.1647s/iter; left time: 1936.6858s
Epoch: 24 cost time: 6.33790922164917
Epoch: 24, Steps: 154 | Train Loss: 1.179 Vali Loss: 3.526 Vali Acc: 0.082 Test Loss: 3.526 Test Acc: 0.082
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3775344687753447
model parameter : 118238
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9419144
	speed: 0.0579s/iter; left time: 886.3390s
Epoch: 1 cost time: 8.098792791366577
Epoch: 1, Steps: 154 | Train Loss: 2.264 Vali Loss: 2.158 Vali Acc: 0.318 Test Loss: 2.158 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2433043
	speed: 0.1564s/iter; left time: 2369.3574s
Epoch: 2 cost time: 6.064925909042358
Epoch: 2, Steps: 154 | Train Loss: 2.068 Vali Loss: 2.188 Vali Acc: 0.318 Test Loss: 2.188 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6512170
	speed: 0.1593s/iter; left time: 2388.4814s
Epoch: 3 cost time: 7.191461086273193
Epoch: 3, Steps: 154 | Train Loss: 1.976 Vali Loss: 2.203 Vali Acc: 0.321 Test Loss: 2.203 Test Acc: 0.321
Validation loss decreased (-0.317902 --> -0.321146).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1823461
	speed: 0.1554s/iter; left time: 2306.2330s
Epoch: 4 cost time: 6.5238893032073975
Epoch: 4, Steps: 154 | Train Loss: 1.919 Vali Loss: 2.184 Vali Acc: 0.324 Test Loss: 2.184 Test Acc: 0.324
Validation loss decreased (-0.321146 --> -0.324390).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4291356
	speed: 0.1571s/iter; left time: 2307.6075s
Epoch: 5 cost time: 6.337727308273315
Epoch: 5, Steps: 154 | Train Loss: 1.855 Vali Loss: 2.153 Vali Acc: 0.339 Test Loss: 2.153 Test Acc: 0.339
Validation loss decreased (-0.324390 --> -0.339395).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8650635
	speed: 0.1420s/iter; left time: 2063.6084s
Epoch: 6 cost time: 6.662439823150635
Epoch: 6, Steps: 154 | Train Loss: 1.774 Vali Loss: 2.142 Vali Acc: 0.348 Test Loss: 2.142 Test Acc: 0.348
Validation loss decreased (-0.339395 --> -0.348316).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6956543
	speed: 0.1685s/iter; left time: 2422.7708s
Epoch: 7 cost time: 7.066274166107178
Epoch: 7, Steps: 154 | Train Loss: 1.738 Vali Loss: 2.215 Vali Acc: 0.354 Test Loss: 2.215 Test Acc: 0.354
Validation loss decreased (-0.348316 --> -0.353992).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7265903
	speed: 0.1780s/iter; left time: 2531.4051s
Epoch: 8 cost time: 7.563827991485596
Epoch: 8, Steps: 154 | Train Loss: 1.648 Vali Loss: 2.360 Vali Acc: 0.369 Test Loss: 2.360 Test Acc: 0.369
Validation loss decreased (-0.353992 --> -0.368590).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0536304
	speed: 0.1727s/iter; left time: 2429.2707s
Epoch: 9 cost time: 7.205593585968018
Epoch: 9, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.403 Vali Acc: 0.362 Test Loss: 2.403 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5537446
	speed: 0.1686s/iter; left time: 2346.1175s
Epoch: 10 cost time: 7.146907567977905
Epoch: 10, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.339 Vali Acc: 0.367 Test Loss: 2.339 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.6538991
	speed: 0.1703s/iter; left time: 2343.6536s
Epoch: 11 cost time: 7.1804070472717285
Epoch: 11, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.402 Vali Acc: 0.388 Test Loss: 2.402 Test Acc: 0.388
Validation loss decreased (-0.368590 --> -0.388459).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2751135
	speed: 0.1537s/iter; left time: 2091.3620s
Epoch: 12 cost time: 6.5014073848724365
Epoch: 12, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.358 Vali Acc: 0.373 Test Loss: 2.358 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1965077
	speed: 0.1591s/iter; left time: 2140.9778s
Epoch: 13 cost time: 6.895554304122925
Epoch: 13, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.536 Vali Acc: 0.266 Test Loss: 2.536 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.5047442
	speed: 0.1623s/iter; left time: 2158.9408s
Epoch: 14 cost time: 7.035068035125732
Epoch: 14, Steps: 154 | Train Loss: 1.392 Vali Loss: 2.342 Vali Acc: 0.377 Test Loss: 2.342 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.1695728
	speed: 0.1681s/iter; left time: 2210.1896s
Epoch: 15 cost time: 6.824729919433594
Epoch: 15, Steps: 154 | Train Loss: 1.331 Vali Loss: 2.459 Vali Acc: 0.378 Test Loss: 2.459 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.7434351
	speed: 0.1592s/iter; left time: 2068.7594s
Epoch: 16 cost time: 6.9732139110565186
Epoch: 16, Steps: 154 | Train Loss: 1.299 Vali Loss: 2.530 Vali Acc: 0.322 Test Loss: 2.530 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.7726282
	speed: 0.1619s/iter; left time: 2077.7412s
Epoch: 17 cost time: 6.831880331039429
Epoch: 17, Steps: 154 | Train Loss: 1.319 Vali Loss: 2.610 Vali Acc: 0.213 Test Loss: 2.610 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.4577688
	speed: 0.1754s/iter; left time: 2224.1262s
Epoch: 18 cost time: 7.166626930236816
Epoch: 18, Steps: 154 | Train Loss: 1.321 Vali Loss: 2.511 Vali Acc: 0.234 Test Loss: 2.511 Test Acc: 0.234
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.3155060
	speed: 0.1646s/iter; left time: 2062.6307s
Epoch: 19 cost time: 7.6667375564575195
Epoch: 19, Steps: 154 | Train Loss: 1.261 Vali Loss: 2.567 Vali Acc: 0.230 Test Loss: 2.567 Test Acc: 0.230
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 2.0254021
	speed: 0.1714s/iter; left time: 2121.0345s
Epoch: 20 cost time: 6.7017927169799805
Epoch: 20, Steps: 154 | Train Loss: 1.236 Vali Loss: 2.556 Vali Acc: 0.238 Test Loss: 2.556 Test Acc: 0.238
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.8844355
	speed: 0.1596s/iter; left time: 1950.5959s
Epoch: 21 cost time: 6.8200671672821045
Epoch: 21, Steps: 154 | Train Loss: 1.201 Vali Loss: 2.698 Vali Acc: 0.211 Test Loss: 2.698 Test Acc: 0.211
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3884833738848337
model parameter : 118238
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9601110
	speed: 0.0723s/iter; left time: 1106.8686s
Epoch: 1 cost time: 9.513103485107422
Epoch: 1, Steps: 154 | Train Loss: 2.240 Vali Loss: 2.146 Vali Acc: 0.318 Test Loss: 2.146 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2315512
	speed: 0.1915s/iter; left time: 2899.9008s
Epoch: 2 cost time: 7.303184509277344
Epoch: 2, Steps: 154 | Train Loss: 2.060 Vali Loss: 2.208 Vali Acc: 0.318 Test Loss: 2.208 Test Acc: 0.318
Validation loss decreased (-0.317902 --> -0.318307).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6567436
	speed: 0.1926s/iter; left time: 2887.1714s
Epoch: 3 cost time: 6.856948137283325
Epoch: 3, Steps: 154 | Train Loss: 1.958 Vali Loss: 2.311 Vali Acc: 0.322 Test Loss: 2.311 Test Acc: 0.322
Validation loss decreased (-0.318307 --> -0.322361).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2183452
	speed: 0.1784s/iter; left time: 2647.9823s
Epoch: 4 cost time: 6.966280698776245
Epoch: 4, Steps: 154 | Train Loss: 1.884 Vali Loss: 2.382 Vali Acc: 0.325 Test Loss: 2.382 Test Acc: 0.325
Validation loss decreased (-0.322361 --> -0.324794).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3332815
	speed: 0.1868s/iter; left time: 2743.0097s
Epoch: 5 cost time: 6.911313772201538
Epoch: 5, Steps: 154 | Train Loss: 1.797 Vali Loss: 2.330 Vali Acc: 0.343 Test Loss: 2.330 Test Acc: 0.343
Validation loss decreased (-0.324794 --> -0.342637).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7484542
	speed: 0.1753s/iter; left time: 2546.9917s
Epoch: 6 cost time: 6.75581955909729
Epoch: 6, Steps: 154 | Train Loss: 1.708 Vali Loss: 2.762 Vali Acc: 0.344 Test Loss: 2.762 Test Acc: 0.344
Validation loss decreased (-0.342637 --> -0.344255).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4918835
	speed: 0.1787s/iter; left time: 2568.5735s
Epoch: 7 cost time: 6.7552878856658936
Epoch: 7, Steps: 154 | Train Loss: 1.636 Vali Loss: 2.463 Vali Acc: 0.362 Test Loss: 2.463 Test Acc: 0.362
Validation loss decreased (-0.344255 --> -0.361695).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6635675
	speed: 0.1737s/iter; left time: 2469.9211s
Epoch: 8 cost time: 6.653985500335693
Epoch: 8, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.567 Vali Acc: 0.359 Test Loss: 2.567 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7304916
	speed: 0.1802s/iter; left time: 2535.3232s
Epoch: 9 cost time: 6.79231858253479
Epoch: 9, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.579 Vali Acc: 0.363 Test Loss: 2.579 Test Acc: 0.363
Validation loss decreased (-0.361695 --> -0.362505).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6770581
	speed: 0.1857s/iter; left time: 2584.6452s
Epoch: 10 cost time: 7.324904203414917
Epoch: 10, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.488 Vali Acc: 0.371 Test Loss: 2.488 Test Acc: 0.371
Validation loss decreased (-0.362505 --> -0.371021).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4453686
	speed: 0.1943s/iter; left time: 2673.0839s
Epoch: 11 cost time: 7.974773168563843
Epoch: 11, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.169 Vali Acc: 0.393 Test Loss: 2.169 Test Acc: 0.393
Validation loss decreased (-0.371021 --> -0.392517).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1017216
	speed: 0.2033s/iter; left time: 2765.6673s
Epoch: 12 cost time: 8.22493052482605
Epoch: 12, Steps: 154 | Train Loss: 1.368 Vali Loss: 2.523 Vali Acc: 0.369 Test Loss: 2.523 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9880376
	speed: 0.2278s/iter; left time: 3064.1809s
Epoch: 13 cost time: 9.340546607971191
Epoch: 13, Steps: 154 | Train Loss: 1.333 Vali Loss: 2.347 Vali Acc: 0.384 Test Loss: 2.347 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.4595091
	speed: 0.2247s/iter; left time: 2988.3879s
Epoch: 14 cost time: 8.022666215896606
Epoch: 14, Steps: 154 | Train Loss: 1.309 Vali Loss: 2.323 Vali Acc: 0.380 Test Loss: 2.323 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.2361978
	speed: 0.2280s/iter; left time: 2996.4033s
Epoch: 15 cost time: 9.341238975524902
Epoch: 15, Steps: 154 | Train Loss: 1.298 Vali Loss: 2.701 Vali Acc: 0.338 Test Loss: 2.701 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.2013863
	speed: 0.2086s/iter; left time: 2709.4997s
Epoch: 16 cost time: 7.712591886520386
Epoch: 16, Steps: 154 | Train Loss: 1.247 Vali Loss: 2.577 Vali Acc: 0.362 Test Loss: 2.577 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.1481519
	speed: 0.2016s/iter; left time: 2587.6658s
Epoch: 17 cost time: 7.738713979721069
Epoch: 17, Steps: 154 | Train Loss: 1.219 Vali Loss: 2.306 Vali Acc: 0.386 Test Loss: 2.306 Test Acc: 0.386
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.3686676
	speed: 0.2320s/iter; left time: 2941.9980s
Epoch: 18 cost time: 8.86975646018982
Epoch: 18, Steps: 154 | Train Loss: 1.246 Vali Loss: 2.441 Vali Acc: 0.386 Test Loss: 2.441 Test Acc: 0.386
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.0946068
	speed: 0.2490s/iter; left time: 3119.3693s
Epoch: 19 cost time: 9.328909397125244
Epoch: 19, Steps: 154 | Train Loss: 1.189 Vali Loss: 2.540 Vali Acc: 0.388 Test Loss: 2.540 Test Acc: 0.388
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.8266799
	speed: 0.2471s/iter; left time: 3057.8127s
Epoch: 20 cost time: 8.780024290084839
Epoch: 20, Steps: 154 | Train Loss: 1.195 Vali Loss: 2.582 Vali Acc: 0.374 Test Loss: 2.582 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.1857915
	speed: 0.2364s/iter; left time: 2889.6188s
Epoch: 21 cost time: 9.23886251449585
Epoch: 21, Steps: 154 | Train Loss: 1.139 Vali Loss: 2.492 Vali Acc: 0.399 Test Loss: 2.492 Test Acc: 0.399
Validation loss decreased (-0.392517 --> -0.399002).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.0182945
	speed: 0.2449s/iter; left time: 2955.0027s
Epoch: 22 cost time: 9.380888938903809
Epoch: 22, Steps: 154 | Train Loss: 1.141 Vali Loss: 2.655 Vali Acc: 0.386 Test Loss: 2.655 Test Acc: 0.386
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.1865008
	speed: 0.2088s/iter; left time: 2487.0489s
Epoch: 23 cost time: 8.067852258682251
Epoch: 23, Steps: 154 | Train Loss: 1.110 Vali Loss: 2.722 Vali Acc: 0.376 Test Loss: 2.722 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.8714656
	speed: 0.2320s/iter; left time: 2728.0745s
Epoch: 24 cost time: 8.805176496505737
Epoch: 24, Steps: 154 | Train Loss: 1.078 Vali Loss: 2.802 Vali Acc: 0.390 Test Loss: 2.802 Test Acc: 0.390
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.7118970
	speed: 0.2326s/iter; left time: 2699.0955s
Epoch: 25 cost time: 8.725297451019287
Epoch: 25, Steps: 154 | Train Loss: 1.101 Vali Loss: 2.898 Vali Acc: 0.389 Test Loss: 2.898 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.1145779
	speed: 0.2079s/iter; left time: 2380.8130s
Epoch: 26 cost time: 7.577580451965332
Epoch: 26, Steps: 154 | Train Loss: 1.038 Vali Loss: 3.167 Vali Acc: 0.137 Test Loss: 3.167 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.7595906
	speed: 0.2133s/iter; left time: 2409.4393s
Epoch: 27 cost time: 8.497169733047485
Epoch: 27, Steps: 154 | Train Loss: 1.018 Vali Loss: 3.163 Vali Acc: 0.341 Test Loss: 3.163 Test Acc: 0.341
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.8557206
	speed: 0.2060s/iter; left time: 2295.5129s
Epoch: 28 cost time: 8.224247217178345
Epoch: 28, Steps: 154 | Train Loss: 0.993 Vali Loss: 3.220 Vali Acc: 0.193 Test Loss: 3.220 Test Acc: 0.193
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 1.5877057
	speed: 0.2240s/iter; left time: 2461.8973s
Epoch: 29 cost time: 8.762370824813843
Epoch: 29, Steps: 154 | Train Loss: 0.986 Vali Loss: 3.054 Vali Acc: 0.114 Test Loss: 3.054 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.0785697
	speed: 0.2238s/iter; left time: 2424.8196s
Epoch: 30 cost time: 9.323369264602661
Epoch: 30, Steps: 154 | Train Loss: 0.960 Vali Loss: 3.109 Vali Acc: 0.206 Test Loss: 3.109 Test Acc: 0.206
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.6155856
	speed: 0.1698s/iter; left time: 1813.4314s
Epoch: 31 cost time: 7.436871528625488
Epoch: 31, Steps: 154 | Train Loss: 0.985 Vali Loss: 2.884 Vali Acc: 0.371 Test Loss: 2.884 Test Acc: 0.371
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39902676399026765
model parameter : 118238
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6079874
	speed: 0.0611s/iter; left time: 934.8182s
Epoch: 1 cost time: 8.316371440887451
Epoch: 1, Steps: 154 | Train Loss: 2.275 Vali Loss: 2.151 Vali Acc: 0.317 Test Loss: 2.151 Test Acc: 0.317
Validation loss decreased (inf --> -0.316686).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4409847
	speed: 0.1525s/iter; left time: 2309.1917s
Epoch: 2 cost time: 6.883981227874756
Epoch: 2, Steps: 154 | Train Loss: 2.050 Vali Loss: 2.130 Vali Acc: 0.322 Test Loss: 2.130 Test Acc: 0.322
Validation loss decreased (-0.316686 --> -0.321552).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0003252
	speed: 0.1669s/iter; left time: 2502.4427s
Epoch: 3 cost time: 6.950860977172852
Epoch: 3, Steps: 154 | Train Loss: 1.995 Vali Loss: 2.157 Vali Acc: 0.322 Test Loss: 2.157 Test Acc: 0.322
Validation loss decreased (-0.321552 --> -0.321957).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8323319
	speed: 0.1629s/iter; left time: 2416.6774s
Epoch: 4 cost time: 7.087426424026489
Epoch: 4, Steps: 154 | Train Loss: 1.958 Vali Loss: 2.160 Vali Acc: 0.323 Test Loss: 2.160 Test Acc: 0.323
Validation loss decreased (-0.321957 --> -0.322768).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8186473
	speed: 0.1605s/iter; left time: 2356.3585s
Epoch: 5 cost time: 6.537707328796387
Epoch: 5, Steps: 154 | Train Loss: 1.889 Vali Loss: 2.164 Vali Acc: 0.324 Test Loss: 2.164 Test Acc: 0.324
Validation loss decreased (-0.322768 --> -0.324390).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9102064
	speed: 0.1609s/iter; left time: 2338.5069s
Epoch: 6 cost time: 6.650182247161865
Epoch: 6, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.185 Vali Acc: 0.326 Test Loss: 2.185 Test Acc: 0.326
Validation loss decreased (-0.324390 --> -0.326012).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8879331
	speed: 0.1627s/iter; left time: 2339.7995s
Epoch: 7 cost time: 7.045390844345093
Epoch: 7, Steps: 154 | Train Loss: 1.797 Vali Loss: 2.183 Vali Acc: 0.335 Test Loss: 2.183 Test Acc: 0.335
Validation loss decreased (-0.326012 --> -0.334934).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4627471
	speed: 0.1619s/iter; left time: 2303.1671s
Epoch: 8 cost time: 6.711210012435913
Epoch: 8, Steps: 154 | Train Loss: 1.749 Vali Loss: 2.228 Vali Acc: 0.342 Test Loss: 2.228 Test Acc: 0.342
Validation loss decreased (-0.334934 --> -0.341827).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9867320
	speed: 0.1564s/iter; left time: 2200.1464s
Epoch: 9 cost time: 6.3639631271362305
Epoch: 9, Steps: 154 | Train Loss: 1.678 Vali Loss: 2.271 Vali Acc: 0.353 Test Loss: 2.271 Test Acc: 0.353
Validation loss decreased (-0.341827 --> -0.353181).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5186284
	speed: 0.1435s/iter; left time: 1997.4716s
Epoch: 10 cost time: 6.135310411453247
Epoch: 10, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.351 Vali Acc: 0.364 Test Loss: 2.351 Test Acc: 0.364
Validation loss decreased (-0.353181 --> -0.363723).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4096928
	speed: 0.1512s/iter; left time: 2081.0050s
Epoch: 11 cost time: 6.5894434452056885
Epoch: 11, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.337 Vali Acc: 0.356 Test Loss: 2.337 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2266902
	speed: 0.1591s/iter; left time: 2164.2180s
Epoch: 12 cost time: 7.380544424057007
Epoch: 12, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.435 Vali Acc: 0.374 Test Loss: 2.435 Test Acc: 0.374
Validation loss decreased (-0.363723 --> -0.374266).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6525512
	speed: 0.1549s/iter; left time: 2084.2785s
Epoch: 13 cost time: 6.834318399429321
Epoch: 13, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.422 Vali Acc: 0.365 Test Loss: 2.422 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5069132
	speed: 0.1565s/iter; left time: 2081.8727s
Epoch: 14 cost time: 6.232976913452148
Epoch: 14, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.556 Vali Acc: 0.372 Test Loss: 2.556 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3129846
	speed: 0.1506s/iter; left time: 1980.2147s
Epoch: 15 cost time: 6.383459568023682
Epoch: 15, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.562 Vali Acc: 0.376 Test Loss: 2.562 Test Acc: 0.376
Validation loss decreased (-0.374266 --> -0.375887).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.0178840
	speed: 0.1405s/iter; left time: 1825.4924s
Epoch: 16 cost time: 5.983714580535889
Epoch: 16, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.714 Vali Acc: 0.093 Test Loss: 2.714 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.0662618
	speed: 0.1351s/iter; left time: 1733.8610s
Epoch: 17 cost time: 5.603289365768433
Epoch: 17, Steps: 154 | Train Loss: 1.401 Vali Loss: 2.783 Vali Acc: 0.208 Test Loss: 2.783 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.3938054
	speed: 0.1326s/iter; left time: 1681.1484s
Epoch: 18 cost time: 6.25719141960144
Epoch: 18, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.748 Vali Acc: 0.148 Test Loss: 2.748 Test Acc: 0.148
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.6131685
	speed: 0.1438s/iter; left time: 1801.5796s
Epoch: 19 cost time: 6.051061630249023
Epoch: 19, Steps: 154 | Train Loss: 1.367 Vali Loss: 3.073 Vali Acc: 0.069 Test Loss: 3.073 Test Acc: 0.069
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.2666174
	speed: 0.1495s/iter; left time: 1850.0829s
Epoch: 20 cost time: 6.4649574756622314
Epoch: 20, Steps: 154 | Train Loss: 1.351 Vali Loss: 2.828 Vali Acc: 0.083 Test Loss: 2.828 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.5317284
	speed: 0.1476s/iter; left time: 1803.8373s
Epoch: 21 cost time: 6.567714214324951
Epoch: 21, Steps: 154 | Train Loss: 1.360 Vali Loss: 2.896 Vali Acc: 0.105 Test Loss: 2.896 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.7953401
	speed: 0.1551s/iter; left time: 1871.8971s
Epoch: 22 cost time: 6.294173002243042
Epoch: 22, Steps: 154 | Train Loss: 1.311 Vali Loss: 3.174 Vali Acc: 0.093 Test Loss: 3.174 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.2485174
	speed: 0.1527s/iter; left time: 1819.4699s
Epoch: 23 cost time: 6.412399053573608
Epoch: 23, Steps: 154 | Train Loss: 1.316 Vali Loss: 3.502 Vali Acc: 0.065 Test Loss: 3.502 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.5363567
	speed: 0.1444s/iter; left time: 1697.7868s
Epoch: 24 cost time: 6.641673803329468
Epoch: 24, Steps: 154 | Train Loss: 1.278 Vali Loss: 3.389 Vali Acc: 0.068 Test Loss: 3.389 Test Acc: 0.068
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.2459861
	speed: 0.1468s/iter; left time: 1703.7632s
Epoch: 25 cost time: 6.179134130477905
Epoch: 25, Steps: 154 | Train Loss: 1.253 Vali Loss: 3.592 Vali Acc: 0.067 Test Loss: 3.592 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3759124087591241
model parameter : 85470
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6335615
	speed: 0.0536s/iter; left time: 819.9217s
Epoch: 1 cost time: 7.397673606872559
Epoch: 1, Steps: 154 | Train Loss: 2.272 Vali Loss: 2.155 Vali Acc: 0.316 Test Loss: 2.155 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4475155
	speed: 0.1387s/iter; left time: 2100.1688s
Epoch: 2 cost time: 6.040616273880005
Epoch: 2, Steps: 154 | Train Loss: 2.051 Vali Loss: 2.133 Vali Acc: 0.322 Test Loss: 2.133 Test Acc: 0.322
Validation loss decreased (-0.316280 --> -0.322363).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0072587
	speed: 0.1468s/iter; left time: 2200.5618s
Epoch: 3 cost time: 6.201093435287476
Epoch: 3, Steps: 154 | Train Loss: 1.992 Vali Loss: 2.154 Vali Acc: 0.321 Test Loss: 2.154 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7983344
	speed: 0.1430s/iter; left time: 2122.3093s
Epoch: 4 cost time: 6.720029354095459
Epoch: 4, Steps: 154 | Train Loss: 1.956 Vali Loss: 2.151 Vali Acc: 0.324 Test Loss: 2.151 Test Acc: 0.324
Validation loss decreased (-0.322363 --> -0.323579).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8753619
	speed: 0.1445s/iter; left time: 2121.8273s
Epoch: 5 cost time: 6.269694566726685
Epoch: 5, Steps: 154 | Train Loss: 1.882 Vali Loss: 2.167 Vali Acc: 0.325 Test Loss: 2.167 Test Acc: 0.325
Validation loss decreased (-0.323579 --> -0.325201).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9476041
	speed: 0.1489s/iter; left time: 2164.2545s
Epoch: 6 cost time: 6.293138027191162
Epoch: 6, Steps: 154 | Train Loss: 1.825 Vali Loss: 2.184 Vali Acc: 0.332 Test Loss: 2.184 Test Acc: 0.332
Validation loss decreased (-0.325201 --> -0.332095).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9686716
	speed: 0.1456s/iter; left time: 2093.1534s
Epoch: 7 cost time: 6.263516187667847
Epoch: 7, Steps: 154 | Train Loss: 1.794 Vali Loss: 2.189 Vali Acc: 0.341 Test Loss: 2.189 Test Acc: 0.341
Validation loss decreased (-0.332095 --> -0.341422).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3409882
	speed: 0.1384s/iter; left time: 1968.1895s
Epoch: 8 cost time: 5.795832395553589
Epoch: 8, Steps: 154 | Train Loss: 1.685 Vali Loss: 2.254 Vali Acc: 0.347 Test Loss: 2.254 Test Acc: 0.347
Validation loss decreased (-0.341422 --> -0.346693).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9202360
	speed: 0.1416s/iter; left time: 1992.7669s
Epoch: 9 cost time: 6.131032228469849
Epoch: 9, Steps: 154 | Train Loss: 1.666 Vali Loss: 2.255 Vali Acc: 0.356 Test Loss: 2.255 Test Acc: 0.356
Validation loss decreased (-0.346693 --> -0.355614).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4538753
	speed: 0.1405s/iter; left time: 1954.6616s
Epoch: 10 cost time: 6.4619057178497314
Epoch: 10, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.281 Vali Acc: 0.366 Test Loss: 2.281 Test Acc: 0.366
Validation loss decreased (-0.355614 --> -0.365752).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5699641
	speed: 0.1448s/iter; left time: 1992.5111s
Epoch: 11 cost time: 6.03953742980957
Epoch: 11, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.328 Vali Acc: 0.356 Test Loss: 2.328 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2630235
	speed: 0.1472s/iter; left time: 2003.3498s
Epoch: 12 cost time: 6.1401166915893555
Epoch: 12, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.351 Vali Acc: 0.368 Test Loss: 2.351 Test Acc: 0.368
Validation loss decreased (-0.365752 --> -0.368184).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5095744
	speed: 0.1441s/iter; left time: 1938.8736s
Epoch: 13 cost time: 6.210164546966553
Epoch: 13, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.412 Vali Acc: 0.368 Test Loss: 2.412 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4883327
	speed: 0.1375s/iter; left time: 1829.0703s
Epoch: 14 cost time: 6.1407976150512695
Epoch: 14, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.387 Vali Acc: 0.383 Test Loss: 2.387 Test Acc: 0.383
Validation loss decreased (-0.368184 --> -0.383188).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.3049755
	speed: 0.1486s/iter; left time: 1953.8043s
Epoch: 15 cost time: 5.850285053253174
Epoch: 15, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.596 Vali Acc: 0.384 Test Loss: 2.596 Test Acc: 0.384
Validation loss decreased (-0.383188 --> -0.384402).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.9782069
	speed: 0.1423s/iter; left time: 1848.7155s
Epoch: 16 cost time: 6.367138862609863
Epoch: 16, Steps: 154 | Train Loss: 1.383 Vali Loss: 2.666 Vali Acc: 0.354 Test Loss: 2.666 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.1403044
	speed: 0.1391s/iter; left time: 1785.0869s
Epoch: 17 cost time: 6.6224024295806885
Epoch: 17, Steps: 154 | Train Loss: 1.374 Vali Loss: 2.824 Vali Acc: 0.217 Test Loss: 2.824 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.1958145
	speed: 0.1507s/iter; left time: 1911.8998s
Epoch: 18 cost time: 6.478465557098389
Epoch: 18, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.724 Vali Acc: 0.211 Test Loss: 2.724 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.5288825
	speed: 0.1556s/iter; left time: 1949.8416s
Epoch: 19 cost time: 7.143746614456177
Epoch: 19, Steps: 154 | Train Loss: 1.315 Vali Loss: 3.039 Vali Acc: 0.075 Test Loss: 3.039 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.2134825
	speed: 0.1599s/iter; left time: 1979.3323s
Epoch: 20 cost time: 7.246074438095093
Epoch: 20, Steps: 154 | Train Loss: 1.301 Vali Loss: 2.738 Vali Acc: 0.335 Test Loss: 2.738 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.6124191
	speed: 0.1555s/iter; left time: 1899.7598s
Epoch: 21 cost time: 6.780827045440674
Epoch: 21, Steps: 154 | Train Loss: 1.273 Vali Loss: 2.917 Vali Acc: 0.208 Test Loss: 2.917 Test Acc: 0.208
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.7440416
	speed: 0.1528s/iter; left time: 1843.3866s
Epoch: 22 cost time: 6.405710458755493
Epoch: 22, Steps: 154 | Train Loss: 1.249 Vali Loss: 3.080 Vali Acc: 0.202 Test Loss: 3.080 Test Acc: 0.202
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.9987406
	speed: 0.1505s/iter; left time: 1792.9338s
Epoch: 23 cost time: 6.383276700973511
Epoch: 23, Steps: 154 | Train Loss: 1.225 Vali Loss: 3.178 Vali Acc: 0.181 Test Loss: 3.178 Test Acc: 0.181
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.3027284
	speed: 0.1474s/iter; left time: 1733.4095s
Epoch: 24 cost time: 6.19927191734314
Epoch: 24, Steps: 154 | Train Loss: 1.263 Vali Loss: 3.502 Vali Acc: 0.074 Test Loss: 3.502 Test Acc: 0.074
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.1669506
	speed: 0.1461s/iter; left time: 1695.4190s
Epoch: 25 cost time: 6.298366069793701
Epoch: 25, Steps: 154 | Train Loss: 1.245 Vali Loss: 3.665 Vali Acc: 0.077 Test Loss: 3.665 Test Acc: 0.077
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3844282238442822
model parameter : 85470
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6300037
	speed: 0.0559s/iter; left time: 854.7089s
Epoch: 1 cost time: 7.5795369148254395
Epoch: 1, Steps: 154 | Train Loss: 2.259 Vali Loss: 2.150 Vali Acc: 0.316 Test Loss: 2.150 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5544744
	speed: 0.1345s/iter; left time: 2036.5843s
Epoch: 2 cost time: 5.556402206420898
Epoch: 2, Steps: 154 | Train Loss: 2.054 Vali Loss: 2.134 Vali Acc: 0.322 Test Loss: 2.134 Test Acc: 0.322
Validation loss decreased (-0.315875 --> -0.321552).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0176687
	speed: 0.1337s/iter; left time: 2003.9260s
Epoch: 3 cost time: 6.265329360961914
Epoch: 3, Steps: 154 | Train Loss: 2.001 Vali Loss: 2.158 Vali Acc: 0.322 Test Loss: 2.158 Test Acc: 0.322
Validation loss decreased (-0.321552 --> -0.322363).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8442848
	speed: 0.1540s/iter; left time: 2284.6634s
Epoch: 4 cost time: 7.43955397605896
Epoch: 4, Steps: 154 | Train Loss: 1.949 Vali Loss: 2.170 Vali Acc: 0.324 Test Loss: 2.170 Test Acc: 0.324
Validation loss decreased (-0.322363 --> -0.323985).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8643444
	speed: 0.1507s/iter; left time: 2212.4066s
Epoch: 5 cost time: 6.565932035446167
Epoch: 5, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.205 Vali Acc: 0.326 Test Loss: 2.205 Test Acc: 0.326
Validation loss decreased (-0.323985 --> -0.325607).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8918252
	speed: 0.1437s/iter; left time: 2088.2552s
Epoch: 6 cost time: 5.7961695194244385
Epoch: 6, Steps: 154 | Train Loss: 1.796 Vali Loss: 2.284 Vali Acc: 0.334 Test Loss: 2.284 Test Acc: 0.334
Validation loss decreased (-0.325607 --> -0.334122).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8503575
	speed: 0.1435s/iter; left time: 2063.1459s
Epoch: 7 cost time: 6.122972011566162
Epoch: 7, Steps: 154 | Train Loss: 1.750 Vali Loss: 2.299 Vali Acc: 0.348 Test Loss: 2.299 Test Acc: 0.348
Validation loss decreased (-0.334122 --> -0.348314).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2465553
	speed: 0.1396s/iter; left time: 1985.1168s
Epoch: 8 cost time: 6.325405597686768
Epoch: 8, Steps: 154 | Train Loss: 1.670 Vali Loss: 2.323 Vali Acc: 0.352 Test Loss: 2.323 Test Acc: 0.352
Validation loss decreased (-0.348314 --> -0.352369).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8946259
	speed: 0.1401s/iter; left time: 1971.4257s
Epoch: 9 cost time: 5.8420634269714355
Epoch: 9, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.389 Vali Acc: 0.358 Test Loss: 2.389 Test Acc: 0.358
Validation loss decreased (-0.352369 --> -0.357640).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4480796
	speed: 0.1402s/iter; left time: 1950.7706s
Epoch: 10 cost time: 5.936063051223755
Epoch: 10, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.317 Vali Acc: 0.365 Test Loss: 2.317 Test Acc: 0.365
Validation loss decreased (-0.357640 --> -0.364535).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4248908
	speed: 0.1384s/iter; left time: 1904.5488s
Epoch: 11 cost time: 6.0960693359375
Epoch: 11, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.407 Vali Acc: 0.356 Test Loss: 2.407 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2414989
	speed: 0.1387s/iter; left time: 1886.7827s
Epoch: 12 cost time: 5.849309206008911
Epoch: 12, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.375 Vali Acc: 0.369 Test Loss: 2.375 Test Acc: 0.369
Validation loss decreased (-0.364535 --> -0.368995).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4556775
	speed: 0.1433s/iter; left time: 1927.9711s
Epoch: 13 cost time: 6.794391393661499
Epoch: 13, Steps: 154 | Train Loss: 1.448 Vali Loss: 2.560 Vali Acc: 0.371 Test Loss: 2.560 Test Acc: 0.371
Validation loss decreased (-0.368995 --> -0.371426).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6333157
	speed: 0.1544s/iter; left time: 2052.7109s
Epoch: 14 cost time: 7.024612188339233
Epoch: 14, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.381 Vali Acc: 0.387 Test Loss: 2.381 Test Acc: 0.387
Validation loss decreased (-0.371426 --> -0.386838).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.6928693
	speed: 0.1532s/iter; left time: 2013.3979s
Epoch: 15 cost time: 6.608829498291016
Epoch: 15, Steps: 154 | Train Loss: 1.379 Vali Loss: 2.462 Vali Acc: 0.366 Test Loss: 2.462 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.2392628
	speed: 0.1530s/iter; left time: 1987.1879s
Epoch: 16 cost time: 6.460846424102783
Epoch: 16, Steps: 154 | Train Loss: 1.334 Vali Loss: 2.569 Vali Acc: 0.367 Test Loss: 2.569 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.1011589
	speed: 0.1480s/iter; left time: 1899.9758s
Epoch: 17 cost time: 6.170661926269531
Epoch: 17, Steps: 154 | Train Loss: 1.325 Vali Loss: 2.450 Vali Acc: 0.286 Test Loss: 2.450 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.1747930
	speed: 0.1433s/iter; left time: 1817.4611s
Epoch: 18 cost time: 6.1078503131866455
Epoch: 18, Steps: 154 | Train Loss: 1.280 Vali Loss: 2.531 Vali Acc: 0.231 Test Loss: 2.531 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.5860082
	speed: 0.1432s/iter; left time: 1794.6830s
Epoch: 19 cost time: 6.1551408767700195
Epoch: 19, Steps: 154 | Train Loss: 1.273 Vali Loss: 2.682 Vali Acc: 0.330 Test Loss: 2.682 Test Acc: 0.330
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.1500490
	speed: 0.1441s/iter; left time: 1782.7363s
Epoch: 20 cost time: 6.233136415481567
Epoch: 20, Steps: 154 | Train Loss: 1.246 Vali Loss: 2.541 Vali Acc: 0.387 Test Loss: 2.541 Test Acc: 0.387
Validation loss decreased (-0.386838 --> -0.387241).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.7047446
	speed: 0.1460s/iter; left time: 1784.8019s
Epoch: 21 cost time: 6.603228330612183
Epoch: 21, Steps: 154 | Train Loss: 1.204 Vali Loss: 2.544 Vali Acc: 0.390 Test Loss: 2.544 Test Acc: 0.390
Validation loss decreased (-0.387241 --> -0.390080).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.7015573
	speed: 0.1475s/iter; left time: 1779.4156s
Epoch: 22 cost time: 6.280615568161011
Epoch: 22, Steps: 154 | Train Loss: 1.202 Vali Loss: 2.732 Vali Acc: 0.223 Test Loss: 2.732 Test Acc: 0.223
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.0086309
	speed: 0.1495s/iter; left time: 1780.5984s
Epoch: 23 cost time: 6.4746246337890625
Epoch: 23, Steps: 154 | Train Loss: 1.194 Vali Loss: 2.914 Vali Acc: 0.213 Test Loss: 2.914 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.1231818
	speed: 0.1503s/iter; left time: 1767.6592s
Epoch: 24 cost time: 6.54616117477417
Epoch: 24, Steps: 154 | Train Loss: 1.202 Vali Loss: 2.748 Vali Acc: 0.212 Test Loss: 2.748 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.0741911
	speed: 0.1332s/iter; left time: 1546.1561s
Epoch: 25 cost time: 6.219128847122192
Epoch: 25, Steps: 154 | Train Loss: 1.161 Vali Loss: 2.990 Vali Acc: 0.190 Test Loss: 2.990 Test Acc: 0.190
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.2924738
	speed: 0.1499s/iter; left time: 1715.9951s
Epoch: 26 cost time: 6.384335517883301
Epoch: 26, Steps: 154 | Train Loss: 1.218 Vali Loss: 2.850 Vali Acc: 0.232 Test Loss: 2.850 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.2815937
	speed: 0.1509s/iter; left time: 1704.2607s
Epoch: 27 cost time: 6.820692300796509
Epoch: 27, Steps: 154 | Train Loss: 1.135 Vali Loss: 2.676 Vali Acc: 0.383 Test Loss: 2.676 Test Acc: 0.383
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.2110062
	speed: 0.1475s/iter; left time: 1643.1993s
Epoch: 28 cost time: 6.280597686767578
Epoch: 28, Steps: 154 | Train Loss: 1.135 Vali Loss: 2.613 Vali Acc: 0.315 Test Loss: 2.613 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 1.4050769
	speed: 0.1383s/iter; left time: 1519.9927s
Epoch: 29 cost time: 6.2128753662109375
Epoch: 29, Steps: 154 | Train Loss: 1.072 Vali Loss: 3.261 Vali Acc: 0.153 Test Loss: 3.261 Test Acc: 0.153
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.4080974
	speed: 0.1444s/iter; left time: 1564.4501s
Epoch: 30 cost time: 6.44281792640686
Epoch: 30, Steps: 154 | Train Loss: 1.047 Vali Loss: 2.845 Vali Acc: 0.212 Test Loss: 2.845 Test Acc: 0.212
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 1.3092254
	speed: 0.1412s/iter; left time: 1507.6767s
Epoch: 31 cost time: 6.377054929733276
Epoch: 31, Steps: 154 | Train Loss: 1.116 Vali Loss: 2.866 Vali Acc: 0.210 Test Loss: 2.866 Test Acc: 0.210
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39010543390105434
model parameter : 85470
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6127999
	speed: 0.0573s/iter; left time: 877.0997s
Epoch: 1 cost time: 7.882413387298584
Epoch: 1, Steps: 154 | Train Loss: 2.237 Vali Loss: 2.152 Vali Acc: 0.318 Test Loss: 2.152 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3561256
	speed: 0.1389s/iter; left time: 2104.2288s
Epoch: 2 cost time: 5.902009725570679
Epoch: 2, Steps: 154 | Train Loss: 2.042 Vali Loss: 2.135 Vali Acc: 0.322 Test Loss: 2.135 Test Acc: 0.322
Validation loss decreased (-0.317497 --> -0.321552).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0310528
	speed: 0.1392s/iter; left time: 2086.7367s
Epoch: 3 cost time: 5.790516376495361
Epoch: 3, Steps: 154 | Train Loss: 1.974 Vali Loss: 2.234 Vali Acc: 0.323 Test Loss: 2.234 Test Acc: 0.323
Validation loss decreased (-0.321552 --> -0.322768).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7962095
	speed: 0.1304s/iter; left time: 1935.0756s
Epoch: 4 cost time: 5.715194225311279
Epoch: 4, Steps: 154 | Train Loss: 1.917 Vali Loss: 2.338 Vali Acc: 0.323 Test Loss: 2.338 Test Acc: 0.323
Validation loss decreased (-0.322768 --> -0.323172).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7522385
	speed: 0.1379s/iter; left time: 2025.2912s
Epoch: 5 cost time: 5.939395904541016
Epoch: 5, Steps: 154 | Train Loss: 1.829 Vali Loss: 2.502 Vali Acc: 0.331 Test Loss: 2.502 Test Acc: 0.331
Validation loss decreased (-0.323172 --> -0.331281).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8646183
	speed: 0.1476s/iter; left time: 2144.1086s
Epoch: 6 cost time: 7.00575852394104
Epoch: 6, Steps: 154 | Train Loss: 1.752 Vali Loss: 2.952 Vali Acc: 0.333 Test Loss: 2.952 Test Acc: 0.333
Validation loss decreased (-0.331281 --> -0.332493).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6462071
	speed: 0.1453s/iter; left time: 2089.6584s
Epoch: 7 cost time: 6.427889585494995
Epoch: 7, Steps: 154 | Train Loss: 1.653 Vali Loss: 2.605 Vali Acc: 0.344 Test Loss: 2.605 Test Acc: 0.344
Validation loss decreased (-0.332493 --> -0.344256).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2483703
	speed: 0.1485s/iter; left time: 2112.6959s
Epoch: 8 cost time: 6.163184404373169
Epoch: 8, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.494 Vali Acc: 0.350 Test Loss: 2.494 Test Acc: 0.350
Validation loss decreased (-0.344256 --> -0.349529).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9508181
	speed: 0.1460s/iter; left time: 2053.6186s
Epoch: 9 cost time: 6.399565696716309
Epoch: 9, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.356 Vali Acc: 0.358 Test Loss: 2.356 Test Acc: 0.358
Validation loss decreased (-0.349529 --> -0.357641).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4127018
	speed: 0.1433s/iter; left time: 1994.1356s
Epoch: 10 cost time: 6.00409722328186
Epoch: 10, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.386 Vali Acc: 0.371 Test Loss: 2.386 Test Acc: 0.371
Validation loss decreased (-0.357641 --> -0.370617).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2556646
	speed: 0.1405s/iter; left time: 1933.2602s
Epoch: 11 cost time: 5.861195802688599
Epoch: 11, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.427 Vali Acc: 0.353 Test Loss: 2.427 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2436818
	speed: 0.1379s/iter; left time: 1876.9187s
Epoch: 12 cost time: 6.148966312408447
Epoch: 12, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.536 Vali Acc: 0.361 Test Loss: 2.536 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.4252993
	speed: 0.1437s/iter; left time: 1932.5496s
Epoch: 13 cost time: 6.236100673675537
Epoch: 13, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.769 Vali Acc: 0.364 Test Loss: 2.769 Test Acc: 0.364
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4333698
	speed: 0.1521s/iter; left time: 2022.3329s
Epoch: 14 cost time: 6.7432262897491455
Epoch: 14, Steps: 154 | Train Loss: 1.370 Vali Loss: 2.398 Vali Acc: 0.388 Test Loss: 2.398 Test Acc: 0.388
Validation loss decreased (-0.370617 --> -0.387648).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4874377
	speed: 0.1462s/iter; left time: 1922.1016s
Epoch: 15 cost time: 6.767320871353149
Epoch: 15, Steps: 154 | Train Loss: 1.314 Vali Loss: 2.323 Vali Acc: 0.371 Test Loss: 2.323 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0957519
	speed: 0.1459s/iter; left time: 1895.0784s
Epoch: 16 cost time: 6.477023363113403
Epoch: 16, Steps: 154 | Train Loss: 1.271 Vali Loss: 2.530 Vali Acc: 0.370 Test Loss: 2.530 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.1275548
	speed: 0.1458s/iter; left time: 1872.2253s
Epoch: 17 cost time: 6.165142297744751
Epoch: 17, Steps: 154 | Train Loss: 1.251 Vali Loss: 2.313 Vali Acc: 0.385 Test Loss: 2.313 Test Acc: 0.385
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.0552185
	speed: 0.1343s/iter; left time: 1703.6016s
Epoch: 18 cost time: 6.334243297576904
Epoch: 18, Steps: 154 | Train Loss: 1.235 Vali Loss: 2.423 Vali Acc: 0.380 Test Loss: 2.423 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.3900464
	speed: 0.1437s/iter; left time: 1800.3722s
Epoch: 19 cost time: 6.1789186000823975
Epoch: 19, Steps: 154 | Train Loss: 1.228 Vali Loss: 2.534 Vali Acc: 0.330 Test Loss: 2.534 Test Acc: 0.330
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.8887318
	speed: 0.1471s/iter; left time: 1820.7424s
Epoch: 20 cost time: 6.356161117553711
Epoch: 20, Steps: 154 | Train Loss: 1.185 Vali Loss: 2.463 Vali Acc: 0.377 Test Loss: 2.463 Test Acc: 0.377
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.6981508
	speed: 0.1441s/iter; left time: 1760.7019s
Epoch: 21 cost time: 6.243926048278809
Epoch: 21, Steps: 154 | Train Loss: 1.183 Vali Loss: 2.498 Vali Acc: 0.382 Test Loss: 2.498 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.6648704
	speed: 0.1438s/iter; left time: 1735.7842s
Epoch: 22 cost time: 6.279932260513306
Epoch: 22, Steps: 154 | Train Loss: 1.119 Vali Loss: 2.514 Vali Acc: 0.386 Test Loss: 2.514 Test Acc: 0.386
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.9021923
	speed: 0.1501s/iter; left time: 1788.2930s
Epoch: 23 cost time: 6.882260322570801
Epoch: 23, Steps: 154 | Train Loss: 1.102 Vali Loss: 2.496 Vali Acc: 0.299 Test Loss: 2.496 Test Acc: 0.299
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.2597873
	speed: 0.1507s/iter; left time: 1772.2516s
Epoch: 24 cost time: 6.632596969604492
Epoch: 24, Steps: 154 | Train Loss: 1.132 Vali Loss: 2.563 Vali Acc: 0.396 Test Loss: 2.563 Test Acc: 0.396
Validation loss decreased (-0.387648 --> -0.396163).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.8882148
	speed: 0.1532s/iter; left time: 1777.6518s
Epoch: 25 cost time: 6.602431297302246
Epoch: 25, Steps: 154 | Train Loss: 1.086 Vali Loss: 2.606 Vali Acc: 0.234 Test Loss: 2.606 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.2071426
	speed: 0.1547s/iter; left time: 1771.6322s
Epoch: 26 cost time: 6.741936445236206
Epoch: 26, Steps: 154 | Train Loss: 1.061 Vali Loss: 2.568 Vali Acc: 0.259 Test Loss: 2.568 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.2896881
	speed: 0.1444s/iter; left time: 1631.6335s
Epoch: 27 cost time: 6.248970031738281
Epoch: 27, Steps: 154 | Train Loss: 1.021 Vali Loss: 2.533 Vali Acc: 0.381 Test Loss: 2.533 Test Acc: 0.381
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.3365078
	speed: 0.1403s/iter; left time: 1563.9057s
Epoch: 28 cost time: 6.0680718421936035
Epoch: 28, Steps: 154 | Train Loss: 1.035 Vali Loss: 2.509 Vali Acc: 0.399 Test Loss: 2.509 Test Acc: 0.399
Validation loss decreased (-0.396163 --> -0.399002).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.5324932
	speed: 0.1424s/iter; left time: 1565.2558s
Epoch: 29 cost time: 6.112437725067139
Epoch: 29, Steps: 154 | Train Loss: 0.986 Vali Loss: 2.844 Vali Acc: 0.337 Test Loss: 2.844 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.3072269
	speed: 0.1451s/iter; left time: 1572.1629s
Epoch: 30 cost time: 6.2799060344696045
Epoch: 30, Steps: 154 | Train Loss: 1.032 Vali Loss: 2.737 Vali Acc: 0.159 Test Loss: 2.737 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.6892182
	speed: 0.1454s/iter; left time: 1553.1825s
Epoch: 31 cost time: 6.232898712158203
Epoch: 31, Steps: 154 | Train Loss: 0.979 Vali Loss: 2.629 Vali Acc: 0.359 Test Loss: 2.629 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.7121878
	speed: 0.1459s/iter; left time: 1536.0027s
Epoch: 32 cost time: 6.356794118881226
Epoch: 32, Steps: 154 | Train Loss: 0.956 Vali Loss: 2.820 Vali Acc: 0.365 Test Loss: 2.820 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 1.3328955
	speed: 0.1491s/iter; left time: 1546.6842s
Epoch: 33 cost time: 6.704358816146851
Epoch: 33, Steps: 154 | Train Loss: 0.995 Vali Loss: 2.933 Vali Acc: 0.374 Test Loss: 2.933 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.8498918
	speed: 0.1547s/iter; left time: 1581.3094s
Epoch: 34 cost time: 6.361692428588867
Epoch: 34, Steps: 154 | Train Loss: 0.955 Vali Loss: 2.738 Vali Acc: 0.247 Test Loss: 2.738 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 1.0061156
	speed: 0.1476s/iter; left time: 1485.2911s
Epoch: 35 cost time: 6.361800670623779
Epoch: 35, Steps: 154 | Train Loss: 0.918 Vali Loss: 3.218 Vali Acc: 0.099 Test Loss: 3.218 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.9125586
	speed: 0.1406s/iter; left time: 1392.9985s
Epoch: 36 cost time: 6.1457929611206055
Epoch: 36, Steps: 154 | Train Loss: 0.951 Vali Loss: 3.493 Vali Acc: 0.111 Test Loss: 3.493 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 1.2037529
	speed: 0.1368s/iter; left time: 1334.5789s
Epoch: 37 cost time: 5.922724723815918
Epoch: 37, Steps: 154 | Train Loss: 1.002 Vali Loss: 3.583 Vali Acc: 0.097 Test Loss: 3.583 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.7315427
	speed: 0.1395s/iter; left time: 1339.8592s
Epoch: 38 cost time: 6.138317108154297
Epoch: 38, Steps: 154 | Train Loss: 0.891 Vali Loss: 3.233 Vali Acc: 0.118 Test Loss: 3.233 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39902676399026765
model parameter : 85470
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9053968
	speed: 0.0570s/iter; left time: 871.5260s
Epoch: 1 cost time: 7.760271310806274
Epoch: 1, Steps: 154 | Train Loss: 2.274 Vali Loss: 2.169 Vali Acc: 0.318 Test Loss: 2.169 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8726331
	speed: 0.1426s/iter; left time: 2160.2575s
Epoch: 2 cost time: 6.0395591259002686
Epoch: 2, Steps: 154 | Train Loss: 2.057 Vali Loss: 2.142 Vali Acc: 0.320 Test Loss: 2.142 Test Acc: 0.320
Validation loss decreased (-0.318308 --> -0.320335).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4606442
	speed: 0.1435s/iter; left time: 2152.2127s
Epoch: 3 cost time: 6.2573158740997314
Epoch: 3, Steps: 154 | Train Loss: 2.008 Vali Loss: 2.127 Vali Acc: 0.328 Test Loss: 2.127 Test Acc: 0.328
Validation loss decreased (-0.320335 --> -0.328040).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1297281
	speed: 0.1413s/iter; left time: 2096.8833s
Epoch: 4 cost time: 6.275639772415161
Epoch: 4, Steps: 154 | Train Loss: 1.950 Vali Loss: 2.175 Vali Acc: 0.328 Test Loss: 2.175 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8091052
	speed: 0.1436s/iter; left time: 2109.3327s
Epoch: 5 cost time: 6.374818801879883
Epoch: 5, Steps: 154 | Train Loss: 1.890 Vali Loss: 2.145 Vali Acc: 0.329 Test Loss: 2.145 Test Acc: 0.329
Validation loss decreased (-0.328040 --> -0.329257).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8865225
	speed: 0.1485s/iter; left time: 2157.4352s
Epoch: 6 cost time: 6.5789854526519775
Epoch: 6, Steps: 154 | Train Loss: 1.845 Vali Loss: 2.165 Vali Acc: 0.330 Test Loss: 2.165 Test Acc: 0.330
Validation loss decreased (-0.329257 --> -0.330068).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5235798
	speed: 0.1476s/iter; left time: 2122.0205s
Epoch: 7 cost time: 6.664166212081909
Epoch: 7, Steps: 154 | Train Loss: 1.792 Vali Loss: 2.206 Vali Acc: 0.337 Test Loss: 2.206 Test Acc: 0.337
Validation loss decreased (-0.330068 --> -0.336555).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8751831
	speed: 0.1432s/iter; left time: 2036.5799s
Epoch: 8 cost time: 6.38197135925293
Epoch: 8, Steps: 154 | Train Loss: 1.721 Vali Loss: 2.162 Vali Acc: 0.347 Test Loss: 2.162 Test Acc: 0.347
Validation loss decreased (-0.336555 --> -0.347099).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6949568
	speed: 0.1596s/iter; left time: 2245.2320s
Epoch: 9 cost time: 7.075172424316406
Epoch: 9, Steps: 154 | Train Loss: 1.668 Vali Loss: 2.271 Vali Acc: 0.351 Test Loss: 2.271 Test Acc: 0.351
Validation loss decreased (-0.347099 --> -0.351153).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6467632
	speed: 0.1619s/iter; left time: 2253.1001s
Epoch: 10 cost time: 7.228613615036011
Epoch: 10, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.256 Vali Acc: 0.354 Test Loss: 2.256 Test Acc: 0.354
Validation loss decreased (-0.351153 --> -0.354398).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7733623
	speed: 0.1590s/iter; left time: 2188.3856s
Epoch: 11 cost time: 6.640106916427612
Epoch: 11, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.278 Vali Acc: 0.357 Test Loss: 2.278 Test Acc: 0.357
Validation loss decreased (-0.354398 --> -0.356830).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7878857
	speed: 0.1536s/iter; left time: 2089.4241s
Epoch: 12 cost time: 6.522302627563477
Epoch: 12, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.473 Vali Acc: 0.363 Test Loss: 2.473 Test Acc: 0.363
Validation loss decreased (-0.356830 --> -0.362506).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2883646
	speed: 0.1442s/iter; left time: 1939.7978s
Epoch: 13 cost time: 6.36462140083313
Epoch: 13, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.442 Vali Acc: 0.363 Test Loss: 2.442 Test Acc: 0.363
Validation loss decreased (-0.362506 --> -0.362506).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.7318125
	speed: 0.1464s/iter; left time: 1947.0962s
Epoch: 14 cost time: 6.310205936431885
Epoch: 14, Steps: 154 | Train Loss: 1.498 Vali Loss: 2.673 Vali Acc: 0.361 Test Loss: 2.673 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.3583071
	speed: 0.1483s/iter; left time: 1948.9309s
Epoch: 15 cost time: 6.510273218154907
Epoch: 15, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.530 Vali Acc: 0.358 Test Loss: 2.530 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.8705500
	speed: 0.1519s/iter; left time: 1973.2658s
Epoch: 16 cost time: 7.180883884429932
Epoch: 16, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.685 Vali Acc: 0.370 Test Loss: 2.685 Test Acc: 0.370
Validation loss decreased (-0.362506 --> -0.369803).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.6028066
	speed: 0.1517s/iter; left time: 1947.7666s
Epoch: 17 cost time: 6.5660765171051025
Epoch: 17, Steps: 154 | Train Loss: 1.424 Vali Loss: 2.550 Vali Acc: 0.361 Test Loss: 2.550 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.6443821
	speed: 0.1512s/iter; left time: 1917.8915s
Epoch: 18 cost time: 6.642333269119263
Epoch: 18, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.738 Vali Acc: 0.367 Test Loss: 2.738 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.3985966
	speed: 0.1600s/iter; left time: 2004.1460s
Epoch: 19 cost time: 6.833013296127319
Epoch: 19, Steps: 154 | Train Loss: 1.363 Vali Loss: 2.664 Vali Acc: 0.375 Test Loss: 2.664 Test Acc: 0.375
Validation loss decreased (-0.369803 --> -0.374669).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.9173700
	speed: 0.1505s/iter; left time: 1861.9559s
Epoch: 20 cost time: 6.556423187255859
Epoch: 20, Steps: 154 | Train Loss: 1.351 Vali Loss: 2.811 Vali Acc: 0.139 Test Loss: 2.811 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.2409881
	speed: 0.1454s/iter; left time: 1777.4197s
Epoch: 21 cost time: 6.234827518463135
Epoch: 21, Steps: 154 | Train Loss: 1.312 Vali Loss: 2.731 Vali Acc: 0.311 Test Loss: 2.731 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.6605170
	speed: 0.1427s/iter; left time: 1721.5886s
Epoch: 22 cost time: 6.304534912109375
Epoch: 22, Steps: 154 | Train Loss: 1.316 Vali Loss: 2.766 Vali Acc: 0.247 Test Loss: 2.766 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.6011212
	speed: 0.1429s/iter; left time: 1702.2828s
Epoch: 23 cost time: 6.772793531417847
Epoch: 23, Steps: 154 | Train Loss: 1.260 Vali Loss: 3.338 Vali Acc: 0.076 Test Loss: 3.338 Test Acc: 0.076
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.3667200
	speed: 0.1497s/iter; left time: 1759.8582s
Epoch: 24 cost time: 6.41037917137146
Epoch: 24, Steps: 154 | Train Loss: 1.252 Vali Loss: 2.931 Vali Acc: 0.126 Test Loss: 2.931 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.9564959
	speed: 0.1526s/iter; left time: 1770.9770s
Epoch: 25 cost time: 6.571699619293213
Epoch: 25, Steps: 154 | Train Loss: 1.258 Vali Loss: 3.206 Vali Acc: 0.083 Test Loss: 3.206 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.3156230
	speed: 0.1525s/iter; left time: 1745.9571s
Epoch: 26 cost time: 6.708498477935791
Epoch: 26, Steps: 154 | Train Loss: 1.236 Vali Loss: 3.120 Vali Acc: 0.083 Test Loss: 3.120 Test Acc: 0.083
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.3405927
	speed: 0.1497s/iter; left time: 1690.7026s
Epoch: 27 cost time: 6.350398778915405
Epoch: 27, Steps: 154 | Train Loss: 1.237 Vali Loss: 2.900 Vali Acc: 0.152 Test Loss: 2.900 Test Acc: 0.152
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.2449244
	speed: 0.1459s/iter; left time: 1626.3205s
Epoch: 28 cost time: 6.107399940490723
Epoch: 28, Steps: 154 | Train Loss: 1.194 Vali Loss: 3.149 Vali Acc: 0.088 Test Loss: 3.149 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.8077835
	speed: 0.1487s/iter; left time: 1634.5584s
Epoch: 29 cost time: 6.907645225524902
Epoch: 29, Steps: 154 | Train Loss: 1.259 Vali Loss: 3.253 Vali Acc: 0.174 Test Loss: 3.253 Test Acc: 0.174
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3746958637469586
model parameter : 69086
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8789821
	speed: 0.0584s/iter; left time: 893.9877s
Epoch: 1 cost time: 8.183257102966309
Epoch: 1, Steps: 154 | Train Loss: 2.276 Vali Loss: 2.169 Vali Acc: 0.319 Test Loss: 2.169 Test Acc: 0.319
Validation loss decreased (inf --> -0.319119).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9249755
	speed: 0.1545s/iter; left time: 2340.9503s
Epoch: 2 cost time: 6.8239829540252686
Epoch: 2, Steps: 154 | Train Loss: 2.063 Vali Loss: 2.138 Vali Acc: 0.321 Test Loss: 2.138 Test Acc: 0.321
Validation loss decreased (-0.319119 --> -0.320741).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4600742
	speed: 0.1494s/iter; left time: 2240.3942s
Epoch: 3 cost time: 6.582556247711182
Epoch: 3, Steps: 154 | Train Loss: 2.004 Vali Loss: 2.129 Vali Acc: 0.329 Test Loss: 2.129 Test Acc: 0.329
Validation loss decreased (-0.320741 --> -0.328851).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0983453
	speed: 0.1456s/iter; left time: 2160.3740s
Epoch: 4 cost time: 6.228387832641602
Epoch: 4, Steps: 154 | Train Loss: 1.943 Vali Loss: 2.171 Vali Acc: 0.328 Test Loss: 2.171 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8038677
	speed: 0.1463s/iter; left time: 2147.9371s
Epoch: 5 cost time: 6.2229228019714355
Epoch: 5, Steps: 154 | Train Loss: 1.891 Vali Loss: 2.151 Vali Acc: 0.330 Test Loss: 2.151 Test Acc: 0.330
Validation loss decreased (-0.328851 --> -0.330473).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8646981
	speed: 0.1329s/iter; left time: 1930.5559s
Epoch: 6 cost time: 5.857784748077393
Epoch: 6, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.156 Vali Acc: 0.335 Test Loss: 2.156 Test Acc: 0.335
Validation loss decreased (-0.330473 --> -0.335339).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4657021
	speed: 0.1355s/iter; left time: 1947.5945s
Epoch: 7 cost time: 6.042584180831909
Epoch: 7, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.191 Vali Acc: 0.341 Test Loss: 2.191 Test Acc: 0.341
Validation loss decreased (-0.335339 --> -0.340611).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8843628
	speed: 0.1418s/iter; left time: 2016.5035s
Epoch: 8 cost time: 6.160807371139526
Epoch: 8, Steps: 154 | Train Loss: 1.712 Vali Loss: 2.219 Vali Acc: 0.355 Test Loss: 2.219 Test Acc: 0.355
Validation loss decreased (-0.340611 --> -0.354803).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5294397
	speed: 0.1432s/iter; left time: 2014.3959s
Epoch: 9 cost time: 6.23163366317749
Epoch: 9, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.264 Vali Acc: 0.352 Test Loss: 2.264 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6619407
	speed: 0.1537s/iter; left time: 2139.2310s
Epoch: 10 cost time: 6.518954277038574
Epoch: 10, Steps: 154 | Train Loss: 1.609 Vali Loss: 2.271 Vali Acc: 0.362 Test Loss: 2.271 Test Acc: 0.362
Validation loss decreased (-0.354803 --> -0.362102).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9819773
	speed: 0.1528s/iter; left time: 2102.0164s
Epoch: 11 cost time: 6.784895181655884
Epoch: 11, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.325 Vali Acc: 0.358 Test Loss: 2.325 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7292483
	speed: 0.1525s/iter; left time: 2074.7111s
Epoch: 12 cost time: 6.914743185043335
Epoch: 12, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.430 Vali Acc: 0.369 Test Loss: 2.430 Test Acc: 0.369
Validation loss decreased (-0.362102 --> -0.368994).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3099600
	speed: 0.1531s/iter; left time: 2059.8246s
Epoch: 13 cost time: 6.632521867752075
Epoch: 13, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.436 Vali Acc: 0.367 Test Loss: 2.436 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.6844233
	speed: 0.1448s/iter; left time: 1925.4717s
Epoch: 14 cost time: 6.2788872718811035
Epoch: 14, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.574 Vali Acc: 0.362 Test Loss: 2.574 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.4060740
	speed: 0.1407s/iter; left time: 1849.0697s
Epoch: 15 cost time: 6.283824443817139
Epoch: 15, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.521 Vali Acc: 0.363 Test Loss: 2.521 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.5372287
	speed: 0.1437s/iter; left time: 1866.9476s
Epoch: 16 cost time: 6.085045337677002
Epoch: 16, Steps: 154 | Train Loss: 1.397 Vali Loss: 2.662 Vali Acc: 0.356 Test Loss: 2.662 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.5282441
	speed: 0.1399s/iter; left time: 1795.4235s
Epoch: 17 cost time: 6.125145673751831
Epoch: 17, Steps: 154 | Train Loss: 1.381 Vali Loss: 2.577 Vali Acc: 0.371 Test Loss: 2.577 Test Acc: 0.371
Validation loss decreased (-0.368994 --> -0.371020).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6792054
	speed: 0.1338s/iter; left time: 1697.1272s
Epoch: 18 cost time: 6.185662269592285
Epoch: 18, Steps: 154 | Train Loss: 1.349 Vali Loss: 2.620 Vali Acc: 0.362 Test Loss: 2.620 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.4796734
	speed: 0.1440s/iter; left time: 1804.6543s
Epoch: 19 cost time: 6.602063894271851
Epoch: 19, Steps: 154 | Train Loss: 1.331 Vali Loss: 2.694 Vali Acc: 0.372 Test Loss: 2.694 Test Acc: 0.372
Validation loss decreased (-0.371020 --> -0.372236).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.9061047
	speed: 0.1531s/iter; left time: 1894.6993s
Epoch: 20 cost time: 6.552769422531128
Epoch: 20, Steps: 154 | Train Loss: 1.396 Vali Loss: 2.661 Vali Acc: 0.353 Test Loss: 2.661 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.0979738
	speed: 0.1519s/iter; left time: 1855.9672s
Epoch: 21 cost time: 7.066129207611084
Epoch: 21, Steps: 154 | Train Loss: 1.315 Vali Loss: 2.761 Vali Acc: 0.258 Test Loss: 2.761 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.3598554
	speed: 0.1537s/iter; left time: 1854.9797s
Epoch: 22 cost time: 6.481424331665039
Epoch: 22, Steps: 154 | Train Loss: 1.297 Vali Loss: 2.753 Vali Acc: 0.222 Test Loss: 2.753 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.6367633
	speed: 0.1429s/iter; left time: 1702.2581s
Epoch: 23 cost time: 5.978490591049194
Epoch: 23, Steps: 154 | Train Loss: 1.312 Vali Loss: 3.133 Vali Acc: 0.129 Test Loss: 3.133 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.2964513
	speed: 0.1427s/iter; left time: 1678.2589s
Epoch: 24 cost time: 6.271980285644531
Epoch: 24, Steps: 154 | Train Loss: 1.264 Vali Loss: 2.974 Vali Acc: 0.157 Test Loss: 2.974 Test Acc: 0.157
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.8489695
	speed: 0.1469s/iter; left time: 1704.7722s
Epoch: 25 cost time: 6.206737518310547
Epoch: 25, Steps: 154 | Train Loss: 1.205 Vali Loss: 3.224 Vali Acc: 0.120 Test Loss: 3.224 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.2427435
	speed: 0.1437s/iter; left time: 1645.3661s
Epoch: 26 cost time: 6.3592870235443115
Epoch: 26, Steps: 154 | Train Loss: 1.197 Vali Loss: 3.043 Vali Acc: 0.097 Test Loss: 3.043 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.2062391
	speed: 0.1458s/iter; left time: 1647.2328s
Epoch: 27 cost time: 6.582339286804199
Epoch: 27, Steps: 154 | Train Loss: 1.185 Vali Loss: 2.935 Vali Acc: 0.107 Test Loss: 2.935 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.1545168
	speed: 0.1479s/iter; left time: 1648.3580s
Epoch: 28 cost time: 6.3773815631866455
Epoch: 28, Steps: 154 | Train Loss: 1.199 Vali Loss: 3.088 Vali Acc: 0.100 Test Loss: 3.088 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.5374237
	speed: 0.1487s/iter; left time: 1634.2888s
Epoch: 29 cost time: 6.281459808349609
Epoch: 29, Steps: 154 | Train Loss: 1.143 Vali Loss: 3.223 Vali Acc: 0.156 Test Loss: 3.223 Test Acc: 0.156
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3722627737226277
model parameter : 69086
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8685762
	speed: 0.0561s/iter; left time: 857.6660s
Epoch: 1 cost time: 7.63423490524292
Epoch: 1, Steps: 154 | Train Loss: 2.266 Vali Loss: 2.163 Vali Acc: 0.319 Test Loss: 2.163 Test Acc: 0.319
Validation loss decreased (inf --> -0.318713).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9408793
	speed: 0.1459s/iter; left time: 2210.0675s
Epoch: 2 cost time: 6.242866277694702
Epoch: 2, Steps: 154 | Train Loss: 2.058 Vali Loss: 2.131 Vali Acc: 0.321 Test Loss: 2.131 Test Acc: 0.321
Validation loss decreased (-0.318713 --> -0.321147).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5341207
	speed: 0.1467s/iter; left time: 2198.8910s
Epoch: 3 cost time: 6.761711835861206
Epoch: 3, Steps: 154 | Train Loss: 1.995 Vali Loss: 2.116 Vali Acc: 0.329 Test Loss: 2.116 Test Acc: 0.329
Validation loss decreased (-0.321147 --> -0.328852).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0600958
	speed: 0.1433s/iter; left time: 2126.9582s
Epoch: 4 cost time: 6.24788236618042
Epoch: 4, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.182 Vali Acc: 0.327 Test Loss: 2.182 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6740546
	speed: 0.1422s/iter; left time: 2088.8456s
Epoch: 5 cost time: 6.062664270401001
Epoch: 5, Steps: 154 | Train Loss: 1.874 Vali Loss: 2.160 Vali Acc: 0.332 Test Loss: 2.160 Test Acc: 0.332
Validation loss decreased (-0.328852 --> -0.332095).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9426423
	speed: 0.1465s/iter; left time: 2129.2364s
Epoch: 6 cost time: 6.335676670074463
Epoch: 6, Steps: 154 | Train Loss: 1.814 Vali Loss: 2.208 Vali Acc: 0.339 Test Loss: 2.208 Test Acc: 0.339
Validation loss decreased (-0.332095 --> -0.338583).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5244498
	speed: 0.1411s/iter; left time: 2028.6373s
Epoch: 7 cost time: 6.186741352081299
Epoch: 7, Steps: 154 | Train Loss: 1.727 Vali Loss: 2.245 Vali Acc: 0.345 Test Loss: 2.245 Test Acc: 0.345
Validation loss decreased (-0.338583 --> -0.345071).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0643609
	speed: 0.1404s/iter; left time: 1997.5579s
Epoch: 8 cost time: 5.917179346084595
Epoch: 8, Steps: 154 | Train Loss: 1.681 Vali Loss: 2.288 Vali Acc: 0.353 Test Loss: 2.288 Test Acc: 0.353
Validation loss decreased (-0.345071 --> -0.352775).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4567618
	speed: 0.1315s/iter; left time: 1850.1987s
Epoch: 9 cost time: 5.7822489738464355
Epoch: 9, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.395 Vali Acc: 0.353 Test Loss: 2.395 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5607363
	speed: 0.1402s/iter; left time: 1950.8366s
Epoch: 10 cost time: 6.130256652832031
Epoch: 10, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.366 Vali Acc: 0.359 Test Loss: 2.366 Test Acc: 0.359
Validation loss decreased (-0.352775 --> -0.359263).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6993148
	speed: 0.1377s/iter; left time: 1894.2609s
Epoch: 11 cost time: 5.962401628494263
Epoch: 11, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.402 Vali Acc: 0.361 Test Loss: 2.402 Test Acc: 0.361
Validation loss decreased (-0.359263 --> -0.360884).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4384546
	speed: 0.1370s/iter; left time: 1864.1068s
Epoch: 12 cost time: 6.253633975982666
Epoch: 12, Steps: 154 | Train Loss: 1.489 Vali Loss: 2.532 Vali Acc: 0.366 Test Loss: 2.532 Test Acc: 0.366
Validation loss decreased (-0.360884 --> -0.366155).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2580590
	speed: 0.1513s/iter; left time: 2034.9821s
Epoch: 13 cost time: 6.897196054458618
Epoch: 13, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.571 Vali Acc: 0.363 Test Loss: 2.571 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.6144186
	speed: 0.1546s/iter; left time: 2056.4029s
Epoch: 14 cost time: 6.534820795059204
Epoch: 14, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.643 Vali Acc: 0.366 Test Loss: 2.643 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3501909
	speed: 0.1480s/iter; left time: 1945.8276s
Epoch: 15 cost time: 6.792566537857056
Epoch: 15, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.585 Vali Acc: 0.364 Test Loss: 2.585 Test Acc: 0.364
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.8300177
	speed: 0.1456s/iter; left time: 1892.1142s
Epoch: 16 cost time: 6.295864105224609
Epoch: 16, Steps: 154 | Train Loss: 1.363 Vali Loss: 2.655 Vali Acc: 0.339 Test Loss: 2.655 Test Acc: 0.339
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.3449856
	speed: 0.1473s/iter; left time: 1890.9137s
Epoch: 17 cost time: 6.122490882873535
Epoch: 17, Steps: 154 | Train Loss: 1.374 Vali Loss: 2.673 Vali Acc: 0.374 Test Loss: 2.673 Test Acc: 0.374
Validation loss decreased (-0.366155 --> -0.374264).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6068070
	speed: 0.1435s/iter; left time: 1820.2323s
Epoch: 18 cost time: 6.196251153945923
Epoch: 18, Steps: 154 | Train Loss: 1.309 Vali Loss: 2.739 Vali Acc: 0.342 Test Loss: 2.739 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.6162370
	speed: 0.1411s/iter; left time: 1768.2576s
Epoch: 19 cost time: 6.031744003295898
Epoch: 19, Steps: 154 | Train Loss: 1.282 Vali Loss: 2.589 Vali Acc: 0.380 Test Loss: 2.589 Test Acc: 0.380
Validation loss decreased (-0.374264 --> -0.379942).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.8819890
	speed: 0.1436s/iter; left time: 1776.9971s
Epoch: 20 cost time: 6.127566337585449
Epoch: 20, Steps: 154 | Train Loss: 1.266 Vali Loss: 2.684 Vali Acc: 0.341 Test Loss: 2.684 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 2.4601176
	speed: 0.1475s/iter; left time: 1803.1385s
Epoch: 21 cost time: 7.051887512207031
Epoch: 21, Steps: 154 | Train Loss: 1.257 Vali Loss: 2.690 Vali Acc: 0.221 Test Loss: 2.690 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.6411394
	speed: 0.1527s/iter; left time: 1843.1783s
Epoch: 22 cost time: 6.810630559921265
Epoch: 22, Steps: 154 | Train Loss: 1.197 Vali Loss: 2.821 Vali Acc: 0.219 Test Loss: 2.821 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.4825146
	speed: 0.1577s/iter; left time: 1878.2001s
Epoch: 23 cost time: 6.790362358093262
Epoch: 23, Steps: 154 | Train Loss: 1.189 Vali Loss: 3.279 Vali Acc: 0.099 Test Loss: 3.279 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.4022257
	speed: 0.1459s/iter; left time: 1715.8060s
Epoch: 24 cost time: 6.45875358581543
Epoch: 24, Steps: 154 | Train Loss: 1.171 Vali Loss: 2.926 Vali Acc: 0.245 Test Loss: 2.926 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.0179799
	speed: 0.1449s/iter; left time: 1681.1906s
Epoch: 25 cost time: 6.352846145629883
Epoch: 25, Steps: 154 | Train Loss: 1.214 Vali Loss: 3.113 Vali Acc: 0.089 Test Loss: 3.113 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.1441925
	speed: 0.1416s/iter; left time: 1621.3520s
Epoch: 26 cost time: 6.011282205581665
Epoch: 26, Steps: 154 | Train Loss: 1.181 Vali Loss: 2.910 Vali Acc: 0.172 Test Loss: 2.910 Test Acc: 0.172
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.9990182
	speed: 0.1438s/iter; left time: 1624.4234s
Epoch: 27 cost time: 6.263164758682251
Epoch: 27, Steps: 154 | Train Loss: 1.212 Vali Loss: 2.762 Vali Acc: 0.228 Test Loss: 2.762 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.2101818
	speed: 0.1419s/iter; left time: 1581.1312s
Epoch: 28 cost time: 6.081607103347778
Epoch: 28, Steps: 154 | Train Loss: 1.095 Vali Loss: 3.035 Vali Acc: 0.116 Test Loss: 3.035 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.5367988
	speed: 0.1430s/iter; left time: 1571.9109s
Epoch: 29 cost time: 6.095901012420654
Epoch: 29, Steps: 154 | Train Loss: 1.102 Vali Loss: 2.897 Vali Acc: 0.212 Test Loss: 2.897 Test Acc: 0.212
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 69086
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9259751
	speed: 0.0555s/iter; left time: 848.9821s
Epoch: 1 cost time: 7.751916885375977
Epoch: 1, Steps: 154 | Train Loss: 2.228 Vali Loss: 2.167 Vali Acc: 0.320 Test Loss: 2.167 Test Acc: 0.320
Validation loss decreased (inf --> -0.319930).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9800079
	speed: 0.1475s/iter; left time: 2234.6017s
Epoch: 2 cost time: 6.489283323287964
Epoch: 2, Steps: 154 | Train Loss: 2.037 Vali Loss: 2.172 Vali Acc: 0.321 Test Loss: 2.172 Test Acc: 0.321
Validation loss decreased (-0.319930 --> -0.321146).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4927855
	speed: 0.1538s/iter; left time: 2305.9977s
Epoch: 3 cost time: 6.985553503036499
Epoch: 3, Steps: 154 | Train Loss: 1.970 Vali Loss: 2.105 Vali Acc: 0.328 Test Loss: 2.105 Test Acc: 0.328
Validation loss decreased (-0.321146 --> -0.328041).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0060661
	speed: 0.1490s/iter; left time: 2211.0361s
Epoch: 4 cost time: 6.615362882614136
Epoch: 4, Steps: 154 | Train Loss: 1.908 Vali Loss: 2.407 Vali Acc: 0.328 Test Loss: 2.407 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6335310
	speed: 0.1475s/iter; left time: 2166.5159s
Epoch: 5 cost time: 6.270656585693359
Epoch: 5, Steps: 154 | Train Loss: 1.843 Vali Loss: 2.538 Vali Acc: 0.334 Test Loss: 2.538 Test Acc: 0.334
Validation loss decreased (-0.328041 --> -0.334119).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8132790
	speed: 0.1454s/iter; left time: 2112.5658s
Epoch: 6 cost time: 6.157737493515015
Epoch: 6, Steps: 154 | Train Loss: 1.776 Vali Loss: 2.564 Vali Acc: 0.341 Test Loss: 2.564 Test Acc: 0.341
Validation loss decreased (-0.334119 --> -0.341012).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2555168
	speed: 0.1425s/iter; left time: 2049.0380s
Epoch: 7 cost time: 6.4153218269348145
Epoch: 7, Steps: 154 | Train Loss: 1.697 Vali Loss: 2.784 Vali Acc: 0.343 Test Loss: 2.784 Test Acc: 0.343
Validation loss decreased (-0.341012 --> -0.343443).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0886116
	speed: 0.1471s/iter; left time: 2092.4681s
Epoch: 8 cost time: 6.284161329269409
Epoch: 8, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.550 Vali Acc: 0.347 Test Loss: 2.550 Test Acc: 0.347
Validation loss decreased (-0.343443 --> -0.346690).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5506678
	speed: 0.1390s/iter; left time: 1955.0876s
Epoch: 9 cost time: 6.543338060379028
Epoch: 9, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.592 Vali Acc: 0.356 Test Loss: 2.592 Test Acc: 0.356
Validation loss decreased (-0.346690 --> -0.355611).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4418877
	speed: 0.1458s/iter; left time: 2028.6376s
Epoch: 10 cost time: 6.447524309158325
Epoch: 10, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.421 Vali Acc: 0.367 Test Loss: 2.421 Test Acc: 0.367
Validation loss decreased (-0.355611 --> -0.366561).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6396111
	speed: 0.1422s/iter; left time: 1957.5003s
Epoch: 11 cost time: 6.437221527099609
Epoch: 11, Steps: 154 | Train Loss: 1.479 Vali Loss: 2.400 Vali Acc: 0.358 Test Loss: 2.400 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4846401
	speed: 0.1492s/iter; left time: 2029.6302s
Epoch: 12 cost time: 6.357539415359497
Epoch: 12, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.448 Vali Acc: 0.368 Test Loss: 2.448 Test Acc: 0.368
Validation loss decreased (-0.366561 --> -0.367778).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1261299
	speed: 0.1452s/iter; left time: 1952.8087s
Epoch: 13 cost time: 6.433197498321533
Epoch: 13, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.475 Vali Acc: 0.367 Test Loss: 2.475 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.6119248
	speed: 0.1437s/iter; left time: 1911.2529s
Epoch: 14 cost time: 6.265749216079712
Epoch: 14, Steps: 154 | Train Loss: 1.360 Vali Loss: 2.576 Vali Acc: 0.361 Test Loss: 2.576 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.5273576
	speed: 0.1405s/iter; left time: 1846.3585s
Epoch: 15 cost time: 6.057650327682495
Epoch: 15, Steps: 154 | Train Loss: 1.324 Vali Loss: 2.326 Vali Acc: 0.368 Test Loss: 2.326 Test Acc: 0.368
Validation loss decreased (-0.367778 --> -0.367779).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5903106
	speed: 0.1392s/iter; left time: 1807.8905s
Epoch: 16 cost time: 6.5481462478637695
Epoch: 16, Steps: 154 | Train Loss: 1.297 Vali Loss: 2.564 Vali Acc: 0.385 Test Loss: 2.564 Test Acc: 0.385
Validation loss decreased (-0.367779 --> -0.385214).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0992676
	speed: 0.1458s/iter; left time: 1871.2575s
Epoch: 17 cost time: 6.314664125442505
Epoch: 17, Steps: 154 | Train Loss: 1.277 Vali Loss: 2.561 Vali Acc: 0.374 Test Loss: 2.561 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.6484196
	speed: 0.1473s/iter; left time: 1867.7940s
Epoch: 18 cost time: 6.300486087799072
Epoch: 18, Steps: 154 | Train Loss: 1.242 Vali Loss: 2.651 Vali Acc: 0.381 Test Loss: 2.651 Test Acc: 0.381
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.4469672
	speed: 0.1438s/iter; left time: 1801.0895s
Epoch: 19 cost time: 6.559239625930786
Epoch: 19, Steps: 154 | Train Loss: 1.238 Vali Loss: 2.358 Vali Acc: 0.386 Test Loss: 2.358 Test Acc: 0.386
Validation loss decreased (-0.385214 --> -0.386027).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.7936374
	speed: 0.1455s/iter; left time: 1800.9610s
Epoch: 20 cost time: 6.267645597457886
Epoch: 20, Steps: 154 | Train Loss: 1.224 Vali Loss: 2.506 Vali Acc: 0.380 Test Loss: 2.506 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.9728984
	speed: 0.1434s/iter; left time: 1752.1806s
Epoch: 21 cost time: 6.223340034484863
Epoch: 21, Steps: 154 | Train Loss: 1.180 Vali Loss: 2.496 Vali Acc: 0.375 Test Loss: 2.496 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.3509281
	speed: 0.1403s/iter; left time: 1693.0564s
Epoch: 22 cost time: 6.536745548248291
Epoch: 22, Steps: 154 | Train Loss: 1.127 Vali Loss: 2.431 Vali Acc: 0.384 Test Loss: 2.431 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.4371216
	speed: 0.1466s/iter; left time: 1746.0751s
Epoch: 23 cost time: 6.401115655899048
Epoch: 23, Steps: 154 | Train Loss: 1.179 Vali Loss: 2.823 Vali Acc: 0.210 Test Loss: 2.823 Test Acc: 0.210
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.4983054
	speed: 0.1499s/iter; left time: 1762.1605s
Epoch: 24 cost time: 6.774515628814697
Epoch: 24, Steps: 154 | Train Loss: 1.112 Vali Loss: 2.613 Vali Acc: 0.384 Test Loss: 2.613 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.1522055
	speed: 0.1523s/iter; left time: 1766.9140s
Epoch: 25 cost time: 6.975466251373291
Epoch: 25, Steps: 154 | Train Loss: 1.148 Vali Loss: 2.653 Vali Acc: 0.256 Test Loss: 2.653 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.0854920
	speed: 0.1528s/iter; left time: 1749.5700s
Epoch: 26 cost time: 6.547236442565918
Epoch: 26, Steps: 154 | Train Loss: 1.121 Vali Loss: 2.817 Vali Acc: 0.382 Test Loss: 2.817 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.1243094
	speed: 0.1476s/iter; left time: 1667.0385s
Epoch: 27 cost time: 6.382826805114746
Epoch: 27, Steps: 154 | Train Loss: 1.061 Vali Loss: 2.658 Vali Acc: 0.399 Test Loss: 2.658 Test Acc: 0.399
Validation loss decreased (-0.386027 --> -0.398595).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.2246355
	speed: 0.1434s/iter; left time: 1597.8238s
Epoch: 28 cost time: 6.235263109207153
Epoch: 28, Steps: 154 | Train Loss: 1.043 Vali Loss: 2.790 Vali Acc: 0.386 Test Loss: 2.790 Test Acc: 0.386
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.4511211
	speed: 0.1428s/iter; left time: 1569.6709s
Epoch: 29 cost time: 6.078389406204224
Epoch: 29, Steps: 154 | Train Loss: 1.043 Vali Loss: 2.832 Vali Acc: 0.366 Test Loss: 2.832 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 1.2389619
	speed: 0.1413s/iter; left time: 1530.6950s
Epoch: 30 cost time: 6.2604079246521
Epoch: 30, Steps: 154 | Train Loss: 1.007 Vali Loss: 2.897 Vali Acc: 0.154 Test Loss: 2.897 Test Acc: 0.154
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.5830537
	speed: 0.1452s/iter; left time: 1551.3782s
Epoch: 31 cost time: 6.2602410316467285
Epoch: 31, Steps: 154 | Train Loss: 1.015 Vali Loss: 2.916 Vali Acc: 0.182 Test Loss: 2.916 Test Acc: 0.182
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 1.1513091
	speed: 0.1418s/iter; left time: 1492.2130s
Epoch: 32 cost time: 6.243016958236694
Epoch: 32, Steps: 154 | Train Loss: 0.971 Vali Loss: 2.875 Vali Acc: 0.385 Test Loss: 2.875 Test Acc: 0.385
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.8923635
	speed: 0.1465s/iter; left time: 1519.9805s
Epoch: 33 cost time: 6.433719873428345
Epoch: 33, Steps: 154 | Train Loss: 0.947 Vali Loss: 3.125 Vali Acc: 0.298 Test Loss: 3.125 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.7641351
	speed: 0.1283s/iter; left time: 1311.5635s
Epoch: 34 cost time: 5.885728597640991
Epoch: 34, Steps: 154 | Train Loss: 0.996 Vali Loss: 2.836 Vali Acc: 0.375 Test Loss: 2.836 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 1.3138200
	speed: 0.1341s/iter; left time: 1350.0546s
Epoch: 35 cost time: 6.63246488571167
Epoch: 35, Steps: 154 | Train Loss: 0.929 Vali Loss: 3.018 Vali Acc: 0.174 Test Loss: 3.018 Test Acc: 0.174
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 1.0443039
	speed: 0.1512s/iter; left time: 1498.9610s
Epoch: 36 cost time: 6.9999237060546875
Epoch: 36, Steps: 154 | Train Loss: 0.975 Vali Loss: 2.978 Vali Acc: 0.275 Test Loss: 2.978 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 1.3005384
	speed: 0.1480s/iter; left time: 1444.2365s
Epoch: 37 cost time: 6.559840679168701
Epoch: 37, Steps: 154 | Train Loss: 1.078 Vali Loss: 3.177 Vali Acc: 0.352 Test Loss: 3.177 Test Acc: 0.352
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3986212489862125
model parameter : 69086
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0965965
	speed: 0.0595s/iter; left time: 909.9602s
Epoch: 1 cost time: 8.034387111663818
Epoch: 1, Steps: 154 | Train Loss: 2.328 Vali Loss: 2.173 Vali Acc: 0.318 Test Loss: 2.173 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1360185
	speed: 0.1410s/iter; left time: 2136.3090s
Epoch: 2 cost time: 6.101214170455933
Epoch: 2, Steps: 154 | Train Loss: 2.097 Vali Loss: 2.176 Vali Acc: 0.318 Test Loss: 2.176 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.2342944
	speed: 0.1412s/iter; left time: 2117.0269s
Epoch: 3 cost time: 6.117321014404297
Epoch: 3, Steps: 154 | Train Loss: 2.020 Vali Loss: 2.153 Vali Acc: 0.320 Test Loss: 2.153 Test Acc: 0.320
Validation loss decreased (-0.317497 --> -0.320335).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0956862
	speed: 0.1414s/iter; left time: 2098.0774s
Epoch: 4 cost time: 6.218638896942139
Epoch: 4, Steps: 154 | Train Loss: 1.958 Vali Loss: 2.202 Vali Acc: 0.324 Test Loss: 2.202 Test Acc: 0.324
Validation loss decreased (-0.320335 --> -0.323984).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9049907
	speed: 0.1419s/iter; left time: 2084.1623s
Epoch: 5 cost time: 6.239248275756836
Epoch: 5, Steps: 154 | Train Loss: 1.932 Vali Loss: 2.151 Vali Acc: 0.329 Test Loss: 2.151 Test Acc: 0.329
Validation loss decreased (-0.323984 --> -0.329257).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8696032
	speed: 0.1453s/iter; left time: 2111.8016s
Epoch: 6 cost time: 6.227635860443115
Epoch: 6, Steps: 154 | Train Loss: 1.850 Vali Loss: 2.134 Vali Acc: 0.336 Test Loss: 2.134 Test Acc: 0.336
Validation loss decreased (-0.329257 --> -0.335745).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8569593
	speed: 0.1442s/iter; left time: 2073.2981s
Epoch: 7 cost time: 6.636724472045898
Epoch: 7, Steps: 154 | Train Loss: 1.798 Vali Loss: 2.211 Vali Acc: 0.337 Test Loss: 2.211 Test Acc: 0.337
Validation loss decreased (-0.335745 --> -0.336555).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5229011
	speed: 0.1523s/iter; left time: 2166.6554s
Epoch: 8 cost time: 6.476632833480835
Epoch: 8, Steps: 154 | Train Loss: 1.737 Vali Loss: 2.250 Vali Acc: 0.341 Test Loss: 2.250 Test Acc: 0.341
Validation loss decreased (-0.336555 --> -0.341421).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4753391
	speed: 0.1513s/iter; left time: 2128.3094s
Epoch: 9 cost time: 6.305854797363281
Epoch: 9, Steps: 154 | Train Loss: 1.708 Vali Loss: 2.224 Vali Acc: 0.345 Test Loss: 2.224 Test Acc: 0.345
Validation loss decreased (-0.341421 --> -0.344666).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2504210
	speed: 0.1474s/iter; left time: 2050.5247s
Epoch: 10 cost time: 6.428206443786621
Epoch: 10, Steps: 154 | Train Loss: 1.657 Vali Loss: 2.289 Vali Acc: 0.344 Test Loss: 2.289 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.7471850
	speed: 0.1410s/iter; left time: 1940.3725s
Epoch: 11 cost time: 6.15032434463501
Epoch: 11, Steps: 154 | Train Loss: 1.605 Vali Loss: 2.348 Vali Acc: 0.348 Test Loss: 2.348 Test Acc: 0.348
Validation loss decreased (-0.344666 --> -0.347908).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0943203
	speed: 0.1416s/iter; left time: 1926.7714s
Epoch: 12 cost time: 6.021301031112671
Epoch: 12, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.333 Vali Acc: 0.354 Test Loss: 2.333 Test Acc: 0.354
Validation loss decreased (-0.347908 --> -0.353991).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0517745
	speed: 0.1387s/iter; left time: 1866.4314s
Epoch: 13 cost time: 6.213531494140625
Epoch: 13, Steps: 154 | Train Loss: 1.571 Vali Loss: 2.412 Vali Acc: 0.348 Test Loss: 2.412 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.7121134
	speed: 0.1415s/iter; left time: 1881.7336s
Epoch: 14 cost time: 5.927154064178467
Epoch: 14, Steps: 154 | Train Loss: 1.554 Vali Loss: 2.373 Vali Acc: 0.355 Test Loss: 2.373 Test Acc: 0.355
Validation loss decreased (-0.353991 --> -0.355207).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.0852609
	speed: 0.1430s/iter; left time: 1879.1387s
Epoch: 15 cost time: 6.158700227737427
Epoch: 15, Steps: 154 | Train Loss: 1.533 Vali Loss: 2.390 Vali Acc: 0.357 Test Loss: 2.390 Test Acc: 0.357
Validation loss decreased (-0.355207 --> -0.357235).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.8173542
	speed: 0.1492s/iter; left time: 1938.1643s
Epoch: 16 cost time: 6.899120092391968
Epoch: 16, Steps: 154 | Train Loss: 1.518 Vali Loss: 2.330 Vali Acc: 0.358 Test Loss: 2.330 Test Acc: 0.358
Validation loss decreased (-0.357235 --> -0.357641).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.5026730
	speed: 0.1556s/iter; left time: 1997.6789s
Epoch: 17 cost time: 6.771006345748901
Epoch: 17, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.459 Vali Acc: 0.356 Test Loss: 2.459 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.9300147
	speed: 0.1551s/iter; left time: 1966.6894s
Epoch: 18 cost time: 6.667264699935913
Epoch: 18, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.466 Vali Acc: 0.358 Test Loss: 2.466 Test Acc: 0.358
Validation loss decreased (-0.357641 --> -0.358045).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.3773140
	speed: 0.1457s/iter; left time: 1826.0614s
Epoch: 19 cost time: 6.01839542388916
Epoch: 19, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.429 Vali Acc: 0.365 Test Loss: 2.429 Test Acc: 0.365
Validation loss decreased (-0.358045 --> -0.364939).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.2520618
	speed: 0.1368s/iter; left time: 1692.7526s
Epoch: 20 cost time: 6.154536962509155
Epoch: 20, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.480 Vali Acc: 0.361 Test Loss: 2.480 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.6291564
	speed: 0.1411s/iter; left time: 1723.7829s
Epoch: 21 cost time: 6.126887321472168
Epoch: 21, Steps: 154 | Train Loss: 1.417 Vali Loss: 2.595 Vali Acc: 0.364 Test Loss: 2.595 Test Acc: 0.364
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.0014281
	speed: 0.1421s/iter; left time: 1714.3791s
Epoch: 22 cost time: 6.061837196350098
Epoch: 22, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.565 Vali Acc: 0.365 Test Loss: 2.565 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.9079537
	speed: 0.1434s/iter; left time: 1708.4359s
Epoch: 23 cost time: 6.277500152587891
Epoch: 23, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.572 Vali Acc: 0.374 Test Loss: 2.572 Test Acc: 0.374
Validation loss decreased (-0.364939 --> -0.373859).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.7108343
	speed: 0.1458s/iter; left time: 1714.0468s
Epoch: 24 cost time: 6.327267646789551
Epoch: 24, Steps: 154 | Train Loss: 1.370 Vali Loss: 2.580 Vali Acc: 0.365 Test Loss: 2.580 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.5803376
	speed: 0.1452s/iter; left time: 1684.7440s
Epoch: 25 cost time: 6.356133699417114
Epoch: 25, Steps: 154 | Train Loss: 1.375 Vali Loss: 2.573 Vali Acc: 0.378 Test Loss: 2.573 Test Acc: 0.378
Validation loss decreased (-0.373859 --> -0.377914).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.4870083
	speed: 0.1442s/iter; left time: 1651.1420s
Epoch: 26 cost time: 6.152164697647095
Epoch: 26, Steps: 154 | Train Loss: 1.376 Vali Loss: 2.641 Vali Acc: 0.373 Test Loss: 2.641 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.6831105
	speed: 0.1487s/iter; left time: 1680.0191s
Epoch: 27 cost time: 6.459424018859863
Epoch: 27, Steps: 154 | Train Loss: 1.368 Vali Loss: 2.587 Vali Acc: 0.372 Test Loss: 2.587 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.0637875
	speed: 0.1476s/iter; left time: 1644.3174s
Epoch: 28 cost time: 6.546209335327148
Epoch: 28, Steps: 154 | Train Loss: 1.315 Vali Loss: 2.690 Vali Acc: 0.204 Test Loss: 2.690 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.4883232
	speed: 0.1466s/iter; left time: 1610.9796s
Epoch: 29 cost time: 6.263953447341919
Epoch: 29, Steps: 154 | Train Loss: 1.346 Vali Loss: 2.708 Vali Acc: 0.214 Test Loss: 2.708 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.3104560
	speed: 0.1449s/iter; left time: 1569.8592s
Epoch: 30 cost time: 6.3023841381073
Epoch: 30, Steps: 154 | Train Loss: 1.292 Vali Loss: 2.768 Vali Acc: 0.311 Test Loss: 2.768 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 1.6947985
	speed: 0.1442s/iter; left time: 1540.0076s
Epoch: 31 cost time: 6.042467832565308
Epoch: 31, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.753 Vali Acc: 0.359 Test Loss: 2.753 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 1.2466564
	speed: 0.1392s/iter; left time: 1465.6684s
Epoch: 32 cost time: 6.157927513122559
Epoch: 32, Steps: 154 | Train Loss: 1.269 Vali Loss: 2.782 Vali Acc: 0.207 Test Loss: 2.782 Test Acc: 0.207
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 1.3541131
	speed: 0.1394s/iter; left time: 1445.6756s
Epoch: 33 cost time: 6.166568279266357
Epoch: 33, Steps: 154 | Train Loss: 1.267 Vali Loss: 2.900 Vali Acc: 0.105 Test Loss: 2.900 Test Acc: 0.105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.7478759
	speed: 0.1453s/iter; left time: 1485.1967s
Epoch: 34 cost time: 6.413170099258423
Epoch: 34, Steps: 154 | Train Loss: 1.250 Vali Loss: 2.746 Vali Acc: 0.201 Test Loss: 2.746 Test Acc: 0.201
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.7485735
	speed: 0.1428s/iter; left time: 1437.5727s
Epoch: 35 cost time: 6.519011974334717
Epoch: 35, Steps: 154 | Train Loss: 1.231 Vali Loss: 2.642 Vali Acc: 0.384 Test Loss: 2.642 Test Acc: 0.384
Validation loss decreased (-0.377914 --> -0.384402).  Saving model ...
	iters: 100, epoch: 36 | loss: 2.0720417
	speed: 0.1455s/iter; left time: 1442.1353s
Epoch: 36 cost time: 6.085236549377441
Epoch: 36, Steps: 154 | Train Loss: 1.216 Vali Loss: 2.960 Vali Acc: 0.088 Test Loss: 2.960 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.7772964
	speed: 0.1410s/iter; left time: 1375.6368s
Epoch: 37 cost time: 6.070275545120239
Epoch: 37, Steps: 154 | Train Loss: 1.201 Vali Loss: 2.997 Vali Acc: 0.103 Test Loss: 2.997 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.8913829
	speed: 0.1468s/iter; left time: 1409.2762s
Epoch: 38 cost time: 6.508979797363281
Epoch: 38, Steps: 154 | Train Loss: 1.207 Vali Loss: 3.181 Vali Acc: 0.084 Test Loss: 3.181 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 1.4841248
	speed: 0.1469s/iter; left time: 1387.8845s
Epoch: 39 cost time: 6.254103183746338
Epoch: 39, Steps: 154 | Train Loss: 1.200 Vali Loss: 2.972 Vali Acc: 0.177 Test Loss: 2.972 Test Acc: 0.177
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.8731015
	speed: 0.1525s/iter; left time: 1417.6221s
Epoch: 40 cost time: 7.144061803817749
Epoch: 40, Steps: 154 | Train Loss: 1.187 Vali Loss: 3.032 Vali Acc: 0.110 Test Loss: 3.032 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 1.3550620
	speed: 0.1520s/iter; left time: 1389.5682s
Epoch: 41 cost time: 6.700897932052612
Epoch: 41, Steps: 154 | Train Loss: 1.208 Vali Loss: 3.046 Vali Acc: 0.082 Test Loss: 3.046 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.7556469
	speed: 0.1454s/iter; left time: 1307.0782s
Epoch: 42 cost time: 6.144252300262451
Epoch: 42, Steps: 154 | Train Loss: 1.222 Vali Loss: 2.959 Vali Acc: 0.180 Test Loss: 2.959 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 1.2367774
	speed: 0.1453s/iter; left time: 1283.2937s
Epoch: 43 cost time: 6.210151433944702
Epoch: 43, Steps: 154 | Train Loss: 1.240 Vali Loss: 3.132 Vali Acc: 0.094 Test Loss: 3.132 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.9699795
	speed: 0.1415s/iter; left time: 1228.4050s
Epoch: 44 cost time: 5.976240396499634
Epoch: 44, Steps: 154 | Train Loss: 1.208 Vali Loss: 3.163 Vali Acc: 0.093 Test Loss: 3.163 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 1.4360220
	speed: 0.1312s/iter; left time: 1118.8823s
Epoch: 45 cost time: 6.166187286376953
Epoch: 45, Steps: 154 | Train Loss: 1.155 Vali Loss: 3.006 Vali Acc: 0.116 Test Loss: 3.006 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3844282238442822
model parameter : 284446
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0954213
	speed: 0.0559s/iter; left time: 855.8759s
Epoch: 1 cost time: 7.80422830581665
Epoch: 1, Steps: 154 | Train Loss: 2.322 Vali Loss: 2.168 Vali Acc: 0.318 Test Loss: 2.168 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1816540
	speed: 0.1372s/iter; left time: 2078.4488s
Epoch: 2 cost time: 6.174589395523071
Epoch: 2, Steps: 154 | Train Loss: 2.086 Vali Loss: 2.180 Vali Acc: 0.318 Test Loss: 2.180 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.2999928
	speed: 0.1501s/iter; left time: 2249.9219s
Epoch: 3 cost time: 6.376921653747559
Epoch: 3, Steps: 154 | Train Loss: 2.009 Vali Loss: 2.155 Vali Acc: 0.321 Test Loss: 2.155 Test Acc: 0.321
Validation loss decreased (-0.317497 --> -0.320741).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1012602
	speed: 0.1483s/iter; left time: 2201.2340s
Epoch: 4 cost time: 6.873502969741821
Epoch: 4, Steps: 154 | Train Loss: 1.949 Vali Loss: 2.197 Vali Acc: 0.324 Test Loss: 2.197 Test Acc: 0.324
Validation loss decreased (-0.320741 --> -0.323579).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9336556
	speed: 0.1501s/iter; left time: 2203.9586s
Epoch: 5 cost time: 6.789917230606079
Epoch: 5, Steps: 154 | Train Loss: 1.909 Vali Loss: 2.140 Vali Acc: 0.332 Test Loss: 2.140 Test Acc: 0.332
Validation loss decreased (-0.323579 --> -0.331690).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9364328
	speed: 0.1510s/iter; left time: 2194.3370s
Epoch: 6 cost time: 6.151464223861694
Epoch: 6, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.114 Vali Acc: 0.335 Test Loss: 2.114 Test Acc: 0.335
Validation loss decreased (-0.331690 --> -0.335340).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9482949
	speed: 0.1394s/iter; left time: 2004.3364s
Epoch: 7 cost time: 6.033082008361816
Epoch: 7, Steps: 154 | Train Loss: 1.816 Vali Loss: 2.208 Vali Acc: 0.337 Test Loss: 2.208 Test Acc: 0.337
Validation loss decreased (-0.335340 --> -0.337366).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5643234
	speed: 0.1384s/iter; left time: 1968.9032s
Epoch: 8 cost time: 6.053135633468628
Epoch: 8, Steps: 154 | Train Loss: 1.736 Vali Loss: 2.273 Vali Acc: 0.339 Test Loss: 2.273 Test Acc: 0.339
Validation loss decreased (-0.337366 --> -0.338582).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4016224
	speed: 0.1383s/iter; left time: 1946.2389s
Epoch: 9 cost time: 6.041678428649902
Epoch: 9, Steps: 154 | Train Loss: 1.692 Vali Loss: 2.226 Vali Acc: 0.345 Test Loss: 2.226 Test Acc: 0.345
Validation loss decreased (-0.338582 --> -0.344665).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.1636811
	speed: 0.1409s/iter; left time: 1960.9502s
Epoch: 10 cost time: 6.043777942657471
Epoch: 10, Steps: 154 | Train Loss: 1.668 Vali Loss: 2.261 Vali Acc: 0.343 Test Loss: 2.261 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.8131340
	speed: 0.1390s/iter; left time: 1912.8370s
Epoch: 11 cost time: 5.893764495849609
Epoch: 11, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.286 Vali Acc: 0.357 Test Loss: 2.286 Test Acc: 0.357
Validation loss decreased (-0.344665 --> -0.357236).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1053629
	speed: 0.1367s/iter; left time: 1859.6692s
Epoch: 12 cost time: 6.395110607147217
Epoch: 12, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.267 Vali Acc: 0.358 Test Loss: 2.267 Test Acc: 0.358
Validation loss decreased (-0.357236 --> -0.357642).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0965674
	speed: 0.1451s/iter; left time: 1952.0589s
Epoch: 13 cost time: 6.7432146072387695
Epoch: 13, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.361 Vali Acc: 0.348 Test Loss: 2.361 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.6627223
	speed: 0.1517s/iter; left time: 2017.6093s
Epoch: 14 cost time: 6.479975700378418
Epoch: 14, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.371 Vali Acc: 0.357 Test Loss: 2.371 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.9018350
	speed: 0.1522s/iter; left time: 2000.9920s
Epoch: 15 cost time: 6.907439947128296
Epoch: 15, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.373 Vali Acc: 0.356 Test Loss: 2.373 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.8069508
	speed: 0.1424s/iter; left time: 1849.4744s
Epoch: 16 cost time: 6.064631223678589
Epoch: 16, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.340 Vali Acc: 0.360 Test Loss: 2.340 Test Acc: 0.360
Validation loss decreased (-0.357642 --> -0.359668).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.3430083
	speed: 0.1455s/iter; left time: 1868.1099s
Epoch: 17 cost time: 6.078217506408691
Epoch: 17, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.385 Vali Acc: 0.355 Test Loss: 2.385 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.9687775
	speed: 0.1357s/iter; left time: 1721.1732s
Epoch: 18 cost time: 6.094785213470459
Epoch: 18, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.435 Vali Acc: 0.364 Test Loss: 2.435 Test Acc: 0.364
Validation loss decreased (-0.359668 --> -0.363723).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.4669739
	speed: 0.1363s/iter; left time: 1707.7294s
Epoch: 19 cost time: 5.863048553466797
Epoch: 19, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.368 Vali Acc: 0.377 Test Loss: 2.368 Test Acc: 0.377
Validation loss decreased (-0.363723 --> -0.377105).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.2187389
	speed: 0.1420s/iter; left time: 1757.0035s
Epoch: 20 cost time: 6.019528150558472
Epoch: 20, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.465 Vali Acc: 0.366 Test Loss: 2.465 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.4373382
	speed: 0.1429s/iter; left time: 1745.9361s
Epoch: 21 cost time: 6.82246208190918
Epoch: 21, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.403 Vali Acc: 0.367 Test Loss: 2.403 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.1420823
	speed: 0.1435s/iter; left time: 1731.3962s
Epoch: 22 cost time: 5.952700138092041
Epoch: 22, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.475 Vali Acc: 0.378 Test Loss: 2.475 Test Acc: 0.378
Validation loss decreased (-0.377105 --> -0.378321).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.9222227
	speed: 0.1431s/iter; left time: 1704.2759s
Epoch: 23 cost time: 6.001244783401489
Epoch: 23, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.502 Vali Acc: 0.238 Test Loss: 2.502 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.5465968
	speed: 0.1506s/iter; left time: 1770.4142s
Epoch: 24 cost time: 7.119109630584717
Epoch: 24, Steps: 154 | Train Loss: 1.340 Vali Loss: 2.430 Vali Acc: 0.383 Test Loss: 2.430 Test Acc: 0.383
Validation loss decreased (-0.378321 --> -0.382782).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.4693509
	speed: 0.1472s/iter; left time: 1707.7831s
Epoch: 25 cost time: 6.070584297180176
Epoch: 25, Steps: 154 | Train Loss: 1.326 Vali Loss: 2.488 Vali Acc: 0.384 Test Loss: 2.488 Test Acc: 0.384
Validation loss decreased (-0.382782 --> -0.384403).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.7267101
	speed: 0.1479s/iter; left time: 1693.0576s
Epoch: 26 cost time: 6.234354734420776
Epoch: 26, Steps: 154 | Train Loss: 1.321 Vali Loss: 2.698 Vali Acc: 0.356 Test Loss: 2.698 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.5423523
	speed: 0.1444s/iter; left time: 1631.6770s
Epoch: 27 cost time: 6.559093713760376
Epoch: 27, Steps: 154 | Train Loss: 1.300 Vali Loss: 2.548 Vali Acc: 0.373 Test Loss: 2.548 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.1002915
	speed: 0.1491s/iter; left time: 1660.9609s
Epoch: 28 cost time: 5.975250482559204
Epoch: 28, Steps: 154 | Train Loss: 1.298 Vali Loss: 2.676 Vali Acc: 0.211 Test Loss: 2.676 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.3359392
	speed: 0.1396s/iter; left time: 1533.5410s
Epoch: 29 cost time: 5.984939098358154
Epoch: 29, Steps: 154 | Train Loss: 1.308 Vali Loss: 2.517 Vali Acc: 0.251 Test Loss: 2.517 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.3695008
	speed: 0.1407s/iter; left time: 1524.2687s
Epoch: 30 cost time: 6.125464200973511
Epoch: 30, Steps: 154 | Train Loss: 1.264 Vali Loss: 2.781 Vali Acc: 0.153 Test Loss: 2.781 Test Acc: 0.153
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 1.7606673
	speed: 0.1448s/iter; left time: 1546.5982s
Epoch: 31 cost time: 6.237286806106567
Epoch: 31, Steps: 154 | Train Loss: 1.298 Vali Loss: 2.587 Vali Acc: 0.258 Test Loss: 2.587 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 1.3508432
	speed: 0.1459s/iter; left time: 1536.1383s
Epoch: 32 cost time: 6.258164644241333
Epoch: 32, Steps: 154 | Train Loss: 1.239 Vali Loss: 2.778 Vali Acc: 0.195 Test Loss: 2.778 Test Acc: 0.195
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 1.4712220
	speed: 0.1397s/iter; left time: 1448.8788s
Epoch: 33 cost time: 6.255963563919067
Epoch: 33, Steps: 154 | Train Loss: 1.235 Vali Loss: 2.782 Vali Acc: 0.106 Test Loss: 2.782 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.5392495
	speed: 0.1353s/iter; left time: 1382.7845s
Epoch: 34 cost time: 5.7168192863464355
Epoch: 34, Steps: 154 | Train Loss: 1.220 Vali Loss: 2.784 Vali Acc: 0.207 Test Loss: 2.784 Test Acc: 0.207
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.7400519
	speed: 0.1355s/iter; left time: 1363.8310s
Epoch: 35 cost time: 6.533820152282715
Epoch: 35, Steps: 154 | Train Loss: 1.195 Vali Loss: 2.687 Vali Acc: 0.272 Test Loss: 2.687 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3844282238442822
model parameter : 284446
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0438673
	speed: 0.0545s/iter; left time: 834.2495s
Epoch: 1 cost time: 7.489408016204834
Epoch: 1, Steps: 154 | Train Loss: 2.310 Vali Loss: 2.164 Vali Acc: 0.317 Test Loss: 2.164 Test Acc: 0.317
Validation loss decreased (inf --> -0.317091).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2283318
	speed: 0.1512s/iter; left time: 2289.5274s
Epoch: 2 cost time: 6.964945077896118
Epoch: 2, Steps: 154 | Train Loss: 2.077 Vali Loss: 2.198 Vali Acc: 0.316 Test Loss: 2.198 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.2563918
	speed: 0.1492s/iter; left time: 2237.6310s
Epoch: 3 cost time: 6.769125699996948
Epoch: 3, Steps: 154 | Train Loss: 2.005 Vali Loss: 2.154 Vali Acc: 0.320 Test Loss: 2.154 Test Acc: 0.320
Validation loss decreased (-0.317091 --> -0.319930).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1070235
	speed: 0.1514s/iter; left time: 2246.7333s
Epoch: 4 cost time: 6.37912654876709
Epoch: 4, Steps: 154 | Train Loss: 1.937 Vali Loss: 2.249 Vali Acc: 0.324 Test Loss: 2.249 Test Acc: 0.324
Validation loss decreased (-0.319930 --> -0.323984).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8576062
	speed: 0.1489s/iter; left time: 2186.9170s
Epoch: 5 cost time: 6.6064770221710205
Epoch: 5, Steps: 154 | Train Loss: 1.889 Vali Loss: 2.154 Vali Acc: 0.331 Test Loss: 2.154 Test Acc: 0.331
Validation loss decreased (-0.323984 --> -0.330879).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8910241
	speed: 0.1468s/iter; left time: 2132.5376s
Epoch: 6 cost time: 6.224056959152222
Epoch: 6, Steps: 154 | Train Loss: 1.825 Vali Loss: 2.103 Vali Acc: 0.334 Test Loss: 2.103 Test Acc: 0.334
Validation loss decreased (-0.330879 --> -0.334123).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8968526
	speed: 0.1405s/iter; left time: 2019.9914s
Epoch: 7 cost time: 5.941781520843506
Epoch: 7, Steps: 154 | Train Loss: 1.794 Vali Loss: 2.307 Vali Acc: 0.337 Test Loss: 2.307 Test Acc: 0.337
Validation loss decreased (-0.334123 --> -0.337365).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5520202
	speed: 0.1428s/iter; left time: 2030.4049s
Epoch: 8 cost time: 6.281862020492554
Epoch: 8, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.306 Vali Acc: 0.337 Test Loss: 2.306 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3962377
	speed: 0.1444s/iter; left time: 2031.6257s
Epoch: 9 cost time: 6.255184173583984
Epoch: 9, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.178 Vali Acc: 0.347 Test Loss: 2.178 Test Acc: 0.347
Validation loss decreased (-0.337365 --> -0.347099).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3392230
	speed: 0.1506s/iter; left time: 2094.9631s
Epoch: 10 cost time: 6.817427396774292
Epoch: 10, Steps: 154 | Train Loss: 1.653 Vali Loss: 2.255 Vali Acc: 0.346 Test Loss: 2.255 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.7573473
	speed: 0.1606s/iter; left time: 2210.3154s
Epoch: 11 cost time: 7.126735687255859
Epoch: 11, Steps: 154 | Train Loss: 1.619 Vali Loss: 2.258 Vali Acc: 0.354 Test Loss: 2.258 Test Acc: 0.354
Validation loss decreased (-0.347099 --> -0.353992).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9675332
	speed: 0.1519s/iter; left time: 2066.8408s
Epoch: 12 cost time: 6.848844051361084
Epoch: 12, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.317 Vali Acc: 0.361 Test Loss: 2.317 Test Acc: 0.361
Validation loss decreased (-0.353992 --> -0.361291).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1419454
	speed: 0.1563s/iter; left time: 2103.3291s
Epoch: 13 cost time: 6.796745777130127
Epoch: 13, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.355 Vali Acc: 0.352 Test Loss: 2.355 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5207405
	speed: 0.1477s/iter; left time: 1964.9184s
Epoch: 14 cost time: 6.297128438949585
Epoch: 14, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.347 Vali Acc: 0.356 Test Loss: 2.347 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3204544
	speed: 0.1443s/iter; left time: 1896.7923s
Epoch: 15 cost time: 6.406124591827393
Epoch: 15, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.366 Vali Acc: 0.361 Test Loss: 2.366 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.1990778
	speed: 0.1429s/iter; left time: 1856.6186s
Epoch: 16 cost time: 6.185230493545532
Epoch: 16, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.328 Vali Acc: 0.360 Test Loss: 2.328 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.2171613
	speed: 0.1378s/iter; left time: 1768.9655s
Epoch: 17 cost time: 6.462880611419678
Epoch: 17, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.601 Vali Acc: 0.219 Test Loss: 2.601 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.9158910
	speed: 0.1459s/iter; left time: 1850.0976s
Epoch: 18 cost time: 6.2438085079193115
Epoch: 18, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.598 Vali Acc: 0.219 Test Loss: 2.598 Test Acc: 0.219
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.4010147
	speed: 0.1464s/iter; left time: 1833.9623s
Epoch: 19 cost time: 6.34438943862915
Epoch: 19, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.465 Vali Acc: 0.235 Test Loss: 2.465 Test Acc: 0.235
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.2538855
	speed: 0.1546s/iter; left time: 1913.5298s
Epoch: 20 cost time: 7.094994306564331
Epoch: 20, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.546 Vali Acc: 0.231 Test Loss: 2.546 Test Acc: 0.231
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.4086083
	speed: 0.1557s/iter; left time: 1902.4470s
Epoch: 21 cost time: 6.952330589294434
Epoch: 21, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.551 Vali Acc: 0.367 Test Loss: 2.551 Test Acc: 0.367
Validation loss decreased (-0.361291 --> -0.366966).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.1393490
	speed: 0.1565s/iter; left time: 1888.4013s
Epoch: 22 cost time: 6.887389183044434
Epoch: 22, Steps: 154 | Train Loss: 1.375 Vali Loss: 2.657 Vali Acc: 0.221 Test Loss: 2.657 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.0493166
	speed: 0.1588s/iter; left time: 1891.8654s
Epoch: 23 cost time: 6.685251951217651
Epoch: 23, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.699 Vali Acc: 0.208 Test Loss: 2.699 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.6661534
	speed: 0.1506s/iter; left time: 1770.4109s
Epoch: 24 cost time: 6.752283334732056
Epoch: 24, Steps: 154 | Train Loss: 1.320 Vali Loss: 2.539 Vali Acc: 0.217 Test Loss: 2.539 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.5270413
	speed: 0.1445s/iter; left time: 1676.6283s
Epoch: 25 cost time: 6.194720268249512
Epoch: 25, Steps: 154 | Train Loss: 1.332 Vali Loss: 2.681 Vali Acc: 0.344 Test Loss: 2.681 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 2.1913149
	speed: 0.1462s/iter; left time: 1674.2656s
Epoch: 26 cost time: 6.237171411514282
Epoch: 26, Steps: 154 | Train Loss: 1.336 Vali Loss: 2.684 Vali Acc: 0.348 Test Loss: 2.684 Test Acc: 0.348
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.6984372
	speed: 0.1436s/iter; left time: 1621.7380s
Epoch: 27 cost time: 6.384996652603149
Epoch: 27, Steps: 154 | Train Loss: 1.262 Vali Loss: 2.830 Vali Acc: 0.216 Test Loss: 2.830 Test Acc: 0.216
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.0974958
	speed: 0.1500s/iter; left time: 1671.0556s
Epoch: 28 cost time: 6.46718430519104
Epoch: 28, Steps: 154 | Train Loss: 1.297 Vali Loss: 3.016 Vali Acc: 0.200 Test Loss: 3.016 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 1.5022296
	speed: 0.1503s/iter; left time: 1651.3726s
Epoch: 29 cost time: 6.510182857513428
Epoch: 29, Steps: 154 | Train Loss: 1.269 Vali Loss: 2.898 Vali Acc: 0.207 Test Loss: 2.898 Test Acc: 0.207
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.0404062
	speed: 0.1480s/iter; left time: 1604.0141s
Epoch: 30 cost time: 6.655906915664673
Epoch: 30, Steps: 154 | Train Loss: 1.233 Vali Loss: 2.640 Vali Acc: 0.365 Test Loss: 2.640 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 1.2751211
	speed: 0.1559s/iter; left time: 1665.1300s
Epoch: 31 cost time: 6.598827600479126
Epoch: 31, Steps: 154 | Train Loss: 1.237 Vali Loss: 2.885 Vali Acc: 0.197 Test Loss: 2.885 Test Acc: 0.197
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36699107866991076
model parameter : 284446
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9808116
	speed: 0.0549s/iter; left time: 840.0947s
Epoch: 1 cost time: 7.547999382019043
Epoch: 1, Steps: 154 | Train Loss: 2.290 Vali Loss: 2.176 Vali Acc: 0.318 Test Loss: 2.176 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1704152
	speed: 0.1364s/iter; left time: 2066.7055s
Epoch: 2 cost time: 5.892613887786865
Epoch: 2, Steps: 154 | Train Loss: 2.054 Vali Loss: 2.298 Vali Acc: 0.318 Test Loss: 2.298 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.1669786
	speed: 0.1375s/iter; left time: 2060.9049s
Epoch: 3 cost time: 6.08963680267334
Epoch: 3, Steps: 154 | Train Loss: 1.979 Vali Loss: 2.208 Vali Acc: 0.324 Test Loss: 2.208 Test Acc: 0.324
Validation loss decreased (-0.318308 --> -0.323984).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9367799
	speed: 0.1382s/iter; left time: 2050.8015s
Epoch: 4 cost time: 6.002766847610474
Epoch: 4, Steps: 154 | Train Loss: 1.905 Vali Loss: 2.447 Vali Acc: 0.327 Test Loss: 2.447 Test Acc: 0.327
Validation loss decreased (-0.323984 --> -0.326821).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7875410
	speed: 0.1302s/iter; left time: 1911.8372s
Epoch: 5 cost time: 5.719774484634399
Epoch: 5, Steps: 154 | Train Loss: 1.844 Vali Loss: 2.194 Vali Acc: 0.329 Test Loss: 2.194 Test Acc: 0.329
Validation loss decreased (-0.326821 --> -0.329256).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8245690
	speed: 0.1372s/iter; left time: 1993.9498s
Epoch: 6 cost time: 5.98101282119751
Epoch: 6, Steps: 154 | Train Loss: 1.770 Vali Loss: 2.159 Vali Acc: 0.338 Test Loss: 2.159 Test Acc: 0.338
Validation loss decreased (-0.329256 --> -0.338178).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6407136
	speed: 0.1405s/iter; left time: 2019.6541s
Epoch: 7 cost time: 6.398192644119263
Epoch: 7, Steps: 154 | Train Loss: 1.732 Vali Loss: 2.467 Vali Acc: 0.336 Test Loss: 2.467 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4217502
	speed: 0.1444s/iter; left time: 2054.4783s
Epoch: 8 cost time: 6.137874364852905
Epoch: 8, Steps: 154 | Train Loss: 1.670 Vali Loss: 2.617 Vali Acc: 0.340 Test Loss: 2.617 Test Acc: 0.340
Validation loss decreased (-0.338178 --> -0.340201).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3224891
	speed: 0.1384s/iter; left time: 1947.2907s
Epoch: 9 cost time: 5.9020490646362305
Epoch: 9, Steps: 154 | Train Loss: 1.625 Vali Loss: 2.341 Vali Acc: 0.349 Test Loss: 2.341 Test Acc: 0.349
Validation loss decreased (-0.340201 --> -0.348719).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3224589
	speed: 0.1401s/iter; left time: 1949.4771s
Epoch: 10 cost time: 6.137043476104736
Epoch: 10, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.218 Vali Acc: 0.351 Test Loss: 2.218 Test Acc: 0.351
Validation loss decreased (-0.348719 --> -0.350748).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8434567
	speed: 0.1429s/iter; left time: 1966.5856s
Epoch: 11 cost time: 6.255077600479126
Epoch: 11, Steps: 154 | Train Loss: 1.552 Vali Loss: 2.218 Vali Acc: 0.361 Test Loss: 2.218 Test Acc: 0.361
Validation loss decreased (-0.350748 --> -0.360886).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0423249
	speed: 0.1423s/iter; left time: 1936.7295s
Epoch: 12 cost time: 6.599208116531372
Epoch: 12, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.201 Vali Acc: 0.367 Test Loss: 2.201 Test Acc: 0.367
Validation loss decreased (-0.360886 --> -0.366969).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0895648
	speed: 0.1491s/iter; left time: 2006.2032s
Epoch: 13 cost time: 6.444427013397217
Epoch: 13, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.264 Vali Acc: 0.361 Test Loss: 2.264 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.6103698
	speed: 0.1444s/iter; left time: 1920.0631s
Epoch: 14 cost time: 6.075051784515381
Epoch: 14, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.248 Vali Acc: 0.380 Test Loss: 2.248 Test Acc: 0.380
Validation loss decreased (-0.366969 --> -0.380351).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.3989704
	speed: 0.1416s/iter; left time: 1861.2368s
Epoch: 15 cost time: 6.3271803855896
Epoch: 15, Steps: 154 | Train Loss: 1.443 Vali Loss: 2.284 Vali Acc: 0.372 Test Loss: 2.284 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.6594403
	speed: 0.1401s/iter; left time: 1819.5232s
Epoch: 16 cost time: 6.1008946895599365
Epoch: 16, Steps: 154 | Train Loss: 1.397 Vali Loss: 2.394 Vali Acc: 0.363 Test Loss: 2.394 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.5380409
	speed: 0.1424s/iter; left time: 1828.3489s
Epoch: 17 cost time: 6.051265478134155
Epoch: 17, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.404 Vali Acc: 0.365 Test Loss: 2.404 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.8478729
	speed: 0.1384s/iter; left time: 1754.8928s
Epoch: 18 cost time: 6.010668039321899
Epoch: 18, Steps: 154 | Train Loss: 1.360 Vali Loss: 2.399 Vali Acc: 0.374 Test Loss: 2.399 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.5116296
	speed: 0.1385s/iter; left time: 1735.4269s
Epoch: 19 cost time: 6.048689842224121
Epoch: 19, Steps: 154 | Train Loss: 1.350 Vali Loss: 2.285 Vali Acc: 0.374 Test Loss: 2.285 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.2703346
	speed: 0.1391s/iter; left time: 1721.4581s
Epoch: 20 cost time: 6.254236698150635
Epoch: 20, Steps: 154 | Train Loss: 1.331 Vali Loss: 2.454 Vali Acc: 0.369 Test Loss: 2.454 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.3265719
	speed: 0.1443s/iter; left time: 1763.2660s
Epoch: 21 cost time: 6.181927680969238
Epoch: 21, Steps: 154 | Train Loss: 1.290 Vali Loss: 2.772 Vali Acc: 0.370 Test Loss: 2.772 Test Acc: 0.370
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.0051632
	speed: 0.1501s/iter; left time: 1811.5731s
Epoch: 22 cost time: 6.508145570755005
Epoch: 22, Steps: 154 | Train Loss: 1.297 Vali Loss: 2.329 Vali Acc: 0.380 Test Loss: 2.329 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.9486941
	speed: 0.1495s/iter; left time: 1780.7480s
Epoch: 23 cost time: 6.672314405441284
Epoch: 23, Steps: 154 | Train Loss: 1.287 Vali Loss: 2.389 Vali Acc: 0.380 Test Loss: 2.389 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.3777800
	speed: 0.1473s/iter; left time: 1731.6767s
Epoch: 24 cost time: 6.485652208328247
Epoch: 24, Steps: 154 | Train Loss: 1.305 Vali Loss: 2.333 Vali Acc: 0.363 Test Loss: 2.333 Test Acc: 0.363
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38037307380373075
model parameter : 284446
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1480582
	speed: 0.0567s/iter; left time: 867.0706s
Epoch: 1 cost time: 7.664803981781006
Epoch: 1, Steps: 154 | Train Loss: 2.303 Vali Loss: 2.150 Vali Acc: 0.315 Test Loss: 2.150 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8846890
	speed: 0.1395s/iter; left time: 2113.6170s
Epoch: 2 cost time: 5.949276924133301
Epoch: 2, Steps: 154 | Train Loss: 2.107 Vali Loss: 2.151 Vali Acc: 0.317 Test Loss: 2.151 Test Acc: 0.317
Validation loss decreased (-0.315469 --> -0.317091).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9688345
	speed: 0.1374s/iter; left time: 2060.3860s
Epoch: 3 cost time: 5.783642530441284
Epoch: 3, Steps: 154 | Train Loss: 2.033 Vali Loss: 2.129 Vali Acc: 0.320 Test Loss: 2.129 Test Acc: 0.320
Validation loss decreased (-0.317091 --> -0.319930).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1852808
	speed: 0.1373s/iter; left time: 2036.7615s
Epoch: 4 cost time: 5.9354143142700195
Epoch: 4, Steps: 154 | Train Loss: 1.984 Vali Loss: 2.127 Vali Acc: 0.322 Test Loss: 2.127 Test Acc: 0.322
Validation loss decreased (-0.319930 --> -0.321958).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7876874
	speed: 0.1394s/iter; left time: 2046.6375s
Epoch: 5 cost time: 6.127828598022461
Epoch: 5, Steps: 154 | Train Loss: 1.935 Vali Loss: 2.122 Vali Acc: 0.325 Test Loss: 2.122 Test Acc: 0.325
Validation loss decreased (-0.321958 --> -0.324796).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8354303
	speed: 0.1535s/iter; left time: 2230.6224s
Epoch: 6 cost time: 6.890366792678833
Epoch: 6, Steps: 154 | Train Loss: 1.876 Vali Loss: 2.108 Vali Acc: 0.333 Test Loss: 2.108 Test Acc: 0.333
Validation loss decreased (-0.324796 --> -0.333312).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5138690
	speed: 0.1538s/iter; left time: 2210.8142s
Epoch: 7 cost time: 6.989516735076904
Epoch: 7, Steps: 154 | Train Loss: 1.820 Vali Loss: 2.153 Vali Acc: 0.340 Test Loss: 2.153 Test Acc: 0.340
Validation loss decreased (-0.333312 --> -0.340206).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6160207
	speed: 0.1514s/iter; left time: 2153.2427s
Epoch: 8 cost time: 6.570499897003174
Epoch: 8, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.191 Vali Acc: 0.340 Test Loss: 2.191 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7590098
	speed: 0.1528s/iter; left time: 2150.2508s
Epoch: 9 cost time: 6.497586250305176
Epoch: 9, Steps: 154 | Train Loss: 1.724 Vali Loss: 2.284 Vali Acc: 0.340 Test Loss: 2.284 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.7243984
	speed: 0.1459s/iter; left time: 2030.4242s
Epoch: 10 cost time: 5.984003782272339
Epoch: 10, Steps: 154 | Train Loss: 1.677 Vali Loss: 2.245 Vali Acc: 0.341 Test Loss: 2.245 Test Acc: 0.341
Validation loss decreased (-0.340206 --> -0.340610).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7798214
	speed: 0.1297s/iter; left time: 1785.0641s
Epoch: 11 cost time: 5.788269519805908
Epoch: 11, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.323 Vali Acc: 0.343 Test Loss: 2.323 Test Acc: 0.343
Validation loss decreased (-0.340610 --> -0.342637).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8091358
	speed: 0.1381s/iter; left time: 1879.0480s
Epoch: 12 cost time: 6.013794660568237
Epoch: 12, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.351 Vali Acc: 0.345 Test Loss: 2.351 Test Acc: 0.345
Validation loss decreased (-0.342637 --> -0.344664).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5646734
	speed: 0.1393s/iter; left time: 1873.5910s
Epoch: 13 cost time: 6.146886348724365
Epoch: 13, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.405 Vali Acc: 0.350 Test Loss: 2.405 Test Acc: 0.350
Validation loss decreased (-0.344664 --> -0.350341).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6038402
	speed: 0.1399s/iter; left time: 1860.0700s
Epoch: 14 cost time: 6.153568744659424
Epoch: 14, Steps: 154 | Train Loss: 1.557 Vali Loss: 2.301 Vali Acc: 0.351 Test Loss: 2.301 Test Acc: 0.351
Validation loss decreased (-0.350341 --> -0.350747).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.8010820
	speed: 0.1439s/iter; left time: 1891.3264s
Epoch: 15 cost time: 6.134746313095093
Epoch: 15, Steps: 154 | Train Loss: 1.557 Vali Loss: 2.300 Vali Acc: 0.356 Test Loss: 2.300 Test Acc: 0.356
Validation loss decreased (-0.350747 --> -0.356425).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.1147923
	speed: 0.1457s/iter; left time: 1893.2818s
Epoch: 16 cost time: 6.507575511932373
Epoch: 16, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.401 Vali Acc: 0.350 Test Loss: 2.401 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.3585916
	speed: 0.1520s/iter; left time: 1950.7501s
Epoch: 17 cost time: 6.6106274127960205
Epoch: 17, Steps: 154 | Train Loss: 1.554 Vali Loss: 2.453 Vali Acc: 0.361 Test Loss: 2.453 Test Acc: 0.361
Validation loss decreased (-0.356425 --> -0.360478).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.1399734
	speed: 0.1516s/iter; left time: 1922.8064s
Epoch: 18 cost time: 6.277595520019531
Epoch: 18, Steps: 154 | Train Loss: 1.466 Vali Loss: 2.410 Vali Acc: 0.370 Test Loss: 2.410 Test Acc: 0.370
Validation loss decreased (-0.360478 --> -0.370211).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.2961844
	speed: 0.1469s/iter; left time: 1840.9902s
Epoch: 19 cost time: 6.209303617477417
Epoch: 19, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.437 Vali Acc: 0.359 Test Loss: 2.437 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.2471575
	speed: 0.1455s/iter; left time: 1800.5701s
Epoch: 20 cost time: 6.236365079879761
Epoch: 20, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.494 Vali Acc: 0.359 Test Loss: 2.494 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.2355194
	speed: 0.1363s/iter; left time: 1665.9272s
Epoch: 21 cost time: 5.793554306030273
Epoch: 21, Steps: 154 | Train Loss: 1.424 Vali Loss: 2.522 Vali Acc: 0.354 Test Loss: 2.522 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.4790764
	speed: 0.1332s/iter; left time: 1606.8953s
Epoch: 22 cost time: 6.087080717086792
Epoch: 22, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.424 Vali Acc: 0.216 Test Loss: 2.424 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.1757162
	speed: 0.1411s/iter; left time: 1680.6476s
Epoch: 23 cost time: 6.180958986282349
Epoch: 23, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.624 Vali Acc: 0.362 Test Loss: 2.624 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.7225075
	speed: 0.1418s/iter; left time: 1667.5352s
Epoch: 24 cost time: 5.906312942504883
Epoch: 24, Steps: 154 | Train Loss: 1.381 Vali Loss: 2.596 Vali Acc: 0.372 Test Loss: 2.596 Test Acc: 0.372
Validation loss decreased (-0.370211 --> -0.372237).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.3157059
	speed: 0.1453s/iter; left time: 1686.1091s
Epoch: 25 cost time: 6.431345701217651
Epoch: 25, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.622 Vali Acc: 0.363 Test Loss: 2.622 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.1685660
	speed: 0.1397s/iter; left time: 1600.0373s
Epoch: 26 cost time: 6.110242605209351
Epoch: 26, Steps: 154 | Train Loss: 1.321 Vali Loss: 2.640 Vali Acc: 0.337 Test Loss: 2.640 Test Acc: 0.337
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.9822447
	speed: 0.1453s/iter; left time: 1641.8451s
Epoch: 27 cost time: 6.5474889278411865
Epoch: 27, Steps: 154 | Train Loss: 1.323 Vali Loss: 2.549 Vali Acc: 0.371 Test Loss: 2.549 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.1683848
	speed: 0.1482s/iter; left time: 1651.3612s
Epoch: 28 cost time: 6.357385873794556
Epoch: 28, Steps: 154 | Train Loss: 1.321 Vali Loss: 2.674 Vali Acc: 0.361 Test Loss: 2.674 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 1.2884281
	speed: 0.1449s/iter; left time: 1592.1303s
Epoch: 29 cost time: 6.217095613479614
Epoch: 29, Steps: 154 | Train Loss: 1.308 Vali Loss: 2.591 Vali Acc: 0.362 Test Loss: 2.591 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 1.0515850
	speed: 0.1457s/iter; left time: 1578.5659s
Epoch: 30 cost time: 6.2070722579956055
Epoch: 30, Steps: 154 | Train Loss: 1.297 Vali Loss: 2.650 Vali Acc: 0.364 Test Loss: 2.650 Test Acc: 0.364
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.9420654
	speed: 0.1439s/iter; left time: 1536.4668s
Epoch: 31 cost time: 6.155293703079224
Epoch: 31, Steps: 154 | Train Loss: 1.298 Vali Loss: 2.632 Vali Acc: 0.336 Test Loss: 2.632 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 1.2876523
	speed: 0.1416s/iter; left time: 1490.2345s
Epoch: 32 cost time: 6.0562663078308105
Epoch: 32, Steps: 154 | Train Loss: 1.311 Vali Loss: 2.748 Vali Acc: 0.212 Test Loss: 2.748 Test Acc: 0.212
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 1.5407841
	speed: 0.1395s/iter; left time: 1446.5580s
Epoch: 33 cost time: 5.902034044265747
Epoch: 33, Steps: 154 | Train Loss: 1.278 Vali Loss: 2.821 Vali Acc: 0.112 Test Loss: 2.821 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.9284596
	speed: 0.1424s/iter; left time: 1455.2705s
Epoch: 34 cost time: 6.447202444076538
Epoch: 34, Steps: 154 | Train Loss: 1.227 Vali Loss: 2.699 Vali Acc: 0.372 Test Loss: 2.699 Test Acc: 0.372
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3722627737226277
model parameter : 153374
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1759872
	speed: 0.0551s/iter; left time: 842.9133s
Epoch: 1 cost time: 7.4855101108551025
Epoch: 1, Steps: 154 | Train Loss: 2.305 Vali Loss: 2.151 Vali Acc: 0.316 Test Loss: 2.151 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8578918
	speed: 0.1342s/iter; left time: 2031.9889s
Epoch: 2 cost time: 6.008474826812744
Epoch: 2, Steps: 154 | Train Loss: 2.094 Vali Loss: 2.153 Vali Acc: 0.318 Test Loss: 2.153 Test Acc: 0.318
Validation loss decreased (-0.315875 --> -0.317497).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9923195
	speed: 0.1414s/iter; left time: 2119.5124s
Epoch: 3 cost time: 6.158729314804077
Epoch: 3, Steps: 154 | Train Loss: 2.028 Vali Loss: 2.129 Vali Acc: 0.321 Test Loss: 2.129 Test Acc: 0.321
Validation loss decreased (-0.317497 --> -0.320741).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1624706
	speed: 0.1469s/iter; left time: 2179.5169s
Epoch: 4 cost time: 6.201416730880737
Epoch: 4, Steps: 154 | Train Loss: 1.973 Vali Loss: 2.128 Vali Acc: 0.323 Test Loss: 2.128 Test Acc: 0.323
Validation loss decreased (-0.320741 --> -0.323174).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7670881
	speed: 0.1434s/iter; left time: 2105.6132s
Epoch: 5 cost time: 6.35173487663269
Epoch: 5, Steps: 154 | Train Loss: 1.923 Vali Loss: 2.127 Vali Acc: 0.327 Test Loss: 2.127 Test Acc: 0.327
Validation loss decreased (-0.323174 --> -0.327229).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7877321
	speed: 0.1427s/iter; left time: 2073.9650s
Epoch: 6 cost time: 6.81838059425354
Epoch: 6, Steps: 154 | Train Loss: 1.867 Vali Loss: 2.099 Vali Acc: 0.339 Test Loss: 2.099 Test Acc: 0.339
Validation loss decreased (-0.327229 --> -0.338584).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4082065
	speed: 0.1462s/iter; left time: 2101.5388s
Epoch: 7 cost time: 6.166492700576782
Epoch: 7, Steps: 154 | Train Loss: 1.827 Vali Loss: 2.161 Vali Acc: 0.341 Test Loss: 2.161 Test Acc: 0.341
Validation loss decreased (-0.338584 --> -0.341017).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8298625
	speed: 0.1419s/iter; left time: 2017.6767s
Epoch: 8 cost time: 6.113879680633545
Epoch: 8, Steps: 154 | Train Loss: 1.750 Vali Loss: 2.185 Vali Acc: 0.343 Test Loss: 2.185 Test Acc: 0.343
Validation loss decreased (-0.341017 --> -0.343449).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9126384
	speed: 0.1387s/iter; left time: 1951.6914s
Epoch: 9 cost time: 6.027401447296143
Epoch: 9, Steps: 154 | Train Loss: 1.732 Vali Loss: 2.291 Vali Acc: 0.343 Test Loss: 2.291 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6771340
	speed: 0.1391s/iter; left time: 1935.7702s
Epoch: 10 cost time: 5.789469480514526
Epoch: 10, Steps: 154 | Train Loss: 1.681 Vali Loss: 2.234 Vali Acc: 0.342 Test Loss: 2.234 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.7841522
	speed: 0.1371s/iter; left time: 1886.5423s
Epoch: 11 cost time: 6.029975891113281
Epoch: 11, Steps: 154 | Train Loss: 1.636 Vali Loss: 2.358 Vali Acc: 0.347 Test Loss: 2.358 Test Acc: 0.347
Validation loss decreased (-0.343449 --> -0.347097).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7488815
	speed: 0.1342s/iter; left time: 1825.6399s
Epoch: 12 cost time: 5.87880539894104
Epoch: 12, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.411 Vali Acc: 0.345 Test Loss: 2.411 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5872320
	speed: 0.1328s/iter; left time: 1786.1639s
Epoch: 13 cost time: 5.922020196914673
Epoch: 13, Steps: 154 | Train Loss: 1.585 Vali Loss: 2.392 Vali Acc: 0.352 Test Loss: 2.392 Test Acc: 0.352
Validation loss decreased (-0.347097 --> -0.351963).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4670217
	speed: 0.1400s/iter; left time: 1862.0130s
Epoch: 14 cost time: 6.534210920333862
Epoch: 14, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.315 Vali Acc: 0.357 Test Loss: 2.315 Test Acc: 0.357
Validation loss decreased (-0.351963 --> -0.357236).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.7982435
	speed: 0.1491s/iter; left time: 1959.9807s
Epoch: 15 cost time: 6.501936912536621
Epoch: 15, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.282 Vali Acc: 0.360 Test Loss: 2.282 Test Acc: 0.360
Validation loss decreased (-0.357236 --> -0.360075).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.2446175
	speed: 0.1518s/iter; left time: 1972.6521s
Epoch: 16 cost time: 6.401122093200684
Epoch: 16, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.337 Vali Acc: 0.357 Test Loss: 2.337 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.5382951
	speed: 0.1537s/iter; left time: 1973.1109s
Epoch: 17 cost time: 6.961202144622803
Epoch: 17, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.424 Vali Acc: 0.360 Test Loss: 2.424 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 2.1141548
	speed: 0.1450s/iter; left time: 1839.2601s
Epoch: 18 cost time: 6.238620281219482
Epoch: 18, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.411 Vali Acc: 0.369 Test Loss: 2.411 Test Acc: 0.369
Validation loss decreased (-0.360075 --> -0.369400).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.4217744
	speed: 0.1458s/iter; left time: 1827.0826s
Epoch: 19 cost time: 6.119934558868408
Epoch: 19, Steps: 154 | Train Loss: 1.458 Vali Loss: 2.468 Vali Acc: 0.362 Test Loss: 2.468 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.2442199
	speed: 0.1438s/iter; left time: 1779.3462s
Epoch: 20 cost time: 6.31087064743042
Epoch: 20, Steps: 154 | Train Loss: 1.425 Vali Loss: 2.544 Vali Acc: 0.364 Test Loss: 2.544 Test Acc: 0.364
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.2390013
	speed: 0.1395s/iter; left time: 1705.0192s
Epoch: 21 cost time: 6.113285541534424
Epoch: 21, Steps: 154 | Train Loss: 1.411 Vali Loss: 2.501 Vali Acc: 0.367 Test Loss: 2.501 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.4213063
	speed: 0.1413s/iter; left time: 1705.5301s
Epoch: 22 cost time: 5.9894139766693115
Epoch: 22, Steps: 154 | Train Loss: 1.383 Vali Loss: 2.499 Vali Acc: 0.263 Test Loss: 2.499 Test Acc: 0.263
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.3390566
	speed: 0.1383s/iter; left time: 1647.2801s
Epoch: 23 cost time: 6.284580945968628
Epoch: 23, Steps: 154 | Train Loss: 1.396 Vali Loss: 2.608 Vali Acc: 0.363 Test Loss: 2.608 Test Acc: 0.363
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.6997080
	speed: 0.1360s/iter; left time: 1598.8187s
Epoch: 24 cost time: 6.410566568374634
Epoch: 24, Steps: 154 | Train Loss: 1.347 Vali Loss: 2.591 Vali Acc: 0.359 Test Loss: 2.591 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.3156847
	speed: 0.1535s/iter; left time: 1780.9912s
Epoch: 25 cost time: 6.647929668426514
Epoch: 25, Steps: 154 | Train Loss: 1.371 Vali Loss: 2.637 Vali Acc: 0.371 Test Loss: 2.637 Test Acc: 0.371
Validation loss decreased (-0.369400 --> -0.371020).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.0519905
	speed: 0.1490s/iter; left time: 1705.6728s
Epoch: 26 cost time: 6.677666187286377
Epoch: 26, Steps: 154 | Train Loss: 1.292 Vali Loss: 2.593 Vali Acc: 0.376 Test Loss: 2.593 Test Acc: 0.376
Validation loss decreased (-0.371020 --> -0.375481).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.9286945
	speed: 0.1536s/iter; left time: 1735.0118s
Epoch: 27 cost time: 6.470203399658203
Epoch: 27, Steps: 154 | Train Loss: 1.313 Vali Loss: 2.695 Vali Acc: 0.371 Test Loss: 2.695 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.2119992
	speed: 0.1477s/iter; left time: 1646.0906s
Epoch: 28 cost time: 6.192359685897827
Epoch: 28, Steps: 154 | Train Loss: 1.262 Vali Loss: 2.646 Vali Acc: 0.120 Test Loss: 2.646 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.4424249
	speed: 0.1409s/iter; left time: 1548.4517s
Epoch: 29 cost time: 6.212192058563232
Epoch: 29, Steps: 154 | Train Loss: 1.294 Vali Loss: 2.659 Vali Acc: 0.231 Test Loss: 2.659 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.9999690
	speed: 0.1425s/iter; left time: 1544.2513s
Epoch: 30 cost time: 5.929002523422241
Epoch: 30, Steps: 154 | Train Loss: 1.252 Vali Loss: 2.782 Vali Acc: 0.370 Test Loss: 2.782 Test Acc: 0.370
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.9429174
	speed: 0.1428s/iter; left time: 1525.7301s
Epoch: 31 cost time: 6.2875916957855225
Epoch: 31, Steps: 154 | Train Loss: 1.299 Vali Loss: 2.715 Vali Acc: 0.382 Test Loss: 2.715 Test Acc: 0.382
Validation loss decreased (-0.375481 --> -0.381968).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.3124942
	speed: 0.1376s/iter; left time: 1448.7753s
Epoch: 32 cost time: 5.9657368659973145
Epoch: 32, Steps: 154 | Train Loss: 1.261 Vali Loss: 2.886 Vali Acc: 0.110 Test Loss: 2.886 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 1.5428365
	speed: 0.1367s/iter; left time: 1418.4767s
Epoch: 33 cost time: 5.458745956420898
Epoch: 33, Steps: 154 | Train Loss: 1.278 Vali Loss: 2.885 Vali Acc: 0.103 Test Loss: 2.885 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.8374897
	speed: 0.1264s/iter; left time: 1291.9372s
Epoch: 34 cost time: 5.753395318984985
Epoch: 34, Steps: 154 | Train Loss: 1.208 Vali Loss: 2.790 Vali Acc: 0.326 Test Loss: 2.790 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 1.5535892
	speed: 0.1406s/iter; left time: 1415.2586s
Epoch: 35 cost time: 6.760427474975586
Epoch: 35, Steps: 154 | Train Loss: 1.191 Vali Loss: 2.948 Vali Acc: 0.094 Test Loss: 2.948 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.8795305
	speed: 0.1491s/iter; left time: 1477.4005s
Epoch: 36 cost time: 6.471098899841309
Epoch: 36, Steps: 154 | Train Loss: 1.220 Vali Loss: 2.842 Vali Acc: 0.102 Test Loss: 2.842 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.7398482
	speed: 0.1534s/iter; left time: 1496.7206s
Epoch: 37 cost time: 7.114013671875
Epoch: 37, Steps: 154 | Train Loss: 1.182 Vali Loss: 3.134 Vali Acc: 0.092 Test Loss: 3.134 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 1.6770936
	speed: 0.1480s/iter; left time: 1421.2580s
Epoch: 38 cost time: 6.458400249481201
Epoch: 38, Steps: 154 | Train Loss: 1.264 Vali Loss: 2.777 Vali Acc: 0.358 Test Loss: 2.777 Test Acc: 0.358
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 1.6567883
	speed: 0.1507s/iter; left time: 1424.3368s
Epoch: 39 cost time: 6.393746376037598
Epoch: 39, Steps: 154 | Train Loss: 1.206 Vali Loss: 2.823 Vali Acc: 0.364 Test Loss: 2.823 Test Acc: 0.364
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.8767781
	speed: 0.1434s/iter; left time: 1333.3026s
Epoch: 40 cost time: 6.2342143058776855
Epoch: 40, Steps: 154 | Train Loss: 1.152 Vali Loss: 2.737 Vali Acc: 0.220 Test Loss: 2.737 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.7422999
	speed: 0.1387s/iter; left time: 1267.4586s
Epoch: 41 cost time: 5.856600522994995
Epoch: 41, Steps: 154 | Train Loss: 1.163 Vali Loss: 2.822 Vali Acc: 0.213 Test Loss: 2.822 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3819951338199513
model parameter : 153374
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1871185
	speed: 0.0599s/iter; left time: 916.6626s
Epoch: 1 cost time: 8.101759433746338
Epoch: 1, Steps: 154 | Train Loss: 2.294 Vali Loss: 2.148 Vali Acc: 0.315 Test Loss: 2.148 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8157089
	speed: 0.1435s/iter; left time: 2173.6179s
Epoch: 2 cost time: 5.951459646224976
Epoch: 2, Steps: 154 | Train Loss: 2.098 Vali Loss: 2.150 Vali Acc: 0.318 Test Loss: 2.150 Test Acc: 0.318
Validation loss decreased (-0.315064 --> -0.318308).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9888384
	speed: 0.1436s/iter; left time: 2153.3847s
Epoch: 3 cost time: 6.168707609176636
Epoch: 3, Steps: 154 | Train Loss: 2.025 Vali Loss: 2.124 Vali Acc: 0.321 Test Loss: 2.124 Test Acc: 0.321
Validation loss decreased (-0.318308 --> -0.321147).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1400204
	speed: 0.1485s/iter; left time: 2203.1062s
Epoch: 4 cost time: 6.772570371627808
Epoch: 4, Steps: 154 | Train Loss: 1.968 Vali Loss: 2.141 Vali Acc: 0.322 Test Loss: 2.141 Test Acc: 0.322
Validation loss decreased (-0.321147 --> -0.322363).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7855109
	speed: 0.1545s/iter; left time: 2268.2103s
Epoch: 5 cost time: 6.579653263092041
Epoch: 5, Steps: 154 | Train Loss: 1.924 Vali Loss: 2.144 Vali Acc: 0.324 Test Loss: 2.144 Test Acc: 0.324
Validation loss decreased (-0.322363 --> -0.324391).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6740322
	speed: 0.1524s/iter; left time: 2214.1582s
Epoch: 6 cost time: 6.435113430023193
Epoch: 6, Steps: 154 | Train Loss: 1.870 Vali Loss: 2.119 Vali Acc: 0.335 Test Loss: 2.119 Test Acc: 0.335
Validation loss decreased (-0.324391 --> -0.335340).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4350564
	speed: 0.1470s/iter; left time: 2114.0852s
Epoch: 7 cost time: 6.876163959503174
Epoch: 7, Steps: 154 | Train Loss: 1.819 Vali Loss: 2.188 Vali Acc: 0.338 Test Loss: 2.188 Test Acc: 0.338
Validation loss decreased (-0.335340 --> -0.337772).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8999041
	speed: 0.1471s/iter; left time: 2091.9470s
Epoch: 8 cost time: 6.128808498382568
Epoch: 8, Steps: 154 | Train Loss: 1.751 Vali Loss: 2.152 Vali Acc: 0.345 Test Loss: 2.152 Test Acc: 0.345
Validation loss decreased (-0.337772 --> -0.344666).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0346298
	speed: 0.1442s/iter; left time: 2028.1862s
Epoch: 9 cost time: 6.111805200576782
Epoch: 9, Steps: 154 | Train Loss: 1.717 Vali Loss: 2.306 Vali Acc: 0.339 Test Loss: 2.306 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6303797
	speed: 0.1417s/iter; left time: 1971.6392s
Epoch: 10 cost time: 6.222906827926636
Epoch: 10, Steps: 154 | Train Loss: 1.683 Vali Loss: 2.269 Vali Acc: 0.347 Test Loss: 2.269 Test Acc: 0.347
Validation loss decreased (-0.344666 --> -0.346693).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8645160
	speed: 0.1422s/iter; left time: 1956.6433s
Epoch: 11 cost time: 6.161370038986206
Epoch: 11, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.352 Vali Acc: 0.345 Test Loss: 2.352 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.5961953
	speed: 0.1450s/iter; left time: 1972.7309s
Epoch: 12 cost time: 6.326109409332275
Epoch: 12, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.358 Vali Acc: 0.347 Test Loss: 2.358 Test Acc: 0.347
Validation loss decreased (-0.346693 --> -0.347097).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7420946
	speed: 0.1437s/iter; left time: 1933.0003s
Epoch: 13 cost time: 6.499183654785156
Epoch: 13, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.374 Vali Acc: 0.352 Test Loss: 2.374 Test Acc: 0.352
Validation loss decreased (-0.347097 --> -0.352369).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4104347
	speed: 0.1449s/iter; left time: 1926.8023s
Epoch: 14 cost time: 5.971387147903442
Epoch: 14, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.372 Vali Acc: 0.353 Test Loss: 2.372 Test Acc: 0.353
Validation loss decreased (-0.352369 --> -0.352774).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.7024944
	speed: 0.1385s/iter; left time: 1820.2450s
Epoch: 15 cost time: 6.020594358444214
Epoch: 15, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.297 Vali Acc: 0.360 Test Loss: 2.297 Test Acc: 0.360
Validation loss decreased (-0.352774 --> -0.359669).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4339859
	speed: 0.1386s/iter; left time: 1800.6206s
Epoch: 16 cost time: 5.890496492385864
Epoch: 16, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.440 Vali Acc: 0.362 Test Loss: 2.440 Test Acc: 0.362
Validation loss decreased (-0.359669 --> -0.361695).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.6932238
	speed: 0.1353s/iter; left time: 1736.6504s
Epoch: 17 cost time: 5.860430717468262
Epoch: 17, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.540 Vali Acc: 0.345 Test Loss: 2.540 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.9737388
	speed: 0.1296s/iter; left time: 1644.1139s
Epoch: 18 cost time: 6.367930889129639
Epoch: 18, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.493 Vali Acc: 0.204 Test Loss: 2.493 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.1789762
	speed: 0.1446s/iter; left time: 1811.3559s
Epoch: 19 cost time: 6.7477216720581055
Epoch: 19, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.507 Vali Acc: 0.363 Test Loss: 2.507 Test Acc: 0.363
Validation loss decreased (-0.361695 --> -0.363316).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.3236171
	speed: 0.1534s/iter; left time: 1898.7391s
Epoch: 20 cost time: 6.3702073097229
Epoch: 20, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.565 Vali Acc: 0.363 Test Loss: 2.565 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.4134980
	speed: 0.1503s/iter; left time: 1837.1461s
Epoch: 21 cost time: 6.854903936386108
Epoch: 21, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.573 Vali Acc: 0.218 Test Loss: 2.573 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.5461383
	speed: 0.1513s/iter; left time: 1825.8999s
Epoch: 22 cost time: 6.846206188201904
Epoch: 22, Steps: 154 | Train Loss: 1.375 Vali Loss: 2.623 Vali Acc: 0.204 Test Loss: 2.623 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.0620019
	speed: 0.1473s/iter; left time: 1755.2137s
Epoch: 23 cost time: 6.1014416217803955
Epoch: 23, Steps: 154 | Train Loss: 1.363 Vali Loss: 2.774 Vali Acc: 0.197 Test Loss: 2.774 Test Acc: 0.197
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.5917819
	speed: 0.1446s/iter; left time: 1700.2755s
Epoch: 24 cost time: 6.180291175842285
Epoch: 24, Steps: 154 | Train Loss: 1.348 Vali Loss: 2.541 Vali Acc: 0.208 Test Loss: 2.541 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.3981918
	speed: 0.1409s/iter; left time: 1635.3502s
Epoch: 25 cost time: 6.077934741973877
Epoch: 25, Steps: 154 | Train Loss: 1.347 Vali Loss: 2.602 Vali Acc: 0.323 Test Loss: 2.602 Test Acc: 0.323
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.8882641
	speed: 0.1397s/iter; left time: 1599.5763s
Epoch: 26 cost time: 5.847207307815552
Epoch: 26, Steps: 154 | Train Loss: 1.301 Vali Loss: 2.601 Vali Acc: 0.356 Test Loss: 2.601 Test Acc: 0.356
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.2018145
	speed: 0.1437s/iter; left time: 1623.5120s
Epoch: 27 cost time: 6.45391058921814
Epoch: 27, Steps: 154 | Train Loss: 1.278 Vali Loss: 2.834 Vali Acc: 0.269 Test Loss: 2.834 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.1132987
	speed: 0.1429s/iter; left time: 1592.3400s
Epoch: 28 cost time: 6.420114994049072
Epoch: 28, Steps: 154 | Train Loss: 1.258 Vali Loss: 2.790 Vali Acc: 0.123 Test Loss: 2.790 Test Acc: 0.123
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.3563340
	speed: 0.1471s/iter; left time: 1616.0963s
Epoch: 29 cost time: 6.561487436294556
Epoch: 29, Steps: 154 | Train Loss: 1.269 Vali Loss: 2.705 Vali Acc: 0.214 Test Loss: 2.705 Test Acc: 0.214
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3633414436334144
model parameter : 153374
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0917513
	speed: 0.0568s/iter; left time: 868.4582s
Epoch: 1 cost time: 8.08053183555603
Epoch: 1, Steps: 154 | Train Loss: 2.278 Vali Loss: 2.148 Vali Acc: 0.315 Test Loss: 2.148 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8654770
	speed: 0.1478s/iter; left time: 2238.3895s
Epoch: 2 cost time: 6.236574411392212
Epoch: 2, Steps: 154 | Train Loss: 2.086 Vali Loss: 2.146 Vali Acc: 0.319 Test Loss: 2.146 Test Acc: 0.319
Validation loss decreased (-0.315469 --> -0.318713).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0208335
	speed: 0.1454s/iter; left time: 2179.5750s
Epoch: 3 cost time: 6.1519598960876465
Epoch: 3, Steps: 154 | Train Loss: 2.003 Vali Loss: 2.138 Vali Acc: 0.322 Test Loss: 2.138 Test Acc: 0.322
Validation loss decreased (-0.318713 --> -0.321958).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0849650
	speed: 0.1388s/iter; left time: 2059.1527s
Epoch: 4 cost time: 5.964224100112915
Epoch: 4, Steps: 154 | Train Loss: 1.953 Vali Loss: 2.213 Vali Acc: 0.324 Test Loss: 2.213 Test Acc: 0.324
Validation loss decreased (-0.321958 --> -0.323579).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7312020
	speed: 0.1333s/iter; left time: 1957.2218s
Epoch: 5 cost time: 5.960570335388184
Epoch: 5, Steps: 154 | Train Loss: 1.874 Vali Loss: 2.199 Vali Acc: 0.328 Test Loss: 2.199 Test Acc: 0.328
Validation loss decreased (-0.323579 --> -0.327634).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9912910
	speed: 0.1450s/iter; left time: 2107.6299s
Epoch: 6 cost time: 6.275494575500488
Epoch: 6, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.147 Vali Acc: 0.333 Test Loss: 2.147 Test Acc: 0.333
Validation loss decreased (-0.327634 --> -0.332906).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3105485
	speed: 0.1320s/iter; left time: 1897.9838s
Epoch: 7 cost time: 6.136662721633911
Epoch: 7, Steps: 154 | Train Loss: 1.767 Vali Loss: 2.404 Vali Acc: 0.335 Test Loss: 2.404 Test Acc: 0.335
Validation loss decreased (-0.332906 --> -0.334931).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9151424
	speed: 0.1449s/iter; left time: 2060.9868s
Epoch: 8 cost time: 6.220131874084473
Epoch: 8, Steps: 154 | Train Loss: 1.691 Vali Loss: 2.220 Vali Acc: 0.346 Test Loss: 2.220 Test Acc: 0.346
Validation loss decreased (-0.334931 --> -0.345882).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8019588
	speed: 0.1421s/iter; left time: 1999.6766s
Epoch: 9 cost time: 6.529589414596558
Epoch: 9, Steps: 154 | Train Loss: 1.653 Vali Loss: 2.595 Vali Acc: 0.342 Test Loss: 2.595 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4376819
	speed: 0.1502s/iter; left time: 2090.2096s
Epoch: 10 cost time: 6.672399044036865
Epoch: 10, Steps: 154 | Train Loss: 1.625 Vali Loss: 2.402 Vali Acc: 0.348 Test Loss: 2.402 Test Acc: 0.348
Validation loss decreased (-0.345882 --> -0.347908).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8862869
	speed: 0.1462s/iter; left time: 2011.5076s
Epoch: 11 cost time: 6.438566207885742
Epoch: 11, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.464 Vali Acc: 0.351 Test Loss: 2.464 Test Acc: 0.351
Validation loss decreased (-0.347908 --> -0.350746).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5904461
	speed: 0.1468s/iter; left time: 1998.0469s
Epoch: 12 cost time: 6.348081588745117
Epoch: 12, Steps: 154 | Train Loss: 1.511 Vali Loss: 2.343 Vali Acc: 0.359 Test Loss: 2.343 Test Acc: 0.359
Validation loss decreased (-0.350746 --> -0.358857).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5933205
	speed: 0.1442s/iter; left time: 1939.4062s
Epoch: 13 cost time: 6.332291126251221
Epoch: 13, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.343 Vali Acc: 0.357 Test Loss: 2.343 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.2503822
	speed: 0.1434s/iter; left time: 1907.2398s
Epoch: 14 cost time: 6.386977434158325
Epoch: 14, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.515 Vali Acc: 0.356 Test Loss: 2.515 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.6698633
	speed: 0.1469s/iter; left time: 1930.6425s
Epoch: 15 cost time: 6.35100245475769
Epoch: 15, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.316 Vali Acc: 0.362 Test Loss: 2.316 Test Acc: 0.362
Validation loss decreased (-0.358857 --> -0.361696).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.2368206
	speed: 0.1447s/iter; left time: 1880.3823s
Epoch: 16 cost time: 6.338424205780029
Epoch: 16, Steps: 154 | Train Loss: 1.409 Vali Loss: 2.480 Vali Acc: 0.361 Test Loss: 2.480 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.5176107
	speed: 0.1465s/iter; left time: 1880.7452s
Epoch: 17 cost time: 6.416208982467651
Epoch: 17, Steps: 154 | Train Loss: 1.388 Vali Loss: 2.296 Vali Acc: 0.378 Test Loss: 2.296 Test Acc: 0.378
Validation loss decreased (-0.361696 --> -0.377512).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.9687430
	speed: 0.1439s/iter; left time: 1824.7363s
Epoch: 18 cost time: 6.375181198120117
Epoch: 18, Steps: 154 | Train Loss: 1.341 Vali Loss: 2.595 Vali Acc: 0.306 Test Loss: 2.595 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.0800428
	speed: 0.1431s/iter; left time: 1793.4505s
Epoch: 19 cost time: 6.217249870300293
Epoch: 19, Steps: 154 | Train Loss: 1.363 Vali Loss: 2.429 Vali Acc: 0.361 Test Loss: 2.429 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.2323418
	speed: 0.1448s/iter; left time: 1792.0727s
Epoch: 20 cost time: 6.2046802043914795
Epoch: 20, Steps: 154 | Train Loss: 1.326 Vali Loss: 2.514 Vali Acc: 0.373 Test Loss: 2.514 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.3853459
	speed: 0.1449s/iter; left time: 1771.2214s
Epoch: 21 cost time: 6.613317966461182
Epoch: 21, Steps: 154 | Train Loss: 1.308 Vali Loss: 2.566 Vali Acc: 0.295 Test Loss: 2.566 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.5723778
	speed: 0.1444s/iter; left time: 1742.8874s
Epoch: 22 cost time: 6.4572062492370605
Epoch: 22, Steps: 154 | Train Loss: 1.294 Vali Loss: 2.390 Vali Acc: 0.239 Test Loss: 2.390 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.1846228
	speed: 0.1472s/iter; left time: 1753.3494s
Epoch: 23 cost time: 6.250757217407227
Epoch: 23, Steps: 154 | Train Loss: 1.253 Vali Loss: 2.547 Vali Acc: 0.376 Test Loss: 2.547 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.6154016
	speed: 0.1463s/iter; left time: 1720.1901s
Epoch: 24 cost time: 6.450041770935059
Epoch: 24, Steps: 154 | Train Loss: 1.279 Vali Loss: 2.279 Vali Acc: 0.332 Test Loss: 2.279 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 1.5060986
	speed: 0.1430s/iter; left time: 1659.1218s
Epoch: 25 cost time: 6.284512281417847
Epoch: 25, Steps: 154 | Train Loss: 1.247 Vali Loss: 2.290 Vali Acc: 0.376 Test Loss: 2.290 Test Acc: 0.376
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.8826693
	speed: 0.1449s/iter; left time: 1659.5673s
Epoch: 26 cost time: 6.191983222961426
Epoch: 26, Steps: 154 | Train Loss: 1.212 Vali Loss: 2.674 Vali Acc: 0.318 Test Loss: 2.674 Test Acc: 0.318
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.0722500
	speed: 0.1435s/iter; left time: 1620.6971s
Epoch: 27 cost time: 6.335813522338867
Epoch: 27, Steps: 154 | Train Loss: 1.204 Vali Loss: 2.590 Vali Acc: 0.387 Test Loss: 2.590 Test Acc: 0.387
Validation loss decreased (-0.377512 --> -0.387241).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.0989783
	speed: 0.1393s/iter; left time: 1551.8568s
Epoch: 28 cost time: 6.021273374557495
Epoch: 28, Steps: 154 | Train Loss: 1.210 Vali Loss: 2.994 Vali Acc: 0.117 Test Loss: 2.994 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.4380167
	speed: 0.1391s/iter; left time: 1528.8038s
Epoch: 29 cost time: 6.131881237030029
Epoch: 29, Steps: 154 | Train Loss: 1.229 Vali Loss: 2.475 Vali Acc: 0.391 Test Loss: 2.475 Test Acc: 0.391
Validation loss decreased (-0.387241 --> -0.391297).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.9844010
	speed: 0.1412s/iter; left time: 1530.0191s
Epoch: 30 cost time: 6.527772903442383
Epoch: 30, Steps: 154 | Train Loss: 1.173 Vali Loss: 2.540 Vali Acc: 0.385 Test Loss: 2.540 Test Acc: 0.385
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.1891948
	speed: 0.1437s/iter; left time: 1534.7292s
Epoch: 31 cost time: 6.377674102783203
Epoch: 31, Steps: 154 | Train Loss: 1.221 Vali Loss: 2.577 Vali Acc: 0.345 Test Loss: 2.577 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.2691438
	speed: 0.1503s/iter; left time: 1581.9354s
Epoch: 32 cost time: 6.891726493835449
Epoch: 32, Steps: 154 | Train Loss: 1.150 Vali Loss: 2.764 Vali Acc: 0.223 Test Loss: 2.764 Test Acc: 0.223
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 1.0070909
	speed: 0.1490s/iter; left time: 1545.1581s
Epoch: 33 cost time: 6.7131054401397705
Epoch: 33, Steps: 154 | Train Loss: 1.135 Vali Loss: 2.721 Vali Acc: 0.203 Test Loss: 2.721 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 1.0970274
	speed: 0.1451s/iter; left time: 1482.5116s
Epoch: 34 cost time: 6.22229528427124
Epoch: 34, Steps: 154 | Train Loss: 1.128 Vali Loss: 3.024 Vali Acc: 0.217 Test Loss: 3.024 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 1.5818272
	speed: 0.1441s/iter; left time: 1450.3259s
Epoch: 35 cost time: 6.242626905441284
Epoch: 35, Steps: 154 | Train Loss: 1.111 Vali Loss: 2.641 Vali Acc: 0.207 Test Loss: 2.641 Test Acc: 0.207
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.9358582
	speed: 0.1411s/iter; left time: 1398.0131s
Epoch: 36 cost time: 6.189345836639404
Epoch: 36, Steps: 154 | Train Loss: 1.115 Vali Loss: 2.760 Vali Acc: 0.194 Test Loss: 2.760 Test Acc: 0.194
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.6248172
	speed: 0.1431s/iter; left time: 1395.8009s
Epoch: 37 cost time: 6.233251571655273
Epoch: 37, Steps: 154 | Train Loss: 1.082 Vali Loss: 2.790 Vali Acc: 0.111 Test Loss: 2.790 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 1.5819235
	speed: 0.1420s/iter; left time: 1363.2785s
Epoch: 38 cost time: 6.0604939460754395
Epoch: 38, Steps: 154 | Train Loss: 1.114 Vali Loss: 2.779 Vali Acc: 0.243 Test Loss: 2.779 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 1.3026434
	speed: 0.1410s/iter; left time: 1331.9273s
Epoch: 39 cost time: 6.109994649887085
Epoch: 39, Steps: 154 | Train Loss: 1.090 Vali Loss: 2.796 Vali Acc: 0.235 Test Loss: 2.796 Test Acc: 0.235
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3913219789132198
model parameter : 153374
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9801220
	speed: 0.0537s/iter; left time: 822.0596s
Epoch: 1 cost time: 7.488528728485107
Epoch: 1, Steps: 154 | Train Loss: 2.297 Vali Loss: 2.172 Vali Acc: 0.317 Test Loss: 2.172 Test Acc: 0.317
Validation loss decreased (inf --> -0.316686).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6842024
	speed: 0.1470s/iter; left time: 2227.2403s
Epoch: 2 cost time: 6.5559914112091064
Epoch: 2, Steps: 154 | Train Loss: 2.109 Vali Loss: 2.152 Vali Acc: 0.317 Test Loss: 2.152 Test Acc: 0.317
Validation loss decreased (-0.316686 --> -0.317091).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0661185
	speed: 0.1529s/iter; left time: 2292.6657s
Epoch: 3 cost time: 7.061558246612549
Epoch: 3, Steps: 154 | Train Loss: 2.034 Vali Loss: 2.134 Vali Acc: 0.320 Test Loss: 2.134 Test Acc: 0.320
Validation loss decreased (-0.317091 --> -0.319524).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1468010
	speed: 0.1520s/iter; left time: 2255.3321s
Epoch: 4 cost time: 6.586870908737183
Epoch: 4, Steps: 154 | Train Loss: 2.005 Vali Loss: 2.133 Vali Acc: 0.325 Test Loss: 2.133 Test Acc: 0.325
Validation loss decreased (-0.319524 --> -0.324796).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7655874
	speed: 0.1488s/iter; left time: 2184.4065s
Epoch: 5 cost time: 6.596513509750366
Epoch: 5, Steps: 154 | Train Loss: 1.937 Vali Loss: 2.132 Vali Acc: 0.323 Test Loss: 2.132 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7386637
	speed: 0.1397s/iter; left time: 2029.3247s
Epoch: 6 cost time: 6.204209089279175
Epoch: 6, Steps: 154 | Train Loss: 1.889 Vali Loss: 2.181 Vali Acc: 0.326 Test Loss: 2.181 Test Acc: 0.326
Validation loss decreased (-0.324796 --> -0.326418).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7573204
	speed: 0.1403s/iter; left time: 2017.7020s
Epoch: 7 cost time: 6.134567975997925
Epoch: 7, Steps: 154 | Train Loss: 1.845 Vali Loss: 2.181 Vali Acc: 0.332 Test Loss: 2.181 Test Acc: 0.332
Validation loss decreased (-0.326418 --> -0.332095).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6004024
	speed: 0.1437s/iter; left time: 2043.4902s
Epoch: 8 cost time: 6.3028905391693115
Epoch: 8, Steps: 154 | Train Loss: 1.785 Vali Loss: 2.189 Vali Acc: 0.335 Test Loss: 2.189 Test Acc: 0.335
Validation loss decreased (-0.332095 --> -0.334528).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3632200
	speed: 0.1420s/iter; left time: 1998.4616s
Epoch: 9 cost time: 6.451847553253174
Epoch: 9, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.226 Vali Acc: 0.339 Test Loss: 2.226 Test Acc: 0.339
Validation loss decreased (-0.334528 --> -0.338988).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7464553
	speed: 0.1444s/iter; left time: 2008.6353s
Epoch: 10 cost time: 6.280246734619141
Epoch: 10, Steps: 154 | Train Loss: 1.680 Vali Loss: 2.300 Vali Acc: 0.340 Test Loss: 2.300 Test Acc: 0.340
Validation loss decreased (-0.338988 --> -0.339799).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8238294
	speed: 0.1465s/iter; left time: 2016.5060s
Epoch: 11 cost time: 6.292212963104248
Epoch: 11, Steps: 154 | Train Loss: 1.652 Vali Loss: 2.287 Vali Acc: 0.339 Test Loss: 2.287 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8108797
	speed: 0.1460s/iter; left time: 1986.7391s
Epoch: 12 cost time: 6.639366149902344
Epoch: 12, Steps: 154 | Train Loss: 1.635 Vali Loss: 2.286 Vali Acc: 0.348 Test Loss: 2.286 Test Acc: 0.348
Validation loss decreased (-0.339799 --> -0.347503).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6530442
	speed: 0.1531s/iter; left time: 2059.6890s
Epoch: 13 cost time: 6.550335884094238
Epoch: 13, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.287 Vali Acc: 0.348 Test Loss: 2.287 Test Acc: 0.348
Validation loss decreased (-0.347503 --> -0.348315).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2363175
	speed: 0.1466s/iter; left time: 1950.1866s
Epoch: 14 cost time: 6.355166912078857
Epoch: 14, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.270 Vali Acc: 0.352 Test Loss: 2.270 Test Acc: 0.352
Validation loss decreased (-0.348315 --> -0.351964).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4494194
	speed: 0.1458s/iter; left time: 1915.9384s
Epoch: 15 cost time: 6.398172378540039
Epoch: 15, Steps: 154 | Train Loss: 1.568 Vali Loss: 2.299 Vali Acc: 0.356 Test Loss: 2.299 Test Acc: 0.356
Validation loss decreased (-0.351964 --> -0.356019).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5079490
	speed: 0.1448s/iter; left time: 1881.5856s
Epoch: 16 cost time: 6.535189628601074
Epoch: 16, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.257 Vali Acc: 0.359 Test Loss: 2.257 Test Acc: 0.359
Validation loss decreased (-0.356019 --> -0.358858).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.5421176
	speed: 0.1434s/iter; left time: 1841.0524s
Epoch: 17 cost time: 6.226528882980347
Epoch: 17, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.450 Vali Acc: 0.359 Test Loss: 2.450 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.9577985
	speed: 0.1429s/iter; left time: 1812.5881s
Epoch: 18 cost time: 6.05311131477356
Epoch: 18, Steps: 154 | Train Loss: 1.498 Vali Loss: 2.357 Vali Acc: 0.360 Test Loss: 2.357 Test Acc: 0.360
Validation loss decreased (-0.358858 --> -0.359668).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.4213274
	speed: 0.1436s/iter; left time: 1798.8568s
Epoch: 19 cost time: 6.588327884674072
Epoch: 19, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.439 Vali Acc: 0.361 Test Loss: 2.439 Test Acc: 0.361
Validation loss decreased (-0.359668 --> -0.360884).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.4255795
	speed: 0.1422s/iter; left time: 1759.2124s
Epoch: 20 cost time: 6.180774927139282
Epoch: 20, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.471 Vali Acc: 0.362 Test Loss: 2.471 Test Acc: 0.362
Validation loss decreased (-0.360884 --> -0.362100).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.5520219
	speed: 0.1465s/iter; left time: 1790.7157s
Epoch: 21 cost time: 6.300207138061523
Epoch: 21, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.451 Vali Acc: 0.364 Test Loss: 2.451 Test Acc: 0.364
Validation loss decreased (-0.362100 --> -0.363722).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.9370791
	speed: 0.1455s/iter; left time: 1756.2628s
Epoch: 22 cost time: 6.241617202758789
Epoch: 22, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.483 Vali Acc: 0.363 Test Loss: 2.483 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.5246371
	speed: 0.1422s/iter; left time: 1694.3718s
Epoch: 23 cost time: 6.170262098312378
Epoch: 23, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.564 Vali Acc: 0.365 Test Loss: 2.564 Test Acc: 0.365
Validation loss decreased (-0.363722 --> -0.365343).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.7097372
	speed: 0.1452s/iter; left time: 1707.0177s
Epoch: 24 cost time: 6.399735927581787
Epoch: 24, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.565 Vali Acc: 0.366 Test Loss: 2.565 Test Acc: 0.366
Validation loss decreased (-0.365343 --> -0.366154).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.2135663
	speed: 0.1425s/iter; left time: 1653.2381s
Epoch: 25 cost time: 6.436944961547852
Epoch: 25, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.526 Vali Acc: 0.363 Test Loss: 2.526 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.1719778
	speed: 0.1493s/iter; left time: 1709.2241s
Epoch: 26 cost time: 6.520266532897949
Epoch: 26, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.575 Vali Acc: 0.369 Test Loss: 2.575 Test Acc: 0.369
Validation loss decreased (-0.366154 --> -0.369398).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.0648389
	speed: 0.1506s/iter; left time: 1701.4108s
Epoch: 27 cost time: 6.7036590576171875
Epoch: 27, Steps: 154 | Train Loss: 1.361 Vali Loss: 2.525 Vali Acc: 0.366 Test Loss: 2.525 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.9532584
	speed: 0.1424s/iter; left time: 1586.7708s
Epoch: 28 cost time: 6.419318437576294
Epoch: 28, Steps: 154 | Train Loss: 1.325 Vali Loss: 2.726 Vali Acc: 0.203 Test Loss: 2.726 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.1854612
	speed: 0.1422s/iter; left time: 1562.7953s
Epoch: 29 cost time: 6.297271490097046
Epoch: 29, Steps: 154 | Train Loss: 1.319 Vali Loss: 2.643 Vali Acc: 0.364 Test Loss: 2.643 Test Acc: 0.364
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.5527940
	speed: 0.1442s/iter; left time: 1562.7398s
Epoch: 30 cost time: 6.025084733963013
Epoch: 30, Steps: 154 | Train Loss: 1.266 Vali Loss: 2.681 Vali Acc: 0.376 Test Loss: 2.681 Test Acc: 0.376
Validation loss decreased (-0.369398 --> -0.375480).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.9846554
	speed: 0.1385s/iter; left time: 1478.8441s
Epoch: 31 cost time: 6.332422733306885
Epoch: 31, Steps: 154 | Train Loss: 1.341 Vali Loss: 2.798 Vali Acc: 0.202 Test Loss: 2.798 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.8567804
	speed: 0.1408s/iter; left time: 1482.1714s
Epoch: 32 cost time: 6.048354148864746
Epoch: 32, Steps: 154 | Train Loss: 1.306 Vali Loss: 2.762 Vali Acc: 0.201 Test Loss: 2.762 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 1.0019954
	speed: 0.1389s/iter; left time: 1440.4312s
Epoch: 33 cost time: 5.895528793334961
Epoch: 33, Steps: 154 | Train Loss: 1.279 Vali Loss: 2.683 Vali Acc: 0.214 Test Loss: 2.683 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 1.6422710
	speed: 0.1356s/iter; left time: 1385.2827s
Epoch: 34 cost time: 6.250114679336548
Epoch: 34, Steps: 154 | Train Loss: 1.267 Vali Loss: 2.693 Vali Acc: 0.367 Test Loss: 2.693 Test Acc: 0.367
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 1.1598868
	speed: 0.1495s/iter; left time: 1504.9012s
Epoch: 35 cost time: 6.47033429145813
Epoch: 35, Steps: 154 | Train Loss: 1.246 Vali Loss: 2.790 Vali Acc: 0.367 Test Loss: 2.790 Test Acc: 0.367
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 1.4747777
	speed: 0.1500s/iter; left time: 1486.8612s
Epoch: 36 cost time: 6.3855578899383545
Epoch: 36, Steps: 154 | Train Loss: 1.215 Vali Loss: 2.763 Vali Acc: 0.356 Test Loss: 2.763 Test Acc: 0.356
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.9662496
	speed: 0.1479s/iter; left time: 1442.8139s
Epoch: 37 cost time: 6.911789417266846
Epoch: 37, Steps: 154 | Train Loss: 1.233 Vali Loss: 2.728 Vali Acc: 0.373 Test Loss: 2.728 Test Acc: 0.373
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 1.1120825
	speed: 0.1528s/iter; left time: 1466.9354s
Epoch: 38 cost time: 6.315684080123901
Epoch: 38, Steps: 154 | Train Loss: 1.278 Vali Loss: 2.770 Vali Acc: 0.241 Test Loss: 2.770 Test Acc: 0.241
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 1.6369827
	speed: 0.1415s/iter; left time: 1337.0350s
Epoch: 39 cost time: 6.085828065872192
Epoch: 39, Steps: 154 | Train Loss: 1.218 Vali Loss: 2.876 Vali Acc: 0.197 Test Loss: 2.876 Test Acc: 0.197
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.9739676
	speed: 0.1387s/iter; left time: 1289.6275s
Epoch: 40 cost time: 6.025232553482056
Epoch: 40, Steps: 154 | Train Loss: 1.213 Vali Loss: 2.874 Vali Acc: 0.360 Test Loss: 2.874 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37550689375506896
model parameter : 87838
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9796215
	speed: 0.0541s/iter; left time: 828.2088s
Epoch: 1 cost time: 7.294399976730347
Epoch: 1, Steps: 154 | Train Loss: 2.293 Vali Loss: 2.171 Vali Acc: 0.317 Test Loss: 2.171 Test Acc: 0.317
Validation loss decreased (inf --> -0.316686).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6713502
	speed: 0.1369s/iter; left time: 2073.7191s
Epoch: 2 cost time: 6.018388509750366
Epoch: 2, Steps: 154 | Train Loss: 2.105 Vali Loss: 2.153 Vali Acc: 0.316 Test Loss: 2.153 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0491443
	speed: 0.1305s/iter; left time: 1957.0301s
Epoch: 3 cost time: 5.780518054962158
Epoch: 3, Steps: 154 | Train Loss: 2.041 Vali Loss: 2.133 Vali Acc: 0.320 Test Loss: 2.133 Test Acc: 0.320
Validation loss decreased (-0.316686 --> -0.319930).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1713922
	speed: 0.1481s/iter; left time: 2197.2939s
Epoch: 4 cost time: 6.46803879737854
Epoch: 4, Steps: 154 | Train Loss: 2.006 Vali Loss: 2.138 Vali Acc: 0.324 Test Loss: 2.138 Test Acc: 0.324
Validation loss decreased (-0.319930 --> -0.323580).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8066142
	speed: 0.1448s/iter; left time: 2126.0522s
Epoch: 5 cost time: 6.372791051864624
Epoch: 5, Steps: 154 | Train Loss: 1.942 Vali Loss: 2.133 Vali Acc: 0.324 Test Loss: 2.133 Test Acc: 0.324
Validation loss decreased (-0.323580 --> -0.323985).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7316200
	speed: 0.1468s/iter; left time: 2133.7674s
Epoch: 6 cost time: 6.249258518218994
Epoch: 6, Steps: 154 | Train Loss: 1.873 Vali Loss: 2.184 Vali Acc: 0.327 Test Loss: 2.184 Test Acc: 0.327
Validation loss decreased (-0.323985 --> -0.326823).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7181332
	speed: 0.1442s/iter; left time: 2073.3417s
Epoch: 7 cost time: 6.322704792022705
Epoch: 7, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.164 Vali Acc: 0.331 Test Loss: 2.164 Test Acc: 0.331
Validation loss decreased (-0.326823 --> -0.331284).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6870786
	speed: 0.1377s/iter; left time: 1958.8543s
Epoch: 8 cost time: 5.907901048660278
Epoch: 8, Steps: 154 | Train Loss: 1.779 Vali Loss: 2.171 Vali Acc: 0.336 Test Loss: 2.171 Test Acc: 0.336
Validation loss decreased (-0.331284 --> -0.335745).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4890668
	speed: 0.1377s/iter; left time: 1937.9761s
Epoch: 9 cost time: 5.771650075912476
Epoch: 9, Steps: 154 | Train Loss: 1.727 Vali Loss: 2.205 Vali Acc: 0.343 Test Loss: 2.205 Test Acc: 0.343
Validation loss decreased (-0.335745 --> -0.343449).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8269950
	speed: 0.1373s/iter; left time: 1910.5194s
Epoch: 10 cost time: 6.173280477523804
Epoch: 10, Steps: 154 | Train Loss: 1.686 Vali Loss: 2.305 Vali Acc: 0.342 Test Loss: 2.305 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.8454204
	speed: 0.1403s/iter; left time: 1930.8603s
Epoch: 11 cost time: 5.967687368392944
Epoch: 11, Steps: 154 | Train Loss: 1.654 Vali Loss: 2.286 Vali Acc: 0.343 Test Loss: 2.286 Test Acc: 0.343
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.8103176
	speed: 0.1407s/iter; left time: 1914.6463s
Epoch: 12 cost time: 5.972432851791382
Epoch: 12, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.257 Vali Acc: 0.349 Test Loss: 2.257 Test Acc: 0.349
Validation loss decreased (-0.343449 --> -0.348720).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6043228
	speed: 0.1394s/iter; left time: 1874.9833s
Epoch: 13 cost time: 6.292158126831055
Epoch: 13, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.303 Vali Acc: 0.347 Test Loss: 2.303 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.2589046
	speed: 0.1358s/iter; left time: 1805.4404s
Epoch: 14 cost time: 5.755564212799072
Epoch: 14, Steps: 154 | Train Loss: 1.605 Vali Loss: 2.222 Vali Acc: 0.353 Test Loss: 2.222 Test Acc: 0.353
Validation loss decreased (-0.348720 --> -0.353181).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4947376
	speed: 0.1446s/iter; left time: 1901.3920s
Epoch: 15 cost time: 6.3084399700164795
Epoch: 15, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.260 Vali Acc: 0.355 Test Loss: 2.260 Test Acc: 0.355
Validation loss decreased (-0.353181 --> -0.355209).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.6152041
	speed: 0.1461s/iter; left time: 1897.5585s
Epoch: 16 cost time: 6.6024158000946045
Epoch: 16, Steps: 154 | Train Loss: 1.552 Vali Loss: 2.270 Vali Acc: 0.356 Test Loss: 2.270 Test Acc: 0.356
Validation loss decreased (-0.355209 --> -0.356019).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.5053682
	speed: 0.1464s/iter; left time: 1879.2695s
Epoch: 17 cost time: 6.11449933052063
Epoch: 17, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.383 Vali Acc: 0.356 Test Loss: 2.383 Test Acc: 0.356
Validation loss decreased (-0.356019 --> -0.356424).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.9875530
	speed: 0.1462s/iter; left time: 1853.6849s
Epoch: 18 cost time: 6.189769983291626
Epoch: 18, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.355 Vali Acc: 0.354 Test Loss: 2.355 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.3812429
	speed: 0.1388s/iter; left time: 1739.2843s
Epoch: 19 cost time: 5.966679573059082
Epoch: 19, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.433 Vali Acc: 0.355 Test Loss: 2.433 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.4042065
	speed: 0.1403s/iter; left time: 1735.7563s
Epoch: 20 cost time: 6.028674602508545
Epoch: 20, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.472 Vali Acc: 0.221 Test Loss: 2.472 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.4967595
	speed: 0.1390s/iter; left time: 1699.1784s
Epoch: 21 cost time: 6.213781118392944
Epoch: 21, Steps: 154 | Train Loss: 1.420 Vali Loss: 2.409 Vali Acc: 0.363 Test Loss: 2.409 Test Acc: 0.363
Validation loss decreased (-0.356424 --> -0.362506).  Saving model ...
	iters: 100, epoch: 22 | loss: 2.0794706
	speed: 0.1407s/iter; left time: 1697.4037s
Epoch: 22 cost time: 6.393376588821411
Epoch: 22, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.489 Vali Acc: 0.364 Test Loss: 2.489 Test Acc: 0.364
Validation loss decreased (-0.362506 --> -0.363722).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.6120121
	speed: 0.1431s/iter; left time: 1704.4222s
Epoch: 23 cost time: 6.167523145675659
Epoch: 23, Steps: 154 | Train Loss: 1.415 Vali Loss: 2.480 Vali Acc: 0.365 Test Loss: 2.480 Test Acc: 0.365
Validation loss decreased (-0.363722 --> -0.364939).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.7277305
	speed: 0.1402s/iter; left time: 1648.8546s
Epoch: 24 cost time: 5.893331527709961
Epoch: 24, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.509 Vali Acc: 0.214 Test Loss: 2.509 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.1672373
	speed: 0.1369s/iter; left time: 1588.5703s
Epoch: 25 cost time: 5.955303907394409
Epoch: 25, Steps: 154 | Train Loss: 1.364 Vali Loss: 2.503 Vali Acc: 0.256 Test Loss: 2.503 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.0517316
	speed: 0.1416s/iter; left time: 1621.7515s
Epoch: 26 cost time: 6.02540135383606
Epoch: 26, Steps: 154 | Train Loss: 1.402 Vali Loss: 2.538 Vali Acc: 0.357 Test Loss: 2.538 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.1381646
	speed: 0.1424s/iter; left time: 1608.8487s
Epoch: 27 cost time: 6.059295415878296
Epoch: 27, Steps: 154 | Train Loss: 1.368 Vali Loss: 2.578 Vali Acc: 0.363 Test Loss: 2.578 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.9985430
	speed: 0.1443s/iter; left time: 1607.5710s
Epoch: 28 cost time: 6.542654514312744
Epoch: 28, Steps: 154 | Train Loss: 1.326 Vali Loss: 2.595 Vali Acc: 0.221 Test Loss: 2.595 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 1.0202115
	speed: 0.1492s/iter; left time: 1639.3183s
Epoch: 29 cost time: 6.281498670578003
Epoch: 29, Steps: 154 | Train Loss: 1.311 Vali Loss: 2.710 Vali Acc: 0.200 Test Loss: 2.710 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 1.5696999
	speed: 0.1449s/iter; left time: 1569.6889s
Epoch: 30 cost time: 6.405883312225342
Epoch: 30, Steps: 154 | Train Loss: 1.285 Vali Loss: 2.732 Vali Acc: 0.211 Test Loss: 2.732 Test Acc: 0.211
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 1.2676206
	speed: 0.1416s/iter; left time: 1512.1000s
Epoch: 31 cost time: 5.989872455596924
Epoch: 31, Steps: 154 | Train Loss: 1.327 Vali Loss: 2.676 Vali Acc: 0.212 Test Loss: 2.676 Test Acc: 0.212
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.9365979
	speed: 0.1441s/iter; left time: 1517.4044s
Epoch: 32 cost time: 6.1280739307403564
Epoch: 32, Steps: 154 | Train Loss: 1.273 Vali Loss: 2.807 Vali Acc: 0.203 Test Loss: 2.807 Test Acc: 0.203
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.9415989
	speed: 0.1387s/iter; left time: 1438.4255s
Epoch: 33 cost time: 6.197765588760376
Epoch: 33, Steps: 154 | Train Loss: 1.254 Vali Loss: 2.677 Vali Acc: 0.212 Test Loss: 2.677 Test Acc: 0.212
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36496350364963503
model parameter : 87838
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0198505
	speed: 0.0555s/iter; left time: 849.7542s
Epoch: 1 cost time: 7.606096982955933
Epoch: 1, Steps: 154 | Train Loss: 2.289 Vali Loss: 2.172 Vali Acc: 0.316 Test Loss: 2.172 Test Acc: 0.316
Validation loss decreased (inf --> -0.315874).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6419365
	speed: 0.1406s/iter; left time: 2130.0029s
Epoch: 2 cost time: 6.12773060798645
Epoch: 2, Steps: 154 | Train Loss: 2.102 Vali Loss: 2.153 Vali Acc: 0.316 Test Loss: 2.153 Test Acc: 0.316
Validation loss decreased (-0.315874 --> -0.316280).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0527797
	speed: 0.1353s/iter; left time: 2028.7629s
Epoch: 3 cost time: 6.2336602210998535
Epoch: 3, Steps: 154 | Train Loss: 2.030 Vali Loss: 2.125 Vali Acc: 0.319 Test Loss: 2.125 Test Acc: 0.319
Validation loss decreased (-0.316280 --> -0.319119).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1727190
	speed: 0.1512s/iter; left time: 2243.2757s
Epoch: 4 cost time: 6.418085098266602
Epoch: 4, Steps: 154 | Train Loss: 1.999 Vali Loss: 2.130 Vali Acc: 0.323 Test Loss: 2.130 Test Acc: 0.323
Validation loss decreased (-0.319119 --> -0.323174).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7948501
	speed: 0.1477s/iter; left time: 2168.7597s
Epoch: 5 cost time: 6.41821813583374
Epoch: 5, Steps: 154 | Train Loss: 1.937 Vali Loss: 2.133 Vali Acc: 0.323 Test Loss: 2.133 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7947669
	speed: 0.1395s/iter; left time: 2027.0395s
Epoch: 6 cost time: 6.017916202545166
Epoch: 6, Steps: 154 | Train Loss: 1.874 Vali Loss: 2.162 Vali Acc: 0.324 Test Loss: 2.162 Test Acc: 0.324
Validation loss decreased (-0.323174 --> -0.324390).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8250070
	speed: 0.1418s/iter; left time: 2039.2047s
Epoch: 7 cost time: 5.8520214557647705
Epoch: 7, Steps: 154 | Train Loss: 1.836 Vali Loss: 2.161 Vali Acc: 0.332 Test Loss: 2.161 Test Acc: 0.332
Validation loss decreased (-0.324390 --> -0.331690).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7050872
	speed: 0.1395s/iter; left time: 1983.9188s
Epoch: 8 cost time: 6.257477760314941
Epoch: 8, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.155 Vali Acc: 0.338 Test Loss: 2.155 Test Acc: 0.338
Validation loss decreased (-0.331690 --> -0.338178).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4068258
	speed: 0.1374s/iter; left time: 1933.2235s
Epoch: 9 cost time: 5.77392578125
Epoch: 9, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.198 Vali Acc: 0.344 Test Loss: 2.198 Test Acc: 0.344
Validation loss decreased (-0.338178 --> -0.343855).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8368881
	speed: 0.1355s/iter; left time: 1885.1562s
Epoch: 10 cost time: 5.887121915817261
Epoch: 10, Steps: 154 | Train Loss: 1.683 Vali Loss: 2.254 Vali Acc: 0.341 Test Loss: 2.254 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.7964290
	speed: 0.1379s/iter; left time: 1897.2941s
Epoch: 11 cost time: 5.867751598358154
Epoch: 11, Steps: 154 | Train Loss: 1.663 Vali Loss: 2.267 Vali Acc: 0.347 Test Loss: 2.267 Test Acc: 0.347
Validation loss decreased (-0.343855 --> -0.347098).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8111281
	speed: 0.1399s/iter; left time: 1904.1584s
Epoch: 12 cost time: 6.01022744178772
Epoch: 12, Steps: 154 | Train Loss: 1.633 Vali Loss: 2.216 Vali Acc: 0.349 Test Loss: 2.216 Test Acc: 0.349
Validation loss decreased (-0.347098 --> -0.348721).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5683360
	speed: 0.1452s/iter; left time: 1954.0364s
Epoch: 13 cost time: 6.472426891326904
Epoch: 13, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.279 Vali Acc: 0.351 Test Loss: 2.279 Test Acc: 0.351
Validation loss decreased (-0.348721 --> -0.351153).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.1092927
	speed: 0.1480s/iter; left time: 1968.3611s
Epoch: 14 cost time: 6.872363090515137
Epoch: 14, Steps: 154 | Train Loss: 1.585 Vali Loss: 2.230 Vali Acc: 0.354 Test Loss: 2.230 Test Acc: 0.354
Validation loss decreased (-0.351153 --> -0.353992).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4171782
	speed: 0.1491s/iter; left time: 1959.3334s
Epoch: 15 cost time: 6.309095859527588
Epoch: 15, Steps: 154 | Train Loss: 1.572 Vali Loss: 2.224 Vali Acc: 0.354 Test Loss: 2.224 Test Acc: 0.354
Validation loss decreased (-0.353992 --> -0.354398).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5224183
	speed: 0.1505s/iter; left time: 1954.7325s
Epoch: 16 cost time: 6.633086442947388
Epoch: 16, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.215 Vali Acc: 0.360 Test Loss: 2.215 Test Acc: 0.360
Validation loss decreased (-0.354398 --> -0.359670).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.3446044
	speed: 0.1452s/iter; left time: 1863.3783s
Epoch: 17 cost time: 6.150793075561523
Epoch: 17, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.291 Vali Acc: 0.360 Test Loss: 2.291 Test Acc: 0.360
Validation loss decreased (-0.359670 --> -0.360074).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.2629868
	speed: 0.1427s/iter; left time: 1809.7191s
Epoch: 18 cost time: 5.96691632270813
Epoch: 18, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.287 Vali Acc: 0.367 Test Loss: 2.287 Test Acc: 0.367
Validation loss decreased (-0.360074 --> -0.366968).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.5095544
	speed: 0.1435s/iter; left time: 1798.0018s
Epoch: 19 cost time: 6.209904670715332
Epoch: 19, Steps: 154 | Train Loss: 1.479 Vali Loss: 2.355 Vali Acc: 0.361 Test Loss: 2.355 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.5024956
	speed: 0.1388s/iter; left time: 1717.4733s
Epoch: 20 cost time: 5.979370355606079
Epoch: 20, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.331 Vali Acc: 0.364 Test Loss: 2.331 Test Acc: 0.364
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.6336179
	speed: 0.1410s/iter; left time: 1723.1218s
Epoch: 21 cost time: 5.941984415054321
Epoch: 21, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.358 Vali Acc: 0.367 Test Loss: 2.358 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 2.0629683
	speed: 0.1454s/iter; left time: 1753.9591s
Epoch: 22 cost time: 6.6028828620910645
Epoch: 22, Steps: 154 | Train Loss: 1.399 Vali Loss: 2.410 Vali Acc: 0.358 Test Loss: 2.410 Test Acc: 0.358
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.3959781
	speed: 0.1410s/iter; left time: 1680.1557s
Epoch: 23 cost time: 6.170179605484009
Epoch: 23, Steps: 154 | Train Loss: 1.356 Vali Loss: 2.409 Vali Acc: 0.367 Test Loss: 2.409 Test Acc: 0.367
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.5705107
	speed: 0.1500s/iter; left time: 1763.5639s
Epoch: 24 cost time: 6.702022552490234
Epoch: 24, Steps: 154 | Train Loss: 1.332 Vali Loss: 2.369 Vali Acc: 0.367 Test Loss: 2.369 Test Acc: 0.367
Validation loss decreased (-0.366968 --> -0.367373).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.1759897
	speed: 0.1483s/iter; left time: 1721.3373s
Epoch: 25 cost time: 6.2808098793029785
Epoch: 25, Steps: 154 | Train Loss: 1.331 Vali Loss: 2.425 Vali Acc: 0.363 Test Loss: 2.425 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.9688456
	speed: 0.1399s/iter; left time: 1602.0774s
Epoch: 26 cost time: 6.219715595245361
Epoch: 26, Steps: 154 | Train Loss: 1.302 Vali Loss: 2.344 Vali Acc: 0.380 Test Loss: 2.344 Test Acc: 0.380
Validation loss decreased (-0.367373 --> -0.379944).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.1346282
	speed: 0.1413s/iter; left time: 1596.1333s
Epoch: 27 cost time: 6.255982160568237
Epoch: 27, Steps: 154 | Train Loss: 1.333 Vali Loss: 2.477 Vali Acc: 0.368 Test Loss: 2.477 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.9265839
	speed: 0.1459s/iter; left time: 1626.0146s
Epoch: 28 cost time: 6.129798650741577
Epoch: 28, Steps: 154 | Train Loss: 1.296 Vali Loss: 2.507 Vali Acc: 0.367 Test Loss: 2.507 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.1486676
	speed: 0.1417s/iter; left time: 1557.4498s
Epoch: 29 cost time: 6.262197256088257
Epoch: 29, Steps: 154 | Train Loss: 1.272 Vali Loss: 2.501 Vali Acc: 0.346 Test Loss: 2.501 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.3564093
	speed: 0.1441s/iter; left time: 1561.1138s
Epoch: 30 cost time: 6.176724672317505
Epoch: 30, Steps: 154 | Train Loss: 1.282 Vali Loss: 2.606 Vali Acc: 0.367 Test Loss: 2.606 Test Acc: 0.367
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 1.1284428
	speed: 0.1434s/iter; left time: 1531.9614s
Epoch: 31 cost time: 6.196916818618774
Epoch: 31, Steps: 154 | Train Loss: 1.267 Vali Loss: 2.526 Vali Acc: 0.360 Test Loss: 2.526 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.9033319
	speed: 0.1409s/iter; left time: 1483.0809s
Epoch: 32 cost time: 6.2120630741119385
Epoch: 32, Steps: 154 | Train Loss: 1.253 Vali Loss: 2.718 Vali Acc: 0.210 Test Loss: 2.718 Test Acc: 0.210
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 1.5776832
	speed: 0.1427s/iter; left time: 1480.6322s
Epoch: 33 cost time: 6.082144021987915
Epoch: 33, Steps: 154 | Train Loss: 1.260 Vali Loss: 2.579 Vali Acc: 0.237 Test Loss: 2.579 Test Acc: 0.237
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 1.5232360
	speed: 0.1399s/iter; left time: 1429.7454s
Epoch: 34 cost time: 6.413679838180542
Epoch: 34, Steps: 154 | Train Loss: 1.230 Vali Loss: 2.454 Vali Acc: 0.375 Test Loss: 2.454 Test Acc: 0.375
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 1.1007837
	speed: 0.1437s/iter; left time: 1446.6846s
Epoch: 35 cost time: 6.179405689239502
Epoch: 35, Steps: 154 | Train Loss: 1.207 Vali Loss: 2.634 Vali Acc: 0.366 Test Loss: 2.634 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 1.6214101
	speed: 0.1421s/iter; left time: 1408.1762s
Epoch: 36 cost time: 6.106706380844116
Epoch: 36, Steps: 154 | Train Loss: 1.189 Vali Loss: 2.538 Vali Acc: 0.371 Test Loss: 2.538 Test Acc: 0.371
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 87838
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0037560
	speed: 0.0570s/iter; left time: 871.6627s
Epoch: 1 cost time: 7.94356894493103
Epoch: 1, Steps: 154 | Train Loss: 2.263 Vali Loss: 2.159 Vali Acc: 0.315 Test Loss: 2.159 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6999584
	speed: 0.1456s/iter; left time: 2205.6639s
Epoch: 2 cost time: 6.020903825759888
Epoch: 2, Steps: 154 | Train Loss: 2.086 Vali Loss: 2.163 Vali Acc: 0.316 Test Loss: 2.163 Test Acc: 0.316
Validation loss decreased (-0.315469 --> -0.315875).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1011865
	speed: 0.1409s/iter; left time: 2112.5613s
Epoch: 3 cost time: 6.391502618789673
Epoch: 3, Steps: 154 | Train Loss: 2.011 Vali Loss: 2.141 Vali Acc: 0.319 Test Loss: 2.141 Test Acc: 0.319
Validation loss decreased (-0.315875 --> -0.319119).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0952263
	speed: 0.1410s/iter; left time: 2092.1274s
Epoch: 4 cost time: 6.105114936828613
Epoch: 4, Steps: 154 | Train Loss: 1.964 Vali Loss: 2.148 Vali Acc: 0.325 Test Loss: 2.148 Test Acc: 0.325
Validation loss decreased (-0.319119 --> -0.325202).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7312093
	speed: 0.1390s/iter; left time: 2041.6829s
Epoch: 5 cost time: 5.786938905715942
Epoch: 5, Steps: 154 | Train Loss: 1.902 Vali Loss: 2.211 Vali Acc: 0.328 Test Loss: 2.211 Test Acc: 0.328
Validation loss decreased (-0.325202 --> -0.327634).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6098348
	speed: 0.1303s/iter; left time: 1893.9589s
Epoch: 6 cost time: 5.5791356563568115
Epoch: 6, Steps: 154 | Train Loss: 1.833 Vali Loss: 2.308 Vali Acc: 0.327 Test Loss: 2.308 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7758564
	speed: 0.1247s/iter; left time: 1792.5578s
Epoch: 7 cost time: 5.6670122146606445
Epoch: 7, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.292 Vali Acc: 0.335 Test Loss: 2.292 Test Acc: 0.335
Validation loss decreased (-0.327634 --> -0.335338).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6516341
	speed: 0.1345s/iter; left time: 1913.2411s
Epoch: 8 cost time: 5.948084354400635
Epoch: 8, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.238 Vali Acc: 0.340 Test Loss: 2.238 Test Acc: 0.340
Validation loss decreased (-0.335338 --> -0.340205).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3641845
	speed: 0.1405s/iter; left time: 1976.4222s
Epoch: 9 cost time: 6.622365236282349
Epoch: 9, Steps: 154 | Train Loss: 1.656 Vali Loss: 2.400 Vali Acc: 0.348 Test Loss: 2.400 Test Acc: 0.348
Validation loss decreased (-0.340205 --> -0.347908).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9656895
	speed: 0.1459s/iter; left time: 2030.1045s
Epoch: 10 cost time: 6.532762765884399
Epoch: 10, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.279 Vali Acc: 0.349 Test Loss: 2.279 Test Acc: 0.349
Validation loss decreased (-0.347908 --> -0.348720).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6393461
	speed: 0.1481s/iter; left time: 2037.6989s
Epoch: 11 cost time: 6.440826892852783
Epoch: 11, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.422 Vali Acc: 0.357 Test Loss: 2.422 Test Acc: 0.357
Validation loss decreased (-0.348720 --> -0.357234).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6941701
	speed: 0.1426s/iter; left time: 1939.9079s
Epoch: 12 cost time: 6.571497917175293
Epoch: 12, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.272 Vali Acc: 0.360 Test Loss: 2.272 Test Acc: 0.360
Validation loss decreased (-0.357234 --> -0.359669).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4355073
	speed: 0.1429s/iter; left time: 1922.1817s
Epoch: 13 cost time: 6.073224306106567
Epoch: 13, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.386 Vali Acc: 0.359 Test Loss: 2.386 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1695069
	speed: 0.1391s/iter; left time: 1849.3874s
Epoch: 14 cost time: 5.93586277961731
Epoch: 14, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.280 Vali Acc: 0.361 Test Loss: 2.280 Test Acc: 0.361
Validation loss decreased (-0.359669 --> -0.360480).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4367564
	speed: 0.1396s/iter; left time: 1835.3032s
Epoch: 15 cost time: 5.870759963989258
Epoch: 15, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.259 Vali Acc: 0.367 Test Loss: 2.259 Test Acc: 0.367
Validation loss decreased (-0.360480 --> -0.366563).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5415678
	speed: 0.1390s/iter; left time: 1806.2025s
Epoch: 16 cost time: 5.939166307449341
Epoch: 16, Steps: 154 | Train Loss: 1.421 Vali Loss: 2.417 Vali Acc: 0.371 Test Loss: 2.417 Test Acc: 0.371
Validation loss decreased (-0.366563 --> -0.370617).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.3473175
	speed: 0.1378s/iter; left time: 1768.8942s
Epoch: 17 cost time: 6.046563625335693
Epoch: 17, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.307 Vali Acc: 0.374 Test Loss: 2.307 Test Acc: 0.374
Validation loss decreased (-0.370617 --> -0.373862).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.1195667
	speed: 0.1377s/iter; left time: 1746.9066s
Epoch: 18 cost time: 6.006186246871948
Epoch: 18, Steps: 154 | Train Loss: 1.404 Vali Loss: 2.287 Vali Acc: 0.381 Test Loss: 2.287 Test Acc: 0.381
Validation loss decreased (-0.373862 --> -0.380756).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.2884457
	speed: 0.1409s/iter; left time: 1765.3439s
Epoch: 19 cost time: 6.12270712852478
Epoch: 19, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.395 Vali Acc: 0.368 Test Loss: 2.395 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.3491096
	speed: 0.1460s/iter; left time: 1807.1484s
Epoch: 20 cost time: 6.567556619644165
Epoch: 20, Steps: 154 | Train Loss: 1.343 Vali Loss: 2.338 Vali Acc: 0.373 Test Loss: 2.338 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.4191163
	speed: 0.1439s/iter; left time: 1759.1313s
Epoch: 21 cost time: 6.297738313674927
Epoch: 21, Steps: 154 | Train Loss: 1.314 Vali Loss: 2.263 Vali Acc: 0.370 Test Loss: 2.263 Test Acc: 0.370
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.6697648
	speed: 0.1474s/iter; left time: 1779.0737s
Epoch: 22 cost time: 6.516007423400879
Epoch: 22, Steps: 154 | Train Loss: 1.286 Vali Loss: 2.321 Vali Acc: 0.366 Test Loss: 2.321 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.2785428
	speed: 0.1423s/iter; left time: 1695.7925s
Epoch: 23 cost time: 6.342479467391968
Epoch: 23, Steps: 154 | Train Loss: 1.309 Vali Loss: 2.436 Vali Acc: 0.378 Test Loss: 2.436 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.5225253
	speed: 0.1433s/iter; left time: 1684.8687s
Epoch: 24 cost time: 6.032277584075928
Epoch: 24, Steps: 154 | Train Loss: 1.274 Vali Loss: 2.205 Vali Acc: 0.377 Test Loss: 2.205 Test Acc: 0.377
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.0813127
	speed: 0.1415s/iter; left time: 1641.9474s
Epoch: 25 cost time: 5.973120212554932
Epoch: 25, Steps: 154 | Train Loss: 1.230 Vali Loss: 2.368 Vali Acc: 0.374 Test Loss: 2.368 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.9300674
	speed: 0.1363s/iter; left time: 1560.2441s
Epoch: 26 cost time: 6.1033148765563965
Epoch: 26, Steps: 154 | Train Loss: 1.261 Vali Loss: 2.211 Vali Acc: 0.389 Test Loss: 2.211 Test Acc: 0.389
Validation loss decreased (-0.380756 --> -0.389272).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.1273193
	speed: 0.1419s/iter; left time: 1603.1699s
Epoch: 27 cost time: 5.999873161315918
Epoch: 27, Steps: 154 | Train Loss: 1.221 Vali Loss: 2.239 Vali Acc: 0.374 Test Loss: 2.239 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.9901716
	speed: 0.1423s/iter; left time: 1585.9756s
Epoch: 28 cost time: 6.211723327636719
Epoch: 28, Steps: 154 | Train Loss: 1.206 Vali Loss: 2.211 Vali Acc: 0.392 Test Loss: 2.211 Test Acc: 0.392
Validation loss decreased (-0.389272 --> -0.391705).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.1391650
	speed: 0.1382s/iter; left time: 1518.7460s
Epoch: 29 cost time: 6.029229640960693
Epoch: 29, Steps: 154 | Train Loss: 1.198 Vali Loss: 2.354 Vali Acc: 0.348 Test Loss: 2.354 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.5756733
	speed: 0.1404s/iter; left time: 1521.1051s
Epoch: 30 cost time: 5.867634296417236
Epoch: 30, Steps: 154 | Train Loss: 1.199 Vali Loss: 2.307 Vali Acc: 0.375 Test Loss: 2.307 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.9680206
	speed: 0.1426s/iter; left time: 1522.5814s
Epoch: 31 cost time: 6.191407680511475
Epoch: 31, Steps: 154 | Train Loss: 1.169 Vali Loss: 2.360 Vali Acc: 0.391 Test Loss: 2.360 Test Acc: 0.391
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.8053474
	speed: 0.1381s/iter; left time: 1453.3828s
Epoch: 32 cost time: 5.951303005218506
Epoch: 32, Steps: 154 | Train Loss: 1.168 Vali Loss: 2.446 Vali Acc: 0.322 Test Loss: 2.446 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 1.0510330
	speed: 0.1348s/iter; left time: 1398.7285s
Epoch: 33 cost time: 5.768819570541382
Epoch: 33, Steps: 154 | Train Loss: 1.144 Vali Loss: 2.489 Vali Acc: 0.240 Test Loss: 2.489 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 1.7339383
	speed: 0.1342s/iter; left time: 1371.4220s
Epoch: 34 cost time: 6.199779272079468
Epoch: 34, Steps: 154 | Train Loss: 1.133 Vali Loss: 2.466 Vali Acc: 0.381 Test Loss: 2.466 Test Acc: 0.381
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.9822665
	speed: 0.1413s/iter; left time: 1422.5069s
Epoch: 35 cost time: 6.332791090011597
Epoch: 35, Steps: 154 | Train Loss: 1.127 Vali Loss: 2.522 Vali Acc: 0.376 Test Loss: 2.522 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 1.6279845
	speed: 0.1412s/iter; left time: 1399.7391s
Epoch: 36 cost time: 6.252674579620361
Epoch: 36, Steps: 154 | Train Loss: 1.147 Vali Loss: 2.536 Vali Acc: 0.374 Test Loss: 2.536 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.9088143
	speed: 0.1409s/iter; left time: 1374.6229s
Epoch: 37 cost time: 6.111478328704834
Epoch: 37, Steps: 154 | Train Loss: 1.078 Vali Loss: 2.344 Vali Acc: 0.369 Test Loss: 2.344 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 1.2113910
	speed: 0.1393s/iter; left time: 1337.4916s
Epoch: 38 cost time: 5.914553642272949
Epoch: 38, Steps: 154 | Train Loss: 1.096 Vali Loss: 2.466 Vali Acc: 0.222 Test Loss: 2.466 Test Acc: 0.222
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39172749391727496
model parameter : 87838
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0758314
	speed: 0.0543s/iter; left time: 830.5069s
Epoch: 1 cost time: 7.443258047103882
Epoch: 1, Steps: 154 | Train Loss: 2.320 Vali Loss: 2.153 Vali Acc: 0.317 Test Loss: 2.153 Test Acc: 0.317
Validation loss decreased (inf --> -0.316686).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5361772
	speed: 0.1353s/iter; left time: 2048.7853s
Epoch: 2 cost time: 5.85453462600708
Epoch: 2, Steps: 154 | Train Loss: 2.080 Vali Loss: 2.144 Vali Acc: 0.315 Test Loss: 2.144 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.2348146
	speed: 0.1366s/iter; left time: 2048.7840s
Epoch: 3 cost time: 6.074542760848999
Epoch: 3, Steps: 154 | Train Loss: 2.025 Vali Loss: 2.144 Vali Acc: 0.318 Test Loss: 2.144 Test Acc: 0.318
Validation loss decreased (-0.316686 --> -0.318308).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8532581
	speed: 0.1376s/iter; left time: 2041.9196s
Epoch: 4 cost time: 6.292473316192627
Epoch: 4, Steps: 154 | Train Loss: 1.978 Vali Loss: 2.161 Vali Acc: 0.321 Test Loss: 2.161 Test Acc: 0.321
Validation loss decreased (-0.318308 --> -0.321146).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4907595
	speed: 0.1401s/iter; left time: 2057.0776s
Epoch: 5 cost time: 6.5276501178741455
Epoch: 5, Steps: 154 | Train Loss: 1.936 Vali Loss: 2.146 Vali Acc: 0.327 Test Loss: 2.146 Test Acc: 0.327
Validation loss decreased (-0.321146 --> -0.327229).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4599686
	speed: 0.1404s/iter; left time: 2040.4271s
Epoch: 6 cost time: 5.82586407661438
Epoch: 6, Steps: 154 | Train Loss: 1.897 Vali Loss: 2.148 Vali Acc: 0.325 Test Loss: 2.148 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4251474
	speed: 0.1290s/iter; left time: 1854.6249s
Epoch: 7 cost time: 6.260359764099121
Epoch: 7, Steps: 154 | Train Loss: 1.863 Vali Loss: 2.198 Vali Acc: 0.330 Test Loss: 2.198 Test Acc: 0.330
Validation loss decreased (-0.327229 --> -0.330473).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5631957
	speed: 0.1428s/iter; left time: 2031.6498s
Epoch: 8 cost time: 6.113884210586548
Epoch: 8, Steps: 154 | Train Loss: 1.780 Vali Loss: 2.252 Vali Acc: 0.333 Test Loss: 2.252 Test Acc: 0.333
Validation loss decreased (-0.330473 --> -0.332905).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5956522
	speed: 0.1420s/iter; left time: 1998.0859s
Epoch: 9 cost time: 6.085923194885254
Epoch: 9, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.258 Vali Acc: 0.336 Test Loss: 2.258 Test Acc: 0.336
Validation loss decreased (-0.332905 --> -0.335744).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9255532
	speed: 0.1408s/iter; left time: 1958.7044s
Epoch: 10 cost time: 6.326662540435791
Epoch: 10, Steps: 154 | Train Loss: 1.698 Vali Loss: 2.280 Vali Acc: 0.339 Test Loss: 2.280 Test Acc: 0.339
Validation loss decreased (-0.335744 --> -0.339393).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7800076
	speed: 0.1367s/iter; left time: 1881.3187s
Epoch: 11 cost time: 6.025254487991333
Epoch: 11, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.315 Vali Acc: 0.340 Test Loss: 2.315 Test Acc: 0.340
Validation loss decreased (-0.339393 --> -0.339798).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7038116
	speed: 0.1400s/iter; left time: 1904.4940s
Epoch: 12 cost time: 5.813871383666992
Epoch: 12, Steps: 154 | Train Loss: 1.624 Vali Loss: 2.370 Vali Acc: 0.347 Test Loss: 2.370 Test Acc: 0.347
Validation loss decreased (-0.339798 --> -0.347097).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5665679
	speed: 0.1341s/iter; left time: 1803.8332s
Epoch: 13 cost time: 5.827946424484253
Epoch: 13, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.319 Vali Acc: 0.349 Test Loss: 2.319 Test Acc: 0.349
Validation loss decreased (-0.347097 --> -0.349125).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.0713649
	speed: 0.1375s/iter; left time: 1828.3239s
Epoch: 14 cost time: 6.240520715713501
Epoch: 14, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.377 Vali Acc: 0.345 Test Loss: 2.377 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6747617
	speed: 0.1440s/iter; left time: 1893.3550s
Epoch: 15 cost time: 6.196861982345581
Epoch: 15, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.357 Vali Acc: 0.354 Test Loss: 2.357 Test Acc: 0.354
Validation loss decreased (-0.349125 --> -0.354397).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.0313714
	speed: 0.1425s/iter; left time: 1851.4032s
Epoch: 16 cost time: 6.438153505325317
Epoch: 16, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.422 Vali Acc: 0.355 Test Loss: 2.422 Test Acc: 0.355
Validation loss decreased (-0.354397 --> -0.354801).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.1642051
	speed: 0.1467s/iter; left time: 1883.0764s
Epoch: 17 cost time: 6.6325767040252686
Epoch: 17, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.448 Vali Acc: 0.350 Test Loss: 2.448 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.6986866
	speed: 0.1505s/iter; left time: 1908.5200s
Epoch: 18 cost time: 6.486041307449341
Epoch: 18, Steps: 154 | Train Loss: 1.518 Vali Loss: 2.427 Vali Acc: 0.355 Test Loss: 2.427 Test Acc: 0.355
Validation loss decreased (-0.354801 --> -0.355207).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.3606222
	speed: 0.1432s/iter; left time: 1794.2471s
Epoch: 19 cost time: 6.484454393386841
Epoch: 19, Steps: 154 | Train Loss: 1.524 Vali Loss: 2.421 Vali Acc: 0.359 Test Loss: 2.421 Test Acc: 0.359
Validation loss decreased (-0.355207 --> -0.359262).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.3871582
	speed: 0.1372s/iter; left time: 1697.8989s
Epoch: 20 cost time: 5.62891697883606
Epoch: 20, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.491 Vali Acc: 0.211 Test Loss: 2.491 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.5534244
	speed: 0.1366s/iter; left time: 1669.1652s
Epoch: 21 cost time: 5.960171461105347
Epoch: 21, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.544 Vali Acc: 0.367 Test Loss: 2.544 Test Acc: 0.367
Validation loss decreased (-0.359262 --> -0.366966).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.3708370
	speed: 0.1402s/iter; left time: 1692.2976s
Epoch: 22 cost time: 6.053561687469482
Epoch: 22, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.490 Vali Acc: 0.356 Test Loss: 2.490 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.2629431
	speed: 0.1458s/iter; left time: 1736.6516s
Epoch: 23 cost time: 6.187453985214233
Epoch: 23, Steps: 154 | Train Loss: 1.411 Vali Loss: 2.397 Vali Acc: 0.368 Test Loss: 2.397 Test Acc: 0.368
Validation loss decreased (-0.366966 --> -0.367778).  Saving model ...
	iters: 100, epoch: 24 | loss: 2.0429857
	speed: 0.1358s/iter; left time: 1597.1444s
Epoch: 24 cost time: 5.687483549118042
Epoch: 24, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.460 Vali Acc: 0.363 Test Loss: 2.460 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.4008814
	speed: 0.1352s/iter; left time: 1569.2586s
Epoch: 25 cost time: 6.821468830108643
Epoch: 25, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.534 Vali Acc: 0.365 Test Loss: 2.534 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.1396219
	speed: 0.1487s/iter; left time: 1702.9541s
Epoch: 26 cost time: 6.655126571655273
Epoch: 26, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.486 Vali Acc: 0.377 Test Loss: 2.486 Test Acc: 0.377
Validation loss decreased (-0.367778 --> -0.377104).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.5869423
	speed: 0.1529s/iter; left time: 1727.8140s
Epoch: 27 cost time: 6.738358974456787
Epoch: 27, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.595 Vali Acc: 0.363 Test Loss: 2.595 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.4158474
	speed: 0.1534s/iter; left time: 1709.5040s
Epoch: 28 cost time: 6.629587411880493
Epoch: 28, Steps: 154 | Train Loss: 1.328 Vali Loss: 2.548 Vali Acc: 0.372 Test Loss: 2.548 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.5900527
	speed: 0.1475s/iter; left time: 1620.4359s
Epoch: 29 cost time: 6.141093492507935
Epoch: 29, Steps: 154 | Train Loss: 1.314 Vali Loss: 2.590 Vali Acc: 0.294 Test Loss: 2.590 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.6083834
	speed: 0.1425s/iter; left time: 1544.1039s
Epoch: 30 cost time: 6.244290113449097
Epoch: 30, Steps: 154 | Train Loss: 1.297 Vali Loss: 2.758 Vali Acc: 0.199 Test Loss: 2.758 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 1.5671829
	speed: 0.1467s/iter; left time: 1567.0378s
Epoch: 31 cost time: 6.269911050796509
Epoch: 31, Steps: 154 | Train Loss: 1.294 Vali Loss: 2.594 Vali Acc: 0.374 Test Loss: 2.594 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 1.0839772
	speed: 0.1421s/iter; left time: 1495.9447s
Epoch: 32 cost time: 6.049557685852051
Epoch: 32, Steps: 154 | Train Loss: 1.300 Vali Loss: 2.814 Vali Acc: 0.194 Test Loss: 2.814 Test Acc: 0.194
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 2.5029471
	speed: 0.1430s/iter; left time: 1482.9174s
Epoch: 33 cost time: 5.966951847076416
Epoch: 33, Steps: 154 | Train Loss: 1.325 Vali Loss: 2.647 Vali Acc: 0.376 Test Loss: 2.647 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 1.3029530
	speed: 0.1419s/iter; left time: 1450.5142s
Epoch: 34 cost time: 6.424175024032593
Epoch: 34, Steps: 154 | Train Loss: 1.264 Vali Loss: 2.617 Vali Acc: 0.220 Test Loss: 2.617 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 1.4852394
	speed: 0.1402s/iter; left time: 1411.2241s
Epoch: 35 cost time: 5.918048143386841
Epoch: 35, Steps: 154 | Train Loss: 1.274 Vali Loss: 2.619 Vali Acc: 0.380 Test Loss: 2.619 Test Acc: 0.380
Validation loss decreased (-0.377104 --> -0.379941).  Saving model ...
	iters: 100, epoch: 36 | loss: 1.1125523
	speed: 0.1449s/iter; left time: 1436.4597s
Epoch: 36 cost time: 6.194739818572998
Epoch: 36, Steps: 154 | Train Loss: 1.274 Vali Loss: 2.669 Vali Acc: 0.340 Test Loss: 2.669 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 1.2101610
	speed: 0.1479s/iter; left time: 1443.3896s
Epoch: 37 cost time: 6.7522804737091064
Epoch: 37, Steps: 154 | Train Loss: 1.326 Vali Loss: 2.658 Vali Acc: 0.214 Test Loss: 2.658 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 1.3193512
	speed: 0.1487s/iter; left time: 1428.3025s
Epoch: 38 cost time: 6.37197470664978
Epoch: 38, Steps: 154 | Train Loss: 1.226 Vali Loss: 2.876 Vali Acc: 0.087 Test Loss: 2.876 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.8895816
	speed: 0.1451s/iter; left time: 1370.9394s
Epoch: 39 cost time: 6.295822858810425
Epoch: 39, Steps: 154 | Train Loss: 1.208 Vali Loss: 2.741 Vali Acc: 0.217 Test Loss: 2.741 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 1.2860818
	speed: 0.1437s/iter; left time: 1335.2910s
Epoch: 40 cost time: 6.095172882080078
Epoch: 40, Steps: 154 | Train Loss: 1.207 Vali Loss: 2.812 Vali Acc: 0.210 Test Loss: 2.812 Test Acc: 0.210
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 1.5163682
	speed: 0.1367s/iter; left time: 1249.2838s
Epoch: 41 cost time: 5.851142644882202
Epoch: 41, Steps: 154 | Train Loss: 1.206 Vali Loss: 2.846 Vali Acc: 0.179 Test Loss: 2.846 Test Acc: 0.179
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 1.2648326
	speed: 0.1366s/iter; left time: 1227.1955s
Epoch: 42 cost time: 6.2662036418914795
Epoch: 42, Steps: 154 | Train Loss: 1.226 Vali Loss: 2.801 Vali Acc: 0.205 Test Loss: 2.801 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 1.4276915
	speed: 0.1419s/iter; left time: 1253.3519s
Epoch: 43 cost time: 6.3269736766815186
Epoch: 43, Steps: 154 | Train Loss: 1.223 Vali Loss: 2.756 Vali Acc: 0.221 Test Loss: 2.756 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 1.8091261
	speed: 0.1404s/iter; left time: 1218.7438s
Epoch: 44 cost time: 6.129847526550293
Epoch: 44, Steps: 154 | Train Loss: 1.184 Vali Loss: 2.992 Vali Acc: 0.085 Test Loss: 2.992 Test Acc: 0.085
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.9342958
	speed: 0.1472s/iter; left time: 1255.2962s
Epoch: 45 cost time: 6.158271551132202
Epoch: 45, Steps: 154 | Train Loss: 1.197 Vali Loss: 2.902 Vali Acc: 0.202 Test Loss: 2.902 Test Acc: 0.202
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 55070
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1579559
	speed: 0.0559s/iter; left time: 855.3970s
Epoch: 1 cost time: 7.560455799102783
Epoch: 1, Steps: 154 | Train Loss: 2.317 Vali Loss: 2.151 Vali Acc: 0.315 Test Loss: 2.151 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5450530
	speed: 0.1458s/iter; left time: 2208.0647s
Epoch: 2 cost time: 6.190964937210083
Epoch: 2, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.150 Vali Acc: 0.316 Test Loss: 2.150 Test Acc: 0.316
Validation loss decreased (-0.315469 --> -0.316280).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2421620
	speed: 0.1429s/iter; left time: 2142.3802s
Epoch: 3 cost time: 6.455121755599976
Epoch: 3, Steps: 154 | Train Loss: 2.026 Vali Loss: 2.148 Vali Acc: 0.318 Test Loss: 2.148 Test Acc: 0.318
Validation loss decreased (-0.316280 --> -0.318308).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8372060
	speed: 0.1405s/iter; left time: 2085.6021s
Epoch: 4 cost time: 5.929338693618774
Epoch: 4, Steps: 154 | Train Loss: 1.980 Vali Loss: 2.172 Vali Acc: 0.321 Test Loss: 2.172 Test Acc: 0.321
Validation loss decreased (-0.318308 --> -0.321146).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4725759
	speed: 0.1387s/iter; left time: 2036.3092s
Epoch: 5 cost time: 6.035170793533325
Epoch: 5, Steps: 154 | Train Loss: 1.937 Vali Loss: 2.139 Vali Acc: 0.327 Test Loss: 2.139 Test Acc: 0.327
Validation loss decreased (-0.321146 --> -0.326824).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5353992
	speed: 0.1393s/iter; left time: 2024.5523s
Epoch: 6 cost time: 6.333449363708496
Epoch: 6, Steps: 154 | Train Loss: 1.891 Vali Loss: 2.149 Vali Acc: 0.326 Test Loss: 2.149 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4343096
	speed: 0.1485s/iter; left time: 2135.5194s
Epoch: 7 cost time: 6.469616889953613
Epoch: 7, Steps: 154 | Train Loss: 1.851 Vali Loss: 2.187 Vali Acc: 0.332 Test Loss: 2.187 Test Acc: 0.332
Validation loss decreased (-0.326824 --> -0.332095).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6335425
	speed: 0.1473s/iter; left time: 2095.5695s
Epoch: 8 cost time: 6.186859607696533
Epoch: 8, Steps: 154 | Train Loss: 1.801 Vali Loss: 2.239 Vali Acc: 0.334 Test Loss: 2.239 Test Acc: 0.334
Validation loss decreased (-0.332095 --> -0.334122).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5798883
	speed: 0.1481s/iter; left time: 2083.8205s
Epoch: 9 cost time: 6.451487302780151
Epoch: 9, Steps: 154 | Train Loss: 1.715 Vali Loss: 2.271 Vali Acc: 0.338 Test Loss: 2.271 Test Acc: 0.338
Validation loss decreased (-0.334122 --> -0.338177).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8807058
	speed: 0.1467s/iter; left time: 2040.7789s
Epoch: 10 cost time: 6.034313917160034
Epoch: 10, Steps: 154 | Train Loss: 1.698 Vali Loss: 2.287 Vali Acc: 0.345 Test Loss: 2.287 Test Acc: 0.345
Validation loss decreased (-0.338177 --> -0.344665).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9143806
	speed: 0.1399s/iter; left time: 1925.7743s
Epoch: 11 cost time: 5.918240547180176
Epoch: 11, Steps: 154 | Train Loss: 1.651 Vali Loss: 2.349 Vali Acc: 0.343 Test Loss: 2.349 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6592714
	speed: 0.1384s/iter; left time: 1883.8125s
Epoch: 12 cost time: 6.180872678756714
Epoch: 12, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.410 Vali Acc: 0.346 Test Loss: 2.410 Test Acc: 0.346
Validation loss decreased (-0.344665 --> -0.345880).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5511090
	speed: 0.1408s/iter; left time: 1893.7497s
Epoch: 13 cost time: 6.402227878570557
Epoch: 13, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.322 Vali Acc: 0.356 Test Loss: 2.322 Test Acc: 0.356
Validation loss decreased (-0.345880 --> -0.356424).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.8969172
	speed: 0.1481s/iter; left time: 1969.5385s
Epoch: 14 cost time: 6.215752840042114
Epoch: 14, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.368 Vali Acc: 0.352 Test Loss: 2.368 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6682028
	speed: 0.1489s/iter; left time: 1956.8065s
Epoch: 15 cost time: 6.60047173500061
Epoch: 15, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.357 Vali Acc: 0.357 Test Loss: 2.357 Test Acc: 0.357
Validation loss decreased (-0.356424 --> -0.356830).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.7901766
	speed: 0.1450s/iter; left time: 1884.1202s
Epoch: 16 cost time: 6.398191928863525
Epoch: 16, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.360 Vali Acc: 0.353 Test Loss: 2.360 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.0977273
	speed: 0.1454s/iter; left time: 1866.5919s
Epoch: 17 cost time: 6.099905252456665
Epoch: 17, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.402 Vali Acc: 0.361 Test Loss: 2.402 Test Acc: 0.361
Validation loss decreased (-0.356830 --> -0.360884).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.7434633
	speed: 0.1558s/iter; left time: 1975.7130s
Epoch: 18 cost time: 7.180830955505371
Epoch: 18, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.542 Vali Acc: 0.260 Test Loss: 2.542 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 2.0725300
	speed: 0.1683s/iter; left time: 2109.1273s
Epoch: 19 cost time: 9.138987302780151
Epoch: 19, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.455 Vali Acc: 0.354 Test Loss: 2.455 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.6295538
	speed: 0.2488s/iter; left time: 3078.9768s
Epoch: 20 cost time: 9.90027403831482
Epoch: 20, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.470 Vali Acc: 0.197 Test Loss: 2.470 Test Acc: 0.197
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.7438965
	speed: 0.2046s/iter; left time: 2500.9905s
Epoch: 21 cost time: 7.792317152023315
Epoch: 21, Steps: 154 | Train Loss: 1.424 Vali Loss: 2.595 Vali Acc: 0.357 Test Loss: 2.595 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.3813202
	speed: 0.2501s/iter; left time: 3017.3950s
Epoch: 22 cost time: 10.308645963668823
Epoch: 22, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.456 Vali Acc: 0.359 Test Loss: 2.456 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.1247227
	speed: 0.2049s/iter; left time: 2441.5001s
Epoch: 23 cost time: 8.191048860549927
Epoch: 23, Steps: 154 | Train Loss: 1.375 Vali Loss: 2.467 Vali Acc: 0.247 Test Loss: 2.467 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.9583222
	speed: 0.2636s/iter; left time: 3099.9646s
Epoch: 24 cost time: 9.116893291473389
Epoch: 24, Steps: 154 | Train Loss: 1.399 Vali Loss: 2.439 Vali Acc: 0.368 Test Loss: 2.439 Test Acc: 0.368
Validation loss decreased (-0.360884 --> -0.367778).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.1800486
	speed: 0.1957s/iter; left time: 2271.6008s
Epoch: 25 cost time: 7.928184270858765
Epoch: 25, Steps: 154 | Train Loss: 1.351 Vali Loss: 2.565 Vali Acc: 0.311 Test Loss: 2.565 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.9507881
	speed: 0.2194s/iter; left time: 2512.8644s
Epoch: 26 cost time: 7.912893295288086
Epoch: 26, Steps: 154 | Train Loss: 1.321 Vali Loss: 2.482 Vali Acc: 0.379 Test Loss: 2.482 Test Acc: 0.379
Validation loss decreased (-0.367778 --> -0.378726).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.4861925
	speed: 0.1765s/iter; left time: 1994.0992s
Epoch: 27 cost time: 6.241649389266968
Epoch: 27, Steps: 154 | Train Loss: 1.329 Vali Loss: 2.661 Vali Acc: 0.367 Test Loss: 2.661 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.2198557
	speed: 0.1431s/iter; left time: 1594.1771s
Epoch: 28 cost time: 6.239660024642944
Epoch: 28, Steps: 154 | Train Loss: 1.290 Vali Loss: 2.557 Vali Acc: 0.372 Test Loss: 2.557 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.2856443
	speed: 0.1434s/iter; left time: 1575.8715s
Epoch: 29 cost time: 6.184276819229126
Epoch: 29, Steps: 154 | Train Loss: 1.309 Vali Loss: 2.512 Vali Acc: 0.382 Test Loss: 2.512 Test Acc: 0.382
Validation loss decreased (-0.378726 --> -0.381970).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.5925078
	speed: 0.1448s/iter; left time: 1569.2961s
Epoch: 30 cost time: 6.154466390609741
Epoch: 30, Steps: 154 | Train Loss: 1.279 Vali Loss: 2.751 Vali Acc: 0.198 Test Loss: 2.751 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.2965707
	speed: 0.1413s/iter; left time: 1508.9279s
Epoch: 31 cost time: 6.253862380981445
Epoch: 31, Steps: 154 | Train Loss: 1.279 Vali Loss: 2.627 Vali Acc: 0.369 Test Loss: 2.627 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.3871253
	speed: 0.1424s/iter; left time: 1498.7538s
Epoch: 32 cost time: 6.232233047485352
Epoch: 32, Steps: 154 | Train Loss: 1.270 Vali Loss: 2.825 Vali Acc: 0.201 Test Loss: 2.825 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 1.2043095
	speed: 0.1566s/iter; left time: 1624.2183s
Epoch: 33 cost time: 6.4311230182647705
Epoch: 33, Steps: 154 | Train Loss: 1.285 Vali Loss: 2.725 Vali Acc: 0.363 Test Loss: 2.725 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 1.3663924
	speed: 0.1413s/iter; left time: 1444.1385s
Epoch: 34 cost time: 6.244537353515625
Epoch: 34, Steps: 154 | Train Loss: 1.240 Vali Loss: 2.611 Vali Acc: 0.242 Test Loss: 2.611 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 1.6125686
	speed: 0.1509s/iter; left time: 1518.5877s
Epoch: 35 cost time: 6.508795499801636
Epoch: 35, Steps: 154 | Train Loss: 1.246 Vali Loss: 2.725 Vali Acc: 0.258 Test Loss: 2.725 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 1.2129784
	speed: 0.1950s/iter; left time: 1932.5669s
Epoch: 36 cost time: 7.865032911300659
Epoch: 36, Steps: 154 | Train Loss: 1.227 Vali Loss: 2.770 Vali Acc: 0.207 Test Loss: 2.770 Test Acc: 0.207
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 1.3036898
	speed: 0.1908s/iter; left time: 1861.1512s
Epoch: 37 cost time: 7.7536797523498535
Epoch: 37, Steps: 154 | Train Loss: 1.276 Vali Loss: 2.749 Vali Acc: 0.186 Test Loss: 2.749 Test Acc: 0.186
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 1.3743618
	speed: 0.2058s/iter; left time: 1975.8758s
Epoch: 38 cost time: 8.514280080795288
Epoch: 38, Steps: 154 | Train Loss: 1.196 Vali Loss: 2.805 Vali Acc: 0.110 Test Loss: 2.805 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 1.0104153
	speed: 0.1930s/iter; left time: 1823.6224s
Epoch: 39 cost time: 7.078864097595215
Epoch: 39, Steps: 154 | Train Loss: 1.199 Vali Loss: 2.728 Vali Acc: 0.107 Test Loss: 2.728 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3819951338199513
model parameter : 55070
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1416256
	speed: 0.0637s/iter; left time: 974.9436s
Epoch: 1 cost time: 8.729825496673584
Epoch: 1, Steps: 154 | Train Loss: 2.305 Vali Loss: 2.154 Vali Acc: 0.315 Test Loss: 2.154 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5556927
	speed: 0.1766s/iter; left time: 2675.4475s
Epoch: 2 cost time: 7.285658121109009
Epoch: 2, Steps: 154 | Train Loss: 2.060 Vali Loss: 2.155 Vali Acc: 0.316 Test Loss: 2.155 Test Acc: 0.316
Validation loss decreased (-0.315064 --> -0.315875).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1940882
	speed: 0.1768s/iter; left time: 2650.0236s
Epoch: 3 cost time: 7.250347852706909
Epoch: 3, Steps: 154 | Train Loss: 2.023 Vali Loss: 2.153 Vali Acc: 0.318 Test Loss: 2.153 Test Acc: 0.318
Validation loss decreased (-0.315875 --> -0.318308).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8102057
	speed: 0.1779s/iter; left time: 2639.6179s
Epoch: 4 cost time: 7.733505487442017
Epoch: 4, Steps: 154 | Train Loss: 1.977 Vali Loss: 2.182 Vali Acc: 0.320 Test Loss: 2.182 Test Acc: 0.320
Validation loss decreased (-0.318308 --> -0.319930).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4858902
	speed: 0.1972s/iter; left time: 2896.1703s
Epoch: 5 cost time: 7.521967172622681
Epoch: 5, Steps: 154 | Train Loss: 1.926 Vali Loss: 2.152 Vali Acc: 0.324 Test Loss: 2.152 Test Acc: 0.324
Validation loss decreased (-0.319930 --> -0.323579).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4842978
	speed: 0.1892s/iter; left time: 2748.8479s
Epoch: 6 cost time: 8.89465594291687
Epoch: 6, Steps: 154 | Train Loss: 1.883 Vali Loss: 2.144 Vali Acc: 0.327 Test Loss: 2.144 Test Acc: 0.327
Validation loss decreased (-0.323579 --> -0.327229).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3881142
	speed: 0.2093s/iter; left time: 3008.4817s
Epoch: 7 cost time: 8.841033697128296
Epoch: 7, Steps: 154 | Train Loss: 1.832 Vali Loss: 2.199 Vali Acc: 0.332 Test Loss: 2.199 Test Acc: 0.332
Validation loss decreased (-0.327229 --> -0.332095).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5285317
	speed: 0.2711s/iter; left time: 3856.1592s
Epoch: 8 cost time: 10.6577308177948
Epoch: 8, Steps: 154 | Train Loss: 1.796 Vali Loss: 2.192 Vali Acc: 0.337 Test Loss: 2.192 Test Acc: 0.337
Validation loss decreased (-0.332095 --> -0.337367).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5948297
	speed: 0.2291s/iter; left time: 3223.2301s
Epoch: 9 cost time: 9.077286005020142
Epoch: 9, Steps: 154 | Train Loss: 1.725 Vali Loss: 2.259 Vali Acc: 0.340 Test Loss: 2.259 Test Acc: 0.340
Validation loss decreased (-0.337367 --> -0.339799).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7037804
	speed: 0.2422s/iter; left time: 3370.3504s
Epoch: 10 cost time: 10.233065843582153
Epoch: 10, Steps: 154 | Train Loss: 1.693 Vali Loss: 2.293 Vali Acc: 0.342 Test Loss: 2.293 Test Acc: 0.342
Validation loss decreased (-0.339799 --> -0.342232).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8626209
	speed: 0.2148s/iter; left time: 2955.6394s
Epoch: 11 cost time: 9.015868663787842
Epoch: 11, Steps: 154 | Train Loss: 1.623 Vali Loss: 2.325 Vali Acc: 0.343 Test Loss: 2.325 Test Acc: 0.343
Validation loss decreased (-0.342232 --> -0.343448).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6439965
	speed: 0.2475s/iter; left time: 3367.7161s
Epoch: 12 cost time: 10.087541818618774
Epoch: 12, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.311 Vali Acc: 0.348 Test Loss: 2.311 Test Acc: 0.348
Validation loss decreased (-0.343448 --> -0.348314).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5756255
	speed: 0.2191s/iter; left time: 2946.8946s
Epoch: 13 cost time: 9.991655111312866
Epoch: 13, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.252 Vali Acc: 0.359 Test Loss: 2.252 Test Acc: 0.359
Validation loss decreased (-0.348314 --> -0.359264).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.8385801
	speed: 0.2447s/iter; left time: 3254.3549s
Epoch: 14 cost time: 8.831698894500732
Epoch: 14, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.330 Vali Acc: 0.355 Test Loss: 2.330 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.7589551
	speed: 0.2219s/iter; left time: 2917.0925s
Epoch: 15 cost time: 10.503732442855835
Epoch: 15, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.304 Vali Acc: 0.359 Test Loss: 2.304 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.8043677
	speed: 0.2427s/iter; left time: 3153.3327s
Epoch: 16 cost time: 9.200531244277954
Epoch: 16, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.340 Vali Acc: 0.358 Test Loss: 2.340 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.0869989
	speed: 0.2090s/iter; left time: 2682.4148s
Epoch: 17 cost time: 9.317895889282227
Epoch: 17, Steps: 154 | Train Loss: 1.479 Vali Loss: 2.342 Vali Acc: 0.360 Test Loss: 2.342 Test Acc: 0.360
Validation loss decreased (-0.359264 --> -0.359668).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6895574
	speed: 0.2482s/iter; left time: 3148.1252s
Epoch: 18 cost time: 9.354776382446289
Epoch: 18, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.343 Vali Acc: 0.378 Test Loss: 2.343 Test Acc: 0.378
Validation loss decreased (-0.359668 --> -0.377917).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.0671895
	speed: 0.2169s/iter; left time: 2717.7078s
Epoch: 19 cost time: 9.902255773544312
Epoch: 19, Steps: 154 | Train Loss: 1.427 Vali Loss: 2.338 Vali Acc: 0.367 Test Loss: 2.338 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.7940140
	speed: 0.2664s/iter; left time: 3296.6879s
Epoch: 20 cost time: 9.492030620574951
Epoch: 20, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.434 Vali Acc: 0.207 Test Loss: 2.434 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.4677856
	speed: 0.2020s/iter; left time: 2469.1425s
Epoch: 21 cost time: 10.07412600517273
Epoch: 21, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.453 Vali Acc: 0.359 Test Loss: 2.453 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.2876726
	speed: 0.2610s/iter; left time: 3149.7919s
Epoch: 22 cost time: 9.123854398727417
Epoch: 22, Steps: 154 | Train Loss: 1.363 Vali Loss: 2.433 Vali Acc: 0.376 Test Loss: 2.433 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.2115862
	speed: 0.1909s/iter; left time: 2274.1317s
Epoch: 23 cost time: 8.844427108764648
Epoch: 23, Steps: 154 | Train Loss: 1.358 Vali Loss: 2.436 Vali Acc: 0.227 Test Loss: 2.436 Test Acc: 0.227
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.5421344
	speed: 0.1966s/iter; left time: 2311.2575s
Epoch: 24 cost time: 8.896230220794678
Epoch: 24, Steps: 154 | Train Loss: 1.337 Vali Loss: 2.438 Vali Acc: 0.229 Test Loss: 2.438 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.2845761
	speed: 0.2055s/iter; left time: 2384.9340s
Epoch: 25 cost time: 7.9507973194122314
Epoch: 25, Steps: 154 | Train Loss: 1.375 Vali Loss: 2.499 Vali Acc: 0.211 Test Loss: 2.499 Test Acc: 0.211
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.0097344
	speed: 0.2226s/iter; left time: 2548.4868s
Epoch: 26 cost time: 9.373743057250977
Epoch: 26, Steps: 154 | Train Loss: 1.289 Vali Loss: 2.458 Vali Acc: 0.227 Test Loss: 2.458 Test Acc: 0.227
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.5151694
	speed: 0.2538s/iter; left time: 2866.7106s
Epoch: 27 cost time: 9.200239658355713
Epoch: 27, Steps: 154 | Train Loss: 1.284 Vali Loss: 2.569 Vali Acc: 0.210 Test Loss: 2.569 Test Acc: 0.210
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.2108121
	speed: 0.2053s/iter; left time: 2288.1091s
Epoch: 28 cost time: 8.831093549728394
Epoch: 28, Steps: 154 | Train Loss: 1.272 Vali Loss: 2.574 Vali Acc: 0.247 Test Loss: 2.574 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37793998377939986
model parameter : 55070
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0985291
	speed: 0.0699s/iter; left time: 1069.4138s
Epoch: 1 cost time: 9.876887798309326
Epoch: 1, Steps: 154 | Train Loss: 2.282 Vali Loss: 2.145 Vali Acc: 0.315 Test Loss: 2.145 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5257733
	speed: 0.2386s/iter; left time: 3614.6951s
Epoch: 2 cost time: 9.48949909210205
Epoch: 2, Steps: 154 | Train Loss: 2.047 Vali Loss: 2.172 Vali Acc: 0.316 Test Loss: 2.172 Test Acc: 0.316
Validation loss decreased (-0.315064 --> -0.316280).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1396472
	speed: 0.2018s/iter; left time: 3026.1563s
Epoch: 3 cost time: 9.245973825454712
Epoch: 3, Steps: 154 | Train Loss: 2.008 Vali Loss: 2.188 Vali Acc: 0.320 Test Loss: 2.188 Test Acc: 0.320
Validation loss decreased (-0.316280 --> -0.320335).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7826012
	speed: 0.2528s/iter; left time: 3751.6704s
Epoch: 4 cost time: 10.229765176773071
Epoch: 4, Steps: 154 | Train Loss: 1.948 Vali Loss: 2.314 Vali Acc: 0.322 Test Loss: 2.314 Test Acc: 0.322
Validation loss decreased (-0.320335 --> -0.321956).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4681176
	speed: 0.2225s/iter; left time: 3267.0248s
Epoch: 5 cost time: 9.257235288619995
Epoch: 5, Steps: 154 | Train Loss: 1.891 Vali Loss: 2.288 Vali Acc: 0.326 Test Loss: 2.288 Test Acc: 0.326
Validation loss decreased (-0.321956 --> -0.326417).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4055810
	speed: 0.2351s/iter; left time: 3416.3645s
Epoch: 6 cost time: 9.223695993423462
Epoch: 6, Steps: 154 | Train Loss: 1.841 Vali Loss: 2.473 Vali Acc: 0.328 Test Loss: 2.473 Test Acc: 0.328
Validation loss decreased (-0.326417 --> -0.328442).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3938084
	speed: 0.1890s/iter; left time: 2717.2488s
Epoch: 7 cost time: 8.426877498626709
Epoch: 7, Steps: 154 | Train Loss: 1.780 Vali Loss: 2.605 Vali Acc: 0.333 Test Loss: 2.605 Test Acc: 0.333
Validation loss decreased (-0.328442 --> -0.333307).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4758773
	speed: 0.2229s/iter; left time: 3170.4022s
Epoch: 8 cost time: 8.710222721099854
Epoch: 8, Steps: 154 | Train Loss: 1.721 Vali Loss: 2.533 Vali Acc: 0.334 Test Loss: 2.533 Test Acc: 0.334
Validation loss decreased (-0.333307 --> -0.333714).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6210754
	speed: 0.2046s/iter; left time: 2878.8291s
Epoch: 9 cost time: 7.406647682189941
Epoch: 9, Steps: 154 | Train Loss: 1.678 Vali Loss: 2.477 Vali Acc: 0.345 Test Loss: 2.477 Test Acc: 0.345
Validation loss decreased (-0.333714 --> -0.345068).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6725017
	speed: 0.1997s/iter; left time: 2778.6450s
Epoch: 10 cost time: 8.764035940170288
Epoch: 10, Steps: 154 | Train Loss: 1.632 Vali Loss: 2.449 Vali Acc: 0.348 Test Loss: 2.449 Test Acc: 0.348
Validation loss decreased (-0.345068 --> -0.348313).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5889462
	speed: 0.2174s/iter; left time: 2991.8465s
Epoch: 11 cost time: 7.852455139160156
Epoch: 11, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.434 Vali Acc: 0.354 Test Loss: 2.434 Test Acc: 0.354
Validation loss decreased (-0.348313 --> -0.353585).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6738073
	speed: 0.2212s/iter; left time: 3009.6017s
Epoch: 12 cost time: 10.571551084518433
Epoch: 12, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.576 Vali Acc: 0.352 Test Loss: 2.576 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.3670594
	speed: 0.2414s/iter; left time: 3248.2137s
Epoch: 13 cost time: 8.79622483253479
Epoch: 13, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.550 Vali Acc: 0.369 Test Loss: 2.550 Test Acc: 0.369
Validation loss decreased (-0.353585 --> -0.368588).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6361723
	speed: 0.2420s/iter; left time: 3218.2723s
Epoch: 14 cost time: 9.803335428237915
Epoch: 14, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.538 Vali Acc: 0.362 Test Loss: 2.538 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6204832
	speed: 0.2424s/iter; left time: 3185.8027s
Epoch: 15 cost time: 8.399161577224731
Epoch: 15, Steps: 154 | Train Loss: 1.424 Vali Loss: 2.376 Vali Acc: 0.371 Test Loss: 2.376 Test Acc: 0.371
Validation loss decreased (-0.368588 --> -0.370617).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.7893060
	speed: 0.2146s/iter; left time: 2788.2090s
Epoch: 16 cost time: 8.804229974746704
Epoch: 16, Steps: 154 | Train Loss: 1.404 Vali Loss: 2.447 Vali Acc: 0.366 Test Loss: 2.447 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.0469311
	speed: 0.2326s/iter; left time: 2986.1190s
Epoch: 17 cost time: 7.818882703781128
Epoch: 17, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.501 Vali Acc: 0.364 Test Loss: 2.501 Test Acc: 0.364
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.6750777
	speed: 0.1930s/iter; left time: 2448.0681s
Epoch: 18 cost time: 8.499956130981445
Epoch: 18, Steps: 154 | Train Loss: 1.337 Vali Loss: 2.472 Vali Acc: 0.372 Test Loss: 2.472 Test Acc: 0.372
Validation loss decreased (-0.370617 --> -0.372238).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.8151827
	speed: 0.2225s/iter; left time: 2787.8066s
Epoch: 19 cost time: 7.998837471008301
Epoch: 19, Steps: 154 | Train Loss: 1.344 Vali Loss: 2.535 Vali Acc: 0.374 Test Loss: 2.535 Test Acc: 0.374
Validation loss decreased (-0.372238 --> -0.374265).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.8483849
	speed: 0.2313s/iter; left time: 2862.7525s
Epoch: 20 cost time: 8.933645248413086
Epoch: 20, Steps: 154 | Train Loss: 1.319 Vali Loss: 2.608 Vali Acc: 0.215 Test Loss: 2.608 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.1835450
	speed: 0.2280s/iter; left time: 2786.6517s
Epoch: 21 cost time: 8.235581159591675
Epoch: 21, Steps: 154 | Train Loss: 1.324 Vali Loss: 2.598 Vali Acc: 0.365 Test Loss: 2.598 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.4896787
	speed: 0.2337s/iter; left time: 2819.8636s
Epoch: 22 cost time: 9.024633407592773
Epoch: 22, Steps: 154 | Train Loss: 1.309 Vali Loss: 2.587 Vali Acc: 0.365 Test Loss: 2.587 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.1636580
	speed: 0.2405s/iter; left time: 2865.1715s
Epoch: 23 cost time: 9.19891095161438
Epoch: 23, Steps: 154 | Train Loss: 1.294 Vali Loss: 2.595 Vali Acc: 0.307 Test Loss: 2.595 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.5144013
	speed: 0.2040s/iter; left time: 2398.3845s
Epoch: 24 cost time: 7.55241322517395
Epoch: 24, Steps: 154 | Train Loss: 1.276 Vali Loss: 2.553 Vali Acc: 0.276 Test Loss: 2.553 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.1262369
	speed: 0.2285s/iter; left time: 2652.2410s
Epoch: 25 cost time: 9.419810771942139
Epoch: 25, Steps: 154 | Train Loss: 1.272 Vali Loss: 2.743 Vali Acc: 0.350 Test Loss: 2.743 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.9347746
	speed: 0.2490s/iter; left time: 2851.4205s
Epoch: 26 cost time: 8.934814214706421
Epoch: 26, Steps: 154 | Train Loss: 1.248 Vali Loss: 2.777 Vali Acc: 0.354 Test Loss: 2.777 Test Acc: 0.354
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.1883287
	speed: 0.1996s/iter; left time: 2254.7842s
Epoch: 27 cost time: 10.023946523666382
Epoch: 27, Steps: 154 | Train Loss: 1.242 Vali Loss: 2.968 Vali Acc: 0.332 Test Loss: 2.968 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.1451454
	speed: 0.2455s/iter; left time: 2736.0854s
Epoch: 28 cost time: 8.106889247894287
Epoch: 28, Steps: 154 | Train Loss: 1.241 Vali Loss: 2.758 Vali Acc: 0.316 Test Loss: 2.758 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.4739935
	speed: 0.2029s/iter; left time: 2229.3377s
Epoch: 29 cost time: 9.31690239906311
Epoch: 29, Steps: 154 | Train Loss: 1.204 Vali Loss: 2.684 Vali Acc: 0.368 Test Loss: 2.684 Test Acc: 0.368
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3742903487429035
model parameter : 55070
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2721267
	speed: 0.0644s/iter; left time: 985.8482s
Epoch: 1 cost time: 9.184041261672974
Epoch: 1, Steps: 154 | Train Loss: 2.349 Vali Loss: 2.173 Vali Acc: 0.316 Test Loss: 2.173 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6198196
	speed: 0.2130s/iter; left time: 3226.4638s
Epoch: 2 cost time: 8.70613980293274
Epoch: 2, Steps: 154 | Train Loss: 2.111 Vali Loss: 2.139 Vali Acc: 0.318 Test Loss: 2.139 Test Acc: 0.318
Validation loss decreased (-0.316280 --> -0.318308).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9566811
	speed: 0.1927s/iter; left time: 2889.5827s
Epoch: 3 cost time: 6.701674938201904
Epoch: 3, Steps: 154 | Train Loss: 2.032 Vali Loss: 2.147 Vali Acc: 0.321 Test Loss: 2.147 Test Acc: 0.321
Validation loss decreased (-0.318308 --> -0.321146).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1775286
	speed: 0.2145s/iter; left time: 3183.6214s
Epoch: 4 cost time: 8.56327486038208
Epoch: 4, Steps: 154 | Train Loss: 1.984 Vali Loss: 2.147 Vali Acc: 0.320 Test Loss: 2.147 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8680059
	speed: 0.2096s/iter; left time: 3078.3554s
Epoch: 5 cost time: 7.477815866470337
Epoch: 5, Steps: 154 | Train Loss: 1.967 Vali Loss: 2.153 Vali Acc: 0.321 Test Loss: 2.153 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.2852979
	speed: 0.2234s/iter; left time: 3245.9041s
Epoch: 6 cost time: 9.64869213104248
Epoch: 6, Steps: 154 | Train Loss: 1.918 Vali Loss: 2.170 Vali Acc: 0.324 Test Loss: 2.170 Test Acc: 0.324
Validation loss decreased (-0.321146 --> -0.323579).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5543897
	speed: 0.2169s/iter; left time: 3118.4428s
Epoch: 7 cost time: 8.25760555267334
Epoch: 7, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.177 Vali Acc: 0.328 Test Loss: 2.177 Test Acc: 0.328
Validation loss decreased (-0.323579 --> -0.328445).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6409528
	speed: 0.2346s/iter; left time: 3337.3421s
Epoch: 8 cost time: 9.634324312210083
Epoch: 8, Steps: 154 | Train Loss: 1.815 Vali Loss: 2.192 Vali Acc: 0.335 Test Loss: 2.192 Test Acc: 0.335
Validation loss decreased (-0.328445 --> -0.334528).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6103028
	speed: 0.2006s/iter; left time: 2822.0189s
Epoch: 9 cost time: 8.5322744846344
Epoch: 9, Steps: 154 | Train Loss: 1.748 Vali Loss: 2.210 Vali Acc: 0.337 Test Loss: 2.210 Test Acc: 0.337
Validation loss decreased (-0.334528 --> -0.337366).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7865124
	speed: 0.2248s/iter; left time: 3128.7362s
Epoch: 10 cost time: 8.575912475585938
Epoch: 10, Steps: 154 | Train Loss: 1.689 Vali Loss: 2.295 Vali Acc: 0.344 Test Loss: 2.295 Test Acc: 0.344
Validation loss decreased (-0.337366 --> -0.343854).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5017428
	speed: 0.1956s/iter; left time: 2691.7952s
Epoch: 11 cost time: 8.185096979141235
Epoch: 11, Steps: 154 | Train Loss: 1.656 Vali Loss: 2.304 Vali Acc: 0.343 Test Loss: 2.304 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.1038227
	speed: 0.1933s/iter; left time: 2629.5659s
Epoch: 12 cost time: 7.734341621398926
Epoch: 12, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.301 Vali Acc: 0.353 Test Loss: 2.301 Test Acc: 0.353
Validation loss decreased (-0.343854 --> -0.353181).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2832555
	speed: 0.1894s/iter; left time: 2547.6946s
Epoch: 13 cost time: 8.209242343902588
Epoch: 13, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.327 Vali Acc: 0.350 Test Loss: 2.327 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.2508323
	speed: 0.2130s/iter; left time: 2832.9201s
Epoch: 14 cost time: 8.160243272781372
Epoch: 14, Steps: 154 | Train Loss: 1.538 Vali Loss: 2.436 Vali Acc: 0.348 Test Loss: 2.436 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.6715900
	speed: 0.2154s/iter; left time: 2831.4135s
Epoch: 15 cost time: 8.615458726882935
Epoch: 15, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.481 Vali Acc: 0.349 Test Loss: 2.481 Test Acc: 0.349
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.5138013
	speed: 0.2056s/iter; left time: 2670.4610s
Epoch: 16 cost time: 8.008417129516602
Epoch: 16, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.462 Vali Acc: 0.355 Test Loss: 2.462 Test Acc: 0.355
Validation loss decreased (-0.353181 --> -0.354801).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.5364138
	speed: 0.2186s/iter; left time: 2806.0477s
Epoch: 17 cost time: 8.366705417633057
Epoch: 17, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.493 Vali Acc: 0.355 Test Loss: 2.493 Test Acc: 0.355
Validation loss decreased (-0.354801 --> -0.355206).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.5519756
	speed: 0.1905s/iter; left time: 2416.0911s
Epoch: 18 cost time: 8.284521341323853
Epoch: 18, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.530 Vali Acc: 0.356 Test Loss: 2.530 Test Acc: 0.356
Validation loss decreased (-0.355206 --> -0.356422).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.1863465
	speed: 0.2273s/iter; left time: 2848.3124s
Epoch: 19 cost time: 8.14962649345398
Epoch: 19, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.533 Vali Acc: 0.358 Test Loss: 2.533 Test Acc: 0.358
Validation loss decreased (-0.356422 --> -0.357639).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.5343599
	speed: 0.1926s/iter; left time: 2383.3817s
Epoch: 20 cost time: 9.072015047073364
Epoch: 20, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.503 Vali Acc: 0.358 Test Loss: 2.503 Test Acc: 0.358
Validation loss decreased (-0.357639 --> -0.358450).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.9459867
	speed: 0.2155s/iter; left time: 2634.2132s
Epoch: 21 cost time: 8.117950201034546
Epoch: 21, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.557 Vali Acc: 0.366 Test Loss: 2.557 Test Acc: 0.366
Validation loss decreased (-0.358450 --> -0.365749).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.2271554
	speed: 0.2051s/iter; left time: 2475.4922s
Epoch: 22 cost time: 9.130290031433105
Epoch: 22, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.587 Vali Acc: 0.356 Test Loss: 2.587 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.6858437
	speed: 0.2184s/iter; left time: 2601.7501s
Epoch: 23 cost time: 7.848665475845337
Epoch: 23, Steps: 154 | Train Loss: 1.466 Vali Loss: 2.580 Vali Acc: 0.357 Test Loss: 2.580 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.1269054
	speed: 0.2075s/iter; left time: 2439.5232s
Epoch: 24 cost time: 8.790008306503296
Epoch: 24, Steps: 154 | Train Loss: 1.368 Vali Loss: 2.721 Vali Acc: 0.360 Test Loss: 2.721 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.5898083
	speed: 0.1977s/iter; left time: 2294.3207s
Epoch: 25 cost time: 8.039876461029053
Epoch: 25, Steps: 154 | Train Loss: 1.351 Vali Loss: 2.612 Vali Acc: 0.360 Test Loss: 2.612 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.1756152
	speed: 0.1965s/iter; left time: 2249.8798s
Epoch: 26 cost time: 7.868261814117432
Epoch: 26, Steps: 154 | Train Loss: 1.351 Vali Loss: 2.709 Vali Acc: 0.364 Test Loss: 2.709 Test Acc: 0.364
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.0772990
	speed: 0.1573s/iter; left time: 1776.8879s
Epoch: 27 cost time: 6.952985525131226
Epoch: 27, Steps: 154 | Train Loss: 1.338 Vali Loss: 2.615 Vali Acc: 0.363 Test Loss: 2.615 Test Acc: 0.363
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.2324363
	speed: 0.2063s/iter; left time: 2298.8776s
Epoch: 28 cost time: 8.108359813690186
Epoch: 28, Steps: 154 | Train Loss: 1.322 Vali Loss: 2.676 Vali Acc: 0.217 Test Loss: 2.676 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.8783672
	speed: 0.1903s/iter; left time: 2090.7609s
Epoch: 29 cost time: 7.468598127365112
Epoch: 29, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.714 Vali Acc: 0.360 Test Loss: 2.714 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.1339347
	speed: 0.2355s/iter; left time: 2551.8054s
Epoch: 30 cost time: 9.89144492149353
Epoch: 30, Steps: 154 | Train Loss: 1.318 Vali Loss: 2.774 Vali Acc: 0.362 Test Loss: 2.774 Test Acc: 0.362
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.9038019
	speed: 0.2068s/iter; left time: 2209.0229s
Epoch: 31 cost time: 7.670346736907959
Epoch: 31, Steps: 154 | Train Loss: 1.351 Vali Loss: 2.698 Vali Acc: 0.206 Test Loss: 2.698 Test Acc: 0.206
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3657745336577453
model parameter : 38686
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2573421
	speed: 0.0623s/iter; left time: 952.6797s
Epoch: 1 cost time: 8.625919818878174
Epoch: 1, Steps: 154 | Train Loss: 2.342 Vali Loss: 2.171 Vali Acc: 0.316 Test Loss: 2.171 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5616052
	speed: 0.1966s/iter; left time: 2977.5397s
Epoch: 2 cost time: 8.179432153701782
Epoch: 2, Steps: 154 | Train Loss: 2.092 Vali Loss: 2.138 Vali Acc: 0.318 Test Loss: 2.138 Test Acc: 0.318
Validation loss decreased (-0.316280 --> -0.318308).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9867473
	speed: 0.1902s/iter; left time: 2851.2518s
Epoch: 3 cost time: 7.033729553222656
Epoch: 3, Steps: 154 | Train Loss: 2.031 Vali Loss: 2.147 Vali Acc: 0.320 Test Loss: 2.147 Test Acc: 0.320
Validation loss decreased (-0.318308 --> -0.319930).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1930966
	speed: 0.1981s/iter; left time: 2939.2412s
Epoch: 4 cost time: 8.25377082824707
Epoch: 4, Steps: 154 | Train Loss: 1.978 Vali Loss: 2.147 Vali Acc: 0.320 Test Loss: 2.147 Test Acc: 0.320
Validation loss decreased (-0.319930 --> -0.320335).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9005120
	speed: 0.1986s/iter; left time: 2917.0095s
Epoch: 5 cost time: 7.251919269561768
Epoch: 5, Steps: 154 | Train Loss: 1.959 Vali Loss: 2.160 Vali Acc: 0.321 Test Loss: 2.160 Test Acc: 0.321
Validation loss decreased (-0.320335 --> -0.321146).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5853070
	speed: 0.2101s/iter; left time: 3053.4078s
Epoch: 6 cost time: 9.102232217788696
Epoch: 6, Steps: 154 | Train Loss: 1.906 Vali Loss: 2.166 Vali Acc: 0.326 Test Loss: 2.166 Test Acc: 0.326
Validation loss decreased (-0.321146 --> -0.325607).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6313857
	speed: 0.1964s/iter; left time: 2824.2935s
Epoch: 7 cost time: 7.362055063247681
Epoch: 7, Steps: 154 | Train Loss: 1.842 Vali Loss: 2.172 Vali Acc: 0.332 Test Loss: 2.172 Test Acc: 0.332
Validation loss decreased (-0.325607 --> -0.331690).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7085797
	speed: 0.1950s/iter; left time: 2773.5214s
Epoch: 8 cost time: 8.365126848220825
Epoch: 8, Steps: 154 | Train Loss: 1.802 Vali Loss: 2.176 Vali Acc: 0.341 Test Loss: 2.176 Test Acc: 0.341
Validation loss decreased (-0.331690 --> -0.341016).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6180899
	speed: 0.2009s/iter; left time: 2826.9035s
Epoch: 9 cost time: 7.654880046844482
Epoch: 9, Steps: 154 | Train Loss: 1.738 Vali Loss: 2.211 Vali Acc: 0.341 Test Loss: 2.211 Test Acc: 0.341
Validation loss decreased (-0.341016 --> -0.341422).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8127012
	speed: 0.1919s/iter; left time: 2669.8276s
Epoch: 10 cost time: 8.218622922897339
Epoch: 10, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.295 Vali Acc: 0.347 Test Loss: 2.295 Test Acc: 0.347
Validation loss decreased (-0.341422 --> -0.347098).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5224769
	speed: 0.2280s/iter; left time: 3136.9848s
Epoch: 11 cost time: 9.114962816238403
Epoch: 11, Steps: 154 | Train Loss: 1.635 Vali Loss: 2.280 Vali Acc: 0.343 Test Loss: 2.280 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.0823786
	speed: 0.1883s/iter; left time: 2561.5345s
Epoch: 12 cost time: 8.365168571472168
Epoch: 12, Steps: 154 | Train Loss: 1.585 Vali Loss: 2.267 Vali Acc: 0.355 Test Loss: 2.267 Test Acc: 0.355
Validation loss decreased (-0.347098 --> -0.355208).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1635376
	speed: 0.2027s/iter; left time: 2726.4904s
Epoch: 13 cost time: 7.475233554840088
Epoch: 13, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.294 Vali Acc: 0.356 Test Loss: 2.294 Test Acc: 0.356
Validation loss decreased (-0.355208 --> -0.355614).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.1208404
	speed: 0.1938s/iter; left time: 2577.4754s
Epoch: 14 cost time: 7.942741870880127
Epoch: 14, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.326 Vali Acc: 0.352 Test Loss: 2.326 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.7859076
	speed: 0.2024s/iter; left time: 2660.5910s
Epoch: 15 cost time: 8.073256969451904
Epoch: 15, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.400 Vali Acc: 0.353 Test Loss: 2.400 Test Acc: 0.353
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.5331771
	speed: 0.1709s/iter; left time: 2220.3217s
Epoch: 16 cost time: 7.303147315979004
Epoch: 16, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.395 Vali Acc: 0.364 Test Loss: 2.395 Test Acc: 0.364
Validation loss decreased (-0.355614 --> -0.364129).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.4171712
	speed: 0.1997s/iter; left time: 2563.0838s
Epoch: 17 cost time: 7.815854787826538
Epoch: 17, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.402 Vali Acc: 0.360 Test Loss: 2.402 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.6418742
	speed: 0.1764s/iter; left time: 2237.5228s
Epoch: 18 cost time: 7.534247398376465
Epoch: 18, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.474 Vali Acc: 0.360 Test Loss: 2.474 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.0774109
	speed: 0.2034s/iter; left time: 2548.7358s
Epoch: 19 cost time: 8.149146556854248
Epoch: 19, Steps: 154 | Train Loss: 1.417 Vali Loss: 2.468 Vali Acc: 0.368 Test Loss: 2.468 Test Acc: 0.368
Validation loss decreased (-0.364129 --> -0.368183).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.5747104
	speed: 0.1973s/iter; left time: 2442.1886s
Epoch: 20 cost time: 8.193300247192383
Epoch: 20, Steps: 154 | Train Loss: 1.425 Vali Loss: 2.442 Vali Acc: 0.370 Test Loss: 2.442 Test Acc: 0.370
Validation loss decreased (-0.368183 --> -0.370211).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.5356195
	speed: 0.2035s/iter; left time: 2487.5658s
Epoch: 21 cost time: 8.251786708831787
Epoch: 21, Steps: 154 | Train Loss: 1.401 Vali Loss: 2.463 Vali Acc: 0.374 Test Loss: 2.463 Test Acc: 0.374
Validation loss decreased (-0.370211 --> -0.374266).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.2617860
	speed: 0.2093s/iter; left time: 2525.2698s
Epoch: 22 cost time: 7.8009021282196045
Epoch: 22, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.544 Vali Acc: 0.363 Test Loss: 2.544 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.5455060
	speed: 0.1970s/iter; left time: 2346.7490s
Epoch: 23 cost time: 7.74533486366272
Epoch: 23, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.447 Vali Acc: 0.363 Test Loss: 2.447 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.0901346
	speed: 0.2055s/iter; left time: 2416.0813s
Epoch: 24 cost time: 7.574897289276123
Epoch: 24, Steps: 154 | Train Loss: 1.363 Vali Loss: 2.546 Vali Acc: 0.366 Test Loss: 2.546 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.7478830
	speed: 0.1920s/iter; left time: 2228.1001s
Epoch: 25 cost time: 7.249730110168457
Epoch: 25, Steps: 154 | Train Loss: 1.334 Vali Loss: 2.602 Vali Acc: 0.372 Test Loss: 2.602 Test Acc: 0.372
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.4542743
	speed: 0.1848s/iter; left time: 2115.8209s
Epoch: 26 cost time: 7.722883701324463
Epoch: 26, Steps: 154 | Train Loss: 1.339 Vali Loss: 2.784 Vali Acc: 0.346 Test Loss: 2.784 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.1602339
	speed: 0.1729s/iter; left time: 1952.8718s
Epoch: 27 cost time: 7.555547475814819
Epoch: 27, Steps: 154 | Train Loss: 1.310 Vali Loss: 2.666 Vali Acc: 0.374 Test Loss: 2.666 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.1039602
	speed: 0.1908s/iter; left time: 2126.5943s
Epoch: 28 cost time: 7.666487455368042
Epoch: 28, Steps: 154 | Train Loss: 1.304 Vali Loss: 2.625 Vali Acc: 0.230 Test Loss: 2.625 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 1.0381743
	speed: 0.1734s/iter; left time: 1905.0504s
Epoch: 29 cost time: 7.801798582077026
Epoch: 29, Steps: 154 | Train Loss: 1.287 Vali Loss: 2.627 Vali Acc: 0.304 Test Loss: 2.627 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.1737590
	speed: 0.1860s/iter; left time: 2015.1240s
Epoch: 30 cost time: 7.27604079246521
Epoch: 30, Steps: 154 | Train Loss: 1.291 Vali Loss: 2.785 Vali Acc: 0.207 Test Loss: 2.785 Test Acc: 0.207
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.9122567
	speed: 0.1667s/iter; left time: 1780.2324s
Epoch: 31 cost time: 7.147730588912964
Epoch: 31, Steps: 154 | Train Loss: 1.271 Vali Loss: 2.775 Vali Acc: 0.200 Test Loss: 2.775 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3742903487429035
model parameter : 38686
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2016115
	speed: 0.0468s/iter; left time: 716.4517s
Epoch: 1 cost time: 6.638671636581421
Epoch: 1, Steps: 154 | Train Loss: 2.338 Vali Loss: 2.161 Vali Acc: 0.317 Test Loss: 2.161 Test Acc: 0.317
Validation loss decreased (inf --> -0.316686).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5378599
	speed: 0.1107s/iter; left time: 1677.4174s
Epoch: 2 cost time: 5.3212010860443115
Epoch: 2, Steps: 154 | Train Loss: 2.085 Vali Loss: 2.133 Vali Acc: 0.317 Test Loss: 2.133 Test Acc: 0.317
Validation loss decreased (-0.316686 --> -0.317091).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9401286
	speed: 0.1100s/iter; left time: 1648.6205s
Epoch: 3 cost time: 5.277318000793457
Epoch: 3, Steps: 154 | Train Loss: 2.027 Vali Loss: 2.141 Vali Acc: 0.319 Test Loss: 2.141 Test Acc: 0.319
Validation loss decreased (-0.317091 --> -0.319119).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1726134
	speed: 0.1223s/iter; left time: 1814.9075s
Epoch: 4 cost time: 6.81292200088501
Epoch: 4, Steps: 154 | Train Loss: 1.983 Vali Loss: 2.133 Vali Acc: 0.320 Test Loss: 2.133 Test Acc: 0.320
Validation loss decreased (-0.319119 --> -0.320336).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8757132
	speed: 0.1160s/iter; left time: 1703.2933s
Epoch: 5 cost time: 5.685208797454834
Epoch: 5, Steps: 154 | Train Loss: 1.949 Vali Loss: 2.168 Vali Acc: 0.320 Test Loss: 2.168 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6001580
	speed: 0.1114s/iter; left time: 1618.2021s
Epoch: 6 cost time: 5.231103897094727
Epoch: 6, Steps: 154 | Train Loss: 1.903 Vali Loss: 2.155 Vali Acc: 0.327 Test Loss: 2.155 Test Acc: 0.327
Validation loss decreased (-0.320336 --> -0.326824).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5908898
	speed: 0.1115s/iter; left time: 1602.8883s
Epoch: 7 cost time: 5.278297185897827
Epoch: 7, Steps: 154 | Train Loss: 1.838 Vali Loss: 2.151 Vali Acc: 0.335 Test Loss: 2.151 Test Acc: 0.335
Validation loss decreased (-0.326824 --> -0.334934).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6638281
	speed: 0.1098s/iter; left time: 1561.4342s
Epoch: 8 cost time: 5.388795614242554
Epoch: 8, Steps: 154 | Train Loss: 1.790 Vali Loss: 2.156 Vali Acc: 0.342 Test Loss: 2.156 Test Acc: 0.342
Validation loss decreased (-0.334934 --> -0.341828).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5276009
	speed: 0.1113s/iter; left time: 1566.4536s
Epoch: 9 cost time: 5.454208135604858
Epoch: 9, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.176 Vali Acc: 0.345 Test Loss: 2.176 Test Acc: 0.345
Validation loss decreased (-0.341828 --> -0.345477).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8414235
	speed: 0.1175s/iter; left time: 1635.2891s
Epoch: 10 cost time: 5.837860107421875
Epoch: 10, Steps: 154 | Train Loss: 1.643 Vali Loss: 2.262 Vali Acc: 0.350 Test Loss: 2.262 Test Acc: 0.350
Validation loss decreased (-0.345477 --> -0.349937).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5271282
	speed: 0.1179s/iter; left time: 1622.3062s
Epoch: 11 cost time: 6.005302429199219
Epoch: 11, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.233 Vali Acc: 0.345 Test Loss: 2.233 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9990926
	speed: 0.1174s/iter; left time: 1598.0481s
Epoch: 12 cost time: 6.2015979290008545
Epoch: 12, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.147 Vali Acc: 0.358 Test Loss: 2.147 Test Acc: 0.358
Validation loss decreased (-0.349937 --> -0.358048).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1733233
	speed: 0.1170s/iter; left time: 1573.6742s
Epoch: 13 cost time: 5.507890939712524
Epoch: 13, Steps: 154 | Train Loss: 1.568 Vali Loss: 2.162 Vali Acc: 0.357 Test Loss: 2.162 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.0311229
	speed: 0.1139s/iter; left time: 1514.1089s
Epoch: 14 cost time: 5.286494255065918
Epoch: 14, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.260 Vali Acc: 0.352 Test Loss: 2.260 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.6853067
	speed: 0.1120s/iter; left time: 1472.3959s
Epoch: 15 cost time: 5.59772515296936
Epoch: 15, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.312 Vali Acc: 0.356 Test Loss: 2.312 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.7592528
	speed: 0.1108s/iter; left time: 1438.9608s
Epoch: 16 cost time: 5.335665225982666
Epoch: 16, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.296 Vali Acc: 0.361 Test Loss: 2.296 Test Acc: 0.361
Validation loss decreased (-0.358048 --> -0.361291).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.4942166
	speed: 0.1213s/iter; left time: 1556.9772s
Epoch: 17 cost time: 6.649917840957642
Epoch: 17, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.324 Vali Acc: 0.358 Test Loss: 2.324 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.6535423
	speed: 0.1524s/iter; left time: 1932.7478s
Epoch: 18 cost time: 7.219313859939575
Epoch: 18, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.387 Vali Acc: 0.358 Test Loss: 2.387 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.1290542
	speed: 0.1449s/iter; left time: 1815.2508s
Epoch: 19 cost time: 6.0126073360443115
Epoch: 19, Steps: 154 | Train Loss: 1.411 Vali Loss: 2.333 Vali Acc: 0.366 Test Loss: 2.333 Test Acc: 0.366
Validation loss decreased (-0.361291 --> -0.365751).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.3893874
	speed: 0.1382s/iter; left time: 1710.0774s
Epoch: 20 cost time: 7.0688698291778564
Epoch: 20, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.303 Vali Acc: 0.374 Test Loss: 2.303 Test Acc: 0.374
Validation loss decreased (-0.365751 --> -0.373862).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.6538936
	speed: 0.1540s/iter; left time: 1881.5569s
Epoch: 21 cost time: 6.656159400939941
Epoch: 21, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.294 Vali Acc: 0.367 Test Loss: 2.294 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.1333982
	speed: 0.1185s/iter; left time: 1430.0631s
Epoch: 22 cost time: 5.679668664932251
Epoch: 22, Steps: 154 | Train Loss: 1.393 Vali Loss: 2.444 Vali Acc: 0.373 Test Loss: 2.444 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.5389414
	speed: 0.1363s/iter; left time: 1623.8264s
Epoch: 23 cost time: 6.254220724105835
Epoch: 23, Steps: 154 | Train Loss: 1.343 Vali Loss: 2.432 Vali Acc: 0.369 Test Loss: 2.432 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.1085083
	speed: 0.1345s/iter; left time: 1581.3104s
Epoch: 24 cost time: 5.257978439331055
Epoch: 24, Steps: 154 | Train Loss: 1.372 Vali Loss: 2.504 Vali Acc: 0.369 Test Loss: 2.504 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 1.6976061
	speed: 0.1184s/iter; left time: 1374.2532s
Epoch: 25 cost time: 6.413714408874512
Epoch: 25, Steps: 154 | Train Loss: 1.330 Vali Loss: 2.472 Vali Acc: 0.372 Test Loss: 2.472 Test Acc: 0.372
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.9471939
	speed: 0.1455s/iter; left time: 1666.0752s
Epoch: 26 cost time: 6.772327184677124
Epoch: 26, Steps: 154 | Train Loss: 1.283 Vali Loss: 2.546 Vali Acc: 0.224 Test Loss: 2.546 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.9960210
	speed: 0.1281s/iter; left time: 1447.6030s
Epoch: 27 cost time: 5.567065000534058
Epoch: 27, Steps: 154 | Train Loss: 1.275 Vali Loss: 2.533 Vali Acc: 0.298 Test Loss: 2.533 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 1.1435843
	speed: 0.1227s/iter; left time: 1366.9923s
Epoch: 28 cost time: 6.3658201694488525
Epoch: 28, Steps: 154 | Train Loss: 1.263 Vali Loss: 2.541 Vali Acc: 0.212 Test Loss: 2.541 Test Acc: 0.212
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.9509596
	speed: 0.1480s/iter; left time: 1626.3770s
Epoch: 29 cost time: 6.666208744049072
Epoch: 29, Steps: 154 | Train Loss: 1.273 Vali Loss: 2.490 Vali Acc: 0.225 Test Loss: 2.490 Test Acc: 0.225
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 1.1338205
	speed: 0.1331s/iter; left time: 1442.0492s
Epoch: 30 cost time: 5.576007127761841
Epoch: 30, Steps: 154 | Train Loss: 1.239 Vali Loss: 2.628 Vali Acc: 0.343 Test Loss: 2.628 Test Acc: 0.343
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37388483373884834
model parameter : 38686
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2135661
	speed: 0.0548s/iter; left time: 839.1875s
Epoch: 1 cost time: 7.641653299331665
Epoch: 1, Steps: 154 | Train Loss: 2.298 Vali Loss: 2.152 Vali Acc: 0.316 Test Loss: 2.152 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5632366
	speed: 0.1205s/iter; left time: 1825.6126s
Epoch: 2 cost time: 5.446261644363403
Epoch: 2, Steps: 154 | Train Loss: 2.070 Vali Loss: 2.134 Vali Acc: 0.317 Test Loss: 2.134 Test Acc: 0.317
Validation loss decreased (-0.316280 --> -0.317091).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9451742
	speed: 0.1251s/iter; left time: 1876.1372s
Epoch: 3 cost time: 6.00244140625
Epoch: 3, Steps: 154 | Train Loss: 2.012 Vali Loss: 2.149 Vali Acc: 0.319 Test Loss: 2.149 Test Acc: 0.319
Validation loss decreased (-0.317091 --> -0.318713).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2142680
	speed: 0.1346s/iter; left time: 1997.2029s
Epoch: 4 cost time: 6.210375070571899
Epoch: 4, Steps: 154 | Train Loss: 1.966 Vali Loss: 2.140 Vali Acc: 0.324 Test Loss: 2.140 Test Acc: 0.324
Validation loss decreased (-0.318713 --> -0.324391).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8848104
	speed: 0.1225s/iter; left time: 1798.9696s
Epoch: 5 cost time: 5.6877593994140625
Epoch: 5, Steps: 154 | Train Loss: 1.902 Vali Loss: 2.384 Vali Acc: 0.324 Test Loss: 2.384 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5717007
	speed: 0.1300s/iter; left time: 1888.7319s
Epoch: 6 cost time: 6.258405923843384
Epoch: 6, Steps: 154 | Train Loss: 1.840 Vali Loss: 2.373 Vali Acc: 0.331 Test Loss: 2.373 Test Acc: 0.331
Validation loss decreased (-0.324391 --> -0.331282).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3410618
	speed: 0.1366s/iter; left time: 1963.6782s
Epoch: 7 cost time: 5.904170751571655
Epoch: 7, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.413 Vali Acc: 0.336 Test Loss: 2.413 Test Acc: 0.336
Validation loss decreased (-0.331282 --> -0.336148).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6582949
	speed: 0.1149s/iter; left time: 1634.4443s
Epoch: 8 cost time: 5.564930200576782
Epoch: 8, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.358 Vali Acc: 0.340 Test Loss: 2.358 Test Acc: 0.340
Validation loss decreased (-0.336148 --> -0.339798).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6611625
	speed: 0.1411s/iter; left time: 1985.1021s
Epoch: 9 cost time: 6.496657609939575
Epoch: 9, Steps: 154 | Train Loss: 1.650 Vali Loss: 2.278 Vali Acc: 0.346 Test Loss: 2.278 Test Acc: 0.346
Validation loss decreased (-0.339798 --> -0.345882).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8501171
	speed: 0.1417s/iter; left time: 1971.8374s
Epoch: 10 cost time: 5.85386323928833
Epoch: 10, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.440 Vali Acc: 0.350 Test Loss: 2.440 Test Acc: 0.350
Validation loss decreased (-0.345882 --> -0.350341).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4303095
	speed: 0.1143s/iter; left time: 1572.8677s
Epoch: 11 cost time: 5.807641267776489
Epoch: 11, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.260 Vali Acc: 0.348 Test Loss: 2.260 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6680913
	speed: 0.1364s/iter; left time: 1856.1208s
Epoch: 12 cost time: 6.150873184204102
Epoch: 12, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.124 Vali Acc: 0.365 Test Loss: 2.124 Test Acc: 0.365
Validation loss decreased (-0.350341 --> -0.364537).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0114188
	speed: 0.1375s/iter; left time: 1849.4954s
Epoch: 13 cost time: 6.2718825340271
Epoch: 13, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.327 Vali Acc: 0.366 Test Loss: 2.327 Test Acc: 0.366
Validation loss decreased (-0.364537 --> -0.365751).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0932634
	speed: 0.1347s/iter; left time: 1790.9658s
Epoch: 14 cost time: 5.254565477371216
Epoch: 14, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.248 Vali Acc: 0.365 Test Loss: 2.248 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.7125881
	speed: 0.1154s/iter; left time: 1517.2439s
Epoch: 15 cost time: 6.123511791229248
Epoch: 15, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.208 Vali Acc: 0.363 Test Loss: 2.208 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.5471556
	speed: 0.1400s/iter; left time: 1818.0936s
Epoch: 16 cost time: 6.280040264129639
Epoch: 16, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.443 Vali Acc: 0.365 Test Loss: 2.443 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.4670775
	speed: 0.1278s/iter; left time: 1641.1207s
Epoch: 17 cost time: 5.313995122909546
Epoch: 17, Steps: 154 | Train Loss: 1.368 Vali Loss: 2.288 Vali Acc: 0.370 Test Loss: 2.288 Test Acc: 0.370
Validation loss decreased (-0.365751 --> -0.370212).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.5107414
	speed: 0.1144s/iter; left time: 1450.7859s
Epoch: 18 cost time: 5.88023042678833
Epoch: 18, Steps: 154 | Train Loss: 1.335 Vali Loss: 2.390 Vali Acc: 0.368 Test Loss: 2.390 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.2316982
	speed: 0.1313s/iter; left time: 1644.8315s
Epoch: 19 cost time: 6.1157073974609375
Epoch: 19, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.426 Vali Acc: 0.285 Test Loss: 2.426 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.9949971
	speed: 0.1195s/iter; left time: 1479.1442s
Epoch: 20 cost time: 5.4008214473724365
Epoch: 20, Steps: 154 | Train Loss: 1.317 Vali Loss: 2.349 Vali Acc: 0.376 Test Loss: 2.349 Test Acc: 0.376
Validation loss decreased (-0.370212 --> -0.375483).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.4284539
	speed: 0.1286s/iter; left time: 1571.4879s
Epoch: 21 cost time: 6.296696424484253
Epoch: 21, Steps: 154 | Train Loss: 1.288 Vali Loss: 2.413 Vali Acc: 0.334 Test Loss: 2.413 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.4416986
	speed: 0.1358s/iter; left time: 1639.2973s
Epoch: 22 cost time: 6.334534168243408
Epoch: 22, Steps: 154 | Train Loss: 1.304 Vali Loss: 2.339 Vali Acc: 0.265 Test Loss: 2.339 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.8466076
	speed: 0.1096s/iter; left time: 1305.5239s
Epoch: 23 cost time: 5.2894909381866455
Epoch: 23, Steps: 154 | Train Loss: 1.272 Vali Loss: 2.274 Vali Acc: 0.373 Test Loss: 2.274 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.9497573
	speed: 0.1244s/iter; left time: 1462.4496s
Epoch: 24 cost time: 6.0909669399261475
Epoch: 24, Steps: 154 | Train Loss: 1.288 Vali Loss: 2.358 Vali Acc: 0.379 Test Loss: 2.358 Test Acc: 0.379
Validation loss decreased (-0.375483 --> -0.378727).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.4621942
	speed: 0.1317s/iter; left time: 1528.7220s
Epoch: 25 cost time: 5.709211826324463
Epoch: 25, Steps: 154 | Train Loss: 1.222 Vali Loss: 2.304 Vali Acc: 0.378 Test Loss: 2.304 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.8763151
	speed: 0.1110s/iter; left time: 1271.2166s
Epoch: 26 cost time: 5.46945595741272
Epoch: 26, Steps: 154 | Train Loss: 1.222 Vali Loss: 2.300 Vali Acc: 0.380 Test Loss: 2.300 Test Acc: 0.380
Validation loss decreased (-0.378727 --> -0.379945).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.8478448
	speed: 0.1342s/iter; left time: 1515.5282s
Epoch: 27 cost time: 6.085463762283325
Epoch: 27, Steps: 154 | Train Loss: 1.185 Vali Loss: 2.329 Vali Acc: 0.382 Test Loss: 2.329 Test Acc: 0.382
Validation loss decreased (-0.379945 --> -0.381566).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.1475357
	speed: 0.1389s/iter; left time: 1547.8996s
Epoch: 28 cost time: 6.240891456604004
Epoch: 28, Steps: 154 | Train Loss: 1.214 Vali Loss: 2.347 Vali Acc: 0.375 Test Loss: 2.347 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.9068201
	speed: 0.1174s/iter; left time: 1290.4195s
Epoch: 29 cost time: 5.122971534729004
Epoch: 29, Steps: 154 | Train Loss: 1.182 Vali Loss: 2.241 Vali Acc: 0.388 Test Loss: 2.241 Test Acc: 0.388
Validation loss decreased (-0.381566 --> -0.388055).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.2004914
	speed: 0.1261s/iter; left time: 1366.7836s
Epoch: 30 cost time: 5.961285591125488
Epoch: 30, Steps: 154 | Train Loss: 1.167 Vali Loss: 2.403 Vali Acc: 0.376 Test Loss: 2.403 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.0552816
	speed: 0.1302s/iter; left time: 1390.9210s
Epoch: 31 cost time: 5.833057165145874
Epoch: 31, Steps: 154 | Train Loss: 1.139 Vali Loss: 2.296 Vali Acc: 0.306 Test Loss: 2.296 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.5298420
	speed: 0.1134s/iter; left time: 1193.7169s
Epoch: 32 cost time: 5.422286510467529
Epoch: 32, Steps: 154 | Train Loss: 1.231 Vali Loss: 2.375 Vali Acc: 0.386 Test Loss: 2.375 Test Acc: 0.386
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 1.3181809
	speed: 0.1358s/iter; left time: 1408.8213s
Epoch: 33 cost time: 6.138516426086426
Epoch: 33, Steps: 154 | Train Loss: 1.124 Vali Loss: 2.367 Vali Acc: 0.380 Test Loss: 2.367 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 1.0674847
	speed: 0.1355s/iter; left time: 1384.6435s
Epoch: 34 cost time: 5.226399660110474
Epoch: 34, Steps: 154 | Train Loss: 1.123 Vali Loss: 2.431 Vali Acc: 0.384 Test Loss: 2.431 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.5994262
	speed: 0.1136s/iter; left time: 1143.7964s
Epoch: 35 cost time: 6.356639623641968
Epoch: 35, Steps: 154 | Train Loss: 1.093 Vali Loss: 2.366 Vali Acc: 0.380 Test Loss: 2.366 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.8038734
	speed: 0.1382s/iter; left time: 1369.6993s
Epoch: 36 cost time: 6.148976802825928
Epoch: 36, Steps: 154 | Train Loss: 1.097 Vali Loss: 2.500 Vali Acc: 0.247 Test Loss: 2.500 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 1.0319804
	speed: 0.1379s/iter; left time: 1345.4633s
Epoch: 37 cost time: 6.373041152954102
Epoch: 37, Steps: 154 | Train Loss: 1.128 Vali Loss: 2.433 Vali Acc: 0.384 Test Loss: 2.433 Test Acc: 0.384
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 1.3793063
	speed: 0.1120s/iter; left time: 1075.4319s
Epoch: 38 cost time: 5.481614828109741
Epoch: 38, Steps: 154 | Train Loss: 1.145 Vali Loss: 2.523 Vali Acc: 0.365 Test Loss: 2.523 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 1.0847620
	speed: 0.1369s/iter; left time: 1293.2821s
Epoch: 39 cost time: 5.997180223464966
Epoch: 39, Steps: 154 | Train Loss: 1.115 Vali Loss: 2.360 Vali Acc: 0.375 Test Loss: 2.360 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3880778588807786
model parameter : 38686
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0037546
	speed: 0.0494s/iter; left time: 756.3827s
Epoch: 1 cost time: 6.719186544418335
Epoch: 1, Steps: 154 | Train Loss: 2.349 Vali Loss: 2.161 Vali Acc: 0.316 Test Loss: 2.161 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0851369
	speed: 0.1274s/iter; left time: 1929.4027s
Epoch: 2 cost time: 5.9292473793029785
Epoch: 2, Steps: 154 | Train Loss: 2.087 Vali Loss: 2.141 Vali Acc: 0.318 Test Loss: 2.141 Test Acc: 0.318
Validation loss decreased (-0.316280 --> -0.317902).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0119243
	speed: 0.1278s/iter; left time: 1916.1338s
Epoch: 3 cost time: 4.825133800506592
Epoch: 3, Steps: 154 | Train Loss: 2.041 Vali Loss: 2.148 Vali Acc: 0.318 Test Loss: 2.148 Test Acc: 0.318
Validation loss decreased (-0.317902 --> -0.318308).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8788842
	speed: 0.1126s/iter; left time: 1670.2091s
Epoch: 4 cost time: 6.145089626312256
Epoch: 4, Steps: 154 | Train Loss: 2.008 Vali Loss: 2.142 Vali Acc: 0.322 Test Loss: 2.142 Test Acc: 0.322
Validation loss decreased (-0.318308 --> -0.321552).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7799597
	speed: 0.1395s/iter; left time: 2047.8780s
Epoch: 5 cost time: 6.661031246185303
Epoch: 5, Steps: 154 | Train Loss: 1.957 Vali Loss: 2.138 Vali Acc: 0.322 Test Loss: 2.138 Test Acc: 0.322
Validation loss decreased (-0.321552 --> -0.321552).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7896786
	speed: 0.1288s/iter; left time: 1870.9536s
Epoch: 6 cost time: 5.318459749221802
Epoch: 6, Steps: 154 | Train Loss: 1.910 Vali Loss: 2.146 Vali Acc: 0.323 Test Loss: 2.146 Test Acc: 0.323
Validation loss decreased (-0.321552 --> -0.323174).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0212874
	speed: 0.1226s/iter; left time: 1762.7348s
Epoch: 7 cost time: 6.259369134902954
Epoch: 7, Steps: 154 | Train Loss: 1.894 Vali Loss: 2.155 Vali Acc: 0.328 Test Loss: 2.155 Test Acc: 0.328
Validation loss decreased (-0.323174 --> -0.328446).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5561537
	speed: 0.1390s/iter; left time: 1977.1035s
Epoch: 8 cost time: 6.504904747009277
Epoch: 8, Steps: 154 | Train Loss: 1.837 Vali Loss: 2.196 Vali Acc: 0.333 Test Loss: 2.196 Test Acc: 0.333
Validation loss decreased (-0.328446 --> -0.332906).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7159271
	speed: 0.1429s/iter; left time: 2010.4187s
Epoch: 9 cost time: 6.201051950454712
Epoch: 9, Steps: 154 | Train Loss: 1.756 Vali Loss: 2.185 Vali Acc: 0.339 Test Loss: 2.185 Test Acc: 0.339
Validation loss decreased (-0.332906 --> -0.338583).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7130492
	speed: 0.1268s/iter; left time: 1764.6657s
Epoch: 10 cost time: 5.540918350219727
Epoch: 10, Steps: 154 | Train Loss: 1.706 Vali Loss: 2.289 Vali Acc: 0.336 Test Loss: 2.289 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5213809
	speed: 0.1272s/iter; left time: 1750.2973s
Epoch: 11 cost time: 6.421029806137085
Epoch: 11, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.284 Vali Acc: 0.338 Test Loss: 2.284 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.9114530
	speed: 0.1358s/iter; left time: 1848.3948s
Epoch: 12 cost time: 6.115006923675537
Epoch: 12, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.272 Vali Acc: 0.345 Test Loss: 2.272 Test Acc: 0.345
Validation loss decreased (-0.338583 --> -0.345071).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3077474
	speed: 0.1393s/iter; left time: 1873.9048s
Epoch: 13 cost time: 6.128742933273315
Epoch: 13, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.279 Vali Acc: 0.349 Test Loss: 2.279 Test Acc: 0.349
Validation loss decreased (-0.345071 --> -0.349126).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5755664
	speed: 0.1177s/iter; left time: 1565.8730s
Epoch: 14 cost time: 5.351600646972656
Epoch: 14, Steps: 154 | Train Loss: 1.603 Vali Loss: 2.309 Vali Acc: 0.346 Test Loss: 2.309 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.5908623
	speed: 0.1257s/iter; left time: 1652.6147s
Epoch: 15 cost time: 6.371611833572388
Epoch: 15, Steps: 154 | Train Loss: 1.572 Vali Loss: 2.362 Vali Acc: 0.353 Test Loss: 2.362 Test Acc: 0.353
Validation loss decreased (-0.349126 --> -0.353180).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5427872
	speed: 0.1322s/iter; left time: 1717.7829s
Epoch: 16 cost time: 5.604307413101196
Epoch: 16, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.323 Vali Acc: 0.351 Test Loss: 2.323 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.2352250
	speed: 0.1116s/iter; left time: 1432.5829s
Epoch: 17 cost time: 5.408828258514404
Epoch: 17, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.341 Vali Acc: 0.352 Test Loss: 2.341 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.7453055
	speed: 0.1309s/iter; left time: 1660.5354s
Epoch: 18 cost time: 6.095416069030762
Epoch: 18, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.366 Vali Acc: 0.352 Test Loss: 2.366 Test Acc: 0.352
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.4672825
	speed: 0.1315s/iter; left time: 1647.7890s
Epoch: 19 cost time: 6.120489597320557
Epoch: 19, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.411 Vali Acc: 0.365 Test Loss: 2.411 Test Acc: 0.365
Validation loss decreased (-0.353180 --> -0.365345).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.7546266
	speed: 0.1182s/iter; left time: 1463.2920s
Epoch: 20 cost time: 5.380002021789551
Epoch: 20, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.390 Vali Acc: 0.358 Test Loss: 2.390 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.1458795
	speed: 0.1269s/iter; left time: 1550.6297s
Epoch: 21 cost time: 5.8879759311676025
Epoch: 21, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.548 Vali Acc: 0.356 Test Loss: 2.548 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 2.0657456
	speed: 0.1308s/iter; left time: 1578.1564s
Epoch: 22 cost time: 6.087750434875488
Epoch: 22, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.499 Vali Acc: 0.352 Test Loss: 2.499 Test Acc: 0.352
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.1970556
	speed: 0.1184s/iter; left time: 1410.6036s
Epoch: 23 cost time: 5.211908340454102
Epoch: 23, Steps: 154 | Train Loss: 1.415 Vali Loss: 2.508 Vali Acc: 0.360 Test Loss: 2.508 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.2443855
	speed: 0.1200s/iter; left time: 1411.4625s
Epoch: 24 cost time: 5.761394262313843
Epoch: 24, Steps: 154 | Train Loss: 1.392 Vali Loss: 2.494 Vali Acc: 0.363 Test Loss: 2.494 Test Acc: 0.363
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.4367135
	speed: 0.1280s/iter; left time: 1484.8959s
Epoch: 25 cost time: 5.822649240493774
Epoch: 25, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.565 Vali Acc: 0.362 Test Loss: 2.565 Test Acc: 0.362
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.2603146
	speed: 0.1210s/iter; left time: 1386.0063s
Epoch: 26 cost time: 5.966646432876587
Epoch: 26, Steps: 154 | Train Loss: 1.388 Vali Loss: 2.567 Vali Acc: 0.356 Test Loss: 2.567 Test Acc: 0.356
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.1539938
	speed: 0.1242s/iter; left time: 1403.4100s
Epoch: 27 cost time: 5.865492343902588
Epoch: 27, Steps: 154 | Train Loss: 1.361 Vali Loss: 2.658 Vali Acc: 0.372 Test Loss: 2.658 Test Acc: 0.372
Validation loss decreased (-0.365345 --> -0.372236).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.2551742
	speed: 0.1233s/iter; left time: 1374.4372s
Epoch: 28 cost time: 5.379872798919678
Epoch: 28, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.677 Vali Acc: 0.356 Test Loss: 2.677 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.3762825
	speed: 0.1158s/iter; left time: 1272.4010s
Epoch: 29 cost time: 5.989646911621094
Epoch: 29, Steps: 154 | Train Loss: 1.347 Vali Loss: 2.671 Vali Acc: 0.356 Test Loss: 2.671 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 1.3992293
	speed: 0.1313s/iter; left time: 1422.4703s
Epoch: 30 cost time: 5.7240211963653564
Epoch: 30, Steps: 154 | Train Loss: 1.341 Vali Loss: 2.749 Vali Acc: 0.240 Test Loss: 2.749 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 1.3206966
	speed: 0.1175s/iter; left time: 1255.5304s
Epoch: 31 cost time: 5.280831336975098
Epoch: 31, Steps: 154 | Train Loss: 1.336 Vali Loss: 2.653 Vali Acc: 0.379 Test Loss: 2.653 Test Acc: 0.379
Validation loss decreased (-0.372236 --> -0.379130).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.6054733
	speed: 0.1263s/iter; left time: 1329.7858s
Epoch: 32 cost time: 6.150866508483887
Epoch: 32, Steps: 154 | Train Loss: 1.307 Vali Loss: 2.706 Vali Acc: 0.371 Test Loss: 2.706 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 1.5042791
	speed: 0.1338s/iter; left time: 1387.7143s
Epoch: 33 cost time: 5.548205614089966
Epoch: 33, Steps: 154 | Train Loss: 1.270 Vali Loss: 2.733 Vali Acc: 0.369 Test Loss: 2.733 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.8400273
	speed: 0.1079s/iter; left time: 1102.1456s
Epoch: 34 cost time: 5.427649974822998
Epoch: 34, Steps: 154 | Train Loss: 1.290 Vali Loss: 2.699 Vali Acc: 0.371 Test Loss: 2.699 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 1.0308223
	speed: 0.1249s/iter; left time: 1257.4567s
Epoch: 35 cost time: 5.822573900222778
Epoch: 35, Steps: 154 | Train Loss: 1.265 Vali Loss: 2.637 Vali Acc: 0.369 Test Loss: 2.637 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 1.1053799
	speed: 0.1200s/iter; left time: 1189.8109s
Epoch: 36 cost time: 5.185335397720337
Epoch: 36, Steps: 154 | Train Loss: 1.289 Vali Loss: 2.682 Vali Acc: 0.369 Test Loss: 2.682 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 1.2225287
	speed: 0.1144s/iter; left time: 1116.3303s
Epoch: 37 cost time: 5.496703624725342
Epoch: 37, Steps: 154 | Train Loss: 1.321 Vali Loss: 2.768 Vali Acc: 0.222 Test Loss: 2.768 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 1.6668262
	speed: 0.1255s/iter; left time: 1205.4588s
Epoch: 38 cost time: 5.7844672203063965
Epoch: 38, Steps: 154 | Train Loss: 1.321 Vali Loss: 2.735 Vali Acc: 0.303 Test Loss: 2.735 Test Acc: 0.303
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 1.2271928
	speed: 0.1146s/iter; left time: 1082.8148s
Epoch: 39 cost time: 5.370208740234375
Epoch: 39, Steps: 154 | Train Loss: 1.183 Vali Loss: 2.800 Vali Acc: 0.378 Test Loss: 2.800 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.8385927
	speed: 0.1571s/iter; left time: 1459.8300s
Epoch: 40 cost time: 7.299449920654297
Epoch: 40, Steps: 154 | Train Loss: 1.197 Vali Loss: 2.860 Vali Acc: 0.207 Test Loss: 2.860 Test Acc: 0.207
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.8333268
	speed: 0.1582s/iter; left time: 1445.6991s
Epoch: 41 cost time: 5.954746246337891
Epoch: 41, Steps: 154 | Train Loss: 1.236 Vali Loss: 2.981 Vali Acc: 0.210 Test Loss: 2.981 Test Acc: 0.210
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3791565287915653
model parameter : 30494
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0504510
	speed: 0.0522s/iter; left time: 799.0614s
Epoch: 1 cost time: 7.11585807800293
Epoch: 1, Steps: 154 | Train Loss: 2.340 Vali Loss: 2.159 Vali Acc: 0.316 Test Loss: 2.159 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0931373
	speed: 0.1594s/iter; left time: 2413.7504s
Epoch: 2 cost time: 7.785254001617432
Epoch: 2, Steps: 154 | Train Loss: 2.087 Vali Loss: 2.143 Vali Acc: 0.318 Test Loss: 2.143 Test Acc: 0.318
Validation loss decreased (-0.316280 --> -0.317497).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9672456
	speed: 0.1696s/iter; left time: 2543.2817s
Epoch: 3 cost time: 6.428403377532959
Epoch: 3, Steps: 154 | Train Loss: 2.037 Vali Loss: 2.148 Vali Acc: 0.318 Test Loss: 2.148 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8823421
	speed: 0.1574s/iter; left time: 2335.0768s
Epoch: 4 cost time: 6.852951765060425
Epoch: 4, Steps: 154 | Train Loss: 2.008 Vali Loss: 2.135 Vali Acc: 0.322 Test Loss: 2.135 Test Acc: 0.322
Validation loss decreased (-0.317497 --> -0.321552).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8480560
	speed: 0.1559s/iter; left time: 2289.5755s
Epoch: 5 cost time: 5.877918481826782
Epoch: 5, Steps: 154 | Train Loss: 1.961 Vali Loss: 2.135 Vali Acc: 0.324 Test Loss: 2.135 Test Acc: 0.324
Validation loss decreased (-0.321552 --> -0.323580).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8055995
	speed: 0.1548s/iter; left time: 2249.6868s
Epoch: 6 cost time: 7.128209114074707
Epoch: 6, Steps: 154 | Train Loss: 1.910 Vali Loss: 2.144 Vali Acc: 0.324 Test Loss: 2.144 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.0858042
	speed: 0.1711s/iter; left time: 2459.3262s
Epoch: 7 cost time: 6.285969018936157
Epoch: 7, Steps: 154 | Train Loss: 1.880 Vali Loss: 2.145 Vali Acc: 0.335 Test Loss: 2.145 Test Acc: 0.335
Validation loss decreased (-0.323580 --> -0.334528).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6240318
	speed: 0.1678s/iter; left time: 2386.1679s
Epoch: 8 cost time: 7.873427152633667
Epoch: 8, Steps: 154 | Train Loss: 1.815 Vali Loss: 2.178 Vali Acc: 0.336 Test Loss: 2.178 Test Acc: 0.336
Validation loss decreased (-0.334528 --> -0.335745).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6630020
	speed: 0.1699s/iter; left time: 2389.9207s
Epoch: 9 cost time: 6.264458894729614
Epoch: 9, Steps: 154 | Train Loss: 1.753 Vali Loss: 2.173 Vali Acc: 0.341 Test Loss: 2.173 Test Acc: 0.341
Validation loss decreased (-0.335745 --> -0.341422).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6690682
	speed: 0.1686s/iter; left time: 2346.0380s
Epoch: 10 cost time: 7.589091062545776
Epoch: 10, Steps: 154 | Train Loss: 1.701 Vali Loss: 2.241 Vali Acc: 0.343 Test Loss: 2.241 Test Acc: 0.343
Validation loss decreased (-0.341422 --> -0.343449).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3987870
	speed: 0.1687s/iter; left time: 2322.1286s
Epoch: 11 cost time: 6.524680852890015
Epoch: 11, Steps: 154 | Train Loss: 1.656 Vali Loss: 2.269 Vali Acc: 0.344 Test Loss: 2.269 Test Acc: 0.344
Validation loss decreased (-0.343449 --> -0.343854).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7455400
	speed: 0.1669s/iter; left time: 2271.5493s
Epoch: 12 cost time: 7.226619005203247
Epoch: 12, Steps: 154 | Train Loss: 1.630 Vali Loss: 2.247 Vali Acc: 0.348 Test Loss: 2.247 Test Acc: 0.348
Validation loss decreased (-0.343854 --> -0.348315).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5117701
	speed: 0.1715s/iter; left time: 2306.6162s
Epoch: 13 cost time: 6.630477428436279
Epoch: 13, Steps: 154 | Train Loss: 1.597 Vali Loss: 2.215 Vali Acc: 0.357 Test Loss: 2.215 Test Acc: 0.357
Validation loss decreased (-0.348315 --> -0.356831).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5469395
	speed: 0.1624s/iter; left time: 2160.3333s
Epoch: 14 cost time: 7.633004188537598
Epoch: 14, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.257 Vali Acc: 0.351 Test Loss: 2.257 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.4980793
	speed: 0.1694s/iter; left time: 2226.1198s
Epoch: 15 cost time: 7.135924339294434
Epoch: 15, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.307 Vali Acc: 0.356 Test Loss: 2.307 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.5701121
	speed: 0.1582s/iter; left time: 2055.1214s
Epoch: 16 cost time: 6.652865648269653
Epoch: 16, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.320 Vali Acc: 0.351 Test Loss: 2.320 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.3808548
	speed: 0.1645s/iter; left time: 2111.5423s
Epoch: 17 cost time: 7.295844078063965
Epoch: 17, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.360 Vali Acc: 0.354 Test Loss: 2.360 Test Acc: 0.354
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.7608528
	speed: 0.1728s/iter; left time: 2191.0315s
Epoch: 18 cost time: 6.738398551940918
Epoch: 18, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.322 Vali Acc: 0.358 Test Loss: 2.322 Test Acc: 0.358
Validation loss decreased (-0.356831 --> -0.358452).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.4971486
	speed: 0.1578s/iter; left time: 1976.8528s
Epoch: 19 cost time: 7.271484375
Epoch: 19, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.300 Vali Acc: 0.369 Test Loss: 2.300 Test Acc: 0.369
Validation loss decreased (-0.358452 --> -0.368996).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.9526191
	speed: 0.1726s/iter; left time: 2135.9898s
Epoch: 20 cost time: 6.7184739112854
Epoch: 20, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.355 Vali Acc: 0.362 Test Loss: 2.355 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.2687278
	speed: 0.1528s/iter; left time: 1867.0464s
Epoch: 21 cost time: 7.526394367218018
Epoch: 21, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.374 Vali Acc: 0.363 Test Loss: 2.374 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.6404737
	speed: 0.1777s/iter; left time: 2143.8874s
Epoch: 22 cost time: 6.8546271324157715
Epoch: 22, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.492 Vali Acc: 0.356 Test Loss: 2.492 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.3302652
	speed: 0.1570s/iter; left time: 1869.8866s
Epoch: 23 cost time: 7.703176975250244
Epoch: 23, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.433 Vali Acc: 0.365 Test Loss: 2.433 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.1143048
	speed: 0.1840s/iter; left time: 2163.1241s
Epoch: 24 cost time: 7.088698625564575
Epoch: 24, Steps: 154 | Train Loss: 1.393 Vali Loss: 2.458 Vali Acc: 0.361 Test Loss: 2.458 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.2956896
	speed: 0.1613s/iter; left time: 1872.4444s
Epoch: 25 cost time: 7.4319775104522705
Epoch: 25, Steps: 154 | Train Loss: 1.420 Vali Loss: 2.454 Vali Acc: 0.361 Test Loss: 2.454 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.3286235
	speed: 0.1776s/iter; left time: 2033.1997s
Epoch: 26 cost time: 6.8874781131744385
Epoch: 26, Steps: 154 | Train Loss: 1.334 Vali Loss: 2.490 Vali Acc: 0.347 Test Loss: 2.490 Test Acc: 0.347
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.1445073
	speed: 0.1654s/iter; left time: 1868.4412s
Epoch: 27 cost time: 7.070720195770264
Epoch: 27, Steps: 154 | Train Loss: 1.356 Vali Loss: 2.601 Vali Acc: 0.362 Test Loss: 2.601 Test Acc: 0.362
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.0773010
	speed: 0.1697s/iter; left time: 1890.9758s
Epoch: 28 cost time: 6.728075265884399
Epoch: 28, Steps: 154 | Train Loss: 1.320 Vali Loss: 2.607 Vali Acc: 0.363 Test Loss: 2.607 Test Acc: 0.363
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.0076952
	speed: 0.1801s/iter; left time: 1978.7608s
Epoch: 29 cost time: 7.628803968429565
Epoch: 29, Steps: 154 | Train Loss: 1.332 Vali Loss: 2.609 Vali Acc: 0.358 Test Loss: 2.609 Test Acc: 0.358
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36901865369018655
model parameter : 30494
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0752854
	speed: 0.0627s/iter; left time: 959.5951s
Epoch: 1 cost time: 8.787727117538452
Epoch: 1, Steps: 154 | Train Loss: 2.330 Vali Loss: 2.150 Vali Acc: 0.316 Test Loss: 2.150 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0679669
	speed: 0.1490s/iter; left time: 2257.4587s
Epoch: 2 cost time: 6.30531907081604
Epoch: 2, Steps: 154 | Train Loss: 2.082 Vali Loss: 2.134 Vali Acc: 0.317 Test Loss: 2.134 Test Acc: 0.317
Validation loss decreased (-0.316280 --> -0.317091).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9440227
	speed: 0.1772s/iter; left time: 2657.3058s
Epoch: 3 cost time: 7.4407429695129395
Epoch: 3, Steps: 154 | Train Loss: 2.031 Vali Loss: 2.142 Vali Acc: 0.318 Test Loss: 2.142 Test Acc: 0.318
Validation loss decreased (-0.317091 --> -0.317497).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8258185
	speed: 0.1622s/iter; left time: 2407.1341s
Epoch: 4 cost time: 6.705096483230591
Epoch: 4, Steps: 154 | Train Loss: 2.007 Vali Loss: 2.124 Vali Acc: 0.321 Test Loss: 2.124 Test Acc: 0.321
Validation loss decreased (-0.317497 --> -0.320741).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9102042
	speed: 0.1615s/iter; left time: 2370.9545s
Epoch: 5 cost time: 7.247125148773193
Epoch: 5, Steps: 154 | Train Loss: 1.953 Vali Loss: 2.123 Vali Acc: 0.322 Test Loss: 2.123 Test Acc: 0.322
Validation loss decreased (-0.320741 --> -0.322363).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7945470
	speed: 0.1613s/iter; left time: 2343.6680s
Epoch: 6 cost time: 6.896966457366943
Epoch: 6, Steps: 154 | Train Loss: 1.900 Vali Loss: 2.124 Vali Acc: 0.325 Test Loss: 2.124 Test Acc: 0.325
Validation loss decreased (-0.322363 --> -0.325202).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1466889
	speed: 0.1611s/iter; left time: 2316.7010s
Epoch: 7 cost time: 7.160010576248169
Epoch: 7, Steps: 154 | Train Loss: 1.874 Vali Loss: 2.130 Vali Acc: 0.335 Test Loss: 2.130 Test Acc: 0.335
Validation loss decreased (-0.325202 --> -0.334934).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6124704
	speed: 0.1606s/iter; left time: 2284.3874s
Epoch: 8 cost time: 6.879345417022705
Epoch: 8, Steps: 154 | Train Loss: 1.804 Vali Loss: 2.197 Vali Acc: 0.333 Test Loss: 2.197 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6286750
	speed: 0.1585s/iter; left time: 2229.5801s
Epoch: 9 cost time: 6.97050929069519
Epoch: 9, Steps: 154 | Train Loss: 1.740 Vali Loss: 2.174 Vali Acc: 0.340 Test Loss: 2.174 Test Acc: 0.340
Validation loss decreased (-0.334934 --> -0.340205).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6477051
	speed: 0.1573s/iter; left time: 2188.2319s
Epoch: 10 cost time: 7.25361967086792
Epoch: 10, Steps: 154 | Train Loss: 1.676 Vali Loss: 2.238 Vali Acc: 0.348 Test Loss: 2.238 Test Acc: 0.348
Validation loss decreased (-0.340205 --> -0.347909).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5682778
	speed: 0.1576s/iter; left time: 2168.7318s
Epoch: 11 cost time: 6.763764142990112
Epoch: 11, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.231 Vali Acc: 0.345 Test Loss: 2.231 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7795677
	speed: 0.1600s/iter; left time: 2176.5568s
Epoch: 12 cost time: 7.3781938552856445
Epoch: 12, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.255 Vali Acc: 0.349 Test Loss: 2.255 Test Acc: 0.349
Validation loss decreased (-0.347909 --> -0.349126).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2027766
	speed: 0.1618s/iter; left time: 2176.7047s
Epoch: 13 cost time: 6.436741590499878
Epoch: 13, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.213 Vali Acc: 0.356 Test Loss: 2.213 Test Acc: 0.356
Validation loss decreased (-0.349126 --> -0.356426).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5039399
	speed: 0.1579s/iter; left time: 2099.4211s
Epoch: 14 cost time: 7.037005186080933
Epoch: 14, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.272 Vali Acc: 0.352 Test Loss: 2.272 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6168462
	speed: 0.1623s/iter; left time: 2133.7422s
Epoch: 15 cost time: 6.495783805847168
Epoch: 15, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.291 Vali Acc: 0.356 Test Loss: 2.291 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.6126019
	speed: 0.1555s/iter; left time: 2020.5724s
Epoch: 16 cost time: 7.036643028259277
Epoch: 16, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.305 Vali Acc: 0.354 Test Loss: 2.305 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.4400098
	speed: 0.1636s/iter; left time: 2099.8194s
Epoch: 17 cost time: 6.458129167556763
Epoch: 17, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.340 Vali Acc: 0.356 Test Loss: 2.340 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.7473171
	speed: 0.1621s/iter; left time: 2055.3750s
Epoch: 18 cost time: 7.112741708755493
Epoch: 18, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.324 Vali Acc: 0.356 Test Loss: 2.324 Test Acc: 0.356
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.6889206
	speed: 0.1601s/iter; left time: 2005.9534s
Epoch: 19 cost time: 5.884038209915161
Epoch: 19, Steps: 154 | Train Loss: 1.441 Vali Loss: 2.308 Vali Acc: 0.370 Test Loss: 2.308 Test Acc: 0.370
Validation loss decreased (-0.356426 --> -0.370212).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.8298664
	speed: 0.1571s/iter; left time: 1944.4114s
Epoch: 20 cost time: 7.4081480503082275
Epoch: 20, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.338 Vali Acc: 0.371 Test Loss: 2.338 Test Acc: 0.371
Validation loss decreased (-0.370212 --> -0.371428).  Saving model ...
	iters: 100, epoch: 21 | loss: 3.1648669
	speed: 0.1624s/iter; left time: 1985.1499s
Epoch: 21 cost time: 6.238038539886475
Epoch: 21, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.473 Vali Acc: 0.373 Test Loss: 2.473 Test Acc: 0.373
Validation loss decreased (-0.371428 --> -0.373049).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.5547004
	speed: 0.1400s/iter; left time: 1689.8386s
Epoch: 22 cost time: 5.790743112564087
Epoch: 22, Steps: 154 | Train Loss: 1.397 Vali Loss: 2.487 Vali Acc: 0.359 Test Loss: 2.487 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.2286185
	speed: 0.1461s/iter; left time: 1740.8261s
Epoch: 23 cost time: 6.650363922119141
Epoch: 23, Steps: 154 | Train Loss: 1.361 Vali Loss: 2.468 Vali Acc: 0.362 Test Loss: 2.468 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.1639836
	speed: 0.1550s/iter; left time: 1822.9104s
Epoch: 24 cost time: 6.507976770401001
Epoch: 24, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.509 Vali Acc: 0.372 Test Loss: 2.509 Test Acc: 0.372
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.2874271
	speed: 0.1557s/iter; left time: 1807.2902s
Epoch: 25 cost time: 6.752716302871704
Epoch: 25, Steps: 154 | Train Loss: 1.338 Vali Loss: 2.426 Vali Acc: 0.371 Test Loss: 2.426 Test Acc: 0.371
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.2686362
	speed: 0.1531s/iter; left time: 1753.1468s
Epoch: 26 cost time: 6.492002010345459
Epoch: 26, Steps: 154 | Train Loss: 1.301 Vali Loss: 2.516 Vali Acc: 0.221 Test Loss: 2.516 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.0776043
	speed: 0.1598s/iter; left time: 1805.3020s
Epoch: 27 cost time: 6.9697511196136475
Epoch: 27, Steps: 154 | Train Loss: 1.296 Vali Loss: 2.605 Vali Acc: 0.266 Test Loss: 2.605 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.2797558
	speed: 0.1532s/iter; left time: 1707.3734s
Epoch: 28 cost time: 6.148151159286499
Epoch: 28, Steps: 154 | Train Loss: 1.271 Vali Loss: 2.605 Vali Acc: 0.371 Test Loss: 2.605 Test Acc: 0.371
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 1.1541506
	speed: 0.1522s/iter; left time: 1672.1831s
Epoch: 29 cost time: 6.841436862945557
Epoch: 29, Steps: 154 | Train Loss: 1.276 Vali Loss: 2.556 Vali Acc: 0.372 Test Loss: 2.556 Test Acc: 0.372
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.1531049
	speed: 0.1496s/iter; left time: 1620.6051s
Epoch: 30 cost time: 5.893649101257324
Epoch: 30, Steps: 154 | Train Loss: 1.291 Vali Loss: 2.641 Vali Acc: 0.223 Test Loss: 2.641 Test Acc: 0.223
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 1.3645165
	speed: 0.1510s/iter; left time: 1613.2924s
Epoch: 31 cost time: 6.653137683868408
Epoch: 31, Steps: 154 | Train Loss: 1.278 Vali Loss: 2.565 Vali Acc: 0.287 Test Loss: 2.565 Test Acc: 0.287
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37307380373073806
model parameter : 30494
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0397887
	speed: 0.0583s/iter; left time: 892.7657s
Epoch: 1 cost time: 8.06264328956604
Epoch: 1, Steps: 154 | Train Loss: 2.305 Vali Loss: 2.149 Vali Acc: 0.316 Test Loss: 2.149 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0730832
	speed: 0.1476s/iter; left time: 2235.6808s
Epoch: 2 cost time: 6.59017539024353
Epoch: 2, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.140 Vali Acc: 0.317 Test Loss: 2.140 Test Acc: 0.317
Validation loss decreased (-0.315875 --> -0.317091).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9331053
	speed: 0.1478s/iter; left time: 2216.0609s
Epoch: 3 cost time: 6.312705993652344
Epoch: 3, Steps: 154 | Train Loss: 2.026 Vali Loss: 2.150 Vali Acc: 0.318 Test Loss: 2.150 Test Acc: 0.318
Validation loss decreased (-0.317091 --> -0.317497).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7992824
	speed: 0.1432s/iter; left time: 2124.9008s
Epoch: 4 cost time: 6.474198818206787
Epoch: 4, Steps: 154 | Train Loss: 1.987 Vali Loss: 2.119 Vali Acc: 0.323 Test Loss: 2.119 Test Acc: 0.323
Validation loss decreased (-0.317497 --> -0.322769).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7853518
	speed: 0.1475s/iter; left time: 2165.4883s
Epoch: 5 cost time: 6.359107255935669
Epoch: 5, Steps: 154 | Train Loss: 1.919 Vali Loss: 2.154 Vali Acc: 0.327 Test Loss: 2.154 Test Acc: 0.327
Validation loss decreased (-0.322769 --> -0.326824).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7988261
	speed: 0.1484s/iter; left time: 2156.5951s
Epoch: 6 cost time: 6.7319135665893555
Epoch: 6, Steps: 154 | Train Loss: 1.858 Vali Loss: 2.168 Vali Acc: 0.330 Test Loss: 2.168 Test Acc: 0.330
Validation loss decreased (-0.326824 --> -0.330473).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0175200
	speed: 0.1509s/iter; left time: 2169.1817s
Epoch: 7 cost time: 5.951690196990967
Epoch: 7, Steps: 154 | Train Loss: 1.795 Vali Loss: 2.209 Vali Acc: 0.340 Test Loss: 2.209 Test Acc: 0.340
Validation loss decreased (-0.330473 --> -0.340205).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6108528
	speed: 0.1427s/iter; left time: 2029.3564s
Epoch: 8 cost time: 6.728339433670044
Epoch: 8, Steps: 154 | Train Loss: 1.727 Vali Loss: 2.342 Vali Acc: 0.340 Test Loss: 2.342 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5785474
	speed: 0.1522s/iter; left time: 2140.9769s
Epoch: 9 cost time: 6.323282241821289
Epoch: 9, Steps: 154 | Train Loss: 1.675 Vali Loss: 2.231 Vali Acc: 0.346 Test Loss: 2.231 Test Acc: 0.346
Validation loss decreased (-0.340205 --> -0.345882).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8544079
	speed: 0.1517s/iter; left time: 2110.5898s
Epoch: 10 cost time: 7.0456061363220215
Epoch: 10, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.272 Vali Acc: 0.357 Test Loss: 2.272 Test Acc: 0.357
Validation loss decreased (-0.345882 --> -0.356830).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3319129
	speed: 0.1649s/iter; left time: 2268.7206s
Epoch: 11 cost time: 7.609657287597656
Epoch: 11, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.327 Vali Acc: 0.356 Test Loss: 2.327 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9274298
	speed: 0.2408s/iter; left time: 3275.8860s
Epoch: 12 cost time: 10.028098106384277
Epoch: 12, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.235 Vali Acc: 0.359 Test Loss: 2.235 Test Acc: 0.359
Validation loss decreased (-0.356830 --> -0.359264).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1683857
	speed: 0.2494s/iter; left time: 3354.8235s
Epoch: 13 cost time: 8.839389085769653
Epoch: 13, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.228 Vali Acc: 0.368 Test Loss: 2.228 Test Acc: 0.368
Validation loss decreased (-0.359264 --> -0.368185).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5701604
	speed: 0.2560s/iter; left time: 3404.3519s
Epoch: 14 cost time: 10.071146488189697
Epoch: 14, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.345 Vali Acc: 0.361 Test Loss: 2.345 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.3700894
	speed: 0.2446s/iter; left time: 3214.9039s
Epoch: 15 cost time: 8.758241176605225
Epoch: 15, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.430 Vali Acc: 0.371 Test Loss: 2.430 Test Acc: 0.371
Validation loss decreased (-0.368185 --> -0.371427).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3717498
	speed: 0.2457s/iter; left time: 3191.7204s
Epoch: 16 cost time: 9.611814498901367
Epoch: 16, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.554 Vali Acc: 0.368 Test Loss: 2.554 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.3040555
	speed: 0.2367s/iter; left time: 3038.3574s
Epoch: 17 cost time: 8.981874227523804
Epoch: 17, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.477 Vali Acc: 0.368 Test Loss: 2.477 Test Acc: 0.368
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.7262297
	speed: 0.2314s/iter; left time: 2935.1268s
Epoch: 18 cost time: 8.868476390838623
Epoch: 18, Steps: 154 | Train Loss: 1.374 Vali Loss: 2.320 Vali Acc: 0.367 Test Loss: 2.320 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.1694995
	speed: 0.2423s/iter; left time: 3035.9146s
Epoch: 19 cost time: 9.278827428817749
Epoch: 19, Steps: 154 | Train Loss: 1.367 Vali Loss: 2.315 Vali Acc: 0.371 Test Loss: 2.315 Test Acc: 0.371
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.8207872
	speed: 0.2322s/iter; left time: 2873.7096s
Epoch: 20 cost time: 9.58840823173523
Epoch: 20, Steps: 154 | Train Loss: 1.344 Vali Loss: 2.360 Vali Acc: 0.376 Test Loss: 2.360 Test Acc: 0.376
Validation loss decreased (-0.371427 --> -0.375889).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.0912825
	speed: 0.2436s/iter; left time: 2977.5154s
Epoch: 21 cost time: 9.881454706192017
Epoch: 21, Steps: 154 | Train Loss: 1.347 Vali Loss: 2.387 Vali Acc: 0.382 Test Loss: 2.387 Test Acc: 0.382
Validation loss decreased (-0.375889 --> -0.381971).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.2449261
	speed: 0.2499s/iter; left time: 3015.5266s
Epoch: 22 cost time: 9.284117937088013
Epoch: 22, Steps: 154 | Train Loss: 1.322 Vali Loss: 2.327 Vali Acc: 0.361 Test Loss: 2.327 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.3425572
	speed: 0.2589s/iter; left time: 3083.7446s
Epoch: 23 cost time: 10.014000177383423
Epoch: 23, Steps: 154 | Train Loss: 1.292 Vali Loss: 2.335 Vali Acc: 0.378 Test Loss: 2.335 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.9094719
	speed: 0.2317s/iter; left time: 2724.5631s
Epoch: 24 cost time: 9.681603193283081
Epoch: 24, Steps: 154 | Train Loss: 1.295 Vali Loss: 2.322 Vali Acc: 0.372 Test Loss: 2.322 Test Acc: 0.372
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.2765653
	speed: 0.2548s/iter; left time: 2956.5373s
Epoch: 25 cost time: 9.100334644317627
Epoch: 25, Steps: 154 | Train Loss: 1.275 Vali Loss: 2.168 Vali Acc: 0.374 Test Loss: 2.168 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.1718750
	speed: 0.2469s/iter; left time: 2827.7588s
Epoch: 26 cost time: 9.21741271018982
Epoch: 26, Steps: 154 | Train Loss: 1.274 Vali Loss: 2.420 Vali Acc: 0.242 Test Loss: 2.420 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.3204234
	speed: 0.2392s/iter; left time: 2702.5973s
Epoch: 27 cost time: 9.422747611999512
Epoch: 27, Steps: 154 | Train Loss: 1.295 Vali Loss: 2.302 Vali Acc: 0.380 Test Loss: 2.302 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.0261338
	speed: 0.2411s/iter; left time: 2686.4739s
Epoch: 28 cost time: 9.012871503829956
Epoch: 28, Steps: 154 | Train Loss: 1.234 Vali Loss: 2.324 Vali Acc: 0.369 Test Loss: 2.324 Test Acc: 0.369
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 1.0471282
	speed: 0.2328s/iter; left time: 2558.1303s
Epoch: 29 cost time: 9.517035245895386
Epoch: 29, Steps: 154 | Train Loss: 1.227 Vali Loss: 2.322 Vali Acc: 0.370 Test Loss: 2.322 Test Acc: 0.370
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.1064534
	speed: 0.2406s/iter; left time: 2607.1813s
Epoch: 30 cost time: 9.023681640625
Epoch: 30, Steps: 154 | Train Loss: 1.213 Vali Loss: 2.355 Vali Acc: 0.384 Test Loss: 2.355 Test Acc: 0.384
Validation loss decreased (-0.381971 --> -0.384405).  Saving model ...
	iters: 100, epoch: 31 | loss: 1.1312556
	speed: 0.2287s/iter; left time: 2442.5398s
Epoch: 31 cost time: 9.455782175064087
Epoch: 31, Steps: 154 | Train Loss: 1.220 Vali Loss: 2.398 Vali Acc: 0.387 Test Loss: 2.398 Test Acc: 0.387
Validation loss decreased (-0.384405 --> -0.387243).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.5561397
	speed: 0.2356s/iter; left time: 2480.5830s
Epoch: 32 cost time: 8.631637811660767
Epoch: 32, Steps: 154 | Train Loss: 1.186 Vali Loss: 2.358 Vali Acc: 0.373 Test Loss: 2.358 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 1.5925266
	speed: 0.2459s/iter; left time: 2550.7491s
Epoch: 33 cost time: 9.730959415435791
Epoch: 33, Steps: 154 | Train Loss: 1.177 Vali Loss: 2.392 Vali Acc: 0.380 Test Loss: 2.392 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.8686942
	speed: 0.2435s/iter; left time: 2488.0454s
Epoch: 34 cost time: 9.393474102020264
Epoch: 34, Steps: 154 | Train Loss: 1.192 Vali Loss: 2.455 Vali Acc: 0.379 Test Loss: 2.455 Test Acc: 0.379
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 1.1548381
	speed: 0.2440s/iter; left time: 2455.6266s
Epoch: 35 cost time: 9.460404396057129
Epoch: 35, Steps: 154 | Train Loss: 1.143 Vali Loss: 2.351 Vali Acc: 0.379 Test Loss: 2.351 Test Acc: 0.379
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 1.2481101
	speed: 0.2492s/iter; left time: 2470.0661s
Epoch: 36 cost time: 8.957465648651123
Epoch: 36, Steps: 154 | Train Loss: 1.201 Vali Loss: 2.285 Vali Acc: 0.382 Test Loss: 2.285 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 1.2305650
	speed: 0.2265s/iter; left time: 2210.3670s
Epoch: 37 cost time: 9.540754079818726
Epoch: 37, Steps: 154 | Train Loss: 1.195 Vali Loss: 2.453 Vali Acc: 0.383 Test Loss: 2.453 Test Acc: 0.383
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 1.6653616
	speed: 0.2330s/iter; left time: 2237.3205s
Epoch: 38 cost time: 9.24307131767273
Epoch: 38, Steps: 154 | Train Loss: 1.126 Vali Loss: 2.348 Vali Acc: 0.381 Test Loss: 2.348 Test Acc: 0.381
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 1.3351882
	speed: 0.2308s/iter; left time: 2180.5590s
Epoch: 39 cost time: 9.506451845169067
Epoch: 39, Steps: 154 | Train Loss: 1.094 Vali Loss: 2.626 Vali Acc: 0.380 Test Loss: 2.626 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 1.0062145
	speed: 0.2479s/iter; left time: 2304.6801s
Epoch: 40 cost time: 9.157581090927124
Epoch: 40, Steps: 154 | Train Loss: 1.105 Vali Loss: 2.338 Vali Acc: 0.387 Test Loss: 2.338 Test Acc: 0.387
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 1.1693858
	speed: 0.2351s/iter; left time: 2149.1708s
Epoch: 41 cost time: 9.630860090255737
Epoch: 41, Steps: 154 | Train Loss: 1.096 Vali Loss: 2.401 Vali Acc: 0.384 Test Loss: 2.401 Test Acc: 0.384
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3872668288726683
model parameter : 30494
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6487001
	speed: 0.0629s/iter; left time: 962.1626s
Epoch: 1 cost time: 8.68406081199646
Epoch: 1, Steps: 154 | Train Loss: 2.326 Vali Loss: 2.306 Vali Acc: 0.320 Test Loss: 2.306 Test Acc: 0.320
Validation loss decreased (inf --> -0.319928).  Saving model ...
	iters: 100, epoch: 2 | loss: 8.3002052
	speed: 0.1852s/iter; left time: 2805.4627s
Epoch: 2 cost time: 6.059178352355957
Epoch: 2, Steps: 154 | Train Loss: 2.151 Vali Loss: 2.234 Vali Acc: 0.330 Test Loss: 2.234 Test Acc: 0.330
Validation loss decreased (-0.319928 --> -0.330067).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6981046
	speed: 0.2015s/iter; left time: 3021.4128s
Epoch: 3 cost time: 7.681495428085327
Epoch: 3, Steps: 154 | Train Loss: 2.139 Vali Loss: 2.297 Vali Acc: 0.330 Test Loss: 2.297 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7571590
	speed: 0.2051s/iter; left time: 3042.8649s
Epoch: 4 cost time: 7.9138007164001465
Epoch: 4, Steps: 154 | Train Loss: 1.935 Vali Loss: 2.442 Vali Acc: 0.327 Test Loss: 2.442 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.0753026
	speed: 0.1927s/iter; left time: 2829.1222s
Epoch: 5 cost time: 6.891095399856567
Epoch: 5, Steps: 154 | Train Loss: 2.092 Vali Loss: 2.559 Vali Acc: 0.333 Test Loss: 2.559 Test Acc: 0.333
Validation loss decreased (-0.330067 --> -0.332497).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1722834
	speed: 0.1894s/iter; left time: 2752.1897s
Epoch: 6 cost time: 7.926048517227173
Epoch: 6, Steps: 154 | Train Loss: 1.979 Vali Loss: 2.758 Vali Acc: 0.337 Test Loss: 2.758 Test Acc: 0.337
Validation loss decreased (-0.332497 --> -0.336955).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8925416
	speed: 0.2034s/iter; left time: 2924.1667s
Epoch: 7 cost time: 7.434277772903442
Epoch: 7, Steps: 154 | Train Loss: 1.848 Vali Loss: 2.591 Vali Acc: 0.343 Test Loss: 2.591 Test Acc: 0.343
Validation loss decreased (-0.336955 --> -0.343445).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3009155
	speed: 0.1882s/iter; left time: 2676.6809s
Epoch: 8 cost time: 7.8507678508758545
Epoch: 8, Steps: 154 | Train Loss: 1.771 Vali Loss: 2.848 Vali Acc: 0.176 Test Loss: 2.848 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.2156949
	speed: 0.1888s/iter; left time: 2656.1450s
Epoch: 9 cost time: 7.209996223449707
Epoch: 9, Steps: 154 | Train Loss: 1.788 Vali Loss: 2.760 Vali Acc: 0.350 Test Loss: 2.760 Test Acc: 0.350
Validation loss decreased (-0.343445 --> -0.349526).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3100719
	speed: 0.1879s/iter; left time: 2614.7978s
Epoch: 10 cost time: 7.010761022567749
Epoch: 10, Steps: 154 | Train Loss: 1.814 Vali Loss: 3.603 Vali Acc: 0.164 Test Loss: 3.603 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 10.0310984
	speed: 0.2041s/iter; left time: 2809.0519s
Epoch: 11 cost time: 7.57399845123291
Epoch: 11, Steps: 154 | Train Loss: 2.216 Vali Loss: 2.978 Vali Acc: 0.357 Test Loss: 2.978 Test Acc: 0.357
Validation loss decreased (-0.349526 --> -0.356823).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7673573
	speed: 0.2133s/iter; left time: 2902.0976s
Epoch: 12 cost time: 8.169015407562256
Epoch: 12, Steps: 154 | Train Loss: 1.745 Vali Loss: 3.623 Vali Acc: 0.185 Test Loss: 3.623 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5918392
	speed: 0.1996s/iter; left time: 2684.7363s
Epoch: 13 cost time: 6.5637431144714355
Epoch: 13, Steps: 154 | Train Loss: 1.760 Vali Loss: 3.307 Vali Acc: 0.352 Test Loss: 3.307 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.5619740
	speed: 0.1960s/iter; left time: 2606.3783s
Epoch: 14 cost time: 7.8380913734436035
Epoch: 14, Steps: 154 | Train Loss: 1.628 Vali Loss: 3.228 Vali Acc: 0.119 Test Loss: 3.228 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.5530645
	speed: 0.1878s/iter; left time: 2468.6488s
Epoch: 15 cost time: 7.211207151412964
Epoch: 15, Steps: 154 | Train Loss: 1.670 Vali Loss: 3.891 Vali Acc: 0.087 Test Loss: 3.891 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.9481121
	speed: 0.1926s/iter; left time: 2502.2571s
Epoch: 16 cost time: 7.333662033081055
Epoch: 16, Steps: 154 | Train Loss: 1.601 Vali Loss: 3.610 Vali Acc: 0.353 Test Loss: 3.610 Test Acc: 0.353
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.9892825
	speed: 0.1875s/iter; left time: 2406.9403s
Epoch: 17 cost time: 7.6928064823150635
Epoch: 17, Steps: 154 | Train Loss: 1.804 Vali Loss: 3.800 Vali Acc: 0.364 Test Loss: 3.800 Test Acc: 0.364
Validation loss decreased (-0.356823 --> -0.364114).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.7109054
	speed: 0.1945s/iter; left time: 2467.0850s
Epoch: 18 cost time: 6.61824893951416
Epoch: 18, Steps: 154 | Train Loss: 1.669 Vali Loss: 4.010 Vali Acc: 0.306 Test Loss: 4.010 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.8055182
	speed: 0.2061s/iter; left time: 2582.1493s
Epoch: 19 cost time: 8.53226113319397
Epoch: 19, Steps: 154 | Train Loss: 1.885 Vali Loss: 4.111 Vali Acc: 0.354 Test Loss: 4.111 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.3641452
	speed: 0.2121s/iter; left time: 2625.2863s
Epoch: 20 cost time: 7.585324287414551
Epoch: 20, Steps: 154 | Train Loss: 1.734 Vali Loss: 4.349 Vali Acc: 0.097 Test Loss: 4.349 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.0821794
	speed: 0.2067s/iter; left time: 2526.1244s
Epoch: 21 cost time: 7.574100494384766
Epoch: 21, Steps: 154 | Train Loss: 1.595 Vali Loss: 4.248 Vali Acc: 0.353 Test Loss: 4.248 Test Acc: 0.353
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 2.1960421
	speed: 0.1906s/iter; left time: 2300.0113s
Epoch: 22 cost time: 7.084362983703613
Epoch: 22, Steps: 154 | Train Loss: 1.497 Vali Loss: 4.316 Vali Acc: 0.184 Test Loss: 4.316 Test Acc: 0.184
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 5.2811928
	speed: 0.1923s/iter; left time: 2291.0534s
Epoch: 23 cost time: 7.517200469970703
Epoch: 23, Steps: 154 | Train Loss: 1.645 Vali Loss: 3.925 Vali Acc: 0.368 Test Loss: 3.925 Test Acc: 0.368
Validation loss decreased (-0.364114 --> -0.367763).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.3568350
	speed: 0.1833s/iter; left time: 2155.3748s
Epoch: 24 cost time: 7.118898868560791
Epoch: 24, Steps: 154 | Train Loss: 1.392 Vali Loss: 4.114 Vali Acc: 0.376 Test Loss: 4.114 Test Acc: 0.376
Validation loss decreased (-0.367763 --> -0.375871).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.8714967
	speed: 0.1899s/iter; left time: 2203.9601s
Epoch: 25 cost time: 7.5281736850738525
Epoch: 25, Steps: 154 | Train Loss: 2.091 Vali Loss: 5.260 Vali Acc: 0.087 Test Loss: 5.260 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.5810058
	speed: 0.1843s/iter; left time: 2110.5281s
Epoch: 26 cost time: 7.070435047149658
Epoch: 26, Steps: 154 | Train Loss: 1.936 Vali Loss: 4.528 Vali Acc: 0.219 Test Loss: 4.528 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 3.1877086
	speed: 0.1994s/iter; left time: 2252.7424s
Epoch: 27 cost time: 8.119032382965088
Epoch: 27, Steps: 154 | Train Loss: 1.372 Vali Loss: 4.571 Vali Acc: 0.110 Test Loss: 4.571 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.7747099
	speed: 0.2108s/iter; left time: 2349.4405s
Epoch: 28 cost time: 7.719158172607422
Epoch: 28, Steps: 154 | Train Loss: 1.419 Vali Loss: 4.595 Vali Acc: 0.395 Test Loss: 4.595 Test Acc: 0.395
Validation loss decreased (-0.375871 --> -0.394926).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.0833137
	speed: 0.2122s/iter; left time: 2331.4702s
Epoch: 29 cost time: 7.664628028869629
Epoch: 29, Steps: 154 | Train Loss: 1.295 Vali Loss: 4.636 Vali Acc: 0.126 Test Loss: 4.636 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.4625584
	speed: 0.2136s/iter; left time: 2313.9388s
Epoch: 30 cost time: 7.700875282287598
Epoch: 30, Steps: 154 | Train Loss: 1.542 Vali Loss: 6.457 Vali Acc: 0.094 Test Loss: 6.457 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.3043507
	speed: 0.1988s/iter; left time: 2122.8984s
Epoch: 31 cost time: 7.3441057205200195
Epoch: 31, Steps: 154 | Train Loss: 1.481 Vali Loss: 6.002 Vali Acc: 0.100 Test Loss: 6.002 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.0961767
	speed: 0.1821s/iter; left time: 1917.1233s
Epoch: 32 cost time: 7.56217360496521
Epoch: 32, Steps: 154 | Train Loss: 1.649 Vali Loss: 5.451 Vali Acc: 0.373 Test Loss: 5.451 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.9799849
	speed: 0.1913s/iter; left time: 1984.2191s
Epoch: 33 cost time: 7.423908233642578
Epoch: 33, Steps: 154 | Train Loss: 1.586 Vali Loss: 6.148 Vali Acc: 0.375 Test Loss: 6.148 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 1.5583124
	speed: 0.1837s/iter; left time: 1877.2373s
Epoch: 34 cost time: 7.134577989578247
Epoch: 34, Steps: 154 | Train Loss: 1.271 Vali Loss: 5.820 Vali Acc: 0.366 Test Loss: 5.820 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 2.7944813
	speed: 0.1767s/iter; left time: 1777.9905s
Epoch: 35 cost time: 6.196835994720459
Epoch: 35, Steps: 154 | Train Loss: 1.213 Vali Loss: 5.535 Vali Acc: 0.224 Test Loss: 5.535 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 1.1733425
	speed: 0.1837s/iter; left time: 1820.2614s
Epoch: 36 cost time: 7.771692276000977
Epoch: 36, Steps: 154 | Train Loss: 1.349 Vali Loss: 6.875 Vali Acc: 0.090 Test Loss: 6.875 Test Acc: 0.090
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.8054762
	speed: 0.2077s/iter; left time: 2026.8788s
Epoch: 37 cost time: 6.939340353012085
Epoch: 37, Steps: 154 | Train Loss: 1.260 Vali Loss: 7.440 Vali Acc: 0.084 Test Loss: 7.440 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 11.7924337
	speed: 0.2035s/iter; left time: 1953.9698s
Epoch: 38 cost time: 7.27067756652832
Epoch: 38, Steps: 154 | Train Loss: 1.746 Vali Loss: 6.942 Vali Acc: 0.084 Test Loss: 6.942 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39497161394971614
model parameter : 2901046
model size : 20.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6447042
	speed: 0.0643s/iter; left time: 984.2866s
Epoch: 1 cost time: 8.78914499282837
Epoch: 1, Steps: 154 | Train Loss: 2.307 Vali Loss: 2.319 Vali Acc: 0.321 Test Loss: 2.319 Test Acc: 0.321
Validation loss decreased (inf --> -0.320739).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.9447484
	speed: 0.1830s/iter; left time: 2772.1712s
Epoch: 2 cost time: 6.827398300170898
Epoch: 2, Steps: 154 | Train Loss: 2.159 Vali Loss: 2.209 Vali Acc: 0.333 Test Loss: 2.209 Test Acc: 0.333
Validation loss decreased (-0.320739 --> -0.332906).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6308415
	speed: 0.1841s/iter; left time: 2760.4493s
Epoch: 3 cost time: 7.266515254974365
Epoch: 3, Steps: 154 | Train Loss: 2.079 Vali Loss: 2.246 Vali Acc: 0.327 Test Loss: 2.246 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6992078
	speed: 0.1822s/iter; left time: 2703.3737s
Epoch: 4 cost time: 6.808320999145508
Epoch: 4, Steps: 154 | Train Loss: 1.897 Vali Loss: 2.540 Vali Acc: 0.050 Test Loss: 2.540 Test Acc: 0.050
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.0279031
	speed: 0.1785s/iter; left time: 2621.2153s
Epoch: 5 cost time: 6.944998025894165
Epoch: 5, Steps: 154 | Train Loss: 2.100 Vali Loss: 2.589 Vali Acc: 0.330 Test Loss: 2.589 Test Acc: 0.330
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.2046206
	speed: 0.2062s/iter; left time: 2996.4381s
Epoch: 6 cost time: 7.451965093612671
Epoch: 6, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.695 Vali Acc: 0.334 Test Loss: 2.695 Test Acc: 0.334
Validation loss decreased (-0.332906 --> -0.334117).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9119589
	speed: 0.1944s/iter; left time: 2795.2840s
Epoch: 7 cost time: 6.693547964096069
Epoch: 7, Steps: 154 | Train Loss: 1.918 Vali Loss: 2.489 Vali Acc: 0.345 Test Loss: 2.489 Test Acc: 0.345
Validation loss decreased (-0.334117 --> -0.344663).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3837037
	speed: 0.2064s/iter; left time: 2935.8168s
Epoch: 8 cost time: 7.606137990951538
Epoch: 8, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.944 Vali Acc: 0.179 Test Loss: 2.944 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.2006934
	speed: 0.1837s/iter; left time: 2583.9192s
Epoch: 9 cost time: 6.879302740097046
Epoch: 9, Steps: 154 | Train Loss: 1.754 Vali Loss: 2.882 Vali Acc: 0.343 Test Loss: 2.882 Test Acc: 0.343
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.2029374
	speed: 0.1783s/iter; left time: 2481.2635s
Epoch: 10 cost time: 6.97129225730896
Epoch: 10, Steps: 154 | Train Loss: 1.708 Vali Loss: 3.375 Vali Acc: 0.347 Test Loss: 3.375 Test Acc: 0.347
Validation loss decreased (-0.344663 --> -0.346682).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3930523
	speed: 0.1824s/iter; left time: 2510.4848s
Epoch: 11 cost time: 7.220181226730347
Epoch: 11, Steps: 154 | Train Loss: 1.828 Vali Loss: 3.417 Vali Acc: 0.230 Test Loss: 3.417 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7522010
	speed: 0.1828s/iter; left time: 2487.3675s
Epoch: 12 cost time: 6.885544538497925
Epoch: 12, Steps: 154 | Train Loss: 1.766 Vali Loss: 3.407 Vali Acc: 0.190 Test Loss: 3.407 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.3793722
	speed: 0.1845s/iter; left time: 2481.6098s
Epoch: 13 cost time: 7.139614105224609
Epoch: 13, Steps: 154 | Train Loss: 1.677 Vali Loss: 3.454 Vali Acc: 0.091 Test Loss: 3.454 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.6289747
	speed: 0.1827s/iter; left time: 2429.4643s
Epoch: 14 cost time: 7.491023063659668
Epoch: 14, Steps: 154 | Train Loss: 2.224 Vali Loss: 3.506 Vali Acc: 0.092 Test Loss: 3.506 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.5956722
	speed: 0.2066s/iter; left time: 2715.7130s
Epoch: 15 cost time: 7.041244268417358
Epoch: 15, Steps: 154 | Train Loss: 1.616 Vali Loss: 3.724 Vali Acc: 0.151 Test Loss: 3.724 Test Acc: 0.151
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 2.0670605
	speed: 0.1990s/iter; left time: 2585.0484s
Epoch: 16 cost time: 7.247148752212524
Epoch: 16, Steps: 154 | Train Loss: 1.682 Vali Loss: 3.588 Vali Acc: 0.365 Test Loss: 3.588 Test Acc: 0.365
Validation loss decreased (-0.346682 --> -0.364522).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.6426259
	speed: 0.2006s/iter; left time: 2574.6525s
Epoch: 17 cost time: 6.947662591934204
Epoch: 17, Steps: 154 | Train Loss: 1.684 Vali Loss: 4.211 Vali Acc: 0.361 Test Loss: 4.211 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.6514318
	speed: 0.1836s/iter; left time: 2328.3832s
Epoch: 18 cost time: 7.150817632675171
Epoch: 18, Steps: 154 | Train Loss: 1.778 Vali Loss: 4.217 Vali Acc: 0.185 Test Loss: 4.217 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.9057025
	speed: 0.1793s/iter; left time: 2246.4949s
Epoch: 19 cost time: 6.89574933052063
Epoch: 19, Steps: 154 | Train Loss: 1.607 Vali Loss: 4.712 Vali Acc: 0.349 Test Loss: 4.712 Test Acc: 0.349
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.1180527
	speed: 0.1749s/iter; left time: 2164.9549s
Epoch: 20 cost time: 6.7541327476501465
Epoch: 20, Steps: 154 | Train Loss: 1.705 Vali Loss: 4.043 Vali Acc: 0.090 Test Loss: 4.043 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.8153129
	speed: 0.1778s/iter; left time: 2173.2899s
Epoch: 21 cost time: 7.216660499572754
Epoch: 21, Steps: 154 | Train Loss: 1.716 Vali Loss: 4.001 Vali Acc: 0.111 Test Loss: 4.001 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.6846231
	speed: 0.1827s/iter; left time: 2205.2408s
Epoch: 22 cost time: 7.444672346115112
Epoch: 22, Steps: 154 | Train Loss: 1.702 Vali Loss: 3.960 Vali Acc: 0.109 Test Loss: 3.960 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.3248105
	speed: 0.1821s/iter; left time: 2168.9873s
Epoch: 23 cost time: 6.957788705825806
Epoch: 23, Steps: 154 | Train Loss: 1.512 Vali Loss: 4.143 Vali Acc: 0.380 Test Loss: 4.143 Test Acc: 0.380
Validation loss decreased (-0.364522 --> -0.380332).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.3666540
	speed: 0.2039s/iter; left time: 2397.4175s
Epoch: 24 cost time: 7.852296829223633
Epoch: 24, Steps: 154 | Train Loss: 1.434 Vali Loss: 4.314 Vali Acc: 0.278 Test Loss: 4.314 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.8410237
	speed: 0.2038s/iter; left time: 2364.8097s
Epoch: 25 cost time: 7.260500907897949
Epoch: 25, Steps: 154 | Train Loss: 1.528 Vali Loss: 4.461 Vali Acc: 0.139 Test Loss: 4.461 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.1378639
	speed: 0.1972s/iter; left time: 2258.2584s
Epoch: 26 cost time: 7.534446716308594
Epoch: 26, Steps: 154 | Train Loss: 1.457 Vali Loss: 4.962 Vali Acc: 0.226 Test Loss: 4.962 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.8071355
	speed: 0.1961s/iter; left time: 2215.8979s
Epoch: 27 cost time: 8.862000465393066
Epoch: 27, Steps: 154 | Train Loss: 2.121 Vali Loss: 4.848 Vali Acc: 0.385 Test Loss: 4.848 Test Acc: 0.385
Validation loss decreased (-0.380332 --> -0.385191).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.8145218
	speed: 0.2111s/iter; left time: 2352.8406s
Epoch: 28 cost time: 5.65399432182312
Epoch: 28, Steps: 154 | Train Loss: 1.510 Vali Loss: 5.034 Vali Acc: 0.373 Test Loss: 5.034 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.0536702
	speed: 0.1330s/iter; left time: 1461.0801s
Epoch: 29 cost time: 4.56920862197876
Epoch: 29, Steps: 154 | Train Loss: 1.283 Vali Loss: 5.874 Vali Acc: 0.090 Test Loss: 5.874 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 1.8642259
	speed: 0.1863s/iter; left time: 2018.9072s
Epoch: 30 cost time: 8.254810810089111
Epoch: 30, Steps: 154 | Train Loss: 1.433 Vali Loss: 5.554 Vali Acc: 0.109 Test Loss: 5.554 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 1.2433920
	speed: 0.1977s/iter; left time: 2111.9027s
Epoch: 31 cost time: 6.709688663482666
Epoch: 31, Steps: 154 | Train Loss: 1.422 Vali Loss: 5.685 Vali Acc: 0.099 Test Loss: 5.685 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.8214598
	speed: 0.1881s/iter; left time: 1979.7540s
Epoch: 32 cost time: 8.063547611236572
Epoch: 32, Steps: 154 | Train Loss: 1.577 Vali Loss: 5.901 Vali Acc: 0.379 Test Loss: 5.901 Test Acc: 0.379
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.8459910
	speed: 0.2034s/iter; left time: 2109.5640s
Epoch: 33 cost time: 7.306213617324829
Epoch: 33, Steps: 154 | Train Loss: 1.410 Vali Loss: 6.096 Vali Acc: 0.169 Test Loss: 6.096 Test Acc: 0.169
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 1.7114277
	speed: 0.1803s/iter; left time: 1842.2917s
Epoch: 34 cost time: 7.25287127494812
Epoch: 34, Steps: 154 | Train Loss: 1.272 Vali Loss: 6.879 Vali Acc: 0.114 Test Loss: 6.879 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 1.2957525
	speed: 0.2041s/iter; left time: 2054.1816s
Epoch: 35 cost time: 7.826279640197754
Epoch: 35, Steps: 154 | Train Loss: 2.201 Vali Loss: 6.420 Vali Acc: 0.197 Test Loss: 6.420 Test Acc: 0.197
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 1.0703253
	speed: 0.2217s/iter; left time: 2197.6733s
Epoch: 36 cost time: 8.957435131072998
Epoch: 36, Steps: 154 | Train Loss: 1.241 Vali Loss: 6.519 Vali Acc: 0.125 Test Loss: 6.519 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 1.6719815
	speed: 0.2089s/iter; left time: 2037.9534s
Epoch: 37 cost time: 7.266765594482422
Epoch: 37, Steps: 154 | Train Loss: 1.319 Vali Loss: 8.027 Vali Acc: 0.086 Test Loss: 8.027 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38523925385239255
model parameter : 2901046
model size : 20.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6706024
	speed: 0.0621s/iter; left time: 950.3643s
Epoch: 1 cost time: 8.921583414077759
Epoch: 1, Steps: 154 | Train Loss: 2.302 Vali Loss: 2.320 Vali Acc: 0.322 Test Loss: 2.320 Test Acc: 0.322
Validation loss decreased (inf --> -0.321956).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.0155091
	speed: 0.2049s/iter; left time: 3103.5307s
Epoch: 2 cost time: 7.9934282302856445
Epoch: 2, Steps: 154 | Train Loss: 2.110 Vali Loss: 2.213 Vali Acc: 0.328 Test Loss: 2.213 Test Acc: 0.328
Validation loss decreased (-0.321956 --> -0.327634).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.6330414
	speed: 0.1855s/iter; left time: 2781.0329s
Epoch: 3 cost time: 7.932342052459717
Epoch: 3, Steps: 154 | Train Loss: 2.047 Vali Loss: 2.223 Vali Acc: 0.329 Test Loss: 2.223 Test Acc: 0.329
Validation loss decreased (-0.327634 --> -0.329256).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6752052
	speed: 0.1986s/iter; left time: 2947.6991s
Epoch: 4 cost time: 7.079589128494263
Epoch: 4, Steps: 154 | Train Loss: 1.930 Vali Loss: 2.525 Vali Acc: 0.129 Test Loss: 2.525 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.0594256
	speed: 0.1837s/iter; left time: 2697.7171s
Epoch: 5 cost time: 8.299408197402954
Epoch: 5, Steps: 154 | Train Loss: 1.985 Vali Loss: 2.525 Vali Acc: 0.333 Test Loss: 2.525 Test Acc: 0.333
Validation loss decreased (-0.329256 --> -0.332497).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1303036
	speed: 0.2159s/iter; left time: 3137.3170s
Epoch: 6 cost time: 7.57820987701416
Epoch: 6, Steps: 154 | Train Loss: 1.909 Vali Loss: 2.578 Vali Acc: 0.337 Test Loss: 2.578 Test Acc: 0.337
Validation loss decreased (-0.332497 --> -0.337363).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0325757
	speed: 0.2057s/iter; left time: 2957.3975s
Epoch: 7 cost time: 7.881186008453369
Epoch: 7, Steps: 154 | Train Loss: 1.910 Vali Loss: 2.697 Vali Acc: 0.341 Test Loss: 2.697 Test Acc: 0.341
Validation loss decreased (-0.337363 --> -0.340606).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2772982
	speed: 0.2135s/iter; left time: 3036.8375s
Epoch: 8 cost time: 7.211099624633789
Epoch: 8, Steps: 154 | Train Loss: 1.896 Vali Loss: 3.022 Vali Acc: 0.180 Test Loss: 3.022 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.9494669
	speed: 0.2037s/iter; left time: 2866.3548s
Epoch: 9 cost time: 7.473352909088135
Epoch: 9, Steps: 154 | Train Loss: 1.838 Vali Loss: 2.932 Vali Acc: 0.348 Test Loss: 2.932 Test Acc: 0.348
Validation loss decreased (-0.340606 --> -0.348308).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3999441
	speed: 0.1820s/iter; left time: 2533.1762s
Epoch: 10 cost time: 7.151392698287964
Epoch: 10, Steps: 154 | Train Loss: 1.828 Vali Loss: 3.223 Vali Acc: 0.354 Test Loss: 3.223 Test Acc: 0.354
Validation loss decreased (-0.348308 --> -0.354388).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5998378
	speed: 0.2020s/iter; left time: 2779.3218s
Epoch: 11 cost time: 7.727237224578857
Epoch: 11, Steps: 154 | Train Loss: 1.678 Vali Loss: 3.050 Vali Acc: 0.353 Test Loss: 3.050 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9236959
	speed: 0.1875s/iter; left time: 2551.8430s
Epoch: 12 cost time: 6.794781446456909
Epoch: 12, Steps: 154 | Train Loss: 1.744 Vali Loss: 3.397 Vali Acc: 0.192 Test Loss: 3.397 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.6637616
	speed: 0.1892s/iter; left time: 2544.9595s
Epoch: 13 cost time: 8.422823190689087
Epoch: 13, Steps: 154 | Train Loss: 1.746 Vali Loss: 3.414 Vali Acc: 0.284 Test Loss: 3.414 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.3740577
	speed: 0.1959s/iter; left time: 2605.3129s
Epoch: 14 cost time: 7.058802843093872
Epoch: 14, Steps: 154 | Train Loss: 1.797 Vali Loss: 3.656 Vali Acc: 0.090 Test Loss: 3.656 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.8289680
	speed: 0.2131s/iter; left time: 2801.1769s
Epoch: 15 cost time: 7.9688966274261475
Epoch: 15, Steps: 154 | Train Loss: 1.690 Vali Loss: 3.597 Vali Acc: 0.358 Test Loss: 3.597 Test Acc: 0.358
Validation loss decreased (-0.354388 --> -0.357628).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.0965202
	speed: 0.2095s/iter; left time: 2721.9275s
Epoch: 16 cost time: 8.103432655334473
Epoch: 16, Steps: 154 | Train Loss: 2.366 Vali Loss: 4.404 Vali Acc: 0.354 Test Loss: 4.404 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.6917152
	speed: 0.2252s/iter; left time: 2890.3560s
Epoch: 17 cost time: 8.01777458190918
Epoch: 17, Steps: 154 | Train Loss: 1.566 Vali Loss: 4.048 Vali Acc: 0.220 Test Loss: 4.048 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.4211770
	speed: 0.1852s/iter; left time: 2349.0849s
Epoch: 18 cost time: 7.616264581680298
Epoch: 18, Steps: 154 | Train Loss: 1.913 Vali Loss: 3.894 Vali Acc: 0.353 Test Loss: 3.894 Test Acc: 0.353
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 2.0683217
	speed: 0.2060s/iter; left time: 2581.4430s
Epoch: 19 cost time: 7.875685930252075
Epoch: 19, Steps: 154 | Train Loss: 1.607 Vali Loss: 4.400 Vali Acc: 0.356 Test Loss: 4.400 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.1347427
	speed: 0.1825s/iter; left time: 2257.9618s
Epoch: 20 cost time: 7.645604133605957
Epoch: 20, Steps: 154 | Train Loss: 1.858 Vali Loss: 4.811 Vali Acc: 0.091 Test Loss: 4.811 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.2302580
	speed: 0.2026s/iter; left time: 2475.6026s
Epoch: 21 cost time: 8.170934915542603
Epoch: 21, Steps: 154 | Train Loss: 1.556 Vali Loss: 4.560 Vali Acc: 0.361 Test Loss: 4.560 Test Acc: 0.361
Validation loss decreased (-0.357628 --> -0.360863).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.6807995
	speed: 0.2026s/iter; left time: 2444.8091s
Epoch: 22 cost time: 6.993165731430054
Epoch: 22, Steps: 154 | Train Loss: 1.694 Vali Loss: 4.821 Vali Acc: 0.118 Test Loss: 4.821 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 3.2922642
	speed: 0.1984s/iter; left time: 2363.2114s
Epoch: 23 cost time: 8.051669359207153
Epoch: 23, Steps: 154 | Train Loss: 1.990 Vali Loss: 4.330 Vali Acc: 0.376 Test Loss: 4.330 Test Acc: 0.376
Validation loss decreased (-0.360863 --> -0.376275).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.1357385
	speed: 0.2130s/iter; left time: 2505.0181s
Epoch: 24 cost time: 6.975002765655518
Epoch: 24, Steps: 154 | Train Loss: 1.511 Vali Loss: 5.219 Vali Acc: 0.142 Test Loss: 5.219 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.5309023
	speed: 0.2115s/iter; left time: 2454.1703s
Epoch: 25 cost time: 7.63848090171814
Epoch: 25, Steps: 154 | Train Loss: 1.509 Vali Loss: 4.823 Vali Acc: 0.212 Test Loss: 4.823 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.7505819
	speed: 0.1995s/iter; left time: 2284.5266s
Epoch: 26 cost time: 7.3774120807647705
Epoch: 26, Steps: 154 | Train Loss: 1.297 Vali Loss: 5.438 Vali Acc: 0.225 Test Loss: 5.438 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.6938528
	speed: 0.2083s/iter; left time: 2353.6887s
Epoch: 27 cost time: 8.372478246688843
Epoch: 27, Steps: 154 | Train Loss: 1.327 Vali Loss: 5.796 Vali Acc: 0.283 Test Loss: 5.796 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.7728426
	speed: 0.1893s/iter; left time: 2109.0684s
Epoch: 28 cost time: 7.010635852813721
Epoch: 28, Steps: 154 | Train Loss: 1.378 Vali Loss: 5.774 Vali Acc: 0.380 Test Loss: 5.774 Test Acc: 0.380
Validation loss decreased (-0.376275 --> -0.379910).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.7981892
	speed: 0.2029s/iter; left time: 2229.8705s
Epoch: 29 cost time: 8.3017258644104
Epoch: 29, Steps: 154 | Train Loss: 1.267 Vali Loss: 5.614 Vali Acc: 0.127 Test Loss: 5.614 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 4.7733183
	speed: 0.1900s/iter; left time: 2058.4497s
Epoch: 30 cost time: 7.902831554412842
Epoch: 30, Steps: 154 | Train Loss: 1.293 Vali Loss: 6.492 Vali Acc: 0.184 Test Loss: 6.492 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.1930909
	speed: 0.1953s/iter; left time: 2086.3658s
Epoch: 31 cost time: 7.823974847793579
Epoch: 31, Steps: 154 | Train Loss: 1.998 Vali Loss: 7.190 Vali Acc: 0.096 Test Loss: 7.190 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.9477984
	speed: 0.1966s/iter; left time: 2069.3099s
Epoch: 32 cost time: 7.919413089752197
Epoch: 32, Steps: 154 | Train Loss: 1.883 Vali Loss: 5.994 Vali Acc: 0.373 Test Loss: 5.994 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 1.5534582
	speed: 0.2175s/iter; left time: 2256.1486s
Epoch: 33 cost time: 7.401063919067383
Epoch: 33, Steps: 154 | Train Loss: 2.497 Vali Loss: 5.826 Vali Acc: 0.220 Test Loss: 5.826 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 1.2936847
	speed: 0.1988s/iter; left time: 2031.3633s
Epoch: 34 cost time: 7.69787335395813
Epoch: 34, Steps: 154 | Train Loss: 2.576 Vali Loss: 7.788 Vali Acc: 0.107 Test Loss: 7.788 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 1.8530729
	speed: 0.2235s/iter; left time: 2249.2300s
Epoch: 35 cost time: 7.937572717666626
Epoch: 35, Steps: 154 | Train Loss: 1.394 Vali Loss: 8.308 Vali Acc: 0.217 Test Loss: 8.308 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.8548596
	speed: 0.1791s/iter; left time: 1774.5860s
Epoch: 36 cost time: 6.701901435852051
Epoch: 36, Steps: 154 | Train Loss: 1.094 Vali Loss: 7.927 Vali Acc: 0.112 Test Loss: 7.927 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 1.3908536
	speed: 0.1912s/iter; left time: 1865.9167s
Epoch: 37 cost time: 7.55197286605835
Epoch: 37, Steps: 154 | Train Loss: 1.030 Vali Loss: 10.024 Vali Acc: 0.075 Test Loss: 10.024 Test Acc: 0.075
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 1.0694064
	speed: 0.1805s/iter; left time: 1733.8099s
Epoch: 38 cost time: 7.342751502990723
Epoch: 38, Steps: 154 | Train Loss: 1.281 Vali Loss: 7.688 Vali Acc: 0.107 Test Loss: 7.688 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 2901046
model size : 20.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6971617
	speed: 0.0610s/iter; left time: 932.6734s
Epoch: 1 cost time: 8.52734899520874
Epoch: 1, Steps: 154 | Train Loss: 2.273 Vali Loss: 2.301 Vali Acc: 0.322 Test Loss: 2.301 Test Acc: 0.322
Validation loss decreased (inf --> -0.321550).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.7662191
	speed: 0.2121s/iter; left time: 3212.3539s
Epoch: 2 cost time: 8.70627236366272
Epoch: 2, Steps: 154 | Train Loss: 2.134 Vali Loss: 2.172 Vali Acc: 0.327 Test Loss: 2.172 Test Acc: 0.327
Validation loss decreased (-0.321550 --> -0.327229).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8834636
	speed: 0.2039s/iter; left time: 3057.6448s
Epoch: 3 cost time: 6.579531192779541
Epoch: 3, Steps: 154 | Train Loss: 2.031 Vali Loss: 2.219 Vali Acc: 0.333 Test Loss: 2.219 Test Acc: 0.333
Validation loss decreased (-0.327229 --> -0.332906).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6356419
	speed: 0.2097s/iter; left time: 3111.1278s
Epoch: 4 cost time: 8.784158945083618
Epoch: 4, Steps: 154 | Train Loss: 1.972 Vali Loss: 2.399 Vali Acc: 0.337 Test Loss: 2.399 Test Acc: 0.337
Validation loss decreased (-0.332906 --> -0.336959).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3299649
	speed: 0.1995s/iter; left time: 2930.3604s
Epoch: 5 cost time: 6.634053945541382
Epoch: 5, Steps: 154 | Train Loss: 1.944 Vali Loss: 2.362 Vali Acc: 0.337 Test Loss: 2.362 Test Acc: 0.337
Validation loss decreased (-0.336959 --> -0.336959).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1097298
	speed: 0.1892s/iter; left time: 2749.2351s
Epoch: 6 cost time: 7.459292411804199
Epoch: 6, Steps: 154 | Train Loss: 2.014 Vali Loss: 2.474 Vali Acc: 0.336 Test Loss: 2.474 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.5546865
	speed: 0.1790s/iter; left time: 2574.1005s
Epoch: 7 cost time: 7.2838053703308105
Epoch: 7, Steps: 154 | Train Loss: 1.893 Vali Loss: 2.459 Vali Acc: 0.347 Test Loss: 2.459 Test Acc: 0.347
Validation loss decreased (-0.336959 --> -0.346691).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1979151
	speed: 0.1909s/iter; left time: 2714.5678s
Epoch: 8 cost time: 6.865585803985596
Epoch: 8, Steps: 154 | Train Loss: 1.842 Vali Loss: 2.613 Vali Acc: 0.304 Test Loss: 2.613 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.3745601
	speed: 0.1825s/iter; left time: 2567.4673s
Epoch: 9 cost time: 7.526418209075928
Epoch: 9, Steps: 154 | Train Loss: 1.842 Vali Loss: 2.817 Vali Acc: 0.348 Test Loss: 2.817 Test Acc: 0.348
Validation loss decreased (-0.346691 --> -0.347904).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9039433
	speed: 0.1895s/iter; left time: 2636.9217s
Epoch: 10 cost time: 6.803170680999756
Epoch: 10, Steps: 154 | Train Loss: 1.893 Vali Loss: 3.243 Vali Acc: 0.350 Test Loss: 3.243 Test Acc: 0.350
Validation loss decreased (-0.347904 --> -0.350333).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4458666
	speed: 0.2011s/iter; left time: 2767.1832s
Epoch: 11 cost time: 7.55815577507019
Epoch: 11, Steps: 154 | Train Loss: 1.893 Vali Loss: 3.020 Vali Acc: 0.199 Test Loss: 3.020 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8259422
	speed: 0.2077s/iter; left time: 2825.8650s
Epoch: 12 cost time: 7.720727443695068
Epoch: 12, Steps: 154 | Train Loss: 1.834 Vali Loss: 2.962 Vali Acc: 0.195 Test Loss: 2.962 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5383974
	speed: 0.2015s/iter; left time: 2711.2114s
Epoch: 13 cost time: 7.812976837158203
Epoch: 13, Steps: 154 | Train Loss: 1.791 Vali Loss: 3.292 Vali Acc: 0.096 Test Loss: 3.292 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.5035813
	speed: 0.1914s/iter; left time: 2545.2136s
Epoch: 14 cost time: 7.230040550231934
Epoch: 14, Steps: 154 | Train Loss: 1.698 Vali Loss: 3.439 Vali Acc: 0.102 Test Loss: 3.439 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.6753212
	speed: 0.1769s/iter; left time: 2325.3818s
Epoch: 15 cost time: 7.281317472457886
Epoch: 15, Steps: 154 | Train Loss: 2.166 Vali Loss: 3.218 Vali Acc: 0.361 Test Loss: 3.218 Test Acc: 0.361
Validation loss decreased (-0.350333 --> -0.360876).  Saving model ...
	iters: 100, epoch: 16 | loss: 14.2363596
	speed: 0.1903s/iter; left time: 2472.5858s
Epoch: 16 cost time: 7.153335094451904
Epoch: 16, Steps: 154 | Train Loss: 1.705 Vali Loss: 4.093 Vali Acc: 0.358 Test Loss: 4.093 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.9876591
	speed: 0.1801s/iter; left time: 2311.4164s
Epoch: 17 cost time: 7.028445243835449
Epoch: 17, Steps: 154 | Train Loss: 1.991 Vali Loss: 4.153 Vali Acc: 0.357 Test Loss: 4.153 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.3839948
	speed: 0.1709s/iter; left time: 2167.8047s
Epoch: 18 cost time: 7.525726318359375
Epoch: 18, Steps: 154 | Train Loss: 1.929 Vali Loss: 3.712 Vali Acc: 0.338 Test Loss: 3.712 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 2.1266451
	speed: 0.2022s/iter; left time: 2533.5445s
Epoch: 19 cost time: 8.452860116958618
Epoch: 19, Steps: 154 | Train Loss: 1.594 Vali Loss: 4.046 Vali Acc: 0.354 Test Loss: 4.046 Test Acc: 0.354
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.8880484
	speed: 0.2214s/iter; left time: 2740.4066s
Epoch: 20 cost time: 7.243886709213257
Epoch: 20, Steps: 154 | Train Loss: 1.527 Vali Loss: 4.117 Vali Acc: 0.090 Test Loss: 4.117 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.1410135
	speed: 0.2096s/iter; left time: 2561.0765s
Epoch: 21 cost time: 8.647087574005127
Epoch: 21, Steps: 154 | Train Loss: 1.582 Vali Loss: 3.736 Vali Acc: 0.368 Test Loss: 3.736 Test Acc: 0.368
Validation loss decreased (-0.360876 --> -0.368170).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.8084368
	speed: 0.2039s/iter; left time: 2460.8101s
Epoch: 22 cost time: 6.802306652069092
Epoch: 22, Steps: 154 | Train Loss: 1.749 Vali Loss: 3.663 Vali Acc: 0.380 Test Loss: 3.663 Test Acc: 0.380
Validation loss decreased (-0.368170 --> -0.380336).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.9867669
	speed: 0.1906s/iter; left time: 2271.1750s
Epoch: 23 cost time: 7.1778459548950195
Epoch: 23, Steps: 154 | Train Loss: 1.407 Vali Loss: 4.495 Vali Acc: 0.363 Test Loss: 4.495 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.8856586
	speed: 0.1823s/iter; left time: 2143.4775s
Epoch: 24 cost time: 7.464253187179565
Epoch: 24, Steps: 154 | Train Loss: 1.384 Vali Loss: 5.031 Vali Acc: 0.108 Test Loss: 5.031 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.4171630
	speed: 0.1863s/iter; left time: 2162.3933s
Epoch: 25 cost time: 6.911111116409302
Epoch: 25, Steps: 154 | Train Loss: 1.495 Vali Loss: 4.417 Vali Acc: 0.314 Test Loss: 4.417 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.3246772
	speed: 0.1861s/iter; left time: 2130.7621s
Epoch: 26 cost time: 7.34209132194519
Epoch: 26, Steps: 154 | Train Loss: 1.389 Vali Loss: 5.223 Vali Acc: 0.379 Test Loss: 5.223 Test Acc: 0.379
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 3.0965195
	speed: 0.1913s/iter; left time: 2161.5262s
Epoch: 27 cost time: 7.642879009246826
Epoch: 27, Steps: 154 | Train Loss: 1.441 Vali Loss: 5.248 Vali Acc: 0.332 Test Loss: 5.248 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 1.6906556
	speed: 0.1951s/iter; left time: 2174.5457s
Epoch: 28 cost time: 7.648661136627197
Epoch: 28, Steps: 154 | Train Loss: 1.612 Vali Loss: 4.858 Vali Acc: 0.350 Test Loss: 4.858 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.9818043
	speed: 0.2123s/iter; left time: 2333.3003s
Epoch: 29 cost time: 7.751559495925903
Epoch: 29, Steps: 154 | Train Loss: 1.135 Vali Loss: 5.426 Vali Acc: 0.123 Test Loss: 5.426 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.0929854
	speed: 0.2081s/iter; left time: 2254.8140s
Epoch: 30 cost time: 7.605343818664551
Epoch: 30, Steps: 154 | Train Loss: 1.733 Vali Loss: 5.561 Vali Acc: 0.359 Test Loss: 5.561 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 1.7408506
	speed: 0.2103s/iter; left time: 2246.2298s
Epoch: 31 cost time: 7.338144063949585
Epoch: 31, Steps: 154 | Train Loss: 1.307 Vali Loss: 5.227 Vali Acc: 0.384 Test Loss: 5.227 Test Acc: 0.384
Validation loss decreased (-0.380336 --> -0.384376).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.7518891
	speed: 0.1885s/iter; left time: 1984.3843s
Epoch: 32 cost time: 7.941045045852661
Epoch: 32, Steps: 154 | Train Loss: 1.187 Vali Loss: 5.396 Vali Acc: 0.382 Test Loss: 5.396 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 1.2976173
	speed: 0.1915s/iter; left time: 1986.4225s
Epoch: 33 cost time: 7.184794902801514
Epoch: 33, Steps: 154 | Train Loss: 1.160 Vali Loss: 5.419 Vali Acc: 0.231 Test Loss: 5.419 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 1.2105396
	speed: 0.1920s/iter; left time: 1961.8990s
Epoch: 34 cost time: 7.78629469871521
Epoch: 34, Steps: 154 | Train Loss: 2.204 Vali Loss: 6.531 Vali Acc: 0.111 Test Loss: 6.531 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 1.6469070
	speed: 0.1852s/iter; left time: 1863.7136s
Epoch: 35 cost time: 7.104808807373047
Epoch: 35, Steps: 154 | Train Loss: 1.776 Vali Loss: 7.251 Vali Acc: 0.111 Test Loss: 7.251 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.6749750
	speed: 0.1942s/iter; left time: 1924.9752s
Epoch: 36 cost time: 7.539636850357056
Epoch: 36, Steps: 154 | Train Loss: 2.037 Vali Loss: 8.985 Vali Acc: 0.103 Test Loss: 8.985 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.9537076
	speed: 0.1952s/iter; left time: 1904.3360s
Epoch: 37 cost time: 7.50154972076416
Epoch: 37, Steps: 154 | Train Loss: 1.857 Vali Loss: 10.298 Vali Acc: 0.101 Test Loss: 10.298 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.6172445
	speed: 0.2057s/iter; left time: 1975.0420s
Epoch: 38 cost time: 7.103186845779419
Epoch: 38, Steps: 154 | Train Loss: 1.360 Vali Loss: 9.097 Vali Acc: 0.096 Test Loss: 9.097 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.6796238
	speed: 0.2089s/iter; left time: 1973.4370s
Epoch: 39 cost time: 7.184196949005127
Epoch: 39, Steps: 154 | Train Loss: 1.551 Vali Loss: 11.521 Vali Acc: 0.088 Test Loss: 11.521 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 1.2179379
	speed: 0.1920s/iter; left time: 1784.8510s
Epoch: 40 cost time: 7.351094484329224
Epoch: 40, Steps: 154 | Train Loss: 1.470 Vali Loss: 9.316 Vali Acc: 0.109 Test Loss: 9.316 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.6812705
	speed: 0.1976s/iter; left time: 1806.5129s
Epoch: 41 cost time: 7.21164870262146
Epoch: 41, Steps: 154 | Train Loss: 2.422 Vali Loss: 9.823 Vali Acc: 0.097 Test Loss: 9.823 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3844282238442822
model parameter : 2901046
model size : 20.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9499807
	speed: 0.0656s/iter; left time: 1003.3832s
Epoch: 1 cost time: 9.039231061935425
Epoch: 1, Steps: 154 | Train Loss: 2.307 Vali Loss: 2.280 Vali Acc: 0.320 Test Loss: 2.280 Test Acc: 0.320
Validation loss decreased (inf --> -0.319929).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.1002288
	speed: 0.1819s/iter; left time: 2754.9788s
Epoch: 2 cost time: 7.348336696624756
Epoch: 2, Steps: 154 | Train Loss: 2.136 Vali Loss: 2.335 Vali Acc: 0.329 Test Loss: 2.335 Test Acc: 0.329
Validation loss decreased (-0.319929 --> -0.328849).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8665144
	speed: 0.1878s/iter; left time: 2815.8498s
Epoch: 3 cost time: 7.176167011260986
Epoch: 3, Steps: 154 | Train Loss: 1.995 Vali Loss: 2.306 Vali Acc: 0.326 Test Loss: 2.306 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8947625
	speed: 0.2083s/iter; left time: 3090.9553s
Epoch: 4 cost time: 7.9505720138549805
Epoch: 4, Steps: 154 | Train Loss: 2.043 Vali Loss: 2.302 Vali Acc: 0.329 Test Loss: 2.302 Test Acc: 0.329
Validation loss decreased (-0.328849 --> -0.328850).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9035480
	speed: 0.2040s/iter; left time: 2996.2788s
Epoch: 5 cost time: 7.864072561264038
Epoch: 5, Steps: 154 | Train Loss: 1.988 Vali Loss: 2.502 Vali Acc: 0.330 Test Loss: 2.502 Test Acc: 0.330
Validation loss decreased (-0.328850 --> -0.330064).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0838101
	speed: 0.2102s/iter; left time: 3054.5932s
Epoch: 6 cost time: 7.478435039520264
Epoch: 6, Steps: 154 | Train Loss: 1.893 Vali Loss: 2.552 Vali Acc: 0.341 Test Loss: 2.552 Test Acc: 0.341
Validation loss decreased (-0.330064 --> -0.341418).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1194727
	speed: 0.1901s/iter; left time: 2733.2299s
Epoch: 7 cost time: 7.5883543491363525
Epoch: 7, Steps: 154 | Train Loss: 1.828 Vali Loss: 2.464 Vali Acc: 0.343 Test Loss: 2.464 Test Acc: 0.343
Validation loss decreased (-0.341418 --> -0.342636).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0737240
	speed: 0.1798s/iter; left time: 2556.8151s
Epoch: 8 cost time: 7.303632736206055
Epoch: 8, Steps: 154 | Train Loss: 1.808 Vali Loss: 2.763 Vali Acc: 0.358 Test Loss: 2.763 Test Acc: 0.358
Validation loss decreased (-0.342636 --> -0.357637).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7016714
	speed: 0.1792s/iter; left time: 2520.9589s
Epoch: 9 cost time: 7.076609134674072
Epoch: 9, Steps: 154 | Train Loss: 1.942 Vali Loss: 3.025 Vali Acc: 0.341 Test Loss: 3.025 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.8750350
	speed: 0.1874s/iter; left time: 2607.5733s
Epoch: 10 cost time: 7.218229055404663
Epoch: 10, Steps: 154 | Train Loss: 2.164 Vali Loss: 3.123 Vali Acc: 0.347 Test Loss: 3.123 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5918700
	speed: 0.1819s/iter; left time: 2503.3905s
Epoch: 11 cost time: 7.0255982875823975
Epoch: 11, Steps: 154 | Train Loss: 1.720 Vali Loss: 2.975 Vali Acc: 0.357 Test Loss: 2.975 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.4194238
	speed: 0.2018s/iter; left time: 2745.3650s
Epoch: 12 cost time: 7.641955137252808
Epoch: 12, Steps: 154 | Train Loss: 1.676 Vali Loss: 3.648 Vali Acc: 0.099 Test Loss: 3.648 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.5798289
	speed: 0.2061s/iter; left time: 2772.3247s
Epoch: 13 cost time: 7.816571950912476
Epoch: 13, Steps: 154 | Train Loss: 1.729 Vali Loss: 3.562 Vali Acc: 0.094 Test Loss: 3.562 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.4081830
	speed: 0.2016s/iter; left time: 2680.4713s
Epoch: 14 cost time: 7.044100284576416
Epoch: 14, Steps: 154 | Train Loss: 1.653 Vali Loss: 3.682 Vali Acc: 0.071 Test Loss: 3.682 Test Acc: 0.071
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 2.0805478
	speed: 0.2104s/iter; left time: 2766.2218s
Epoch: 15 cost time: 7.673550128936768
Epoch: 15, Steps: 154 | Train Loss: 1.954 Vali Loss: 3.412 Vali Acc: 0.200 Test Loss: 3.412 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.8036196
	speed: 0.1767s/iter; left time: 2295.0725s
Epoch: 16 cost time: 6.863619089126587
Epoch: 16, Steps: 154 | Train Loss: 1.568 Vali Loss: 3.343 Vali Acc: 0.365 Test Loss: 3.343 Test Acc: 0.365
Validation loss decreased (-0.357637 --> -0.365336).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.8024029
	speed: 0.1839s/iter; left time: 2361.3447s
Epoch: 17 cost time: 6.966253042221069
Epoch: 17, Steps: 154 | Train Loss: 2.026 Vali Loss: 4.438 Vali Acc: 0.087 Test Loss: 4.438 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.3288167
	speed: 0.1813s/iter; left time: 2299.7035s
Epoch: 18 cost time: 7.6836464405059814
Epoch: 18, Steps: 154 | Train Loss: 2.391 Vali Loss: 4.105 Vali Acc: 0.362 Test Loss: 4.105 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.9063524
	speed: 0.1853s/iter; left time: 2321.2087s
Epoch: 19 cost time: 7.053481817245483
Epoch: 19, Steps: 154 | Train Loss: 1.860 Vali Loss: 4.211 Vali Acc: 0.345 Test Loss: 4.211 Test Acc: 0.345
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.5282153
	speed: 0.1857s/iter; left time: 2298.1111s
Epoch: 20 cost time: 7.4444899559021
Epoch: 20, Steps: 154 | Train Loss: 1.591 Vali Loss: 4.125 Vali Acc: 0.309 Test Loss: 4.125 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.6964065
	speed: 0.1977s/iter; left time: 2416.3638s
Epoch: 21 cost time: 7.991374731063843
Epoch: 21, Steps: 154 | Train Loss: 1.478 Vali Loss: 4.400 Vali Acc: 0.169 Test Loss: 4.400 Test Acc: 0.169
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.8795022
	speed: 0.2102s/iter; left time: 2536.8221s
Epoch: 22 cost time: 7.249049425125122
Epoch: 22, Steps: 154 | Train Loss: 1.470 Vali Loss: 4.577 Vali Acc: 0.275 Test Loss: 4.577 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.7745985
	speed: 0.2075s/iter; left time: 2471.6995s
Epoch: 23 cost time: 7.598996162414551
Epoch: 23, Steps: 154 | Train Loss: 1.505 Vali Loss: 5.517 Vali Acc: 0.071 Test Loss: 5.517 Test Acc: 0.071
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.8092657
	speed: 0.2016s/iter; left time: 2370.2730s
Epoch: 24 cost time: 7.094958066940308
Epoch: 24, Steps: 154 | Train Loss: 1.551 Vali Loss: 4.563 Vali Acc: 0.379 Test Loss: 4.563 Test Acc: 0.379
Validation loss decreased (-0.365336 --> -0.379111).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.4754567
	speed: 0.1803s/iter; left time: 2091.8744s
Epoch: 25 cost time: 6.89489483833313
Epoch: 25, Steps: 154 | Train Loss: 1.835 Vali Loss: 5.062 Vali Acc: 0.315 Test Loss: 5.062 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.4906499
	speed: 0.1795s/iter; left time: 2055.3924s
Epoch: 26 cost time: 7.278318643569946
Epoch: 26, Steps: 154 | Train Loss: 1.516 Vali Loss: 4.008 Vali Acc: 0.352 Test Loss: 4.008 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.2692803
	speed: 0.1860s/iter; left time: 2101.6867s
Epoch: 27 cost time: 7.187459468841553
Epoch: 27, Steps: 154 | Train Loss: 1.616 Vali Loss: 5.960 Vali Acc: 0.073 Test Loss: 5.960 Test Acc: 0.073
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.8385257
	speed: 0.1776s/iter; left time: 1979.2712s
Epoch: 28 cost time: 7.107064247131348
Epoch: 28, Steps: 154 | Train Loss: 1.696 Vali Loss: 6.434 Vali Acc: 0.072 Test Loss: 6.434 Test Acc: 0.072
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.7086714
	speed: 0.1849s/iter; left time: 2031.9310s
Epoch: 29 cost time: 7.099435329437256
Epoch: 29, Steps: 154 | Train Loss: 1.497 Vali Loss: 5.577 Vali Acc: 0.122 Test Loss: 5.577 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.6503711
	speed: 0.1992s/iter; left time: 2158.1843s
Epoch: 30 cost time: 7.618528604507446
Epoch: 30, Steps: 154 | Train Loss: 1.385 Vali Loss: 6.414 Vali Acc: 0.100 Test Loss: 6.414 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.8854423
	speed: 0.1990s/iter; left time: 2125.5710s
Epoch: 31 cost time: 7.0190653800964355
Epoch: 31, Steps: 154 | Train Loss: 1.714 Vali Loss: 6.656 Vali Acc: 0.085 Test Loss: 6.656 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.3880171
	speed: 0.2085s/iter; left time: 2194.9316s
Epoch: 32 cost time: 7.342506647109985
Epoch: 32, Steps: 154 | Train Loss: 1.351 Vali Loss: 5.392 Vali Acc: 0.159 Test Loss: 5.392 Test Acc: 0.159
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.4058677
	speed: 0.2022s/iter; left time: 2097.0618s
Epoch: 33 cost time: 6.957147598266602
Epoch: 33, Steps: 154 | Train Loss: 1.658 Vali Loss: 6.861 Vali Acc: 0.087 Test Loss: 6.861 Test Acc: 0.087
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 1.7125429
	speed: 0.1888s/iter; left time: 1929.0913s
Epoch: 34 cost time: 7.402575969696045
Epoch: 34, Steps: 154 | Train Loss: 1.296 Vali Loss: 6.367 Vali Acc: 0.094 Test Loss: 6.367 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3791565287915653
model parameter : 1852470
model size : 16.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9401199
	speed: 0.0632s/iter; left time: 966.4977s
Epoch: 1 cost time: 8.796916723251343
Epoch: 1, Steps: 154 | Train Loss: 2.310 Vali Loss: 2.284 Vali Acc: 0.319 Test Loss: 2.284 Test Acc: 0.319
Validation loss decreased (inf --> -0.318712).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.9653678
	speed: 0.1852s/iter; left time: 2805.3272s
Epoch: 2 cost time: 7.381238698959351
Epoch: 2, Steps: 154 | Train Loss: 2.146 Vali Loss: 2.309 Vali Acc: 0.330 Test Loss: 2.309 Test Acc: 0.330
Validation loss decreased (-0.318712 --> -0.329661).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8444469
	speed: 0.1866s/iter; left time: 2797.7002s
Epoch: 3 cost time: 7.402477979660034
Epoch: 3, Steps: 154 | Train Loss: 2.047 Vali Loss: 2.320 Vali Acc: 0.326 Test Loss: 2.320 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8110565
	speed: 0.1979s/iter; left time: 2936.4172s
Epoch: 4 cost time: 6.998419284820557
Epoch: 4, Steps: 154 | Train Loss: 1.948 Vali Loss: 2.297 Vali Acc: 0.333 Test Loss: 2.297 Test Acc: 0.333
Validation loss decreased (-0.329661 --> -0.333310).  Saving model ...
	iters: 100, epoch: 5 | loss: 5.2934737
	speed: 0.2016s/iter; left time: 2960.8137s
Epoch: 5 cost time: 7.242432117462158
Epoch: 5, Steps: 154 | Train Loss: 2.058 Vali Loss: 2.378 Vali Acc: 0.333 Test Loss: 2.378 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.2208011
	speed: 0.2007s/iter; left time: 2916.7670s
Epoch: 6 cost time: 7.467119216918945
Epoch: 6, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.485 Vali Acc: 0.339 Test Loss: 2.485 Test Acc: 0.339
Validation loss decreased (-0.333310 --> -0.339391).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0039262
	speed: 0.1957s/iter; left time: 2814.1854s
Epoch: 7 cost time: 6.6412436962127686
Epoch: 7, Steps: 154 | Train Loss: 1.972 Vali Loss: 2.432 Vali Acc: 0.352 Test Loss: 2.432 Test Acc: 0.352
Validation loss decreased (-0.339391 --> -0.351963).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5950794
	speed: 0.1813s/iter; left time: 2579.1475s
Epoch: 8 cost time: 7.258346080780029
Epoch: 8, Steps: 154 | Train Loss: 1.763 Vali Loss: 2.969 Vali Acc: 0.343 Test Loss: 2.969 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6775846
	speed: 0.1790s/iter; left time: 2518.9795s
Epoch: 9 cost time: 6.986782073974609
Epoch: 9, Steps: 154 | Train Loss: 1.991 Vali Loss: 3.313 Vali Acc: 0.339 Test Loss: 3.313 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.9847938
	speed: 0.1822s/iter; left time: 2535.8233s
Epoch: 10 cost time: 6.943006277084351
Epoch: 10, Steps: 154 | Train Loss: 1.753 Vali Loss: 3.459 Vali Acc: 0.343 Test Loss: 3.459 Test Acc: 0.343
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6137207
	speed: 0.1941s/iter; left time: 2671.4128s
Epoch: 11 cost time: 7.455398321151733
Epoch: 11, Steps: 154 | Train Loss: 1.716 Vali Loss: 3.467 Vali Acc: 0.252 Test Loss: 3.467 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.5207592
	speed: 0.1844s/iter; left time: 2509.3676s
Epoch: 12 cost time: 6.662529468536377
Epoch: 12, Steps: 154 | Train Loss: 2.006 Vali Loss: 3.511 Vali Acc: 0.197 Test Loss: 3.511 Test Acc: 0.197
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.5907446
	speed: 0.2011s/iter; left time: 2704.7565s
Epoch: 13 cost time: 7.450384855270386
Epoch: 13, Steps: 154 | Train Loss: 1.868 Vali Loss: 4.058 Vali Acc: 0.082 Test Loss: 4.058 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.6610510
	speed: 0.2057s/iter; left time: 2735.7703s
Epoch: 14 cost time: 7.535125970840454
Epoch: 14, Steps: 154 | Train Loss: 1.961 Vali Loss: 3.263 Vali Acc: 0.352 Test Loss: 3.263 Test Acc: 0.352
Validation loss decreased (-0.351963 --> -0.352360).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.8494148
	speed: 0.2020s/iter; left time: 2655.5912s
Epoch: 15 cost time: 7.2167298793792725
Epoch: 15, Steps: 154 | Train Loss: 1.736 Vali Loss: 3.593 Vali Acc: 0.206 Test Loss: 3.593 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.5275112
	speed: 0.1936s/iter; left time: 2515.4122s
Epoch: 16 cost time: 8.933034181594849
Epoch: 16, Steps: 154 | Train Loss: 1.790 Vali Loss: 3.580 Vali Acc: 0.108 Test Loss: 3.580 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.6337759
	speed: 0.2218s/iter; left time: 2847.0771s
Epoch: 17 cost time: 7.473135471343994
Epoch: 17, Steps: 154 | Train Loss: 1.574 Vali Loss: 4.830 Vali Acc: 0.132 Test Loss: 4.830 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.2579041
	speed: 0.1231s/iter; left time: 1560.9281s
Epoch: 18 cost time: 4.69164514541626
Epoch: 18, Steps: 154 | Train Loss: 1.799 Vali Loss: 4.703 Vali Acc: 0.360 Test Loss: 4.703 Test Acc: 0.360
Validation loss decreased (-0.352360 --> -0.359645).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.9279088
	speed: 0.1605s/iter; left time: 2010.7953s
Epoch: 19 cost time: 6.1301469802856445
Epoch: 19, Steps: 154 | Train Loss: 2.205 Vali Loss: 4.325 Vali Acc: 0.167 Test Loss: 4.325 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.4386507
	speed: 0.1618s/iter; left time: 2001.8110s
Epoch: 20 cost time: 7.010829448699951
Epoch: 20, Steps: 154 | Train Loss: 1.629 Vali Loss: 4.517 Vali Acc: 0.180 Test Loss: 4.517 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.8531928
	speed: 0.1809s/iter; left time: 2210.9772s
Epoch: 21 cost time: 7.0010411739349365
Epoch: 21, Steps: 154 | Train Loss: 1.589 Vali Loss: 3.823 Vali Acc: 0.185 Test Loss: 3.823 Test Acc: 0.185
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 2.7071810
	speed: 0.1758s/iter; left time: 2120.9799s
Epoch: 22 cost time: 6.9455180168151855
Epoch: 22, Steps: 154 | Train Loss: 1.538 Vali Loss: 4.758 Vali Acc: 0.090 Test Loss: 4.758 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.0888699
	speed: 0.1839s/iter; left time: 2190.3951s
Epoch: 23 cost time: 7.19268536567688
Epoch: 23, Steps: 154 | Train Loss: 1.531 Vali Loss: 5.419 Vali Acc: 0.083 Test Loss: 5.419 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.5020734
	speed: 0.1873s/iter; left time: 2202.5337s
Epoch: 24 cost time: 7.2547972202301025
Epoch: 24, Steps: 154 | Train Loss: 1.507 Vali Loss: 4.319 Vali Acc: 0.206 Test Loss: 4.319 Test Acc: 0.206
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.0570920
	speed: 0.2064s/iter; left time: 2395.4073s
Epoch: 25 cost time: 7.31217098236084
Epoch: 25, Steps: 154 | Train Loss: 1.450 Vali Loss: 4.928 Vali Acc: 0.104 Test Loss: 4.928 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 2.1161680
	speed: 0.1956s/iter; left time: 2239.5406s
Epoch: 26 cost time: 6.8947718143463135
Epoch: 26, Steps: 154 | Train Loss: 1.877 Vali Loss: 5.187 Vali Acc: 0.109 Test Loss: 5.187 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.5177839
	speed: 0.2041s/iter; left time: 2305.3254s
Epoch: 27 cost time: 6.981043577194214
Epoch: 27, Steps: 154 | Train Loss: 2.091 Vali Loss: 6.257 Vali Acc: 0.080 Test Loss: 6.257 Test Acc: 0.080
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.0662358
	speed: 0.1743s/iter; left time: 1942.7185s
Epoch: 28 cost time: 7.146084547042847
Epoch: 28, Steps: 154 | Train Loss: 1.430 Vali Loss: 5.726 Vali Acc: 0.159 Test Loss: 5.726 Test Acc: 0.159
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3596918085969181
model parameter : 1852470
model size : 16.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9749035
	speed: 0.0613s/iter; left time: 938.2846s
Epoch: 1 cost time: 8.48036503791809
Epoch: 1, Steps: 154 | Train Loss: 2.301 Vali Loss: 2.262 Vali Acc: 0.318 Test Loss: 2.262 Test Acc: 0.318
Validation loss decreased (inf --> -0.317901).  Saving model ...
	iters: 100, epoch: 2 | loss: 10.0223494
	speed: 0.1762s/iter; left time: 2669.1844s
Epoch: 2 cost time: 6.960459470748901
Epoch: 2, Steps: 154 | Train Loss: 2.166 Vali Loss: 2.283 Vali Acc: 0.331 Test Loss: 2.283 Test Acc: 0.331
Validation loss decreased (-0.317901 --> -0.330877).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8723046
	speed: 0.1833s/iter; left time: 2747.7172s
Epoch: 3 cost time: 7.248616456985474
Epoch: 3, Steps: 154 | Train Loss: 1.986 Vali Loss: 2.311 Vali Acc: 0.327 Test Loss: 2.311 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8322523
	speed: 0.1787s/iter; left time: 2651.5998s
Epoch: 4 cost time: 6.7279884815216064
Epoch: 4, Steps: 154 | Train Loss: 1.954 Vali Loss: 2.346 Vali Acc: 0.328 Test Loss: 2.346 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 4.7677717
	speed: 0.1961s/iter; left time: 2879.3827s
Epoch: 5 cost time: 7.479088544845581
Epoch: 5, Steps: 154 | Train Loss: 2.020 Vali Loss: 2.429 Vali Acc: 0.331 Test Loss: 2.429 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.8620745
	speed: 0.2011s/iter; left time: 2921.9977s
Epoch: 6 cost time: 6.793637990951538
Epoch: 6, Steps: 154 | Train Loss: 1.927 Vali Loss: 2.502 Vali Acc: 0.339 Test Loss: 2.502 Test Acc: 0.339
Validation loss decreased (-0.330877 --> -0.339391).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.6682808
	speed: 0.2074s/iter; left time: 2981.4758s
Epoch: 7 cost time: 7.178473711013794
Epoch: 7, Steps: 154 | Train Loss: 1.792 Vali Loss: 2.673 Vali Acc: 0.343 Test Loss: 2.673 Test Acc: 0.343
Validation loss decreased (-0.339391 --> -0.342633).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0717604
	speed: 0.1810s/iter; left time: 2574.7252s
Epoch: 8 cost time: 7.1889636516571045
Epoch: 8, Steps: 154 | Train Loss: 1.831 Vali Loss: 2.664 Vali Acc: 0.356 Test Loss: 2.664 Test Acc: 0.356
Validation loss decreased (-0.342633 --> -0.356016).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4011693
	speed: 0.1829s/iter; left time: 2572.8716s
Epoch: 9 cost time: 6.743375301361084
Epoch: 9, Steps: 154 | Train Loss: 2.045 Vali Loss: 2.871 Vali Acc: 0.349 Test Loss: 2.871 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.9907287
	speed: 0.1882s/iter; left time: 2618.2394s
Epoch: 10 cost time: 7.386276960372925
Epoch: 10, Steps: 154 | Train Loss: 1.775 Vali Loss: 3.423 Vali Acc: 0.343 Test Loss: 3.423 Test Acc: 0.343
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.6410859
	speed: 0.1839s/iter; left time: 2530.9343s
Epoch: 11 cost time: 7.05756402015686
Epoch: 11, Steps: 154 | Train Loss: 1.810 Vali Loss: 2.995 Vali Acc: 0.364 Test Loss: 2.995 Test Acc: 0.364
Validation loss decreased (-0.356016 --> -0.363717).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4279796
	speed: 0.1816s/iter; left time: 2471.0786s
Epoch: 12 cost time: 6.795263767242432
Epoch: 12, Steps: 154 | Train Loss: 1.819 Vali Loss: 3.324 Vali Acc: 0.365 Test Loss: 3.324 Test Acc: 0.365
Validation loss decreased (-0.363717 --> -0.364930).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6350411
	speed: 0.2017s/iter; left time: 2713.5620s
Epoch: 13 cost time: 7.54086971282959
Epoch: 13, Steps: 154 | Train Loss: 1.710 Vali Loss: 3.783 Vali Acc: 0.085 Test Loss: 3.783 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.2499228
	speed: 0.2039s/iter; left time: 2711.2494s
Epoch: 14 cost time: 7.747187614440918
Epoch: 14, Steps: 154 | Train Loss: 1.807 Vali Loss: 3.327 Vali Acc: 0.334 Test Loss: 3.327 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.9878514
	speed: 0.2053s/iter; left time: 2698.7694s
Epoch: 15 cost time: 7.777128219604492
Epoch: 15, Steps: 154 | Train Loss: 1.804 Vali Loss: 3.812 Vali Acc: 0.139 Test Loss: 3.812 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 3.4979417
	speed: 0.1865s/iter; left time: 2422.2466s
Epoch: 16 cost time: 7.253486633300781
Epoch: 16, Steps: 154 | Train Loss: 1.957 Vali Loss: 4.093 Vali Acc: 0.358 Test Loss: 4.093 Test Acc: 0.358
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 2.5491829
	speed: 0.1824s/iter; left time: 2340.9837s
Epoch: 17 cost time: 7.091758966445923
Epoch: 17, Steps: 154 | Train Loss: 1.786 Vali Loss: 4.268 Vali Acc: 0.073 Test Loss: 4.268 Test Acc: 0.073
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.2046148
	speed: 0.1853s/iter; left time: 2350.2174s
Epoch: 18 cost time: 7.223484992980957
Epoch: 18, Steps: 154 | Train Loss: 1.884 Vali Loss: 3.834 Vali Acc: 0.366 Test Loss: 3.834 Test Acc: 0.366
Validation loss decreased (-0.364930 --> -0.365736).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.0077572
	speed: 0.1832s/iter; left time: 2295.4715s
Epoch: 19 cost time: 7.010992050170898
Epoch: 19, Steps: 154 | Train Loss: 1.634 Vali Loss: 3.809 Vali Acc: 0.368 Test Loss: 3.809 Test Acc: 0.368
Validation loss decreased (-0.365736 --> -0.367764).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.5924499
	speed: 0.1827s/iter; left time: 2260.6885s
Epoch: 20 cost time: 6.711517572402954
Epoch: 20, Steps: 154 | Train Loss: 1.461 Vali Loss: 5.253 Vali Acc: 0.155 Test Loss: 5.253 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.2845217
	speed: 0.1901s/iter; left time: 2323.3036s
Epoch: 21 cost time: 7.371906995773315
Epoch: 21, Steps: 154 | Train Loss: 1.977 Vali Loss: 4.371 Vali Acc: 0.208 Test Loss: 4.371 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.0875704
	speed: 0.2058s/iter; left time: 2483.0907s
Epoch: 22 cost time: 6.792476415634155
Epoch: 22, Steps: 154 | Train Loss: 1.352 Vali Loss: 5.285 Vali Acc: 0.084 Test Loss: 5.285 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.0404308
	speed: 0.1905s/iter; left time: 2268.8637s
Epoch: 23 cost time: 7.246628284454346
Epoch: 23, Steps: 154 | Train Loss: 1.705 Vali Loss: 5.742 Vali Acc: 0.086 Test Loss: 5.742 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 2.8219330
	speed: 0.1996s/iter; left time: 2346.6212s
Epoch: 24 cost time: 6.761231899261475
Epoch: 24, Steps: 154 | Train Loss: 1.706 Vali Loss: 5.501 Vali Acc: 0.137 Test Loss: 5.501 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.1005085
	speed: 0.1801s/iter; left time: 2090.3423s
Epoch: 25 cost time: 6.747182607650757
Epoch: 25, Steps: 154 | Train Loss: 1.465 Vali Loss: 4.828 Vali Acc: 0.101 Test Loss: 4.828 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.5348289
	speed: 0.1780s/iter; left time: 2038.4431s
Epoch: 26 cost time: 6.913512706756592
Epoch: 26, Steps: 154 | Train Loss: 1.783 Vali Loss: 4.826 Vali Acc: 0.103 Test Loss: 4.826 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.4150522
	speed: 0.1748s/iter; left time: 1975.1115s
Epoch: 27 cost time: 7.011396646499634
Epoch: 27, Steps: 154 | Train Loss: 1.705 Vali Loss: 6.391 Vali Acc: 0.078 Test Loss: 6.391 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.8466403
	speed: 0.1778s/iter; left time: 1980.8365s
Epoch: 28 cost time: 6.886669635772705
Epoch: 28, Steps: 154 | Train Loss: 1.332 Vali Loss: 7.259 Vali Acc: 0.088 Test Loss: 7.259 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.1054447
	speed: 0.1783s/iter; left time: 1959.2103s
Epoch: 29 cost time: 7.234455585479736
Epoch: 29, Steps: 154 | Train Loss: 1.574 Vali Loss: 6.461 Vali Acc: 0.094 Test Loss: 6.461 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3678021086780211
model parameter : 1852470
model size : 16.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0509150
	speed: 0.0625s/iter; left time: 956.4310s
Epoch: 1 cost time: 8.679802179336548
Epoch: 1, Steps: 154 | Train Loss: 2.258 Vali Loss: 2.245 Vali Acc: 0.319 Test Loss: 2.245 Test Acc: 0.319
Validation loss decreased (inf --> -0.319118).  Saving model ...
	iters: 100, epoch: 2 | loss: 8.4612818
	speed: 0.2023s/iter; left time: 3064.3980s
Epoch: 2 cost time: 6.747472763061523
Epoch: 2, Steps: 154 | Train Loss: 2.159 Vali Loss: 2.269 Vali Acc: 0.330 Test Loss: 2.269 Test Acc: 0.330
Validation loss decreased (-0.319118 --> -0.330472).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8554773
	speed: 0.1974s/iter; left time: 2959.4949s
Epoch: 3 cost time: 6.487211227416992
Epoch: 3, Steps: 154 | Train Loss: 2.097 Vali Loss: 2.270 Vali Acc: 0.329 Test Loss: 2.270 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6631262
	speed: 0.1836s/iter; left time: 2724.4247s
Epoch: 4 cost time: 6.865482568740845
Epoch: 4, Steps: 154 | Train Loss: 1.927 Vali Loss: 2.384 Vali Acc: 0.331 Test Loss: 2.384 Test Acc: 0.331
Validation loss decreased (-0.330472 --> -0.331282).  Saving model ...
	iters: 100, epoch: 5 | loss: 6.2449098
	speed: 0.1851s/iter; left time: 2718.3609s
Epoch: 5 cost time: 6.736523151397705
Epoch: 5, Steps: 154 | Train Loss: 1.944 Vali Loss: 2.486 Vali Acc: 0.333 Test Loss: 2.486 Test Acc: 0.333
Validation loss decreased (-0.331282 --> -0.332497).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7602129
	speed: 0.1747s/iter; left time: 2538.2791s
Epoch: 6 cost time: 6.573350191116333
Epoch: 6, Steps: 154 | Train Loss: 1.923 Vali Loss: 2.418 Vali Acc: 0.340 Test Loss: 2.418 Test Acc: 0.340
Validation loss decreased (-0.332497 --> -0.339797).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2044272
	speed: 0.1773s/iter; left time: 2548.5164s
Epoch: 7 cost time: 6.833650827407837
Epoch: 7, Steps: 154 | Train Loss: 1.829 Vali Loss: 2.636 Vali Acc: 0.339 Test Loss: 2.636 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.1096079
	speed: 0.1762s/iter; left time: 2505.4351s
Epoch: 8 cost time: 6.721870422363281
Epoch: 8, Steps: 154 | Train Loss: 1.894 Vali Loss: 2.594 Vali Acc: 0.363 Test Loss: 2.594 Test Acc: 0.363
Validation loss decreased (-0.339797 --> -0.362910).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3121741
	speed: 0.1935s/iter; left time: 2721.8295s
Epoch: 9 cost time: 6.722903251647949
Epoch: 9, Steps: 154 | Train Loss: 1.968 Vali Loss: 2.980 Vali Acc: 0.347 Test Loss: 2.980 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.7171530
	speed: 0.1984s/iter; left time: 2760.7025s
Epoch: 10 cost time: 6.922389984130859
Epoch: 10, Steps: 154 | Train Loss: 2.061 Vali Loss: 3.286 Vali Acc: 0.348 Test Loss: 3.286 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4251809
	speed: 0.1942s/iter; left time: 2672.9986s
Epoch: 11 cost time: 6.853193998336792
Epoch: 11, Steps: 154 | Train Loss: 1.774 Vali Loss: 2.911 Vali Acc: 0.357 Test Loss: 2.911 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.3136410
	speed: 0.1882s/iter; left time: 2560.3541s
Epoch: 12 cost time: 6.377496242523193
Epoch: 12, Steps: 154 | Train Loss: 1.955 Vali Loss: 2.924 Vali Acc: 0.363 Test Loss: 2.924 Test Acc: 0.363
Validation loss decreased (-0.362910 --> -0.363312).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3979937
	speed: 0.1595s/iter; left time: 2145.1688s
Epoch: 13 cost time: 6.833044528961182
Epoch: 13, Steps: 154 | Train Loss: 1.684 Vali Loss: 3.483 Vali Acc: 0.082 Test Loss: 3.483 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.2151812
	speed: 0.1738s/iter; left time: 2311.9872s
Epoch: 14 cost time: 6.7464869022369385
Epoch: 14, Steps: 154 | Train Loss: 1.856 Vali Loss: 2.916 Vali Acc: 0.366 Test Loss: 2.916 Test Acc: 0.366
Validation loss decreased (-0.363312 --> -0.366151).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.1430764
	speed: 0.1790s/iter; left time: 2353.4478s
Epoch: 15 cost time: 7.078397750854492
Epoch: 15, Steps: 154 | Train Loss: 1.785 Vali Loss: 3.681 Vali Acc: 0.131 Test Loss: 3.681 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.3770409
	speed: 0.1816s/iter; left time: 2359.5592s
Epoch: 16 cost time: 7.109017610549927
Epoch: 16, Steps: 154 | Train Loss: 1.632 Vali Loss: 4.203 Vali Acc: 0.353 Test Loss: 4.203 Test Acc: 0.353
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.5347205
	speed: 0.1859s/iter; left time: 2386.9916s
Epoch: 17 cost time: 7.1192944049835205
Epoch: 17, Steps: 154 | Train Loss: 1.599 Vali Loss: 4.235 Vali Acc: 0.087 Test Loss: 4.235 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.1884317
	speed: 0.1949s/iter; left time: 2472.3021s
Epoch: 18 cost time: 6.828829050064087
Epoch: 18, Steps: 154 | Train Loss: 1.722 Vali Loss: 3.242 Vali Acc: 0.373 Test Loss: 3.242 Test Acc: 0.373
Validation loss decreased (-0.366151 --> -0.373447).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.3983665
	speed: 0.1955s/iter; left time: 2449.4418s
Epoch: 19 cost time: 7.2251715660095215
Epoch: 19, Steps: 154 | Train Loss: 1.703 Vali Loss: 3.684 Vali Acc: 0.366 Test Loss: 3.684 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.8905661
	speed: 0.1909s/iter; left time: 2362.0680s
Epoch: 20 cost time: 6.446761846542358
Epoch: 20, Steps: 154 | Train Loss: 1.901 Vali Loss: 4.441 Vali Acc: 0.201 Test Loss: 4.441 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 7.8276973
	speed: 0.1750s/iter; left time: 2138.3002s
Epoch: 21 cost time: 6.919821500778198
Epoch: 21, Steps: 154 | Train Loss: 1.707 Vali Loss: 3.773 Vali Acc: 0.207 Test Loss: 3.773 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.8015688
	speed: 0.1724s/iter; left time: 2080.3417s
Epoch: 22 cost time: 6.773581504821777
Epoch: 22, Steps: 154 | Train Loss: 1.745 Vali Loss: 4.754 Vali Acc: 0.089 Test Loss: 4.754 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.7736815
	speed: 0.1734s/iter; left time: 2066.1628s
Epoch: 23 cost time: 6.6406309604644775
Epoch: 23, Steps: 154 | Train Loss: 1.466 Vali Loss: 4.605 Vali Acc: 0.248 Test Loss: 4.605 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 15.2722750
	speed: 0.1825s/iter; left time: 2145.9777s
Epoch: 24 cost time: 7.0571393966674805
Epoch: 24, Steps: 154 | Train Loss: 1.673 Vali Loss: 4.384 Vali Acc: 0.116 Test Loss: 4.384 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.9533806
	speed: 0.1758s/iter; left time: 2040.6450s
Epoch: 25 cost time: 6.563899040222168
Epoch: 25, Steps: 154 | Train Loss: 1.936 Vali Loss: 4.997 Vali Acc: 0.102 Test Loss: 4.997 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.7986300
	speed: 0.1947s/iter; left time: 2229.0449s
Epoch: 26 cost time: 7.1263587474823
Epoch: 26, Steps: 154 | Train Loss: 1.930 Vali Loss: 4.846 Vali Acc: 0.122 Test Loss: 4.846 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.3809856
	speed: 0.2005s/iter; left time: 2265.1014s
Epoch: 27 cost time: 7.458089828491211
Epoch: 27, Steps: 154 | Train Loss: 1.366 Vali Loss: 5.560 Vali Acc: 0.091 Test Loss: 5.560 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.9173456
	speed: 0.2024s/iter; left time: 2255.5862s
Epoch: 28 cost time: 7.046367883682251
Epoch: 28, Steps: 154 | Train Loss: 1.546 Vali Loss: 6.261 Vali Acc: 0.125 Test Loss: 6.261 Test Acc: 0.125
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3734793187347932
model parameter : 1852470
model size : 16.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7953628
	speed: 0.0639s/iter; left time: 977.3432s
Epoch: 1 cost time: 8.888510704040527
Epoch: 1, Steps: 154 | Train Loss: 2.372 Vali Loss: 2.233 Vali Acc: 0.322 Test Loss: 2.233 Test Acc: 0.322
Validation loss decreased (inf --> -0.322362).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3843663
	speed: 0.1691s/iter; left time: 2560.9995s
Epoch: 2 cost time: 6.351118564605713
Epoch: 2, Steps: 154 | Train Loss: 2.208 Vali Loss: 2.333 Vali Acc: 0.322 Test Loss: 2.333 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6782037
	speed: 0.1664s/iter; left time: 2495.1209s
Epoch: 3 cost time: 6.843634605407715
Epoch: 3, Steps: 154 | Train Loss: 2.028 Vali Loss: 2.292 Vali Acc: 0.335 Test Loss: 2.292 Test Acc: 0.335
Validation loss decreased (-0.322362 --> -0.335338).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5673027
	speed: 0.1666s/iter; left time: 2471.8810s
Epoch: 4 cost time: 6.675649881362915
Epoch: 4, Steps: 154 | Train Loss: 1.893 Vali Loss: 2.496 Vali Acc: 0.328 Test Loss: 2.496 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8500369
	speed: 0.1693s/iter; left time: 2486.7134s
Epoch: 5 cost time: 6.8107500076293945
Epoch: 5, Steps: 154 | Train Loss: 1.993 Vali Loss: 2.497 Vali Acc: 0.336 Test Loss: 2.497 Test Acc: 0.336
Validation loss decreased (-0.335338 --> -0.335741).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1554308
	speed: 0.1851s/iter; left time: 2690.0335s
Epoch: 6 cost time: 7.061715841293335
Epoch: 6, Steps: 154 | Train Loss: 1.959 Vali Loss: 2.669 Vali Acc: 0.339 Test Loss: 2.669 Test Acc: 0.339
Validation loss decreased (-0.335741 --> -0.338578).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1299741
	speed: 0.1874s/iter; left time: 2694.5395s
Epoch: 7 cost time: 7.00778341293335
Epoch: 7, Steps: 154 | Train Loss: 1.899 Vali Loss: 2.553 Vali Acc: 0.341 Test Loss: 2.553 Test Acc: 0.341
Validation loss decreased (-0.338578 --> -0.341418).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5280406
	speed: 0.1869s/iter; left time: 2658.9726s
Epoch: 8 cost time: 6.806642293930054
Epoch: 8, Steps: 154 | Train Loss: 2.001 Vali Loss: 2.805 Vali Acc: 0.091 Test Loss: 2.805 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3905523
	speed: 0.1689s/iter; left time: 2376.2015s
Epoch: 9 cost time: 6.907891035079956
Epoch: 9, Steps: 154 | Train Loss: 1.716 Vali Loss: 2.983 Vali Acc: 0.182 Test Loss: 2.983 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6484302
	speed: 0.1742s/iter; left time: 2423.8469s
Epoch: 10 cost time: 6.466357231140137
Epoch: 10, Steps: 154 | Train Loss: 1.786 Vali Loss: 2.981 Vali Acc: 0.350 Test Loss: 2.981 Test Acc: 0.350
Validation loss decreased (-0.341418 --> -0.349524).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4250209
	speed: 0.1686s/iter; left time: 2319.6719s
Epoch: 11 cost time: 7.158414602279663
Epoch: 11, Steps: 154 | Train Loss: 1.783 Vali Loss: 2.881 Vali Acc: 0.348 Test Loss: 2.881 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6295805
	speed: 0.1713s/iter; left time: 2331.3073s
Epoch: 12 cost time: 7.0265703201293945
Epoch: 12, Steps: 154 | Train Loss: 1.840 Vali Loss: 2.914 Vali Acc: 0.352 Test Loss: 2.914 Test Acc: 0.352
Validation loss decreased (-0.349524 --> -0.352363).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5900484
	speed: 0.1732s/iter; left time: 2329.8636s
Epoch: 13 cost time: 6.729137420654297
Epoch: 13, Steps: 154 | Train Loss: 1.706 Vali Loss: 3.330 Vali Acc: 0.359 Test Loss: 3.330 Test Acc: 0.359
Validation loss decreased (-0.352363 --> -0.358847).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.8001665
	speed: 0.1735s/iter; left time: 2307.2989s
Epoch: 14 cost time: 7.173052072525024
Epoch: 14, Steps: 154 | Train Loss: 1.868 Vali Loss: 3.578 Vali Acc: 0.119 Test Loss: 3.578 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 3.0226791
	speed: 0.1954s/iter; left time: 2568.7915s
Epoch: 15 cost time: 7.7437050342559814
Epoch: 15, Steps: 154 | Train Loss: 1.801 Vali Loss: 3.356 Vali Acc: 0.300 Test Loss: 3.356 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.3082458
	speed: 0.1814s/iter; left time: 2356.9004s
Epoch: 16 cost time: 6.9549291133880615
Epoch: 16, Steps: 154 | Train Loss: 1.996 Vali Loss: 3.819 Vali Acc: 0.349 Test Loss: 3.819 Test Acc: 0.349
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.6474357
	speed: 0.1879s/iter; left time: 2412.2676s
Epoch: 17 cost time: 6.670737981796265
Epoch: 17, Steps: 154 | Train Loss: 1.666 Vali Loss: 3.597 Vali Acc: 0.181 Test Loss: 3.597 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.3154386
	speed: 0.1600s/iter; left time: 2028.8025s
Epoch: 18 cost time: 6.377155303955078
Epoch: 18, Steps: 154 | Train Loss: 1.538 Vali Loss: 3.487 Vali Acc: 0.129 Test Loss: 3.487 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.0770974
	speed: 0.1644s/iter; left time: 2060.1336s
Epoch: 19 cost time: 6.763365983963013
Epoch: 19, Steps: 154 | Train Loss: 1.797 Vali Loss: 4.464 Vali Acc: 0.105 Test Loss: 4.464 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.7893831
	speed: 0.1674s/iter; left time: 2072.1888s
Epoch: 20 cost time: 6.7109739780426025
Epoch: 20, Steps: 154 | Train Loss: 1.748 Vali Loss: 4.156 Vali Acc: 0.355 Test Loss: 4.156 Test Acc: 0.355
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.4229083
	speed: 0.1635s/iter; left time: 1997.6214s
Epoch: 21 cost time: 6.662177562713623
Epoch: 21, Steps: 154 | Train Loss: 1.680 Vali Loss: 4.478 Vali Acc: 0.093 Test Loss: 4.478 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.0760039
	speed: 0.1709s/iter; left time: 2062.2426s
Epoch: 22 cost time: 6.641120195388794
Epoch: 22, Steps: 154 | Train Loss: 1.602 Vali Loss: 3.665 Vali Acc: 0.255 Test Loss: 3.665 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.0617479
	speed: 0.1776s/iter; left time: 2115.5217s
Epoch: 23 cost time: 6.941380262374878
Epoch: 23, Steps: 154 | Train Loss: 1.953 Vali Loss: 4.150 Vali Acc: 0.368 Test Loss: 4.150 Test Acc: 0.368
Validation loss decreased (-0.358847 --> -0.367761).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.9761465
	speed: 0.1831s/iter; left time: 2152.9261s
Epoch: 24 cost time: 6.648122072219849
Epoch: 24, Steps: 154 | Train Loss: 1.485 Vali Loss: 5.106 Vali Acc: 0.345 Test Loss: 5.106 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.4463995
	speed: 0.1904s/iter; left time: 2210.0188s
Epoch: 25 cost time: 6.695190906524658
Epoch: 25, Steps: 154 | Train Loss: 1.461 Vali Loss: 4.277 Vali Acc: 0.204 Test Loss: 4.277 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.5883644
	speed: 0.1814s/iter; left time: 2077.4183s
Epoch: 26 cost time: 5.923694610595703
Epoch: 26, Steps: 154 | Train Loss: 1.347 Vali Loss: 5.092 Vali Acc: 0.112 Test Loss: 5.092 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.1395566
	speed: 0.1940s/iter; left time: 2191.2420s
Epoch: 27 cost time: 8.311208486557007
Epoch: 27, Steps: 154 | Train Loss: 1.451 Vali Loss: 4.266 Vali Acc: 0.363 Test Loss: 4.266 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.5613853
	speed: 0.1495s/iter; left time: 1666.1150s
Epoch: 28 cost time: 4.696013450622559
Epoch: 28, Steps: 154 | Train Loss: 1.608 Vali Loss: 4.658 Vali Acc: 0.227 Test Loss: 4.658 Test Acc: 0.227
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 1.3230051
	speed: 0.1293s/iter; left time: 1420.3700s
Epoch: 29 cost time: 6.538562536239624
Epoch: 29, Steps: 154 | Train Loss: 1.376 Vali Loss: 4.844 Vali Acc: 0.302 Test Loss: 4.844 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 1.4230103
	speed: 0.1665s/iter; left time: 1804.2706s
Epoch: 30 cost time: 6.921501398086548
Epoch: 30, Steps: 154 | Train Loss: 1.565 Vali Loss: 5.387 Vali Acc: 0.094 Test Loss: 5.387 Test Acc: 0.094
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 1.3933432
	speed: 0.1697s/iter; left time: 1812.1599s
Epoch: 31 cost time: 6.762948989868164
Epoch: 31, Steps: 154 | Train Loss: 2.706 Vali Loss: 5.631 Vali Acc: 0.106 Test Loss: 5.631 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.8506355
	speed: 0.1663s/iter; left time: 1750.5804s
Epoch: 32 cost time: 6.653578042984009
Epoch: 32, Steps: 154 | Train Loss: 1.640 Vali Loss: 7.118 Vali Acc: 0.377 Test Loss: 7.118 Test Acc: 0.377
Validation loss decreased (-0.367761 --> -0.377058).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.0229403
	speed: 0.1687s/iter; left time: 1750.0757s
Epoch: 33 cost time: 6.575546979904175
Epoch: 33, Steps: 154 | Train Loss: 1.536 Vali Loss: 6.119 Vali Acc: 0.169 Test Loss: 6.119 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 1.0289334
	speed: 0.1669s/iter; left time: 1705.6149s
Epoch: 34 cost time: 6.585067987442017
Epoch: 34, Steps: 154 | Train Loss: 1.395 Vali Loss: 6.105 Vali Acc: 0.077 Test Loss: 6.105 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 1.3716769
	speed: 0.1834s/iter; left time: 1845.4597s
Epoch: 35 cost time: 6.776427984237671
Epoch: 35, Steps: 154 | Train Loss: 1.525 Vali Loss: 4.697 Vali Acc: 0.209 Test Loss: 4.697 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 1.3963859
	speed: 0.1929s/iter; left time: 1911.9449s
Epoch: 36 cost time: 7.1717119216918945
Epoch: 36, Steps: 154 | Train Loss: 1.356 Vali Loss: 5.288 Vali Acc: 0.085 Test Loss: 5.288 Test Acc: 0.085
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 1.4115204
	speed: 0.1891s/iter; left time: 1845.1874s
Epoch: 37 cost time: 6.700534105300903
Epoch: 37, Steps: 154 | Train Loss: 1.384 Vali Loss: 5.720 Vali Acc: 0.296 Test Loss: 5.720 Test Acc: 0.296
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.3763800
	speed: 0.1771s/iter; left time: 1700.6459s
Epoch: 38 cost time: 6.97186541557312
Epoch: 38, Steps: 154 | Train Loss: 1.228 Vali Loss: 5.627 Vali Acc: 0.168 Test Loss: 5.627 Test Acc: 0.168
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.9762707
	speed: 0.1722s/iter; left time: 1627.4771s
Epoch: 39 cost time: 6.574816942214966
Epoch: 39, Steps: 154 | Train Loss: 1.103 Vali Loss: 6.341 Vali Acc: 0.318 Test Loss: 6.341 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.7215506
	speed: 0.1735s/iter; left time: 1612.9018s
Epoch: 40 cost time: 6.792616367340088
Epoch: 40, Steps: 154 | Train Loss: 2.110 Vali Loss: 5.826 Vali Acc: 0.092 Test Loss: 5.826 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.9492602
	speed: 0.1675s/iter; left time: 1531.2237s
Epoch: 41 cost time: 6.8603010177612305
Epoch: 41, Steps: 154 | Train Loss: 1.352 Vali Loss: 5.943 Vali Acc: 0.169 Test Loss: 5.943 Test Acc: 0.169
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 2.8545868
	speed: 0.1671s/iter; left time: 1501.8233s
Epoch: 42 cost time: 6.99679970741272
Epoch: 42, Steps: 154 | Train Loss: 1.455 Vali Loss: 5.850 Vali Acc: 0.378 Test Loss: 5.850 Test Acc: 0.378
Validation loss decreased (-0.377058 --> -0.378287).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.6695112
	speed: 0.1682s/iter; left time: 1485.7417s
Epoch: 43 cost time: 6.480289697647095
Epoch: 43, Steps: 154 | Train Loss: 1.641 Vali Loss: 5.384 Vali Acc: 0.327 Test Loss: 5.384 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 2.5210614
	speed: 0.1911s/iter; left time: 1658.2430s
Epoch: 44 cost time: 7.486428499221802
Epoch: 44, Steps: 154 | Train Loss: 1.211 Vali Loss: 5.297 Vali Acc: 0.119 Test Loss: 5.297 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 0.5692390
	speed: 0.1871s/iter; left time: 1595.1543s
Epoch: 45 cost time: 7.089184284210205
Epoch: 45, Steps: 154 | Train Loss: 1.115 Vali Loss: 6.158 Vali Acc: 0.177 Test Loss: 6.158 Test Acc: 0.177
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 46 | loss: 0.6909640
	speed: 0.1880s/iter; left time: 1574.0085s
Epoch: 46 cost time: 7.1323418617248535
Epoch: 46, Steps: 154 | Train Loss: 1.429 Vali Loss: 7.023 Vali Acc: 0.125 Test Loss: 7.023 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 47 | loss: 1.1738665
	speed: 0.1679s/iter; left time: 1379.7884s
Epoch: 47 cost time: 6.747568607330322
Epoch: 47, Steps: 154 | Train Loss: 1.452 Vali Loss: 9.910 Vali Acc: 0.081 Test Loss: 9.910 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 48 | loss: 1.0885502
	speed: 0.1661s/iter; left time: 1339.0364s
Epoch: 48 cost time: 6.5719523429870605
Epoch: 48, Steps: 154 | Train Loss: 1.125 Vali Loss: 9.140 Vali Acc: 0.089 Test Loss: 9.140 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 49 | loss: 1.1288301
	speed: 0.1657s/iter; left time: 1310.1650s
Epoch: 49 cost time: 6.615473747253418
Epoch: 49, Steps: 154 | Train Loss: 1.283 Vali Loss: 8.475 Vali Acc: 0.084 Test Loss: 8.475 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 50 | loss: 0.8529955
	speed: 0.1688s/iter; left time: 1308.9919s
Epoch: 50 cost time: 6.788053512573242
Epoch: 50, Steps: 154 | Train Loss: 0.982 Vali Loss: 9.238 Vali Acc: 0.103 Test Loss: 9.238 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 51 | loss: 0.7440895
	speed: 0.1720s/iter; left time: 1307.0362s
Epoch: 51 cost time: 6.525017499923706
Epoch: 51, Steps: 154 | Train Loss: 1.815 Vali Loss: 9.860 Vali Acc: 0.095 Test Loss: 9.860 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 52 | loss: 0.4755763
	speed: 0.1825s/iter; left time: 1359.2249s
Epoch: 52 cost time: 7.196374416351318
Epoch: 52, Steps: 154 | Train Loss: 2.005 Vali Loss: 10.123 Vali Acc: 0.092 Test Loss: 10.123 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37834549878345497
model parameter : 1328182
model size : 14.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7881774
	speed: 0.0586s/iter; left time: 897.0312s
Epoch: 1 cost time: 8.267394065856934
Epoch: 1, Steps: 154 | Train Loss: 2.351 Vali Loss: 2.236 Vali Acc: 0.322 Test Loss: 2.236 Test Acc: 0.322
Validation loss decreased (inf --> -0.321957).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3230786
	speed: 0.1838s/iter; left time: 2783.5630s
Epoch: 2 cost time: 6.473649501800537
Epoch: 2, Steps: 154 | Train Loss: 2.082 Vali Loss: 2.368 Vali Acc: 0.324 Test Loss: 2.368 Test Acc: 0.324
Validation loss decreased (-0.321957 --> -0.323577).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7107620
	speed: 0.1684s/iter; left time: 2524.3607s
Epoch: 3 cost time: 6.878807306289673
Epoch: 3, Steps: 154 | Train Loss: 2.105 Vali Loss: 2.231 Vali Acc: 0.335 Test Loss: 2.231 Test Acc: 0.335
Validation loss decreased (-0.323577 --> -0.335339).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5592761
	speed: 0.1663s/iter; left time: 2467.8676s
Epoch: 4 cost time: 6.834227800369263
Epoch: 4, Steps: 154 | Train Loss: 1.874 Vali Loss: 2.399 Vali Acc: 0.330 Test Loss: 2.399 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7674352
	speed: 0.1689s/iter; left time: 2480.9556s
Epoch: 5 cost time: 7.121744632720947
Epoch: 5, Steps: 154 | Train Loss: 1.903 Vali Loss: 2.544 Vali Acc: 0.338 Test Loss: 2.544 Test Acc: 0.338
Validation loss decreased (-0.335339 --> -0.337769).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0968611
	speed: 0.1694s/iter; left time: 2461.3390s
Epoch: 6 cost time: 6.624202251434326
Epoch: 6, Steps: 154 | Train Loss: 1.997 Vali Loss: 2.711 Vali Acc: 0.342 Test Loss: 2.711 Test Acc: 0.342
Validation loss decreased (-0.337769 --> -0.341822).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0310538
	speed: 0.1746s/iter; left time: 2509.7611s
Epoch: 7 cost time: 7.022023439407349
Epoch: 7, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.514 Vali Acc: 0.346 Test Loss: 2.514 Test Acc: 0.346
Validation loss decreased (-0.341822 --> -0.345879).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4303057
	speed: 0.1777s/iter; left time: 2527.3268s
Epoch: 8 cost time: 7.0392069816589355
Epoch: 8, Steps: 154 | Train Loss: 1.880 Vali Loss: 2.758 Vali Acc: 0.094 Test Loss: 2.758 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1603098
	speed: 0.1889s/iter; left time: 2657.2884s
Epoch: 9 cost time: 6.877737998962402
Epoch: 9, Steps: 154 | Train Loss: 1.760 Vali Loss: 2.772 Vali Acc: 0.341 Test Loss: 2.772 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6875459
	speed: 0.1869s/iter; left time: 2600.2035s
Epoch: 10 cost time: 7.2317492961883545
Epoch: 10, Steps: 154 | Train Loss: 1.817 Vali Loss: 3.234 Vali Acc: 0.339 Test Loss: 3.234 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2233702
	speed: 0.1827s/iter; left time: 2514.2837s
Epoch: 11 cost time: 5.565875053405762
Epoch: 11, Steps: 154 | Train Loss: 1.761 Vali Loss: 3.017 Vali Acc: 0.350 Test Loss: 3.017 Test Acc: 0.350
Validation loss decreased (-0.345879 --> -0.349524).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5902278
	speed: 0.1578s/iter; left time: 2146.7472s
Epoch: 12 cost time: 6.737651586532593
Epoch: 12, Steps: 154 | Train Loss: 2.040 Vali Loss: 3.284 Vali Acc: 0.328 Test Loss: 3.284 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.2931083
	speed: 0.1663s/iter; left time: 2237.3507s
Epoch: 13 cost time: 6.662708759307861
Epoch: 13, Steps: 154 | Train Loss: 2.331 Vali Loss: 3.281 Vali Acc: 0.355 Test Loss: 3.281 Test Acc: 0.355
Validation loss decreased (-0.349524 --> -0.354793).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.8603902
	speed: 0.1665s/iter; left time: 2214.7871s
Epoch: 14 cost time: 6.383411169052124
Epoch: 14, Steps: 154 | Train Loss: 1.741 Vali Loss: 3.397 Vali Acc: 0.290 Test Loss: 3.397 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.5738158
	speed: 0.1649s/iter; left time: 2167.4532s
Epoch: 15 cost time: 6.6236796379089355
Epoch: 15, Steps: 154 | Train Loss: 1.639 Vali Loss: 3.537 Vali Acc: 0.286 Test Loss: 3.537 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.2837662
	speed: 0.1623s/iter; left time: 2108.5039s
Epoch: 16 cost time: 6.724817991256714
Epoch: 16, Steps: 154 | Train Loss: 1.729 Vali Loss: 4.275 Vali Acc: 0.069 Test Loss: 4.275 Test Acc: 0.069
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.5674616
	speed: 0.1716s/iter; left time: 2202.6063s
Epoch: 17 cost time: 6.679529666900635
Epoch: 17, Steps: 154 | Train Loss: 1.540 Vali Loss: 4.548 Vali Acc: 0.071 Test Loss: 4.548 Test Acc: 0.071
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.5552486
	speed: 0.1943s/iter; left time: 2464.1686s
Epoch: 18 cost time: 7.152043104171753
Epoch: 18, Steps: 154 | Train Loss: 1.707 Vali Loss: 3.624 Vali Acc: 0.137 Test Loss: 3.624 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.4971004
	speed: 0.1902s/iter; left time: 2382.4614s
Epoch: 19 cost time: 6.885521650314331
Epoch: 19, Steps: 154 | Train Loss: 1.551 Vali Loss: 4.455 Vali Acc: 0.131 Test Loss: 4.455 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.1026402
	speed: 0.1852s/iter; left time: 2292.3117s
Epoch: 20 cost time: 6.556164503097534
Epoch: 20, Steps: 154 | Train Loss: 1.553 Vali Loss: 4.312 Vali Acc: 0.356 Test Loss: 4.312 Test Acc: 0.356
Validation loss decreased (-0.354793 --> -0.356405).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.2801450
	speed: 0.1712s/iter; left time: 2092.6747s
Epoch: 21 cost time: 6.982898235321045
Epoch: 21, Steps: 154 | Train Loss: 1.581 Vali Loss: 4.650 Vali Acc: 0.159 Test Loss: 4.650 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.1811823
	speed: 0.1635s/iter; left time: 1973.2424s
Epoch: 22 cost time: 6.494594097137451
Epoch: 22, Steps: 154 | Train Loss: 1.416 Vali Loss: 4.376 Vali Acc: 0.384 Test Loss: 4.376 Test Acc: 0.384
Validation loss decreased (-0.356405 --> -0.383573).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.1502497
	speed: 0.1653s/iter; left time: 1969.4102s
Epoch: 23 cost time: 6.624162912368774
Epoch: 23, Steps: 154 | Train Loss: 1.567 Vali Loss: 4.235 Vali Acc: 0.139 Test Loss: 4.235 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.9477456
	speed: 0.1646s/iter; left time: 1936.1106s
Epoch: 24 cost time: 6.806377410888672
Epoch: 24, Steps: 154 | Train Loss: 1.387 Vali Loss: 4.921 Vali Acc: 0.347 Test Loss: 4.921 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.9283435
	speed: 0.1610s/iter; left time: 1868.7669s
Epoch: 25 cost time: 6.294426202774048
Epoch: 25, Steps: 154 | Train Loss: 1.677 Vali Loss: 4.424 Vali Acc: 0.373 Test Loss: 4.424 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.6864105
	speed: 0.1715s/iter; left time: 1963.5518s
Epoch: 26 cost time: 6.050899982452393
Epoch: 26, Steps: 154 | Train Loss: 2.299 Vali Loss: 5.298 Vali Acc: 0.103 Test Loss: 5.298 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.2788124
	speed: 0.1780s/iter; left time: 2010.9395s
Epoch: 27 cost time: 6.356787443161011
Epoch: 27, Steps: 154 | Train Loss: 1.997 Vali Loss: 4.632 Vali Acc: 0.117 Test Loss: 4.632 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.9482228
	speed: 0.1896s/iter; left time: 2113.0541s
Epoch: 28 cost time: 6.693450927734375
Epoch: 28, Steps: 154 | Train Loss: 1.776 Vali Loss: 4.396 Vali Acc: 0.231 Test Loss: 4.396 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 1.0683644
	speed: 0.1738s/iter; left time: 1910.2246s
Epoch: 29 cost time: 6.625800609588623
Epoch: 29, Steps: 154 | Train Loss: 1.595 Vali Loss: 5.734 Vali Acc: 0.083 Test Loss: 5.734 Test Acc: 0.083
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.1038520
	speed: 0.1685s/iter; left time: 1825.7013s
Epoch: 30 cost time: 6.7602598667144775
Epoch: 30, Steps: 154 | Train Loss: 1.820 Vali Loss: 4.117 Vali Acc: 0.391 Test Loss: 4.117 Test Acc: 0.391
Validation loss decreased (-0.383573 --> -0.390875).  Saving model ...
	iters: 100, epoch: 31 | loss: 1.3505704
	speed: 0.1724s/iter; left time: 1841.1277s
Epoch: 31 cost time: 6.5030646324157715
Epoch: 31, Steps: 154 | Train Loss: 1.378 Vali Loss: 5.444 Vali Acc: 0.088 Test Loss: 5.444 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.7387576
	speed: 0.1610s/iter; left time: 1694.7253s
Epoch: 32 cost time: 6.807814121246338
Epoch: 32, Steps: 154 | Train Loss: 1.448 Vali Loss: 5.366 Vali Acc: 0.382 Test Loss: 5.366 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.7080444
	speed: 0.1635s/iter; left time: 1696.4819s
Epoch: 33 cost time: 6.790990591049194
Epoch: 33, Steps: 154 | Train Loss: 2.037 Vali Loss: 5.579 Vali Acc: 0.200 Test Loss: 5.579 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.9464796
	speed: 0.1668s/iter; left time: 1704.5101s
Epoch: 34 cost time: 6.286651849746704
Epoch: 34, Steps: 154 | Train Loss: 1.140 Vali Loss: 7.543 Vali Acc: 0.080 Test Loss: 7.543 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 1.2502397
	speed: 0.1807s/iter; left time: 1818.6458s
Epoch: 35 cost time: 7.212608575820923
Epoch: 35, Steps: 154 | Train Loss: 1.088 Vali Loss: 6.259 Vali Acc: 0.171 Test Loss: 6.259 Test Acc: 0.171
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 1.0829282
	speed: 0.1859s/iter; left time: 1842.2635s
Epoch: 36 cost time: 6.687596321105957
Epoch: 36, Steps: 154 | Train Loss: 1.389 Vali Loss: 7.075 Vali Acc: 0.091 Test Loss: 7.075 Test Acc: 0.091
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 1.5741236
	speed: 0.1805s/iter; left time: 1761.1155s
Epoch: 37 cost time: 6.417360782623291
Epoch: 37, Steps: 154 | Train Loss: 1.214 Vali Loss: 5.699 Vali Acc: 0.382 Test Loss: 5.699 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.5615591
	speed: 0.1749s/iter; left time: 1679.6942s
Epoch: 38 cost time: 6.582668304443359
Epoch: 38, Steps: 154 | Train Loss: 1.494 Vali Loss: 6.480 Vali Acc: 0.131 Test Loss: 6.480 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.8402569
	speed: 0.1678s/iter; left time: 1585.1691s
Epoch: 39 cost time: 6.269762992858887
Epoch: 39, Steps: 154 | Train Loss: 1.020 Vali Loss: 7.259 Vali Acc: 0.110 Test Loss: 7.259 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.6062256
	speed: 0.1656s/iter; left time: 1538.8298s
Epoch: 40 cost time: 6.646055698394775
Epoch: 40, Steps: 154 | Train Loss: 2.222 Vali Loss: 7.677 Vali Acc: 0.092 Test Loss: 7.677 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3909164639091646
model parameter : 1328182
model size : 14.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7919159
	speed: 0.0588s/iter; left time: 899.1649s
Epoch: 1 cost time: 7.938892602920532
Epoch: 1, Steps: 154 | Train Loss: 2.325 Vali Loss: 2.230 Vali Acc: 0.323 Test Loss: 2.230 Test Acc: 0.323
Validation loss decreased (inf --> -0.323173).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2861292
	speed: 0.1630s/iter; left time: 2469.1877s
Epoch: 2 cost time: 6.643853187561035
Epoch: 2, Steps: 154 | Train Loss: 2.057 Vali Loss: 2.310 Vali Acc: 0.322 Test Loss: 2.310 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6950603
	speed: 0.1833s/iter; left time: 2748.0180s
Epoch: 3 cost time: 6.4397499561309814
Epoch: 3, Steps: 154 | Train Loss: 2.081 Vali Loss: 2.205 Vali Acc: 0.334 Test Loss: 2.205 Test Acc: 0.334
Validation loss decreased (-0.323173 --> -0.333717).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7835354
	speed: 0.1755s/iter; left time: 2604.8062s
Epoch: 4 cost time: 6.62409234046936
Epoch: 4, Steps: 154 | Train Loss: 1.958 Vali Loss: 2.477 Vali Acc: 0.330 Test Loss: 2.477 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9769256
	speed: 0.1848s/iter; left time: 2713.8635s
Epoch: 5 cost time: 7.202552556991577
Epoch: 5, Steps: 154 | Train Loss: 2.033 Vali Loss: 2.604 Vali Acc: 0.335 Test Loss: 2.604 Test Acc: 0.335
Validation loss decreased (-0.333717 --> -0.335335).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5613368
	speed: 0.1631s/iter; left time: 2369.4078s
Epoch: 6 cost time: 6.323160171508789
Epoch: 6, Steps: 154 | Train Loss: 1.849 Vali Loss: 2.664 Vali Acc: 0.342 Test Loss: 2.664 Test Acc: 0.342
Validation loss decreased (-0.335335 --> -0.342228).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8638992
	speed: 0.1698s/iter; left time: 2441.0174s
Epoch: 7 cost time: 6.706902503967285
Epoch: 7, Steps: 154 | Train Loss: 1.834 Vali Loss: 2.737 Vali Acc: 0.347 Test Loss: 2.737 Test Acc: 0.347
Validation loss decreased (-0.342228 --> -0.347093).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3875935
	speed: 0.1663s/iter; left time: 2364.7020s
Epoch: 8 cost time: 6.6714019775390625
Epoch: 8, Steps: 154 | Train Loss: 1.833 Vali Loss: 2.945 Vali Acc: 0.094 Test Loss: 2.945 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.8163865
	speed: 0.1682s/iter; left time: 2366.7693s
Epoch: 9 cost time: 6.510510206222534
Epoch: 9, Steps: 154 | Train Loss: 2.085 Vali Loss: 2.911 Vali Acc: 0.191 Test Loss: 2.911 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.5045007
	speed: 0.1638s/iter; left time: 2278.8071s
Epoch: 10 cost time: 6.566979169845581
Epoch: 10, Steps: 154 | Train Loss: 1.765 Vali Loss: 3.001 Vali Acc: 0.344 Test Loss: 3.001 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.3474449
	speed: 0.1641s/iter; left time: 2257.7604s
Epoch: 11 cost time: 6.778003931045532
Epoch: 11, Steps: 154 | Train Loss: 1.672 Vali Loss: 3.085 Vali Acc: 0.347 Test Loss: 3.085 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.5644510
	speed: 0.1763s/iter; left time: 2399.0054s
Epoch: 12 cost time: 6.271043300628662
Epoch: 12, Steps: 154 | Train Loss: 1.759 Vali Loss: 3.323 Vali Acc: 0.199 Test Loss: 3.323 Test Acc: 0.199
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.4405893
	speed: 0.1789s/iter; left time: 2407.1320s
Epoch: 13 cost time: 6.996655464172363
Epoch: 13, Steps: 154 | Train Loss: 1.804 Vali Loss: 3.501 Vali Acc: 0.363 Test Loss: 3.501 Test Acc: 0.363
Validation loss decreased (-0.347093 --> -0.363306).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.7937608
	speed: 0.1829s/iter; left time: 2432.5489s
Epoch: 14 cost time: 5.957958221435547
Epoch: 14, Steps: 154 | Train Loss: 2.064 Vali Loss: 4.080 Vali Acc: 0.355 Test Loss: 4.080 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9449073
	speed: 0.1570s/iter; left time: 2063.6733s
Epoch: 15 cost time: 6.401601076126099
Epoch: 15, Steps: 154 | Train Loss: 1.723 Vali Loss: 3.698 Vali Acc: 0.137 Test Loss: 3.698 Test Acc: 0.137
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.3569615
	speed: 0.1607s/iter; left time: 2087.5375s
Epoch: 16 cost time: 6.334529399871826
Epoch: 16, Steps: 154 | Train Loss: 1.729 Vali Loss: 3.523 Vali Acc: 0.367 Test Loss: 3.523 Test Acc: 0.367
Validation loss decreased (-0.363306 --> -0.366550).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.2653649
	speed: 0.1658s/iter; left time: 2128.0714s
Epoch: 17 cost time: 6.250582218170166
Epoch: 17, Steps: 154 | Train Loss: 1.759 Vali Loss: 4.205 Vali Acc: 0.200 Test Loss: 4.205 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 4.1095119
	speed: 0.1645s/iter; left time: 2086.9480s
Epoch: 18 cost time: 6.397796869277954
Epoch: 18, Steps: 154 | Train Loss: 1.641 Vali Loss: 4.125 Vali Acc: 0.373 Test Loss: 4.125 Test Acc: 0.373
Validation loss decreased (-0.366550 --> -0.373033).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.3402596
	speed: 0.1648s/iter; left time: 2065.3008s
Epoch: 19 cost time: 6.541974067687988
Epoch: 19, Steps: 154 | Train Loss: 1.694 Vali Loss: 4.556 Vali Acc: 0.349 Test Loss: 4.556 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.0045475
	speed: 0.1725s/iter; left time: 2134.6119s
Epoch: 20 cost time: 6.5833046436309814
Epoch: 20, Steps: 154 | Train Loss: 1.635 Vali Loss: 3.998 Vali Acc: 0.391 Test Loss: 3.998 Test Acc: 0.391
Validation loss decreased (-0.373033 --> -0.391282).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.7346829
	speed: 0.1815s/iter; left time: 2217.8677s
Epoch: 21 cost time: 6.798218011856079
Epoch: 21, Steps: 154 | Train Loss: 1.800 Vali Loss: 4.883 Vali Acc: 0.100 Test Loss: 4.883 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.7598436
	speed: 0.1884s/iter; left time: 2273.7746s
Epoch: 22 cost time: 6.693030595779419
Epoch: 22, Steps: 154 | Train Loss: 1.606 Vali Loss: 4.559 Vali Acc: 0.370 Test Loss: 4.559 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.1991984
	speed: 0.1718s/iter; left time: 2047.2395s
Epoch: 23 cost time: 6.646009922027588
Epoch: 23, Steps: 154 | Train Loss: 1.500 Vali Loss: 4.833 Vali Acc: 0.121 Test Loss: 4.833 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.6201658
	speed: 0.1619s/iter; left time: 1904.3460s
Epoch: 24 cost time: 6.647163152694702
Epoch: 24, Steps: 154 | Train Loss: 1.408 Vali Loss: 5.537 Vali Acc: 0.267 Test Loss: 5.537 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 1.2360681
	speed: 0.1640s/iter; left time: 1903.3475s
Epoch: 25 cost time: 6.536163091659546
Epoch: 25, Steps: 154 | Train Loss: 1.502 Vali Loss: 5.208 Vali Acc: 0.369 Test Loss: 5.208 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 1.8946276
	speed: 0.1674s/iter; left time: 1916.4019s
Epoch: 26 cost time: 6.445315361022949
Epoch: 26, Steps: 154 | Train Loss: 1.339 Vali Loss: 5.527 Vali Acc: 0.368 Test Loss: 5.527 Test Acc: 0.368
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 1.4507799
	speed: 0.1672s/iter; left time: 1889.0285s
Epoch: 27 cost time: 6.612141132354736
Epoch: 27, Steps: 154 | Train Loss: 1.524 Vali Loss: 5.674 Vali Acc: 0.374 Test Loss: 5.674 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 1.1859688
	speed: 0.1604s/iter; left time: 1786.9532s
Epoch: 28 cost time: 5.8508360385894775
Epoch: 28, Steps: 154 | Train Loss: 1.422 Vali Loss: 6.139 Vali Acc: 0.270 Test Loss: 6.139 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 1.1857669
	speed: 0.1809s/iter; left time: 1987.4339s
Epoch: 29 cost time: 6.730519771575928
Epoch: 29, Steps: 154 | Train Loss: 1.473 Vali Loss: 5.653 Vali Acc: 0.129 Test Loss: 5.653 Test Acc: 0.129
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 1.3930072
	speed: 0.1823s/iter; left time: 1975.6577s
Epoch: 30 cost time: 6.689979314804077
Epoch: 30, Steps: 154 | Train Loss: 1.818 Vali Loss: 5.097 Vali Acc: 0.384 Test Loss: 5.097 Test Acc: 0.384
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3913219789132198
model parameter : 1328182
model size : 14.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7951776
	speed: 0.0622s/iter; left time: 952.3790s
Epoch: 1 cost time: 8.157118082046509
Epoch: 1, Steps: 154 | Train Loss: 2.287 Vali Loss: 2.232 Vali Acc: 0.320 Test Loss: 2.232 Test Acc: 0.320
Validation loss decreased (inf --> -0.320335).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2823262
	speed: 0.1862s/iter; left time: 2820.2320s
Epoch: 2 cost time: 5.989990711212158
Epoch: 2, Steps: 154 | Train Loss: 2.103 Vali Loss: 2.237 Vali Acc: 0.322 Test Loss: 2.237 Test Acc: 0.322
Validation loss decreased (-0.320335 --> -0.322362).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7766516
	speed: 0.1933s/iter; left time: 2898.2254s
Epoch: 3 cost time: 6.071201801300049
Epoch: 3, Steps: 154 | Train Loss: 2.014 Vali Loss: 2.255 Vali Acc: 0.335 Test Loss: 2.255 Test Acc: 0.335
Validation loss decreased (-0.322362 --> -0.334933).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0409064
	speed: 0.2010s/iter; left time: 2982.0583s
Epoch: 4 cost time: 6.378605604171753
Epoch: 4, Steps: 154 | Train Loss: 2.005 Vali Loss: 2.376 Vali Acc: 0.333 Test Loss: 2.376 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9366896
	speed: 0.2001s/iter; left time: 2938.8942s
Epoch: 5 cost time: 6.929640054702759
Epoch: 5, Steps: 154 | Train Loss: 1.982 Vali Loss: 2.422 Vali Acc: 0.343 Test Loss: 2.422 Test Acc: 0.343
Validation loss decreased (-0.334933 --> -0.342636).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.6037891
	speed: 0.2195s/iter; left time: 3190.2349s
Epoch: 6 cost time: 7.204230785369873
Epoch: 6, Steps: 154 | Train Loss: 1.963 Vali Loss: 2.612 Vali Acc: 0.345 Test Loss: 2.612 Test Acc: 0.345
Validation loss decreased (-0.342636 --> -0.345473).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5993336
	speed: 0.2025s/iter; left time: 2911.3010s
Epoch: 7 cost time: 6.260657072067261
Epoch: 7, Steps: 154 | Train Loss: 1.824 Vali Loss: 2.571 Vali Acc: 0.346 Test Loss: 2.571 Test Acc: 0.346
Validation loss decreased (-0.345473 --> -0.346284).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3524538
	speed: 0.1883s/iter; left time: 2677.6348s
Epoch: 8 cost time: 6.001410484313965
Epoch: 8, Steps: 154 | Train Loss: 1.887 Vali Loss: 2.756 Vali Acc: 0.191 Test Loss: 2.756 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4382178
	speed: 0.1849s/iter; left time: 2601.9238s
Epoch: 9 cost time: 6.278003454208374
Epoch: 9, Steps: 154 | Train Loss: 1.888 Vali Loss: 2.928 Vali Acc: 0.185 Test Loss: 2.928 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.9935946
	speed: 0.1815s/iter; left time: 2524.9077s
Epoch: 10 cost time: 5.724126815795898
Epoch: 10, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.758 Vali Acc: 0.354 Test Loss: 2.758 Test Acc: 0.354
Validation loss decreased (-0.346284 --> -0.354393).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2808794
	speed: 0.1830s/iter; left time: 2518.0333s
Epoch: 11 cost time: 5.724561929702759
Epoch: 11, Steps: 154 | Train Loss: 1.729 Vali Loss: 3.015 Vali Acc: 0.359 Test Loss: 3.015 Test Acc: 0.359
Validation loss decreased (-0.354393 --> -0.359256).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4748437
	speed: 0.1865s/iter; left time: 2537.5250s
Epoch: 12 cost time: 5.634647846221924
Epoch: 12, Steps: 154 | Train Loss: 1.740 Vali Loss: 3.397 Vali Acc: 0.352 Test Loss: 3.397 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.3687061
	speed: 0.1742s/iter; left time: 2343.3072s
Epoch: 13 cost time: 5.6698524951934814
Epoch: 13, Steps: 154 | Train Loss: 1.804 Vali Loss: 3.223 Vali Acc: 0.365 Test Loss: 3.223 Test Acc: 0.365
Validation loss decreased (-0.359256 --> -0.364931).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.7103885
	speed: 0.1915s/iter; left time: 2546.3836s
Epoch: 14 cost time: 5.833446025848389
Epoch: 14, Steps: 154 | Train Loss: 1.768 Vali Loss: 4.027 Vali Acc: 0.092 Test Loss: 4.027 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.7229948
	speed: 0.1887s/iter; left time: 2480.0733s
Epoch: 15 cost time: 6.099684000015259
Epoch: 15, Steps: 154 | Train Loss: 1.639 Vali Loss: 3.512 Vali Acc: 0.363 Test Loss: 3.512 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0900064
	speed: 0.1930s/iter; left time: 2506.7585s
Epoch: 16 cost time: 6.398181676864624
Epoch: 16, Steps: 154 | Train Loss: 1.693 Vali Loss: 3.647 Vali Acc: 0.261 Test Loss: 3.647 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.5116805
	speed: 0.1855s/iter; left time: 2380.7486s
Epoch: 17 cost time: 6.142024993896484
Epoch: 17, Steps: 154 | Train Loss: 2.038 Vali Loss: 4.455 Vali Acc: 0.359 Test Loss: 4.455 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.4646657
	speed: 0.2106s/iter; left time: 2670.8802s
Epoch: 18 cost time: 6.27083158493042
Epoch: 18, Steps: 154 | Train Loss: 1.740 Vali Loss: 3.914 Vali Acc: 0.124 Test Loss: 3.914 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.1798719
	speed: 0.2083s/iter; left time: 2610.0634s
Epoch: 19 cost time: 6.444634914398193
Epoch: 19, Steps: 154 | Train Loss: 1.690 Vali Loss: 4.102 Vali Acc: 0.364 Test Loss: 4.102 Test Acc: 0.364
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.8630591
	speed: 0.2071s/iter; left time: 2562.6841s
Epoch: 20 cost time: 6.5506298542022705
Epoch: 20, Steps: 154 | Train Loss: 1.457 Vali Loss: 4.002 Vali Acc: 0.368 Test Loss: 4.002 Test Acc: 0.368
Validation loss decreased (-0.364931 --> -0.367762).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.3078351
	speed: 0.2071s/iter; left time: 2531.3586s
Epoch: 21 cost time: 6.285070180892944
Epoch: 21, Steps: 154 | Train Loss: 1.996 Vali Loss: 4.963 Vali Acc: 0.091 Test Loss: 4.963 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.3189751
	speed: 0.2066s/iter; left time: 2493.2925s
Epoch: 22 cost time: 6.053356409072876
Epoch: 22, Steps: 154 | Train Loss: 1.639 Vali Loss: 4.801 Vali Acc: 0.377 Test Loss: 4.801 Test Acc: 0.377
Validation loss decreased (-0.367762 --> -0.376675).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.3782781
	speed: 0.1792s/iter; left time: 2134.4049s
Epoch: 23 cost time: 5.920560359954834
Epoch: 23, Steps: 154 | Train Loss: 1.366 Vali Loss: 4.487 Vali Acc: 0.098 Test Loss: 4.487 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 2.3873606
	speed: 0.1880s/iter; left time: 2211.1750s
Epoch: 24 cost time: 6.653695583343506
Epoch: 24, Steps: 154 | Train Loss: 1.312 Vali Loss: 6.629 Vali Acc: 0.323 Test Loss: 6.629 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.4551253
	speed: 0.2003s/iter; left time: 2324.3526s
Epoch: 25 cost time: 6.419171571731567
Epoch: 25, Steps: 154 | Train Loss: 2.141 Vali Loss: 6.298 Vali Acc: 0.221 Test Loss: 6.298 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.5699115
	speed: 0.1869s/iter; left time: 2139.9005s
Epoch: 26 cost time: 5.918179273605347
Epoch: 26, Steps: 154 | Train Loss: 2.064 Vali Loss: 4.859 Vali Acc: 0.382 Test Loss: 4.859 Test Acc: 0.382
Validation loss decreased (-0.376675 --> -0.381541).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.8328443
	speed: 0.1903s/iter; left time: 2149.7223s
Epoch: 27 cost time: 6.088535785675049
Epoch: 27, Steps: 154 | Train Loss: 1.442 Vali Loss: 5.887 Vali Acc: 0.185 Test Loss: 5.887 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.1295204
	speed: 0.1847s/iter; left time: 2058.2567s
Epoch: 28 cost time: 6.365883111953735
Epoch: 28, Steps: 154 | Train Loss: 1.647 Vali Loss: 5.550 Vali Acc: 0.380 Test Loss: 5.550 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.2487447
	speed: 0.2009s/iter; left time: 2207.6582s
Epoch: 29 cost time: 6.082430362701416
Epoch: 29, Steps: 154 | Train Loss: 1.373 Vali Loss: 6.278 Vali Acc: 0.132 Test Loss: 6.278 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.1959512
	speed: 0.1917s/iter; left time: 2077.2243s
Epoch: 30 cost time: 6.790852069854736
Epoch: 30, Steps: 154 | Train Loss: 1.854 Vali Loss: 6.558 Vali Acc: 0.364 Test Loss: 6.558 Test Acc: 0.364
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 1.2579823
	speed: 0.1933s/iter; left time: 2064.4878s
Epoch: 31 cost time: 5.947827339172363
Epoch: 31, Steps: 154 | Train Loss: 1.917 Vali Loss: 5.916 Vali Acc: 0.379 Test Loss: 5.916 Test Acc: 0.379
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.6743950
	speed: 0.1902s/iter; left time: 2002.3414s
Epoch: 32 cost time: 6.005505561828613
Epoch: 32, Steps: 154 | Train Loss: 1.477 Vali Loss: 6.766 Vali Acc: 0.123 Test Loss: 6.766 Test Acc: 0.123
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.7181772
	speed: 0.2013s/iter; left time: 2088.4254s
Epoch: 33 cost time: 6.597689151763916
Epoch: 33, Steps: 154 | Train Loss: 1.551 Vali Loss: 6.459 Vali Acc: 0.384 Test Loss: 6.459 Test Acc: 0.384
Validation loss decreased (-0.381541 --> -0.383553).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.9225287
	speed: 0.2045s/iter; left time: 2089.9431s
Epoch: 34 cost time: 6.72285270690918
Epoch: 34, Steps: 154 | Train Loss: 1.332 Vali Loss: 7.516 Vali Acc: 0.131 Test Loss: 7.516 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 1.5579960
	speed: 0.2092s/iter; left time: 2105.8583s
Epoch: 35 cost time: 6.682554244995117
Epoch: 35, Steps: 154 | Train Loss: 1.177 Vali Loss: 8.133 Vali Acc: 0.122 Test Loss: 8.133 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.9617338
	speed: 0.2013s/iter; left time: 1994.9693s
Epoch: 36 cost time: 6.430412292480469
Epoch: 36, Steps: 154 | Train Loss: 1.305 Vali Loss: 9.384 Vali Acc: 0.173 Test Loss: 9.384 Test Acc: 0.173
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 1.0394551
	speed: 0.2007s/iter; left time: 1958.4290s
Epoch: 37 cost time: 6.456689357757568
Epoch: 37, Steps: 154 | Train Loss: 1.484 Vali Loss: 8.572 Vali Acc: 0.225 Test Loss: 8.572 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.7133149
	speed: 0.2009s/iter; left time: 1929.6476s
Epoch: 38 cost time: 6.279875755310059
Epoch: 38, Steps: 154 | Train Loss: 1.517 Vali Loss: 7.345 Vali Acc: 0.196 Test Loss: 7.345 Test Acc: 0.196
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.5044541
	speed: 0.2050s/iter; left time: 1936.8809s
Epoch: 39 cost time: 6.494475841522217
Epoch: 39, Steps: 154 | Train Loss: 1.470 Vali Loss: 8.641 Vali Acc: 0.155 Test Loss: 8.641 Test Acc: 0.155
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 4.5976782
	speed: 0.2037s/iter; left time: 1893.3436s
Epoch: 40 cost time: 6.441299915313721
Epoch: 40, Steps: 154 | Train Loss: 1.466 Vali Loss: 7.041 Vali Acc: 0.289 Test Loss: 7.041 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 35.0468102
	speed: 0.1924s/iter; left time: 1758.3976s
Epoch: 41 cost time: 6.3334996700286865
Epoch: 41, Steps: 154 | Train Loss: 1.562 Vali Loss: 9.991 Vali Acc: 0.115 Test Loss: 9.991 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 0.6672173
	speed: 0.1875s/iter; left time: 1685.3728s
Epoch: 42 cost time: 6.377849578857422
Epoch: 42, Steps: 154 | Train Loss: 1.644 Vali Loss: 10.110 Vali Acc: 0.109 Test Loss: 10.110 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 43 | loss: 0.5394289
	speed: 0.1969s/iter; left time: 1738.7991s
Epoch: 43 cost time: 6.378565788269043
Epoch: 43, Steps: 154 | Train Loss: 1.794 Vali Loss: 8.075 Vali Acc: 0.378 Test Loss: 8.075 Test Acc: 0.378
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38361719383617193
model parameter : 1328182
model size : 14.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9248713
	speed: 0.0596s/iter; left time: 911.2827s
Epoch: 1 cost time: 8.277051210403442
Epoch: 1, Steps: 154 | Train Loss: 2.249 Vali Loss: 2.271 Vali Acc: 0.322 Test Loss: 2.271 Test Acc: 0.322
Validation loss decreased (inf --> -0.322362).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.9149690
	speed: 0.1797s/iter; left time: 2721.5679s
Epoch: 2 cost time: 5.883643627166748
Epoch: 2, Steps: 154 | Train Loss: 2.209 Vali Loss: 2.299 Vali Acc: 0.329 Test Loss: 2.299 Test Acc: 0.329
Validation loss decreased (-0.322362 --> -0.328850).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5529962
	speed: 0.1603s/iter; left time: 2403.4259s
Epoch: 3 cost time: 6.9616076946258545
Epoch: 3, Steps: 154 | Train Loss: 2.028 Vali Loss: 2.285 Vali Acc: 0.335 Test Loss: 2.285 Test Acc: 0.335
Validation loss decreased (-0.328850 --> -0.335338).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5337106
	speed: 0.1762s/iter; left time: 2614.7672s
Epoch: 4 cost time: 6.915783643722534
Epoch: 4, Steps: 154 | Train Loss: 2.093 Vali Loss: 2.330 Vali Acc: 0.329 Test Loss: 2.330 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8191023
	speed: 0.1707s/iter; left time: 2506.2764s
Epoch: 5 cost time: 6.749389886856079
Epoch: 5, Steps: 154 | Train Loss: 1.948 Vali Loss: 2.613 Vali Acc: 0.330 Test Loss: 2.613 Test Acc: 0.330
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.1396117
	speed: 0.1785s/iter; left time: 2593.9659s
Epoch: 6 cost time: 7.156503438949585
Epoch: 6, Steps: 154 | Train Loss: 1.866 Vali Loss: 2.498 Vali Acc: 0.343 Test Loss: 2.498 Test Acc: 0.343
Validation loss decreased (-0.335338 --> -0.342635).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5159898
	speed: 0.1772s/iter; left time: 2547.8649s
Epoch: 7 cost time: 7.233270645141602
Epoch: 7, Steps: 154 | Train Loss: 1.847 Vali Loss: 2.699 Vali Acc: 0.176 Test Loss: 2.699 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8074793
	speed: 0.1688s/iter; left time: 2400.3085s
Epoch: 8 cost time: 7.101714849472046
Epoch: 8, Steps: 154 | Train Loss: 2.092 Vali Loss: 2.549 Vali Acc: 0.350 Test Loss: 2.549 Test Acc: 0.350
Validation loss decreased (-0.342635 --> -0.349528).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4600059
	speed: 0.1993s/iter; left time: 2804.0698s
Epoch: 9 cost time: 7.72382926940918
Epoch: 9, Steps: 154 | Train Loss: 1.751 Vali Loss: 2.830 Vali Acc: 0.173 Test Loss: 2.830 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.1603923
	speed: 0.1925s/iter; left time: 2678.4317s
Epoch: 10 cost time: 7.451656341552734
Epoch: 10, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.824 Vali Acc: 0.356 Test Loss: 2.824 Test Acc: 0.356
Validation loss decreased (-0.349528 --> -0.355608).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8592501
	speed: 0.1951s/iter; left time: 2684.2801s
Epoch: 11 cost time: 7.160994052886963
Epoch: 11, Steps: 154 | Train Loss: 1.798 Vali Loss: 2.912 Vali Acc: 0.356 Test Loss: 2.912 Test Acc: 0.356
Validation loss decreased (-0.355608 --> -0.356013).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5833474
	speed: 0.1749s/iter; left time: 2380.4684s
Epoch: 12 cost time: 6.96948504447937
Epoch: 12, Steps: 154 | Train Loss: 1.767 Vali Loss: 3.290 Vali Acc: 0.097 Test Loss: 3.290 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 10.7259321
	speed: 0.1726s/iter; left time: 2322.2624s
Epoch: 13 cost time: 6.716754198074341
Epoch: 13, Steps: 154 | Train Loss: 1.735 Vali Loss: 3.259 Vali Acc: 0.359 Test Loss: 3.259 Test Acc: 0.359
Validation loss decreased (-0.356013 --> -0.359254).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3953155
	speed: 0.1743s/iter; left time: 2318.2160s
Epoch: 14 cost time: 6.8892247676849365
Epoch: 14, Steps: 154 | Train Loss: 1.774 Vali Loss: 3.528 Vali Acc: 0.355 Test Loss: 3.528 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1373944
	speed: 0.1756s/iter; left time: 2308.6591s
Epoch: 15 cost time: 7.148909330368042
Epoch: 15, Steps: 154 | Train Loss: 1.739 Vali Loss: 3.249 Vali Acc: 0.366 Test Loss: 3.249 Test Acc: 0.366
Validation loss decreased (-0.359254 --> -0.365742).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5517632
	speed: 0.1758s/iter; left time: 2283.6051s
Epoch: 16 cost time: 6.6141440868377686
Epoch: 16, Steps: 154 | Train Loss: 2.060 Vali Loss: 4.139 Vali Acc: 0.065 Test Loss: 4.139 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.1391705
	speed: 0.1938s/iter; left time: 2487.7496s
Epoch: 17 cost time: 7.571473121643066
Epoch: 17, Steps: 154 | Train Loss: 1.653 Vali Loss: 3.982 Vali Acc: 0.241 Test Loss: 3.982 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.8537436
	speed: 0.1907s/iter; left time: 2418.9152s
Epoch: 18 cost time: 6.449542284011841
Epoch: 18, Steps: 154 | Train Loss: 1.621 Vali Loss: 3.972 Vali Acc: 0.104 Test Loss: 3.972 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.6837864
	speed: 0.1873s/iter; left time: 2346.2749s
Epoch: 19 cost time: 7.069034576416016
Epoch: 19, Steps: 154 | Train Loss: 1.592 Vali Loss: 3.946 Vali Acc: 0.212 Test Loss: 3.946 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.9514189
	speed: 0.1797s/iter; left time: 2223.2203s
Epoch: 20 cost time: 6.914511680603027
Epoch: 20, Steps: 154 | Train Loss: 1.489 Vali Loss: 3.890 Vali Acc: 0.360 Test Loss: 3.890 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.3839707
	speed: 0.1702s/iter; left time: 2079.6165s
Epoch: 21 cost time: 6.965489864349365
Epoch: 21, Steps: 154 | Train Loss: 1.503 Vali Loss: 3.976 Vali Acc: 0.371 Test Loss: 3.976 Test Acc: 0.371
Validation loss decreased (-0.365742 --> -0.370601).  Saving model ...
	iters: 100, epoch: 22 | loss: 2.8227689
	speed: 0.1732s/iter; left time: 2089.8943s
Epoch: 22 cost time: 7.0708935260772705
Epoch: 22, Steps: 154 | Train Loss: 1.661 Vali Loss: 4.358 Vali Acc: 0.184 Test Loss: 4.358 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.8791602
	speed: 0.1759s/iter; left time: 2095.7155s
Epoch: 23 cost time: 7.305715560913086
Epoch: 23, Steps: 154 | Train Loss: 2.516 Vali Loss: 4.221 Vali Acc: 0.226 Test Loss: 4.221 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.5531957
	speed: 0.1742s/iter; left time: 2048.4951s
Epoch: 24 cost time: 6.658368349075317
Epoch: 24, Steps: 154 | Train Loss: 1.461 Vali Loss: 5.470 Vali Acc: 0.094 Test Loss: 5.470 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.2674413
	speed: 0.1726s/iter; left time: 2003.3026s
Epoch: 25 cost time: 7.183620929718018
Epoch: 25, Steps: 154 | Train Loss: 2.008 Vali Loss: 4.943 Vali Acc: 0.350 Test Loss: 4.943 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.2657081
	speed: 0.1889s/iter; left time: 2163.1622s
Epoch: 26 cost time: 7.18410062789917
Epoch: 26, Steps: 154 | Train Loss: 1.800 Vali Loss: 4.821 Vali Acc: 0.287 Test Loss: 4.821 Test Acc: 0.287
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.1961912
	speed: 0.1874s/iter; left time: 2116.5939s
Epoch: 27 cost time: 6.778410911560059
Epoch: 27, Steps: 154 | Train Loss: 1.392 Vali Loss: 4.985 Vali Acc: 0.091 Test Loss: 4.985 Test Acc: 0.091
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 2.1047280
	speed: 0.1958s/iter; left time: 2181.3624s
Epoch: 28 cost time: 7.093085765838623
Epoch: 28, Steps: 154 | Train Loss: 1.650 Vali Loss: 4.873 Vali Acc: 0.368 Test Loss: 4.873 Test Acc: 0.368
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.8830617
	speed: 0.1837s/iter; left time: 2019.0351s
Epoch: 29 cost time: 6.603207349777222
Epoch: 29, Steps: 154 | Train Loss: 1.466 Vali Loss: 5.769 Vali Acc: 0.086 Test Loss: 5.769 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.5162673
	speed: 0.1713s/iter; left time: 1855.9361s
Epoch: 30 cost time: 6.778595685958862
Epoch: 30, Steps: 154 | Train Loss: 2.010 Vali Loss: 5.573 Vali Acc: 0.240 Test Loss: 5.573 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.9751793
	speed: 0.1709s/iter; left time: 1824.9741s
Epoch: 31 cost time: 6.8986594676971436
Epoch: 31, Steps: 154 | Train Loss: 1.418 Vali Loss: 4.378 Vali Acc: 0.104 Test Loss: 4.378 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3706407137064071
model parameter : 1066038
model size : 13.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9469777
	speed: 0.0616s/iter; left time: 942.2058s
Epoch: 1 cost time: 8.683228254318237
Epoch: 1, Steps: 154 | Train Loss: 2.239 Vali Loss: 2.269 Vali Acc: 0.322 Test Loss: 2.269 Test Acc: 0.322
Validation loss decreased (inf --> -0.322362).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8048253
	speed: 0.1802s/iter; left time: 2728.8092s
Epoch: 2 cost time: 6.858575820922852
Epoch: 2, Steps: 154 | Train Loss: 2.184 Vali Loss: 2.303 Vali Acc: 0.328 Test Loss: 2.303 Test Acc: 0.328
Validation loss decreased (-0.322362 --> -0.328444).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5760167
	speed: 0.1871s/iter; left time: 2805.3747s
Epoch: 3 cost time: 6.7420947551727295
Epoch: 3, Steps: 154 | Train Loss: 2.061 Vali Loss: 2.330 Vali Acc: 0.337 Test Loss: 2.330 Test Acc: 0.337
Validation loss decreased (-0.328444 --> -0.336554).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5693289
	speed: 0.1902s/iter; left time: 2822.7518s
Epoch: 4 cost time: 7.255350828170776
Epoch: 4, Steps: 154 | Train Loss: 2.024 Vali Loss: 2.307 Vali Acc: 0.336 Test Loss: 2.307 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9290473
	speed: 0.1938s/iter; left time: 2846.1553s
Epoch: 5 cost time: 7.135598659515381
Epoch: 5, Steps: 154 | Train Loss: 1.905 Vali Loss: 2.759 Vali Acc: 0.327 Test Loss: 2.759 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.0448442
	speed: 0.1688s/iter; left time: 2453.0396s
Epoch: 6 cost time: 7.056485891342163
Epoch: 6, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.462 Vali Acc: 0.343 Test Loss: 2.462 Test Acc: 0.343
Validation loss decreased (-0.336554 --> -0.342636).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5306287
	speed: 0.1771s/iter; left time: 2546.6557s
Epoch: 7 cost time: 7.150424480438232
Epoch: 7, Steps: 154 | Train Loss: 1.853 Vali Loss: 2.591 Vali Acc: 0.347 Test Loss: 2.591 Test Acc: 0.347
Validation loss decreased (-0.342636 --> -0.346689).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7064729
	speed: 0.1732s/iter; left time: 2462.7984s
Epoch: 8 cost time: 6.87892484664917
Epoch: 8, Steps: 154 | Train Loss: 1.845 Vali Loss: 2.660 Vali Acc: 0.350 Test Loss: 2.660 Test Acc: 0.350
Validation loss decreased (-0.346689 --> -0.349933).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6887628
	speed: 0.1708s/iter; left time: 2403.5806s
Epoch: 9 cost time: 6.867358207702637
Epoch: 9, Steps: 154 | Train Loss: 1.873 Vali Loss: 2.692 Vali Acc: 0.354 Test Loss: 2.692 Test Acc: 0.354
Validation loss decreased (-0.349933 --> -0.354393).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3517015
	speed: 0.1769s/iter; left time: 2461.4849s
Epoch: 10 cost time: 7.051427364349365
Epoch: 10, Steps: 154 | Train Loss: 1.733 Vali Loss: 3.041 Vali Acc: 0.360 Test Loss: 3.041 Test Acc: 0.360
Validation loss decreased (-0.354393 --> -0.360067).  Saving model ...
	iters: 100, epoch: 11 | loss: 7.9711194
	speed: 0.1777s/iter; left time: 2445.1907s
Epoch: 11 cost time: 6.619533538818359
Epoch: 11, Steps: 154 | Train Loss: 1.739 Vali Loss: 3.120 Vali Acc: 0.318 Test Loss: 3.120 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2158719
	speed: 0.1960s/iter; left time: 2667.2947s
Epoch: 12 cost time: 7.142949104309082
Epoch: 12, Steps: 154 | Train Loss: 1.889 Vali Loss: 3.260 Vali Acc: 0.358 Test Loss: 3.260 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.6576312
	speed: 0.1877s/iter; left time: 2524.7530s
Epoch: 13 cost time: 6.6867828369140625
Epoch: 13, Steps: 154 | Train Loss: 1.693 Vali Loss: 3.290 Vali Acc: 0.192 Test Loss: 3.290 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4728938
	speed: 0.1932s/iter; left time: 2569.3858s
Epoch: 14 cost time: 6.885651350021362
Epoch: 14, Steps: 154 | Train Loss: 1.716 Vali Loss: 3.427 Vali Acc: 0.339 Test Loss: 3.427 Test Acc: 0.339
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.2606728
	speed: 0.1716s/iter; left time: 2255.3806s
Epoch: 15 cost time: 6.964933395385742
Epoch: 15, Steps: 154 | Train Loss: 2.083 Vali Loss: 3.623 Vali Acc: 0.358 Test Loss: 3.623 Test Acc: 0.358
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.3875877
	speed: 0.1691s/iter; left time: 2197.1022s
Epoch: 16 cost time: 6.9070518016815186
Epoch: 16, Steps: 154 | Train Loss: 1.571 Vali Loss: 4.197 Vali Acc: 0.077 Test Loss: 4.197 Test Acc: 0.077
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.0804058
	speed: 0.1736s/iter; left time: 2228.7870s
Epoch: 17 cost time: 6.959068298339844
Epoch: 17, Steps: 154 | Train Loss: 1.567 Vali Loss: 4.205 Vali Acc: 0.355 Test Loss: 4.205 Test Acc: 0.355
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.9989368
	speed: 0.1749s/iter; left time: 2218.8358s
Epoch: 18 cost time: 7.405359506607056
Epoch: 18, Steps: 154 | Train Loss: 1.568 Vali Loss: 4.219 Vali Acc: 0.129 Test Loss: 4.219 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.3658690
	speed: 0.1722s/iter; left time: 2157.3498s
Epoch: 19 cost time: 6.744451522827148
Epoch: 19, Steps: 154 | Train Loss: 1.681 Vali Loss: 4.120 Vali Acc: 0.370 Test Loss: 4.120 Test Acc: 0.370
Validation loss decreased (-0.360067 --> -0.370194).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.3896621
	speed: 0.1890s/iter; left time: 2338.8657s
Epoch: 20 cost time: 7.659347772598267
Epoch: 20, Steps: 154 | Train Loss: 1.663 Vali Loss: 3.756 Vali Acc: 0.362 Test Loss: 3.756 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.4717069
	speed: 0.1969s/iter; left time: 2406.8497s
Epoch: 21 cost time: 6.555940389633179
Epoch: 21, Steps: 154 | Train Loss: 1.509 Vali Loss: 4.551 Vali Acc: 0.361 Test Loss: 4.551 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 2.4354453
	speed: 0.1936s/iter; left time: 2335.7532s
Epoch: 22 cost time: 7.668307542800903
Epoch: 22, Steps: 154 | Train Loss: 1.634 Vali Loss: 3.971 Vali Acc: 0.371 Test Loss: 3.971 Test Acc: 0.371
Validation loss decreased (-0.370194 --> -0.371007).  Saving model ...
	iters: 100, epoch: 23 | loss: 2.0336776
	speed: 0.1974s/iter; left time: 2352.0249s
Epoch: 23 cost time: 7.2069010734558105
Epoch: 23, Steps: 154 | Train Loss: 1.530 Vali Loss: 4.160 Vali Acc: 0.318 Test Loss: 4.160 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.5216683
	speed: 0.1727s/iter; left time: 2030.6451s
Epoch: 24 cost time: 6.650447845458984
Epoch: 24, Steps: 154 | Train Loss: 1.913 Vali Loss: 4.832 Vali Acc: 0.099 Test Loss: 4.832 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.4715852
	speed: 0.1724s/iter; left time: 2000.7038s
Epoch: 25 cost time: 6.988651752471924
Epoch: 25, Steps: 154 | Train Loss: 1.693 Vali Loss: 4.224 Vali Acc: 0.349 Test Loss: 4.224 Test Acc: 0.349
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.8404828
	speed: 0.1732s/iter; left time: 1983.8396s
Epoch: 26 cost time: 6.9933552742004395
Epoch: 26, Steps: 154 | Train Loss: 1.360 Vali Loss: 5.074 Vali Acc: 0.346 Test Loss: 5.074 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.1146169
	speed: 0.1749s/iter; left time: 1975.6537s
Epoch: 27 cost time: 6.638382196426392
Epoch: 27, Steps: 154 | Train Loss: 1.535 Vali Loss: 5.106 Vali Acc: 0.145 Test Loss: 5.106 Test Acc: 0.145
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 3.1493037
	speed: 0.1711s/iter; left time: 1906.7835s
Epoch: 28 cost time: 6.9016194343566895
Epoch: 28, Steps: 154 | Train Loss: 1.321 Vali Loss: 5.542 Vali Acc: 0.266 Test Loss: 5.542 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 1.2408215
	speed: 0.1950s/iter; left time: 2142.9361s
Epoch: 29 cost time: 6.779991149902344
Epoch: 29, Steps: 154 | Train Loss: 1.544 Vali Loss: 6.778 Vali Acc: 0.078 Test Loss: 6.778 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.2700670
	speed: 0.1915s/iter; left time: 2075.0440s
Epoch: 30 cost time: 7.411273002624512
Epoch: 30, Steps: 154 | Train Loss: 1.261 Vali Loss: 6.304 Vali Acc: 0.095 Test Loss: 6.304 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 3.7398732
	speed: 0.1978s/iter; left time: 2112.7649s
Epoch: 31 cost time: 7.146881818771362
Epoch: 31, Steps: 154 | Train Loss: 2.442 Vali Loss: 7.207 Vali Acc: 0.103 Test Loss: 7.207 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 1.0765519
	speed: 0.1798s/iter; left time: 1892.8931s
Epoch: 32 cost time: 6.560055255889893
Epoch: 32, Steps: 154 | Train Loss: 1.315 Vali Loss: 6.145 Vali Acc: 0.108 Test Loss: 6.145 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3710462287104623
model parameter : 1066038
model size : 13.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9123064
	speed: 0.0633s/iter; left time: 969.2897s
Epoch: 1 cost time: 8.765133142471313
Epoch: 1, Steps: 154 | Train Loss: 2.235 Vali Loss: 2.267 Vali Acc: 0.323 Test Loss: 2.267 Test Acc: 0.323
Validation loss decreased (inf --> -0.323173).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6962311
	speed: 0.1724s/iter; left time: 2610.6325s
Epoch: 2 cost time: 6.872607946395874
Epoch: 2, Steps: 154 | Train Loss: 2.209 Vali Loss: 2.303 Vali Acc: 0.331 Test Loss: 2.303 Test Acc: 0.331
Validation loss decreased (-0.323173 --> -0.330877).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5636861
	speed: 0.1658s/iter; left time: 2485.1679s
Epoch: 3 cost time: 6.590949058532715
Epoch: 3, Steps: 154 | Train Loss: 1.998 Vali Loss: 2.259 Vali Acc: 0.337 Test Loss: 2.259 Test Acc: 0.337
Validation loss decreased (-0.330877 --> -0.336960).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5652075
	speed: 0.1654s/iter; left time: 2453.9716s
Epoch: 4 cost time: 7.053471565246582
Epoch: 4, Steps: 154 | Train Loss: 2.110 Vali Loss: 2.383 Vali Acc: 0.337 Test Loss: 2.383 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8830656
	speed: 0.1932s/iter; left time: 2837.0736s
Epoch: 5 cost time: 6.777627468109131
Epoch: 5, Steps: 154 | Train Loss: 1.926 Vali Loss: 2.707 Vali Acc: 0.333 Test Loss: 2.707 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.1581330
	speed: 0.1850s/iter; left time: 2688.7769s
Epoch: 6 cost time: 6.697378873825073
Epoch: 6, Steps: 154 | Train Loss: 1.967 Vali Loss: 2.607 Vali Acc: 0.341 Test Loss: 2.607 Test Acc: 0.341
Validation loss decreased (-0.336960 --> -0.341012).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4334427
	speed: 0.1924s/iter; left time: 2766.3064s
Epoch: 7 cost time: 6.783764362335205
Epoch: 7, Steps: 154 | Train Loss: 1.911 Vali Loss: 2.662 Vali Acc: 0.342 Test Loss: 2.662 Test Acc: 0.342
Validation loss decreased (-0.341012 --> -0.341823).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6895614
	speed: 0.1693s/iter; left time: 2407.8456s
Epoch: 8 cost time: 6.288718938827515
Epoch: 8, Steps: 154 | Train Loss: 1.791 Vali Loss: 2.647 Vali Acc: 0.341 Test Loss: 2.647 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5423465
	speed: 0.1693s/iter; left time: 2382.4804s
Epoch: 9 cost time: 6.816319942474365
Epoch: 9, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.828 Vali Acc: 0.332 Test Loss: 2.828 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.8848755
	speed: 0.1668s/iter; left time: 2321.5244s
Epoch: 10 cost time: 6.7042155265808105
Epoch: 10, Steps: 154 | Train Loss: 1.719 Vali Loss: 2.977 Vali Acc: 0.356 Test Loss: 2.977 Test Acc: 0.356
Validation loss decreased (-0.341823 --> -0.356012).  Saving model ...
	iters: 100, epoch: 11 | loss: 8.6361361
	speed: 0.1662s/iter; left time: 2287.6053s
Epoch: 11 cost time: 6.473344087600708
Epoch: 11, Steps: 154 | Train Loss: 1.802 Vali Loss: 3.021 Vali Acc: 0.355 Test Loss: 3.021 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1720481
	speed: 0.1666s/iter; left time: 2267.4616s
Epoch: 12 cost time: 6.784733533859253
Epoch: 12, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.968 Vali Acc: 0.112 Test Loss: 2.968 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.7129816
	speed: 0.1780s/iter; left time: 2395.1355s
Epoch: 13 cost time: 6.774475336074829
Epoch: 13, Steps: 154 | Train Loss: 1.682 Vali Loss: 3.278 Vali Acc: 0.349 Test Loss: 3.278 Test Acc: 0.349
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.3681188
	speed: 0.1791s/iter; left time: 2381.6253s
Epoch: 14 cost time: 6.434934616088867
Epoch: 14, Steps: 154 | Train Loss: 1.803 Vali Loss: 4.094 Vali Acc: 0.350 Test Loss: 4.094 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.3407289
	speed: 0.1860s/iter; left time: 2444.3196s
Epoch: 15 cost time: 6.837409496307373
Epoch: 15, Steps: 154 | Train Loss: 1.703 Vali Loss: 3.435 Vali Acc: 0.365 Test Loss: 3.435 Test Acc: 0.365
Validation loss decreased (-0.356012 --> -0.364929).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.2205241
	speed: 0.1854s/iter; left time: 2407.8922s
Epoch: 16 cost time: 6.333496809005737
Epoch: 16, Steps: 154 | Train Loss: 1.908 Vali Loss: 3.723 Vali Acc: 0.137 Test Loss: 3.723 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 61.1536865
	speed: 0.1706s/iter; left time: 2190.5062s
Epoch: 17 cost time: 6.894010066986084
Epoch: 17, Steps: 154 | Train Loss: 1.924 Vali Loss: 4.718 Vali Acc: 0.108 Test Loss: 4.718 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.4591224
	speed: 0.1754s/iter; left time: 2224.0426s
Epoch: 18 cost time: 7.009265184402466
Epoch: 18, Steps: 154 | Train Loss: 1.551 Vali Loss: 4.419 Vali Acc: 0.350 Test Loss: 4.419 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.3958018
	speed: 0.1688s/iter; left time: 2114.7309s
Epoch: 19 cost time: 6.599280595779419
Epoch: 19, Steps: 154 | Train Loss: 1.660 Vali Loss: 4.091 Vali Acc: 0.369 Test Loss: 4.091 Test Acc: 0.369
Validation loss decreased (-0.364929 --> -0.368978).  Saving model ...
	iters: 100, epoch: 20 | loss: 2.0762842
	speed: 0.1676s/iter; left time: 2073.8859s
Epoch: 20 cost time: 6.861846685409546
Epoch: 20, Steps: 154 | Train Loss: 1.878 Vali Loss: 3.901 Vali Acc: 0.366 Test Loss: 3.901 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.3278781
	speed: 0.1670s/iter; left time: 2041.2627s
Epoch: 21 cost time: 6.55242395401001
Epoch: 21, Steps: 154 | Train Loss: 1.495 Vali Loss: 4.071 Vali Acc: 0.373 Test Loss: 4.071 Test Acc: 0.373
Validation loss decreased (-0.368978 --> -0.373439).  Saving model ...
	iters: 100, epoch: 22 | loss: 2.6767490
	speed: 0.1785s/iter; left time: 2153.7546s
Epoch: 22 cost time: 6.691967725753784
Epoch: 22, Steps: 154 | Train Loss: 1.486 Vali Loss: 4.309 Vali Acc: 0.175 Test Loss: 4.309 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.7582023
	speed: 0.1870s/iter; left time: 2228.0155s
Epoch: 23 cost time: 6.26878547668457
Epoch: 23, Steps: 154 | Train Loss: 1.624 Vali Loss: 5.008 Vali Acc: 0.099 Test Loss: 5.008 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.0945095
	speed: 0.1819s/iter; left time: 2138.4275s
Epoch: 24 cost time: 6.631370782852173
Epoch: 24, Steps: 154 | Train Loss: 1.510 Vali Loss: 4.832 Vali Acc: 0.376 Test Loss: 4.832 Test Acc: 0.376
Validation loss decreased (-0.373439 --> -0.376270).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.2926028
	speed: 0.1830s/iter; left time: 2123.6867s
Epoch: 25 cost time: 6.694515705108643
Epoch: 25, Steps: 154 | Train Loss: 1.607 Vali Loss: 4.919 Vali Acc: 0.363 Test Loss: 4.919 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.9391072
	speed: 0.1707s/iter; left time: 1954.3341s
Epoch: 26 cost time: 6.6825621128082275
Epoch: 26, Steps: 154 | Train Loss: 1.517 Vali Loss: 5.024 Vali Acc: 0.379 Test Loss: 5.024 Test Acc: 0.379
Validation loss decreased (-0.376270 --> -0.378701).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.9050804
	speed: 0.1699s/iter; left time: 1919.0322s
Epoch: 27 cost time: 6.544079780578613
Epoch: 27, Steps: 154 | Train Loss: 1.541 Vali Loss: 4.524 Vali Acc: 0.380 Test Loss: 4.524 Test Acc: 0.380
Validation loss decreased (-0.378701 --> -0.379922).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.9553528
	speed: 0.1697s/iter; left time: 1890.6193s
Epoch: 28 cost time: 6.641056537628174
Epoch: 28, Steps: 154 | Train Loss: 1.627 Vali Loss: 4.366 Vali Acc: 0.386 Test Loss: 4.366 Test Acc: 0.386
Validation loss decreased (-0.379922 --> -0.386007).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.6548830
	speed: 0.1684s/iter; left time: 1850.0296s
Epoch: 29 cost time: 6.5482566356658936
Epoch: 29, Steps: 154 | Train Loss: 1.978 Vali Loss: 5.298 Vali Acc: 0.095 Test Loss: 5.298 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.2192553
	speed: 0.1676s/iter; left time: 1815.7166s
Epoch: 30 cost time: 6.906460285186768
Epoch: 30, Steps: 154 | Train Loss: 1.170 Vali Loss: 6.923 Vali Acc: 0.092 Test Loss: 6.923 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.6428384
	speed: 0.1902s/iter; left time: 2031.0425s
Epoch: 31 cost time: 7.310245513916016
Epoch: 31, Steps: 154 | Train Loss: 1.683 Vali Loss: 5.883 Vali Acc: 0.125 Test Loss: 5.883 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.6855398
	speed: 0.1825s/iter; left time: 1921.5578s
Epoch: 32 cost time: 6.589852809906006
Epoch: 32, Steps: 154 | Train Loss: 1.238 Vali Loss: 5.493 Vali Acc: 0.153 Test Loss: 5.493 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 2.7948077
	speed: 0.1783s/iter; left time: 1849.9716s
Epoch: 33 cost time: 6.030844449996948
Epoch: 33, Steps: 154 | Train Loss: 1.209 Vali Loss: 6.348 Vali Acc: 0.317 Test Loss: 6.348 Test Acc: 0.317
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.8479488
	speed: 0.1523s/iter; left time: 1556.7864s
Epoch: 34 cost time: 6.80867075920105
Epoch: 34, Steps: 154 | Train Loss: 1.249 Vali Loss: 6.133 Vali Acc: 0.119 Test Loss: 6.133 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.9391531
	speed: 0.1650s/iter; left time: 1660.8686s
Epoch: 35 cost time: 6.414227724075317
Epoch: 35, Steps: 154 | Train Loss: 1.479 Vali Loss: 9.076 Vali Acc: 0.086 Test Loss: 9.076 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.2665274
	speed: 0.1729s/iter; left time: 1713.1911s
Epoch: 36 cost time: 6.570052862167358
Epoch: 36, Steps: 154 | Train Loss: 2.206 Vali Loss: 7.831 Vali Acc: 0.091 Test Loss: 7.831 Test Acc: 0.091
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.9400935
	speed: 0.1674s/iter; left time: 1633.2416s
Epoch: 37 cost time: 6.569526433944702
Epoch: 37, Steps: 154 | Train Loss: 2.440 Vali Loss: 8.157 Vali Acc: 0.099 Test Loss: 8.157 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 1.4807558
	speed: 0.1678s/iter; left time: 1611.8134s
Epoch: 38 cost time: 6.418816089630127
Epoch: 38, Steps: 154 | Train Loss: 1.009 Vali Loss: 8.192 Vali Acc: 0.167 Test Loss: 8.192 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38605028386050283
model parameter : 1066038
model size : 13.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8915647
	speed: 0.0613s/iter; left time: 938.4752s
Epoch: 1 cost time: 8.510429620742798
Epoch: 1, Steps: 154 | Train Loss: 2.209 Vali Loss: 2.244 Vali Acc: 0.322 Test Loss: 2.244 Test Acc: 0.322
Validation loss decreased (inf --> -0.322362).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5157204
	speed: 0.1799s/iter; left time: 2725.3046s
Epoch: 2 cost time: 6.089210033416748
Epoch: 2, Steps: 154 | Train Loss: 2.189 Vali Loss: 2.256 Vali Acc: 0.329 Test Loss: 2.256 Test Acc: 0.329
Validation loss decreased (-0.322362 --> -0.329256).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5422726
	speed: 0.1745s/iter; left time: 2616.3800s
Epoch: 3 cost time: 6.274750232696533
Epoch: 3, Steps: 154 | Train Loss: 2.011 Vali Loss: 2.220 Vali Acc: 0.336 Test Loss: 2.220 Test Acc: 0.336
Validation loss decreased (-0.329256 --> -0.335744).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4667780
	speed: 0.1612s/iter; left time: 2391.5295s
Epoch: 4 cost time: 6.384021282196045
Epoch: 4, Steps: 154 | Train Loss: 2.126 Vali Loss: 2.266 Vali Acc: 0.340 Test Loss: 2.266 Test Acc: 0.340
Validation loss decreased (-0.335744 --> -0.339799).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8525232
	speed: 0.1635s/iter; left time: 2401.7108s
Epoch: 5 cost time: 6.3590757846832275
Epoch: 5, Steps: 154 | Train Loss: 1.937 Vali Loss: 2.615 Vali Acc: 0.331 Test Loss: 2.615 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.0178180
	speed: 0.1606s/iter; left time: 2333.8478s
Epoch: 6 cost time: 6.559354782104492
Epoch: 6, Steps: 154 | Train Loss: 1.864 Vali Loss: 2.529 Vali Acc: 0.343 Test Loss: 2.529 Test Acc: 0.343
Validation loss decreased (-0.339799 --> -0.343446).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5278145
	speed: 0.1666s/iter; left time: 2395.8366s
Epoch: 7 cost time: 6.634356498718262
Epoch: 7, Steps: 154 | Train Loss: 1.853 Vali Loss: 2.753 Vali Acc: 0.204 Test Loss: 2.753 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7626562
	speed: 0.1635s/iter; left time: 2324.9202s
Epoch: 8 cost time: 6.238051652908325
Epoch: 8, Steps: 154 | Train Loss: 1.979 Vali Loss: 2.584 Vali Acc: 0.352 Test Loss: 2.584 Test Acc: 0.352
Validation loss decreased (-0.343446 --> -0.351556).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7310383
	speed: 0.1866s/iter; left time: 2625.5750s
Epoch: 9 cost time: 6.954084634780884
Epoch: 9, Steps: 154 | Train Loss: 1.921 Vali Loss: 2.662 Vali Acc: 0.340 Test Loss: 2.662 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.6251576
	speed: 0.1810s/iter; left time: 2518.9621s
Epoch: 10 cost time: 6.0462915897369385
Epoch: 10, Steps: 154 | Train Loss: 1.725 Vali Loss: 2.777 Vali Acc: 0.361 Test Loss: 2.777 Test Acc: 0.361
Validation loss decreased (-0.351556 --> -0.360881).  Saving model ...
	iters: 100, epoch: 11 | loss: 12.6108227
	speed: 0.1768s/iter; left time: 2432.4688s
Epoch: 11 cost time: 6.5920445919036865
Epoch: 11, Steps: 154 | Train Loss: 1.751 Vali Loss: 3.154 Vali Acc: 0.355 Test Loss: 3.154 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1329223
	speed: 0.1739s/iter; left time: 2366.8114s
Epoch: 12 cost time: 6.471372604370117
Epoch: 12, Steps: 154 | Train Loss: 1.837 Vali Loss: 3.369 Vali Acc: 0.322 Test Loss: 3.369 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.5048754
	speed: 0.1631s/iter; left time: 2193.7742s
Epoch: 13 cost time: 6.224889516830444
Epoch: 13, Steps: 154 | Train Loss: 1.769 Vali Loss: 3.524 Vali Acc: 0.350 Test Loss: 3.524 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4067692
	speed: 0.1611s/iter; left time: 2142.2683s
Epoch: 14 cost time: 6.4887144565582275
Epoch: 14, Steps: 154 | Train Loss: 1.807 Vali Loss: 4.031 Vali Acc: 0.340 Test Loss: 4.031 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.3468963
	speed: 0.1616s/iter; left time: 2124.0284s
Epoch: 15 cost time: 6.393799781799316
Epoch: 15, Steps: 154 | Train Loss: 1.995 Vali Loss: 3.428 Vali Acc: 0.359 Test Loss: 3.428 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.0206438
	speed: 0.1578s/iter; left time: 2050.5738s
Epoch: 16 cost time: 6.205571174621582
Epoch: 16, Steps: 154 | Train Loss: 1.566 Vali Loss: 3.498 Vali Acc: 0.213 Test Loss: 3.498 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.1376121
	speed: 0.1586s/iter; left time: 2035.7453s
Epoch: 17 cost time: 6.051085948944092
Epoch: 17, Steps: 154 | Train Loss: 1.676 Vali Loss: 4.123 Vali Acc: 0.127 Test Loss: 4.123 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.9372191
	speed: 0.1855s/iter; left time: 2352.6714s
Epoch: 18 cost time: 6.414400100708008
Epoch: 18, Steps: 154 | Train Loss: 1.756 Vali Loss: 3.699 Vali Acc: 0.250 Test Loss: 3.699 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.3185283
	speed: 0.1787s/iter; left time: 2238.3201s
Epoch: 19 cost time: 6.763732671737671
Epoch: 19, Steps: 154 | Train Loss: 1.629 Vali Loss: 3.553 Vali Acc: 0.376 Test Loss: 3.553 Test Acc: 0.376
Validation loss decreased (-0.360881 --> -0.375471).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.5508438
	speed: 0.1833s/iter; left time: 2268.5569s
Epoch: 20 cost time: 6.7374420166015625
Epoch: 20, Steps: 154 | Train Loss: 1.464 Vali Loss: 3.591 Vali Acc: 0.366 Test Loss: 3.591 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.4187560
	speed: 0.1674s/iter; left time: 2045.7381s
Epoch: 21 cost time: 6.513767957687378
Epoch: 21, Steps: 154 | Train Loss: 1.518 Vali Loss: 5.720 Vali Acc: 0.139 Test Loss: 5.720 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 3.3015614
	speed: 0.1621s/iter; left time: 1956.3210s
Epoch: 22 cost time: 6.586801290512085
Epoch: 22, Steps: 154 | Train Loss: 1.556 Vali Loss: 4.321 Vali Acc: 0.212 Test Loss: 4.321 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 4.3061132
	speed: 0.1630s/iter; left time: 1941.2945s
Epoch: 23 cost time: 6.732274532318115
Epoch: 23, Steps: 154 | Train Loss: 2.049 Vali Loss: 4.433 Vali Acc: 0.124 Test Loss: 4.433 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.3126817
	speed: 0.1578s/iter; left time: 1855.4838s
Epoch: 24 cost time: 6.417119026184082
Epoch: 24, Steps: 154 | Train Loss: 1.771 Vali Loss: 5.932 Vali Acc: 0.114 Test Loss: 5.932 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.6504090
	speed: 0.1630s/iter; left time: 1891.5820s
Epoch: 25 cost time: 6.806278705596924
Epoch: 25, Steps: 154 | Train Loss: 1.431 Vali Loss: 5.928 Vali Acc: 0.362 Test Loss: 5.928 Test Acc: 0.362
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 2.1475532
	speed: 0.1585s/iter; left time: 1814.4579s
Epoch: 26 cost time: 5.89447021484375
Epoch: 26, Steps: 154 | Train Loss: 1.948 Vali Loss: 5.747 Vali Acc: 0.120 Test Loss: 5.747 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.2358844
	speed: 0.1807s/iter; left time: 2041.0184s
Epoch: 27 cost time: 6.578336477279663
Epoch: 27, Steps: 154 | Train Loss: 1.902 Vali Loss: 5.966 Vali Acc: 0.092 Test Loss: 5.966 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 2.3152504
	speed: 0.1816s/iter; left time: 2023.4891s
Epoch: 28 cost time: 6.339100360870361
Epoch: 28, Steps: 154 | Train Loss: 1.412 Vali Loss: 6.365 Vali Acc: 0.205 Test Loss: 6.365 Test Acc: 0.205
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.8757368
	speed: 0.1841s/iter; left time: 2023.0565s
Epoch: 29 cost time: 6.299610137939453
Epoch: 29, Steps: 154 | Train Loss: 1.588 Vali Loss: 6.726 Vali Acc: 0.112 Test Loss: 6.726 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37550689375506896
model parameter : 1066038
model size : 13.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8683138
	speed: 0.0612s/iter; left time: 936.6744s
Epoch: 1 cost time: 8.507030725479126
Epoch: 1, Steps: 154 | Train Loss: 2.316 Vali Loss: 2.210 Vali Acc: 0.326 Test Loss: 2.210 Test Acc: 0.326
Validation loss decreased (inf --> -0.326012).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7680206
	speed: 0.1634s/iter; left time: 2475.4580s
Epoch: 2 cost time: 6.285062313079834
Epoch: 2, Steps: 154 | Train Loss: 2.110 Vali Loss: 2.217 Vali Acc: 0.326 Test Loss: 2.217 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8233695
	speed: 0.1614s/iter; left time: 2419.3797s
Epoch: 3 cost time: 6.725372552871704
Epoch: 3, Steps: 154 | Train Loss: 2.088 Vali Loss: 2.350 Vali Acc: 0.330 Test Loss: 2.350 Test Acc: 0.330
Validation loss decreased (-0.326012 --> -0.330066).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9493511
	speed: 0.1678s/iter; left time: 2489.2723s
Epoch: 4 cost time: 6.4637451171875
Epoch: 4, Steps: 154 | Train Loss: 1.950 Vali Loss: 2.318 Vali Acc: 0.336 Test Loss: 2.318 Test Acc: 0.336
Validation loss decreased (-0.330066 --> -0.335743).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8750265
	speed: 0.1600s/iter; left time: 2350.1003s
Epoch: 5 cost time: 6.675546884536743
Epoch: 5, Steps: 154 | Train Loss: 1.930 Vali Loss: 2.339 Vali Acc: 0.342 Test Loss: 2.339 Test Acc: 0.342
Validation loss decreased (-0.335743 --> -0.342231).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5547211
	speed: 0.1917s/iter; left time: 2786.1256s
Epoch: 6 cost time: 7.066770315170288
Epoch: 6, Steps: 154 | Train Loss: 1.818 Vali Loss: 2.411 Vali Acc: 0.338 Test Loss: 2.411 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2615098
	speed: 0.1819s/iter; left time: 2615.8184s
Epoch: 7 cost time: 7.127533197402954
Epoch: 7, Steps: 154 | Train Loss: 1.970 Vali Loss: 2.825 Vali Acc: 0.339 Test Loss: 2.825 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.3008385
	speed: 0.1881s/iter; left time: 2674.7165s
Epoch: 8 cost time: 6.962161064147949
Epoch: 8, Steps: 154 | Train Loss: 1.890 Vali Loss: 2.890 Vali Acc: 0.339 Test Loss: 2.890 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.6061887
	speed: 0.1711s/iter; left time: 2406.9427s
Epoch: 9 cost time: 6.806617498397827
Epoch: 9, Steps: 154 | Train Loss: 1.799 Vali Loss: 2.794 Vali Acc: 0.337 Test Loss: 2.794 Test Acc: 0.337
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.4483250
	speed: 0.1632s/iter; left time: 2271.0117s
Epoch: 10 cost time: 6.509759187698364
Epoch: 10, Steps: 154 | Train Loss: 1.699 Vali Loss: 3.141 Vali Acc: 0.347 Test Loss: 3.141 Test Acc: 0.347
Validation loss decreased (-0.342231 --> -0.346684).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4840237
	speed: 0.1627s/iter; left time: 2238.8724s
Epoch: 11 cost time: 6.780590534210205
Epoch: 11, Steps: 154 | Train Loss: 1.773 Vali Loss: 3.251 Vali Acc: 0.356 Test Loss: 3.251 Test Acc: 0.356
Validation loss decreased (-0.346684 --> -0.355604).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3722277
	speed: 0.1688s/iter; left time: 2296.3492s
Epoch: 12 cost time: 6.610657215118408
Epoch: 12, Steps: 154 | Train Loss: 1.932 Vali Loss: 3.687 Vali Acc: 0.357 Test Loss: 3.687 Test Acc: 0.357
Validation loss decreased (-0.355604 --> -0.356816).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1694270
	speed: 0.1647s/iter; left time: 2216.2983s
Epoch: 13 cost time: 6.605616331100464
Epoch: 13, Steps: 154 | Train Loss: 1.826 Vali Loss: 3.628 Vali Acc: 0.358 Test Loss: 3.628 Test Acc: 0.358
Validation loss decreased (-0.356816 --> -0.358439).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3752490
	speed: 0.1670s/iter; left time: 2220.4269s
Epoch: 14 cost time: 6.620003700256348
Epoch: 14, Steps: 154 | Train Loss: 1.883 Vali Loss: 3.288 Vali Acc: 0.354 Test Loss: 3.288 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6497841
	speed: 0.1832s/iter; left time: 2408.6767s
Epoch: 15 cost time: 6.651141881942749
Epoch: 15, Steps: 154 | Train Loss: 1.751 Vali Loss: 3.440 Vali Acc: 0.200 Test Loss: 3.440 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.0495181
	speed: 0.1795s/iter; left time: 2331.2977s
Epoch: 16 cost time: 6.610626697540283
Epoch: 16, Steps: 154 | Train Loss: 1.844 Vali Loss: 3.696 Vali Acc: 0.198 Test Loss: 3.696 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.3372731
	speed: 0.1890s/iter; left time: 2426.1343s
Epoch: 17 cost time: 6.422080755233765
Epoch: 17, Steps: 154 | Train Loss: 1.691 Vali Loss: 4.135 Vali Acc: 0.111 Test Loss: 4.135 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.9537513
	speed: 0.1630s/iter; left time: 2067.4110s
Epoch: 18 cost time: 6.370657205581665
Epoch: 18, Steps: 154 | Train Loss: 1.579 Vali Loss: 4.066 Vali Acc: 0.108 Test Loss: 4.066 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.2146719
	speed: 0.1678s/iter; left time: 2102.3787s
Epoch: 19 cost time: 6.596161842346191
Epoch: 19, Steps: 154 | Train Loss: 1.621 Vali Loss: 4.331 Vali Acc: 0.097 Test Loss: 4.331 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.9711361
	speed: 0.1670s/iter; left time: 2066.8569s
Epoch: 20 cost time: 6.670073986053467
Epoch: 20, Steps: 154 | Train Loss: 1.582 Vali Loss: 4.204 Vali Acc: 0.247 Test Loss: 4.204 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.3475971
	speed: 0.1663s/iter; left time: 2032.8921s
Epoch: 21 cost time: 6.733304023742676
Epoch: 21, Steps: 154 | Train Loss: 1.557 Vali Loss: 4.391 Vali Acc: 0.089 Test Loss: 4.391 Test Acc: 0.089
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.9933901
	speed: 0.1652s/iter; left time: 1993.9406s
Epoch: 22 cost time: 6.82514500617981
Epoch: 22, Steps: 154 | Train Loss: 1.844 Vali Loss: 4.529 Vali Acc: 0.111 Test Loss: 4.529 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.0619813
	speed: 0.1733s/iter; left time: 2064.3455s
Epoch: 23 cost time: 6.730553865432739
Epoch: 23, Steps: 154 | Train Loss: 2.142 Vali Loss: 4.133 Vali Acc: 0.191 Test Loss: 4.133 Test Acc: 0.191
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3584752635847526
model parameter : 934966
model size : 13.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8751260
	speed: 0.0648s/iter; left time: 991.3508s
Epoch: 1 cost time: 8.97003984451294
Epoch: 1, Steps: 154 | Train Loss: 2.306 Vali Loss: 2.227 Vali Acc: 0.325 Test Loss: 2.227 Test Acc: 0.325
Validation loss decreased (inf --> -0.325201).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8155141
	speed: 0.1809s/iter; left time: 2740.4976s
Epoch: 2 cost time: 5.832980632781982
Epoch: 2, Steps: 154 | Train Loss: 2.122 Vali Loss: 2.192 Vali Acc: 0.325 Test Loss: 2.192 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0920398
	speed: 0.1649s/iter; left time: 2472.8440s
Epoch: 3 cost time: 6.56835150718689
Epoch: 3, Steps: 154 | Train Loss: 2.061 Vali Loss: 2.339 Vali Acc: 0.180 Test Loss: 2.339 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.9393501
	speed: 0.1681s/iter; left time: 2495.0761s
Epoch: 4 cost time: 6.642961740493774
Epoch: 4, Steps: 154 | Train Loss: 1.946 Vali Loss: 2.376 Vali Acc: 0.335 Test Loss: 2.376 Test Acc: 0.335
Validation loss decreased (-0.325201 --> -0.334932).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8873053
	speed: 0.1720s/iter; left time: 2525.4340s
Epoch: 5 cost time: 6.310369968414307
Epoch: 5, Steps: 154 | Train Loss: 1.878 Vali Loss: 2.401 Vali Acc: 0.338 Test Loss: 2.401 Test Acc: 0.338
Validation loss decreased (-0.334932 --> -0.338176).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4000810
	speed: 0.1659s/iter; left time: 2410.5618s
Epoch: 6 cost time: 6.619205713272095
Epoch: 6, Steps: 154 | Train Loss: 1.980 Vali Loss: 2.415 Vali Acc: 0.336 Test Loss: 2.415 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4783913
	speed: 0.1633s/iter; left time: 2347.3925s
Epoch: 7 cost time: 6.085492134094238
Epoch: 7, Steps: 154 | Train Loss: 1.977 Vali Loss: 2.984 Vali Acc: 0.338 Test Loss: 2.984 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.2410483
	speed: 0.1811s/iter; left time: 2575.2087s
Epoch: 8 cost time: 6.770958662033081
Epoch: 8, Steps: 154 | Train Loss: 1.915 Vali Loss: 2.919 Vali Acc: 0.342 Test Loss: 2.919 Test Acc: 0.342
Validation loss decreased (-0.338176 --> -0.342225).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5800411
	speed: 0.1866s/iter; left time: 2625.9650s
Epoch: 9 cost time: 6.759920358657837
Epoch: 9, Steps: 154 | Train Loss: 1.804 Vali Loss: 2.749 Vali Acc: 0.345 Test Loss: 2.749 Test Acc: 0.345
Validation loss decreased (-0.342225 --> -0.345066).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3907486
	speed: 0.1846s/iter; left time: 2569.1797s
Epoch: 10 cost time: 6.455336809158325
Epoch: 10, Steps: 154 | Train Loss: 1.772 Vali Loss: 3.006 Vali Acc: 0.345 Test Loss: 3.006 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.6558592
	speed: 0.1608s/iter; left time: 2212.7718s
Epoch: 11 cost time: 6.811241149902344
Epoch: 11, Steps: 154 | Train Loss: 1.700 Vali Loss: 3.277 Vali Acc: 0.342 Test Loss: 3.277 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.3194402
	speed: 0.1663s/iter; left time: 2262.5138s
Epoch: 12 cost time: 6.806833505630493
Epoch: 12, Steps: 154 | Train Loss: 1.608 Vali Loss: 3.252 Vali Acc: 0.358 Test Loss: 3.252 Test Acc: 0.358
Validation loss decreased (-0.345066 --> -0.358443).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2389294
	speed: 0.1711s/iter; left time: 2301.5723s
Epoch: 13 cost time: 6.385120391845703
Epoch: 13, Steps: 154 | Train Loss: 1.905 Vali Loss: 3.266 Vali Acc: 0.357 Test Loss: 3.266 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1646925
	speed: 0.1631s/iter; left time: 2169.0608s
Epoch: 14 cost time: 6.815855026245117
Epoch: 14, Steps: 154 | Train Loss: 1.795 Vali Loss: 3.693 Vali Acc: 0.362 Test Loss: 3.693 Test Acc: 0.362
Validation loss decreased (-0.358443 --> -0.362088).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.5621614
	speed: 0.1652s/iter; left time: 2171.6182s
Epoch: 15 cost time: 6.1674158573150635
Epoch: 15, Steps: 154 | Train Loss: 1.690 Vali Loss: 3.351 Vali Acc: 0.209 Test Loss: 3.351 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.9597284
	speed: 0.1690s/iter; left time: 2195.2393s
Epoch: 16 cost time: 7.3188090324401855
Epoch: 16, Steps: 154 | Train Loss: 1.969 Vali Loss: 3.679 Vali Acc: 0.195 Test Loss: 3.679 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.5400136
	speed: 0.1897s/iter; left time: 2434.7948s
Epoch: 17 cost time: 6.997778415679932
Epoch: 17, Steps: 154 | Train Loss: 1.608 Vali Loss: 3.735 Vali Acc: 0.103 Test Loss: 3.735 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.6524043
	speed: 0.1773s/iter; left time: 2249.1281s
Epoch: 18 cost time: 6.793234348297119
Epoch: 18, Steps: 154 | Train Loss: 1.626 Vali Loss: 3.647 Vali Acc: 0.107 Test Loss: 3.647 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.9144927
	speed: 0.1901s/iter; left time: 2381.6589s
Epoch: 19 cost time: 6.669113397598267
Epoch: 19, Steps: 154 | Train Loss: 1.553 Vali Loss: 4.346 Vali Acc: 0.346 Test Loss: 4.346 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 31.3033504
	speed: 0.1620s/iter; left time: 2004.7411s
Epoch: 20 cost time: 6.93560004234314
Epoch: 20, Steps: 154 | Train Loss: 2.088 Vali Loss: 4.529 Vali Acc: 0.359 Test Loss: 4.529 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.3573654
	speed: 0.1627s/iter; left time: 1988.5521s
Epoch: 21 cost time: 6.410318851470947
Epoch: 21, Steps: 154 | Train Loss: 1.484 Vali Loss: 4.525 Vali Acc: 0.197 Test Loss: 4.525 Test Acc: 0.197
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.3466312
	speed: 0.1617s/iter; left time: 1950.9844s
Epoch: 22 cost time: 6.687553405761719
Epoch: 22, Steps: 154 | Train Loss: 2.094 Vali Loss: 4.103 Vali Acc: 0.362 Test Loss: 4.103 Test Acc: 0.362
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.2178661
	speed: 0.1693s/iter; left time: 2017.3446s
Epoch: 23 cost time: 6.487567901611328
Epoch: 23, Steps: 154 | Train Loss: 1.603 Vali Loss: 4.387 Vali Acc: 0.103 Test Loss: 4.387 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.8915210
	speed: 0.1738s/iter; left time: 2043.6423s
Epoch: 24 cost time: 6.610485792160034
Epoch: 24, Steps: 154 | Train Loss: 1.412 Vali Loss: 4.315 Vali Acc: 0.372 Test Loss: 4.315 Test Acc: 0.372
Validation loss decreased (-0.362088 --> -0.371814).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.5843973
	speed: 0.1844s/iter; left time: 2139.8794s
Epoch: 25 cost time: 6.754681825637817
Epoch: 25, Steps: 154 | Train Loss: 1.741 Vali Loss: 4.736 Vali Acc: 0.207 Test Loss: 4.736 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.4021165
	speed: 0.1818s/iter; left time: 2081.7940s
Epoch: 26 cost time: 6.352301120758057
Epoch: 26, Steps: 154 | Train Loss: 1.912 Vali Loss: 5.009 Vali Acc: 0.086 Test Loss: 5.009 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 7.2404685
	speed: 0.1806s/iter; left time: 2039.8008s
Epoch: 27 cost time: 6.2467639446258545
Epoch: 27, Steps: 154 | Train Loss: 2.653 Vali Loss: 4.790 Vali Acc: 0.354 Test Loss: 4.790 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.7381973
	speed: 0.1691s/iter; left time: 1884.7903s
Epoch: 28 cost time: 7.952815532684326
Epoch: 28, Steps: 154 | Train Loss: 1.930 Vali Loss: 4.585 Vali Acc: 0.342 Test Loss: 4.585 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 1.1260438
	speed: 0.1961s/iter; left time: 2154.7330s
Epoch: 29 cost time: 6.212963819503784
Epoch: 29, Steps: 154 | Train Loss: 1.761 Vali Loss: 5.867 Vali Acc: 0.101 Test Loss: 5.867 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.9856005
	speed: 0.1224s/iter; left time: 1325.6669s
Epoch: 30 cost time: 4.4220311641693115
Epoch: 30, Steps: 154 | Train Loss: 1.594 Vali Loss: 5.522 Vali Acc: 0.129 Test Loss: 5.522 Test Acc: 0.129
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 2.0665383
	speed: 0.1485s/iter; left time: 1585.6868s
Epoch: 31 cost time: 6.436246156692505
Epoch: 31, Steps: 154 | Train Loss: 1.239 Vali Loss: 5.550 Vali Acc: 0.163 Test Loss: 5.550 Test Acc: 0.163
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.4796423
	speed: 0.1615s/iter; left time: 1699.6297s
Epoch: 32 cost time: 6.628870010375977
Epoch: 32, Steps: 154 | Train Loss: 1.281 Vali Loss: 6.394 Vali Acc: 0.365 Test Loss: 6.394 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 1.7063007
	speed: 0.1578s/iter; left time: 1636.7947s
Epoch: 33 cost time: 6.341449975967407
Epoch: 33, Steps: 154 | Train Loss: 1.399 Vali Loss: 5.707 Vali Acc: 0.122 Test Loss: 5.707 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 1.6635301
	speed: 0.1597s/iter; left time: 1631.6060s
Epoch: 34 cost time: 6.643739700317383
Epoch: 34, Steps: 154 | Train Loss: 1.247 Vali Loss: 7.493 Vali Acc: 0.101 Test Loss: 7.493 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3718572587185726
model parameter : 934966
model size : 13.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8750287
	speed: 0.0590s/iter; left time: 903.3366s
Epoch: 1 cost time: 8.153672933578491
Epoch: 1, Steps: 154 | Train Loss: 2.269 Vali Loss: 2.215 Vali Acc: 0.323 Test Loss: 2.215 Test Acc: 0.323
Validation loss decreased (inf --> -0.323173).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8999002
	speed: 0.1852s/iter; left time: 2804.7291s
Epoch: 2 cost time: 6.625139951705933
Epoch: 2, Steps: 154 | Train Loss: 2.116 Vali Loss: 2.275 Vali Acc: 0.324 Test Loss: 2.275 Test Acc: 0.324
Validation loss decreased (-0.323173 --> -0.324389).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1961131
	speed: 0.1818s/iter; left time: 2725.5294s
Epoch: 3 cost time: 6.462506055831909
Epoch: 3, Steps: 154 | Train Loss: 2.096 Vali Loss: 2.304 Vali Acc: 0.169 Test Loss: 2.304 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8990644
	speed: 0.1835s/iter; left time: 2723.2130s
Epoch: 4 cost time: 6.5777587890625
Epoch: 4, Steps: 154 | Train Loss: 1.946 Vali Loss: 2.360 Vali Acc: 0.333 Test Loss: 2.360 Test Acc: 0.333
Validation loss decreased (-0.324389 --> -0.332904).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8956025
	speed: 0.1557s/iter; left time: 2286.4858s
Epoch: 5 cost time: 6.40951943397522
Epoch: 5, Steps: 154 | Train Loss: 1.905 Vali Loss: 2.389 Vali Acc: 0.344 Test Loss: 2.389 Test Acc: 0.344
Validation loss decreased (-0.332904 --> -0.344258).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3985246
	speed: 0.1615s/iter; left time: 2346.1839s
Epoch: 6 cost time: 6.032883644104004
Epoch: 6, Steps: 154 | Train Loss: 1.843 Vali Loss: 2.391 Vali Acc: 0.345 Test Loss: 2.391 Test Acc: 0.345
Validation loss decreased (-0.344258 --> -0.344664).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3779778
	speed: 0.1588s/iter; left time: 2282.6792s
Epoch: 7 cost time: 6.501512765884399
Epoch: 7, Steps: 154 | Train Loss: 1.893 Vali Loss: 2.888 Vali Acc: 0.341 Test Loss: 2.888 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2670369
	speed: 0.1562s/iter; left time: 2222.3408s
Epoch: 8 cost time: 6.138027906417847
Epoch: 8, Steps: 154 | Train Loss: 1.732 Vali Loss: 2.970 Vali Acc: 0.344 Test Loss: 2.970 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.6366271
	speed: 0.1695s/iter; left time: 2385.1984s
Epoch: 9 cost time: 6.165213584899902
Epoch: 9, Steps: 154 | Train Loss: 1.970 Vali Loss: 2.977 Vali Acc: 0.341 Test Loss: 2.977 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4783678
	speed: 0.1812s/iter; left time: 2521.5845s
Epoch: 10 cost time: 6.856006860733032
Epoch: 10, Steps: 154 | Train Loss: 1.784 Vali Loss: 3.133 Vali Acc: 0.347 Test Loss: 3.133 Test Acc: 0.347
Validation loss decreased (-0.344664 --> -0.346684).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4745686
	speed: 0.1834s/iter; left time: 2524.1682s
Epoch: 11 cost time: 6.594428062438965
Epoch: 11, Steps: 154 | Train Loss: 1.669 Vali Loss: 3.568 Vali Acc: 0.069 Test Loss: 3.568 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3497776
	speed: 0.1782s/iter; left time: 2425.0889s
Epoch: 12 cost time: 7.0075719356536865
Epoch: 12, Steps: 154 | Train Loss: 1.721 Vali Loss: 3.456 Vali Acc: 0.359 Test Loss: 3.456 Test Acc: 0.359
Validation loss decreased (-0.346684 --> -0.358846).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3341476
	speed: 0.1702s/iter; left time: 2289.7452s
Epoch: 13 cost time: 6.7981202602386475
Epoch: 13, Steps: 154 | Train Loss: 1.733 Vali Loss: 3.771 Vali Acc: 0.350 Test Loss: 3.771 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.9199885
	speed: 0.1629s/iter; left time: 2166.1049s
Epoch: 14 cost time: 6.364558696746826
Epoch: 14, Steps: 154 | Train Loss: 1.823 Vali Loss: 4.062 Vali Acc: 0.083 Test Loss: 4.062 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.4484664
	speed: 0.1593s/iter; left time: 2093.4946s
Epoch: 15 cost time: 6.546285629272461
Epoch: 15, Steps: 154 | Train Loss: 1.587 Vali Loss: 3.813 Vali Acc: 0.200 Test Loss: 3.813 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.2332664
	speed: 0.1632s/iter; left time: 2119.7158s
Epoch: 16 cost time: 6.166548490524292
Epoch: 16, Steps: 154 | Train Loss: 1.663 Vali Loss: 3.612 Vali Acc: 0.223 Test Loss: 3.612 Test Acc: 0.223
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 2.0720303
	speed: 0.1670s/iter; left time: 2144.0304s
Epoch: 17 cost time: 6.451927185058594
Epoch: 17, Steps: 154 | Train Loss: 1.491 Vali Loss: 4.041 Vali Acc: 0.343 Test Loss: 4.041 Test Acc: 0.343
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.5258224
	speed: 0.1739s/iter; left time: 2205.1100s
Epoch: 18 cost time: 6.552824258804321
Epoch: 18, Steps: 154 | Train Loss: 1.992 Vali Loss: 3.819 Vali Acc: 0.365 Test Loss: 3.819 Test Acc: 0.365
Validation loss decreased (-0.358846 --> -0.365331).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.2564803
	speed: 0.1817s/iter; left time: 2276.6783s
Epoch: 19 cost time: 5.963994741439819
Epoch: 19, Steps: 154 | Train Loss: 1.807 Vali Loss: 4.459 Vali Acc: 0.358 Test Loss: 4.459 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.2141517
	speed: 0.1742s/iter; left time: 2155.6418s
Epoch: 20 cost time: 6.606889486312866
Epoch: 20, Steps: 154 | Train Loss: 1.663 Vali Loss: 4.132 Vali Acc: 0.336 Test Loss: 4.132 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.6024768
	speed: 0.1767s/iter; left time: 2159.2516s
Epoch: 21 cost time: 6.34014368057251
Epoch: 21, Steps: 154 | Train Loss: 1.465 Vali Loss: 4.080 Vali Acc: 0.376 Test Loss: 4.080 Test Acc: 0.376
Validation loss decreased (-0.365331 --> -0.375466).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.1595494
	speed: 0.1660s/iter; left time: 2003.2400s
Epoch: 22 cost time: 6.371282339096069
Epoch: 22, Steps: 154 | Train Loss: 2.015 Vali Loss: 4.635 Vali Acc: 0.294 Test Loss: 4.635 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.4972051
	speed: 0.1660s/iter; left time: 1977.3338s
Epoch: 23 cost time: 6.414204835891724
Epoch: 23, Steps: 154 | Train Loss: 1.863 Vali Loss: 5.058 Vali Acc: 0.109 Test Loss: 5.058 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.8257996
	speed: 0.1638s/iter; left time: 1926.2272s
Epoch: 24 cost time: 6.346719741821289
Epoch: 24, Steps: 154 | Train Loss: 1.497 Vali Loss: 5.090 Vali Acc: 0.234 Test Loss: 5.090 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.2140448
	speed: 0.1662s/iter; left time: 1928.8917s
Epoch: 25 cost time: 6.7780468463897705
Epoch: 25, Steps: 154 | Train Loss: 1.526 Vali Loss: 4.759 Vali Acc: 0.203 Test Loss: 4.759 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.9641819
	speed: 0.1613s/iter; left time: 1847.3471s
Epoch: 26 cost time: 6.583940505981445
Epoch: 26, Steps: 154 | Train Loss: 2.227 Vali Loss: 5.181 Vali Acc: 0.079 Test Loss: 5.181 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.9879010
	speed: 0.1796s/iter; left time: 2028.4546s
Epoch: 27 cost time: 6.739046096801758
Epoch: 27, Steps: 154 | Train Loss: 1.427 Vali Loss: 5.647 Vali Acc: 0.097 Test Loss: 5.647 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.1986433
	speed: 0.1761s/iter; left time: 1962.6058s
Epoch: 28 cost time: 6.798078775405884
Epoch: 28, Steps: 154 | Train Loss: 1.503 Vali Loss: 5.213 Vali Acc: 0.395 Test Loss: 5.213 Test Acc: 0.395
Validation loss decreased (-0.375466 --> -0.395325).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.6921400
	speed: 0.1846s/iter; left time: 2028.1417s
Epoch: 29 cost time: 6.186858415603638
Epoch: 29, Steps: 154 | Train Loss: 1.291 Vali Loss: 5.184 Vali Acc: 0.185 Test Loss: 5.184 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.1201475
	speed: 0.1635s/iter; left time: 1771.5267s
Epoch: 30 cost time: 6.249917268753052
Epoch: 30, Steps: 154 | Train Loss: 1.232 Vali Loss: 5.387 Vali Acc: 0.163 Test Loss: 5.387 Test Acc: 0.163
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.5475905
	speed: 0.1650s/iter; left time: 1761.8985s
Epoch: 31 cost time: 6.445265531539917
Epoch: 31, Steps: 154 | Train Loss: 1.165 Vali Loss: 5.660 Vali Acc: 0.259 Test Loss: 5.660 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.3959066
	speed: 0.1634s/iter; left time: 1719.9824s
Epoch: 32 cost time: 6.012124538421631
Epoch: 32, Steps: 154 | Train Loss: 1.214 Vali Loss: 5.744 Vali Acc: 0.324 Test Loss: 5.744 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.9923146
	speed: 0.1585s/iter; left time: 1643.9513s
Epoch: 33 cost time: 6.456258535385132
Epoch: 33, Steps: 154 | Train Loss: 1.301 Vali Loss: 7.345 Vali Acc: 0.205 Test Loss: 7.345 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 1.5824528
	speed: 0.1614s/iter; left time: 1649.2729s
Epoch: 34 cost time: 6.121900320053101
Epoch: 34, Steps: 154 | Train Loss: 1.362 Vali Loss: 6.769 Vali Acc: 0.210 Test Loss: 6.769 Test Acc: 0.210
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 1.0649184
	speed: 0.1778s/iter; left time: 1789.9431s
Epoch: 35 cost time: 6.733920574188232
Epoch: 35, Steps: 154 | Train Loss: 1.724 Vali Loss: 7.364 Vali Acc: 0.085 Test Loss: 7.364 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 1.3769821
	speed: 0.1787s/iter; left time: 1770.6127s
Epoch: 36 cost time: 6.412761449813843
Epoch: 36, Steps: 154 | Train Loss: 2.123 Vali Loss: 8.138 Vali Acc: 0.102 Test Loss: 8.138 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 1.1280221
	speed: 0.1865s/iter; left time: 1820.1133s
Epoch: 37 cost time: 6.478530645370483
Epoch: 37, Steps: 154 | Train Loss: 1.747 Vali Loss: 8.260 Vali Acc: 0.240 Test Loss: 8.260 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.7645498
	speed: 0.1622s/iter; left time: 1557.6170s
Epoch: 38 cost time: 6.4445459842681885
Epoch: 38, Steps: 154 | Train Loss: 1.420 Vali Loss: 8.063 Vali Acc: 0.094 Test Loss: 8.063 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3953771289537713
model parameter : 934966
model size : 13.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8465921
	speed: 0.0548s/iter; left time: 838.0936s
Epoch: 1 cost time: 7.480847358703613
Epoch: 1, Steps: 154 | Train Loss: 2.256 Vali Loss: 2.241 Vali Acc: 0.325 Test Loss: 2.241 Test Acc: 0.325
Validation loss decreased (inf --> -0.325201).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8064036
	speed: 0.1471s/iter; left time: 2227.8566s
Epoch: 2 cost time: 5.58208703994751
Epoch: 2, Steps: 154 | Train Loss: 2.155 Vali Loss: 2.232 Vali Acc: 0.325 Test Loss: 2.232 Test Acc: 0.325
Validation loss decreased (-0.325201 --> -0.325201).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8863153
	speed: 0.1611s/iter; left time: 2415.6112s
Epoch: 3 cost time: 6.66616415977478
Epoch: 3, Steps: 154 | Train Loss: 2.004 Vali Loss: 2.290 Vali Acc: 0.330 Test Loss: 2.290 Test Acc: 0.330
Validation loss decreased (-0.325201 --> -0.330472).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8592068
	speed: 0.1801s/iter; left time: 2673.0353s
Epoch: 4 cost time: 7.430095911026001
Epoch: 4, Steps: 154 | Train Loss: 2.002 Vali Loss: 2.326 Vali Acc: 0.333 Test Loss: 2.326 Test Acc: 0.333
Validation loss decreased (-0.330472 --> -0.333310).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8501835
	speed: 0.1896s/iter; left time: 2783.8393s
Epoch: 5 cost time: 6.31186842918396
Epoch: 5, Steps: 154 | Train Loss: 1.952 Vali Loss: 2.365 Vali Acc: 0.342 Test Loss: 2.365 Test Acc: 0.342
Validation loss decreased (-0.333310 --> -0.341825).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5363106
	speed: 0.1934s/iter; left time: 2809.6932s
Epoch: 6 cost time: 7.03130030632019
Epoch: 6, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.451 Vali Acc: 0.339 Test Loss: 2.451 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8483341
	speed: 0.1828s/iter; left time: 2628.5830s
Epoch: 7 cost time: 6.151137113571167
Epoch: 7, Steps: 154 | Train Loss: 1.872 Vali Loss: 2.750 Vali Acc: 0.339 Test Loss: 2.750 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.2787557
	speed: 0.1644s/iter; left time: 2338.8088s
Epoch: 8 cost time: 6.723828554153442
Epoch: 8, Steps: 154 | Train Loss: 1.882 Vali Loss: 2.995 Vali Acc: 0.345 Test Loss: 2.995 Test Acc: 0.345
Validation loss decreased (-0.341825 --> -0.344658).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6696705
	speed: 0.1675s/iter; left time: 2356.1428s
Epoch: 9 cost time: 6.721310377120972
Epoch: 9, Steps: 154 | Train Loss: 2.134 Vali Loss: 2.786 Vali Acc: 0.346 Test Loss: 2.786 Test Acc: 0.346
Validation loss decreased (-0.344658 --> -0.345876).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9097898
	speed: 0.1671s/iter; left time: 2325.4185s
Epoch: 10 cost time: 6.469712018966675
Epoch: 10, Steps: 154 | Train Loss: 2.031 Vali Loss: 2.788 Vali Acc: 0.364 Test Loss: 2.788 Test Acc: 0.364
Validation loss decreased (-0.345876 --> -0.364125).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3163145
	speed: 0.1701s/iter; left time: 2341.3776s
Epoch: 11 cost time: 6.572236061096191
Epoch: 11, Steps: 154 | Train Loss: 1.798 Vali Loss: 3.299 Vali Acc: 0.352 Test Loss: 3.299 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4359021
	speed: 0.1728s/iter; left time: 2350.9811s
Epoch: 12 cost time: 6.704811334609985
Epoch: 12, Steps: 154 | Train Loss: 1.701 Vali Loss: 3.193 Vali Acc: 0.363 Test Loss: 3.193 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.1578103
	speed: 0.1836s/iter; left time: 2469.5770s
Epoch: 13 cost time: 6.938817739486694
Epoch: 13, Steps: 154 | Train Loss: 1.646 Vali Loss: 3.718 Vali Acc: 0.353 Test Loss: 3.718 Test Acc: 0.353
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.1158646
	speed: 0.1893s/iter; left time: 2517.1942s
Epoch: 14 cost time: 7.381453514099121
Epoch: 14, Steps: 154 | Train Loss: 1.869 Vali Loss: 2.791 Vali Acc: 0.371 Test Loss: 2.791 Test Acc: 0.371
Validation loss decreased (-0.364125 --> -0.371018).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4717504
	speed: 0.1817s/iter; left time: 2388.0533s
Epoch: 15 cost time: 6.064566135406494
Epoch: 15, Steps: 154 | Train Loss: 1.772 Vali Loss: 3.737 Vali Acc: 0.207 Test Loss: 3.737 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.8605359
	speed: 0.1655s/iter; left time: 2150.1497s
Epoch: 16 cost time: 7.105778455734253
Epoch: 16, Steps: 154 | Train Loss: 1.679 Vali Loss: 4.056 Vali Acc: 0.344 Test Loss: 4.056 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 2.1697493
	speed: 0.1701s/iter; left time: 2184.0708s
Epoch: 17 cost time: 6.765954256057739
Epoch: 17, Steps: 154 | Train Loss: 1.593 Vali Loss: 3.558 Vali Acc: 0.104 Test Loss: 3.558 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.3704940
	speed: 0.1692s/iter; left time: 2146.2322s
Epoch: 18 cost time: 6.725980043411255
Epoch: 18, Steps: 154 | Train Loss: 1.537 Vali Loss: 3.184 Vali Acc: 0.379 Test Loss: 3.184 Test Acc: 0.379
Validation loss decreased (-0.371018 --> -0.378719).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.5579956
	speed: 0.1708s/iter; left time: 2139.7301s
Epoch: 19 cost time: 6.761174201965332
Epoch: 19, Steps: 154 | Train Loss: 1.457 Vali Loss: 4.180 Vali Acc: 0.214 Test Loss: 4.180 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.7170566
	speed: 0.1739s/iter; left time: 2152.1060s
Epoch: 20 cost time: 6.214407205581665
Epoch: 20, Steps: 154 | Train Loss: 1.764 Vali Loss: 4.797 Vali Acc: 0.329 Test Loss: 4.797 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.5975044
	speed: 0.1770s/iter; left time: 2163.1131s
Epoch: 21 cost time: 6.851502418518066
Epoch: 21, Steps: 154 | Train Loss: 1.808 Vali Loss: 4.478 Vali Acc: 0.323 Test Loss: 4.478 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.1265678
	speed: 0.1826s/iter; left time: 2203.7991s
Epoch: 22 cost time: 6.870686054229736
Epoch: 22, Steps: 154 | Train Loss: 1.935 Vali Loss: 5.577 Vali Acc: 0.330 Test Loss: 5.577 Test Acc: 0.330
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.7555848
	speed: 0.1938s/iter; left time: 2308.6990s
Epoch: 23 cost time: 9.041753768920898
Epoch: 23, Steps: 154 | Train Loss: 1.759 Vali Loss: 3.759 Vali Acc: 0.196 Test Loss: 3.759 Test Acc: 0.196
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.4951237
	speed: 0.2106s/iter; left time: 2476.5882s
Epoch: 24 cost time: 8.029896020889282
Epoch: 24, Steps: 154 | Train Loss: 1.580 Vali Loss: 4.560 Vali Acc: 0.122 Test Loss: 4.560 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.8742352
	speed: 0.2091s/iter; left time: 2426.5818s
Epoch: 25 cost time: 8.5121431350708
Epoch: 25, Steps: 154 | Train Loss: 1.321 Vali Loss: 4.344 Vali Acc: 0.370 Test Loss: 4.344 Test Acc: 0.370
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.1623261
	speed: 0.1959s/iter; left time: 2242.8097s
Epoch: 26 cost time: 7.815594911575317
Epoch: 26, Steps: 154 | Train Loss: 1.457 Vali Loss: 4.442 Vali Acc: 0.167 Test Loss: 4.442 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.9405120
	speed: 0.2054s/iter; left time: 2320.0859s
Epoch: 27 cost time: 8.31821322441101
Epoch: 27, Steps: 154 | Train Loss: 2.001 Vali Loss: 7.238 Vali Acc: 0.126 Test Loss: 7.238 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.1461179
	speed: 0.2089s/iter; left time: 2327.5137s
Epoch: 28 cost time: 9.014078378677368
Epoch: 28, Steps: 154 | Train Loss: 1.539 Vali Loss: 5.354 Vali Acc: 0.363 Test Loss: 5.354 Test Acc: 0.363
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37875101378751014
model parameter : 934966
model size : 13.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0630310
	speed: 0.0793s/iter; left time: 1213.0224s
Epoch: 1 cost time: 10.975383520126343
Epoch: 1, Steps: 154 | Train Loss: 2.297 Vali Loss: 2.223 Vali Acc: 0.328 Test Loss: 2.223 Test Acc: 0.328
Validation loss decreased (inf --> -0.327634).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7502377
	speed: 0.2222s/iter; left time: 3364.9396s
Epoch: 2 cost time: 8.251549005508423
Epoch: 2, Steps: 154 | Train Loss: 2.165 Vali Loss: 2.278 Vali Acc: 0.325 Test Loss: 2.278 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9747833
	speed: 0.2191s/iter; left time: 3284.4628s
Epoch: 3 cost time: 7.9379966259002686
Epoch: 3, Steps: 154 | Train Loss: 2.160 Vali Loss: 2.312 Vali Acc: 0.328 Test Loss: 2.312 Test Acc: 0.328
Validation loss decreased (-0.327634 --> -0.328444).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9057139
	speed: 0.2165s/iter; left time: 3212.5592s
Epoch: 4 cost time: 8.76388669013977
Epoch: 4, Steps: 154 | Train Loss: 1.955 Vali Loss: 2.386 Vali Acc: 0.330 Test Loss: 2.386 Test Acc: 0.330
Validation loss decreased (-0.328444 --> -0.330065).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5182781
	speed: 0.1979s/iter; left time: 2906.3597s
Epoch: 5 cost time: 7.60961127281189
Epoch: 5, Steps: 154 | Train Loss: 1.859 Vali Loss: 2.430 Vali Acc: 0.179 Test Loss: 2.430 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6812018
	speed: 0.2072s/iter; left time: 3010.9466s
Epoch: 6 cost time: 8.805655002593994
Epoch: 6, Steps: 154 | Train Loss: 1.940 Vali Loss: 2.727 Vali Acc: 0.331 Test Loss: 2.727 Test Acc: 0.331
Validation loss decreased (-0.330065 --> -0.331278).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9922982
	speed: 0.2168s/iter; left time: 3117.5294s
Epoch: 7 cost time: 8.179413795471191
Epoch: 7, Steps: 154 | Train Loss: 1.809 Vali Loss: 2.854 Vali Acc: 0.338 Test Loss: 2.854 Test Acc: 0.338
Validation loss decreased (-0.331278 --> -0.337765).  Saving model ...
	iters: 100, epoch: 8 | loss: 10.6946268
	speed: 0.2032s/iter; left time: 2889.9331s
Epoch: 8 cost time: 7.647116661071777
Epoch: 8, Steps: 154 | Train Loss: 2.019 Vali Loss: 2.825 Vali Acc: 0.191 Test Loss: 2.825 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5665088
	speed: 0.2054s/iter; left time: 2890.2137s
Epoch: 9 cost time: 9.049298763275146
Epoch: 9, Steps: 154 | Train Loss: 1.790 Vali Loss: 2.769 Vali Acc: 0.164 Test Loss: 2.769 Test Acc: 0.164
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.5540411
	speed: 0.2158s/iter; left time: 3003.0379s
Epoch: 10 cost time: 8.461356401443481
Epoch: 10, Steps: 154 | Train Loss: 1.923 Vali Loss: 3.050 Vali Acc: 0.353 Test Loss: 3.050 Test Acc: 0.353
Validation loss decreased (-0.337765 --> -0.352768).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9749583
	speed: 0.2267s/iter; left time: 3119.9094s
Epoch: 11 cost time: 8.11779236793518
Epoch: 11, Steps: 154 | Train Loss: 1.835 Vali Loss: 3.071 Vali Acc: 0.369 Test Loss: 3.071 Test Acc: 0.369
Validation loss decreased (-0.352768 --> -0.368582).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4973279
	speed: 0.2187s/iter; left time: 2975.4711s
Epoch: 12 cost time: 8.557299613952637
Epoch: 12, Steps: 154 | Train Loss: 1.672 Vali Loss: 3.594 Vali Acc: 0.090 Test Loss: 3.594 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.3624872
	speed: 0.2267s/iter; left time: 3049.6811s
Epoch: 13 cost time: 8.243263244628906
Epoch: 13, Steps: 154 | Train Loss: 1.687 Vali Loss: 3.211 Vali Acc: 0.355 Test Loss: 3.211 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.5312405
	speed: 0.2069s/iter; left time: 2751.8122s
Epoch: 14 cost time: 8.962072372436523
Epoch: 14, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.991 Vali Acc: 0.354 Test Loss: 2.991 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.2557001
	speed: 0.2073s/iter; left time: 2724.8497s
Epoch: 15 cost time: 8.482105493545532
Epoch: 15, Steps: 154 | Train Loss: 1.699 Vali Loss: 3.597 Vali Acc: 0.356 Test Loss: 3.597 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.4275609
	speed: 0.2100s/iter; left time: 2727.5484s
Epoch: 16 cost time: 8.310441493988037
Epoch: 16, Steps: 154 | Train Loss: 2.378 Vali Loss: 3.463 Vali Acc: 0.354 Test Loss: 3.463 Test Acc: 0.354
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.0176529
	speed: 0.2086s/iter; left time: 2677.7632s
Epoch: 17 cost time: 8.657989025115967
Epoch: 17, Steps: 154 | Train Loss: 1.569 Vali Loss: 3.647 Vali Acc: 0.359 Test Loss: 3.647 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.7219180
	speed: 0.2163s/iter; left time: 2743.4397s
Epoch: 18 cost time: 8.50922417640686
Epoch: 18, Steps: 154 | Train Loss: 1.898 Vali Loss: 4.053 Vali Acc: 0.137 Test Loss: 4.053 Test Acc: 0.137
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.9233744
	speed: 0.2059s/iter; left time: 2579.7587s
Epoch: 19 cost time: 8.97296404838562
Epoch: 19, Steps: 154 | Train Loss: 1.838 Vali Loss: 4.172 Vali Acc: 0.367 Test Loss: 4.172 Test Acc: 0.367
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.4673011
	speed: 0.2228s/iter; left time: 2757.6070s
Epoch: 20 cost time: 8.711264848709106
Epoch: 20, Steps: 154 | Train Loss: 1.594 Vali Loss: 3.970 Vali Acc: 0.126 Test Loss: 3.970 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 2.2415729
	speed: 0.2240s/iter; left time: 2737.5430s
Epoch: 21 cost time: 8.45988416671753
Epoch: 21, Steps: 154 | Train Loss: 1.542 Vali Loss: 3.734 Vali Acc: 0.355 Test Loss: 3.734 Test Acc: 0.355
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3686131386861314
model parameter : 869430
model size : 13.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0416577
	speed: 0.0721s/iter; left time: 1103.1013s
Epoch: 1 cost time: 10.090631008148193
Epoch: 1, Steps: 154 | Train Loss: 2.282 Vali Loss: 2.225 Vali Acc: 0.329 Test Loss: 2.225 Test Acc: 0.329
Validation loss decreased (inf --> -0.328850).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7465425
	speed: 0.2075s/iter; left time: 3142.4485s
Epoch: 2 cost time: 8.690685272216797
Epoch: 2, Steps: 154 | Train Loss: 2.090 Vali Loss: 2.257 Vali Acc: 0.332 Test Loss: 2.257 Test Acc: 0.332
Validation loss decreased (-0.328850 --> -0.331689).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9899818
	speed: 0.1983s/iter; left time: 2972.9533s
Epoch: 3 cost time: 7.709709405899048
Epoch: 3, Steps: 154 | Train Loss: 2.145 Vali Loss: 2.251 Vali Acc: 0.329 Test Loss: 2.251 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1557295
	speed: 0.2066s/iter; left time: 3066.2007s
Epoch: 4 cost time: 8.518363952636719
Epoch: 4, Steps: 154 | Train Loss: 1.968 Vali Loss: 2.349 Vali Acc: 0.333 Test Loss: 2.349 Test Acc: 0.333
Validation loss decreased (-0.331689 --> -0.333310).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6076579
	speed: 0.1996s/iter; left time: 2931.3754s
Epoch: 5 cost time: 8.09937071800232
Epoch: 5, Steps: 154 | Train Loss: 1.925 Vali Loss: 2.430 Vali Acc: 0.182 Test Loss: 2.430 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2147037
	speed: 0.2033s/iter; left time: 2953.8916s
Epoch: 6 cost time: 8.227036237716675
Epoch: 6, Steps: 154 | Train Loss: 1.935 Vali Loss: 2.800 Vali Acc: 0.330 Test Loss: 2.800 Test Acc: 0.330
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.9722630
	speed: 0.2212s/iter; left time: 3180.3523s
Epoch: 7 cost time: 9.807072877883911
Epoch: 7, Steps: 154 | Train Loss: 1.854 Vali Loss: 2.930 Vali Acc: 0.335 Test Loss: 2.930 Test Acc: 0.335
Validation loss decreased (-0.333310 --> -0.335332).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1480060
	speed: 0.2166s/iter; left time: 3080.8041s
Epoch: 8 cost time: 7.4987335205078125
Epoch: 8, Steps: 154 | Train Loss: 1.876 Vali Loss: 2.743 Vali Acc: 0.187 Test Loss: 2.743 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7474167
	speed: 0.2240s/iter; left time: 3150.9044s
Epoch: 9 cost time: 9.499126672744751
Epoch: 9, Steps: 154 | Train Loss: 1.732 Vali Loss: 2.719 Vali Acc: 0.354 Test Loss: 2.719 Test Acc: 0.354
Validation loss decreased (-0.335332 --> -0.353582).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6340075
	speed: 0.2217s/iter; left time: 3084.5775s
Epoch: 10 cost time: 9.555025815963745
Epoch: 10, Steps: 154 | Train Loss: 1.724 Vali Loss: 2.913 Vali Acc: 0.348 Test Loss: 2.913 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.2412357
	speed: 0.2378s/iter; left time: 3272.8089s
Epoch: 11 cost time: 7.917563199996948
Epoch: 11, Steps: 154 | Train Loss: 1.682 Vali Loss: 3.169 Vali Acc: 0.115 Test Loss: 3.169 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.5520595
	speed: 0.1628s/iter; left time: 2215.3100s
Epoch: 12 cost time: 6.930943489074707
Epoch: 12, Steps: 154 | Train Loss: 2.061 Vali Loss: 3.357 Vali Acc: 0.088 Test Loss: 3.357 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.4614081
	speed: 0.1974s/iter; left time: 2655.2412s
Epoch: 13 cost time: 8.016220569610596
Epoch: 13, Steps: 154 | Train Loss: 1.730 Vali Loss: 3.011 Vali Acc: 0.356 Test Loss: 3.011 Test Acc: 0.356
Validation loss decreased (-0.353582 --> -0.356418).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6515559
	speed: 0.2043s/iter; left time: 2717.1972s
Epoch: 14 cost time: 8.2493257522583
Epoch: 14, Steps: 154 | Train Loss: 1.954 Vali Loss: 3.127 Vali Acc: 0.354 Test Loss: 3.127 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.0068531
	speed: 0.1835s/iter; left time: 2411.7752s
Epoch: 15 cost time: 6.867394924163818
Epoch: 15, Steps: 154 | Train Loss: 1.718 Vali Loss: 3.689 Vali Acc: 0.352 Test Loss: 3.689 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.3365126
	speed: 0.2020s/iter; left time: 2624.7701s
Epoch: 16 cost time: 8.078505039215088
Epoch: 16, Steps: 154 | Train Loss: 1.658 Vali Loss: 3.888 Vali Acc: 0.354 Test Loss: 3.888 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.8493939
	speed: 0.2014s/iter; left time: 2585.5178s
Epoch: 17 cost time: 8.458703756332397
Epoch: 17, Steps: 154 | Train Loss: 1.895 Vali Loss: 3.592 Vali Acc: 0.365 Test Loss: 3.592 Test Acc: 0.365
Validation loss decreased (-0.356418 --> -0.364522).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.5427729
	speed: 0.2050s/iter; left time: 2600.5568s
Epoch: 18 cost time: 8.149118661880493
Epoch: 18, Steps: 154 | Train Loss: 1.635 Vali Loss: 3.729 Vali Acc: 0.369 Test Loss: 3.729 Test Acc: 0.369
Validation loss decreased (-0.364522 --> -0.369387).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.0398892
	speed: 0.2318s/iter; left time: 2904.0645s
Epoch: 19 cost time: 9.22876524925232
Epoch: 19, Steps: 154 | Train Loss: 1.660 Vali Loss: 3.898 Vali Acc: 0.359 Test Loss: 3.898 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.7200412
	speed: 0.2147s/iter; left time: 2657.2600s
Epoch: 20 cost time: 8.252500772476196
Epoch: 20, Steps: 154 | Train Loss: 1.630 Vali Loss: 4.521 Vali Acc: 0.136 Test Loss: 4.521 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 2.4227319
	speed: 0.2221s/iter; left time: 2714.4079s
Epoch: 21 cost time: 8.021172761917114
Epoch: 21, Steps: 154 | Train Loss: 1.615 Vali Loss: 3.812 Vali Acc: 0.366 Test Loss: 3.812 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.3974206
	speed: 0.2045s/iter; left time: 2467.8794s
Epoch: 22 cost time: 8.705710649490356
Epoch: 22, Steps: 154 | Train Loss: 1.874 Vali Loss: 4.273 Vali Acc: 0.355 Test Loss: 4.273 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.8184265
	speed: 0.2030s/iter; left time: 2418.6546s
Epoch: 23 cost time: 7.907020568847656
Epoch: 23, Steps: 154 | Train Loss: 1.805 Vali Loss: 4.036 Vali Acc: 0.212 Test Loss: 4.036 Test Acc: 0.212
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.2329378
	speed: 0.2050s/iter; left time: 2410.4914s
Epoch: 24 cost time: 8.797730207443237
Epoch: 24, Steps: 154 | Train Loss: 1.765 Vali Loss: 4.889 Vali Acc: 0.378 Test Loss: 4.889 Test Acc: 0.378
Validation loss decreased (-0.369387 --> -0.377486).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.9930097
	speed: 0.2044s/iter; left time: 2372.0187s
Epoch: 25 cost time: 7.921443939208984
Epoch: 25, Steps: 154 | Train Loss: 2.122 Vali Loss: 4.308 Vali Acc: 0.226 Test Loss: 4.308 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.6588140
	speed: 0.1979s/iter; left time: 2266.2049s
Epoch: 26 cost time: 7.7964746952056885
Epoch: 26, Steps: 154 | Train Loss: 1.490 Vali Loss: 4.567 Vali Acc: 0.119 Test Loss: 4.567 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.7901525
	speed: 0.2052s/iter; left time: 2318.6000s
Epoch: 27 cost time: 8.873158693313599
Epoch: 27, Steps: 154 | Train Loss: 1.454 Vali Loss: 4.273 Vali Acc: 0.368 Test Loss: 4.273 Test Acc: 0.368
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 9.3444271
	speed: 0.2184s/iter; left time: 2433.4352s
Epoch: 28 cost time: 7.532253980636597
Epoch: 28, Steps: 154 | Train Loss: 1.355 Vali Loss: 5.776 Vali Acc: 0.370 Test Loss: 5.776 Test Acc: 0.370
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 2.0087950
	speed: 0.2207s/iter; left time: 2425.6483s
Epoch: 29 cost time: 9.372512102127075
Epoch: 29, Steps: 154 | Train Loss: 1.468 Vali Loss: 4.777 Vali Acc: 0.119 Test Loss: 4.777 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 1.1563257
	speed: 0.2217s/iter; left time: 2402.3661s
Epoch: 30 cost time: 8.47211241722107
Epoch: 30, Steps: 154 | Train Loss: 1.239 Vali Loss: 5.739 Vali Acc: 0.360 Test Loss: 5.739 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 1.4409583
	speed: 0.1995s/iter; left time: 2130.6565s
Epoch: 31 cost time: 7.665207386016846
Epoch: 31, Steps: 154 | Train Loss: 1.442 Vali Loss: 6.348 Vali Acc: 0.117 Test Loss: 6.348 Test Acc: 0.117
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 6.7844930
	speed: 0.2001s/iter; left time: 2106.8274s
Epoch: 32 cost time: 8.400906562805176
Epoch: 32, Steps: 154 | Train Loss: 1.571 Vali Loss: 4.660 Vali Acc: 0.288 Test Loss: 4.660 Test Acc: 0.288
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 1.3958549
	speed: 0.2060s/iter; left time: 2136.7353s
Epoch: 33 cost time: 7.66614556312561
Epoch: 33, Steps: 154 | Train Loss: 2.375 Vali Loss: 5.326 Vali Acc: 0.113 Test Loss: 5.326 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 1.4572703
	speed: 0.1989s/iter; left time: 2032.5712s
Epoch: 34 cost time: 8.682413816452026
Epoch: 34, Steps: 154 | Train Loss: 1.414 Vali Loss: 5.438 Vali Acc: 0.359 Test Loss: 5.438 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3775344687753447
model parameter : 869430
model size : 13.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0444739
	speed: 0.0743s/iter; left time: 1137.4215s
Epoch: 1 cost time: 10.200645685195923
Epoch: 1, Steps: 154 | Train Loss: 2.293 Vali Loss: 2.220 Vali Acc: 0.325 Test Loss: 2.220 Test Acc: 0.325
Validation loss decreased (inf --> -0.325201).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6968043
	speed: 0.2109s/iter; left time: 3193.9787s
Epoch: 2 cost time: 8.79274320602417
Epoch: 2, Steps: 154 | Train Loss: 2.107 Vali Loss: 2.204 Vali Acc: 0.332 Test Loss: 2.204 Test Acc: 0.332
Validation loss decreased (-0.325201 --> -0.332095).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9825816
	speed: 0.2249s/iter; left time: 3372.4394s
Epoch: 3 cost time: 8.014084100723267
Epoch: 3, Steps: 154 | Train Loss: 2.148 Vali Loss: 2.221 Vali Acc: 0.332 Test Loss: 2.221 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9212213
	speed: 0.2225s/iter; left time: 3301.0078s
Epoch: 4 cost time: 9.129337787628174
Epoch: 4, Steps: 154 | Train Loss: 2.030 Vali Loss: 2.333 Vali Acc: 0.337 Test Loss: 2.333 Test Acc: 0.337
Validation loss decreased (-0.332095 --> -0.337365).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5662485
	speed: 0.2103s/iter; left time: 3088.8275s
Epoch: 5 cost time: 7.852370262145996
Epoch: 5, Steps: 154 | Train Loss: 1.900 Vali Loss: 2.598 Vali Acc: 0.189 Test Loss: 2.598 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2298838
	speed: 0.2065s/iter; left time: 3000.4382s
Epoch: 6 cost time: 8.473082065582275
Epoch: 6, Steps: 154 | Train Loss: 1.869 Vali Loss: 2.724 Vali Acc: 0.337 Test Loss: 2.724 Test Acc: 0.337
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.8723159
	speed: 0.1916s/iter; left time: 2754.0890s
Epoch: 7 cost time: 7.772596836090088
Epoch: 7, Steps: 154 | Train Loss: 1.798 Vali Loss: 2.743 Vali Acc: 0.335 Test Loss: 2.743 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.4927001
	speed: 0.2037s/iter; left time: 2896.7136s
Epoch: 8 cost time: 8.014295816421509
Epoch: 8, Steps: 154 | Train Loss: 1.820 Vali Loss: 2.845 Vali Acc: 0.186 Test Loss: 2.845 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.4938556
	speed: 0.2023s/iter; left time: 2846.2222s
Epoch: 9 cost time: 8.484110593795776
Epoch: 9, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.601 Vali Acc: 0.364 Test Loss: 2.601 Test Acc: 0.364
Validation loss decreased (-0.337365 --> -0.364126).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5647159
	speed: 0.1966s/iter; left time: 2735.4934s
Epoch: 10 cost time: 7.530358552932739
Epoch: 10, Steps: 154 | Train Loss: 1.820 Vali Loss: 3.053 Vali Acc: 0.339 Test Loss: 3.053 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4894331
	speed: 0.2215s/iter; left time: 3047.8260s
Epoch: 11 cost time: 8.56271243095398
Epoch: 11, Steps: 154 | Train Loss: 1.996 Vali Loss: 3.157 Vali Acc: 0.236 Test Loss: 3.157 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.5617865
	speed: 0.2088s/iter; left time: 2840.6928s
Epoch: 12 cost time: 7.514586687088013
Epoch: 12, Steps: 154 | Train Loss: 1.745 Vali Loss: 3.813 Vali Acc: 0.086 Test Loss: 3.813 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.7312260
	speed: 0.2215s/iter; left time: 2979.2400s
Epoch: 13 cost time: 8.155144691467285
Epoch: 13, Steps: 154 | Train Loss: 1.654 Vali Loss: 3.467 Vali Acc: 0.349 Test Loss: 3.467 Test Acc: 0.349
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.2689375
	speed: 0.2212s/iter; left time: 2941.8038s
Epoch: 14 cost time: 8.818164348602295
Epoch: 14, Steps: 154 | Train Loss: 1.751 Vali Loss: 2.997 Vali Acc: 0.356 Test Loss: 2.997 Test Acc: 0.356
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 2.0062680
	speed: 0.2003s/iter; left time: 2632.7401s
Epoch: 15 cost time: 7.796228647232056
Epoch: 15, Steps: 154 | Train Loss: 1.665 Vali Loss: 3.474 Vali Acc: 0.363 Test Loss: 3.474 Test Acc: 0.363
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.2016910
	speed: 0.1901s/iter; left time: 2470.0627s
Epoch: 16 cost time: 6.496809959411621
Epoch: 16, Steps: 154 | Train Loss: 1.664 Vali Loss: 3.655 Vali Acc: 0.353 Test Loss: 3.655 Test Acc: 0.353
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.8366596
	speed: 0.1774s/iter; left time: 2277.8985s
Epoch: 17 cost time: 8.630982160568237
Epoch: 17, Steps: 154 | Train Loss: 1.642 Vali Loss: 4.203 Vali Acc: 0.359 Test Loss: 4.203 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.6827872
	speed: 0.2005s/iter; left time: 2543.1843s
Epoch: 18 cost time: 7.959570407867432
Epoch: 18, Steps: 154 | Train Loss: 1.718 Vali Loss: 4.578 Vali Acc: 0.365 Test Loss: 4.578 Test Acc: 0.365
Validation loss decreased (-0.364126 --> -0.364512).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.9762986
	speed: 0.2040s/iter; left time: 2555.7993s
Epoch: 19 cost time: 8.087276697158813
Epoch: 19, Steps: 154 | Train Loss: 1.807 Vali Loss: 4.247 Vali Acc: 0.305 Test Loss: 4.247 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.5930916
	speed: 0.2092s/iter; left time: 2588.9862s
Epoch: 20 cost time: 8.631988525390625
Epoch: 20, Steps: 154 | Train Loss: 1.475 Vali Loss: 4.336 Vali Acc: 0.179 Test Loss: 4.336 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 2.3157885
	speed: 0.2164s/iter; left time: 2644.6077s
Epoch: 21 cost time: 8.10120439529419
Epoch: 21, Steps: 154 | Train Loss: 1.574 Vali Loss: 4.636 Vali Acc: 0.215 Test Loss: 4.636 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.4102472
	speed: 0.2186s/iter; left time: 2637.8799s
Epoch: 22 cost time: 8.358296632766724
Epoch: 22, Steps: 154 | Train Loss: 1.717 Vali Loss: 4.819 Vali Acc: 0.298 Test Loss: 4.819 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.7931921
	speed: 0.2082s/iter; left time: 2480.1676s
Epoch: 23 cost time: 7.953537702560425
Epoch: 23, Steps: 154 | Train Loss: 1.378 Vali Loss: 4.973 Vali Acc: 0.207 Test Loss: 4.973 Test Acc: 0.207
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.3494252
	speed: 0.1968s/iter; left time: 2314.7037s
Epoch: 24 cost time: 7.776849031448364
Epoch: 24, Steps: 154 | Train Loss: 1.717 Vali Loss: 4.863 Vali Acc: 0.382 Test Loss: 4.863 Test Acc: 0.382
Validation loss decreased (-0.364512 --> -0.381947).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.8377161
	speed: 0.2060s/iter; left time: 2390.8826s
Epoch: 25 cost time: 8.043711185455322
Epoch: 25, Steps: 154 | Train Loss: 1.402 Vali Loss: 5.290 Vali Acc: 0.152 Test Loss: 5.290 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.7433038
	speed: 0.1927s/iter; left time: 2206.2265s
Epoch: 26 cost time: 7.908308029174805
Epoch: 26, Steps: 154 | Train Loss: 1.458 Vali Loss: 5.350 Vali Acc: 0.103 Test Loss: 5.350 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.0730822
	speed: 0.2108s/iter; left time: 2381.2117s
Epoch: 27 cost time: 7.993893146514893
Epoch: 27, Steps: 154 | Train Loss: 1.408 Vali Loss: 5.581 Vali Acc: 0.373 Test Loss: 5.581 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.8718882
	speed: 0.2038s/iter; left time: 2270.6951s
Epoch: 28 cost time: 8.28222918510437
Epoch: 28, Steps: 154 | Train Loss: 2.359 Vali Loss: 6.125 Vali Acc: 0.204 Test Loss: 6.125 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 1.0322689
	speed: 0.1973s/iter; left time: 2168.3211s
Epoch: 29 cost time: 8.472224473953247
Epoch: 29, Steps: 154 | Train Loss: 1.771 Vali Loss: 5.875 Vali Acc: 0.102 Test Loss: 5.875 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.9207132
	speed: 0.2235s/iter; left time: 2421.8723s
Epoch: 30 cost time: 8.419761419296265
Epoch: 30, Steps: 154 | Train Loss: 1.180 Vali Loss: 6.666 Vali Acc: 0.219 Test Loss: 6.666 Test Acc: 0.219
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 1.2181084
	speed: 0.2236s/iter; left time: 2387.9511s
Epoch: 31 cost time: 9.235216617584229
Epoch: 31, Steps: 154 | Train Loss: 1.617 Vali Loss: 6.844 Vali Acc: 0.372 Test Loss: 6.844 Test Acc: 0.372
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.7057953
	speed: 0.2190s/iter; left time: 2305.4209s
Epoch: 32 cost time: 8.155391454696655
Epoch: 32, Steps: 154 | Train Loss: 1.635 Vali Loss: 5.914 Vali Acc: 0.365 Test Loss: 5.914 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 27.2208996
	speed: 0.2061s/iter; left time: 2137.5704s
Epoch: 33 cost time: 8.132192850112915
Epoch: 33, Steps: 154 | Train Loss: 2.157 Vali Loss: 6.585 Vali Acc: 0.090 Test Loss: 6.585 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 1.4277303
	speed: 0.1983s/iter; left time: 2026.2516s
Epoch: 34 cost time: 8.456279993057251
Epoch: 34, Steps: 154 | Train Loss: 1.167 Vali Loss: 6.269 Vali Acc: 0.375 Test Loss: 6.269 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3819951338199513
model parameter : 869430
model size : 13.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0382798
	speed: 0.0724s/iter; left time: 1107.8373s
Epoch: 1 cost time: 9.811884880065918
Epoch: 1, Steps: 154 | Train Loss: 2.269 Vali Loss: 2.226 Vali Acc: 0.325 Test Loss: 2.226 Test Acc: 0.325
Validation loss decreased (inf --> -0.325201).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7023382
	speed: 0.2014s/iter; left time: 3051.1961s
Epoch: 2 cost time: 8.023727178573608
Epoch: 2, Steps: 154 | Train Loss: 2.082 Vali Loss: 2.186 Vali Acc: 0.331 Test Loss: 2.186 Test Acc: 0.331
Validation loss decreased (-0.325201 --> -0.330878).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9160014
	speed: 0.2046s/iter; left time: 3067.4885s
Epoch: 3 cost time: 7.48979926109314
Epoch: 3, Steps: 154 | Train Loss: 2.091 Vali Loss: 2.207 Vali Acc: 0.331 Test Loss: 2.207 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1139398
	speed: 0.2145s/iter; left time: 3182.7092s
Epoch: 4 cost time: 8.556116342544556
Epoch: 4, Steps: 154 | Train Loss: 1.996 Vali Loss: 2.308 Vali Acc: 0.338 Test Loss: 2.308 Test Acc: 0.338
Validation loss decreased (-0.330878 --> -0.337771).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5552111
	speed: 0.2114s/iter; left time: 3103.9731s
Epoch: 5 cost time: 7.981836557388306
Epoch: 5, Steps: 154 | Train Loss: 2.065 Vali Loss: 2.421 Vali Acc: 0.183 Test Loss: 2.421 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1559492
	speed: 0.2217s/iter; left time: 3221.9942s
Epoch: 6 cost time: 8.224225759506226
Epoch: 6, Steps: 154 | Train Loss: 1.854 Vali Loss: 2.582 Vali Acc: 0.338 Test Loss: 2.582 Test Acc: 0.338
Validation loss decreased (-0.337771 --> -0.338174).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7273606
	speed: 0.2035s/iter; left time: 2925.7218s
Epoch: 7 cost time: 8.314709186553955
Epoch: 7, Steps: 154 | Train Loss: 1.874 Vali Loss: 2.503 Vali Acc: 0.346 Test Loss: 2.503 Test Acc: 0.346
Validation loss decreased (-0.338174 --> -0.345879).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7686877
	speed: 0.2028s/iter; left time: 2884.3270s
Epoch: 8 cost time: 7.978723764419556
Epoch: 8, Steps: 154 | Train Loss: 1.854 Vali Loss: 2.790 Vali Acc: 0.187 Test Loss: 2.790 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5522325
	speed: 0.2027s/iter; left time: 2852.3534s
Epoch: 9 cost time: 8.12324571609497
Epoch: 9, Steps: 154 | Train Loss: 1.827 Vali Loss: 2.705 Vali Acc: 0.363 Test Loss: 2.705 Test Acc: 0.363
Validation loss decreased (-0.345879 --> -0.363314).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5702306
	speed: 0.1938s/iter; left time: 2697.4070s
Epoch: 10 cost time: 8.059115409851074
Epoch: 10, Steps: 154 | Train Loss: 1.824 Vali Loss: 2.811 Vali Acc: 0.357 Test Loss: 2.811 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5164467
	speed: 0.1722s/iter; left time: 2369.0516s
Epoch: 11 cost time: 6.58633828163147
Epoch: 11, Steps: 154 | Train Loss: 2.080 Vali Loss: 2.983 Vali Acc: 0.363 Test Loss: 2.983 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.4733177
	speed: 0.1935s/iter; left time: 2633.2609s
Epoch: 12 cost time: 7.49357533454895
Epoch: 12, Steps: 154 | Train Loss: 1.652 Vali Loss: 3.202 Vali Acc: 0.103 Test Loss: 3.202 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.6776215
	speed: 0.2118s/iter; left time: 2849.6465s
Epoch: 13 cost time: 8.822738885879517
Epoch: 13, Steps: 154 | Train Loss: 1.703 Vali Loss: 2.940 Vali Acc: 0.362 Test Loss: 2.940 Test Acc: 0.362
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.1790706
	speed: 0.2098s/iter; left time: 2789.8836s
Epoch: 14 cost time: 7.552481412887573
Epoch: 14, Steps: 154 | Train Loss: 2.172 Vali Loss: 2.988 Vali Acc: 0.360 Test Loss: 2.988 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.5959671
	speed: 0.2082s/iter; left time: 2736.6416s
Epoch: 15 cost time: 7.419552326202393
Epoch: 15, Steps: 154 | Train Loss: 1.592 Vali Loss: 2.961 Vali Acc: 0.375 Test Loss: 2.961 Test Acc: 0.375
Validation loss decreased (-0.363314 --> -0.375072).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5296355
	speed: 0.2006s/iter; left time: 2606.4783s
Epoch: 16 cost time: 7.963987350463867
Epoch: 16, Steps: 154 | Train Loss: 1.971 Vali Loss: 4.069 Vali Acc: 0.347 Test Loss: 4.069 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.0032120
	speed: 0.1950s/iter; left time: 2503.8448s
Epoch: 17 cost time: 7.373173475265503
Epoch: 17, Steps: 154 | Train Loss: 1.865 Vali Loss: 3.428 Vali Acc: 0.374 Test Loss: 3.428 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.5222492
	speed: 0.1944s/iter; left time: 2466.1060s
Epoch: 18 cost time: 7.930034637451172
Epoch: 18, Steps: 154 | Train Loss: 1.699 Vali Loss: 3.704 Vali Acc: 0.371 Test Loss: 3.704 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.5895768
	speed: 0.1967s/iter; left time: 2464.4662s
Epoch: 19 cost time: 8.009736776351929
Epoch: 19, Steps: 154 | Train Loss: 1.822 Vali Loss: 4.363 Vali Acc: 0.365 Test Loss: 4.363 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.6304979
	speed: 0.1881s/iter; left time: 2327.2947s
Epoch: 20 cost time: 7.134598016738892
Epoch: 20, Steps: 154 | Train Loss: 1.427 Vali Loss: 4.222 Vali Acc: 0.359 Test Loss: 4.222 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 3.1953387
	speed: 0.1865s/iter; left time: 2279.7558s
Epoch: 21 cost time: 7.112273693084717
Epoch: 21, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.421 Vali Acc: 0.388 Test Loss: 3.421 Test Acc: 0.388
Validation loss decreased (-0.375072 --> -0.387638).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.4276531
	speed: 0.1919s/iter; left time: 2315.5608s
Epoch: 22 cost time: 8.340174436569214
Epoch: 22, Steps: 154 | Train Loss: 1.462 Vali Loss: 4.520 Vali Acc: 0.134 Test Loss: 4.520 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.6863277
	speed: 0.2147s/iter; left time: 2557.1274s
Epoch: 23 cost time: 7.7070393562316895
Epoch: 23, Steps: 154 | Train Loss: 2.143 Vali Loss: 4.417 Vali Acc: 0.244 Test Loss: 4.417 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.9136280
	speed: 0.2037s/iter; left time: 2395.0193s
Epoch: 24 cost time: 8.541921377182007
Epoch: 24, Steps: 154 | Train Loss: 1.700 Vali Loss: 5.702 Vali Acc: 0.355 Test Loss: 5.702 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.8626592
	speed: 0.2035s/iter; left time: 2361.4055s
Epoch: 25 cost time: 7.971381664276123
Epoch: 25, Steps: 154 | Train Loss: 2.057 Vali Loss: 5.340 Vali Acc: 0.384 Test Loss: 5.340 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 26.9903774
	speed: 0.1947s/iter; left time: 2229.5400s
Epoch: 26 cost time: 7.5281901359558105
Epoch: 26, Steps: 154 | Train Loss: 1.872 Vali Loss: 5.213 Vali Acc: 0.121 Test Loss: 5.213 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.7629217
	speed: 0.1927s/iter; left time: 2177.3844s
Epoch: 27 cost time: 8.319486618041992
Epoch: 27, Steps: 154 | Train Loss: 2.246 Vali Loss: 5.320 Vali Acc: 0.109 Test Loss: 5.320 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.0208073
	speed: 0.1928s/iter; left time: 2148.3365s
Epoch: 28 cost time: 7.654499053955078
Epoch: 28, Steps: 154 | Train Loss: 1.425 Vali Loss: 5.159 Vali Acc: 0.262 Test Loss: 5.159 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 1.2321069
	speed: 0.1946s/iter; left time: 2138.5578s
Epoch: 29 cost time: 7.323289632797241
Epoch: 29, Steps: 154 | Train Loss: 1.520 Vali Loss: 5.649 Vali Acc: 0.308 Test Loss: 5.649 Test Acc: 0.308
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.2106222
	speed: 0.1938s/iter; left time: 2099.9013s
Epoch: 30 cost time: 8.284728288650513
Epoch: 30, Steps: 154 | Train Loss: 1.274 Vali Loss: 7.215 Vali Acc: 0.107 Test Loss: 7.215 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 1.2255219
	speed: 0.2054s/iter; left time: 2193.6620s
Epoch: 31 cost time: 7.530193328857422
Epoch: 31, Steps: 154 | Train Loss: 1.529 Vali Loss: 6.295 Vali Acc: 0.123 Test Loss: 6.295 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38767234387672345
model parameter : 869430
model size : 13.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9136863
	speed: 0.0678s/iter; left time: 1037.6389s
Epoch: 1 cost time: 9.858756065368652
Epoch: 1, Steps: 154 | Train Loss: 2.272 Vali Loss: 2.160 Vali Acc: 0.324 Test Loss: 2.160 Test Acc: 0.324
Validation loss decreased (inf --> -0.323985).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2987037
	speed: 0.2163s/iter; left time: 3275.8672s
Epoch: 2 cost time: 6.863017559051514
Epoch: 2, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.214 Vali Acc: 0.322 Test Loss: 2.214 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3518419
	speed: 0.1853s/iter; left time: 2778.2336s
Epoch: 3 cost time: 7.916607618331909
Epoch: 3, Steps: 154 | Train Loss: 1.977 Vali Loss: 2.207 Vali Acc: 0.326 Test Loss: 2.207 Test Acc: 0.326
Validation loss decreased (-0.323985 --> -0.325606).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9875176
	speed: 0.1906s/iter; left time: 2828.6539s
Epoch: 4 cost time: 7.428340911865234
Epoch: 4, Steps: 154 | Train Loss: 1.881 Vali Loss: 2.211 Vali Acc: 0.329 Test Loss: 2.211 Test Acc: 0.329
Validation loss decreased (-0.325606 --> -0.328851).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4747647
	speed: 0.1875s/iter; left time: 2752.7185s
Epoch: 5 cost time: 7.187600135803223
Epoch: 5, Steps: 154 | Train Loss: 1.862 Vali Loss: 2.251 Vali Acc: 0.329 Test Loss: 2.251 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8288903
	speed: 0.1879s/iter; left time: 2730.6668s
Epoch: 6 cost time: 8.123341798782349
Epoch: 6, Steps: 154 | Train Loss: 1.822 Vali Loss: 2.266 Vali Acc: 0.334 Test Loss: 2.266 Test Acc: 0.334
Validation loss decreased (-0.328851 --> -0.334122).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7765024
	speed: 0.1927s/iter; left time: 2771.1220s
Epoch: 7 cost time: 7.6078362464904785
Epoch: 7, Steps: 154 | Train Loss: 1.860 Vali Loss: 2.378 Vali Acc: 0.340 Test Loss: 2.378 Test Acc: 0.340
Validation loss decreased (-0.334122 --> -0.339798).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7164711
	speed: 0.1726s/iter; left time: 2454.7660s
Epoch: 8 cost time: 5.762848615646362
Epoch: 8, Steps: 154 | Train Loss: 1.761 Vali Loss: 2.299 Vali Acc: 0.348 Test Loss: 2.299 Test Acc: 0.348
Validation loss decreased (-0.339798 --> -0.347909).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0767977
	speed: 0.1894s/iter; left time: 2665.3502s
Epoch: 9 cost time: 8.55950927734375
Epoch: 9, Steps: 154 | Train Loss: 1.800 Vali Loss: 2.426 Vali Acc: 0.343 Test Loss: 2.426 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.8024005
	speed: 0.2048s/iter; left time: 2850.1520s
Epoch: 10 cost time: 7.569649696350098
Epoch: 10, Steps: 154 | Train Loss: 1.831 Vali Loss: 2.519 Vali Acc: 0.343 Test Loss: 2.519 Test Acc: 0.343
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.9156717
	speed: 0.2048s/iter; left time: 2818.3676s
Epoch: 11 cost time: 6.914399862289429
Epoch: 11, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.566 Vali Acc: 0.350 Test Loss: 2.566 Test Acc: 0.350
Validation loss decreased (-0.347909 --> -0.350339).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6318619
	speed: 0.2035s/iter; left time: 2768.5172s
Epoch: 12 cost time: 9.470866918563843
Epoch: 12, Steps: 154 | Train Loss: 1.700 Vali Loss: 2.546 Vali Acc: 0.357 Test Loss: 2.546 Test Acc: 0.357
Validation loss decreased (-0.350339 --> -0.357233).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6765273
	speed: 0.2026s/iter; left time: 2725.5473s
Epoch: 13 cost time: 5.496678829193115
Epoch: 13, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.788 Vali Acc: 0.356 Test Loss: 2.788 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.8921291
	speed: 0.1440s/iter; left time: 1915.4885s
Epoch: 14 cost time: 5.629379510879517
Epoch: 14, Steps: 154 | Train Loss: 1.620 Vali Loss: 3.047 Vali Acc: 0.350 Test Loss: 3.047 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.6749364
	speed: 0.1862s/iter; left time: 2447.4735s
Epoch: 15 cost time: 8.030691862106323
Epoch: 15, Steps: 154 | Train Loss: 1.556 Vali Loss: 3.004 Vali Acc: 0.366 Test Loss: 3.004 Test Acc: 0.366
Validation loss decreased (-0.357233 --> -0.366150).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5359062
	speed: 0.1844s/iter; left time: 2395.0324s
Epoch: 16 cost time: 7.051985025405884
Epoch: 16, Steps: 154 | Train Loss: 1.681 Vali Loss: 3.210 Vali Acc: 0.187 Test Loss: 3.210 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.9765036
	speed: 0.1855s/iter; left time: 2381.5853s
Epoch: 17 cost time: 7.44601583480835
Epoch: 17, Steps: 154 | Train Loss: 1.498 Vali Loss: 3.103 Vali Acc: 0.379 Test Loss: 3.103 Test Acc: 0.379
Validation loss decreased (-0.366150 --> -0.378720).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.9373224
	speed: 0.1917s/iter; left time: 2431.5393s
Epoch: 18 cost time: 8.119467496871948
Epoch: 18, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.946 Vali Acc: 0.374 Test Loss: 2.946 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.7352526
	speed: 0.1853s/iter; left time: 2321.0709s
Epoch: 19 cost time: 7.178339719772339
Epoch: 19, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.991 Vali Acc: 0.377 Test Loss: 2.991 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.4047141
	speed: 0.1914s/iter; left time: 2369.0210s
Epoch: 20 cost time: 7.845873117446899
Epoch: 20, Steps: 154 | Train Loss: 1.415 Vali Loss: 2.949 Vali Acc: 0.381 Test Loss: 2.949 Test Acc: 0.381
Validation loss decreased (-0.378720 --> -0.380749).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.8313346
	speed: 0.2205s/iter; left time: 2695.0089s
Epoch: 21 cost time: 8.527588844299316
Epoch: 21, Steps: 154 | Train Loss: 1.579 Vali Loss: 3.306 Vali Acc: 0.129 Test Loss: 3.306 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.0180075
	speed: 0.1998s/iter; left time: 2410.9863s
Epoch: 22 cost time: 7.64572286605835
Epoch: 22, Steps: 154 | Train Loss: 1.553 Vali Loss: 3.411 Vali Acc: 0.216 Test Loss: 3.411 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 2.0003760
	speed: 0.2085s/iter; left time: 2483.7251s
Epoch: 23 cost time: 7.432294607162476
Epoch: 23, Steps: 154 | Train Loss: 1.369 Vali Loss: 4.151 Vali Acc: 0.078 Test Loss: 4.151 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 2.1558115
	speed: 0.1962s/iter; left time: 2306.8348s
Epoch: 24 cost time: 7.925581693649292
Epoch: 24, Steps: 154 | Train Loss: 1.365 Vali Loss: 3.308 Vali Acc: 0.365 Test Loss: 3.308 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.8667499
	speed: 0.1877s/iter; left time: 2178.7223s
Epoch: 25 cost time: 7.205145597457886
Epoch: 25, Steps: 154 | Train Loss: 1.297 Vali Loss: 4.066 Vali Acc: 0.376 Test Loss: 4.066 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 1.4318042
	speed: 0.1942s/iter; left time: 2224.0078s
Epoch: 26 cost time: 7.479990720748901
Epoch: 26, Steps: 154 | Train Loss: 1.586 Vali Loss: 4.151 Vali Acc: 0.075 Test Loss: 4.151 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 1.3828884
	speed: 0.1847s/iter; left time: 2086.4871s
Epoch: 27 cost time: 7.461528778076172
Epoch: 27, Steps: 154 | Train Loss: 1.418 Vali Loss: 4.560 Vali Acc: 0.083 Test Loss: 4.560 Test Acc: 0.083
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.8607374
	speed: 0.1884s/iter; left time: 2099.7246s
Epoch: 28 cost time: 7.138726234436035
Epoch: 28, Steps: 154 | Train Loss: 1.229 Vali Loss: 4.006 Vali Acc: 0.204 Test Loss: 4.006 Test Acc: 0.204
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 1.5186702
	speed: 0.2033s/iter; left time: 2234.0702s
Epoch: 29 cost time: 7.889975547790527
Epoch: 29, Steps: 154 | Train Loss: 1.478 Vali Loss: 4.062 Vali Acc: 0.190 Test Loss: 4.062 Test Acc: 0.190
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 1.1307298
	speed: 0.1984s/iter; left time: 2149.4662s
Epoch: 30 cost time: 7.415708541870117
Epoch: 30, Steps: 154 | Train Loss: 1.342 Vali Loss: 4.757 Vali Acc: 0.100 Test Loss: 4.757 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38077858880778587
model parameter : 1319478
model size : 9.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9147127
	speed: 0.0645s/iter; left time: 986.3865s
Epoch: 1 cost time: 9.22342038154602
Epoch: 1, Steps: 154 | Train Loss: 2.262 Vali Loss: 2.152 Vali Acc: 0.321 Test Loss: 2.152 Test Acc: 0.321
Validation loss decreased (inf --> -0.321146).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2949023
	speed: 0.1842s/iter; left time: 2789.5216s
Epoch: 2 cost time: 7.141467809677124
Epoch: 2, Steps: 154 | Train Loss: 2.087 Vali Loss: 2.204 Vali Acc: 0.321 Test Loss: 2.204 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.4021637
	speed: 0.1863s/iter; left time: 2793.3977s
Epoch: 3 cost time: 7.51663064956665
Epoch: 3, Steps: 154 | Train Loss: 1.960 Vali Loss: 2.189 Vali Acc: 0.325 Test Loss: 2.189 Test Acc: 0.325
Validation loss decreased (-0.321146 --> -0.325201).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9602329
	speed: 0.1873s/iter; left time: 2780.0032s
Epoch: 4 cost time: 7.827647686004639
Epoch: 4, Steps: 154 | Train Loss: 1.883 Vali Loss: 2.210 Vali Acc: 0.328 Test Loss: 2.210 Test Acc: 0.328
Validation loss decreased (-0.325201 --> -0.327634).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4335797
	speed: 0.1865s/iter; left time: 2738.2782s
Epoch: 5 cost time: 7.452009916305542
Epoch: 5, Steps: 154 | Train Loss: 1.853 Vali Loss: 2.236 Vali Acc: 0.328 Test Loss: 2.236 Test Acc: 0.328
Validation loss decreased (-0.327634 --> -0.328039).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7601526
	speed: 0.1921s/iter; left time: 2791.8944s
Epoch: 6 cost time: 7.595272779464722
Epoch: 6, Steps: 154 | Train Loss: 1.764 Vali Loss: 2.217 Vali Acc: 0.303 Test Loss: 2.217 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6632497
	speed: 0.1945s/iter; left time: 2796.9075s
Epoch: 7 cost time: 8.237815856933594
Epoch: 7, Steps: 154 | Train Loss: 1.866 Vali Loss: 2.343 Vali Acc: 0.338 Test Loss: 2.343 Test Acc: 0.338
Validation loss decreased (-0.328039 --> -0.337771).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6196778
	speed: 0.2044s/iter; left time: 2907.2824s
Epoch: 8 cost time: 7.465058088302612
Epoch: 8, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.339 Vali Acc: 0.353 Test Loss: 2.339 Test Acc: 0.353
Validation loss decreased (-0.337771 --> -0.352775).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9104409
	speed: 0.2053s/iter; left time: 2888.5554s
Epoch: 9 cost time: 7.2351975440979
Epoch: 9, Steps: 154 | Train Loss: 1.802 Vali Loss: 2.534 Vali Acc: 0.350 Test Loss: 2.534 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.5174401
	speed: 0.2007s/iter; left time: 2792.4933s
Epoch: 10 cost time: 7.560337781906128
Epoch: 10, Steps: 154 | Train Loss: 1.746 Vali Loss: 2.540 Vali Acc: 0.351 Test Loss: 2.540 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.8066608
	speed: 0.1869s/iter; left time: 2571.4259s
Epoch: 11 cost time: 7.300945997238159
Epoch: 11, Steps: 154 | Train Loss: 1.603 Vali Loss: 2.415 Vali Acc: 0.361 Test Loss: 2.415 Test Acc: 0.361
Validation loss decreased (-0.352775 --> -0.360884).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6091883
	speed: 0.1875s/iter; left time: 2551.4077s
Epoch: 12 cost time: 6.803308486938477
Epoch: 12, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.556 Vali Acc: 0.354 Test Loss: 2.556 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6613214
	speed: 0.1818s/iter; left time: 2446.2223s
Epoch: 13 cost time: 7.840524196624756
Epoch: 13, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.742 Vali Acc: 0.356 Test Loss: 2.742 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2371007
	speed: 0.1860s/iter; left time: 2474.1321s
Epoch: 14 cost time: 7.17344069480896
Epoch: 14, Steps: 154 | Train Loss: 1.470 Vali Loss: 3.020 Vali Acc: 0.351 Test Loss: 3.020 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.7619432
	speed: 0.1850s/iter; left time: 2431.4046s
Epoch: 15 cost time: 7.024122476577759
Epoch: 15, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.936 Vali Acc: 0.357 Test Loss: 2.936 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.3116207
	speed: 0.1929s/iter; left time: 2505.5296s
Epoch: 16 cost time: 8.324450969696045
Epoch: 16, Steps: 154 | Train Loss: 1.706 Vali Loss: 3.093 Vali Acc: 0.371 Test Loss: 3.093 Test Acc: 0.371
Validation loss decreased (-0.360884 --> -0.370610).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.9019325
	speed: 0.2100s/iter; left time: 2695.4405s
Epoch: 17 cost time: 7.377479791641235
Epoch: 17, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.970 Vali Acc: 0.370 Test Loss: 2.970 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.2504426
	speed: 0.2018s/iter; left time: 2559.4625s
Epoch: 18 cost time: 7.746445655822754
Epoch: 18, Steps: 154 | Train Loss: 1.398 Vali Loss: 3.085 Vali Acc: 0.368 Test Loss: 3.085 Test Acc: 0.368
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.7853433
	speed: 0.2050s/iter; left time: 2568.9775s
Epoch: 19 cost time: 7.684459686279297
Epoch: 19, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.972 Vali Acc: 0.369 Test Loss: 2.972 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.4498115
	speed: 0.1856s/iter; left time: 2296.3057s
Epoch: 20 cost time: 7.095785140991211
Epoch: 20, Steps: 154 | Train Loss: 1.368 Vali Loss: 3.121 Vali Acc: 0.365 Test Loss: 3.121 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.9091073
	speed: 0.1916s/iter; left time: 2341.6542s
Epoch: 21 cost time: 7.7021260261535645
Epoch: 21, Steps: 154 | Train Loss: 1.450 Vali Loss: 3.516 Vali Acc: 0.372 Test Loss: 3.516 Test Acc: 0.372
Validation loss decreased (-0.370610 --> -0.372228).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.0367894
	speed: 0.1905s/iter; left time: 2299.3079s
Epoch: 22 cost time: 7.679193735122681
Epoch: 22, Steps: 154 | Train Loss: 1.406 Vali Loss: 3.836 Vali Acc: 0.245 Test Loss: 3.836 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 3.9918211
	speed: 0.1873s/iter; left time: 2231.2262s
Epoch: 23 cost time: 6.833677768707275
Epoch: 23, Steps: 154 | Train Loss: 1.531 Vali Loss: 4.322 Vali Acc: 0.081 Test Loss: 4.322 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.9887671
	speed: 0.1840s/iter; left time: 2163.1944s
Epoch: 24 cost time: 6.773582220077515
Epoch: 24, Steps: 154 | Train Loss: 1.437 Vali Loss: 3.673 Vali Acc: 0.365 Test Loss: 3.673 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.0007218
	speed: 0.1883s/iter; left time: 2185.7375s
Epoch: 25 cost time: 7.901376485824585
Epoch: 25, Steps: 154 | Train Loss: 1.367 Vali Loss: 4.507 Vali Acc: 0.370 Test Loss: 4.507 Test Acc: 0.370
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.2656063
	speed: 0.2064s/iter; left time: 2362.9395s
Epoch: 26 cost time: 6.927952766418457
Epoch: 26, Steps: 154 | Train Loss: 1.287 Vali Loss: 4.006 Vali Acc: 0.199 Test Loss: 4.006 Test Acc: 0.199
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.4659044
	speed: 0.2005s/iter; left time: 2264.8655s
Epoch: 27 cost time: 8.016770124435425
Epoch: 27, Steps: 154 | Train Loss: 1.245 Vali Loss: 4.585 Vali Acc: 0.378 Test Loss: 4.585 Test Acc: 0.378
Validation loss decreased (-0.372228 --> -0.377489).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.8378982
	speed: 0.1960s/iter; left time: 2184.3803s
Epoch: 28 cost time: 7.025609016418457
Epoch: 28, Steps: 154 | Train Loss: 1.295 Vali Loss: 4.143 Vali Acc: 0.388 Test Loss: 4.143 Test Acc: 0.388
Validation loss decreased (-0.377489 --> -0.388442).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.6849113
	speed: 0.1862s/iter; left time: 2046.1836s
Epoch: 29 cost time: 6.629133701324463
Epoch: 29, Steps: 154 | Train Loss: 1.258 Vali Loss: 4.021 Vali Acc: 0.205 Test Loss: 4.021 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.0822364
	speed: 0.1825s/iter; left time: 1977.0419s
Epoch: 30 cost time: 7.905843257904053
Epoch: 30, Steps: 154 | Train Loss: 1.427 Vali Loss: 4.108 Vali Acc: 0.125 Test Loss: 4.108 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.7315345
	speed: 0.1834s/iter; left time: 1959.4198s
Epoch: 31 cost time: 7.194644927978516
Epoch: 31, Steps: 154 | Train Loss: 1.198 Vali Loss: 4.694 Vali Acc: 0.113 Test Loss: 4.694 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.0057615
	speed: 0.1829s/iter; left time: 1925.5131s
Epoch: 32 cost time: 6.959136486053467
Epoch: 32, Steps: 154 | Train Loss: 1.172 Vali Loss: 4.939 Vali Acc: 0.087 Test Loss: 4.939 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.9989654
	speed: 0.1926s/iter; left time: 1997.3784s
Epoch: 33 cost time: 8.103450775146484
Epoch: 33, Steps: 154 | Train Loss: 1.468 Vali Loss: 3.771 Vali Acc: 0.390 Test Loss: 3.771 Test Acc: 0.390
Validation loss decreased (-0.388442 --> -0.389662).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.3695588
	speed: 0.1880s/iter; left time: 1921.6507s
Epoch: 34 cost time: 7.192339181900024
Epoch: 34, Steps: 154 | Train Loss: 1.244 Vali Loss: 4.490 Vali Acc: 0.223 Test Loss: 4.490 Test Acc: 0.223
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 1.0232966
	speed: 0.1803s/iter; left time: 1814.4372s
Epoch: 35 cost time: 6.14170241355896
Epoch: 35, Steps: 154 | Train Loss: 1.295 Vali Loss: 4.884 Vali Acc: 0.119 Test Loss: 4.884 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.8935756
	speed: 0.2029s/iter; left time: 2010.6205s
Epoch: 36 cost time: 8.481165885925293
Epoch: 36, Steps: 154 | Train Loss: 1.229 Vali Loss: 4.129 Vali Acc: 0.394 Test Loss: 4.129 Test Acc: 0.394
Validation loss decreased (-0.389662 --> -0.394119).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.9385611
	speed: 0.2062s/iter; left time: 2011.5206s
Epoch: 37 cost time: 6.630676507949829
Epoch: 37, Steps: 154 | Train Loss: 1.203 Vali Loss: 4.847 Vali Acc: 0.236 Test Loss: 4.847 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.8302312
	speed: 0.1874s/iter; left time: 1799.2359s
Epoch: 38 cost time: 7.354300260543823
Epoch: 38, Steps: 154 | Train Loss: 1.209 Vali Loss: 4.856 Vali Acc: 0.108 Test Loss: 4.856 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 1.7820853
	speed: 0.1894s/iter; left time: 1790.1087s
Epoch: 39 cost time: 7.820874929428101
Epoch: 39, Steps: 154 | Train Loss: 1.253 Vali Loss: 5.689 Vali Acc: 0.088 Test Loss: 5.689 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.9369785
	speed: 0.1908s/iter; left time: 1773.4545s
Epoch: 40 cost time: 6.893531560897827
Epoch: 40, Steps: 154 | Train Loss: 1.129 Vali Loss: 4.525 Vali Acc: 0.377 Test Loss: 4.525 Test Acc: 0.377
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.6712971
	speed: 0.1932s/iter; left time: 1766.0895s
Epoch: 41 cost time: 7.905435562133789
Epoch: 41, Steps: 154 | Train Loss: 1.111 Vali Loss: 5.103 Vali Acc: 0.178 Test Loss: 5.103 Test Acc: 0.178
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.7510548
	speed: 0.1857s/iter; left time: 1669.0905s
Epoch: 42 cost time: 7.412043809890747
Epoch: 42, Steps: 154 | Train Loss: 1.213 Vali Loss: 5.368 Vali Acc: 0.114 Test Loss: 5.368 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.6727407
	speed: 0.1894s/iter; left time: 1672.8550s
Epoch: 43 cost time: 7.140950918197632
Epoch: 43, Steps: 154 | Train Loss: 1.123 Vali Loss: 6.001 Vali Acc: 0.090 Test Loss: 6.001 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 1.0298246
	speed: 0.2114s/iter; left time: 1835.0240s
Epoch: 44 cost time: 8.650867700576782
Epoch: 44, Steps: 154 | Train Loss: 1.003 Vali Loss: 6.520 Vali Acc: 0.088 Test Loss: 6.520 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 0.6653296
	speed: 0.2022s/iter; left time: 1723.5723s
Epoch: 45 cost time: 6.998898506164551
Epoch: 45, Steps: 154 | Train Loss: 1.249 Vali Loss: 5.307 Vali Acc: 0.107 Test Loss: 5.307 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 1.1477300
	speed: 0.2085s/iter; left time: 1745.4354s
Epoch: 46 cost time: 8.012383699417114
Epoch: 46, Steps: 154 | Train Loss: 1.310 Vali Loss: 6.095 Vali Acc: 0.102 Test Loss: 6.095 Test Acc: 0.102
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39416058394160586
model parameter : 1319478
model size : 9.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9098853
	speed: 0.0613s/iter; left time: 938.0404s
Epoch: 1 cost time: 8.738922357559204
Epoch: 1, Steps: 154 | Train Loss: 2.245 Vali Loss: 2.148 Vali Acc: 0.321 Test Loss: 2.148 Test Acc: 0.321
Validation loss decreased (inf --> -0.321146).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2856412
	speed: 0.1907s/iter; left time: 2889.0426s
Epoch: 2 cost time: 8.272727727890015
Epoch: 2, Steps: 154 | Train Loss: 2.077 Vali Loss: 2.195 Vali Acc: 0.321 Test Loss: 2.195 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3459096
	speed: 0.1917s/iter; left time: 2873.5734s
Epoch: 3 cost time: 7.447152137756348
Epoch: 3, Steps: 154 | Train Loss: 1.950 Vali Loss: 2.167 Vali Acc: 0.327 Test Loss: 2.167 Test Acc: 0.327
Validation loss decreased (-0.321146 --> -0.326823).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9425271
	speed: 0.1976s/iter; left time: 2931.5288s
Epoch: 4 cost time: 7.5458903312683105
Epoch: 4, Steps: 154 | Train Loss: 1.881 Vali Loss: 2.200 Vali Acc: 0.328 Test Loss: 2.200 Test Acc: 0.328
Validation loss decreased (-0.326823 --> -0.328445).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5098333
	speed: 0.1938s/iter; left time: 2846.4214s
Epoch: 5 cost time: 7.793439626693726
Epoch: 5, Steps: 154 | Train Loss: 1.877 Vali Loss: 2.234 Vali Acc: 0.331 Test Loss: 2.234 Test Acc: 0.331
Validation loss decreased (-0.328445 --> -0.330878).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7468145
	speed: 0.2128s/iter; left time: 3092.9044s
Epoch: 6 cost time: 7.31231951713562
Epoch: 6, Steps: 154 | Train Loss: 1.826 Vali Loss: 2.229 Vali Acc: 0.349 Test Loss: 2.229 Test Acc: 0.349
Validation loss decreased (-0.330878 --> -0.348721).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7682374
	speed: 0.2076s/iter; left time: 2984.0363s
Epoch: 7 cost time: 8.24067234992981
Epoch: 7, Steps: 154 | Train Loss: 1.815 Vali Loss: 2.433 Vali Acc: 0.339 Test Loss: 2.433 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5750294
	speed: 0.2107s/iter; left time: 2996.8049s
Epoch: 8 cost time: 7.441190958023071
Epoch: 8, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.362 Vali Acc: 0.355 Test Loss: 2.362 Test Acc: 0.355
Validation loss decreased (-0.348721 --> -0.355208).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.1642509
	speed: 0.1994s/iter; left time: 2805.9572s
Epoch: 9 cost time: 6.9883880615234375
Epoch: 9, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.528 Vali Acc: 0.342 Test Loss: 2.528 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.2762804
	speed: 0.1853s/iter; left time: 2578.0700s
Epoch: 10 cost time: 7.9799768924713135
Epoch: 10, Steps: 154 | Train Loss: 1.753 Vali Loss: 2.587 Vali Acc: 0.353 Test Loss: 2.587 Test Acc: 0.353
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 16.5352001
	speed: 0.1967s/iter; left time: 2707.4472s
Epoch: 11 cost time: 7.339738607406616
Epoch: 11, Steps: 154 | Train Loss: 1.674 Vali Loss: 2.758 Vali Acc: 0.357 Test Loss: 2.758 Test Acc: 0.357
Validation loss decreased (-0.355208 --> -0.357231).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6607022
	speed: 0.1949s/iter; left time: 2652.5768s
Epoch: 12 cost time: 7.378716945648193
Epoch: 12, Steps: 154 | Train Loss: 1.542 Vali Loss: 2.861 Vali Acc: 0.303 Test Loss: 2.861 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6206676
	speed: 0.1875s/iter; left time: 2522.6938s
Epoch: 13 cost time: 7.6859376430511475
Epoch: 13, Steps: 154 | Train Loss: 1.678 Vali Loss: 2.937 Vali Acc: 0.354 Test Loss: 2.937 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.4001141
	speed: 0.1940s/iter; left time: 2579.4889s
Epoch: 14 cost time: 7.424922704696655
Epoch: 14, Steps: 154 | Train Loss: 1.551 Vali Loss: 3.388 Vali Acc: 0.335 Test Loss: 3.388 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.6852596
	speed: 0.2100s/iter; left time: 2761.0595s
Epoch: 15 cost time: 8.742308378219604
Epoch: 15, Steps: 154 | Train Loss: 1.481 Vali Loss: 3.487 Vali Acc: 0.355 Test Loss: 3.487 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.5154632
	speed: 0.2076s/iter; left time: 2696.5263s
Epoch: 16 cost time: 7.782093286514282
Epoch: 16, Steps: 154 | Train Loss: 1.563 Vali Loss: 3.277 Vali Acc: 0.366 Test Loss: 3.277 Test Acc: 0.366
Validation loss decreased (-0.357231 --> -0.366147).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.1729616
	speed: 0.2133s/iter; left time: 2738.3771s
Epoch: 17 cost time: 7.181956052780151
Epoch: 17, Steps: 154 | Train Loss: 1.559 Vali Loss: 3.463 Vali Acc: 0.272 Test Loss: 3.463 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.1481969
	speed: 0.1922s/iter; left time: 2437.9831s
Epoch: 18 cost time: 7.8727521896362305
Epoch: 18, Steps: 154 | Train Loss: 1.428 Vali Loss: 3.769 Vali Acc: 0.363 Test Loss: 3.769 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.7396554
	speed: 0.1942s/iter; left time: 2433.0353s
Epoch: 19 cost time: 7.524379253387451
Epoch: 19, Steps: 154 | Train Loss: 1.537 Vali Loss: 3.439 Vali Acc: 0.374 Test Loss: 3.439 Test Acc: 0.374
Validation loss decreased (-0.366147 --> -0.374256).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.3857770
	speed: 0.1956s/iter; left time: 2421.1037s
Epoch: 20 cost time: 7.5205605030059814
Epoch: 20, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.530 Vali Acc: 0.378 Test Loss: 3.530 Test Acc: 0.378
Validation loss decreased (-0.374256 --> -0.377499).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.9828349
	speed: 0.1907s/iter; left time: 2330.5403s
Epoch: 21 cost time: 7.605098485946655
Epoch: 21, Steps: 154 | Train Loss: 1.510 Vali Loss: 4.390 Vali Acc: 0.265 Test Loss: 4.390 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.9101734
	speed: 0.1952s/iter; left time: 2355.3180s
Epoch: 22 cost time: 7.460446834564209
Epoch: 22, Steps: 154 | Train Loss: 1.395 Vali Loss: 4.111 Vali Acc: 0.377 Test Loss: 4.111 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.5050809
	speed: 0.1872s/iter; left time: 2229.6025s
Epoch: 23 cost time: 7.657821893692017
Epoch: 23, Steps: 154 | Train Loss: 1.298 Vali Loss: 4.566 Vali Acc: 0.179 Test Loss: 4.566 Test Acc: 0.179
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.6500041
	speed: 0.2112s/iter; left time: 2482.9848s
Epoch: 24 cost time: 7.628627300262451
Epoch: 24, Steps: 154 | Train Loss: 1.455 Vali Loss: 4.068 Vali Acc: 0.381 Test Loss: 4.068 Test Acc: 0.381
Validation loss decreased (-0.377499 --> -0.380738).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.0091186
	speed: 0.2042s/iter; left time: 2369.3878s
Epoch: 25 cost time: 7.230461597442627
Epoch: 25, Steps: 154 | Train Loss: 1.312 Vali Loss: 4.447 Vali Acc: 0.370 Test Loss: 4.447 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.2653823
	speed: 0.2031s/iter; left time: 2325.1467s
Epoch: 26 cost time: 8.125290393829346
Epoch: 26, Steps: 154 | Train Loss: 1.520 Vali Loss: 4.896 Vali Acc: 0.102 Test Loss: 4.896 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.5463617
	speed: 0.2041s/iter; left time: 2305.1947s
Epoch: 27 cost time: 7.474827289581299
Epoch: 27, Steps: 154 | Train Loss: 1.178 Vali Loss: 5.187 Vali Acc: 0.094 Test Loss: 5.187 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.9587706
	speed: 0.1922s/iter; left time: 2141.1410s
Epoch: 28 cost time: 7.406409978866577
Epoch: 28, Steps: 154 | Train Loss: 1.237 Vali Loss: 4.894 Vali Acc: 0.191 Test Loss: 4.894 Test Acc: 0.191
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 1.3061780
	speed: 0.1878s/iter; left time: 2063.9198s
Epoch: 29 cost time: 7.586595058441162
Epoch: 29, Steps: 154 | Train Loss: 1.147 Vali Loss: 4.760 Vali Acc: 0.157 Test Loss: 4.760 Test Acc: 0.157
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 1.0005122
	speed: 0.1690s/iter; left time: 1830.7366s
Epoch: 30 cost time: 5.856266736984253
Epoch: 30, Steps: 154 | Train Loss: 1.251 Vali Loss: 5.826 Vali Acc: 0.094 Test Loss: 5.826 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.9210662
	speed: 0.1782s/iter; left time: 1903.0146s
Epoch: 31 cost time: 7.330932140350342
Epoch: 31, Steps: 154 | Train Loss: 1.353 Vali Loss: 6.398 Vali Acc: 0.088 Test Loss: 6.398 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 1.0386637
	speed: 0.1848s/iter; left time: 1945.6059s
Epoch: 32 cost time: 7.504187822341919
Epoch: 32, Steps: 154 | Train Loss: 1.227 Vali Loss: 5.447 Vali Acc: 0.108 Test Loss: 5.447 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 1.4834515
	speed: 0.2072s/iter; left time: 2149.0217s
Epoch: 33 cost time: 7.177355766296387
Epoch: 33, Steps: 154 | Train Loss: 1.521 Vali Loss: 5.891 Vali Acc: 0.149 Test Loss: 5.891 Test Acc: 0.149
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 1.2799484
	speed: 0.2003s/iter; left time: 2046.8464s
Epoch: 34 cost time: 7.79604697227478
Epoch: 34, Steps: 154 | Train Loss: 1.185 Vali Loss: 5.950 Vali Acc: 0.099 Test Loss: 5.950 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38077858880778587
model parameter : 1319478
model size : 9.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8903973
	speed: 0.0614s/iter; left time: 939.6213s
Epoch: 1 cost time: 8.630086183547974
Epoch: 1, Steps: 154 | Train Loss: 2.229 Vali Loss: 2.148 Vali Acc: 0.320 Test Loss: 2.148 Test Acc: 0.320
Validation loss decreased (inf --> -0.319930).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2962186
	speed: 0.1847s/iter; left time: 2797.7627s
Epoch: 2 cost time: 7.743225812911987
Epoch: 2, Steps: 154 | Train Loss: 2.082 Vali Loss: 2.197 Vali Acc: 0.320 Test Loss: 2.197 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3946893
	speed: 0.1822s/iter; left time: 2732.1856s
Epoch: 3 cost time: 7.186749696731567
Epoch: 3, Steps: 154 | Train Loss: 1.963 Vali Loss: 2.182 Vali Acc: 0.326 Test Loss: 2.182 Test Acc: 0.326
Validation loss decreased (-0.319930 --> -0.326418).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9707869
	speed: 0.1815s/iter; left time: 2693.3647s
Epoch: 4 cost time: 6.9567108154296875
Epoch: 4, Steps: 154 | Train Loss: 1.900 Vali Loss: 2.182 Vali Acc: 0.327 Test Loss: 2.182 Test Acc: 0.327
Validation loss decreased (-0.326418 --> -0.326823).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5089269
	speed: 0.1829s/iter; left time: 2685.2438s
Epoch: 5 cost time: 7.576054811477661
Epoch: 5, Steps: 154 | Train Loss: 1.872 Vali Loss: 2.186 Vali Acc: 0.335 Test Loss: 2.186 Test Acc: 0.335
Validation loss decreased (-0.326823 --> -0.334528).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8266020
	speed: 0.1876s/iter; left time: 2725.5913s
Epoch: 6 cost time: 6.861422538757324
Epoch: 6, Steps: 154 | Train Loss: 1.860 Vali Loss: 2.243 Vali Acc: 0.321 Test Loss: 2.243 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.7325554
	speed: 0.1941s/iter; left time: 2790.4935s
Epoch: 7 cost time: 7.254228591918945
Epoch: 7, Steps: 154 | Train Loss: 1.822 Vali Loss: 2.352 Vali Acc: 0.338 Test Loss: 2.352 Test Acc: 0.338
Validation loss decreased (-0.334528 --> -0.338176).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5906476
	speed: 0.1950s/iter; left time: 2773.4556s
Epoch: 8 cost time: 7.30314564704895
Epoch: 8, Steps: 154 | Train Loss: 1.718 Vali Loss: 2.338 Vali Acc: 0.352 Test Loss: 2.338 Test Acc: 0.352
Validation loss decreased (-0.338176 --> -0.352369).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0145831
	speed: 0.2041s/iter; left time: 2871.2784s
Epoch: 9 cost time: 6.90376615524292
Epoch: 9, Steps: 154 | Train Loss: 1.759 Vali Loss: 2.541 Vali Acc: 0.343 Test Loss: 2.541 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.8362937
	speed: 0.1949s/iter; left time: 2712.1797s
Epoch: 10 cost time: 8.712568521499634
Epoch: 10, Steps: 154 | Train Loss: 2.058 Vali Loss: 2.697 Vali Acc: 0.350 Test Loss: 2.697 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.9165942
	speed: 0.2237s/iter; left time: 3077.7820s
Epoch: 11 cost time: 7.7484471797943115
Epoch: 11, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.540 Vali Acc: 0.359 Test Loss: 2.540 Test Acc: 0.359
Validation loss decreased (-0.352369 --> -0.359261).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5133504
	speed: 0.1435s/iter; left time: 1951.9506s
Epoch: 12 cost time: 5.0418620109558105
Epoch: 12, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.856 Vali Acc: 0.354 Test Loss: 2.856 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.8962977
	speed: 0.1736s/iter; left time: 2335.3321s
Epoch: 13 cost time: 7.923685073852539
Epoch: 13, Steps: 154 | Train Loss: 1.752 Vali Loss: 2.741 Vali Acc: 0.360 Test Loss: 2.741 Test Acc: 0.360
Validation loss decreased (-0.359261 --> -0.359664).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3095903
	speed: 0.1854s/iter; left time: 2465.7277s
Epoch: 14 cost time: 7.179084300994873
Epoch: 14, Steps: 154 | Train Loss: 1.665 Vali Loss: 3.060 Vali Acc: 0.356 Test Loss: 3.060 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.5347111
	speed: 0.1840s/iter; left time: 2419.0005s
Epoch: 15 cost time: 6.679439306259155
Epoch: 15, Steps: 154 | Train Loss: 1.630 Vali Loss: 3.005 Vali Acc: 0.363 Test Loss: 3.005 Test Acc: 0.363
Validation loss decreased (-0.359664 --> -0.362500).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.2077484
	speed: 0.1839s/iter; left time: 2388.7894s
Epoch: 16 cost time: 7.768813371658325
Epoch: 16, Steps: 154 | Train Loss: 1.529 Vali Loss: 3.154 Vali Acc: 0.365 Test Loss: 3.154 Test Acc: 0.365
Validation loss decreased (-0.362500 --> -0.364526).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.8743181
	speed: 0.1876s/iter; left time: 2407.9679s
Epoch: 17 cost time: 7.295862197875977
Epoch: 17, Steps: 154 | Train Loss: 1.488 Vali Loss: 3.038 Vali Acc: 0.356 Test Loss: 3.038 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.0528622
	speed: 0.1813s/iter; left time: 2299.9796s
Epoch: 18 cost time: 6.825855493545532
Epoch: 18, Steps: 154 | Train Loss: 1.424 Vali Loss: 3.059 Vali Acc: 0.371 Test Loss: 3.059 Test Acc: 0.371
Validation loss decreased (-0.364526 --> -0.370610).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.8742669
	speed: 0.1963s/iter; left time: 2459.6532s
Epoch: 19 cost time: 7.752959728240967
Epoch: 19, Steps: 154 | Train Loss: 1.712 Vali Loss: 3.233 Vali Acc: 0.363 Test Loss: 3.233 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.8656116
	speed: 0.1969s/iter; left time: 2436.5046s
Epoch: 20 cost time: 6.819186210632324
Epoch: 20, Steps: 154 | Train Loss: 1.616 Vali Loss: 3.248 Vali Acc: 0.382 Test Loss: 3.248 Test Acc: 0.382
Validation loss decreased (-0.370610 --> -0.382368).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.6024234
	speed: 0.2026s/iter; left time: 2475.4438s
Epoch: 21 cost time: 8.117397546768188
Epoch: 21, Steps: 154 | Train Loss: 1.521 Vali Loss: 3.524 Vali Acc: 0.372 Test Loss: 3.524 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.9955987
	speed: 0.1868s/iter; left time: 2254.4983s
Epoch: 22 cost time: 7.239205837249756
Epoch: 22, Steps: 154 | Train Loss: 1.370 Vali Loss: 3.724 Vali Acc: 0.380 Test Loss: 3.724 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.1287402
	speed: 0.1852s/iter; left time: 2206.1480s
Epoch: 23 cost time: 7.063354730606079
Epoch: 23, Steps: 154 | Train Loss: 1.207 Vali Loss: 4.089 Vali Acc: 0.181 Test Loss: 4.089 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.6126482
	speed: 0.1888s/iter; left time: 2220.1280s
Epoch: 24 cost time: 7.838811159133911
Epoch: 24, Steps: 154 | Train Loss: 1.228 Vali Loss: 4.252 Vali Acc: 0.364 Test Loss: 4.252 Test Acc: 0.364
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.7963075
	speed: 0.1862s/iter; left time: 2161.2700s
Epoch: 25 cost time: 7.289909839630127
Epoch: 25, Steps: 154 | Train Loss: 1.347 Vali Loss: 3.665 Vali Acc: 0.378 Test Loss: 3.665 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 1.3582336
	speed: 0.1871s/iter; left time: 2142.9317s
Epoch: 26 cost time: 7.08393406867981
Epoch: 26, Steps: 154 | Train Loss: 1.302 Vali Loss: 4.224 Vali Acc: 0.371 Test Loss: 4.224 Test Acc: 0.371
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 1.1590071
	speed: 0.1886s/iter; left time: 2130.4986s
Epoch: 27 cost time: 8.125978469848633
Epoch: 27, Steps: 154 | Train Loss: 1.414 Vali Loss: 4.776 Vali Acc: 0.304 Test Loss: 4.776 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.7131365
	speed: 0.2071s/iter; left time: 2307.7892s
Epoch: 28 cost time: 7.259709596633911
Epoch: 28, Steps: 154 | Train Loss: 1.502 Vali Loss: 4.979 Vali Acc: 0.372 Test Loss: 4.979 Test Acc: 0.372
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 1.0913206
	speed: 0.1954s/iter; left time: 2147.4373s
Epoch: 29 cost time: 6.85697340965271
Epoch: 29, Steps: 154 | Train Loss: 1.474 Vali Loss: 4.650 Vali Acc: 0.135 Test Loss: 4.650 Test Acc: 0.135
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.9453241
	speed: 0.1986s/iter; left time: 2151.4773s
Epoch: 30 cost time: 7.9593353271484375
Epoch: 30, Steps: 154 | Train Loss: 1.339 Vali Loss: 5.574 Vali Acc: 0.129 Test Loss: 5.574 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3824006488240065
model parameter : 1319478
model size : 9.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0207734
	speed: 0.0687s/iter; left time: 1051.0294s
Epoch: 1 cost time: 9.554754495620728
Epoch: 1, Steps: 154 | Train Loss: 2.284 Vali Loss: 2.160 Vali Acc: 0.320 Test Loss: 2.160 Test Acc: 0.320
Validation loss decreased (inf --> -0.319930).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8957133
	speed: 0.1854s/iter; left time: 2808.6425s
Epoch: 2 cost time: 7.428401947021484
Epoch: 2, Steps: 154 | Train Loss: 2.130 Vali Loss: 2.221 Vali Acc: 0.324 Test Loss: 2.221 Test Acc: 0.324
Validation loss decreased (-0.319930 --> -0.323579).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0702856
	speed: 0.1893s/iter; left time: 2838.2707s
Epoch: 3 cost time: 6.858976125717163
Epoch: 3, Steps: 154 | Train Loss: 2.010 Vali Loss: 2.264 Vali Acc: 0.173 Test Loss: 2.264 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.4133799
	speed: 0.1869s/iter; left time: 2773.5507s
Epoch: 4 cost time: 7.901567459106445
Epoch: 4, Steps: 154 | Train Loss: 1.936 Vali Loss: 2.249 Vali Acc: 0.165 Test Loss: 2.249 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.7356237
	speed: 0.1841s/iter; left time: 2703.1729s
Epoch: 5 cost time: 7.02303147315979
Epoch: 5, Steps: 154 | Train Loss: 1.863 Vali Loss: 2.292 Vali Acc: 0.329 Test Loss: 2.292 Test Acc: 0.329
Validation loss decreased (-0.323579 --> -0.328850).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6146673
	speed: 0.1987s/iter; left time: 2887.1539s
Epoch: 6 cost time: 6.8240272998809814
Epoch: 6, Steps: 154 | Train Loss: 1.888 Vali Loss: 2.317 Vali Acc: 0.331 Test Loss: 2.317 Test Acc: 0.331
Validation loss decreased (-0.328850 --> -0.330877).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8435459
	speed: 0.1999s/iter; left time: 2873.4732s
Epoch: 7 cost time: 7.696523666381836
Epoch: 7, Steps: 154 | Train Loss: 1.782 Vali Loss: 2.281 Vali Acc: 0.336 Test Loss: 2.281 Test Acc: 0.336
Validation loss decreased (-0.330877 --> -0.335744).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8435720
	speed: 0.1753s/iter; left time: 2492.8001s
Epoch: 8 cost time: 7.428210973739624
Epoch: 8, Steps: 154 | Train Loss: 1.712 Vali Loss: 2.539 Vali Acc: 0.337 Test Loss: 2.539 Test Acc: 0.337
Validation loss decreased (-0.335744 --> -0.336958).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4541842
	speed: 0.1901s/iter; left time: 2673.8872s
Epoch: 9 cost time: 7.152485609054565
Epoch: 9, Steps: 154 | Train Loss: 1.727 Vali Loss: 2.565 Vali Acc: 0.345 Test Loss: 2.565 Test Acc: 0.345
Validation loss decreased (-0.336958 --> -0.345473).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6924956
	speed: 0.1892s/iter; left time: 2632.8761s
Epoch: 10 cost time: 7.612322568893433
Epoch: 10, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.542 Vali Acc: 0.352 Test Loss: 2.542 Test Acc: 0.352
Validation loss decreased (-0.345473 --> -0.351962).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0710515
	speed: 0.1846s/iter; left time: 2540.8666s
Epoch: 11 cost time: 7.309187889099121
Epoch: 11, Steps: 154 | Train Loss: 1.687 Vali Loss: 2.964 Vali Acc: 0.315 Test Loss: 2.964 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2285273
	speed: 0.1858s/iter; left time: 2528.3450s
Epoch: 12 cost time: 7.297862768173218
Epoch: 12, Steps: 154 | Train Loss: 1.704 Vali Loss: 2.689 Vali Acc: 0.217 Test Loss: 2.689 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.7621076
	speed: 0.1890s/iter; left time: 2542.1716s
Epoch: 13 cost time: 7.56682276725769
Epoch: 13, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.895 Vali Acc: 0.356 Test Loss: 2.895 Test Acc: 0.356
Validation loss decreased (-0.351962 --> -0.356013).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9756456
	speed: 0.1778s/iter; left time: 2364.0645s
Epoch: 14 cost time: 6.838368892669678
Epoch: 14, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.845 Vali Acc: 0.343 Test Loss: 2.845 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6982940
	speed: 0.2012s/iter; left time: 2645.1280s
Epoch: 15 cost time: 7.377119779586792
Epoch: 15, Steps: 154 | Train Loss: 1.714 Vali Loss: 3.161 Vali Acc: 0.364 Test Loss: 3.161 Test Acc: 0.364
Validation loss decreased (-0.356013 --> -0.363715).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.9097109
	speed: 0.2035s/iter; left time: 2643.7771s
Epoch: 16 cost time: 7.6900529861450195
Epoch: 16, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.966 Vali Acc: 0.380 Test Loss: 2.966 Test Acc: 0.380
Validation loss decreased (-0.363715 --> -0.379938).  Saving model ...
	iters: 100, epoch: 17 | loss: 3.5004437
	speed: 0.1900s/iter; left time: 2439.2082s
Epoch: 17 cost time: 7.029259204864502
Epoch: 17, Steps: 154 | Train Loss: 1.547 Vali Loss: 2.936 Vali Acc: 0.358 Test Loss: 2.936 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.3922987
	speed: 0.1877s/iter; left time: 2381.1641s
Epoch: 18 cost time: 7.166987180709839
Epoch: 18, Steps: 154 | Train Loss: 1.439 Vali Loss: 3.325 Vali Acc: 0.367 Test Loss: 3.325 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.8232049
	speed: 0.1846s/iter; left time: 2313.2650s
Epoch: 19 cost time: 7.267187118530273
Epoch: 19, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.866 Vali Acc: 0.203 Test Loss: 2.866 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.5556387
	speed: 0.1808s/iter; left time: 2236.8620s
Epoch: 20 cost time: 7.308912515640259
Epoch: 20, Steps: 154 | Train Loss: 1.371 Vali Loss: 3.603 Vali Acc: 0.195 Test Loss: 3.603 Test Acc: 0.195
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.4747903
	speed: 0.1855s/iter; left time: 2266.9012s
Epoch: 21 cost time: 7.2585344314575195
Epoch: 21, Steps: 154 | Train Loss: 1.971 Vali Loss: 3.361 Vali Acc: 0.368 Test Loss: 3.361 Test Acc: 0.368
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.5578215
	speed: 0.1897s/iter; left time: 2289.6674s
Epoch: 22 cost time: 7.530714511871338
Epoch: 22, Steps: 154 | Train Loss: 1.434 Vali Loss: 3.442 Vali Acc: 0.387 Test Loss: 3.442 Test Acc: 0.387
Validation loss decreased (-0.379938 --> -0.387232).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.2864963
	speed: 0.1809s/iter; left time: 2155.3328s
Epoch: 23 cost time: 7.5847673416137695
Epoch: 23, Steps: 154 | Train Loss: 1.292 Vali Loss: 3.863 Vali Acc: 0.182 Test Loss: 3.863 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.2564827
	speed: 0.2076s/iter; left time: 2441.4059s
Epoch: 24 cost time: 7.354511022567749
Epoch: 24, Steps: 154 | Train Loss: 1.259 Vali Loss: 3.654 Vali Acc: 0.355 Test Loss: 3.654 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.3222312
	speed: 0.1987s/iter; left time: 2305.6100s
Epoch: 25 cost time: 7.796096563339233
Epoch: 25, Steps: 154 | Train Loss: 1.597 Vali Loss: 4.450 Vali Acc: 0.086 Test Loss: 4.450 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.2109926
	speed: 0.1932s/iter; left time: 2212.7909s
Epoch: 26 cost time: 6.803501605987549
Epoch: 26, Steps: 154 | Train Loss: 1.441 Vali Loss: 3.690 Vali Acc: 0.215 Test Loss: 3.690 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.7631590
	speed: 0.1894s/iter; left time: 2139.3100s
Epoch: 27 cost time: 7.5240232944488525
Epoch: 27, Steps: 154 | Train Loss: 1.666 Vali Loss: 4.718 Vali Acc: 0.369 Test Loss: 4.718 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.8823076
	speed: 0.1916s/iter; left time: 2134.9016s
Epoch: 28 cost time: 7.970034837722778
Epoch: 28, Steps: 154 | Train Loss: 1.555 Vali Loss: 4.681 Vali Acc: 0.081 Test Loss: 4.681 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.8652006
	speed: 0.1849s/iter; left time: 2031.8260s
Epoch: 29 cost time: 7.1130359172821045
Epoch: 29, Steps: 154 | Train Loss: 1.335 Vali Loss: 4.106 Vali Acc: 0.363 Test Loss: 4.106 Test Acc: 0.363
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.3679149
	speed: 0.1917s/iter; left time: 2077.3952s
Epoch: 30 cost time: 7.56529426574707
Epoch: 30, Steps: 154 | Train Loss: 1.631 Vali Loss: 4.482 Vali Acc: 0.085 Test Loss: 4.482 Test Acc: 0.085
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 2.5153456
	speed: 0.1965s/iter; left time: 2099.2553s
Epoch: 31 cost time: 7.871654987335205
Epoch: 31, Steps: 154 | Train Loss: 1.354 Vali Loss: 4.692 Vali Acc: 0.333 Test Loss: 4.692 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 1.0054740
	speed: 0.1809s/iter; left time: 1904.0983s
Epoch: 32 cost time: 7.185178995132446
Epoch: 32, Steps: 154 | Train Loss: 2.256 Vali Loss: 4.401 Vali Acc: 0.090 Test Loss: 4.401 Test Acc: 0.090
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3872668288726683
model parameter : 795190
model size : 7.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0377789
	speed: 0.0680s/iter; left time: 1040.0718s
Epoch: 1 cost time: 9.381401777267456
Epoch: 1, Steps: 154 | Train Loss: 2.277 Vali Loss: 2.156 Vali Acc: 0.320 Test Loss: 2.156 Test Acc: 0.320
Validation loss decreased (inf --> -0.320335).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9230527
	speed: 0.1713s/iter; left time: 2595.1762s
Epoch: 2 cost time: 6.847397327423096
Epoch: 2, Steps: 154 | Train Loss: 2.115 Vali Loss: 2.222 Vali Acc: 0.324 Test Loss: 2.222 Test Acc: 0.324
Validation loss decreased (-0.320335 --> -0.323579).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0930815
	speed: 0.1976s/iter; left time: 2963.0952s
Epoch: 3 cost time: 7.438924074172974
Epoch: 3, Steps: 154 | Train Loss: 2.040 Vali Loss: 2.240 Vali Acc: 0.330 Test Loss: 2.240 Test Acc: 0.330
Validation loss decreased (-0.323579 --> -0.329661).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4048493
	speed: 0.1942s/iter; left time: 2880.9952s
Epoch: 4 cost time: 7.568836212158203
Epoch: 4, Steps: 154 | Train Loss: 1.906 Vali Loss: 2.226 Vali Acc: 0.320 Test Loss: 2.226 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7123502
	speed: 0.1894s/iter; left time: 2780.8818s
Epoch: 5 cost time: 7.862872362136841
Epoch: 5, Steps: 154 | Train Loss: 1.891 Vali Loss: 2.287 Vali Acc: 0.328 Test Loss: 2.287 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.6303896
	speed: 0.1934s/iter; left time: 2810.5917s
Epoch: 6 cost time: 7.536729097366333
Epoch: 6, Steps: 154 | Train Loss: 1.894 Vali Loss: 2.288 Vali Acc: 0.334 Test Loss: 2.288 Test Acc: 0.334
Validation loss decreased (-0.329661 --> -0.333716).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8706357
	speed: 0.1892s/iter; left time: 2720.2869s
Epoch: 7 cost time: 7.5463244915008545
Epoch: 7, Steps: 154 | Train Loss: 1.835 Vali Loss: 2.306 Vali Acc: 0.340 Test Loss: 2.306 Test Acc: 0.340
Validation loss decreased (-0.333716 --> -0.340204).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9143524
	speed: 0.1871s/iter; left time: 2660.5561s
Epoch: 8 cost time: 7.527872562408447
Epoch: 8, Steps: 154 | Train Loss: 1.716 Vali Loss: 2.532 Vali Acc: 0.334 Test Loss: 2.532 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4352291
	speed: 0.2085s/iter; left time: 2933.5996s
Epoch: 9 cost time: 7.5327959060668945
Epoch: 9, Steps: 154 | Train Loss: 1.737 Vali Loss: 2.413 Vali Acc: 0.345 Test Loss: 2.413 Test Acc: 0.345
Validation loss decreased (-0.340204 --> -0.345069).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6167108
	speed: 0.1985s/iter; left time: 2761.8908s
Epoch: 10 cost time: 7.433372974395752
Epoch: 10, Steps: 154 | Train Loss: 1.619 Vali Loss: 2.564 Vali Acc: 0.350 Test Loss: 2.564 Test Acc: 0.350
Validation loss decreased (-0.345069 --> -0.349934).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0132506
	speed: 0.2015s/iter; left time: 2773.2510s
Epoch: 11 cost time: 7.730900049209595
Epoch: 11, Steps: 154 | Train Loss: 1.687 Vali Loss: 2.777 Vali Acc: 0.350 Test Loss: 2.777 Test Acc: 0.350
Validation loss decreased (-0.349934 --> -0.350337).  Saving model ...
	iters: 100, epoch: 12 | loss: 5.2234297
	speed: 0.1944s/iter; left time: 2644.6503s
Epoch: 12 cost time: 6.905024766921997
Epoch: 12, Steps: 154 | Train Loss: 1.692 Vali Loss: 2.798 Vali Acc: 0.353 Test Loss: 2.798 Test Acc: 0.353
Validation loss decreased (-0.350337 --> -0.353176).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5098002
	speed: 0.1883s/iter; left time: 2533.4563s
Epoch: 13 cost time: 7.7027647495269775
Epoch: 13, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.803 Vali Acc: 0.354 Test Loss: 2.803 Test Acc: 0.354
Validation loss decreased (-0.353176 --> -0.354392).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2888931
	speed: 0.1944s/iter; left time: 2585.6403s
Epoch: 14 cost time: 8.086711168289185
Epoch: 14, Steps: 154 | Train Loss: 1.610 Vali Loss: 3.025 Vali Acc: 0.357 Test Loss: 3.025 Test Acc: 0.357
Validation loss decreased (-0.354392 --> -0.356823).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.6640885
	speed: 0.1855s/iter; left time: 2438.0859s
Epoch: 15 cost time: 6.739223957061768
Epoch: 15, Steps: 154 | Train Loss: 1.636 Vali Loss: 2.861 Vali Acc: 0.367 Test Loss: 2.861 Test Acc: 0.367
Validation loss decreased (-0.356823 --> -0.366557).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.7537153
	speed: 0.1874s/iter; left time: 2434.5211s
Epoch: 16 cost time: 7.436575889587402
Epoch: 16, Steps: 154 | Train Loss: 1.560 Vali Loss: 3.046 Vali Acc: 0.371 Test Loss: 3.046 Test Acc: 0.371
Validation loss decreased (-0.366557 --> -0.370610).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.8908392
	speed: 0.1864s/iter; left time: 2392.7038s
Epoch: 17 cost time: 7.777963638305664
Epoch: 17, Steps: 154 | Train Loss: 1.552 Vali Loss: 3.092 Vali Acc: 0.357 Test Loss: 3.092 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.2931743
	speed: 0.2051s/iter; left time: 2600.6508s
Epoch: 18 cost time: 7.2469398975372314
Epoch: 18, Steps: 154 | Train Loss: 1.460 Vali Loss: 3.281 Vali Acc: 0.366 Test Loss: 3.281 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.4949920
	speed: 0.2011s/iter; left time: 2519.8562s
Epoch: 19 cost time: 7.63408088684082
Epoch: 19, Steps: 154 | Train Loss: 1.570 Vali Loss: 3.049 Vali Acc: 0.204 Test Loss: 3.049 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.2359736
	speed: 0.2097s/iter; left time: 2594.9958s
Epoch: 20 cost time: 8.41722297668457
Epoch: 20, Steps: 154 | Train Loss: 1.375 Vali Loss: 3.322 Vali Acc: 0.373 Test Loss: 3.322 Test Acc: 0.373
Validation loss decreased (-0.370610 --> -0.373041).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.4437673
	speed: 0.1919s/iter; left time: 2345.3635s
Epoch: 21 cost time: 7.406016111373901
Epoch: 21, Steps: 154 | Train Loss: 1.531 Vali Loss: 3.264 Vali Acc: 0.368 Test Loss: 3.264 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.1872087
	speed: 0.1959s/iter; left time: 2363.9228s
Epoch: 22 cost time: 7.486398458480835
Epoch: 22, Steps: 154 | Train Loss: 1.712 Vali Loss: 3.433 Vali Acc: 0.380 Test Loss: 3.433 Test Acc: 0.380
Validation loss decreased (-0.373041 --> -0.379528).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.0516298
	speed: 0.1904s/iter; left time: 2267.9618s
Epoch: 23 cost time: 7.683458566665649
Epoch: 23, Steps: 154 | Train Loss: 1.354 Vali Loss: 3.897 Vali Acc: 0.171 Test Loss: 3.897 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.9375018
	speed: 0.1871s/iter; left time: 2200.2612s
Epoch: 24 cost time: 7.347500324249268
Epoch: 24, Steps: 154 | Train Loss: 1.311 Vali Loss: 3.645 Vali Acc: 0.378 Test Loss: 3.645 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.7754395
	speed: 0.1927s/iter; left time: 2235.8538s
Epoch: 25 cost time: 7.3280744552612305
Epoch: 25, Steps: 154 | Train Loss: 1.341 Vali Loss: 3.856 Vali Acc: 0.163 Test Loss: 3.856 Test Acc: 0.163
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.4291918
	speed: 0.1860s/iter; left time: 2129.7829s
Epoch: 26 cost time: 7.326430797576904
Epoch: 26, Steps: 154 | Train Loss: 1.224 Vali Loss: 3.667 Vali Acc: 0.378 Test Loss: 3.667 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.8482815
	speed: 0.1880s/iter; left time: 2123.3191s
Epoch: 27 cost time: 6.350780487060547
Epoch: 27, Steps: 154 | Train Loss: 1.429 Vali Loss: 4.200 Vali Acc: 0.362 Test Loss: 4.200 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.7313336
	speed: 0.1902s/iter; left time: 2119.2919s
Epoch: 28 cost time: 7.463758707046509
Epoch: 28, Steps: 154 | Train Loss: 1.363 Vali Loss: 4.486 Vali Acc: 0.079 Test Loss: 4.486 Test Acc: 0.079
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 1.9254537
	speed: 0.2079s/iter; left time: 2285.0640s
Epoch: 29 cost time: 8.312758207321167
Epoch: 29, Steps: 154 | Train Loss: 1.202 Vali Loss: 4.112 Vali Acc: 0.304 Test Loss: 4.112 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.3744309
	speed: 0.1871s/iter; left time: 2026.8534s
Epoch: 30 cost time: 7.00292706489563
Epoch: 30, Steps: 154 | Train Loss: 1.275 Vali Loss: 4.961 Vali Acc: 0.083 Test Loss: 4.961 Test Acc: 0.083
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 1.1191685
	speed: 0.1898s/iter; left time: 2027.4356s
Epoch: 31 cost time: 7.202193260192871
Epoch: 31, Steps: 154 | Train Loss: 1.181 Vali Loss: 4.415 Vali Acc: 0.152 Test Loss: 4.415 Test Acc: 0.152
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 1.2508893
	speed: 0.1901s/iter; left time: 2001.1455s
Epoch: 32 cost time: 7.6129772663116455
Epoch: 32, Steps: 154 | Train Loss: 1.213 Vali Loss: 4.480 Vali Acc: 0.355 Test Loss: 4.480 Test Acc: 0.355
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3795620437956204
model parameter : 795190
model size : 7.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0425003
	speed: 0.0669s/iter; left time: 1023.4321s
Epoch: 1 cost time: 9.208194494247437
Epoch: 1, Steps: 154 | Train Loss: 2.265 Vali Loss: 2.158 Vali Acc: 0.320 Test Loss: 2.158 Test Acc: 0.320
Validation loss decreased (inf --> -0.320335).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8604045
	speed: 0.1886s/iter; left time: 2857.2296s
Epoch: 2 cost time: 7.660090684890747
Epoch: 2, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.198 Vali Acc: 0.324 Test Loss: 2.198 Test Acc: 0.324
Validation loss decreased (-0.320335 --> -0.323985).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0946631
	speed: 0.2032s/iter; left time: 3047.1359s
Epoch: 3 cost time: 7.750888824462891
Epoch: 3, Steps: 154 | Train Loss: 1.998 Vali Loss: 2.200 Vali Acc: 0.328 Test Loss: 2.200 Test Acc: 0.328
Validation loss decreased (-0.323985 --> -0.328445).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4680450
	speed: 0.2045s/iter; left time: 3035.2731s
Epoch: 4 cost time: 7.54587197303772
Epoch: 4, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.255 Vali Acc: 0.172 Test Loss: 2.255 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7455666
	speed: 0.1942s/iter; left time: 2851.3996s
Epoch: 5 cost time: 6.069665431976318
Epoch: 5, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.220 Vali Acc: 0.330 Test Loss: 2.220 Test Acc: 0.330
Validation loss decreased (-0.328445 --> -0.329661).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6010326
	speed: 0.1533s/iter; left time: 2227.0259s
Epoch: 6 cost time: 7.012090444564819
Epoch: 6, Steps: 154 | Train Loss: 1.858 Vali Loss: 2.220 Vali Acc: 0.335 Test Loss: 2.220 Test Acc: 0.335
Validation loss decreased (-0.329661 --> -0.334933).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8569859
	speed: 0.1952s/iter; left time: 2806.9607s
Epoch: 7 cost time: 7.437548637390137
Epoch: 7, Steps: 154 | Train Loss: 1.785 Vali Loss: 2.325 Vali Acc: 0.344 Test Loss: 2.325 Test Acc: 0.344
Validation loss decreased (-0.334933 --> -0.344259).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0195115
	speed: 0.1902s/iter; left time: 2704.7060s
Epoch: 8 cost time: 7.699180841445923
Epoch: 8, Steps: 154 | Train Loss: 1.718 Vali Loss: 2.522 Vali Acc: 0.341 Test Loss: 2.522 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4006951
	speed: 0.1894s/iter; left time: 2664.9713s
Epoch: 9 cost time: 7.378598690032959
Epoch: 9, Steps: 154 | Train Loss: 1.727 Vali Loss: 2.555 Vali Acc: 0.345 Test Loss: 2.555 Test Acc: 0.345
Validation loss decreased (-0.344259 --> -0.345473).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4650575
	speed: 0.1938s/iter; left time: 2696.8344s
Epoch: 10 cost time: 7.204524278640747
Epoch: 10, Steps: 154 | Train Loss: 1.697 Vali Loss: 2.589 Vali Acc: 0.348 Test Loss: 2.589 Test Acc: 0.348
Validation loss decreased (-0.345473 --> -0.347906).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.8472160
	speed: 0.1867s/iter; left time: 2569.3326s
Epoch: 11 cost time: 7.703339576721191
Epoch: 11, Steps: 154 | Train Loss: 1.625 Vali Loss: 2.856 Vali Acc: 0.350 Test Loss: 2.856 Test Acc: 0.350
Validation loss decreased (-0.347906 --> -0.350336).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2507343
	speed: 0.2085s/iter; left time: 2836.6392s
Epoch: 12 cost time: 7.519636631011963
Epoch: 12, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.717 Vali Acc: 0.210 Test Loss: 2.717 Test Acc: 0.210
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5768491
	speed: 0.2073s/iter; left time: 2788.3831s
Epoch: 13 cost time: 7.096383333206177
Epoch: 13, Steps: 154 | Train Loss: 1.566 Vali Loss: 3.225 Vali Acc: 0.347 Test Loss: 3.225 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2347385
	speed: 0.2041s/iter; left time: 2713.8954s
Epoch: 14 cost time: 8.141490936279297
Epoch: 14, Steps: 154 | Train Loss: 1.622 Vali Loss: 3.288 Vali Acc: 0.352 Test Loss: 3.288 Test Acc: 0.352
Validation loss decreased (-0.350336 --> -0.351549).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.5705060
	speed: 0.2105s/iter; left time: 2766.9317s
Epoch: 15 cost time: 7.530876159667969
Epoch: 15, Steps: 154 | Train Loss: 1.560 Vali Loss: 3.070 Vali Acc: 0.364 Test Loss: 3.070 Test Acc: 0.364
Validation loss decreased (-0.351549 --> -0.363716).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.6450055
	speed: 0.1934s/iter; left time: 2512.8432s
Epoch: 16 cost time: 7.882283926010132
Epoch: 16, Steps: 154 | Train Loss: 1.680 Vali Loss: 3.004 Vali Acc: 0.369 Test Loss: 3.004 Test Acc: 0.369
Validation loss decreased (-0.363716 --> -0.368989).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.8190296
	speed: 0.1950s/iter; left time: 2503.5702s
Epoch: 17 cost time: 7.850939989089966
Epoch: 17, Steps: 154 | Train Loss: 1.635 Vali Loss: 2.993 Vali Acc: 0.365 Test Loss: 2.993 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.5265882
	speed: 0.1991s/iter; left time: 2525.6312s
Epoch: 18 cost time: 7.661347150802612
Epoch: 18, Steps: 154 | Train Loss: 1.467 Vali Loss: 3.031 Vali Acc: 0.367 Test Loss: 3.031 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.8851223
	speed: 0.1922s/iter; left time: 2408.0817s
Epoch: 19 cost time: 7.938668251037598
Epoch: 19, Steps: 154 | Train Loss: 1.627 Vali Loss: 3.033 Vali Acc: 0.226 Test Loss: 3.033 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.7380170
	speed: 0.1935s/iter; left time: 2395.1143s
Epoch: 20 cost time: 7.542812824249268
Epoch: 20, Steps: 154 | Train Loss: 1.430 Vali Loss: 3.554 Vali Acc: 0.367 Test Loss: 3.554 Test Acc: 0.367
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.5600481
	speed: 0.2024s/iter; left time: 2474.1265s
Epoch: 21 cost time: 7.544105052947998
Epoch: 21, Steps: 154 | Train Loss: 1.488 Vali Loss: 3.489 Vali Acc: 0.365 Test Loss: 3.489 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.2878828
	speed: 0.1989s/iter; left time: 2399.9163s
Epoch: 22 cost time: 7.940851926803589
Epoch: 22, Steps: 154 | Train Loss: 1.480 Vali Loss: 3.462 Vali Acc: 0.367 Test Loss: 3.462 Test Acc: 0.367
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.3642430
	speed: 0.2129s/iter; left time: 2535.8403s
Epoch: 23 cost time: 7.541942596435547
Epoch: 23, Steps: 154 | Train Loss: 1.232 Vali Loss: 4.494 Vali Acc: 0.202 Test Loss: 4.494 Test Acc: 0.202
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.5719919
	speed: 0.2001s/iter; left time: 2352.9489s
Epoch: 24 cost time: 7.594115972518921
Epoch: 24, Steps: 154 | Train Loss: 1.437 Vali Loss: 4.140 Vali Acc: 0.262 Test Loss: 4.140 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 2.4920459
	speed: 0.1931s/iter; left time: 2240.7040s
Epoch: 25 cost time: 7.632568359375
Epoch: 25, Steps: 154 | Train Loss: 1.619 Vali Loss: 4.361 Vali Acc: 0.213 Test Loss: 4.361 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.1214615
	speed: 0.1907s/iter; left time: 2183.2190s
Epoch: 26 cost time: 7.566214323043823
Epoch: 26, Steps: 154 | Train Loss: 1.360 Vali Loss: 4.323 Vali Acc: 0.378 Test Loss: 4.323 Test Acc: 0.378
Validation loss decreased (-0.368989 --> -0.377897).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.7445561
	speed: 0.1903s/iter; left time: 2149.8789s
Epoch: 27 cost time: 7.4985620975494385
Epoch: 27, Steps: 154 | Train Loss: 1.392 Vali Loss: 4.361 Vali Acc: 0.366 Test Loss: 4.361 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.9739823
	speed: 0.1975s/iter; left time: 2200.7069s
Epoch: 28 cost time: 7.641901731491089
Epoch: 28, Steps: 154 | Train Loss: 1.222 Vali Loss: 6.140 Vali Acc: 0.083 Test Loss: 6.140 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.7961091
	speed: 0.2008s/iter; left time: 2206.2048s
Epoch: 29 cost time: 8.094805240631104
Epoch: 29, Steps: 154 | Train Loss: 1.247 Vali Loss: 4.659 Vali Acc: 0.253 Test Loss: 4.659 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.3174787
	speed: 0.2027s/iter; left time: 2196.3778s
Epoch: 30 cost time: 8.028075695037842
Epoch: 30, Steps: 154 | Train Loss: 1.395 Vali Loss: 4.486 Vali Acc: 0.101 Test Loss: 4.486 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 1.3219310
	speed: 0.2180s/iter; left time: 2328.5109s
Epoch: 31 cost time: 7.784661769866943
Epoch: 31, Steps: 154 | Train Loss: 1.526 Vali Loss: 4.871 Vali Acc: 0.354 Test Loss: 4.871 Test Acc: 0.354
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.7737600
	speed: 0.2054s/iter; left time: 2161.9667s
Epoch: 32 cost time: 8.25782322883606
Epoch: 32, Steps: 154 | Train Loss: 1.818 Vali Loss: 4.654 Vali Acc: 0.208 Test Loss: 4.654 Test Acc: 0.208
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.6035178
	speed: 0.2096s/iter; left time: 2174.3573s
Epoch: 33 cost time: 7.520977020263672
Epoch: 33, Steps: 154 | Train Loss: 1.327 Vali Loss: 5.568 Vali Acc: 0.141 Test Loss: 5.568 Test Acc: 0.141
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 1.0471864
	speed: 0.1957s/iter; left time: 1999.6025s
Epoch: 34 cost time: 7.753185033798218
Epoch: 34, Steps: 154 | Train Loss: 1.237 Vali Loss: 5.182 Vali Acc: 0.225 Test Loss: 5.182 Test Acc: 0.225
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 1.3469988
	speed: 0.1804s/iter; left time: 1815.8963s
Epoch: 35 cost time: 6.983678579330444
Epoch: 35, Steps: 154 | Train Loss: 1.547 Vali Loss: 5.232 Vali Acc: 0.103 Test Loss: 5.232 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 1.3681769
	speed: 0.1951s/iter; left time: 1933.8909s
Epoch: 36 cost time: 7.3919079303741455
Epoch: 36, Steps: 154 | Train Loss: 1.335 Vali Loss: 5.233 Vali Acc: 0.127 Test Loss: 5.233 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37793998377939986
model parameter : 795190
model size : 7.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0537002
	speed: 0.0612s/iter; left time: 936.1224s
Epoch: 1 cost time: 8.852801084518433
Epoch: 1, Steps: 154 | Train Loss: 2.242 Vali Loss: 2.163 Vali Acc: 0.319 Test Loss: 2.163 Test Acc: 0.319
Validation loss decreased (inf --> -0.319119).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8526372
	speed: 0.1988s/iter; left time: 3011.4652s
Epoch: 2 cost time: 7.737802982330322
Epoch: 2, Steps: 154 | Train Loss: 2.100 Vali Loss: 2.230 Vali Acc: 0.323 Test Loss: 2.230 Test Acc: 0.323
Validation loss decreased (-0.319119 --> -0.322768).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1067696
	speed: 0.1986s/iter; left time: 2977.0035s
Epoch: 3 cost time: 7.3175129890441895
Epoch: 3, Steps: 154 | Train Loss: 1.994 Vali Loss: 2.197 Vali Acc: 0.328 Test Loss: 2.197 Test Acc: 0.328
Validation loss decreased (-0.322768 --> -0.328445).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4203553
	speed: 0.2033s/iter; left time: 3016.7855s
Epoch: 4 cost time: 7.305875301361084
Epoch: 4, Steps: 154 | Train Loss: 1.935 Vali Loss: 2.191 Vali Acc: 0.152 Test Loss: 2.191 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7456492
	speed: 0.2105s/iter; left time: 3090.9554s
Epoch: 5 cost time: 8.36118769645691
Epoch: 5, Steps: 154 | Train Loss: 1.840 Vali Loss: 2.220 Vali Acc: 0.332 Test Loss: 2.220 Test Acc: 0.332
Validation loss decreased (-0.328445 --> -0.332095).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8460931
	speed: 0.1889s/iter; left time: 2745.1994s
Epoch: 6 cost time: 7.077986240386963
Epoch: 6, Steps: 154 | Train Loss: 1.891 Vali Loss: 2.208 Vali Acc: 0.343 Test Loss: 2.208 Test Acc: 0.343
Validation loss decreased (-0.332095 --> -0.343449).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8182110
	speed: 0.1958s/iter; left time: 2815.4607s
Epoch: 7 cost time: 7.7662529945373535
Epoch: 7, Steps: 154 | Train Loss: 1.795 Vali Loss: 2.311 Vali Acc: 0.346 Test Loss: 2.311 Test Acc: 0.346
Validation loss decreased (-0.343449 --> -0.345881).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0880151
	speed: 0.1910s/iter; left time: 2716.4857s
Epoch: 8 cost time: 7.5917723178863525
Epoch: 8, Steps: 154 | Train Loss: 1.702 Vali Loss: 2.588 Vali Acc: 0.342 Test Loss: 2.588 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3628533
	speed: 0.1896s/iter; left time: 2667.2750s
Epoch: 9 cost time: 7.4469006061553955
Epoch: 9, Steps: 154 | Train Loss: 1.724 Vali Loss: 2.399 Vali Acc: 0.350 Test Loss: 2.399 Test Acc: 0.350
Validation loss decreased (-0.345881 --> -0.349935).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3320067
	speed: 0.1966s/iter; left time: 2735.1466s
Epoch: 10 cost time: 8.252877712249756
Epoch: 10, Steps: 154 | Train Loss: 1.649 Vali Loss: 2.527 Vali Acc: 0.351 Test Loss: 2.527 Test Acc: 0.351
Validation loss decreased (-0.349935 --> -0.351151).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.9706660
	speed: 0.1894s/iter; left time: 2606.0124s
Epoch: 11 cost time: 6.993071556091309
Epoch: 11, Steps: 154 | Train Loss: 1.761 Vali Loss: 2.665 Vali Acc: 0.349 Test Loss: 2.665 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 10.2138538
	speed: 0.2034s/iter; left time: 2767.4797s
Epoch: 12 cost time: 7.546482563018799
Epoch: 12, Steps: 154 | Train Loss: 1.758 Vali Loss: 2.461 Vali Acc: 0.367 Test Loss: 2.461 Test Acc: 0.367
Validation loss decreased (-0.351151 --> -0.367372).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4443226
	speed: 0.2074s/iter; left time: 2790.0944s
Epoch: 13 cost time: 8.284830331802368
Epoch: 13, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.933 Vali Acc: 0.232 Test Loss: 2.933 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1148717
	speed: 0.2021s/iter; left time: 2687.5811s
Epoch: 14 cost time: 6.620964288711548
Epoch: 14, Steps: 154 | Train Loss: 1.533 Vali Loss: 2.722 Vali Acc: 0.368 Test Loss: 2.722 Test Acc: 0.368
Validation loss decreased (-0.367372 --> -0.367775).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.5353854
	speed: 0.1998s/iter; left time: 2625.7803s
Epoch: 15 cost time: 7.675363779067993
Epoch: 15, Steps: 154 | Train Loss: 1.758 Vali Loss: 2.902 Vali Acc: 0.370 Test Loss: 2.902 Test Acc: 0.370
Validation loss decreased (-0.367775 --> -0.369801).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.6897030
	speed: 0.1858s/iter; left time: 2413.4372s
Epoch: 16 cost time: 7.514456510543823
Epoch: 16, Steps: 154 | Train Loss: 1.761 Vali Loss: 3.030 Vali Acc: 0.389 Test Loss: 3.030 Test Acc: 0.389
Validation loss decreased (-0.369801 --> -0.389264).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0625417
	speed: 0.1890s/iter; left time: 2425.6696s
Epoch: 17 cost time: 7.05863356590271
Epoch: 17, Steps: 154 | Train Loss: 1.557 Vali Loss: 3.182 Vali Acc: 0.367 Test Loss: 3.182 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.4096133
	speed: 0.1936s/iter; left time: 2454.8700s
Epoch: 18 cost time: 8.012610673904419
Epoch: 18, Steps: 154 | Train Loss: 1.468 Vali Loss: 3.354 Vali Acc: 0.362 Test Loss: 3.354 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.6112808
	speed: 0.1888s/iter; left time: 2366.0238s
Epoch: 19 cost time: 7.1285881996154785
Epoch: 19, Steps: 154 | Train Loss: 1.611 Vali Loss: 3.213 Vali Acc: 0.225 Test Loss: 3.213 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.2202754
	speed: 0.1886s/iter; left time: 2333.8187s
Epoch: 20 cost time: 7.216076135635376
Epoch: 20, Steps: 154 | Train Loss: 1.345 Vali Loss: 3.735 Vali Acc: 0.363 Test Loss: 3.735 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.2687752
	speed: 0.2067s/iter; left time: 2525.8362s
Epoch: 21 cost time: 8.487735271453857
Epoch: 21, Steps: 154 | Train Loss: 1.357 Vali Loss: 2.991 Vali Acc: 0.371 Test Loss: 2.991 Test Acc: 0.371
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.2311748
	speed: 0.2060s/iter; left time: 2485.8304s
Epoch: 22 cost time: 6.779529571533203
Epoch: 22, Steps: 154 | Train Loss: 1.478 Vali Loss: 3.072 Vali Acc: 0.381 Test Loss: 3.072 Test Acc: 0.381
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.6023614
	speed: 0.2112s/iter; left time: 2515.7092s
Epoch: 23 cost time: 8.8378324508667
Epoch: 23, Steps: 154 | Train Loss: 1.371 Vali Loss: 3.463 Vali Acc: 0.382 Test Loss: 3.463 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.5552365
	speed: 0.2032s/iter; left time: 2389.2548s
Epoch: 24 cost time: 7.615046739578247
Epoch: 24, Steps: 154 | Train Loss: 1.280 Vali Loss: 3.919 Vali Acc: 0.364 Test Loss: 3.919 Test Acc: 0.364
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.5784479
	speed: 0.1664s/iter; left time: 1931.0662s
Epoch: 25 cost time: 6.03408145904541
Epoch: 25, Steps: 154 | Train Loss: 1.830 Vali Loss: 4.000 Vali Acc: 0.378 Test Loss: 4.000 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.4044091
	speed: 0.1754s/iter; left time: 2008.1835s
Epoch: 26 cost time: 7.994079828262329
Epoch: 26, Steps: 154 | Train Loss: 1.293 Vali Loss: 3.910 Vali Acc: 0.382 Test Loss: 3.910 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38929440389294406
model parameter : 795190
model size : 7.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1207578
	speed: 0.0643s/iter; left time: 984.1142s
Epoch: 1 cost time: 9.215169429779053
Epoch: 1, Steps: 154 | Train Loss: 2.240 Vali Loss: 2.218 Vali Acc: 0.320 Test Loss: 2.218 Test Acc: 0.320
Validation loss decreased (inf --> -0.319524).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6006298
	speed: 0.1953s/iter; left time: 2958.2498s
Epoch: 2 cost time: 7.992417573928833
Epoch: 2, Steps: 154 | Train Loss: 2.114 Vali Loss: 2.281 Vali Acc: 0.324 Test Loss: 2.281 Test Acc: 0.324
Validation loss decreased (-0.319524 --> -0.324389).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7666199
	speed: 0.1964s/iter; left time: 2944.1655s
Epoch: 3 cost time: 6.894901752471924
Epoch: 3, Steps: 154 | Train Loss: 1.981 Vali Loss: 2.214 Vali Acc: 0.326 Test Loss: 2.214 Test Acc: 0.326
Validation loss decreased (-0.324389 --> -0.325606).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6596258
	speed: 0.2002s/iter; left time: 2971.1620s
Epoch: 4 cost time: 7.265411138534546
Epoch: 4, Steps: 154 | Train Loss: 1.976 Vali Loss: 2.221 Vali Acc: 0.325 Test Loss: 2.221 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3173881
	speed: 0.2050s/iter; left time: 3010.6684s
Epoch: 5 cost time: 8.031774044036865
Epoch: 5, Steps: 154 | Train Loss: 1.895 Vali Loss: 2.185 Vali Acc: 0.334 Test Loss: 2.185 Test Acc: 0.334
Validation loss decreased (-0.325606 --> -0.334123).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5800009
	speed: 0.2021s/iter; left time: 2936.0929s
Epoch: 6 cost time: 6.941310882568359
Epoch: 6, Steps: 154 | Train Loss: 1.778 Vali Loss: 2.289 Vali Acc: 0.328 Test Loss: 2.289 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5779506
	speed: 0.1912s/iter; left time: 2748.7284s
Epoch: 7 cost time: 7.554962396621704
Epoch: 7, Steps: 154 | Train Loss: 1.833 Vali Loss: 2.252 Vali Acc: 0.336 Test Loss: 2.252 Test Acc: 0.336
Validation loss decreased (-0.334123 --> -0.336149).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2022479
	speed: 0.1877s/iter; left time: 2669.1975s
Epoch: 8 cost time: 7.621316432952881
Epoch: 8, Steps: 154 | Train Loss: 1.771 Vali Loss: 2.456 Vali Acc: 0.341 Test Loss: 2.456 Test Acc: 0.341
Validation loss decreased (-0.336149 --> -0.340608).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2653620
	speed: 0.1930s/iter; left time: 2715.5405s
Epoch: 9 cost time: 7.426935911178589
Epoch: 9, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.258 Vali Acc: 0.349 Test Loss: 2.258 Test Acc: 0.349
Validation loss decreased (-0.340608 --> -0.348720).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8201925
	speed: 0.1981s/iter; left time: 2755.9723s
Epoch: 10 cost time: 7.992210149765015
Epoch: 10, Steps: 154 | Train Loss: 1.699 Vali Loss: 2.565 Vali Acc: 0.348 Test Loss: 2.565 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.8129406
	speed: 0.1859s/iter; left time: 2557.6651s
Epoch: 11 cost time: 7.326401472091675
Epoch: 11, Steps: 154 | Train Loss: 1.797 Vali Loss: 2.690 Vali Acc: 0.354 Test Loss: 2.690 Test Acc: 0.354
Validation loss decreased (-0.348720 --> -0.353988).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9267064
	speed: 0.1996s/iter; left time: 2716.6282s
Epoch: 12 cost time: 7.63681173324585
Epoch: 12, Steps: 154 | Train Loss: 1.940 Vali Loss: 2.772 Vali Acc: 0.351 Test Loss: 2.772 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6267046
	speed: 0.2168s/iter; left time: 2916.6872s
Epoch: 13 cost time: 8.294389486312866
Epoch: 13, Steps: 154 | Train Loss: 1.661 Vali Loss: 2.602 Vali Acc: 0.361 Test Loss: 2.602 Test Acc: 0.361
Validation loss decreased (-0.353988 --> -0.360882).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2636553
	speed: 0.1969s/iter; left time: 2617.9377s
Epoch: 14 cost time: 7.084276437759399
Epoch: 14, Steps: 154 | Train Loss: 1.565 Vali Loss: 3.119 Vali Acc: 0.195 Test Loss: 3.119 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9260216
	speed: 0.2088s/iter; left time: 2744.1799s
Epoch: 15 cost time: 7.271142244338989
Epoch: 15, Steps: 154 | Train Loss: 1.711 Vali Loss: 3.107 Vali Acc: 0.262 Test Loss: 3.107 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.2127401
	speed: 0.1920s/iter; left time: 2493.6393s
Epoch: 16 cost time: 7.951423406600952
Epoch: 16, Steps: 154 | Train Loss: 1.706 Vali Loss: 2.970 Vali Acc: 0.324 Test Loss: 2.970 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.7377205
	speed: 0.1853s/iter; left time: 2378.4553s
Epoch: 17 cost time: 7.260988473892212
Epoch: 17, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.914 Vali Acc: 0.367 Test Loss: 2.914 Test Acc: 0.367
Validation loss decreased (-0.360882 --> -0.366962).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.9939959
	speed: 0.1953s/iter; left time: 2476.6867s
Epoch: 18 cost time: 7.421338081359863
Epoch: 18, Steps: 154 | Train Loss: 1.595 Vali Loss: 2.910 Vali Acc: 0.217 Test Loss: 2.910 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.3669530
	speed: 0.1929s/iter; left time: 2416.7924s
Epoch: 19 cost time: 7.867902994155884
Epoch: 19, Steps: 154 | Train Loss: 1.449 Vali Loss: 3.504 Vali Acc: 0.365 Test Loss: 3.504 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.6413693
	speed: 0.1873s/iter; left time: 2317.2576s
Epoch: 20 cost time: 6.6889121532440186
Epoch: 20, Steps: 154 | Train Loss: 1.405 Vali Loss: 3.600 Vali Acc: 0.183 Test Loss: 3.600 Test Acc: 0.183
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.0879017
	speed: 0.1950s/iter; left time: 2383.1944s
Epoch: 21 cost time: 7.2748894691467285
Epoch: 21, Steps: 154 | Train Loss: 1.428 Vali Loss: 3.177 Vali Acc: 0.365 Test Loss: 3.177 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.7075788
	speed: 0.2074s/iter; left time: 2503.2642s
Epoch: 22 cost time: 8.322936058044434
Epoch: 22, Steps: 154 | Train Loss: 1.478 Vali Loss: 3.883 Vali Acc: 0.357 Test Loss: 3.883 Test Acc: 0.357
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.3807918
	speed: 0.2025s/iter; left time: 2412.4713s
Epoch: 23 cost time: 6.94562554359436
Epoch: 23, Steps: 154 | Train Loss: 1.378 Vali Loss: 3.887 Vali Acc: 0.367 Test Loss: 3.887 Test Acc: 0.367
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.6012324
	speed: 0.2018s/iter; left time: 2372.8396s
Epoch: 24 cost time: 7.538231611251831
Epoch: 24, Steps: 154 | Train Loss: 1.439 Vali Loss: 3.458 Vali Acc: 0.385 Test Loss: 3.458 Test Acc: 0.385
Validation loss decreased (-0.366962 --> -0.384799).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.9207540
	speed: 0.1916s/iter; left time: 2223.8778s
Epoch: 25 cost time: 8.089728116989136
Epoch: 25, Steps: 154 | Train Loss: 1.559 Vali Loss: 4.002 Vali Acc: 0.385 Test Loss: 4.002 Test Acc: 0.385
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 2.4554210
	speed: 0.1842s/iter; left time: 2108.9637s
Epoch: 26 cost time: 7.370707988739014
Epoch: 26, Steps: 154 | Train Loss: 1.450 Vali Loss: 4.865 Vali Acc: 0.203 Test Loss: 4.865 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.6388444
	speed: 0.1925s/iter; left time: 2174.5159s
Epoch: 27 cost time: 7.5869221687316895
Epoch: 27, Steps: 154 | Train Loss: 1.453 Vali Loss: 4.417 Vali Acc: 0.364 Test Loss: 4.417 Test Acc: 0.364
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.7757584
	speed: 0.1897s/iter; left time: 2113.6939s
Epoch: 28 cost time: 7.9473607540130615
Epoch: 28, Steps: 154 | Train Loss: 1.428 Vali Loss: 3.730 Vali Acc: 0.335 Test Loss: 3.730 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 1.0439011
	speed: 0.1868s/iter; left time: 2052.9908s
Epoch: 29 cost time: 7.320409774780273
Epoch: 29, Steps: 154 | Train Loss: 1.303 Vali Loss: 4.260 Vali Acc: 0.265 Test Loss: 4.260 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.7269841
	speed: 0.1990s/iter; left time: 2156.4633s
Epoch: 30 cost time: 7.491238832473755
Epoch: 30, Steps: 154 | Train Loss: 1.273 Vali Loss: 4.837 Vali Acc: 0.204 Test Loss: 4.837 Test Acc: 0.204
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 1.0834657
	speed: 0.2010s/iter; left time: 2146.7867s
Epoch: 31 cost time: 7.511455297470093
Epoch: 31, Steps: 154 | Train Loss: 1.292 Vali Loss: 4.542 Vali Acc: 0.180 Test Loss: 4.542 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 9.8313093
	speed: 0.2034s/iter; left time: 2141.3224s
Epoch: 32 cost time: 7.299903631210327
Epoch: 32, Steps: 154 | Train Loss: 1.207 Vali Loss: 5.106 Vali Acc: 0.219 Test Loss: 5.106 Test Acc: 0.219
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 1.1562924
	speed: 0.2053s/iter; left time: 2129.0955s
Epoch: 33 cost time: 7.066957712173462
Epoch: 33, Steps: 154 | Train Loss: 1.203 Vali Loss: 4.815 Vali Acc: 0.238 Test Loss: 4.815 Test Acc: 0.238
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 1.0353571
	speed: 0.1881s/iter; left time: 1922.6316s
Epoch: 34 cost time: 7.764224052429199
Epoch: 34, Steps: 154 | Train Loss: 1.189 Vali Loss: 5.156 Vali Acc: 0.223 Test Loss: 5.156 Test Acc: 0.223
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3848337388483374
model parameter : 533046
model size : 6.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1224992
	speed: 0.0678s/iter; left time: 1038.0242s
Epoch: 1 cost time: 9.159980535507202
Epoch: 1, Steps: 154 | Train Loss: 2.233 Vali Loss: 2.219 Vali Acc: 0.320 Test Loss: 2.219 Test Acc: 0.320
Validation loss decreased (inf --> -0.319929).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5975398
	speed: 0.1816s/iter; left time: 2751.0259s
Epoch: 2 cost time: 7.210514307022095
Epoch: 2, Steps: 154 | Train Loss: 2.100 Vali Loss: 2.253 Vali Acc: 0.324 Test Loss: 2.253 Test Acc: 0.324
Validation loss decreased (-0.319929 --> -0.324389).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7566795
	speed: 0.1924s/iter; left time: 2884.0003s
Epoch: 3 cost time: 7.278136253356934
Epoch: 3, Steps: 154 | Train Loss: 1.967 Vali Loss: 2.156 Vali Acc: 0.326 Test Loss: 2.156 Test Acc: 0.326
Validation loss decreased (-0.324389 --> -0.326418).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6775590
	speed: 0.1977s/iter; left time: 2933.0919s
Epoch: 4 cost time: 8.302183866500854
Epoch: 4, Steps: 154 | Train Loss: 1.912 Vali Loss: 2.241 Vali Acc: 0.330 Test Loss: 2.241 Test Acc: 0.330
Validation loss decreased (-0.326418 --> -0.329661).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3310965
	speed: 0.1997s/iter; left time: 2932.6868s
Epoch: 5 cost time: 7.403407335281372
Epoch: 5, Steps: 154 | Train Loss: 1.902 Vali Loss: 2.169 Vali Acc: 0.332 Test Loss: 2.169 Test Acc: 0.332
Validation loss decreased (-0.329661 --> -0.331690).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6341972
	speed: 0.2064s/iter; left time: 2999.6229s
Epoch: 6 cost time: 7.73895001411438
Epoch: 6, Steps: 154 | Train Loss: 1.787 Vali Loss: 2.255 Vali Acc: 0.333 Test Loss: 2.255 Test Acc: 0.333
Validation loss decreased (-0.331690 --> -0.332905).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5541506
	speed: 0.1991s/iter; left time: 2863.0081s
Epoch: 7 cost time: 7.5923871994018555
Epoch: 7, Steps: 154 | Train Loss: 1.816 Vali Loss: 2.223 Vali Acc: 0.340 Test Loss: 2.223 Test Acc: 0.340
Validation loss decreased (-0.332905 --> -0.340205).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0634863
	speed: 0.1862s/iter; left time: 2648.4384s
Epoch: 8 cost time: 7.136044979095459
Epoch: 8, Steps: 154 | Train Loss: 1.764 Vali Loss: 2.456 Vali Acc: 0.339 Test Loss: 2.456 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.2663858
	speed: 0.1844s/iter; left time: 2593.7274s
Epoch: 9 cost time: 7.225368976593018
Epoch: 9, Steps: 154 | Train Loss: 1.737 Vali Loss: 2.223 Vali Acc: 0.354 Test Loss: 2.223 Test Acc: 0.354
Validation loss decreased (-0.340205 --> -0.354398).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6943468
	speed: 0.1819s/iter; left time: 2530.7824s
Epoch: 10 cost time: 7.632971525192261
Epoch: 10, Steps: 154 | Train Loss: 1.693 Vali Loss: 2.568 Vali Acc: 0.348 Test Loss: 2.568 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.7631171
	speed: 0.1833s/iter; left time: 2523.0380s
Epoch: 11 cost time: 7.0672526359558105
Epoch: 11, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.578 Vali Acc: 0.346 Test Loss: 2.578 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.9474293
	speed: 0.1897s/iter; left time: 2580.9772s
Epoch: 12 cost time: 7.462429761886597
Epoch: 12, Steps: 154 | Train Loss: 1.844 Vali Loss: 2.762 Vali Acc: 0.356 Test Loss: 2.762 Test Acc: 0.356
Validation loss decreased (-0.354398 --> -0.356420).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5982656
	speed: 0.1818s/iter; left time: 2446.4043s
Epoch: 13 cost time: 7.055882692337036
Epoch: 13, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.702 Vali Acc: 0.295 Test Loss: 2.702 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3093641
	speed: 0.2004s/iter; left time: 2665.5618s
Epoch: 14 cost time: 6.903442144393921
Epoch: 14, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.979 Vali Acc: 0.195 Test Loss: 2.979 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.8518320
	speed: 0.1988s/iter; left time: 2612.7191s
Epoch: 15 cost time: 7.654971122741699
Epoch: 15, Steps: 154 | Train Loss: 1.458 Vali Loss: 2.833 Vali Acc: 0.373 Test Loss: 2.833 Test Acc: 0.373
Validation loss decreased (-0.356420 --> -0.372640).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.2227961
	speed: 0.1885s/iter; left time: 2448.4425s
Epoch: 16 cost time: 6.6530232429504395
Epoch: 16, Steps: 154 | Train Loss: 1.497 Vali Loss: 3.200 Vali Acc: 0.356 Test Loss: 3.200 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.6990434
	speed: 0.1764s/iter; left time: 2264.9159s
Epoch: 17 cost time: 7.249831676483154
Epoch: 17, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.985 Vali Acc: 0.232 Test Loss: 2.985 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.9335988
	speed: 0.1899s/iter; left time: 2408.5802s
Epoch: 18 cost time: 8.037722110748291
Epoch: 18, Steps: 154 | Train Loss: 1.546 Vali Loss: 3.096 Vali Acc: 0.373 Test Loss: 3.096 Test Acc: 0.373
Validation loss decreased (-0.372640 --> -0.373448).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.3775355
	speed: 0.1832s/iter; left time: 2295.5237s
Epoch: 19 cost time: 7.107780456542969
Epoch: 19, Steps: 154 | Train Loss: 1.494 Vali Loss: 3.504 Vali Acc: 0.362 Test Loss: 3.504 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.3991441
	speed: 0.1891s/iter; left time: 2340.6060s
Epoch: 20 cost time: 7.412201404571533
Epoch: 20, Steps: 154 | Train Loss: 1.433 Vali Loss: 3.405 Vali Acc: 0.217 Test Loss: 3.405 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.2525074
	speed: 0.1914s/iter; left time: 2338.8933s
Epoch: 21 cost time: 8.05092191696167
Epoch: 21, Steps: 154 | Train Loss: 1.667 Vali Loss: 3.601 Vali Acc: 0.363 Test Loss: 3.601 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 3.7382572
	speed: 0.1819s/iter; left time: 2194.7017s
Epoch: 22 cost time: 7.097161293029785
Epoch: 22, Steps: 154 | Train Loss: 1.593 Vali Loss: 3.935 Vali Acc: 0.364 Test Loss: 3.935 Test Acc: 0.364
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.1169184
	speed: 0.2026s/iter; left time: 2413.2736s
Epoch: 23 cost time: 7.419077634811401
Epoch: 23, Steps: 154 | Train Loss: 1.244 Vali Loss: 3.645 Vali Acc: 0.380 Test Loss: 3.645 Test Acc: 0.380
Validation loss decreased (-0.373448 --> -0.380337).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.2855271
	speed: 0.2055s/iter; left time: 2416.2879s
Epoch: 24 cost time: 8.025245904922485
Epoch: 24, Steps: 154 | Train Loss: 1.245 Vali Loss: 3.339 Vali Acc: 0.379 Test Loss: 3.339 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.9220592
	speed: 0.1978s/iter; left time: 2295.9329s
Epoch: 25 cost time: 7.28281831741333
Epoch: 25, Steps: 154 | Train Loss: 1.395 Vali Loss: 3.706 Vali Acc: 0.359 Test Loss: 3.706 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.2970005
	speed: 0.1944s/iter; left time: 2225.7627s
Epoch: 26 cost time: 7.214885234832764
Epoch: 26, Steps: 154 | Train Loss: 1.472 Vali Loss: 4.310 Vali Acc: 0.211 Test Loss: 4.310 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.6670911
	speed: 0.1833s/iter; left time: 2070.8664s
Epoch: 27 cost time: 6.6973137855529785
Epoch: 27, Steps: 154 | Train Loss: 1.385 Vali Loss: 4.315 Vali Acc: 0.366 Test Loss: 4.315 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.0649272
	speed: 0.1536s/iter; left time: 1711.3583s
Epoch: 28 cost time: 7.107528448104858
Epoch: 28, Steps: 154 | Train Loss: 1.187 Vali Loss: 4.214 Vali Acc: 0.342 Test Loss: 4.214 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.9864397
	speed: 0.1877s/iter; left time: 2062.5126s
Epoch: 29 cost time: 7.09705662727356
Epoch: 29, Steps: 154 | Train Loss: 1.260 Vali Loss: 4.535 Vali Acc: 0.353 Test Loss: 4.535 Test Acc: 0.353
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.8373503
	speed: 0.1900s/iter; left time: 2058.9779s
Epoch: 30 cost time: 7.301125526428223
Epoch: 30, Steps: 154 | Train Loss: 1.330 Vali Loss: 4.857 Vali Acc: 0.207 Test Loss: 4.857 Test Acc: 0.207
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.9058986
	speed: 0.1894s/iter; left time: 2023.0936s
Epoch: 31 cost time: 7.731952667236328
Epoch: 31, Steps: 154 | Train Loss: 1.562 Vali Loss: 3.968 Vali Acc: 0.391 Test Loss: 3.968 Test Acc: 0.391
Validation loss decreased (-0.380337 --> -0.391282).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.9442461
	speed: 0.2078s/iter; left time: 2187.6529s
Epoch: 32 cost time: 7.00435209274292
Epoch: 32, Steps: 154 | Train Loss: 1.206 Vali Loss: 4.532 Vali Acc: 0.236 Test Loss: 4.532 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 1.2800260
	speed: 0.2019s/iter; left time: 2094.0469s
Epoch: 33 cost time: 8.040140390396118
Epoch: 33, Steps: 154 | Train Loss: 1.215 Vali Loss: 4.286 Vali Acc: 0.378 Test Loss: 4.286 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 1.0819283
	speed: 0.1946s/iter; left time: 1988.7500s
Epoch: 34 cost time: 7.261622190475464
Epoch: 34, Steps: 154 | Train Loss: 1.283 Vali Loss: 5.233 Vali Acc: 0.374 Test Loss: 5.233 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 1.0881400
	speed: 0.1857s/iter; left time: 1868.9690s
Epoch: 35 cost time: 6.882481098175049
Epoch: 35, Steps: 154 | Train Loss: 1.448 Vali Loss: 4.824 Vali Acc: 0.363 Test Loss: 4.824 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.7988951
	speed: 0.1858s/iter; left time: 1841.0700s
Epoch: 36 cost time: 7.835865497589111
Epoch: 36, Steps: 154 | Train Loss: 1.800 Vali Loss: 5.327 Vali Acc: 0.207 Test Loss: 5.327 Test Acc: 0.207
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 1.0276783
	speed: 0.1817s/iter; left time: 1772.6412s
Epoch: 37 cost time: 7.415329456329346
Epoch: 37, Steps: 154 | Train Loss: 1.148 Vali Loss: 4.333 Vali Acc: 0.367 Test Loss: 4.333 Test Acc: 0.367
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 13.7791767
	speed: 0.1852s/iter; left time: 1778.7399s
Epoch: 38 cost time: 6.734481573104858
Epoch: 38, Steps: 154 | Train Loss: 1.314 Vali Loss: 4.848 Vali Acc: 0.280 Test Loss: 4.848 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.7727345
	speed: 0.1859s/iter; left time: 1756.4842s
Epoch: 39 cost time: 7.5004050731658936
Epoch: 39, Steps: 154 | Train Loss: 1.184 Vali Loss: 5.878 Vali Acc: 0.097 Test Loss: 5.878 Test Acc: 0.097
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.6310927
	speed: 0.1917s/iter; left time: 1781.7404s
Epoch: 40 cost time: 7.485008239746094
Epoch: 40, Steps: 154 | Train Loss: 1.101 Vali Loss: 5.350 Vali Acc: 0.358 Test Loss: 5.350 Test Acc: 0.358
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 1.2904173
	speed: 0.1988s/iter; left time: 1817.0219s
Epoch: 41 cost time: 6.760180234909058
Epoch: 41, Steps: 154 | Train Loss: 1.200 Vali Loss: 5.487 Vali Acc: 0.389 Test Loss: 5.487 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3913219789132198
model parameter : 533046
model size : 6.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1140888
	speed: 0.0612s/iter; left time: 936.4628s
Epoch: 1 cost time: 8.388946294784546
Epoch: 1, Steps: 154 | Train Loss: 2.225 Vali Loss: 2.201 Vali Acc: 0.320 Test Loss: 2.201 Test Acc: 0.320
Validation loss decreased (inf --> -0.319929).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6086034
	speed: 0.1791s/iter; left time: 2712.8153s
Epoch: 2 cost time: 6.754578590393066
Epoch: 2, Steps: 154 | Train Loss: 2.091 Vali Loss: 2.230 Vali Acc: 0.324 Test Loss: 2.230 Test Acc: 0.324
Validation loss decreased (-0.319929 --> -0.324390).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7232236
	speed: 0.1856s/iter; left time: 2783.4007s
Epoch: 3 cost time: 7.5357136726379395
Epoch: 3, Steps: 154 | Train Loss: 1.964 Vali Loss: 2.158 Vali Acc: 0.328 Test Loss: 2.158 Test Acc: 0.328
Validation loss decreased (-0.324390 --> -0.327635).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6888005
	speed: 0.1804s/iter; left time: 2677.4478s
Epoch: 4 cost time: 7.107011556625366
Epoch: 4, Steps: 154 | Train Loss: 1.876 Vali Loss: 2.208 Vali Acc: 0.326 Test Loss: 2.208 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3187690
	speed: 0.1819s/iter; left time: 2670.9856s
Epoch: 5 cost time: 6.372922897338867
Epoch: 5, Steps: 154 | Train Loss: 1.855 Vali Loss: 2.175 Vali Acc: 0.335 Test Loss: 2.175 Test Acc: 0.335
Validation loss decreased (-0.327635 --> -0.335339).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5511945
	speed: 0.1865s/iter; left time: 2710.1760s
Epoch: 6 cost time: 8.05196475982666
Epoch: 6, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.272 Vali Acc: 0.334 Test Loss: 2.272 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7497900
	speed: 0.2006s/iter; left time: 2883.7012s
Epoch: 7 cost time: 8.263264417648315
Epoch: 7, Steps: 154 | Train Loss: 1.834 Vali Loss: 2.342 Vali Acc: 0.343 Test Loss: 2.342 Test Acc: 0.343
Validation loss decreased (-0.335339 --> -0.342637).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9783627
	speed: 0.2051s/iter; left time: 2917.3819s
Epoch: 8 cost time: 7.199985980987549
Epoch: 8, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.472 Vali Acc: 0.345 Test Loss: 2.472 Test Acc: 0.345
Validation loss decreased (-0.342637 --> -0.344663).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0377922
	speed: 0.2125s/iter; left time: 2989.8998s
Epoch: 9 cost time: 8.242904663085938
Epoch: 9, Steps: 154 | Train Loss: 1.713 Vali Loss: 2.359 Vali Acc: 0.356 Test Loss: 2.359 Test Acc: 0.356
Validation loss decreased (-0.344663 --> -0.356019).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7251711
	speed: 0.1960s/iter; left time: 2727.1802s
Epoch: 10 cost time: 6.0540452003479
Epoch: 10, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.594 Vali Acc: 0.347 Test Loss: 2.594 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.7889873
	speed: 0.1925s/iter; left time: 2649.6271s
Epoch: 11 cost time: 8.643315076828003
Epoch: 11, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.567 Vali Acc: 0.358 Test Loss: 2.567 Test Acc: 0.358
Validation loss decreased (-0.356019 --> -0.358044).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9302558
	speed: 0.1898s/iter; left time: 2582.5258s
Epoch: 12 cost time: 5.859046220779419
Epoch: 12, Steps: 154 | Train Loss: 1.749 Vali Loss: 2.666 Vali Acc: 0.358 Test Loss: 2.666 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6924130
	speed: 0.1528s/iter; left time: 2054.9821s
Epoch: 13 cost time: 7.185096025466919
Epoch: 13, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.884 Vali Acc: 0.197 Test Loss: 2.884 Test Acc: 0.197
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.4580865
	speed: 0.1907s/iter; left time: 2535.7139s
Epoch: 14 cost time: 7.386918067932129
Epoch: 14, Steps: 154 | Train Loss: 1.964 Vali Loss: 3.005 Vali Acc: 0.199 Test Loss: 3.005 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.1663250
	speed: 0.1949s/iter; left time: 2561.6744s
Epoch: 15 cost time: 7.610245943069458
Epoch: 15, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.838 Vali Acc: 0.245 Test Loss: 2.838 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.1423023
	speed: 0.1897s/iter; left time: 2464.4675s
Epoch: 16 cost time: 7.828821420669556
Epoch: 16, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.992 Vali Acc: 0.368 Test Loss: 2.992 Test Acc: 0.368
Validation loss decreased (-0.358044 --> -0.367772).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.7424612
	speed: 0.1952s/iter; left time: 2505.9607s
Epoch: 17 cost time: 7.45258641242981
Epoch: 17, Steps: 154 | Train Loss: 1.637 Vali Loss: 3.070 Vali Acc: 0.206 Test Loss: 3.070 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.7193143
	speed: 0.1937s/iter; left time: 2456.9483s
Epoch: 18 cost time: 7.215846538543701
Epoch: 18, Steps: 154 | Train Loss: 1.476 Vali Loss: 3.256 Vali Acc: 0.213 Test Loss: 3.256 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.2268996
	speed: 0.1998s/iter; left time: 2503.6409s
Epoch: 19 cost time: 8.550083637237549
Epoch: 19, Steps: 154 | Train Loss: 1.420 Vali Loss: 3.432 Vali Acc: 0.367 Test Loss: 3.432 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.3103690
	speed: 0.2070s/iter; left time: 2562.2065s
Epoch: 20 cost time: 7.359336614608765
Epoch: 20, Steps: 154 | Train Loss: 1.369 Vali Loss: 3.470 Vali Acc: 0.214 Test Loss: 3.470 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 6.1671000
	speed: 0.2097s/iter; left time: 2562.6011s
Epoch: 21 cost time: 7.291229486465454
Epoch: 21, Steps: 154 | Train Loss: 1.397 Vali Loss: 3.614 Vali Acc: 0.372 Test Loss: 3.614 Test Acc: 0.372
Validation loss decreased (-0.367772 --> -0.372227).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.5200839
	speed: 0.1917s/iter; left time: 2312.8412s
Epoch: 22 cost time: 8.297326803207397
Epoch: 22, Steps: 154 | Train Loss: 1.615 Vali Loss: 4.111 Vali Acc: 0.363 Test Loss: 4.111 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.0771792
	speed: 0.1949s/iter; left time: 2321.6800s
Epoch: 23 cost time: 7.660252571105957
Epoch: 23, Steps: 154 | Train Loss: 1.512 Vali Loss: 3.848 Vali Acc: 0.370 Test Loss: 3.848 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.9628456
	speed: 0.1932s/iter; left time: 2271.9070s
Epoch: 24 cost time: 7.3008527755737305
Epoch: 24, Steps: 154 | Train Loss: 1.349 Vali Loss: 3.845 Vali Acc: 0.380 Test Loss: 3.845 Test Acc: 0.380
Validation loss decreased (-0.372227 --> -0.380335).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.9988235
	speed: 0.1934s/iter; left time: 2244.9697s
Epoch: 25 cost time: 8.157702684402466
Epoch: 25, Steps: 154 | Train Loss: 1.275 Vali Loss: 4.066 Vali Acc: 0.379 Test Loss: 4.066 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.2456570
	speed: 0.1890s/iter; left time: 2164.4332s
Epoch: 26 cost time: 7.361248016357422
Epoch: 26, Steps: 154 | Train Loss: 1.273 Vali Loss: 3.677 Vali Acc: 0.212 Test Loss: 3.677 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.7819933
	speed: 0.1873s/iter; left time: 2116.2442s
Epoch: 27 cost time: 7.1038291454315186
Epoch: 27, Steps: 154 | Train Loss: 1.444 Vali Loss: 4.173 Vali Acc: 0.315 Test Loss: 4.173 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.9638945
	speed: 0.2084s/iter; left time: 2322.5244s
Epoch: 28 cost time: 8.16453218460083
Epoch: 28, Steps: 154 | Train Loss: 1.386 Vali Loss: 4.238 Vali Acc: 0.325 Test Loss: 4.238 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 1.1093395
	speed: 0.2054s/iter; left time: 2257.3879s
Epoch: 29 cost time: 7.295709609985352
Epoch: 29, Steps: 154 | Train Loss: 1.218 Vali Loss: 4.875 Vali Acc: 0.219 Test Loss: 4.875 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.8458660
	speed: 0.2089s/iter; left time: 2263.6738s
Epoch: 30 cost time: 7.459802150726318
Epoch: 30, Steps: 154 | Train Loss: 1.414 Vali Loss: 4.823 Vali Acc: 0.208 Test Loss: 4.823 Test Acc: 0.208
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.5595940
	speed: 0.2050s/iter; left time: 2189.6473s
Epoch: 31 cost time: 7.789504051208496
Epoch: 31, Steps: 154 | Train Loss: 1.845 Vali Loss: 4.578 Vali Acc: 0.374 Test Loss: 4.578 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 3.7748814
	speed: 0.1882s/iter; left time: 1981.3408s
Epoch: 32 cost time: 7.2657153606414795
Epoch: 32, Steps: 154 | Train Loss: 1.329 Vali Loss: 5.284 Vali Acc: 0.270 Test Loss: 5.284 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 1.3841501
	speed: 0.1915s/iter; left time: 1986.0989s
Epoch: 33 cost time: 7.482945203781128
Epoch: 33, Steps: 154 | Train Loss: 1.455 Vali Loss: 5.055 Vali Acc: 0.382 Test Loss: 5.055 Test Acc: 0.382
Validation loss decreased (-0.380335 --> -0.381945).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.0955389
	speed: 0.1937s/iter; left time: 1979.3627s
Epoch: 34 cost time: 7.744197130203247
Epoch: 34, Steps: 154 | Train Loss: 1.373 Vali Loss: 5.188 Vali Acc: 0.375 Test Loss: 5.188 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 1.1519866
	speed: 0.1895s/iter; left time: 1907.3943s
Epoch: 35 cost time: 7.9609434604644775
Epoch: 35, Steps: 154 | Train Loss: 1.582 Vali Loss: 5.875 Vali Acc: 0.266 Test Loss: 5.875 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.7310159
	speed: 0.1846s/iter; left time: 1829.8396s
Epoch: 36 cost time: 6.8790600299835205
Epoch: 36, Steps: 154 | Train Loss: 1.450 Vali Loss: 6.134 Vali Acc: 0.208 Test Loss: 6.134 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 1.1804874
	speed: 0.2044s/iter; left time: 1994.5583s
Epoch: 37 cost time: 7.9387500286102295
Epoch: 37, Steps: 154 | Train Loss: 1.186 Vali Loss: 5.945 Vali Acc: 0.124 Test Loss: 5.945 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 1.0792633
	speed: 0.2053s/iter; left time: 1971.3062s
Epoch: 38 cost time: 8.933629751205444
Epoch: 38, Steps: 154 | Train Loss: 1.270 Vali Loss: 5.736 Vali Acc: 0.190 Test Loss: 5.736 Test Acc: 0.190
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 1.1735971
	speed: 0.2148s/iter; left time: 2029.8676s
Epoch: 39 cost time: 7.629723787307739
Epoch: 39, Steps: 154 | Train Loss: 1.676 Vali Loss: 5.330 Vali Acc: 0.152 Test Loss: 5.330 Test Acc: 0.152
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 0.3706048
	speed: 0.1952s/iter; left time: 1814.8106s
Epoch: 40 cost time: 7.444545745849609
Epoch: 40, Steps: 154 | Train Loss: 1.008 Vali Loss: 5.619 Vali Acc: 0.230 Test Loss: 5.619 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 1.3667556
	speed: 0.1919s/iter; left time: 1754.1801s
Epoch: 41 cost time: 8.201416969299316
Epoch: 41, Steps: 154 | Train Loss: 1.068 Vali Loss: 6.343 Vali Acc: 0.391 Test Loss: 6.343 Test Acc: 0.391
Validation loss decreased (-0.381945 --> -0.391259).  Saving model ...
	iters: 100, epoch: 42 | loss: 0.8836302
	speed: 0.1983s/iter; left time: 1781.9236s
Epoch: 42 cost time: 7.815544366836548
Epoch: 42, Steps: 154 | Train Loss: 1.103 Vali Loss: 7.208 Vali Acc: 0.105 Test Loss: 7.208 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 0.9246353
	speed: 0.1948s/iter; left time: 1720.4354s
Epoch: 43 cost time: 7.0104005336761475
Epoch: 43, Steps: 154 | Train Loss: 1.213 Vali Loss: 6.307 Vali Acc: 0.395 Test Loss: 6.307 Test Acc: 0.395
Validation loss decreased (-0.391259 --> -0.394909).  Saving model ...
	iters: 100, epoch: 44 | loss: 1.1160408
	speed: 0.1960s/iter; left time: 1701.1638s
Epoch: 44 cost time: 8.320068836212158
Epoch: 44, Steps: 154 | Train Loss: 1.460 Vali Loss: 7.027 Vali Acc: 0.092 Test Loss: 7.027 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 0.5867526
	speed: 0.1938s/iter; left time: 1651.8780s
Epoch: 45 cost time: 7.127537488937378
Epoch: 45, Steps: 154 | Train Loss: 1.629 Vali Loss: 6.954 Vali Acc: 0.122 Test Loss: 6.954 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 0.6026919
	speed: 0.2047s/iter; left time: 1713.8310s
Epoch: 46 cost time: 7.42561674118042
Epoch: 46, Steps: 154 | Train Loss: 1.156 Vali Loss: 6.341 Vali Acc: 0.134 Test Loss: 6.341 Test Acc: 0.134
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 47 | loss: 1.9241459
	speed: 0.2122s/iter; left time: 1743.6960s
Epoch: 47 cost time: 8.45050573348999
Epoch: 47, Steps: 154 | Train Loss: 0.932 Vali Loss: 6.712 Vali Acc: 0.201 Test Loss: 6.712 Test Acc: 0.201
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 48 | loss: 0.8036053
	speed: 0.2056s/iter; left time: 1657.4640s
Epoch: 48 cost time: 7.176288366317749
Epoch: 48, Steps: 154 | Train Loss: 1.159 Vali Loss: 6.436 Vali Acc: 0.120 Test Loss: 6.436 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 49 | loss: 0.6333579
	speed: 0.1894s/iter; left time: 1498.1528s
Epoch: 49 cost time: 7.529407978057861
Epoch: 49, Steps: 154 | Train Loss: 1.147 Vali Loss: 7.741 Vali Acc: 0.107 Test Loss: 7.741 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 50 | loss: 0.2345928
	speed: 0.1938s/iter; left time: 1502.8171s
Epoch: 50 cost time: 7.8536224365234375
Epoch: 50, Steps: 154 | Train Loss: 1.078 Vali Loss: 6.956 Vali Acc: 0.203 Test Loss: 6.956 Test Acc: 0.203
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 51 | loss: 0.7524742
	speed: 0.1862s/iter; left time: 1415.5740s
Epoch: 51 cost time: 7.1675355434417725
Epoch: 51, Steps: 154 | Train Loss: 0.791 Vali Loss: 8.841 Vali Acc: 0.104 Test Loss: 8.841 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 52 | loss: 1.0908390
	speed: 0.1939s/iter; left time: 1444.0050s
Epoch: 52 cost time: 7.581561088562012
Epoch: 52, Steps: 154 | Train Loss: 1.179 Vali Loss: 7.472 Vali Acc: 0.106 Test Loss: 7.472 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 53 | loss: 0.7455715
	speed: 0.1975s/iter; left time: 1440.1632s
Epoch: 53 cost time: 8.19906497001648
Epoch: 53, Steps: 154 | Train Loss: 0.861 Vali Loss: 8.740 Vali Acc: 0.215 Test Loss: 8.740 Test Acc: 0.215
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39497161394971614
model parameter : 533046
model size : 6.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1652424
	speed: 0.0581s/iter; left time: 889.4668s
Epoch: 1 cost time: 8.107395648956299
Epoch: 1, Steps: 154 | Train Loss: 2.209 Vali Loss: 2.200 Vali Acc: 0.318 Test Loss: 2.200 Test Acc: 0.318
Validation loss decreased (inf --> -0.317496).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5856738
	speed: 0.2017s/iter; left time: 3055.4304s
Epoch: 2 cost time: 8.420047998428345
Epoch: 2, Steps: 154 | Train Loss: 2.096 Vali Loss: 2.243 Vali Acc: 0.323 Test Loss: 2.243 Test Acc: 0.323
Validation loss decreased (-0.317496 --> -0.323173).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8213953
	speed: 0.2059s/iter; left time: 3086.8546s
Epoch: 3 cost time: 7.398104667663574
Epoch: 3, Steps: 154 | Train Loss: 1.976 Vali Loss: 2.183 Vali Acc: 0.327 Test Loss: 2.183 Test Acc: 0.327
Validation loss decreased (-0.323173 --> -0.326823).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7053047
	speed: 0.1905s/iter; left time: 2826.7961s
Epoch: 4 cost time: 7.062246561050415
Epoch: 4, Steps: 154 | Train Loss: 1.903 Vali Loss: 2.238 Vali Acc: 0.331 Test Loss: 2.238 Test Acc: 0.331
Validation loss decreased (-0.326823 --> -0.331283).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3618951
	speed: 0.1823s/iter; left time: 2677.4522s
Epoch: 5 cost time: 6.675304174423218
Epoch: 5, Steps: 154 | Train Loss: 1.894 Vali Loss: 2.178 Vali Acc: 0.335 Test Loss: 2.178 Test Acc: 0.335
Validation loss decreased (-0.331283 --> -0.335339).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1375747
	speed: 0.1540s/iter; left time: 2237.9183s
Epoch: 6 cost time: 6.994474649429321
Epoch: 6, Steps: 154 | Train Loss: 1.854 Vali Loss: 2.200 Vali Acc: 0.340 Test Loss: 2.200 Test Acc: 0.340
Validation loss decreased (-0.335339 --> -0.339800).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6084256
	speed: 0.1877s/iter; left time: 2698.6478s
Epoch: 7 cost time: 7.158926486968994
Epoch: 7, Steps: 154 | Train Loss: 1.758 Vali Loss: 2.331 Vali Acc: 0.349 Test Loss: 2.331 Test Acc: 0.349
Validation loss decreased (-0.339800 --> -0.348720).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9000340
	speed: 0.1873s/iter; left time: 2664.0251s
Epoch: 8 cost time: 7.463589429855347
Epoch: 8, Steps: 154 | Train Loss: 1.827 Vali Loss: 2.430 Vali Acc: 0.346 Test Loss: 2.430 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4092792
	speed: 0.1784s/iter; left time: 2510.1506s
Epoch: 9 cost time: 6.997756242752075
Epoch: 9, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.375 Vali Acc: 0.354 Test Loss: 2.375 Test Acc: 0.354
Validation loss decreased (-0.348720 --> -0.354396).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7242630
	speed: 0.1952s/iter; left time: 2716.0785s
Epoch: 10 cost time: 6.983341455459595
Epoch: 10, Steps: 154 | Train Loss: 1.733 Vali Loss: 2.657 Vali Acc: 0.350 Test Loss: 2.657 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5990703
	speed: 0.1985s/iter; left time: 2731.8647s
Epoch: 11 cost time: 7.1612372398376465
Epoch: 11, Steps: 154 | Train Loss: 1.669 Vali Loss: 2.587 Vali Acc: 0.354 Test Loss: 2.587 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.0565898
	speed: 0.1930s/iter; left time: 2625.7761s
Epoch: 12 cost time: 7.687178373336792
Epoch: 12, Steps: 154 | Train Loss: 1.854 Vali Loss: 2.781 Vali Acc: 0.360 Test Loss: 2.781 Test Acc: 0.360
Validation loss decreased (-0.354396 --> -0.359664).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5579057
	speed: 0.1905s/iter; left time: 2562.9017s
Epoch: 13 cost time: 7.392818212509155
Epoch: 13, Steps: 154 | Train Loss: 1.517 Vali Loss: 3.018 Vali Acc: 0.220 Test Loss: 3.018 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3642161
	speed: 0.1857s/iter; left time: 2470.2066s
Epoch: 14 cost time: 7.172061443328857
Epoch: 14, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.813 Vali Acc: 0.203 Test Loss: 2.813 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.0918167
	speed: 0.1826s/iter; left time: 2400.0408s
Epoch: 15 cost time: 7.973455429077148
Epoch: 15, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.708 Vali Acc: 0.370 Test Loss: 2.708 Test Acc: 0.370
Validation loss decreased (-0.359664 --> -0.370208).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.1806778
	speed: 0.1923s/iter; left time: 2498.2594s
Epoch: 16 cost time: 7.51211953163147
Epoch: 16, Steps: 154 | Train Loss: 1.572 Vali Loss: 3.218 Vali Acc: 0.366 Test Loss: 3.218 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.4518707
	speed: 0.1845s/iter; left time: 2368.1656s
Epoch: 17 cost time: 6.883733510971069
Epoch: 17, Steps: 154 | Train Loss: 1.679 Vali Loss: 3.161 Vali Acc: 0.208 Test Loss: 3.161 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.6543409
	speed: 0.1860s/iter; left time: 2358.9210s
Epoch: 18 cost time: 7.5806028842926025
Epoch: 18, Steps: 154 | Train Loss: 1.445 Vali Loss: 3.419 Vali Acc: 0.227 Test Loss: 3.419 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.3434954
	speed: 0.1944s/iter; left time: 2436.2395s
Epoch: 19 cost time: 7.054086923599243
Epoch: 19, Steps: 154 | Train Loss: 1.508 Vali Loss: 3.414 Vali Acc: 0.363 Test Loss: 3.414 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.7918432
	speed: 0.1922s/iter; left time: 2378.0241s
Epoch: 20 cost time: 6.315704345703125
Epoch: 20, Steps: 154 | Train Loss: 1.481 Vali Loss: 3.644 Vali Acc: 0.255 Test Loss: 3.644 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.0731115
	speed: 0.2021s/iter; left time: 2470.2774s
Epoch: 21 cost time: 8.233692169189453
Epoch: 21, Steps: 154 | Train Loss: 1.683 Vali Loss: 3.520 Vali Acc: 0.377 Test Loss: 3.520 Test Acc: 0.377
Validation loss decreased (-0.370208 --> -0.376688).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.4134783
	speed: 0.1876s/iter; left time: 2263.2382s
Epoch: 22 cost time: 6.661938190460205
Epoch: 22, Steps: 154 | Train Loss: 1.712 Vali Loss: 4.082 Vali Acc: 0.366 Test Loss: 4.082 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.1416268
	speed: 0.1807s/iter; left time: 2152.1293s
Epoch: 23 cost time: 7.138664722442627
Epoch: 23, Steps: 154 | Train Loss: 1.357 Vali Loss: 4.114 Vali Acc: 0.373 Test Loss: 4.114 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.0489864
	speed: 0.1858s/iter; left time: 2184.7050s
Epoch: 24 cost time: 7.65642237663269
Epoch: 24, Steps: 154 | Train Loss: 1.328 Vali Loss: 3.776 Vali Acc: 0.385 Test Loss: 3.776 Test Acc: 0.385
Validation loss decreased (-0.376688 --> -0.385201).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.9972612
	speed: 0.1766s/iter; left time: 2049.1061s
Epoch: 25 cost time: 6.673909425735474
Epoch: 25, Steps: 154 | Train Loss: 1.330 Vali Loss: 4.287 Vali Acc: 0.297 Test Loss: 4.287 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.2066340
	speed: 0.1818s/iter; left time: 2081.9989s
Epoch: 26 cost time: 7.177306175231934
Epoch: 26, Steps: 154 | Train Loss: 1.585 Vali Loss: 4.052 Vali Acc: 0.310 Test Loss: 4.052 Test Acc: 0.310
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.6840458
	speed: 0.1868s/iter; left time: 2110.1125s
Epoch: 27 cost time: 7.754866361618042
Epoch: 27, Steps: 154 | Train Loss: 1.266 Vali Loss: 4.876 Vali Acc: 0.126 Test Loss: 4.876 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.0444522
	speed: 0.1922s/iter; left time: 2141.4460s
Epoch: 28 cost time: 7.398629665374756
Epoch: 28, Steps: 154 | Train Loss: 1.439 Vali Loss: 4.181 Vali Acc: 0.195 Test Loss: 4.181 Test Acc: 0.195
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 1.5180238
	speed: 0.2035s/iter; left time: 2236.7650s
Epoch: 29 cost time: 7.1858720779418945
Epoch: 29, Steps: 154 | Train Loss: 1.542 Vali Loss: 4.998 Vali Acc: 0.381 Test Loss: 4.998 Test Acc: 0.381
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.5785187
	speed: 0.2082s/iter; left time: 2256.0319s
Epoch: 30 cost time: 7.650644779205322
Epoch: 30, Steps: 154 | Train Loss: 1.639 Vali Loss: 4.716 Vali Acc: 0.234 Test Loss: 4.716 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.5141205
	speed: 0.1888s/iter; left time: 2016.6860s
Epoch: 31 cost time: 7.497997045516968
Epoch: 31, Steps: 154 | Train Loss: 1.260 Vali Loss: 4.353 Vali Acc: 0.397 Test Loss: 4.353 Test Acc: 0.397
Validation loss decreased (-0.385201 --> -0.396956).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.1634222
	speed: 0.1947s/iter; left time: 2049.9644s
Epoch: 32 cost time: 7.345307111740112
Epoch: 32, Steps: 154 | Train Loss: 1.282 Vali Loss: 4.785 Vali Acc: 0.388 Test Loss: 4.785 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.7769161
	speed: 0.1831s/iter; left time: 1899.1398s
Epoch: 33 cost time: 6.860239744186401
Epoch: 33, Steps: 154 | Train Loss: 1.411 Vali Loss: 4.666 Vali Acc: 0.386 Test Loss: 4.666 Test Acc: 0.386
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 1.2012808
	speed: 0.1790s/iter; left time: 1828.9955s
Epoch: 34 cost time: 7.518295049667358
Epoch: 34, Steps: 154 | Train Loss: 1.299 Vali Loss: 5.330 Vali Acc: 0.373 Test Loss: 5.330 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 1.2170324
	speed: 0.1831s/iter; left time: 1842.7804s
Epoch: 35 cost time: 7.190114974975586
Epoch: 35, Steps: 154 | Train Loss: 1.036 Vali Loss: 4.932 Vali Acc: 0.388 Test Loss: 4.932 Test Acc: 0.388
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.8475285
	speed: 0.1863s/iter; left time: 1845.9352s
Epoch: 36 cost time: 6.894681930541992
Epoch: 36, Steps: 154 | Train Loss: 1.204 Vali Loss: 5.568 Vali Acc: 0.148 Test Loss: 5.568 Test Acc: 0.148
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.7845803
	speed: 0.1967s/iter; left time: 1919.0001s
Epoch: 37 cost time: 8.204806804656982
Epoch: 37, Steps: 154 | Train Loss: 1.090 Vali Loss: 5.110 Vali Acc: 0.159 Test Loss: 5.110 Test Acc: 0.159
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 1.0429375
	speed: 0.1962s/iter; left time: 1884.3719s
Epoch: 38 cost time: 6.648322820663452
Epoch: 38, Steps: 154 | Train Loss: 1.035 Vali Loss: 5.636 Vali Acc: 0.120 Test Loss: 5.636 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.4195213
	speed: 0.1912s/iter; left time: 1807.0641s
Epoch: 39 cost time: 6.817605972290039
Epoch: 39, Steps: 154 | Train Loss: 1.340 Vali Loss: 5.495 Vali Acc: 0.123 Test Loss: 5.495 Test Acc: 0.123
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 1.8169667
	speed: 0.1978s/iter; left time: 1838.7769s
Epoch: 40 cost time: 7.759232521057129
Epoch: 40, Steps: 154 | Train Loss: 1.143 Vali Loss: 5.203 Vali Acc: 0.155 Test Loss: 5.203 Test Acc: 0.155
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 1.3239479
	speed: 0.1816s/iter; left time: 1659.9419s
Epoch: 41 cost time: 6.608117341995239
Epoch: 41, Steps: 154 | Train Loss: 1.176 Vali Loss: 5.272 Vali Acc: 0.372 Test Loss: 5.272 Test Acc: 0.372
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39699918896999187
model parameter : 533046
model size : 6.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 3.7497041
	speed: 0.0694s/iter; left time: 1062.3824s
Epoch: 1 cost time: 9.798986434936523
Epoch: 1, Steps: 154 | Train Loss: 2.239 Vali Loss: 2.193 Vali Acc: 0.322 Test Loss: 2.193 Test Acc: 0.322
Validation loss decreased (inf --> -0.321551).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9387721
	speed: 0.1899s/iter; left time: 2876.1007s
Epoch: 2 cost time: 6.905679941177368
Epoch: 2, Steps: 154 | Train Loss: 2.069 Vali Loss: 2.223 Vali Acc: 0.322 Test Loss: 2.223 Test Acc: 0.322
Validation loss decreased (-0.321551 --> -0.321957).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5355866
	speed: 0.1861s/iter; left time: 2790.3931s
Epoch: 3 cost time: 7.517104625701904
Epoch: 3, Steps: 154 | Train Loss: 1.971 Vali Loss: 2.172 Vali Acc: 0.326 Test Loss: 2.172 Test Acc: 0.326
Validation loss decreased (-0.321957 --> -0.326012).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6340642
	speed: 0.1957s/iter; left time: 2903.5034s
Epoch: 4 cost time: 8.260741472244263
Epoch: 4, Steps: 154 | Train Loss: 1.927 Vali Loss: 2.355 Vali Acc: 0.322 Test Loss: 2.355 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8499569
	speed: 0.1983s/iter; left time: 2911.3225s
Epoch: 5 cost time: 6.912633657455444
Epoch: 5, Steps: 154 | Train Loss: 1.853 Vali Loss: 2.270 Vali Acc: 0.328 Test Loss: 2.270 Test Acc: 0.328
Validation loss decreased (-0.326012 --> -0.328039).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2870338
	speed: 0.2003s/iter; left time: 2910.1613s
Epoch: 6 cost time: 6.985628128051758
Epoch: 6, Steps: 154 | Train Loss: 1.830 Vali Loss: 2.208 Vali Acc: 0.333 Test Loss: 2.208 Test Acc: 0.333
Validation loss decreased (-0.328039 --> -0.333311).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8292063
	speed: 0.1990s/iter; left time: 2861.7239s
Epoch: 7 cost time: 7.393169641494751
Epoch: 7, Steps: 154 | Train Loss: 1.835 Vali Loss: 2.334 Vali Acc: 0.337 Test Loss: 2.334 Test Acc: 0.337
Validation loss decreased (-0.333311 --> -0.337365).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2754095
	speed: 0.1813s/iter; left time: 2578.2380s
Epoch: 8 cost time: 7.155625820159912
Epoch: 8, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.357 Vali Acc: 0.343 Test Loss: 2.357 Test Acc: 0.343
Validation loss decreased (-0.337365 --> -0.342637).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6921085
	speed: 0.1855s/iter; left time: 2609.4958s
Epoch: 9 cost time: 7.062371253967285
Epoch: 9, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.340 Vali Acc: 0.345 Test Loss: 2.340 Test Acc: 0.345
Validation loss decreased (-0.342637 --> -0.344664).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1304348
	speed: 0.1868s/iter; left time: 2599.1902s
Epoch: 10 cost time: 7.455609560012817
Epoch: 10, Steps: 154 | Train Loss: 1.689 Vali Loss: 2.621 Vali Acc: 0.348 Test Loss: 2.621 Test Acc: 0.348
Validation loss decreased (-0.344664 --> -0.347500).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8260388
	speed: 0.1825s/iter; left time: 2510.8125s
Epoch: 11 cost time: 7.155550003051758
Epoch: 11, Steps: 154 | Train Loss: 1.683 Vali Loss: 2.675 Vali Acc: 0.346 Test Loss: 2.675 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6552361
	speed: 0.1880s/iter; left time: 2557.6565s
Epoch: 12 cost time: 7.0311362743377686
Epoch: 12, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.611 Vali Acc: 0.367 Test Loss: 2.611 Test Acc: 0.367
Validation loss decreased (-0.347500 --> -0.366559).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8470793
	speed: 0.1981s/iter; left time: 2664.7109s
Epoch: 13 cost time: 7.6069254875183105
Epoch: 13, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.682 Vali Acc: 0.358 Test Loss: 2.682 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.7911084
	speed: 0.1984s/iter; left time: 2638.5941s
Epoch: 14 cost time: 7.18333101272583
Epoch: 14, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.819 Vali Acc: 0.360 Test Loss: 2.819 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.8759661
	speed: 0.2028s/iter; left time: 2665.6433s
Epoch: 15 cost time: 7.200098514556885
Epoch: 15, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.813 Vali Acc: 0.365 Test Loss: 2.813 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.0460868
	speed: 0.1985s/iter; left time: 2578.4624s
Epoch: 16 cost time: 7.846772193908691
Epoch: 16, Steps: 154 | Train Loss: 1.683 Vali Loss: 3.166 Vali Acc: 0.369 Test Loss: 3.166 Test Acc: 0.369
Validation loss decreased (-0.366559 --> -0.368987).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.8041855
	speed: 0.1874s/iter; left time: 2405.0813s
Epoch: 17 cost time: 7.722573280334473
Epoch: 17, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.917 Vali Acc: 0.358 Test Loss: 2.917 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.4543861
	speed: 0.1882s/iter; left time: 2387.2828s
Epoch: 18 cost time: 7.148016691207886
Epoch: 18, Steps: 154 | Train Loss: 1.666 Vali Loss: 3.509 Vali Acc: 0.356 Test Loss: 3.509 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.9319175
	speed: 0.1877s/iter; left time: 2351.1088s
Epoch: 19 cost time: 7.588601589202881
Epoch: 19, Steps: 154 | Train Loss: 1.439 Vali Loss: 3.344 Vali Acc: 0.358 Test Loss: 3.344 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.2694600
	speed: 0.1907s/iter; left time: 2360.4547s
Epoch: 20 cost time: 7.691645860671997
Epoch: 20, Steps: 154 | Train Loss: 1.418 Vali Loss: 3.476 Vali Acc: 0.365 Test Loss: 3.476 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.9926223
	speed: 0.1819s/iter; left time: 2223.0502s
Epoch: 21 cost time: 7.049479007720947
Epoch: 21, Steps: 154 | Train Loss: 1.540 Vali Loss: 3.000 Vali Acc: 0.215 Test Loss: 3.000 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.8663125
	speed: 0.1961s/iter; left time: 2366.0595s
Epoch: 22 cost time: 7.070741653442383
Epoch: 22, Steps: 154 | Train Loss: 1.472 Vali Loss: 3.272 Vali Acc: 0.102 Test Loss: 3.272 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.7960303
	speed: 0.1956s/iter; left time: 2330.6612s
Epoch: 23 cost time: 7.488111257553101
Epoch: 23, Steps: 154 | Train Loss: 1.432 Vali Loss: 3.425 Vali Acc: 0.372 Test Loss: 3.425 Test Acc: 0.372
Validation loss decreased (-0.368987 --> -0.372229).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.1025121
	speed: 0.1910s/iter; left time: 2246.2283s
Epoch: 24 cost time: 6.347592353820801
Epoch: 24, Steps: 154 | Train Loss: 1.517 Vali Loss: 4.389 Vali Acc: 0.210 Test Loss: 4.389 Test Acc: 0.210
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.9872401
	speed: 0.1837s/iter; left time: 2131.4660s
Epoch: 25 cost time: 6.878183603286743
Epoch: 25, Steps: 154 | Train Loss: 1.387 Vali Loss: 3.558 Vali Acc: 0.345 Test Loss: 3.558 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.9902448
	speed: 0.1828s/iter; left time: 2092.7003s
Epoch: 26 cost time: 7.706722259521484
Epoch: 26, Steps: 154 | Train Loss: 1.400 Vali Loss: 3.870 Vali Acc: 0.186 Test Loss: 3.870 Test Acc: 0.186
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.3704001
	speed: 0.1805s/iter; left time: 2039.4496s
Epoch: 27 cost time: 6.766066789627075
Epoch: 27, Steps: 154 | Train Loss: 1.244 Vali Loss: 4.637 Vali Acc: 0.231 Test Loss: 4.637 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.9778566
	speed: 0.1809s/iter; left time: 2015.6309s
Epoch: 28 cost time: 7.11661434173584
Epoch: 28, Steps: 154 | Train Loss: 1.615 Vali Loss: 4.226 Vali Acc: 0.109 Test Loss: 4.226 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.7911221
	speed: 0.1841s/iter; left time: 2023.3509s
Epoch: 29 cost time: 7.709597110748291
Epoch: 29, Steps: 154 | Train Loss: 1.372 Vali Loss: 4.142 Vali Acc: 0.120 Test Loss: 4.142 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.8207320
	speed: 0.1816s/iter; left time: 1967.6997s
Epoch: 30 cost time: 7.205444812774658
Epoch: 30, Steps: 154 | Train Loss: 1.234 Vali Loss: 4.086 Vali Acc: 0.378 Test Loss: 4.086 Test Acc: 0.378
Validation loss decreased (-0.372229 --> -0.377899).  Saving model ...
	iters: 100, epoch: 31 | loss: 1.6875107
	speed: 0.1950s/iter; left time: 2082.5578s
Epoch: 31 cost time: 7.571690797805786
Epoch: 31, Steps: 154 | Train Loss: 1.273 Vali Loss: 4.201 Vali Acc: 0.206 Test Loss: 4.201 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 1.4000833
	speed: 0.2025s/iter; left time: 2131.3544s
Epoch: 32 cost time: 7.6071553230285645
Epoch: 32, Steps: 154 | Train Loss: 1.250 Vali Loss: 5.164 Vali Acc: 0.078 Test Loss: 5.164 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 1.2185640
	speed: 0.1932s/iter; left time: 2004.3577s
Epoch: 33 cost time: 7.599875211715698
Epoch: 33, Steps: 154 | Train Loss: 1.189 Vali Loss: 4.780 Vali Acc: 0.230 Test Loss: 4.780 Test Acc: 0.230
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 1.1751443
	speed: 0.2085s/iter; left time: 2130.6275s
Epoch: 34 cost time: 6.908789396286011
Epoch: 34, Steps: 154 | Train Loss: 1.207 Vali Loss: 4.832 Vali Acc: 0.094 Test Loss: 4.832 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 1.2053399
	speed: 0.1828s/iter; left time: 1840.1060s
Epoch: 35 cost time: 7.122874021530151
Epoch: 35, Steps: 154 | Train Loss: 1.181 Vali Loss: 4.452 Vali Acc: 0.098 Test Loss: 4.452 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 1.5765642
	speed: 0.1825s/iter; left time: 1808.8671s
Epoch: 36 cost time: 7.203394651412964
Epoch: 36, Steps: 154 | Train Loss: 1.467 Vali Loss: 4.279 Vali Acc: 0.094 Test Loss: 4.279 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.8835465
	speed: 0.1593s/iter; left time: 1553.9760s
Epoch: 37 cost time: 5.924326419830322
Epoch: 37, Steps: 154 | Train Loss: 1.353 Vali Loss: 5.026 Vali Acc: 0.091 Test Loss: 5.026 Test Acc: 0.091
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.9442686
	speed: 0.1908s/iter; left time: 1832.1831s
Epoch: 38 cost time: 7.331352233886719
Epoch: 38, Steps: 154 | Train Loss: 1.293 Vali Loss: 5.182 Vali Acc: 0.093 Test Loss: 5.182 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 1.4332175
	speed: 0.1881s/iter; left time: 1777.3293s
Epoch: 39 cost time: 8.011438846588135
Epoch: 39, Steps: 154 | Train Loss: 1.133 Vali Loss: 4.892 Vali Acc: 0.380 Test Loss: 4.892 Test Acc: 0.380
Validation loss decreased (-0.377899 --> -0.379513).  Saving model ...
	iters: 100, epoch: 40 | loss: 0.8471416
	speed: 0.1969s/iter; left time: 1830.1942s
Epoch: 40 cost time: 6.6421027183532715
Epoch: 40, Steps: 154 | Train Loss: 1.103 Vali Loss: 4.559 Vali Acc: 0.105 Test Loss: 4.559 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 1.1129624
	speed: 0.2080s/iter; left time: 1901.0231s
Epoch: 41 cost time: 8.11687684059143
Epoch: 41, Steps: 154 | Train Loss: 1.198 Vali Loss: 5.667 Vali Acc: 0.087 Test Loss: 5.667 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 0.6231465
	speed: 0.1997s/iter; left time: 1794.9384s
Epoch: 42 cost time: 7.310251474380493
Epoch: 42, Steps: 154 | Train Loss: 0.986 Vali Loss: 5.781 Vali Acc: 0.103 Test Loss: 5.781 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 0.5507580
	speed: 0.1988s/iter; left time: 1756.0689s
Epoch: 43 cost time: 6.616811513900757
Epoch: 43, Steps: 154 | Train Loss: 1.317 Vali Loss: 5.755 Vali Acc: 0.089 Test Loss: 5.755 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 1.0173295
	speed: 0.1886s/iter; left time: 1637.0467s
Epoch: 44 cost time: 8.21992015838623
Epoch: 44, Steps: 154 | Train Loss: 2.750 Vali Loss: 5.132 Vali Acc: 0.187 Test Loss: 5.132 Test Acc: 0.187
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 0.8164235
	speed: 0.1949s/iter; left time: 1661.7525s
Epoch: 45 cost time: 7.314909219741821
Epoch: 45, Steps: 154 | Train Loss: 1.092 Vali Loss: 5.514 Vali Acc: 0.109 Test Loss: 5.514 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 46 | loss: 1.1661253
	speed: 0.1940s/iter; left time: 1624.0527s
Epoch: 46 cost time: 7.702491044998169
Epoch: 46, Steps: 154 | Train Loss: 1.283 Vali Loss: 5.220 Vali Acc: 0.100 Test Loss: 5.220 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 47 | loss: 1.5436677
	speed: 0.1925s/iter; left time: 1582.0031s
Epoch: 47 cost time: 7.927828311920166
Epoch: 47, Steps: 154 | Train Loss: 1.148 Vali Loss: 5.052 Vali Acc: 0.099 Test Loss: 5.052 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 48 | loss: 0.5664042
	speed: 0.1979s/iter; left time: 1595.9114s
Epoch: 48 cost time: 7.147463798522949
Epoch: 48, Steps: 154 | Train Loss: 1.600 Vali Loss: 5.318 Vali Acc: 0.103 Test Loss: 5.318 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 49 | loss: 0.9246307
	speed: 0.1970s/iter; left time: 1558.1501s
Epoch: 49 cost time: 8.64610767364502
Epoch: 49, Steps: 154 | Train Loss: 1.125 Vali Loss: 5.754 Vali Acc: 0.101 Test Loss: 5.754 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3795620437956204
model parameter : 401974
model size : 6.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 3.7931757
	speed: 0.0675s/iter; left time: 1032.3427s
Epoch: 1 cost time: 9.091042757034302
Epoch: 1, Steps: 154 | Train Loss: 2.236 Vali Loss: 2.186 Vali Acc: 0.322 Test Loss: 2.186 Test Acc: 0.322
Validation loss decreased (inf --> -0.321552).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9382144
	speed: 0.1990s/iter; left time: 3014.0862s
Epoch: 2 cost time: 7.690118312835693
Epoch: 2, Steps: 154 | Train Loss: 2.066 Vali Loss: 2.218 Vali Acc: 0.322 Test Loss: 2.218 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.4731567
	speed: 0.1938s/iter; left time: 2905.2835s
Epoch: 3 cost time: 7.088893413543701
Epoch: 3, Steps: 154 | Train Loss: 1.956 Vali Loss: 2.180 Vali Acc: 0.326 Test Loss: 2.180 Test Acc: 0.326
Validation loss decreased (-0.321552 --> -0.325607).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6344988
	speed: 0.1839s/iter; left time: 2728.2658s
Epoch: 4 cost time: 7.770541429519653
Epoch: 4, Steps: 154 | Train Loss: 1.910 Vali Loss: 2.266 Vali Acc: 0.324 Test Loss: 2.266 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8727887
	speed: 0.1866s/iter; left time: 2740.5741s
Epoch: 5 cost time: 7.225060224533081
Epoch: 5, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.269 Vali Acc: 0.331 Test Loss: 2.269 Test Acc: 0.331
Validation loss decreased (-0.325607 --> -0.330878).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2844310
	speed: 0.1895s/iter; left time: 2753.2138s
Epoch: 6 cost time: 7.200134992599487
Epoch: 6, Steps: 154 | Train Loss: 1.799 Vali Loss: 2.192 Vali Acc: 0.337 Test Loss: 2.192 Test Acc: 0.337
Validation loss decreased (-0.330878 --> -0.336961).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7950573
	speed: 0.1876s/iter; left time: 2696.8570s
Epoch: 7 cost time: 7.688101053237915
Epoch: 7, Steps: 154 | Train Loss: 1.820 Vali Loss: 2.362 Vali Acc: 0.335 Test Loss: 2.362 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.2614824
	speed: 0.1899s/iter; left time: 2700.9491s
Epoch: 8 cost time: 6.903609037399292
Epoch: 8, Steps: 154 | Train Loss: 1.816 Vali Loss: 2.279 Vali Acc: 0.342 Test Loss: 2.279 Test Acc: 0.342
Validation loss decreased (-0.336961 --> -0.341826).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5757529
	speed: 0.2071s/iter; left time: 2914.0971s
Epoch: 9 cost time: 8.193578720092773
Epoch: 9, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.410 Vali Acc: 0.346 Test Loss: 2.410 Test Acc: 0.346
Validation loss decreased (-0.341826 --> -0.346286).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9421418
	speed: 0.2035s/iter; left time: 2831.4256s
Epoch: 10 cost time: 7.872659206390381
Epoch: 10, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.546 Vali Acc: 0.344 Test Loss: 2.546 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.7149086
	speed: 0.2142s/iter; left time: 2948.0664s
Epoch: 11 cost time: 7.459657907485962
Epoch: 11, Steps: 154 | Train Loss: 1.644 Vali Loss: 2.595 Vali Acc: 0.346 Test Loss: 2.595 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.4051718
	speed: 0.1929s/iter; left time: 2624.6744s
Epoch: 12 cost time: 9.123372554779053
Epoch: 12, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.818 Vali Acc: 0.360 Test Loss: 2.818 Test Acc: 0.360
Validation loss decreased (-0.346286 --> -0.360069).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0103290
	speed: 0.2072s/iter; left time: 2787.5672s
Epoch: 13 cost time: 6.057986736297607
Epoch: 13, Steps: 154 | Train Loss: 1.675 Vali Loss: 2.575 Vali Acc: 0.368 Test Loss: 2.575 Test Acc: 0.368
Validation loss decreased (-0.360069 --> -0.367776).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.7015100
	speed: 0.1458s/iter; left time: 1938.8618s
Epoch: 14 cost time: 6.005419015884399
Epoch: 14, Steps: 154 | Train Loss: 1.538 Vali Loss: 2.966 Vali Acc: 0.363 Test Loss: 2.966 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.5780679
	speed: 0.1815s/iter; left time: 2385.9340s
Epoch: 15 cost time: 7.27888035774231
Epoch: 15, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.870 Vali Acc: 0.366 Test Loss: 2.870 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.8682600
	speed: 0.1887s/iter; left time: 2451.5021s
Epoch: 16 cost time: 7.252472877502441
Epoch: 16, Steps: 154 | Train Loss: 1.459 Vali Loss: 3.165 Vali Acc: 0.373 Test Loss: 3.165 Test Acc: 0.373
Validation loss decreased (-0.367776 --> -0.373448).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.7328851
	speed: 0.1837s/iter; left time: 2358.3070s
Epoch: 17 cost time: 7.656294107437134
Epoch: 17, Steps: 154 | Train Loss: 1.494 Vali Loss: 3.109 Vali Acc: 0.354 Test Loss: 3.109 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.5652030
	speed: 0.1875s/iter; left time: 2377.6064s
Epoch: 18 cost time: 7.295821666717529
Epoch: 18, Steps: 154 | Train Loss: 1.470 Vali Loss: 3.181 Vali Acc: 0.363 Test Loss: 3.181 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.5912980
	speed: 0.1935s/iter; left time: 2424.8230s
Epoch: 19 cost time: 7.64288592338562
Epoch: 19, Steps: 154 | Train Loss: 1.524 Vali Loss: 3.689 Vali Acc: 0.354 Test Loss: 3.689 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.2818516
	speed: 0.1883s/iter; left time: 2330.4585s
Epoch: 20 cost time: 6.915637731552124
Epoch: 20, Steps: 154 | Train Loss: 1.412 Vali Loss: 3.522 Vali Acc: 0.370 Test Loss: 3.522 Test Acc: 0.370
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.1642874
	speed: 0.1758s/iter; left time: 2148.7934s
Epoch: 21 cost time: 6.23369288444519
Epoch: 21, Steps: 154 | Train Loss: 1.388 Vali Loss: 3.855 Vali Acc: 0.215 Test Loss: 3.855 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 3.4008069
	speed: 0.1972s/iter; left time: 2380.0601s
Epoch: 22 cost time: 6.708877325057983
Epoch: 22, Steps: 154 | Train Loss: 1.389 Vali Loss: 3.422 Vali Acc: 0.203 Test Loss: 3.422 Test Acc: 0.203
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.6516241
	speed: 0.2029s/iter; left time: 2417.1658s
Epoch: 23 cost time: 7.851769685745239
Epoch: 23, Steps: 154 | Train Loss: 1.437 Vali Loss: 3.519 Vali Acc: 0.385 Test Loss: 3.519 Test Acc: 0.385
Validation loss decreased (-0.373448 --> -0.384799).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.0033646
	speed: 0.1921s/iter; left time: 2258.3626s
Epoch: 24 cost time: 7.634588718414307
Epoch: 24, Steps: 154 | Train Loss: 1.542 Vali Loss: 3.805 Vali Acc: 0.209 Test Loss: 3.805 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.9218401
	speed: 0.1902s/iter; left time: 2207.1541s
Epoch: 25 cost time: 7.116561412811279
Epoch: 25, Steps: 154 | Train Loss: 1.543 Vali Loss: 3.688 Vali Acc: 0.370 Test Loss: 3.688 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.9774693
	speed: 0.1859s/iter; left time: 2129.2789s
Epoch: 26 cost time: 8.302213430404663
Epoch: 26, Steps: 154 | Train Loss: 1.700 Vali Loss: 3.826 Vali Acc: 0.291 Test Loss: 3.826 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.1383604
	speed: 0.1911s/iter; left time: 2159.0211s
Epoch: 27 cost time: 7.468837738037109
Epoch: 27, Steps: 154 | Train Loss: 1.301 Vali Loss: 4.008 Vali Acc: 0.368 Test Loss: 4.008 Test Acc: 0.368
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.1492398
	speed: 0.1894s/iter; left time: 2110.7440s
Epoch: 28 cost time: 7.206653833389282
Epoch: 28, Steps: 154 | Train Loss: 1.191 Vali Loss: 4.172 Vali Acc: 0.131 Test Loss: 4.172 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.6968075
	speed: 0.1932s/iter; left time: 2123.0915s
Epoch: 29 cost time: 8.61191725730896
Epoch: 29, Steps: 154 | Train Loss: 1.165 Vali Loss: 4.263 Vali Acc: 0.372 Test Loss: 4.263 Test Acc: 0.372
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.7144846
	speed: 0.2027s/iter; left time: 2195.8904s
Epoch: 30 cost time: 6.93116307258606
Epoch: 30, Steps: 154 | Train Loss: 1.273 Vali Loss: 3.869 Vali Acc: 0.320 Test Loss: 3.869 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 1.5923922
	speed: 0.1988s/iter; left time: 2123.2577s
Epoch: 31 cost time: 7.572586297988892
Epoch: 31, Steps: 154 | Train Loss: 1.116 Vali Loss: 4.262 Vali Acc: 0.386 Test Loss: 4.262 Test Acc: 0.386
Validation loss decreased (-0.384799 --> -0.386413).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.5596367
	speed: 0.1977s/iter; left time: 2081.5768s
Epoch: 32 cost time: 7.663312673568726
Epoch: 32, Steps: 154 | Train Loss: 1.224 Vali Loss: 5.060 Vali Acc: 0.079 Test Loss: 5.060 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.8708843
	speed: 0.1894s/iter; left time: 1964.2270s
Epoch: 33 cost time: 6.6804399490356445
Epoch: 33, Steps: 154 | Train Loss: 1.309 Vali Loss: 4.540 Vali Acc: 0.366 Test Loss: 4.540 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 1.1983844
	speed: 0.1887s/iter; left time: 1928.8312s
Epoch: 34 cost time: 8.064643621444702
Epoch: 34, Steps: 154 | Train Loss: 1.147 Vali Loss: 4.900 Vali Acc: 0.091 Test Loss: 4.900 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 1.2212589
	speed: 0.1880s/iter; left time: 1892.5515s
Epoch: 35 cost time: 7.148756265640259
Epoch: 35, Steps: 154 | Train Loss: 1.508 Vali Loss: 4.033 Vali Acc: 0.379 Test Loss: 4.033 Test Acc: 0.379
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 1.0270905
	speed: 0.1875s/iter; left time: 1858.6000s
Epoch: 36 cost time: 6.928133726119995
Epoch: 36, Steps: 154 | Train Loss: 1.517 Vali Loss: 3.946 Vali Acc: 0.362 Test Loss: 3.946 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.8122913
	speed: 0.1896s/iter; left time: 1849.4963s
Epoch: 37 cost time: 7.969427585601807
Epoch: 37, Steps: 154 | Train Loss: 1.068 Vali Loss: 5.126 Vali Acc: 0.097 Test Loss: 5.126 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 1.1155465
	speed: 0.1857s/iter; left time: 1782.8825s
Epoch: 38 cost time: 6.9802162647247314
Epoch: 38, Steps: 154 | Train Loss: 1.189 Vali Loss: 4.789 Vali Acc: 0.381 Test Loss: 4.789 Test Acc: 0.381
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 1.2020661
	speed: 0.2051s/iter; left time: 1938.1236s
Epoch: 39 cost time: 7.494153022766113
Epoch: 39, Steps: 154 | Train Loss: 1.306 Vali Loss: 5.046 Vali Acc: 0.382 Test Loss: 5.046 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.7803885
	speed: 0.2100s/iter; left time: 1952.3068s
Epoch: 40 cost time: 8.896345138549805
Epoch: 40, Steps: 154 | Train Loss: 1.135 Vali Loss: 5.070 Vali Acc: 0.114 Test Loss: 5.070 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 1.4474261
	speed: 0.2022s/iter; left time: 1848.6453s
Epoch: 41 cost time: 6.729953765869141
Epoch: 41, Steps: 154 | Train Loss: 1.271 Vali Loss: 5.703 Vali Acc: 0.093 Test Loss: 5.703 Test Acc: 0.093
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.386455798864558
model parameter : 401974
model size : 6.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 3.8198586
	speed: 0.0637s/iter; left time: 974.0078s
Epoch: 1 cost time: 9.307273864746094
Epoch: 1, Steps: 154 | Train Loss: 2.223 Vali Loss: 2.159 Vali Acc: 0.320 Test Loss: 2.159 Test Acc: 0.320
Validation loss decreased (inf --> -0.320335).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9312056
	speed: 0.1913s/iter; left time: 2896.8882s
Epoch: 2 cost time: 6.571625709533691
Epoch: 2, Steps: 154 | Train Loss: 2.055 Vali Loss: 2.218 Vali Acc: 0.321 Test Loss: 2.218 Test Acc: 0.321
Validation loss decreased (-0.320335 --> -0.321146).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4744281
	speed: 0.1836s/iter; left time: 2753.3848s
Epoch: 3 cost time: 7.889980792999268
Epoch: 3, Steps: 154 | Train Loss: 1.983 Vali Loss: 2.147 Vali Acc: 0.329 Test Loss: 2.147 Test Acc: 0.329
Validation loss decreased (-0.321146 --> -0.328851).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6432735
	speed: 0.1834s/iter; left time: 2720.8987s
Epoch: 4 cost time: 6.971502065658569
Epoch: 4, Steps: 154 | Train Loss: 1.890 Vali Loss: 2.277 Vali Acc: 0.326 Test Loss: 2.277 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8436658
	speed: 0.1916s/iter; left time: 2813.3350s
Epoch: 5 cost time: 6.950640916824341
Epoch: 5, Steps: 154 | Train Loss: 1.836 Vali Loss: 2.209 Vali Acc: 0.334 Test Loss: 2.209 Test Acc: 0.334
Validation loss decreased (-0.328851 --> -0.334122).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2150377
	speed: 0.2024s/iter; left time: 2940.3640s
Epoch: 6 cost time: 8.50869107246399
Epoch: 6, Steps: 154 | Train Loss: 1.854 Vali Loss: 2.230 Vali Acc: 0.336 Test Loss: 2.230 Test Acc: 0.336
Validation loss decreased (-0.334122 --> -0.335744).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8391662
	speed: 0.1994s/iter; left time: 2866.9043s
Epoch: 7 cost time: 6.725545883178711
Epoch: 7, Steps: 154 | Train Loss: 1.854 Vali Loss: 2.327 Vali Acc: 0.338 Test Loss: 2.327 Test Acc: 0.338
Validation loss decreased (-0.335744 --> -0.337771).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3358825
	speed: 0.2018s/iter; left time: 2870.3236s
Epoch: 8 cost time: 7.391014575958252
Epoch: 8, Steps: 154 | Train Loss: 1.767 Vali Loss: 2.323 Vali Acc: 0.343 Test Loss: 2.323 Test Acc: 0.343
Validation loss decreased (-0.337771 --> -0.343042).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5474697
	speed: 0.1886s/iter; left time: 2653.1082s
Epoch: 9 cost time: 7.8836774826049805
Epoch: 9, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.433 Vali Acc: 0.352 Test Loss: 2.433 Test Acc: 0.352
Validation loss decreased (-0.343042 --> -0.351557).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9363897
	speed: 0.1868s/iter; left time: 2598.9505s
Epoch: 10 cost time: 6.78131628036499
Epoch: 10, Steps: 154 | Train Loss: 1.801 Vali Loss: 2.523 Vali Acc: 0.346 Test Loss: 2.523 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.6756181
	speed: 0.1905s/iter; left time: 2621.3756s
Epoch: 11 cost time: 7.799383878707886
Epoch: 11, Steps: 154 | Train Loss: 1.741 Vali Loss: 2.716 Vali Acc: 0.345 Test Loss: 2.716 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.5115404
	speed: 0.1891s/iter; left time: 2572.7612s
Epoch: 12 cost time: 7.874833345413208
Epoch: 12, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.622 Vali Acc: 0.363 Test Loss: 2.622 Test Acc: 0.363
Validation loss decreased (-0.351557 --> -0.363315).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9789107
	speed: 0.1883s/iter; left time: 2533.7149s
Epoch: 13 cost time: 7.172180652618408
Epoch: 13, Steps: 154 | Train Loss: 1.689 Vali Loss: 2.576 Vali Acc: 0.219 Test Loss: 2.576 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.7645816
	speed: 0.2066s/iter; left time: 2747.2947s
Epoch: 14 cost time: 8.005545139312744
Epoch: 14, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.776 Vali Acc: 0.369 Test Loss: 2.776 Test Acc: 0.369
Validation loss decreased (-0.363315 --> -0.369396).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.3634366
	speed: 0.2029s/iter; left time: 2667.0819s
Epoch: 15 cost time: 7.332631587982178
Epoch: 15, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.824 Vali Acc: 0.364 Test Loss: 2.824 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.8730599
	speed: 0.2030s/iter; left time: 2637.6595s
Epoch: 16 cost time: 7.314452648162842
Epoch: 16, Steps: 154 | Train Loss: 1.567 Vali Loss: 3.323 Vali Acc: 0.371 Test Loss: 3.323 Test Acc: 0.371
Validation loss decreased (-0.369396 --> -0.371013).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.3499621
	speed: 0.2065s/iter; left time: 2650.8320s
Epoch: 17 cost time: 8.120991945266724
Epoch: 17, Steps: 154 | Train Loss: 1.757 Vali Loss: 3.275 Vali Acc: 0.360 Test Loss: 3.275 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.5230689
	speed: 0.1864s/iter; left time: 2363.5626s
Epoch: 18 cost time: 7.02419900894165
Epoch: 18, Steps: 154 | Train Loss: 1.499 Vali Loss: 3.370 Vali Acc: 0.367 Test Loss: 3.370 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.4130905
	speed: 0.1899s/iter; left time: 2379.3871s
Epoch: 19 cost time: 7.273193359375
Epoch: 19, Steps: 154 | Train Loss: 1.406 Vali Loss: 3.620 Vali Acc: 0.365 Test Loss: 3.620 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.9926895
	speed: 0.1904s/iter; left time: 2355.7599s
Epoch: 20 cost time: 7.9254374504089355
Epoch: 20, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.580 Vali Acc: 0.371 Test Loss: 3.580 Test Acc: 0.371
Validation loss decreased (-0.371013 --> -0.371416).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.8990843
	speed: 0.1835s/iter; left time: 2242.4106s
Epoch: 21 cost time: 7.064312934875488
Epoch: 21, Steps: 154 | Train Loss: 1.396 Vali Loss: 3.758 Vali Acc: 0.209 Test Loss: 3.758 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.8113003
	speed: 0.1934s/iter; left time: 2333.3160s
Epoch: 22 cost time: 7.278719186782837
Epoch: 22, Steps: 154 | Train Loss: 1.436 Vali Loss: 3.751 Vali Acc: 0.225 Test Loss: 3.751 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.1571187
	speed: 0.2037s/iter; left time: 2426.7626s
Epoch: 23 cost time: 8.095901250839233
Epoch: 23, Steps: 154 | Train Loss: 1.525 Vali Loss: 4.000 Vali Acc: 0.377 Test Loss: 4.000 Test Acc: 0.377
Validation loss decreased (-0.371416 --> -0.376683).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.2565469
	speed: 0.1991s/iter; left time: 2341.1067s
Epoch: 24 cost time: 7.440392971038818
Epoch: 24, Steps: 154 | Train Loss: 1.375 Vali Loss: 3.904 Vali Acc: 0.212 Test Loss: 3.904 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.1579256
	speed: 0.2061s/iter; left time: 2392.2483s
Epoch: 25 cost time: 7.305223703384399
Epoch: 25, Steps: 154 | Train Loss: 1.747 Vali Loss: 3.670 Vali Acc: 0.378 Test Loss: 3.670 Test Acc: 0.378
Validation loss decreased (-0.376683 --> -0.378309).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.2533374
	speed: 0.1875s/iter; left time: 2146.5769s
Epoch: 26 cost time: 7.3596110343933105
Epoch: 26, Steps: 154 | Train Loss: 1.304 Vali Loss: 4.265 Vali Acc: 0.246 Test Loss: 4.265 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.2017707
	speed: 0.1635s/iter; left time: 1846.7471s
Epoch: 27 cost time: 6.663723707199097
Epoch: 27, Steps: 154 | Train Loss: 1.132 Vali Loss: 4.821 Vali Acc: 0.359 Test Loss: 4.821 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.8035404
	speed: 0.1941s/iter; left time: 2162.7984s
Epoch: 28 cost time: 7.142405033111572
Epoch: 28, Steps: 154 | Train Loss: 1.472 Vali Loss: 4.761 Vali Acc: 0.233 Test Loss: 4.761 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.6580560
	speed: 0.1933s/iter; left time: 2124.3041s
Epoch: 29 cost time: 7.981768608093262
Epoch: 29, Steps: 154 | Train Loss: 1.364 Vali Loss: 5.295 Vali Acc: 0.296 Test Loss: 5.295 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.7564359
	speed: 0.1934s/iter; left time: 2095.7448s
Epoch: 30 cost time: 7.86065149307251
Epoch: 30, Steps: 154 | Train Loss: 1.348 Vali Loss: 4.795 Vali Acc: 0.209 Test Loss: 4.795 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 1.6432968
	speed: 0.1833s/iter; left time: 1957.5840s
Epoch: 31 cost time: 6.620535850524902
Epoch: 31, Steps: 154 | Train Loss: 1.213 Vali Loss: 4.834 Vali Acc: 0.262 Test Loss: 4.834 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 1.2398688
	speed: 0.2042s/iter; left time: 2149.5444s
Epoch: 32 cost time: 7.503542900085449
Epoch: 32, Steps: 154 | Train Loss: 1.344 Vali Loss: 5.158 Vali Acc: 0.095 Test Loss: 5.158 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 1.1700218
	speed: 0.1947s/iter; left time: 2019.6519s
Epoch: 33 cost time: 7.643985271453857
Epoch: 33, Steps: 154 | Train Loss: 1.180 Vali Loss: 5.359 Vali Acc: 0.245 Test Loss: 5.359 Test Acc: 0.245
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.9032206
	speed: 0.1996s/iter; left time: 2040.0976s
Epoch: 34 cost time: 7.054675579071045
Epoch: 34, Steps: 154 | Train Loss: 1.007 Vali Loss: 4.778 Vali Acc: 0.122 Test Loss: 4.778 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 1.2384949
	speed: 0.1926s/iter; left time: 1938.0945s
Epoch: 35 cost time: 7.716883897781372
Epoch: 35, Steps: 154 | Train Loss: 1.178 Vali Loss: 4.340 Vali Acc: 0.212 Test Loss: 4.340 Test Acc: 0.212
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37834549878345497
model parameter : 401974
model size : 6.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 3.7700789
	speed: 0.0618s/iter; left time: 945.4877s
Epoch: 1 cost time: 8.571429252624512
Epoch: 1, Steps: 154 | Train Loss: 2.202 Vali Loss: 2.168 Vali Acc: 0.318 Test Loss: 2.168 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9067290
	speed: 0.1843s/iter; left time: 2791.1422s
Epoch: 2 cost time: 7.182929039001465
Epoch: 2, Steps: 154 | Train Loss: 2.039 Vali Loss: 2.204 Vali Acc: 0.322 Test Loss: 2.204 Test Acc: 0.322
Validation loss decreased (-0.317902 --> -0.321551).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4912058
	speed: 0.1760s/iter; left time: 2639.2748s
Epoch: 3 cost time: 6.8895347118377686
Epoch: 3, Steps: 154 | Train Loss: 1.980 Vali Loss: 2.154 Vali Acc: 0.328 Test Loss: 2.154 Test Acc: 0.328
Validation loss decreased (-0.321551 --> -0.327635).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6748281
	speed: 0.1806s/iter; left time: 2679.9651s
Epoch: 4 cost time: 6.664760112762451
Epoch: 4, Steps: 154 | Train Loss: 1.879 Vali Loss: 2.268 Vali Acc: 0.326 Test Loss: 2.268 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9645951
	speed: 0.2027s/iter; left time: 2977.1524s
Epoch: 5 cost time: 7.443753480911255
Epoch: 5, Steps: 154 | Train Loss: 1.870 Vali Loss: 2.272 Vali Acc: 0.332 Test Loss: 2.272 Test Acc: 0.332
Validation loss decreased (-0.327635 --> -0.332094).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1659766
	speed: 0.1863s/iter; left time: 2707.0009s
Epoch: 6 cost time: 7.280433416366577
Epoch: 6, Steps: 154 | Train Loss: 1.814 Vali Loss: 2.223 Vali Acc: 0.339 Test Loss: 2.223 Test Acc: 0.339
Validation loss decreased (-0.332094 --> -0.338583).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7856557
	speed: 0.2015s/iter; left time: 2896.8336s
Epoch: 7 cost time: 7.390211343765259
Epoch: 7, Steps: 154 | Train Loss: 1.849 Vali Loss: 2.389 Vali Acc: 0.341 Test Loss: 2.389 Test Acc: 0.341
Validation loss decreased (-0.338583 --> -0.340609).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2451484
	speed: 0.1851s/iter; left time: 2632.1057s
Epoch: 8 cost time: 7.614877462387085
Epoch: 8, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.323 Vali Acc: 0.341 Test Loss: 2.323 Test Acc: 0.341
Validation loss decreased (-0.340609 --> -0.340609).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4915425
	speed: 0.1789s/iter; left time: 2516.3689s
Epoch: 9 cost time: 7.1849424839019775
Epoch: 9, Steps: 154 | Train Loss: 1.660 Vali Loss: 2.379 Vali Acc: 0.348 Test Loss: 2.379 Test Acc: 0.348
Validation loss decreased (-0.340609 --> -0.348314).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1087503
	speed: 0.1806s/iter; left time: 2512.7719s
Epoch: 10 cost time: 6.81136417388916
Epoch: 10, Steps: 154 | Train Loss: 1.753 Vali Loss: 2.375 Vali Acc: 0.359 Test Loss: 2.375 Test Acc: 0.359
Validation loss decreased (-0.348314 --> -0.358857).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4640794
	speed: 0.1751s/iter; left time: 2409.2529s
Epoch: 11 cost time: 7.263097763061523
Epoch: 11, Steps: 154 | Train Loss: 1.660 Vali Loss: 2.560 Vali Acc: 0.355 Test Loss: 2.560 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2605702
	speed: 0.1753s/iter; left time: 2384.8738s
Epoch: 12 cost time: 6.605162143707275
Epoch: 12, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.601 Vali Acc: 0.373 Test Loss: 2.601 Test Acc: 0.373
Validation loss decreased (-0.358857 --> -0.373048).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8557029
	speed: 0.1807s/iter; left time: 2430.3192s
Epoch: 13 cost time: 6.978525876998901
Epoch: 13, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.781 Vali Acc: 0.346 Test Loss: 2.781 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.6742333
	speed: 0.1779s/iter; left time: 2365.7229s
Epoch: 14 cost time: 6.758082628250122
Epoch: 14, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.798 Vali Acc: 0.365 Test Loss: 2.798 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3960501
	speed: 0.1817s/iter; left time: 2388.4031s
Epoch: 15 cost time: 5.73723030090332
Epoch: 15, Steps: 154 | Train Loss: 1.497 Vali Loss: 3.089 Vali Acc: 0.217 Test Loss: 3.089 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.9937084
	speed: 0.1909s/iter; left time: 2480.2107s
Epoch: 16 cost time: 7.664770841598511
Epoch: 16, Steps: 154 | Train Loss: 1.541 Vali Loss: 3.346 Vali Acc: 0.227 Test Loss: 3.346 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.4659206
	speed: 0.1813s/iter; left time: 2327.9595s
Epoch: 17 cost time: 5.944833040237427
Epoch: 17, Steps: 154 | Train Loss: 1.724 Vali Loss: 3.347 Vali Acc: 0.361 Test Loss: 3.347 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.4913422
	speed: 0.1762s/iter; left time: 2234.8223s
Epoch: 18 cost time: 6.807129383087158
Epoch: 18, Steps: 154 | Train Loss: 1.882 Vali Loss: 3.506 Vali Acc: 0.356 Test Loss: 3.506 Test Acc: 0.356
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.3730862
	speed: 0.1783s/iter; left time: 2233.4530s
Epoch: 19 cost time: 7.717641830444336
Epoch: 19, Steps: 154 | Train Loss: 1.389 Vali Loss: 3.670 Vali Acc: 0.359 Test Loss: 3.670 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.0949644
	speed: 0.1790s/iter; left time: 2214.7316s
Epoch: 20 cost time: 6.531523704528809
Epoch: 20, Steps: 154 | Train Loss: 1.532 Vali Loss: 3.711 Vali Acc: 0.374 Test Loss: 3.711 Test Acc: 0.374
Validation loss decreased (-0.373048 --> -0.374253).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.7990016
	speed: 0.1803s/iter; left time: 2203.4842s
Epoch: 21 cost time: 7.186053991317749
Epoch: 21, Steps: 154 | Train Loss: 1.679 Vali Loss: 3.657 Vali Acc: 0.211 Test Loss: 3.657 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.6752968
	speed: 0.1817s/iter; left time: 2192.8701s
Epoch: 22 cost time: 7.816016435623169
Epoch: 22, Steps: 154 | Train Loss: 1.410 Vali Loss: 3.597 Vali Acc: 0.376 Test Loss: 3.597 Test Acc: 0.376
Validation loss decreased (-0.374253 --> -0.375471).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.9946430
	speed: 0.1796s/iter; left time: 2139.6928s
Epoch: 23 cost time: 6.4231908321380615
Epoch: 23, Steps: 154 | Train Loss: 1.429 Vali Loss: 4.353 Vali Acc: 0.369 Test Loss: 4.353 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.4119109
	speed: 0.1824s/iter; left time: 2145.0299s
Epoch: 24 cost time: 6.09316086769104
Epoch: 24, Steps: 154 | Train Loss: 1.513 Vali Loss: 3.827 Vali Acc: 0.358 Test Loss: 3.827 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.2185799
	speed: 0.1711s/iter; left time: 1985.3629s
Epoch: 25 cost time: 7.354182481765747
Epoch: 25, Steps: 154 | Train Loss: 1.385 Vali Loss: 3.898 Vali Acc: 0.388 Test Loss: 3.898 Test Acc: 0.388
Validation loss decreased (-0.375471 --> -0.388039).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.0799780
	speed: 0.1834s/iter; left time: 2100.1859s
Epoch: 26 cost time: 6.31389594078064
Epoch: 26, Steps: 154 | Train Loss: 1.201 Vali Loss: 4.245 Vali Acc: 0.251 Test Loss: 4.245 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.0203724
	speed: 0.1760s/iter; left time: 1988.2628s
Epoch: 27 cost time: 6.545754432678223
Epoch: 27, Steps: 154 | Train Loss: 1.369 Vali Loss: 4.461 Vali Acc: 0.371 Test Loss: 4.461 Test Acc: 0.371
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.8561379
	speed: 0.1778s/iter; left time: 1981.7601s
Epoch: 28 cost time: 7.0217602252960205
Epoch: 28, Steps: 154 | Train Loss: 1.807 Vali Loss: 4.304 Vali Acc: 0.305 Test Loss: 4.304 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.6172972
	speed: 0.1736s/iter; left time: 1907.6943s
Epoch: 29 cost time: 6.604315519332886
Epoch: 29, Steps: 154 | Train Loss: 1.052 Vali Loss: 4.931 Vali Acc: 0.107 Test Loss: 4.931 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.4942587
	speed: 0.1764s/iter; left time: 1910.7961s
Epoch: 30 cost time: 6.667792081832886
Epoch: 30, Steps: 154 | Train Loss: 1.356 Vali Loss: 4.689 Vali Acc: 0.380 Test Loss: 4.689 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 2.0489612
	speed: 0.1756s/iter; left time: 1875.4051s
Epoch: 31 cost time: 6.854872941970825
Epoch: 31, Steps: 154 | Train Loss: 1.269 Vali Loss: 4.579 Vali Acc: 0.385 Test Loss: 4.579 Test Acc: 0.385
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 1.1501819
	speed: 0.1714s/iter; left time: 1803.8534s
Epoch: 32 cost time: 6.73100471496582
Epoch: 32, Steps: 154 | Train Loss: 1.120 Vali Loss: 4.621 Vali Acc: 0.339 Test Loss: 4.621 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 1.0126938
	speed: 0.1891s/iter; left time: 1961.2847s
Epoch: 33 cost time: 6.518870115280151
Epoch: 33, Steps: 154 | Train Loss: 1.488 Vali Loss: 5.538 Vali Acc: 0.144 Test Loss: 5.538 Test Acc: 0.144
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.9076104
	speed: 0.1787s/iter; left time: 1825.8087s
Epoch: 34 cost time: 7.663558483123779
Epoch: 34, Steps: 154 | Train Loss: 1.173 Vali Loss: 5.743 Vali Acc: 0.111 Test Loss: 5.743 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.7611103
	speed: 0.1864s/iter; left time: 1875.6337s
Epoch: 35 cost time: 6.933886289596558
Epoch: 35, Steps: 154 | Train Loss: 1.018 Vali Loss: 5.701 Vali Acc: 0.390 Test Loss: 5.701 Test Acc: 0.390
Validation loss decreased (-0.388039 --> -0.390048).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.7199491
	speed: 0.1825s/iter; left time: 1808.4714s
Epoch: 36 cost time: 6.7459211349487305
Epoch: 36, Steps: 154 | Train Loss: 1.396 Vali Loss: 5.485 Vali Acc: 0.179 Test Loss: 5.485 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.8098107
	speed: 0.1769s/iter; left time: 1725.5702s
Epoch: 37 cost time: 7.5943145751953125
Epoch: 37, Steps: 154 | Train Loss: 1.264 Vali Loss: 6.065 Vali Acc: 0.101 Test Loss: 6.065 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.9113694
	speed: 0.1748s/iter; left time: 1679.0572s
Epoch: 38 cost time: 6.978171348571777
Epoch: 38, Steps: 154 | Train Loss: 1.244 Vali Loss: 5.102 Vali Acc: 0.242 Test Loss: 5.102 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.9232720
	speed: 0.1769s/iter; left time: 1671.2522s
Epoch: 39 cost time: 6.5957934856414795
Epoch: 39, Steps: 154 | Train Loss: 1.165 Vali Loss: 6.368 Vali Acc: 0.114 Test Loss: 6.368 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.9077444
	speed: 0.1699s/iter; left time: 1579.6542s
Epoch: 40 cost time: 7.269371271133423
Epoch: 40, Steps: 154 | Train Loss: 1.392 Vali Loss: 6.897 Vali Acc: 0.109 Test Loss: 6.897 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.9121569
	speed: 0.1736s/iter; left time: 1587.2903s
Epoch: 41 cost time: 6.256567478179932
Epoch: 41, Steps: 154 | Train Loss: 1.321 Vali Loss: 5.914 Vali Acc: 0.336 Test Loss: 5.914 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 1.8811076
	speed: 0.1807s/iter; left time: 1624.1483s
Epoch: 42 cost time: 6.270758390426636
Epoch: 42, Steps: 154 | Train Loss: 1.539 Vali Loss: 6.943 Vali Acc: 0.195 Test Loss: 6.943 Test Acc: 0.195
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.4271280
	speed: 0.1806s/iter; left time: 1595.6516s
Epoch: 43 cost time: 6.975378036499023
Epoch: 43, Steps: 154 | Train Loss: 1.127 Vali Loss: 8.011 Vali Acc: 0.105 Test Loss: 8.011 Test Acc: 0.105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.7910594
	speed: 0.1888s/iter; left time: 1638.2919s
Epoch: 44 cost time: 6.322579860687256
Epoch: 44, Steps: 154 | Train Loss: 1.061 Vali Loss: 6.529 Vali Acc: 0.184 Test Loss: 6.529 Test Acc: 0.184
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.3185895
	speed: 0.1849s/iter; left time: 1576.5435s
Epoch: 45 cost time: 6.535661697387695
Epoch: 45, Steps: 154 | Train Loss: 0.877 Vali Loss: 6.603 Vali Acc: 0.149 Test Loss: 6.603 Test Acc: 0.149
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39010543390105434
model parameter : 401974
model size : 6.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0728183
	speed: 0.0618s/iter; left time: 945.5539s
Epoch: 1 cost time: 8.327043533325195
Epoch: 1, Steps: 154 | Train Loss: 2.241 Vali Loss: 2.196 Vali Acc: 0.322 Test Loss: 2.196 Test Acc: 0.322
Validation loss decreased (inf --> -0.321957).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5631548
	speed: 0.1819s/iter; left time: 2755.4164s
Epoch: 2 cost time: 7.213665246963501
Epoch: 2, Steps: 154 | Train Loss: 2.061 Vali Loss: 2.169 Vali Acc: 0.324 Test Loss: 2.169 Test Acc: 0.324
Validation loss decreased (-0.321957 --> -0.323579).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9725969
	speed: 0.1778s/iter; left time: 2665.0151s
Epoch: 3 cost time: 7.478638172149658
Epoch: 3, Steps: 154 | Train Loss: 1.986 Vali Loss: 2.274 Vali Acc: 0.325 Test Loss: 2.274 Test Acc: 0.325
Validation loss decreased (-0.323579 --> -0.325200).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4102154
	speed: 0.1824s/iter; left time: 2706.8555s
Epoch: 4 cost time: 6.59987998008728
Epoch: 4, Steps: 154 | Train Loss: 2.022 Vali Loss: 2.258 Vali Acc: 0.327 Test Loss: 2.258 Test Acc: 0.327
Validation loss decreased (-0.325200 --> -0.327228).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0831199
	speed: 0.1879s/iter; left time: 2759.4005s
Epoch: 5 cost time: 7.714114189147949
Epoch: 5, Steps: 154 | Train Loss: 1.925 Vali Loss: 2.272 Vali Acc: 0.329 Test Loss: 2.272 Test Acc: 0.329
Validation loss decreased (-0.327228 --> -0.329255).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9111186
	speed: 0.1974s/iter; left time: 2868.5288s
Epoch: 6 cost time: 7.540270090103149
Epoch: 6, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.356 Vali Acc: 0.332 Test Loss: 2.356 Test Acc: 0.332
Validation loss decreased (-0.329255 --> -0.332093).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7889891
	speed: 0.1928s/iter; left time: 2772.5385s
Epoch: 7 cost time: 6.566524505615234
Epoch: 7, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.301 Vali Acc: 0.339 Test Loss: 2.301 Test Acc: 0.339
Validation loss decreased (-0.332093 --> -0.339393).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0401719
	speed: 0.1876s/iter; left time: 2668.6716s
Epoch: 8 cost time: 6.700809001922607
Epoch: 8, Steps: 154 | Train Loss: 1.809 Vali Loss: 2.409 Vali Acc: 0.338 Test Loss: 2.409 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6347773
	speed: 0.2135s/iter; left time: 3004.0574s
Epoch: 9 cost time: 8.583972215652466
Epoch: 9, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.329 Vali Acc: 0.186 Test Loss: 2.329 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8817265
	speed: 0.1518s/iter; left time: 2112.2880s
Epoch: 10 cost time: 4.872624635696411
Epoch: 10, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.546 Vali Acc: 0.355 Test Loss: 2.546 Test Acc: 0.355
Validation loss decreased (-0.339393 --> -0.354800).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.5368397
	speed: 0.1285s/iter; left time: 1768.2375s
Epoch: 11 cost time: 5.560707092285156
Epoch: 11, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.608 Vali Acc: 0.357 Test Loss: 2.608 Test Acc: 0.357
Validation loss decreased (-0.354800 --> -0.356827).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1484090
	speed: 0.1677s/iter; left time: 2282.4151s
Epoch: 12 cost time: 7.416588306427002
Epoch: 12, Steps: 154 | Train Loss: 1.670 Vali Loss: 2.684 Vali Acc: 0.354 Test Loss: 2.684 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5322866
	speed: 0.1774s/iter; left time: 2386.0344s
Epoch: 13 cost time: 7.057073354721069
Epoch: 13, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.812 Vali Acc: 0.369 Test Loss: 2.812 Test Acc: 0.369
Validation loss decreased (-0.356827 --> -0.368585).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3092074
	speed: 0.1883s/iter; left time: 2504.5570s
Epoch: 14 cost time: 7.287738561630249
Epoch: 14, Steps: 154 | Train Loss: 1.653 Vali Loss: 2.783 Vali Acc: 0.353 Test Loss: 2.783 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.7820673
	speed: 0.1839s/iter; left time: 2417.3163s
Epoch: 15 cost time: 7.396794319152832
Epoch: 15, Steps: 154 | Train Loss: 1.582 Vali Loss: 3.074 Vali Acc: 0.351 Test Loss: 3.074 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.4137735
	speed: 0.1862s/iter; left time: 2418.8117s
Epoch: 16 cost time: 7.074232339859009
Epoch: 16, Steps: 154 | Train Loss: 1.507 Vali Loss: 3.350 Vali Acc: 0.351 Test Loss: 3.350 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.5133810
	speed: 0.2038s/iter; left time: 2616.2427s
Epoch: 17 cost time: 7.901135444641113
Epoch: 17, Steps: 154 | Train Loss: 1.462 Vali Loss: 3.147 Vali Acc: 0.207 Test Loss: 3.147 Test Acc: 0.207
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.5287575
	speed: 0.1941s/iter; left time: 2461.4299s
Epoch: 18 cost time: 7.314842939376831
Epoch: 18, Steps: 154 | Train Loss: 1.539 Vali Loss: 3.337 Vali Acc: 0.375 Test Loss: 3.337 Test Acc: 0.375
Validation loss decreased (-0.368585 --> -0.375068).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.6583033
	speed: 0.2100s/iter; left time: 2630.5944s
Epoch: 19 cost time: 7.443222761154175
Epoch: 19, Steps: 154 | Train Loss: 1.830 Vali Loss: 3.441 Vali Acc: 0.234 Test Loss: 3.441 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.4437490
	speed: 0.2009s/iter; left time: 2485.5286s
Epoch: 20 cost time: 7.920893669128418
Epoch: 20, Steps: 154 | Train Loss: 1.535 Vali Loss: 3.966 Vali Acc: 0.162 Test Loss: 3.966 Test Acc: 0.162
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.0197376
	speed: 0.1878s/iter; left time: 2294.9502s
Epoch: 21 cost time: 6.865755796432495
Epoch: 21, Steps: 154 | Train Loss: 1.408 Vali Loss: 3.497 Vali Acc: 0.362 Test Loss: 3.497 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.0619482
	speed: 0.1781s/iter; left time: 2149.1528s
Epoch: 22 cost time: 7.3634161949157715
Epoch: 22, Steps: 154 | Train Loss: 1.302 Vali Loss: 3.765 Vali Acc: 0.360 Test Loss: 3.765 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.0876652
	speed: 0.1876s/iter; left time: 2235.3807s
Epoch: 23 cost time: 7.940791368484497
Epoch: 23, Steps: 154 | Train Loss: 1.554 Vali Loss: 3.214 Vali Acc: 0.376 Test Loss: 3.214 Test Acc: 0.376
Validation loss decreased (-0.375068 --> -0.376286).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.4275187
	speed: 0.1864s/iter; left time: 2192.1944s
Epoch: 24 cost time: 6.744801759719849
Epoch: 24, Steps: 154 | Train Loss: 1.359 Vali Loss: 3.664 Vali Acc: 0.202 Test Loss: 3.664 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.1138077
	speed: 0.1883s/iter; left time: 2185.3507s
Epoch: 25 cost time: 7.695749998092651
Epoch: 25, Steps: 154 | Train Loss: 1.564 Vali Loss: 3.412 Vali Acc: 0.372 Test Loss: 3.412 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.8426673
	speed: 0.1928s/iter; left time: 2207.7307s
Epoch: 26 cost time: 7.478655815124512
Epoch: 26, Steps: 154 | Train Loss: 1.458 Vali Loss: 4.613 Vali Acc: 0.198 Test Loss: 4.613 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.9147995
	speed: 0.1989s/iter; left time: 2246.5943s
Epoch: 27 cost time: 6.71394419670105
Epoch: 27, Steps: 154 | Train Loss: 1.478 Vali Loss: 3.710 Vali Acc: 0.376 Test Loss: 3.710 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.1736667
	speed: 0.2069s/iter; left time: 2305.0271s
Epoch: 28 cost time: 8.504248142242432
Epoch: 28, Steps: 154 | Train Loss: 1.570 Vali Loss: 4.106 Vali Acc: 0.202 Test Loss: 4.106 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 1.2696079
	speed: 0.1908s/iter; left time: 2097.1416s
Epoch: 29 cost time: 6.565778970718384
Epoch: 29, Steps: 154 | Train Loss: 1.284 Vali Loss: 4.822 Vali Acc: 0.086 Test Loss: 4.822 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.9113271
	speed: 0.1833s/iter; left time: 1986.1013s
Epoch: 30 cost time: 7.2430243492126465
Epoch: 30, Steps: 154 | Train Loss: 1.215 Vali Loss: 4.735 Vali Acc: 0.271 Test Loss: 4.735 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 1.4033897
	speed: 0.1852s/iter; left time: 1978.3879s
Epoch: 31 cost time: 7.882006645202637
Epoch: 31, Steps: 154 | Train Loss: 1.351 Vali Loss: 4.847 Vali Acc: 0.105 Test Loss: 4.847 Test Acc: 0.105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.9214753
	speed: 0.1878s/iter; left time: 1977.0287s
Epoch: 32 cost time: 7.041390419006348
Epoch: 32, Steps: 154 | Train Loss: 1.232 Vali Loss: 4.683 Vali Acc: 0.090 Test Loss: 4.683 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 1.0467701
	speed: 0.1945s/iter; left time: 2017.9484s
Epoch: 33 cost time: 7.756556987762451
Epoch: 33, Steps: 154 | Train Loss: 1.445 Vali Loss: 5.179 Vali Acc: 0.292 Test Loss: 5.179 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37631792376317924
model parameter : 336438
model size : 6.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0792992
	speed: 0.0663s/iter; left time: 1014.8248s
Epoch: 1 cost time: 9.198015689849854
Epoch: 1, Steps: 154 | Train Loss: 2.236 Vali Loss: 2.197 Vali Acc: 0.321 Test Loss: 2.197 Test Acc: 0.321
Validation loss decreased (inf --> -0.320740).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5763425
	speed: 0.2083s/iter; left time: 3155.1105s
Epoch: 2 cost time: 8.270066261291504
Epoch: 2, Steps: 154 | Train Loss: 2.058 Vali Loss: 2.177 Vali Acc: 0.321 Test Loss: 2.177 Test Acc: 0.321
Validation loss decreased (-0.320740 --> -0.320741).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9719833
	speed: 0.1971s/iter; left time: 2955.6728s
Epoch: 3 cost time: 7.012536525726318
Epoch: 3, Steps: 154 | Train Loss: 1.986 Vali Loss: 2.242 Vali Acc: 0.325 Test Loss: 2.242 Test Acc: 0.325
Validation loss decreased (-0.320741 --> -0.324795).  Saving model ...
	iters: 100, epoch: 4 | loss: 7.7164526
	speed: 0.2013s/iter; left time: 2987.2108s
Epoch: 4 cost time: 7.375531435012817
Epoch: 4, Steps: 154 | Train Loss: 1.984 Vali Loss: 2.238 Vali Acc: 0.326 Test Loss: 2.238 Test Acc: 0.326
Validation loss decreased (-0.324795 --> -0.325606).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0512514
	speed: 0.1898s/iter; left time: 2787.6562s
Epoch: 5 cost time: 8.000268459320068
Epoch: 5, Steps: 154 | Train Loss: 1.859 Vali Loss: 2.233 Vali Acc: 0.329 Test Loss: 2.233 Test Acc: 0.329
Validation loss decreased (-0.325606 --> -0.328850).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9257963
	speed: 0.1901s/iter; left time: 2762.6877s
Epoch: 6 cost time: 7.0244622230529785
Epoch: 6, Steps: 154 | Train Loss: 1.824 Vali Loss: 2.301 Vali Acc: 0.337 Test Loss: 2.301 Test Acc: 0.337
Validation loss decreased (-0.328850 --> -0.336554).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7654177
	speed: 0.1937s/iter; left time: 2785.3100s
Epoch: 7 cost time: 7.724438428878784
Epoch: 7, Steps: 154 | Train Loss: 1.780 Vali Loss: 2.267 Vali Acc: 0.337 Test Loss: 2.267 Test Acc: 0.337
Validation loss decreased (-0.336554 --> -0.337366).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0171003
	speed: 0.1844s/iter; left time: 2623.4179s
Epoch: 8 cost time: 7.204967737197876
Epoch: 8, Steps: 154 | Train Loss: 1.689 Vali Loss: 2.364 Vali Acc: 0.342 Test Loss: 2.364 Test Acc: 0.342
Validation loss decreased (-0.337366 --> -0.341826).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7716731
	speed: 0.1861s/iter; left time: 2617.8796s
Epoch: 9 cost time: 7.152820825576782
Epoch: 9, Steps: 154 | Train Loss: 1.779 Vali Loss: 2.459 Vali Acc: 0.201 Test Loss: 2.459 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.8885150
	speed: 0.2082s/iter; left time: 2897.0886s
Epoch: 10 cost time: 8.14130425453186
Epoch: 10, Steps: 154 | Train Loss: 1.662 Vali Loss: 2.435 Vali Acc: 0.363 Test Loss: 2.435 Test Acc: 0.363
Validation loss decreased (-0.341826 --> -0.362912).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6270348
	speed: 0.1982s/iter; left time: 2728.0964s
Epoch: 11 cost time: 6.591502904891968
Epoch: 11, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.761 Vali Acc: 0.355 Test Loss: 2.761 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1087021
	speed: 0.2053s/iter; left time: 2793.5874s
Epoch: 12 cost time: 7.446187257766724
Epoch: 12, Steps: 154 | Train Loss: 1.698 Vali Loss: 2.501 Vali Acc: 0.361 Test Loss: 2.501 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.7666826
	speed: 0.1960s/iter; left time: 2636.6995s
Epoch: 13 cost time: 7.889667510986328
Epoch: 13, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.525 Vali Acc: 0.365 Test Loss: 2.525 Test Acc: 0.365
Validation loss decreased (-0.362912 --> -0.364938).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.1249932
	speed: 0.1943s/iter; left time: 2584.2692s
Epoch: 14 cost time: 7.371733665466309
Epoch: 14, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.908 Vali Acc: 0.360 Test Loss: 2.908 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.9650660
	speed: 0.1915s/iter; left time: 2516.6830s
Epoch: 15 cost time: 7.80520224571228
Epoch: 15, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.995 Vali Acc: 0.358 Test Loss: 2.995 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.3894399
	speed: 0.1891s/iter; left time: 2455.9623s
Epoch: 16 cost time: 7.534599542617798
Epoch: 16, Steps: 154 | Train Loss: 1.544 Vali Loss: 3.081 Vali Acc: 0.354 Test Loss: 3.081 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.5946102
	speed: 0.1932s/iter; left time: 2480.3988s
Epoch: 17 cost time: 7.536601781845093
Epoch: 17, Steps: 154 | Train Loss: 1.553 Vali Loss: 3.283 Vali Acc: 0.205 Test Loss: 3.283 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.7778833
	speed: 0.1945s/iter; left time: 2466.6035s
Epoch: 18 cost time: 7.792834997177124
Epoch: 18, Steps: 154 | Train Loss: 1.415 Vali Loss: 3.215 Vali Acc: 0.368 Test Loss: 3.215 Test Acc: 0.368
Validation loss decreased (-0.364938 --> -0.367770).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.2478778
	speed: 0.1954s/iter; left time: 2448.7086s
Epoch: 19 cost time: 7.421085834503174
Epoch: 19, Steps: 154 | Train Loss: 1.643 Vali Loss: 3.089 Vali Acc: 0.368 Test Loss: 3.089 Test Acc: 0.368
Validation loss decreased (-0.367770 --> -0.368177).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.2414142
	speed: 0.2077s/iter; left time: 2570.7962s
Epoch: 20 cost time: 7.146552085876465
Epoch: 20, Steps: 154 | Train Loss: 1.496 Vali Loss: 3.321 Vali Acc: 0.374 Test Loss: 3.321 Test Acc: 0.374
Validation loss decreased (-0.368177 --> -0.374257).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.0116941
	speed: 0.2029s/iter; left time: 2479.0890s
Epoch: 21 cost time: 7.759379625320435
Epoch: 21, Steps: 154 | Train Loss: 1.503 Vali Loss: 3.493 Vali Acc: 0.367 Test Loss: 3.493 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.2298445
	speed: 0.2039s/iter; left time: 2460.9455s
Epoch: 22 cost time: 7.422193765640259
Epoch: 22, Steps: 154 | Train Loss: 1.283 Vali Loss: 3.969 Vali Acc: 0.365 Test Loss: 3.969 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.8437948
	speed: 0.1896s/iter; left time: 2259.1641s
Epoch: 23 cost time: 6.994082450866699
Epoch: 23, Steps: 154 | Train Loss: 1.619 Vali Loss: 3.566 Vali Acc: 0.380 Test Loss: 3.566 Test Acc: 0.380
Validation loss decreased (-0.374257 --> -0.379526).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.1201106
	speed: 0.1910s/iter; left time: 2245.7956s
Epoch: 24 cost time: 7.511545181274414
Epoch: 24, Steps: 154 | Train Loss: 1.478 Vali Loss: 3.716 Vali Acc: 0.230 Test Loss: 3.716 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.0723684
	speed: 0.1819s/iter; left time: 2111.4723s
Epoch: 25 cost time: 7.156747102737427
Epoch: 25, Steps: 154 | Train Loss: 1.532 Vali Loss: 4.449 Vali Acc: 0.382 Test Loss: 4.449 Test Acc: 0.382
Validation loss decreased (-0.379526 --> -0.381951).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.0497187
	speed: 0.1925s/iter; left time: 2204.8330s
Epoch: 26 cost time: 7.473792314529419
Epoch: 26, Steps: 154 | Train Loss: 1.387 Vali Loss: 4.158 Vali Acc: 0.384 Test Loss: 4.158 Test Acc: 0.384
Validation loss decreased (-0.381951 --> -0.383981).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.6721452
	speed: 0.1852s/iter; left time: 2091.8012s
Epoch: 27 cost time: 7.344452142715454
Epoch: 27, Steps: 154 | Train Loss: 1.332 Vali Loss: 4.180 Vali Acc: 0.386 Test Loss: 4.180 Test Acc: 0.386
Validation loss decreased (-0.383981 --> -0.386008).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.1539388
	speed: 0.2109s/iter; left time: 2350.2882s
Epoch: 28 cost time: 7.711636304855347
Epoch: 28, Steps: 154 | Train Loss: 1.464 Vali Loss: 4.801 Vali Acc: 0.118 Test Loss: 4.801 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.6640745
	speed: 0.2090s/iter; left time: 2296.2409s
Epoch: 29 cost time: 8.157543420791626
Epoch: 29, Steps: 154 | Train Loss: 1.274 Vali Loss: 4.674 Vali Acc: 0.374 Test Loss: 4.674 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 1.1232859
	speed: 0.2007s/iter; left time: 2174.4631s
Epoch: 30 cost time: 7.552278757095337
Epoch: 30, Steps: 154 | Train Loss: 1.459 Vali Loss: 5.242 Vali Acc: 0.358 Test Loss: 5.242 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 1.4144107
	speed: 0.1691s/iter; left time: 1805.8992s
Epoch: 31 cost time: 6.068850040435791
Epoch: 31, Steps: 154 | Train Loss: 1.234 Vali Loss: 4.977 Vali Acc: 0.112 Test Loss: 4.977 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.6948341
	speed: 0.1830s/iter; left time: 1926.6648s
Epoch: 32 cost time: 7.51630711555481
Epoch: 32, Steps: 154 | Train Loss: 1.217 Vali Loss: 4.337 Vali Acc: 0.137 Test Loss: 4.337 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 1.0291283
	speed: 0.1883s/iter; left time: 1953.1515s
Epoch: 33 cost time: 7.966455459594727
Epoch: 33, Steps: 154 | Train Loss: 1.084 Vali Loss: 4.521 Vali Acc: 0.304 Test Loss: 4.521 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.8861985
	speed: 0.1934s/iter; left time: 1976.6115s
Epoch: 34 cost time: 6.844544887542725
Epoch: 34, Steps: 154 | Train Loss: 1.180 Vali Loss: 5.360 Vali Acc: 0.197 Test Loss: 5.360 Test Acc: 0.197
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 1.3515247
	speed: 0.1910s/iter; left time: 1922.6905s
Epoch: 35 cost time: 7.194394826889038
Epoch: 35, Steps: 154 | Train Loss: 1.144 Vali Loss: 5.159 Vali Acc: 0.095 Test Loss: 5.159 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 1.2003510
	speed: 0.1974s/iter; left time: 1956.6585s
Epoch: 36 cost time: 8.109071016311646
Epoch: 36, Steps: 154 | Train Loss: 1.262 Vali Loss: 4.938 Vali Acc: 0.296 Test Loss: 4.938 Test Acc: 0.296
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.6681466
	speed: 0.2033s/iter; left time: 1983.7733s
Epoch: 37 cost time: 7.051524639129639
Epoch: 37, Steps: 154 | Train Loss: 1.898 Vali Loss: 5.239 Vali Acc: 0.217 Test Loss: 5.239 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38605028386050283
model parameter : 336438
model size : 6.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0879972
	speed: 0.0654s/iter; left time: 1001.2365s
Epoch: 1 cost time: 8.864698886871338
Epoch: 1, Steps: 154 | Train Loss: 2.225 Vali Loss: 2.187 Vali Acc: 0.320 Test Loss: 2.187 Test Acc: 0.320
Validation loss decreased (inf --> -0.320335).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6716824
	speed: 0.1827s/iter; left time: 2767.6063s
Epoch: 2 cost time: 6.801022052764893
Epoch: 2, Steps: 154 | Train Loss: 2.051 Vali Loss: 2.165 Vali Acc: 0.322 Test Loss: 2.165 Test Acc: 0.322
Validation loss decreased (-0.320335 --> -0.321552).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9752494
	speed: 0.1841s/iter; left time: 2759.6558s
Epoch: 3 cost time: 7.361840724945068
Epoch: 3, Steps: 154 | Train Loss: 1.966 Vali Loss: 2.209 Vali Acc: 0.324 Test Loss: 2.209 Test Acc: 0.324
Validation loss decreased (-0.321552 --> -0.323579).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.9999018
	speed: 0.1814s/iter; left time: 2691.4124s
Epoch: 4 cost time: 7.442034721374512
Epoch: 4, Steps: 154 | Train Loss: 1.975 Vali Loss: 2.230 Vali Acc: 0.328 Test Loss: 2.230 Test Acc: 0.328
Validation loss decreased (-0.323579 --> -0.328445).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9596703
	speed: 0.1867s/iter; left time: 2741.2371s
Epoch: 5 cost time: 7.213208436965942
Epoch: 5, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.245 Vali Acc: 0.332 Test Loss: 2.245 Test Acc: 0.332
Validation loss decreased (-0.328445 --> -0.332094).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9049770
	speed: 0.1905s/iter; left time: 2767.5363s
Epoch: 6 cost time: 7.5640387535095215
Epoch: 6, Steps: 154 | Train Loss: 1.830 Vali Loss: 2.329 Vali Acc: 0.333 Test Loss: 2.329 Test Acc: 0.333
Validation loss decreased (-0.332094 --> -0.332905).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8348660
	speed: 0.1914s/iter; left time: 2752.1201s
Epoch: 7 cost time: 7.912050485610962
Epoch: 7, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.286 Vali Acc: 0.343 Test Loss: 2.286 Test Acc: 0.343
Validation loss decreased (-0.332905 --> -0.342637).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8686743
	speed: 0.2041s/iter; left time: 2903.0631s
Epoch: 8 cost time: 7.297327041625977
Epoch: 8, Steps: 154 | Train Loss: 1.764 Vali Loss: 2.419 Vali Acc: 0.344 Test Loss: 2.419 Test Acc: 0.344
Validation loss decreased (-0.342637 --> -0.343853).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6053969
	speed: 0.2040s/iter; left time: 2869.5655s
Epoch: 9 cost time: 7.2651121616363525
Epoch: 9, Steps: 154 | Train Loss: 1.845 Vali Loss: 2.519 Vali Acc: 0.208 Test Loss: 2.519 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.8753269
	speed: 0.1987s/iter; left time: 2765.1959s
Epoch: 10 cost time: 7.2037177085876465
Epoch: 10, Steps: 154 | Train Loss: 1.757 Vali Loss: 2.617 Vali Acc: 0.357 Test Loss: 2.617 Test Acc: 0.357
Validation loss decreased (-0.343853 --> -0.356827).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5188550
	speed: 0.1874s/iter; left time: 2578.7923s
Epoch: 11 cost time: 6.844853401184082
Epoch: 11, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.805 Vali Acc: 0.358 Test Loss: 2.805 Test Acc: 0.358
Validation loss decreased (-0.356827 --> -0.357636).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0238868
	speed: 0.1836s/iter; left time: 2498.2681s
Epoch: 12 cost time: 7.259296894073486
Epoch: 12, Steps: 154 | Train Loss: 1.680 Vali Loss: 2.608 Vali Acc: 0.363 Test Loss: 2.608 Test Acc: 0.363
Validation loss decreased (-0.357636 --> -0.362504).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5191245
	speed: 0.1787s/iter; left time: 2404.1763s
Epoch: 13 cost time: 7.239243030548096
Epoch: 13, Steps: 154 | Train Loss: 1.666 Vali Loss: 2.752 Vali Acc: 0.363 Test Loss: 2.752 Test Acc: 0.363
Validation loss decreased (-0.362504 --> -0.362908).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4683218
	speed: 0.1811s/iter; left time: 2407.9149s
Epoch: 14 cost time: 6.5539915561676025
Epoch: 14, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.925 Vali Acc: 0.358 Test Loss: 2.925 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.9458859
	speed: 0.1806s/iter; left time: 2374.5234s
Epoch: 15 cost time: 6.8960981369018555
Epoch: 15, Steps: 154 | Train Loss: 1.547 Vali Loss: 3.014 Vali Acc: 0.366 Test Loss: 3.014 Test Acc: 0.366
Validation loss decreased (-0.362908 --> -0.366150).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.7836999
	speed: 0.1718s/iter; left time: 2231.5921s
Epoch: 16 cost time: 7.014849424362183
Epoch: 16, Steps: 154 | Train Loss: 1.705 Vali Loss: 3.387 Vali Acc: 0.361 Test Loss: 3.387 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.3037291
	speed: 0.1975s/iter; left time: 2535.5071s
Epoch: 17 cost time: 6.479463338851929
Epoch: 17, Steps: 154 | Train Loss: 1.551 Vali Loss: 3.523 Vali Acc: 0.206 Test Loss: 3.523 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.7217648
	speed: 0.1899s/iter; left time: 2408.4817s
Epoch: 18 cost time: 7.644382476806641
Epoch: 18, Steps: 154 | Train Loss: 1.617 Vali Loss: 3.557 Vali Acc: 0.368 Test Loss: 3.557 Test Acc: 0.368
Validation loss decreased (-0.366150 --> -0.368172).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.3310623
	speed: 0.1959s/iter; left time: 2454.0486s
Epoch: 19 cost time: 7.107706069946289
Epoch: 19, Steps: 154 | Train Loss: 1.554 Vali Loss: 3.505 Vali Acc: 0.209 Test Loss: 3.505 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.4222151
	speed: 0.1867s/iter; left time: 2310.3880s
Epoch: 20 cost time: 6.91053581237793
Epoch: 20, Steps: 154 | Train Loss: 1.560 Vali Loss: 3.647 Vali Acc: 0.361 Test Loss: 3.647 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.8600368
	speed: 0.1823s/iter; left time: 2228.0159s
Epoch: 21 cost time: 8.018799543380737
Epoch: 21, Steps: 154 | Train Loss: 1.468 Vali Loss: 3.571 Vali Acc: 0.368 Test Loss: 3.571 Test Acc: 0.368
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.7397695
	speed: 0.1842s/iter; left time: 2222.7952s
Epoch: 22 cost time: 7.254647493362427
Epoch: 22, Steps: 154 | Train Loss: 1.460 Vali Loss: 4.291 Vali Acc: 0.358 Test Loss: 4.291 Test Acc: 0.358
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.2635090
	speed: 0.1845s/iter; left time: 2198.0351s
Epoch: 23 cost time: 6.747999906539917
Epoch: 23, Steps: 154 | Train Loss: 1.344 Vali Loss: 3.715 Vali Acc: 0.367 Test Loss: 3.715 Test Acc: 0.367
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.0284009
	speed: 0.1811s/iter; left time: 2130.0155s
Epoch: 24 cost time: 7.559078931808472
Epoch: 24, Steps: 154 | Train Loss: 1.811 Vali Loss: 3.830 Vali Acc: 0.198 Test Loss: 3.830 Test Acc: 0.198
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.3181686
	speed: 0.1865s/iter; left time: 2164.8105s
Epoch: 25 cost time: 6.796544075012207
Epoch: 25, Steps: 154 | Train Loss: 1.187 Vali Loss: 4.098 Vali Acc: 0.380 Test Loss: 4.098 Test Acc: 0.380
Validation loss decreased (-0.368172 --> -0.380332).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.9116737
	speed: 0.1940s/iter; left time: 2221.8767s
Epoch: 26 cost time: 6.941558599472046
Epoch: 26, Steps: 154 | Train Loss: 1.209 Vali Loss: 4.360 Vali Acc: 0.388 Test Loss: 4.360 Test Acc: 0.388
Validation loss decreased (-0.380332 --> -0.388440).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.5544327
	speed: 0.1941s/iter; left time: 2193.0442s
Epoch: 27 cost time: 7.994382619857788
Epoch: 27, Steps: 154 | Train Loss: 1.292 Vali Loss: 4.389 Vali Acc: 0.330 Test Loss: 4.389 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.8491325
	speed: 0.1919s/iter; left time: 2138.7745s
Epoch: 28 cost time: 6.242135763168335
Epoch: 28, Steps: 154 | Train Loss: 1.339 Vali Loss: 4.945 Vali Acc: 0.094 Test Loss: 4.945 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.3788139
	speed: 0.1798s/iter; left time: 1975.4224s
Epoch: 29 cost time: 7.151445150375366
Epoch: 29, Steps: 154 | Train Loss: 1.449 Vali Loss: 4.667 Vali Acc: 0.391 Test Loss: 4.667 Test Acc: 0.391
Validation loss decreased (-0.388440 --> -0.390870).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.1553352
	speed: 0.1763s/iter; left time: 1909.8498s
Epoch: 30 cost time: 7.106701612472534
Epoch: 30, Steps: 154 | Train Loss: 2.134 Vali Loss: 4.958 Vali Acc: 0.131 Test Loss: 4.958 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.3993678
	speed: 0.1781s/iter; left time: 1902.0223s
Epoch: 31 cost time: 6.66331148147583
Epoch: 31, Steps: 154 | Train Loss: 1.225 Vali Loss: 5.146 Vali Acc: 0.157 Test Loss: 5.146 Test Acc: 0.157
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.5103293
	speed: 0.1862s/iter; left time: 1960.6112s
Epoch: 32 cost time: 7.31841778755188
Epoch: 32, Steps: 154 | Train Loss: 1.092 Vali Loss: 4.535 Vali Acc: 0.358 Test Loss: 4.535 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.7152331
	speed: 0.1782s/iter; left time: 1848.2399s
Epoch: 33 cost time: 7.173714637756348
Epoch: 33, Steps: 154 | Train Loss: 1.172 Vali Loss: 4.965 Vali Acc: 0.177 Test Loss: 4.965 Test Acc: 0.177
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.8999271
	speed: 0.1977s/iter; left time: 2020.3550s
Epoch: 34 cost time: 6.932287693023682
Epoch: 34, Steps: 154 | Train Loss: 1.437 Vali Loss: 5.221 Vali Acc: 0.169 Test Loss: 5.221 Test Acc: 0.169
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.9859439
	speed: 0.2036s/iter; left time: 2049.1420s
Epoch: 35 cost time: 7.929440975189209
Epoch: 35, Steps: 154 | Train Loss: 1.057 Vali Loss: 4.785 Vali Acc: 0.266 Test Loss: 4.785 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 1.1754930
	speed: 0.1916s/iter; left time: 1898.7306s
Epoch: 36 cost time: 7.192748069763184
Epoch: 36, Steps: 154 | Train Loss: 1.441 Vali Loss: 5.350 Vali Acc: 0.164 Test Loss: 5.350 Test Acc: 0.164
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 1.3373590
	speed: 0.1935s/iter; left time: 1887.5308s
Epoch: 37 cost time: 6.72217583656311
Epoch: 37, Steps: 154 | Train Loss: 1.099 Vali Loss: 5.818 Vali Acc: 0.111 Test Loss: 5.818 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 2.6009009
	speed: 0.1824s/iter; left time: 1751.4574s
Epoch: 38 cost time: 7.701057434082031
Epoch: 38, Steps: 154 | Train Loss: 1.002 Vali Loss: 7.194 Vali Acc: 0.097 Test Loss: 7.194 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 1.0758474
	speed: 0.1771s/iter; left time: 1673.3527s
Epoch: 39 cost time: 6.767326354980469
Epoch: 39, Steps: 154 | Train Loss: 1.069 Vali Loss: 6.177 Vali Acc: 0.095 Test Loss: 6.177 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3909164639091646
model parameter : 336438
model size : 6.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0683722
	speed: 0.0671s/iter; left time: 1026.3546s
Epoch: 1 cost time: 9.494333744049072
Epoch: 1, Steps: 154 | Train Loss: 2.207 Vali Loss: 2.184 Vali Acc: 0.319 Test Loss: 2.184 Test Acc: 0.319
Validation loss decreased (inf --> -0.318713).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6027853
	speed: 0.1802s/iter; left time: 2730.2268s
Epoch: 2 cost time: 6.681656122207642
Epoch: 2, Steps: 154 | Train Loss: 2.062 Vali Loss: 2.163 Vali Acc: 0.320 Test Loss: 2.163 Test Acc: 0.320
Validation loss decreased (-0.318713 --> -0.320335).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9664737
	speed: 0.1907s/iter; left time: 2858.5848s
Epoch: 3 cost time: 6.57570219039917
Epoch: 3, Steps: 154 | Train Loss: 2.021 Vali Loss: 2.212 Vali Acc: 0.327 Test Loss: 2.212 Test Acc: 0.327
Validation loss decreased (-0.320335 --> -0.327228).  Saving model ...
	iters: 100, epoch: 4 | loss: 9.2252340
	speed: 0.1940s/iter; left time: 2878.4781s
Epoch: 4 cost time: 8.054081201553345
Epoch: 4, Steps: 154 | Train Loss: 1.987 Vali Loss: 2.174 Vali Acc: 0.331 Test Loss: 2.174 Test Acc: 0.331
Validation loss decreased (-0.327228 --> -0.331284).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8860568
	speed: 0.1967s/iter; left time: 2888.4732s
Epoch: 5 cost time: 6.637312650680542
Epoch: 5, Steps: 154 | Train Loss: 1.872 Vali Loss: 2.158 Vali Acc: 0.338 Test Loss: 2.158 Test Acc: 0.338
Validation loss decreased (-0.331284 --> -0.337772).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7857010
	speed: 0.1922s/iter; left time: 2793.0751s
Epoch: 6 cost time: 6.701252460479736
Epoch: 6, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.325 Vali Acc: 0.337 Test Loss: 2.325 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 4.7862468
	speed: 0.1751s/iter; left time: 2517.2876s
Epoch: 7 cost time: 6.750781297683716
Epoch: 7, Steps: 154 | Train Loss: 1.846 Vali Loss: 2.252 Vali Acc: 0.344 Test Loss: 2.252 Test Acc: 0.344
Validation loss decreased (-0.337772 --> -0.343854).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8268778
	speed: 0.1463s/iter; left time: 2081.5021s
Epoch: 8 cost time: 5.358303546905518
Epoch: 8, Steps: 154 | Train Loss: 1.770 Vali Loss: 2.382 Vali Acc: 0.341 Test Loss: 2.382 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0758429
	speed: 0.1748s/iter; left time: 2459.3324s
Epoch: 9 cost time: 7.276672124862671
Epoch: 9, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.374 Vali Acc: 0.200 Test Loss: 2.374 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.9883909
	speed: 0.1808s/iter; left time: 2515.9094s
Epoch: 10 cost time: 7.7006683349609375
Epoch: 10, Steps: 154 | Train Loss: 1.699 Vali Loss: 2.456 Vali Acc: 0.358 Test Loss: 2.456 Test Acc: 0.358
Validation loss decreased (-0.343854 --> -0.358045).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6244991
	speed: 0.1776s/iter; left time: 2444.1772s
Epoch: 11 cost time: 6.757566213607788
Epoch: 11, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.695 Vali Acc: 0.359 Test Loss: 2.695 Test Acc: 0.359
Validation loss decreased (-0.358045 --> -0.358854).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2263418
	speed: 0.1893s/iter; left time: 2575.7300s
Epoch: 12 cost time: 6.9758501052856445
Epoch: 12, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.618 Vali Acc: 0.365 Test Loss: 2.618 Test Acc: 0.365
Validation loss decreased (-0.358854 --> -0.364937).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.0541911
	speed: 0.1947s/iter; left time: 2619.8650s
Epoch: 13 cost time: 7.379706144332886
Epoch: 13, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.891 Vali Acc: 0.358 Test Loss: 2.891 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.2178390
	speed: 0.1900s/iter; left time: 2526.2986s
Epoch: 14 cost time: 6.875659227371216
Epoch: 14, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.993 Vali Acc: 0.361 Test Loss: 2.993 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.8674712
	speed: 0.1909s/iter; left time: 2508.8036s
Epoch: 15 cost time: 6.467823266983032
Epoch: 15, Steps: 154 | Train Loss: 1.603 Vali Loss: 2.873 Vali Acc: 0.360 Test Loss: 2.873 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.2153763
	speed: 0.1818s/iter; left time: 2362.1164s
Epoch: 16 cost time: 7.1636810302734375
Epoch: 16, Steps: 154 | Train Loss: 1.422 Vali Loss: 3.092 Vali Acc: 0.359 Test Loss: 3.092 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.3197757
	speed: 0.1751s/iter; left time: 2247.1412s
Epoch: 17 cost time: 6.611941814422607
Epoch: 17, Steps: 154 | Train Loss: 1.577 Vali Loss: 3.196 Vali Acc: 0.258 Test Loss: 3.196 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.6226217
	speed: 0.1804s/iter; left time: 2287.7887s
Epoch: 18 cost time: 6.569412708282471
Epoch: 18, Steps: 154 | Train Loss: 1.523 Vali Loss: 3.390 Vali Acc: 0.373 Test Loss: 3.390 Test Acc: 0.373
Validation loss decreased (-0.364937 --> -0.373040).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.4059503
	speed: 0.1800s/iter; left time: 2255.7632s
Epoch: 19 cost time: 7.564851522445679
Epoch: 19, Steps: 154 | Train Loss: 1.687 Vali Loss: 3.312 Vali Acc: 0.377 Test Loss: 3.312 Test Acc: 0.377
Validation loss decreased (-0.373040 --> -0.376690).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.4482901
	speed: 0.1744s/iter; left time: 2157.5976s
Epoch: 20 cost time: 6.645001649856567
Epoch: 20, Steps: 154 | Train Loss: 1.557 Vali Loss: 3.480 Vali Acc: 0.375 Test Loss: 3.480 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.8721018
	speed: 0.1919s/iter; left time: 2345.7762s
Epoch: 21 cost time: 6.428497314453125
Epoch: 21, Steps: 154 | Train Loss: 1.328 Vali Loss: 3.799 Vali Acc: 0.367 Test Loss: 3.799 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.9422093
	speed: 0.1863s/iter; left time: 2247.7105s
Epoch: 22 cost time: 7.833179950714111
Epoch: 22, Steps: 154 | Train Loss: 1.472 Vali Loss: 4.170 Vali Acc: 0.369 Test Loss: 4.170 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.5129673
	speed: 0.1938s/iter; left time: 2308.5271s
Epoch: 23 cost time: 6.694421768188477
Epoch: 23, Steps: 154 | Train Loss: 1.411 Vali Loss: 3.582 Vali Acc: 0.378 Test Loss: 3.582 Test Acc: 0.378
Validation loss decreased (-0.376690 --> -0.377499).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.8250754
	speed: 0.1840s/iter; left time: 2163.7851s
Epoch: 24 cost time: 6.955289363861084
Epoch: 24, Steps: 154 | Train Loss: 1.279 Vali Loss: 4.001 Vali Acc: 0.176 Test Loss: 4.001 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.1169147
	speed: 0.1638s/iter; left time: 1901.1378s
Epoch: 25 cost time: 6.961769342422485
Epoch: 25, Steps: 154 | Train Loss: 1.189 Vali Loss: 4.070 Vali Acc: 0.379 Test Loss: 4.070 Test Acc: 0.379
Validation loss decreased (-0.377499 --> -0.378710).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.7086583
	speed: 0.1813s/iter; left time: 2076.3502s
Epoch: 26 cost time: 6.764876127243042
Epoch: 26, Steps: 154 | Train Loss: 1.136 Vali Loss: 4.243 Vali Acc: 0.288 Test Loss: 4.243 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.5702799
	speed: 0.1812s/iter; left time: 2046.7533s
Epoch: 27 cost time: 7.002474069595337
Epoch: 27, Steps: 154 | Train Loss: 1.692 Vali Loss: 4.258 Vali Acc: 0.236 Test Loss: 4.258 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.6827388
	speed: 0.1744s/iter; left time: 1942.9950s
Epoch: 28 cost time: 7.165285587310791
Epoch: 28, Steps: 154 | Train Loss: 1.513 Vali Loss: 4.584 Vali Acc: 0.109 Test Loss: 4.584 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.5598708
	speed: 0.1770s/iter; left time: 1944.8157s
Epoch: 29 cost time: 6.39540958404541
Epoch: 29, Steps: 154 | Train Loss: 1.856 Vali Loss: 4.612 Vali Acc: 0.305 Test Loss: 4.612 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.8129257
	speed: 0.1975s/iter; left time: 2139.5607s
Epoch: 30 cost time: 7.145349025726318
Epoch: 30, Steps: 154 | Train Loss: 1.090 Vali Loss: 4.983 Vali Acc: 0.363 Test Loss: 4.983 Test Acc: 0.363
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 1.1874164
	speed: 0.1865s/iter; left time: 1991.8762s
Epoch: 31 cost time: 6.723819255828857
Epoch: 31, Steps: 154 | Train Loss: 1.318 Vali Loss: 4.681 Vali Acc: 0.354 Test Loss: 4.681 Test Acc: 0.354
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.5263709
	speed: 0.1891s/iter; left time: 1990.5091s
Epoch: 32 cost time: 6.572244882583618
Epoch: 32, Steps: 154 | Train Loss: 2.060 Vali Loss: 4.325 Vali Acc: 0.123 Test Loss: 4.325 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 1.1064464
	speed: 0.1799s/iter; left time: 1866.3627s
Epoch: 33 cost time: 8.682191848754883
Epoch: 33, Steps: 154 | Train Loss: 1.122 Vali Loss: 4.504 Vali Acc: 0.370 Test Loss: 4.504 Test Acc: 0.370
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.8905197
	speed: 0.1957s/iter; left time: 1999.4536s
Epoch: 34 cost time: 5.621803522109985
Epoch: 34, Steps: 154 | Train Loss: 1.153 Vali Loss: 4.604 Vali Acc: 0.358 Test Loss: 4.604 Test Acc: 0.358
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 1.3077086
	speed: 0.1361s/iter; left time: 1370.0907s
Epoch: 35 cost time: 4.775130987167358
Epoch: 35, Steps: 154 | Train Loss: 0.986 Vali Loss: 5.978 Vali Acc: 0.134 Test Loss: 5.978 Test Acc: 0.134
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37875101378751014
model parameter : 336438
model size : 6.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0600426
	speed: 0.0585s/iter; left time: 894.8722s
Epoch: 1 cost time: 8.160813570022583
Epoch: 1, Steps: 154 | Train Loss: 2.227 Vali Loss: 2.177 Vali Acc: 0.322 Test Loss: 2.177 Test Acc: 0.322
Validation loss decreased (inf --> -0.321957).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6374037
	speed: 0.1829s/iter; left time: 2769.9917s
Epoch: 2 cost time: 7.426759958267212
Epoch: 2, Steps: 154 | Train Loss: 2.084 Vali Loss: 2.174 Vali Acc: 0.325 Test Loss: 2.174 Test Acc: 0.325
Validation loss decreased (-0.321957 --> -0.325201).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4363048
	speed: 0.1791s/iter; left time: 2685.1647s
Epoch: 3 cost time: 7.371427774429321
Epoch: 3, Steps: 154 | Train Loss: 2.005 Vali Loss: 2.217 Vali Acc: 0.327 Test Loss: 2.217 Test Acc: 0.327
Validation loss decreased (-0.325201 --> -0.327228).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2897875
	speed: 0.1806s/iter; left time: 2679.5002s
Epoch: 4 cost time: 6.547041893005371
Epoch: 4, Steps: 154 | Train Loss: 1.972 Vali Loss: 2.268 Vali Acc: 0.325 Test Loss: 2.268 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.4360034
	speed: 0.1851s/iter; left time: 2717.4701s
Epoch: 5 cost time: 7.118381977081299
Epoch: 5, Steps: 154 | Train Loss: 1.883 Vali Loss: 2.171 Vali Acc: 0.332 Test Loss: 2.171 Test Acc: 0.332
Validation loss decreased (-0.327228 --> -0.331690).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2076886
	speed: 0.1864s/iter; left time: 2708.1350s
Epoch: 6 cost time: 6.817225933074951
Epoch: 6, Steps: 154 | Train Loss: 1.826 Vali Loss: 2.320 Vali Acc: 0.339 Test Loss: 2.320 Test Acc: 0.339
Validation loss decreased (-0.331690 --> -0.338987).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2746155
	speed: 0.1973s/iter; left time: 2836.1739s
Epoch: 7 cost time: 7.094326019287109
Epoch: 7, Steps: 154 | Train Loss: 1.823 Vali Loss: 2.472 Vali Acc: 0.173 Test Loss: 2.472 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5415812
	speed: 0.1971s/iter; left time: 2803.4144s
Epoch: 8 cost time: 7.8349974155426025
Epoch: 8, Steps: 154 | Train Loss: 1.809 Vali Loss: 2.432 Vali Acc: 0.341 Test Loss: 2.432 Test Acc: 0.341
Validation loss decreased (-0.338987 --> -0.340608).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4922457
	speed: 0.1772s/iter; left time: 2492.7433s
Epoch: 9 cost time: 6.513159513473511
Epoch: 9, Steps: 154 | Train Loss: 1.666 Vali Loss: 2.553 Vali Acc: 0.341 Test Loss: 2.553 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.8013568
	speed: 0.1745s/iter; left time: 2428.1689s
Epoch: 10 cost time: 6.779022216796875
Epoch: 10, Steps: 154 | Train Loss: 1.704 Vali Loss: 2.519 Vali Acc: 0.349 Test Loss: 2.519 Test Acc: 0.349
Validation loss decreased (-0.340608 --> -0.348718).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8034726
	speed: 0.1778s/iter; left time: 2446.1173s
Epoch: 11 cost time: 7.34042501449585
Epoch: 11, Steps: 154 | Train Loss: 1.676 Vali Loss: 2.616 Vali Acc: 0.357 Test Loss: 2.616 Test Acc: 0.357
Validation loss decreased (-0.348718 --> -0.357233).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4476881
	speed: 0.1745s/iter; left time: 2374.3628s
Epoch: 12 cost time: 6.52255654335022
Epoch: 12, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.565 Vali Acc: 0.356 Test Loss: 2.565 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5139569
	speed: 0.1767s/iter; left time: 2377.4332s
Epoch: 13 cost time: 6.86109185218811
Epoch: 13, Steps: 154 | Train Loss: 1.630 Vali Loss: 2.777 Vali Acc: 0.362 Test Loss: 2.777 Test Acc: 0.362
Validation loss decreased (-0.357233 --> -0.362097).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6375287
	speed: 0.1822s/iter; left time: 2422.7037s
Epoch: 14 cost time: 7.253247261047363
Epoch: 14, Steps: 154 | Train Loss: 1.592 Vali Loss: 2.729 Vali Acc: 0.358 Test Loss: 2.729 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.8933613
	speed: 0.1942s/iter; left time: 2552.2217s
Epoch: 15 cost time: 6.949853181838989
Epoch: 15, Steps: 154 | Train Loss: 1.580 Vali Loss: 3.063 Vali Acc: 0.362 Test Loss: 3.063 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.7137601
	speed: 0.1949s/iter; left time: 2532.4772s
Epoch: 16 cost time: 6.76528525352478
Epoch: 16, Steps: 154 | Train Loss: 1.596 Vali Loss: 3.289 Vali Acc: 0.087 Test Loss: 3.289 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.1344571
	speed: 0.1933s/iter; left time: 2481.8813s
Epoch: 17 cost time: 7.3996806144714355
Epoch: 17, Steps: 154 | Train Loss: 1.656 Vali Loss: 2.871 Vali Acc: 0.212 Test Loss: 2.871 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.0639424
	speed: 0.1777s/iter; left time: 2253.6944s
Epoch: 18 cost time: 7.179606199264526
Epoch: 18, Steps: 154 | Train Loss: 1.516 Vali Loss: 3.112 Vali Acc: 0.362 Test Loss: 3.112 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.7959504
	speed: 0.1799s/iter; left time: 2253.7598s
Epoch: 19 cost time: 6.67480993270874
Epoch: 19, Steps: 154 | Train Loss: 1.416 Vali Loss: 3.185 Vali Acc: 0.373 Test Loss: 3.185 Test Acc: 0.373
Validation loss decreased (-0.362097 --> -0.373447).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.8810838
	speed: 0.1799s/iter; left time: 2226.2180s
Epoch: 20 cost time: 7.766976833343506
Epoch: 20, Steps: 154 | Train Loss: 1.362 Vali Loss: 3.070 Vali Acc: 0.365 Test Loss: 3.070 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.1807113
	speed: 0.1805s/iter; left time: 2205.4402s
Epoch: 21 cost time: 7.1179540157318115
Epoch: 21, Steps: 154 | Train Loss: 1.418 Vali Loss: 3.416 Vali Acc: 0.212 Test Loss: 3.416 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 2.0197473
	speed: 0.1575s/iter; left time: 1900.5282s
Epoch: 22 cost time: 5.484736442565918
Epoch: 22, Steps: 154 | Train Loss: 1.468 Vali Loss: 3.553 Vali Acc: 0.174 Test Loss: 3.553 Test Acc: 0.174
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 4.9774628
	speed: 0.1731s/iter; left time: 2062.0790s
Epoch: 23 cost time: 7.670844316482544
Epoch: 23, Steps: 154 | Train Loss: 1.541 Vali Loss: 3.682 Vali Acc: 0.199 Test Loss: 3.682 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.1746439
	speed: 0.1903s/iter; left time: 2237.3837s
Epoch: 24 cost time: 6.178324222564697
Epoch: 24, Steps: 154 | Train Loss: 1.482 Vali Loss: 3.659 Vali Acc: 0.217 Test Loss: 3.659 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.5055565
	speed: 0.1972s/iter; left time: 2288.2917s
Epoch: 25 cost time: 6.809474945068359
Epoch: 25, Steps: 154 | Train Loss: 1.389 Vali Loss: 3.996 Vali Acc: 0.203 Test Loss: 3.996 Test Acc: 0.203
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.3449621
	speed: 0.1880s/iter; left time: 2152.3751s
Epoch: 26 cost time: 7.256353855133057
Epoch: 26, Steps: 154 | Train Loss: 1.326 Vali Loss: 3.927 Vali Acc: 0.378 Test Loss: 3.927 Test Acc: 0.378
Validation loss decreased (-0.373447 --> -0.377495).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.6148087
	speed: 0.1720s/iter; left time: 1943.4688s
Epoch: 27 cost time: 6.559943675994873
Epoch: 27, Steps: 154 | Train Loss: 1.373 Vali Loss: 4.850 Vali Acc: 0.079 Test Loss: 4.850 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.5872200
	speed: 0.1761s/iter; left time: 1961.9458s
Epoch: 28 cost time: 6.734730005264282
Epoch: 28, Steps: 154 | Train Loss: 1.285 Vali Loss: 3.374 Vali Acc: 0.388 Test Loss: 3.374 Test Acc: 0.388
Validation loss decreased (-0.377495 --> -0.388044).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.8400006
	speed: 0.1772s/iter; left time: 1946.7151s
Epoch: 29 cost time: 6.890769004821777
Epoch: 29, Steps: 154 | Train Loss: 1.363 Vali Loss: 3.904 Vali Acc: 0.378 Test Loss: 3.904 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.5631840
	speed: 0.1714s/iter; left time: 1857.4013s
Epoch: 30 cost time: 6.866468906402588
Epoch: 30, Steps: 154 | Train Loss: 1.330 Vali Loss: 3.882 Vali Acc: 0.229 Test Loss: 3.882 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.9479459
	speed: 0.1713s/iter; left time: 1829.7443s
Epoch: 31 cost time: 6.6595070362091064
Epoch: 31, Steps: 154 | Train Loss: 1.235 Vali Loss: 4.355 Vali Acc: 0.085 Test Loss: 4.355 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.3561703
	speed: 0.1962s/iter; left time: 2065.1981s
Epoch: 32 cost time: 7.286550521850586
Epoch: 32, Steps: 154 | Train Loss: 1.441 Vali Loss: 4.135 Vali Acc: 0.105 Test Loss: 4.135 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.8198146
	speed: 0.1932s/iter; left time: 2004.1789s
Epoch: 33 cost time: 7.6565611362457275
Epoch: 33, Steps: 154 | Train Loss: 1.164 Vali Loss: 4.716 Vali Acc: 0.105 Test Loss: 4.716 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.8288742
	speed: 0.1963s/iter; left time: 2006.2694s
Epoch: 34 cost time: 6.759865045547485
Epoch: 34, Steps: 154 | Train Loss: 1.283 Vali Loss: 5.500 Vali Acc: 0.082 Test Loss: 5.500 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 1.5823327
	speed: 0.1794s/iter; left time: 1806.0031s
Epoch: 35 cost time: 7.018871307373047
Epoch: 35, Steps: 154 | Train Loss: 1.882 Vali Loss: 4.840 Vali Acc: 0.327 Test Loss: 4.840 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.4794118
	speed: 0.1767s/iter; left time: 1751.2846s
Epoch: 36 cost time: 7.5132575035095215
Epoch: 36, Steps: 154 | Train Loss: 1.454 Vali Loss: 4.470 Vali Acc: 0.219 Test Loss: 4.470 Test Acc: 0.219
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 1.2061999
	speed: 0.1752s/iter; left time: 1709.0322s
Epoch: 37 cost time: 6.434435129165649
Epoch: 37, Steps: 154 | Train Loss: 1.561 Vali Loss: 5.350 Vali Acc: 0.086 Test Loss: 5.350 Test Acc: 0.086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 1.5011207
	speed: 0.1751s/iter; left time: 1681.6373s
Epoch: 38 cost time: 6.772197723388672
Epoch: 38, Steps: 154 | Train Loss: 1.080 Vali Loss: 5.252 Vali Acc: 0.132 Test Loss: 5.252 Test Acc: 0.132
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3880778588807786
model parameter : 303670
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0398920
	speed: 0.0613s/iter; left time: 938.5275s
Epoch: 1 cost time: 8.433637619018555
Epoch: 1, Steps: 154 | Train Loss: 2.211 Vali Loss: 2.172 Vali Acc: 0.321 Test Loss: 2.172 Test Acc: 0.321
Validation loss decreased (inf --> -0.320741).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6332607
	speed: 0.1927s/iter; left time: 2919.2594s
Epoch: 2 cost time: 6.7575201988220215
Epoch: 2, Steps: 154 | Train Loss: 2.097 Vali Loss: 2.154 Vali Acc: 0.324 Test Loss: 2.154 Test Acc: 0.324
Validation loss decreased (-0.320741 --> -0.324390).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3972483
	speed: 0.1856s/iter; left time: 2781.9624s
Epoch: 3 cost time: 7.207015037536621
Epoch: 3, Steps: 154 | Train Loss: 1.960 Vali Loss: 2.215 Vali Acc: 0.327 Test Loss: 2.215 Test Acc: 0.327
Validation loss decreased (-0.324390 --> -0.326823).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2924609
	speed: 0.1891s/iter; left time: 2805.5726s
Epoch: 4 cost time: 6.20215368270874
Epoch: 4, Steps: 154 | Train Loss: 2.005 Vali Loss: 2.269 Vali Acc: 0.325 Test Loss: 2.269 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.4282668
	speed: 0.1717s/iter; left time: 2521.3133s
Epoch: 5 cost time: 6.237177848815918
Epoch: 5, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.173 Vali Acc: 0.331 Test Loss: 2.173 Test Acc: 0.331
Validation loss decreased (-0.326823 --> -0.331284).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2251589
	speed: 0.1732s/iter; left time: 2517.4523s
Epoch: 6 cost time: 7.4773337841033936
Epoch: 6, Steps: 154 | Train Loss: 1.798 Vali Loss: 2.286 Vali Acc: 0.343 Test Loss: 2.286 Test Acc: 0.343
Validation loss decreased (-0.331284 --> -0.342637).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3341047
	speed: 0.1751s/iter; left time: 2517.8670s
Epoch: 7 cost time: 6.8538877964019775
Epoch: 7, Steps: 154 | Train Loss: 1.750 Vali Loss: 2.473 Vali Acc: 0.178 Test Loss: 2.473 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5975372
	speed: 0.1760s/iter; left time: 2503.4367s
Epoch: 8 cost time: 6.608780860900879
Epoch: 8, Steps: 154 | Train Loss: 1.756 Vali Loss: 2.439 Vali Acc: 0.340 Test Loss: 2.439 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.2914658
	speed: 0.1774s/iter; left time: 2495.6664s
Epoch: 9 cost time: 7.709231615066528
Epoch: 9, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.557 Vali Acc: 0.341 Test Loss: 2.557 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.7826968
	speed: 0.1820s/iter; left time: 2532.1641s
Epoch: 10 cost time: 6.811934232711792
Epoch: 10, Steps: 154 | Train Loss: 1.668 Vali Loss: 2.496 Vali Acc: 0.344 Test Loss: 2.496 Test Acc: 0.344
Validation loss decreased (-0.342637 --> -0.343852).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8492042
	speed: 0.1953s/iter; left time: 2687.2571s
Epoch: 11 cost time: 6.796129941940308
Epoch: 11, Steps: 154 | Train Loss: 1.668 Vali Loss: 2.679 Vali Acc: 0.356 Test Loss: 2.679 Test Acc: 0.356
Validation loss decreased (-0.343852 --> -0.355610).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2462399
	speed: 0.1951s/iter; left time: 2654.6354s
Epoch: 12 cost time: 7.6309850215911865
Epoch: 12, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.604 Vali Acc: 0.351 Test Loss: 2.604 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4493500
	speed: 0.1847s/iter; left time: 2484.7840s
Epoch: 13 cost time: 5.777350664138794
Epoch: 13, Steps: 154 | Train Loss: 1.666 Vali Loss: 2.622 Vali Acc: 0.361 Test Loss: 2.622 Test Acc: 0.361
Validation loss decreased (-0.355610 --> -0.360882).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.8589823
	speed: 0.1733s/iter; left time: 2305.2556s
Epoch: 14 cost time: 6.659063816070557
Epoch: 14, Steps: 154 | Train Loss: 1.717 Vali Loss: 2.899 Vali Acc: 0.358 Test Loss: 2.899 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9749587
	speed: 0.1713s/iter; left time: 2251.6884s
Epoch: 15 cost time: 7.087518692016602
Epoch: 15, Steps: 154 | Train Loss: 1.542 Vali Loss: 3.148 Vali Acc: 0.356 Test Loss: 3.148 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.6671715
	speed: 0.1677s/iter; left time: 2177.9870s
Epoch: 16 cost time: 6.835881471633911
Epoch: 16, Steps: 154 | Train Loss: 1.488 Vali Loss: 3.134 Vali Acc: 0.134 Test Loss: 3.134 Test Acc: 0.134
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.1288766
	speed: 0.1740s/iter; left time: 2233.8515s
Epoch: 17 cost time: 6.5218400955200195
Epoch: 17, Steps: 154 | Train Loss: 1.705 Vali Loss: 2.952 Vali Acc: 0.214 Test Loss: 2.952 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.8788467
	speed: 0.1736s/iter; left time: 2201.9072s
Epoch: 18 cost time: 6.599233388900757
Epoch: 18, Steps: 154 | Train Loss: 1.426 Vali Loss: 3.284 Vali Acc: 0.360 Test Loss: 3.284 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.6055428
	speed: 0.1787s/iter; left time: 2238.4397s
Epoch: 19 cost time: 6.918751001358032
Epoch: 19, Steps: 154 | Train Loss: 1.376 Vali Loss: 3.200 Vali Acc: 0.371 Test Loss: 3.200 Test Acc: 0.371
Validation loss decreased (-0.360882 --> -0.371014).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.1420182
	speed: 0.1921s/iter; left time: 2376.9592s
Epoch: 20 cost time: 6.425050497055054
Epoch: 20, Steps: 154 | Train Loss: 1.405 Vali Loss: 3.100 Vali Acc: 0.350 Test Loss: 3.100 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.0894086
	speed: 0.1921s/iter; left time: 2347.4570s
Epoch: 21 cost time: 7.4802258014678955
Epoch: 21, Steps: 154 | Train Loss: 1.406 Vali Loss: 3.076 Vali Acc: 0.230 Test Loss: 3.076 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.9683189
	speed: 0.1823s/iter; left time: 2199.3945s
Epoch: 22 cost time: 7.028586149215698
Epoch: 22, Steps: 154 | Train Loss: 1.413 Vali Loss: 3.233 Vali Acc: 0.257 Test Loss: 3.233 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 2.4781091
	speed: 0.1783s/iter; left time: 2123.8079s
Epoch: 23 cost time: 6.497611999511719
Epoch: 23, Steps: 154 | Train Loss: 1.616 Vali Loss: 3.617 Vali Acc: 0.208 Test Loss: 3.617 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.1056265
	speed: 0.1767s/iter; left time: 2077.7568s
Epoch: 24 cost time: 7.327008247375488
Epoch: 24, Steps: 154 | Train Loss: 1.390 Vali Loss: 3.795 Vali Acc: 0.335 Test Loss: 3.795 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 2.5795083
	speed: 0.1732s/iter; left time: 2009.6021s
Epoch: 25 cost time: 7.257359027862549
Epoch: 25, Steps: 154 | Train Loss: 1.578 Vali Loss: 4.592 Vali Acc: 0.208 Test Loss: 4.592 Test Acc: 0.208
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.6330220
	speed: 0.1725s/iter; left time: 1974.9366s
Epoch: 26 cost time: 6.547420024871826
Epoch: 26, Steps: 154 | Train Loss: 1.255 Vali Loss: 3.857 Vali Acc: 0.375 Test Loss: 3.857 Test Acc: 0.375
Validation loss decreased (-0.371014 --> -0.375063).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.4905618
	speed: 0.1744s/iter; left time: 1970.5796s
Epoch: 27 cost time: 6.716774225234985
Epoch: 27, Steps: 154 | Train Loss: 1.237 Vali Loss: 3.980 Vali Acc: 0.376 Test Loss: 3.980 Test Acc: 0.376
Validation loss decreased (-0.375063 --> -0.375873).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.3851315
	speed: 0.1835s/iter; left time: 2044.2041s
Epoch: 28 cost time: 6.537692308425903
Epoch: 28, Steps: 154 | Train Loss: 1.485 Vali Loss: 4.141 Vali Acc: 0.383 Test Loss: 4.141 Test Acc: 0.383
Validation loss decreased (-0.375873 --> -0.383170).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.6335413
	speed: 0.1668s/iter; left time: 1833.2823s
Epoch: 29 cost time: 5.7819983959198
Epoch: 29, Steps: 154 | Train Loss: 1.168 Vali Loss: 4.121 Vali Acc: 0.382 Test Loss: 4.121 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.3792634
	speed: 0.1932s/iter; left time: 2092.9544s
Epoch: 30 cost time: 7.215067625045776
Epoch: 30, Steps: 154 | Train Loss: 1.399 Vali Loss: 4.146 Vali Acc: 0.382 Test Loss: 4.146 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.8688784
	speed: 0.1855s/iter; left time: 1981.1501s
Epoch: 31 cost time: 7.10304594039917
Epoch: 31, Steps: 154 | Train Loss: 1.177 Vali Loss: 4.281 Vali Acc: 0.118 Test Loss: 4.281 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.4010751
	speed: 0.1857s/iter; left time: 1954.9974s
Epoch: 32 cost time: 6.762693166732788
Epoch: 32, Steps: 154 | Train Loss: 1.325 Vali Loss: 4.746 Vali Acc: 0.088 Test Loss: 4.746 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.6006182
	speed: 0.1788s/iter; left time: 1854.8614s
Epoch: 33 cost time: 7.36508584022522
Epoch: 33, Steps: 154 | Train Loss: 1.420 Vali Loss: 3.996 Vali Acc: 0.311 Test Loss: 3.996 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.9267130
	speed: 0.1794s/iter; left time: 1832.8978s
Epoch: 34 cost time: 6.748705625534058
Epoch: 34, Steps: 154 | Train Loss: 1.242 Vali Loss: 4.176 Vali Acc: 0.195 Test Loss: 4.176 Test Acc: 0.195
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 1.2244706
	speed: 0.1820s/iter; left time: 1831.3727s
Epoch: 35 cost time: 7.054957151412964
Epoch: 35, Steps: 154 | Train Loss: 1.256 Vali Loss: 4.610 Vali Acc: 0.375 Test Loss: 4.610 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 1.0080861
	speed: 0.1775s/iter; left time: 1759.0642s
Epoch: 36 cost time: 7.9010910987854
Epoch: 36, Steps: 154 | Train Loss: 1.217 Vali Loss: 5.289 Vali Acc: 0.149 Test Loss: 5.289 Test Acc: 0.149
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.4082600
	speed: 0.2001s/iter; left time: 1952.0099s
Epoch: 37 cost time: 7.357593059539795
Epoch: 37, Steps: 154 | Train Loss: 1.211 Vali Loss: 4.819 Vali Acc: 0.102 Test Loss: 4.819 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 1.5032496
	speed: 0.2044s/iter; left time: 1963.0222s
Epoch: 38 cost time: 7.627848863601685
Epoch: 38, Steps: 154 | Train Loss: 1.494 Vali Loss: 4.912 Vali Acc: 0.174 Test Loss: 4.912 Test Acc: 0.174
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38321167883211676
model parameter : 303670
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0553577
	speed: 0.0646s/iter; left time: 987.7506s
Epoch: 1 cost time: 8.96059775352478
Epoch: 1, Steps: 154 | Train Loss: 2.207 Vali Loss: 2.187 Vali Acc: 0.321 Test Loss: 2.187 Test Acc: 0.321
Validation loss decreased (inf --> -0.321146).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6227953
	speed: 0.1821s/iter; left time: 2758.6051s
Epoch: 2 cost time: 7.536960124969482
Epoch: 2, Steps: 154 | Train Loss: 2.095 Vali Loss: 2.153 Vali Acc: 0.325 Test Loss: 2.153 Test Acc: 0.325
Validation loss decreased (-0.321146 --> -0.324796).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4094465
	speed: 0.1817s/iter; left time: 2723.8978s
Epoch: 3 cost time: 6.843634128570557
Epoch: 3, Steps: 154 | Train Loss: 1.992 Vali Loss: 2.155 Vali Acc: 0.329 Test Loss: 2.155 Test Acc: 0.329
Validation loss decreased (-0.324796 --> -0.329257).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3253899
	speed: 0.1874s/iter; left time: 2781.4061s
Epoch: 4 cost time: 7.326222658157349
Epoch: 4, Steps: 154 | Train Loss: 1.943 Vali Loss: 2.233 Vali Acc: 0.328 Test Loss: 2.233 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.4663141
	speed: 0.1790s/iter; left time: 2628.3310s
Epoch: 5 cost time: 7.223912954330444
Epoch: 5, Steps: 154 | Train Loss: 1.871 Vali Loss: 2.204 Vali Acc: 0.334 Test Loss: 2.204 Test Acc: 0.334
Validation loss decreased (-0.329257 --> -0.333717).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2317677
	speed: 0.1838s/iter; left time: 2670.7817s
Epoch: 6 cost time: 6.701519966125488
Epoch: 6, Steps: 154 | Train Loss: 1.834 Vali Loss: 2.280 Vali Acc: 0.344 Test Loss: 2.280 Test Acc: 0.344
Validation loss decreased (-0.333717 --> -0.343854).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4046495
	speed: 0.1965s/iter; left time: 2825.0491s
Epoch: 7 cost time: 7.715726852416992
Epoch: 7, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.508 Vali Acc: 0.178 Test Loss: 2.508 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5476274
	speed: 0.1912s/iter; left time: 2719.9167s
Epoch: 8 cost time: 6.940589427947998
Epoch: 8, Steps: 154 | Train Loss: 1.715 Vali Loss: 2.419 Vali Acc: 0.345 Test Loss: 2.419 Test Acc: 0.345
Validation loss decreased (-0.343854 --> -0.345069).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4004943
	speed: 0.1997s/iter; left time: 2809.0384s
Epoch: 9 cost time: 6.926434516906738
Epoch: 9, Steps: 154 | Train Loss: 1.686 Vali Loss: 2.607 Vali Acc: 0.347 Test Loss: 2.607 Test Acc: 0.347
Validation loss decreased (-0.345069 --> -0.346689).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6207014
	speed: 0.1770s/iter; left time: 2462.2835s
Epoch: 10 cost time: 7.13468074798584
Epoch: 10, Steps: 154 | Train Loss: 1.754 Vali Loss: 2.615 Vali Acc: 0.343 Test Loss: 2.615 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.6979549
	speed: 0.1739s/iter; left time: 2393.3880s
Epoch: 11 cost time: 6.462371587753296
Epoch: 11, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.730 Vali Acc: 0.358 Test Loss: 2.730 Test Acc: 0.358
Validation loss decreased (-0.346689 --> -0.358042).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5213941
	speed: 0.1821s/iter; left time: 2477.6675s
Epoch: 12 cost time: 7.610836029052734
Epoch: 12, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.702 Vali Acc: 0.364 Test Loss: 2.702 Test Acc: 0.364
Validation loss decreased (-0.358042 --> -0.364125).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3824371
	speed: 0.1782s/iter; left time: 2397.9718s
Epoch: 13 cost time: 7.070694923400879
Epoch: 13, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.761 Vali Acc: 0.358 Test Loss: 2.761 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.6968752
	speed: 0.1855s/iter; left time: 2466.4909s
Epoch: 14 cost time: 7.271584510803223
Epoch: 14, Steps: 154 | Train Loss: 1.533 Vali Loss: 2.938 Vali Acc: 0.356 Test Loss: 2.938 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.9046293
	speed: 0.1986s/iter; left time: 2610.2311s
Epoch: 15 cost time: 8.501627206802368
Epoch: 15, Steps: 154 | Train Loss: 1.530 Vali Loss: 3.079 Vali Acc: 0.363 Test Loss: 3.079 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.4588010
	speed: 0.2005s/iter; left time: 2604.3809s
Epoch: 16 cost time: 6.772108793258667
Epoch: 16, Steps: 154 | Train Loss: 1.477 Vali Loss: 3.365 Vali Acc: 0.130 Test Loss: 3.365 Test Acc: 0.130
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.0653963
	speed: 0.2080s/iter; left time: 2670.0663s
Epoch: 17 cost time: 7.549031734466553
Epoch: 17, Steps: 154 | Train Loss: 1.556 Vali Loss: 3.396 Vali Acc: 0.182 Test Loss: 3.396 Test Acc: 0.182
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.8257350
	speed: 0.1933s/iter; left time: 2451.0405s
Epoch: 18 cost time: 7.09850811958313
Epoch: 18, Steps: 154 | Train Loss: 1.482 Vali Loss: 3.625 Vali Acc: 0.366 Test Loss: 3.625 Test Acc: 0.366
Validation loss decreased (-0.364125 --> -0.366144).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.8796409
	speed: 0.1870s/iter; left time: 2343.0662s
Epoch: 19 cost time: 6.970604658126831
Epoch: 19, Steps: 154 | Train Loss: 1.725 Vali Loss: 3.783 Vali Acc: 0.366 Test Loss: 3.783 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.0813788
	speed: 0.1879s/iter; left time: 2325.0899s
Epoch: 20 cost time: 7.776313543319702
Epoch: 20, Steps: 154 | Train Loss: 1.464 Vali Loss: 4.014 Vali Acc: 0.137 Test Loss: 4.014 Test Acc: 0.137
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.9650778
	speed: 0.1759s/iter; left time: 2149.4993s
Epoch: 21 cost time: 6.70433497428894
Epoch: 21, Steps: 154 | Train Loss: 1.399 Vali Loss: 3.704 Vali Acc: 0.215 Test Loss: 3.704 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.5232944
	speed: 0.1801s/iter; left time: 2173.0809s
Epoch: 22 cost time: 6.980498313903809
Epoch: 22, Steps: 154 | Train Loss: 1.289 Vali Loss: 5.051 Vali Acc: 0.349 Test Loss: 5.051 Test Acc: 0.349
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 2.1889915
	speed: 0.1814s/iter; left time: 2161.0481s
Epoch: 23 cost time: 7.372516393661499
Epoch: 23, Steps: 154 | Train Loss: 1.844 Vali Loss: 4.275 Vali Acc: 0.380 Test Loss: 4.275 Test Acc: 0.380
Validation loss decreased (-0.366144 --> -0.379925).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.8784580
	speed: 0.1969s/iter; left time: 2315.3369s
Epoch: 24 cost time: 7.138821125030518
Epoch: 24, Steps: 154 | Train Loss: 1.236 Vali Loss: 4.296 Vali Acc: 0.207 Test Loss: 4.296 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 2.3106179
	speed: 0.2049s/iter; left time: 2377.8969s
Epoch: 25 cost time: 7.376189231872559
Epoch: 25, Steps: 154 | Train Loss: 1.435 Vali Loss: 3.894 Vali Acc: 0.215 Test Loss: 3.894 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.3522239
	speed: 0.1923s/iter; left time: 2201.5466s
Epoch: 26 cost time: 7.029680967330933
Epoch: 26, Steps: 154 | Train Loss: 1.530 Vali Loss: 4.110 Vali Acc: 0.347 Test Loss: 4.110 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.4358928
	speed: 0.1944s/iter; left time: 2196.3918s
Epoch: 27 cost time: 7.173525094985962
Epoch: 27, Steps: 154 | Train Loss: 1.421 Vali Loss: 4.984 Vali Acc: 0.357 Test Loss: 4.984 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.5486984
	speed: 0.1852s/iter; left time: 2064.0877s
Epoch: 28 cost time: 7.7463061809539795
Epoch: 28, Steps: 154 | Train Loss: 1.472 Vali Loss: 4.257 Vali Acc: 0.379 Test Loss: 4.257 Test Acc: 0.379
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.9482069
	speed: 0.1845s/iter; left time: 2027.1035s
Epoch: 29 cost time: 7.267917633056641
Epoch: 29, Steps: 154 | Train Loss: 1.323 Vali Loss: 4.473 Vali Acc: 0.384 Test Loss: 4.473 Test Acc: 0.384
Validation loss decreased (-0.379925 --> -0.383978).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.3071339
	speed: 0.1887s/iter; left time: 2044.1439s
Epoch: 30 cost time: 7.319713830947876
Epoch: 30, Steps: 154 | Train Loss: 1.166 Vali Loss: 5.274 Vali Acc: 0.240 Test Loss: 5.274 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.9233093
	speed: 0.1860s/iter; left time: 1986.1970s
Epoch: 31 cost time: 7.776987552642822
Epoch: 31, Steps: 154 | Train Loss: 1.394 Vali Loss: 4.917 Vali Acc: 0.228 Test Loss: 4.917 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.5018690
	speed: 0.1853s/iter; left time: 1951.0944s
Epoch: 32 cost time: 7.097787857055664
Epoch: 32, Steps: 154 | Train Loss: 1.302 Vali Loss: 4.878 Vali Acc: 0.330 Test Loss: 4.878 Test Acc: 0.330
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.7169004
	speed: 0.2011s/iter; left time: 2085.6311s
Epoch: 33 cost time: 7.090237617492676
Epoch: 33, Steps: 154 | Train Loss: 1.152 Vali Loss: 5.387 Vali Acc: 0.330 Test Loss: 5.387 Test Acc: 0.330
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.9468685
	speed: 0.1955s/iter; left time: 1998.2408s
Epoch: 34 cost time: 7.646301746368408
Epoch: 34, Steps: 154 | Train Loss: 1.039 Vali Loss: 5.902 Vali Acc: 0.175 Test Loss: 5.902 Test Acc: 0.175
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 1.1789809
	speed: 0.2042s/iter; left time: 2055.2871s
Epoch: 35 cost time: 6.948166370391846
Epoch: 35, Steps: 154 | Train Loss: 1.419 Vali Loss: 4.989 Vali Acc: 0.378 Test Loss: 4.989 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.4083363
	speed: 0.1924s/iter; left time: 1906.6451s
Epoch: 36 cost time: 7.580132961273193
Epoch: 36, Steps: 154 | Train Loss: 0.983 Vali Loss: 5.621 Vali Acc: 0.132 Test Loss: 5.621 Test Acc: 0.132
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 4.1442137
	speed: 0.1772s/iter; left time: 1728.6281s
Epoch: 37 cost time: 6.9618706703186035
Epoch: 37, Steps: 154 | Train Loss: 1.323 Vali Loss: 5.879 Vali Acc: 0.231 Test Loss: 5.879 Test Acc: 0.231
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 1.3358489
	speed: 0.1823s/iter; left time: 1751.0408s
Epoch: 38 cost time: 6.775025844573975
Epoch: 38, Steps: 154 | Train Loss: 1.128 Vali Loss: 5.846 Vali Acc: 0.223 Test Loss: 5.846 Test Acc: 0.223
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 3.1091301
	speed: 0.1848s/iter; left time: 1745.7975s
Epoch: 39 cost time: 7.784933805465698
Epoch: 39, Steps: 154 | Train Loss: 1.093 Vali Loss: 5.918 Vali Acc: 0.387 Test Loss: 5.918 Test Acc: 0.387
Validation loss decreased (-0.383978 --> -0.387208).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.0817536
	speed: 0.1820s/iter; left time: 1692.0479s
Epoch: 40 cost time: 6.941775798797607
Epoch: 40, Steps: 154 | Train Loss: 1.562 Vali Loss: 5.716 Vali Acc: 0.247 Test Loss: 5.716 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 1.4402184
	speed: 0.1866s/iter; left time: 1705.6668s
Epoch: 41 cost time: 7.179060459136963
Epoch: 41, Steps: 154 | Train Loss: 1.244 Vali Loss: 6.632 Vali Acc: 0.203 Test Loss: 6.632 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 0.7109730
	speed: 0.1975s/iter; left time: 1774.7351s
Epoch: 42 cost time: 8.09180212020874
Epoch: 42, Steps: 154 | Train Loss: 1.666 Vali Loss: 6.527 Vali Acc: 0.356 Test Loss: 6.527 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 0.6746414
	speed: 0.2130s/iter; left time: 1881.5004s
Epoch: 43 cost time: 7.165387392044067
Epoch: 43, Steps: 154 | Train Loss: 1.114 Vali Loss: 7.429 Vali Acc: 0.213 Test Loss: 7.429 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 0.5543997
	speed: 0.1939s/iter; left time: 1682.8220s
Epoch: 44 cost time: 6.218799591064453
Epoch: 44, Steps: 154 | Train Loss: 1.006 Vali Loss: 7.483 Vali Acc: 0.106 Test Loss: 7.483 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 0.4326676
	speed: 0.1548s/iter; left time: 1319.5749s
Epoch: 45 cost time: 7.531587839126587
Epoch: 45, Steps: 154 | Train Loss: 1.447 Vali Loss: 7.731 Vali Acc: 0.102 Test Loss: 7.731 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 46 | loss: 0.5759854
	speed: 0.1845s/iter; left time: 1544.7231s
Epoch: 46 cost time: 6.904552221298218
Epoch: 46, Steps: 154 | Train Loss: 1.620 Vali Loss: 6.230 Vali Acc: 0.335 Test Loss: 6.230 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 47 | loss: 6.0139937
	speed: 0.1863s/iter; left time: 1530.9445s
Epoch: 47 cost time: 7.518209218978882
Epoch: 47, Steps: 154 | Train Loss: 1.064 Vali Loss: 7.434 Vali Acc: 0.115 Test Loss: 7.434 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 48 | loss: 0.4647757
	speed: 0.1818s/iter; left time: 1465.9520s
Epoch: 48 cost time: 7.2956624031066895
Epoch: 48, Steps: 154 | Train Loss: 1.244 Vali Loss: 6.955 Vali Acc: 0.174 Test Loss: 6.955 Test Acc: 0.174
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 49 | loss: 0.7864420
	speed: 0.1833s/iter; left time: 1449.9681s
Epoch: 49 cost time: 6.754014492034912
Epoch: 49, Steps: 154 | Train Loss: 1.046 Vali Loss: 6.840 Vali Acc: 0.219 Test Loss: 6.840 Test Acc: 0.219
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3872668288726683
model parameter : 303670
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0041726
	speed: 0.0615s/iter; left time: 941.6320s
Epoch: 1 cost time: 8.602508544921875
Epoch: 1, Steps: 154 | Train Loss: 2.196 Vali Loss: 2.172 Vali Acc: 0.320 Test Loss: 2.172 Test Acc: 0.320
Validation loss decreased (inf --> -0.320335).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6280612
	speed: 0.1972s/iter; left time: 2986.3929s
Epoch: 2 cost time: 6.879287004470825
Epoch: 2, Steps: 154 | Train Loss: 2.072 Vali Loss: 2.157 Vali Acc: 0.323 Test Loss: 2.157 Test Acc: 0.323
Validation loss decreased (-0.320335 --> -0.322768).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3996475
	speed: 0.1988s/iter; left time: 2980.8418s
Epoch: 3 cost time: 7.237418174743652
Epoch: 3, Steps: 154 | Train Loss: 1.949 Vali Loss: 2.196 Vali Acc: 0.329 Test Loss: 2.196 Test Acc: 0.329
Validation loss decreased (-0.322768 --> -0.329256).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3351908
	speed: 0.1759s/iter; left time: 2609.9663s
Epoch: 4 cost time: 6.948990821838379
Epoch: 4, Steps: 154 | Train Loss: 1.977 Vali Loss: 2.207 Vali Acc: 0.327 Test Loss: 2.207 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3965650
	speed: 0.1819s/iter; left time: 2671.7052s
Epoch: 5 cost time: 6.997792720794678
Epoch: 5, Steps: 154 | Train Loss: 1.910 Vali Loss: 2.200 Vali Acc: 0.337 Test Loss: 2.200 Test Acc: 0.337
Validation loss decreased (-0.329256 --> -0.336555).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5130460
	speed: 0.1809s/iter; left time: 2628.3860s
Epoch: 6 cost time: 7.182739734649658
Epoch: 6, Steps: 154 | Train Loss: 1.791 Vali Loss: 2.267 Vali Acc: 0.345 Test Loss: 2.267 Test Acc: 0.345
Validation loss decreased (-0.336555 --> -0.345071).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5047045
	speed: 0.1803s/iter; left time: 2592.8222s
Epoch: 7 cost time: 7.4470484256744385
Epoch: 7, Steps: 154 | Train Loss: 1.925 Vali Loss: 2.495 Vali Acc: 0.180 Test Loss: 2.495 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4569397
	speed: 0.1805s/iter; left time: 2567.5725s
Epoch: 8 cost time: 6.73717474937439
Epoch: 8, Steps: 154 | Train Loss: 1.727 Vali Loss: 2.419 Vali Acc: 0.353 Test Loss: 2.419 Test Acc: 0.353
Validation loss decreased (-0.345071 --> -0.352774).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3712324
	speed: 0.1981s/iter; left time: 2787.4533s
Epoch: 9 cost time: 7.153428316116333
Epoch: 9, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.425 Vali Acc: 0.348 Test Loss: 2.425 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6010166
	speed: 0.1687s/iter; left time: 2348.1300s
Epoch: 10 cost time: 6.235464572906494
Epoch: 10, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.611 Vali Acc: 0.350 Test Loss: 2.611 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.7949601
	speed: 0.1920s/iter; left time: 2641.9019s
Epoch: 11 cost time: 7.05235743522644
Epoch: 11, Steps: 154 | Train Loss: 1.723 Vali Loss: 2.705 Vali Acc: 0.360 Test Loss: 2.705 Test Acc: 0.360
Validation loss decreased (-0.352774 --> -0.360070).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1830225
	speed: 0.1923s/iter; left time: 2616.2094s
Epoch: 12 cost time: 7.567337512969971
Epoch: 12, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.773 Vali Acc: 0.362 Test Loss: 2.773 Test Acc: 0.362
Validation loss decreased (-0.360070 --> -0.361692).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4133826
	speed: 0.1746s/iter; left time: 2348.8931s
Epoch: 13 cost time: 7.222091913223267
Epoch: 13, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.977 Vali Acc: 0.360 Test Loss: 2.977 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5691279
	speed: 0.1851s/iter; left time: 2461.2107s
Epoch: 14 cost time: 7.021796226501465
Epoch: 14, Steps: 154 | Train Loss: 1.743 Vali Loss: 2.758 Vali Acc: 0.360 Test Loss: 2.758 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.9122108
	speed: 0.1872s/iter; left time: 2460.9245s
Epoch: 15 cost time: 7.4883904457092285
Epoch: 15, Steps: 154 | Train Loss: 2.056 Vali Loss: 2.846 Vali Acc: 0.364 Test Loss: 2.846 Test Acc: 0.364
Validation loss decreased (-0.361692 --> -0.364124).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.6732491
	speed: 0.1764s/iter; left time: 2292.1568s
Epoch: 16 cost time: 7.322291851043701
Epoch: 16, Steps: 154 | Train Loss: 1.486 Vali Loss: 3.492 Vali Acc: 0.149 Test Loss: 3.492 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.4161053
	speed: 0.1804s/iter; left time: 2315.6734s
Epoch: 17 cost time: 6.6383256912231445
Epoch: 17, Steps: 154 | Train Loss: 1.819 Vali Loss: 3.116 Vali Acc: 0.376 Test Loss: 3.116 Test Acc: 0.376
Validation loss decreased (-0.364124 --> -0.376287).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.5035106
	speed: 0.1925s/iter; left time: 2441.6399s
Epoch: 18 cost time: 7.58198618888855
Epoch: 18, Steps: 154 | Train Loss: 1.468 Vali Loss: 3.198 Vali Acc: 0.367 Test Loss: 3.198 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.6218997
	speed: 0.1924s/iter; left time: 2410.2467s
Epoch: 19 cost time: 6.763869047164917
Epoch: 19, Steps: 154 | Train Loss: 1.386 Vali Loss: 3.475 Vali Acc: 0.375 Test Loss: 3.475 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.1686157
	speed: 0.1929s/iter; left time: 2387.4991s
Epoch: 20 cost time: 6.570556163787842
Epoch: 20, Steps: 154 | Train Loss: 1.403 Vali Loss: 3.579 Vali Acc: 0.373 Test Loss: 3.579 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.0733618
	speed: 0.1788s/iter; left time: 2185.5145s
Epoch: 21 cost time: 7.591402292251587
Epoch: 21, Steps: 154 | Train Loss: 1.522 Vali Loss: 3.442 Vali Acc: 0.379 Test Loss: 3.442 Test Acc: 0.379
Validation loss decreased (-0.376287 --> -0.379122).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.4995484
	speed: 0.1792s/iter; left time: 2162.0100s
Epoch: 22 cost time: 6.979285478591919
Epoch: 22, Steps: 154 | Train Loss: 1.298 Vali Loss: 5.013 Vali Acc: 0.119 Test Loss: 5.013 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.4533229
	speed: 0.1782s/iter; left time: 2122.6519s
Epoch: 23 cost time: 6.718886375427246
Epoch: 23, Steps: 154 | Train Loss: 1.701 Vali Loss: 3.809 Vali Acc: 0.240 Test Loss: 3.809 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.9379048
	speed: 0.1766s/iter; left time: 2076.1819s
Epoch: 24 cost time: 7.6282970905303955
Epoch: 24, Steps: 154 | Train Loss: 1.278 Vali Loss: 3.662 Vali Acc: 0.379 Test Loss: 3.662 Test Acc: 0.379
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 2.6542780
	speed: 0.1804s/iter; left time: 2092.9963s
Epoch: 25 cost time: 6.49277925491333
Epoch: 25, Steps: 154 | Train Loss: 1.461 Vali Loss: 4.648 Vali Acc: 0.208 Test Loss: 4.648 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.3271682
	speed: 0.1863s/iter; left time: 2132.7996s
Epoch: 26 cost time: 7.418214321136475
Epoch: 26, Steps: 154 | Train Loss: 1.254 Vali Loss: 4.017 Vali Acc: 0.352 Test Loss: 4.017 Test Acc: 0.352
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.2853963
	speed: 0.1949s/iter; left time: 2201.9082s
Epoch: 27 cost time: 7.705211162567139
Epoch: 27, Steps: 154 | Train Loss: 1.131 Vali Loss: 5.098 Vali Acc: 0.369 Test Loss: 5.098 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.3764149
	speed: 0.1948s/iter; left time: 2170.2090s
Epoch: 28 cost time: 6.554404020309448
Epoch: 28, Steps: 154 | Train Loss: 1.438 Vali Loss: 4.765 Vali Acc: 0.379 Test Loss: 4.765 Test Acc: 0.379
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 2.7359118
	speed: 0.2029s/iter; left time: 2229.3842s
Epoch: 29 cost time: 7.598310232162476
Epoch: 29, Steps: 154 | Train Loss: 1.832 Vali Loss: 4.752 Vali Acc: 0.238 Test Loss: 4.752 Test Acc: 0.238
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.1357607
	speed: 0.1783s/iter; left time: 1932.3878s
Epoch: 30 cost time: 7.037692070007324
Epoch: 30, Steps: 154 | Train Loss: 1.379 Vali Loss: 4.661 Vali Acc: 0.370 Test Loss: 4.661 Test Acc: 0.370
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.8299885
	speed: 0.1801s/iter; left time: 1923.4731s
Epoch: 31 cost time: 6.786133050918579
Epoch: 31, Steps: 154 | Train Loss: 1.204 Vali Loss: 4.603 Vali Acc: 0.253 Test Loss: 4.603 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3791565287915653
model parameter : 303670
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9777709
	speed: 0.0593s/iter; left time: 907.8230s
Epoch: 1 cost time: 8.144802331924438
Epoch: 1, Steps: 154 | Train Loss: 2.247 Vali Loss: 2.137 Vali Acc: 0.322 Test Loss: 2.137 Test Acc: 0.322
Validation loss decreased (inf --> -0.321552).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4238074
	speed: 0.1745s/iter; left time: 2643.7143s
Epoch: 2 cost time: 6.684354066848755
Epoch: 2, Steps: 154 | Train Loss: 2.052 Vali Loss: 2.179 Vali Acc: 0.322 Test Loss: 2.179 Test Acc: 0.322
Validation loss decreased (-0.321552 --> -0.322363).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0385151
	speed: 0.1874s/iter; left time: 2809.0011s
Epoch: 3 cost time: 7.412365198135376
Epoch: 3, Steps: 154 | Train Loss: 2.003 Vali Loss: 2.162 Vali Acc: 0.328 Test Loss: 2.162 Test Acc: 0.328
Validation loss decreased (-0.322363 --> -0.327635).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9822863
	speed: 0.1915s/iter; left time: 2841.2510s
Epoch: 4 cost time: 6.523114919662476
Epoch: 4, Steps: 154 | Train Loss: 1.933 Vali Loss: 2.178 Vali Acc: 0.326 Test Loss: 2.178 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.2210770
	speed: 0.1923s/iter; left time: 2823.2930s
Epoch: 5 cost time: 6.621078968048096
Epoch: 5, Steps: 154 | Train Loss: 1.876 Vali Loss: 2.185 Vali Acc: 0.330 Test Loss: 2.185 Test Acc: 0.330
Validation loss decreased (-0.327635 --> -0.330067).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0808187
	speed: 0.1899s/iter; left time: 2759.3860s
Epoch: 6 cost time: 7.000115633010864
Epoch: 6, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.268 Vali Acc: 0.324 Test Loss: 2.268 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.1675842
	speed: 0.1781s/iter; left time: 2560.3369s
Epoch: 7 cost time: 6.443280935287476
Epoch: 7, Steps: 154 | Train Loss: 1.823 Vali Loss: 2.253 Vali Acc: 0.330 Test Loss: 2.253 Test Acc: 0.330
Validation loss decreased (-0.330067 --> -0.330472).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9571108
	speed: 0.1764s/iter; left time: 2509.5120s
Epoch: 8 cost time: 6.807329177856445
Epoch: 8, Steps: 154 | Train Loss: 1.784 Vali Loss: 2.299 Vali Acc: 0.328 Test Loss: 2.299 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7285355
	speed: 0.1746s/iter; left time: 2456.4662s
Epoch: 9 cost time: 6.911498546600342
Epoch: 9, Steps: 154 | Train Loss: 1.717 Vali Loss: 2.215 Vali Acc: 0.343 Test Loss: 2.215 Test Acc: 0.343
Validation loss decreased (-0.330472 --> -0.342638).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9255435
	speed: 0.1815s/iter; left time: 2525.1998s
Epoch: 10 cost time: 6.82152247428894
Epoch: 10, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.319 Vali Acc: 0.336 Test Loss: 2.319 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4732310
	speed: 0.1772s/iter; left time: 2438.5310s
Epoch: 11 cost time: 6.896868944168091
Epoch: 11, Steps: 154 | Train Loss: 1.763 Vali Loss: 2.391 Vali Acc: 0.340 Test Loss: 2.391 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.7299525
	speed: 0.1834s/iter; left time: 2495.2055s
Epoch: 12 cost time: 7.271385908126831
Epoch: 12, Steps: 154 | Train Loss: 1.703 Vali Loss: 2.387 Vali Acc: 0.340 Test Loss: 2.387 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.8179542
	speed: 0.2000s/iter; left time: 2690.7558s
Epoch: 13 cost time: 6.693666934967041
Epoch: 13, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.451 Vali Acc: 0.345 Test Loss: 2.451 Test Acc: 0.345
Validation loss decreased (-0.342638 --> -0.345069).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3801881
	speed: 0.1916s/iter; left time: 2547.8554s
Epoch: 14 cost time: 7.310295820236206
Epoch: 14, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.585 Vali Acc: 0.354 Test Loss: 2.585 Test Acc: 0.354
Validation loss decreased (-0.345069 --> -0.353583).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.6845349
	speed: 0.1937s/iter; left time: 2545.7510s
Epoch: 15 cost time: 6.539687871932983
Epoch: 15, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.568 Vali Acc: 0.358 Test Loss: 2.568 Test Acc: 0.358
Validation loss decreased (-0.353583 --> -0.357639).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5828024
	speed: 0.1739s/iter; left time: 2259.3331s
Epoch: 16 cost time: 6.451211452484131
Epoch: 16, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.517 Vali Acc: 0.365 Test Loss: 2.517 Test Acc: 0.365
Validation loss decreased (-0.357639 --> -0.364533).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.3057674
	speed: 0.1769s/iter; left time: 2271.0332s
Epoch: 17 cost time: 7.172796010971069
Epoch: 17, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.535 Vali Acc: 0.357 Test Loss: 2.535 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.2173294
	speed: 0.1727s/iter; left time: 2190.3641s
Epoch: 18 cost time: 6.689837694168091
Epoch: 18, Steps: 154 | Train Loss: 1.458 Vali Loss: 2.677 Vali Acc: 0.361 Test Loss: 2.677 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.4760318
	speed: 0.1758s/iter; left time: 2202.3729s
Epoch: 19 cost time: 6.205383777618408
Epoch: 19, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.600 Vali Acc: 0.235 Test Loss: 2.600 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.5384483
	speed: 0.1741s/iter; left time: 2155.0252s
Epoch: 20 cost time: 7.041825771331787
Epoch: 20, Steps: 154 | Train Loss: 1.408 Vali Loss: 3.059 Vali Acc: 0.365 Test Loss: 3.059 Test Acc: 0.365
Validation loss decreased (-0.364533 --> -0.364933).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.4603701
	speed: 0.1873s/iter; left time: 2288.5130s
Epoch: 21 cost time: 6.491721868515015
Epoch: 21, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.801 Vali Acc: 0.373 Test Loss: 2.801 Test Acc: 0.373
Validation loss decreased (-0.364933 --> -0.373451).  Saving model ...
	iters: 100, epoch: 22 | loss: 2.1589437
	speed: 0.1918s/iter; left time: 2315.0273s
Epoch: 22 cost time: 6.43980598449707
Epoch: 22, Steps: 154 | Train Loss: 1.464 Vali Loss: 3.272 Vali Acc: 0.376 Test Loss: 3.272 Test Acc: 0.376
Validation loss decreased (-0.373451 --> -0.375474).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.0915506
	speed: 0.1934s/iter; left time: 2304.4423s
Epoch: 23 cost time: 7.548348903656006
Epoch: 23, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.784 Vali Acc: 0.365 Test Loss: 2.784 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.6105703
	speed: 0.1906s/iter; left time: 2241.1469s
Epoch: 24 cost time: 6.510161638259888
Epoch: 24, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.758 Vali Acc: 0.207 Test Loss: 2.758 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.0483372
	speed: 0.1821s/iter; left time: 2113.3121s
Epoch: 25 cost time: 7.178199052810669
Epoch: 25, Steps: 154 | Train Loss: 1.376 Vali Loss: 2.879 Vali Acc: 0.254 Test Loss: 2.879 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.5411667
	speed: 0.1727s/iter; left time: 1977.9660s
Epoch: 26 cost time: 6.844505786895752
Epoch: 26, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.812 Vali Acc: 0.373 Test Loss: 2.812 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.8658563
	speed: 0.1782s/iter; left time: 2013.1351s
Epoch: 27 cost time: 6.554325103759766
Epoch: 27, Steps: 154 | Train Loss: 1.368 Vali Loss: 2.954 Vali Acc: 0.217 Test Loss: 2.954 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 1.3568922
	speed: 0.1651s/iter; left time: 1839.5078s
Epoch: 28 cost time: 6.8860485553741455
Epoch: 28, Steps: 154 | Train Loss: 1.308 Vali Loss: 3.003 Vali Acc: 0.192 Test Loss: 3.003 Test Acc: 0.192
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 12.6038837
	speed: 0.1760s/iter; left time: 1934.4926s
Epoch: 29 cost time: 6.596576452255249
Epoch: 29, Steps: 154 | Train Loss: 1.522 Vali Loss: 3.423 Vali Acc: 0.214 Test Loss: 3.423 Test Acc: 0.214
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.1010767
	speed: 0.1913s/iter; left time: 2072.2329s
Epoch: 30 cost time: 6.449132919311523
Epoch: 30, Steps: 154 | Train Loss: 1.316 Vali Loss: 3.622 Vali Acc: 0.083 Test Loss: 3.622 Test Acc: 0.083
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 2.2107747
	speed: 0.1919s/iter; left time: 2050.2176s
Epoch: 31 cost time: 7.359046936035156
Epoch: 31, Steps: 154 | Train Loss: 1.262 Vali Loss: 3.609 Vali Acc: 0.094 Test Loss: 3.609 Test Acc: 0.094
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 1.4311236
	speed: 0.1905s/iter; left time: 2005.6802s
Epoch: 32 cost time: 6.723048448562622
Epoch: 32, Steps: 154 | Train Loss: 1.256 Vali Loss: 3.423 Vali Acc: 0.202 Test Loss: 3.423 Test Acc: 0.202
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37550689375506896
model parameter : 626998
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9743285
	speed: 0.0641s/iter; left time: 980.0960s
Epoch: 1 cost time: 8.889080286026001
Epoch: 1, Steps: 154 | Train Loss: 2.242 Vali Loss: 2.139 Vali Acc: 0.321 Test Loss: 2.139 Test Acc: 0.321
Validation loss decreased (inf --> -0.320741).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4204786
	speed: 0.1717s/iter; left time: 2601.1349s
Epoch: 2 cost time: 6.213578462600708
Epoch: 2, Steps: 154 | Train Loss: 2.053 Vali Loss: 2.178 Vali Acc: 0.323 Test Loss: 2.178 Test Acc: 0.323
Validation loss decreased (-0.320741 --> -0.322768).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0567560
	speed: 0.1733s/iter; left time: 2598.5735s
Epoch: 3 cost time: 6.606480598449707
Epoch: 3, Steps: 154 | Train Loss: 1.989 Vali Loss: 2.164 Vali Acc: 0.328 Test Loss: 2.164 Test Acc: 0.328
Validation loss decreased (-0.322768 --> -0.328040).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9790497
	speed: 0.1725s/iter; left time: 2559.1673s
Epoch: 4 cost time: 6.849414587020874
Epoch: 4, Steps: 154 | Train Loss: 1.935 Vali Loss: 2.169 Vali Acc: 0.325 Test Loss: 2.169 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.2069921
	speed: 0.1703s/iter; left time: 2501.2749s
Epoch: 5 cost time: 6.178485870361328
Epoch: 5, Steps: 154 | Train Loss: 1.906 Vali Loss: 2.165 Vali Acc: 0.328 Test Loss: 2.165 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.0882177
	speed: 0.1959s/iter; left time: 2846.0497s
Epoch: 6 cost time: 7.458273410797119
Epoch: 6, Steps: 154 | Train Loss: 1.838 Vali Loss: 2.244 Vali Acc: 0.326 Test Loss: 2.244 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.2279155
	speed: 0.1856s/iter; left time: 2667.7872s
Epoch: 7 cost time: 6.951570272445679
Epoch: 7, Steps: 154 | Train Loss: 1.794 Vali Loss: 2.232 Vali Acc: 0.330 Test Loss: 2.232 Test Acc: 0.330
Validation loss decreased (-0.328040 --> -0.330472).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5427705
	speed: 0.1957s/iter; left time: 2783.5373s
Epoch: 8 cost time: 6.725302696228027
Epoch: 8, Steps: 154 | Train Loss: 1.773 Vali Loss: 2.336 Vali Acc: 0.330 Test Loss: 2.336 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7929844
	speed: 0.1847s/iter; left time: 2597.8466s
Epoch: 9 cost time: 7.386586666107178
Epoch: 9, Steps: 154 | Train Loss: 1.791 Vali Loss: 2.176 Vali Acc: 0.343 Test Loss: 2.176 Test Acc: 0.343
Validation loss decreased (-0.330472 --> -0.343044).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0911138
	speed: 0.1730s/iter; left time: 2406.6818s
Epoch: 10 cost time: 6.534742593765259
Epoch: 10, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.307 Vali Acc: 0.339 Test Loss: 2.307 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4248755
	speed: 0.1744s/iter; left time: 2400.5810s
Epoch: 11 cost time: 6.244471073150635
Epoch: 11, Steps: 154 | Train Loss: 1.753 Vali Loss: 2.387 Vali Acc: 0.340 Test Loss: 2.387 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.6094458
	speed: 0.1712s/iter; left time: 2329.7108s
Epoch: 12 cost time: 7.3003668785095215
Epoch: 12, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.330 Vali Acc: 0.346 Test Loss: 2.330 Test Acc: 0.346
Validation loss decreased (-0.343044 --> -0.346287).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3852127
	speed: 0.1723s/iter; left time: 2318.1401s
Epoch: 13 cost time: 6.182403087615967
Epoch: 13, Steps: 154 | Train Loss: 1.633 Vali Loss: 2.399 Vali Acc: 0.346 Test Loss: 2.399 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3088795
	speed: 0.1760s/iter; left time: 2340.2326s
Epoch: 14 cost time: 6.883723020553589
Epoch: 14, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.515 Vali Acc: 0.349 Test Loss: 2.515 Test Acc: 0.349
Validation loss decreased (-0.346287 --> -0.348718).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.6384078
	speed: 0.1886s/iter; left time: 2479.6422s
Epoch: 15 cost time: 6.717454671859741
Epoch: 15, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.603 Vali Acc: 0.351 Test Loss: 2.603 Test Acc: 0.351
Validation loss decreased (-0.348718 --> -0.351150).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4941937
	speed: 0.1885s/iter; left time: 2448.9728s
Epoch: 16 cost time: 6.522088289260864
Epoch: 16, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.636 Vali Acc: 0.357 Test Loss: 2.636 Test Acc: 0.357
Validation loss decreased (-0.351150 --> -0.357232).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.2328823
	speed: 0.1975s/iter; left time: 2535.7452s
Epoch: 17 cost time: 7.5931010246276855
Epoch: 17, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.556 Vali Acc: 0.358 Test Loss: 2.556 Test Acc: 0.358
Validation loss decreased (-0.357232 --> -0.358450).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.1550100
	speed: 0.1745s/iter; left time: 2213.1738s
Epoch: 18 cost time: 6.380874395370483
Epoch: 18, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.593 Vali Acc: 0.329 Test Loss: 2.593 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.0767986
	speed: 0.1735s/iter; left time: 2173.2804s
Epoch: 19 cost time: 6.568007707595825
Epoch: 19, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.605 Vali Acc: 0.357 Test Loss: 2.605 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.6580319
	speed: 0.1743s/iter; left time: 2157.1935s
Epoch: 20 cost time: 7.195873737335205
Epoch: 20, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.797 Vali Acc: 0.364 Test Loss: 2.797 Test Acc: 0.364
Validation loss decreased (-0.358450 --> -0.364125).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.3623580
	speed: 0.1719s/iter; left time: 2101.2197s
Epoch: 21 cost time: 6.670294523239136
Epoch: 21, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.859 Vali Acc: 0.367 Test Loss: 2.859 Test Acc: 0.367
Validation loss decreased (-0.364125 --> -0.366557).  Saving model ...
	iters: 100, epoch: 22 | loss: 2.1242008
	speed: 0.1793s/iter; left time: 2163.7286s
Epoch: 22 cost time: 6.718656301498413
Epoch: 22, Steps: 154 | Train Loss: 1.385 Vali Loss: 2.558 Vali Acc: 0.372 Test Loss: 2.558 Test Acc: 0.372
Validation loss decreased (-0.366557 --> -0.372237).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.2533625
	speed: 0.1779s/iter; left time: 2119.3116s
Epoch: 23 cost time: 7.501030921936035
Epoch: 23, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.876 Vali Acc: 0.250 Test Loss: 2.876 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.5252433
	speed: 0.1915s/iter; left time: 2252.1775s
Epoch: 24 cost time: 6.7672412395477295
Epoch: 24, Steps: 154 | Train Loss: 1.374 Vali Loss: 2.895 Vali Acc: 0.356 Test Loss: 2.895 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.1485323
	speed: 0.1962s/iter; left time: 2277.3929s
Epoch: 25 cost time: 7.096379518508911
Epoch: 25, Steps: 154 | Train Loss: 1.310 Vali Loss: 2.743 Vali Acc: 0.372 Test Loss: 2.743 Test Acc: 0.372
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.4629670
	speed: 0.1880s/iter; left time: 2153.3021s
Epoch: 26 cost time: 6.747544288635254
Epoch: 26, Steps: 154 | Train Loss: 1.778 Vali Loss: 2.890 Vali Acc: 0.375 Test Loss: 2.890 Test Acc: 0.375
Validation loss decreased (-0.372237 --> -0.375072).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.9910817
	speed: 0.1909s/iter; left time: 2156.6199s
Epoch: 27 cost time: 7.600748777389526
Epoch: 27, Steps: 154 | Train Loss: 1.544 Vali Loss: 3.183 Vali Acc: 0.137 Test Loss: 3.183 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.4546919
	speed: 0.1563s/iter; left time: 1741.8292s
Epoch: 28 cost time: 3.838381052017212
Epoch: 28, Steps: 154 | Train Loss: 1.280 Vali Loss: 3.263 Vali Acc: 0.297 Test Loss: 3.263 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.9884779
	speed: 0.0944s/iter; left time: 1037.8143s
Epoch: 29 cost time: 3.815195322036743
Epoch: 29, Steps: 154 | Train Loss: 1.317 Vali Loss: 3.467 Vali Acc: 0.221 Test Loss: 3.467 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.0990974
	speed: 0.1594s/iter; left time: 1727.3865s
Epoch: 30 cost time: 6.675081253051758
Epoch: 30, Steps: 154 | Train Loss: 1.399 Vali Loss: 3.377 Vali Acc: 0.376 Test Loss: 3.377 Test Acc: 0.376
Validation loss decreased (-0.375072 --> -0.375473).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.8989521
	speed: 0.1681s/iter; left time: 1795.0727s
Epoch: 31 cost time: 6.426871061325073
Epoch: 31, Steps: 154 | Train Loss: 1.312 Vali Loss: 3.654 Vali Acc: 0.373 Test Loss: 3.654 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 1.5530099
	speed: 0.1742s/iter; left time: 1833.5471s
Epoch: 32 cost time: 6.478479385375977
Epoch: 32, Steps: 154 | Train Loss: 1.231 Vali Loss: 4.038 Vali Acc: 0.190 Test Loss: 4.038 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.7221614
	speed: 0.1734s/iter; left time: 1798.4237s
Epoch: 33 cost time: 6.752862215042114
Epoch: 33, Steps: 154 | Train Loss: 1.207 Vali Loss: 4.075 Vali Acc: 0.236 Test Loss: 4.075 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 1.3361617
	speed: 0.1745s/iter; left time: 1782.9034s
Epoch: 34 cost time: 6.743536710739136
Epoch: 34, Steps: 154 | Train Loss: 1.240 Vali Loss: 3.770 Vali Acc: 0.213 Test Loss: 3.770 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 1.0553672
	speed: 0.1848s/iter; left time: 1859.9484s
Epoch: 35 cost time: 6.597663164138794
Epoch: 35, Steps: 154 | Train Loss: 1.267 Vali Loss: 3.732 Vali Acc: 0.197 Test Loss: 3.732 Test Acc: 0.197
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 1.2286799
	speed: 0.1955s/iter; left time: 1937.6909s
Epoch: 36 cost time: 7.129913330078125
Epoch: 36, Steps: 154 | Train Loss: 1.247 Vali Loss: 3.897 Vali Acc: 0.187 Test Loss: 3.897 Test Acc: 0.187
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 1.0552275
	speed: 0.1936s/iter; left time: 1888.9316s
Epoch: 37 cost time: 7.362038850784302
Epoch: 37, Steps: 154 | Train Loss: 1.172 Vali Loss: 3.429 Vali Acc: 0.217 Test Loss: 3.429 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 1.3040726
	speed: 0.1911s/iter; left time: 1835.3045s
Epoch: 38 cost time: 6.339889287948608
Epoch: 38, Steps: 154 | Train Loss: 1.191 Vali Loss: 4.079 Vali Acc: 0.174 Test Loss: 4.079 Test Acc: 0.174
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.7228571
	speed: 0.1719s/iter; left time: 1624.3452s
Epoch: 39 cost time: 6.69538688659668
Epoch: 39, Steps: 154 | Train Loss: 1.249 Vali Loss: 4.029 Vali Acc: 0.170 Test Loss: 4.029 Test Acc: 0.170
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 1.0595410
	speed: 0.1621s/iter; left time: 1506.6441s
Epoch: 40 cost time: 6.456595182418823
Epoch: 40, Steps: 154 | Train Loss: 1.117 Vali Loss: 3.702 Vali Acc: 0.387 Test Loss: 3.702 Test Acc: 0.387
Validation loss decreased (-0.375473 --> -0.387230).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.9023204
	speed: 0.1709s/iter; left time: 1562.0366s
Epoch: 41 cost time: 6.33720588684082
Epoch: 41, Steps: 154 | Train Loss: 1.096 Vali Loss: 3.889 Vali Acc: 0.208 Test Loss: 3.889 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 1.2924947
	speed: 0.1726s/iter; left time: 1551.3744s
Epoch: 42 cost time: 6.51109504699707
Epoch: 42, Steps: 154 | Train Loss: 1.149 Vali Loss: 3.987 Vali Acc: 0.208 Test Loss: 3.987 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 1.0557677
	speed: 0.1726s/iter; left time: 1524.5882s
Epoch: 43 cost time: 6.510035753250122
Epoch: 43, Steps: 154 | Train Loss: 1.324 Vali Loss: 3.990 Vali Acc: 0.160 Test Loss: 3.990 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 1.3537707
	speed: 0.1905s/iter; left time: 1653.6461s
Epoch: 44 cost time: 6.598865509033203
Epoch: 44, Steps: 154 | Train Loss: 1.076 Vali Loss: 4.456 Vali Acc: 0.150 Test Loss: 4.456 Test Acc: 0.150
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.5153645
	speed: 0.1925s/iter; left time: 1640.7472s
Epoch: 45 cost time: 6.911998271942139
Epoch: 45, Steps: 154 | Train Loss: 1.171 Vali Loss: 3.948 Vali Acc: 0.141 Test Loss: 3.948 Test Acc: 0.141
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.6386613
	speed: 0.1879s/iter; left time: 1573.0008s
Epoch: 46 cost time: 6.884820938110352
Epoch: 46, Steps: 154 | Train Loss: 1.257 Vali Loss: 4.074 Vali Acc: 0.195 Test Loss: 4.074 Test Acc: 0.195
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 1.1433765
	speed: 0.1771s/iter; left time: 1455.3461s
Epoch: 47 cost time: 6.162980318069458
Epoch: 47, Steps: 154 | Train Loss: 1.134 Vali Loss: 4.264 Vali Acc: 0.084 Test Loss: 4.264 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 9.3077049
	speed: 0.1757s/iter; left time: 1416.9969s
Epoch: 48 cost time: 6.609410762786865
Epoch: 48, Steps: 154 | Train Loss: 1.231 Vali Loss: 3.841 Vali Acc: 0.197 Test Loss: 3.841 Test Acc: 0.197
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.8479913
	speed: 0.1651s/iter; left time: 1305.8299s
Epoch: 49 cost time: 6.564180850982666
Epoch: 49, Steps: 154 | Train Loss: 1.159 Vali Loss: 4.329 Vali Acc: 0.099 Test Loss: 4.329 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 0.9167312
	speed: 0.1732s/iter; left time: 1342.9503s
Epoch: 50 cost time: 6.333843231201172
Epoch: 50, Steps: 154 | Train Loss: 1.034 Vali Loss: 4.067 Vali Acc: 0.126 Test Loss: 4.067 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3872668288726683
model parameter : 626998
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9657546
	speed: 0.0591s/iter; left time: 904.8282s
Epoch: 1 cost time: 8.211682081222534
Epoch: 1, Steps: 154 | Train Loss: 2.226 Vali Loss: 2.138 Vali Acc: 0.320 Test Loss: 2.138 Test Acc: 0.320
Validation loss decreased (inf --> -0.320335).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4224896
	speed: 0.1913s/iter; left time: 2897.3242s
Epoch: 2 cost time: 6.38021445274353
Epoch: 2, Steps: 154 | Train Loss: 2.053 Vali Loss: 2.170 Vali Acc: 0.323 Test Loss: 2.170 Test Acc: 0.323
Validation loss decreased (-0.320335 --> -0.323174).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1083686
	speed: 0.1906s/iter; left time: 2857.0436s
Epoch: 3 cost time: 7.715136766433716
Epoch: 3, Steps: 154 | Train Loss: 1.989 Vali Loss: 2.157 Vali Acc: 0.328 Test Loss: 2.157 Test Acc: 0.328
Validation loss decreased (-0.323174 --> -0.327635).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9652158
	speed: 0.1875s/iter; left time: 2782.6178s
Epoch: 4 cost time: 6.335596799850464
Epoch: 4, Steps: 154 | Train Loss: 1.931 Vali Loss: 2.165 Vali Acc: 0.324 Test Loss: 2.165 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.1395824
	speed: 0.1697s/iter; left time: 2491.6249s
Epoch: 5 cost time: 6.470124006271362
Epoch: 5, Steps: 154 | Train Loss: 1.894 Vali Loss: 2.163 Vali Acc: 0.333 Test Loss: 2.163 Test Acc: 0.333
Validation loss decreased (-0.327635 --> -0.332501).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0756817
	speed: 0.1685s/iter; left time: 2448.5083s
Epoch: 6 cost time: 6.921745777130127
Epoch: 6, Steps: 154 | Train Loss: 1.832 Vali Loss: 2.209 Vali Acc: 0.327 Test Loss: 2.209 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.2801206
	speed: 0.1654s/iter; left time: 2378.4539s
Epoch: 7 cost time: 6.2185282707214355
Epoch: 7, Steps: 154 | Train Loss: 1.817 Vali Loss: 2.227 Vali Acc: 0.332 Test Loss: 2.227 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.3209300
	speed: 0.1692s/iter; left time: 2406.1451s
Epoch: 8 cost time: 6.4312450885772705
Epoch: 8, Steps: 154 | Train Loss: 1.782 Vali Loss: 2.257 Vali Acc: 0.335 Test Loss: 2.257 Test Acc: 0.335
Validation loss decreased (-0.332501 --> -0.334933).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7190757
	speed: 0.1677s/iter; left time: 2359.7224s
Epoch: 9 cost time: 6.882128953933716
Epoch: 9, Steps: 154 | Train Loss: 1.732 Vali Loss: 2.186 Vali Acc: 0.345 Test Loss: 2.186 Test Acc: 0.345
Validation loss decreased (-0.334933 --> -0.345477).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0107887
	speed: 0.1807s/iter; left time: 2513.9373s
Epoch: 10 cost time: 6.403960227966309
Epoch: 10, Steps: 154 | Train Loss: 1.709 Vali Loss: 2.362 Vali Acc: 0.340 Test Loss: 2.362 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3964773
	speed: 0.1904s/iter; left time: 2619.8631s
Epoch: 11 cost time: 6.68398118019104
Epoch: 11, Steps: 154 | Train Loss: 1.649 Vali Loss: 2.380 Vali Acc: 0.345 Test Loss: 2.380 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.6151054
	speed: 0.1803s/iter; left time: 2453.5795s
Epoch: 12 cost time: 6.689362049102783
Epoch: 12, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.385 Vali Acc: 0.350 Test Loss: 2.385 Test Acc: 0.350
Validation loss decreased (-0.345477 --> -0.349530).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3369988
	speed: 0.1886s/iter; left time: 2536.6256s
Epoch: 13 cost time: 6.159375190734863
Epoch: 13, Steps: 154 | Train Loss: 1.572 Vali Loss: 2.484 Vali Acc: 0.349 Test Loss: 2.484 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4033668
	speed: 0.1557s/iter; left time: 2070.1487s
Epoch: 14 cost time: 5.4522809982299805
Epoch: 14, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.533 Vali Acc: 0.355 Test Loss: 2.533 Test Acc: 0.355
Validation loss decreased (-0.349530 --> -0.355206).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4967997
	speed: 0.1449s/iter; left time: 1904.6283s
Epoch: 15 cost time: 6.866384029388428
Epoch: 15, Steps: 154 | Train Loss: 1.665 Vali Loss: 2.566 Vali Acc: 0.355 Test Loss: 2.566 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.5257862
	speed: 0.1696s/iter; left time: 2203.4894s
Epoch: 16 cost time: 6.450366258621216
Epoch: 16, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.759 Vali Acc: 0.362 Test Loss: 2.759 Test Acc: 0.362
Validation loss decreased (-0.355206 --> -0.362097).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0434779
	speed: 0.1678s/iter; left time: 2154.0673s
Epoch: 17 cost time: 6.4128522872924805
Epoch: 17, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.625 Vali Acc: 0.353 Test Loss: 2.625 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.1032943
	speed: 0.1685s/iter; left time: 2137.3525s
Epoch: 18 cost time: 7.047544479370117
Epoch: 18, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.751 Vali Acc: 0.363 Test Loss: 2.751 Test Acc: 0.363
Validation loss decreased (-0.362097 --> -0.362908).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.0973234
	speed: 0.1726s/iter; left time: 2162.9552s
Epoch: 19 cost time: 6.395009756088257
Epoch: 19, Steps: 154 | Train Loss: 1.445 Vali Loss: 2.893 Vali Acc: 0.356 Test Loss: 2.893 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.6753926
	speed: 0.1842s/iter; left time: 2279.0942s
Epoch: 20 cost time: 6.014758348464966
Epoch: 20, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.799 Vali Acc: 0.363 Test Loss: 2.799 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.0962250
	speed: 0.1807s/iter; left time: 2208.2817s
Epoch: 21 cost time: 7.3836095333099365
Epoch: 21, Steps: 154 | Train Loss: 1.405 Vali Loss: 2.944 Vali Acc: 0.261 Test Loss: 2.944 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 2.2833064
	speed: 0.1879s/iter; left time: 2267.7959s
Epoch: 22 cost time: 5.987140655517578
Epoch: 22, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.876 Vali Acc: 0.370 Test Loss: 2.876 Test Acc: 0.370
Validation loss decreased (-0.362908 --> -0.370206).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.2240679
	speed: 0.1691s/iter; left time: 2014.3784s
Epoch: 23 cost time: 6.308187007904053
Epoch: 23, Steps: 154 | Train Loss: 1.431 Vali Loss: 3.086 Vali Acc: 0.365 Test Loss: 3.086 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.5908020
	speed: 0.1648s/iter; left time: 1937.8704s
Epoch: 24 cost time: 6.6058573722839355
Epoch: 24, Steps: 154 | Train Loss: 1.302 Vali Loss: 2.918 Vali Acc: 0.374 Test Loss: 2.918 Test Acc: 0.374
Validation loss decreased (-0.370206 --> -0.374261).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.9723243
	speed: 0.1682s/iter; left time: 1952.1917s
Epoch: 25 cost time: 6.11997127532959
Epoch: 25, Steps: 154 | Train Loss: 1.271 Vali Loss: 3.405 Vali Acc: 0.368 Test Loss: 3.405 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.5557857
	speed: 0.1678s/iter; left time: 1921.8326s
Epoch: 26 cost time: 6.332131624221802
Epoch: 26, Steps: 154 | Train Loss: 1.453 Vali Loss: 3.109 Vali Acc: 0.366 Test Loss: 3.109 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.9099632
	speed: 0.1661s/iter; left time: 1875.9361s
Epoch: 27 cost time: 6.66063666343689
Epoch: 27, Steps: 154 | Train Loss: 1.324 Vali Loss: 3.504 Vali Acc: 0.291 Test Loss: 3.504 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.4467088
	speed: 0.1757s/iter; left time: 1957.8464s
Epoch: 28 cost time: 6.443068981170654
Epoch: 28, Steps: 154 | Train Loss: 1.219 Vali Loss: 3.304 Vali Acc: 0.376 Test Loss: 3.304 Test Acc: 0.376
Validation loss decreased (-0.374261 --> -0.375474).  Saving model ...
	iters: 100, epoch: 29 | loss: 2.9035766
	speed: 0.1888s/iter; left time: 2074.6457s
Epoch: 29 cost time: 6.410476922988892
Epoch: 29, Steps: 154 | Train Loss: 1.335 Vali Loss: 3.421 Vali Acc: 0.240 Test Loss: 3.421 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.9951896
	speed: 0.1905s/iter; left time: 2064.4979s
Epoch: 30 cost time: 6.892911911010742
Epoch: 30, Steps: 154 | Train Loss: 1.302 Vali Loss: 3.686 Vali Acc: 0.378 Test Loss: 3.686 Test Acc: 0.378
Validation loss decreased (-0.375474 --> -0.377498).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.7422282
	speed: 0.1821s/iter; left time: 1945.4746s
Epoch: 31 cost time: 6.748096942901611
Epoch: 31, Steps: 154 | Train Loss: 1.240 Vali Loss: 3.796 Vali Acc: 0.228 Test Loss: 3.796 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 1.2314804
	speed: 0.1709s/iter; left time: 1799.2947s
Epoch: 32 cost time: 6.013524532318115
Epoch: 32, Steps: 154 | Train Loss: 1.273 Vali Loss: 4.051 Vali Acc: 0.210 Test Loss: 4.051 Test Acc: 0.210
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.6494163
	speed: 0.1700s/iter; left time: 1763.0675s
Epoch: 33 cost time: 6.810507535934448
Epoch: 33, Steps: 154 | Train Loss: 1.252 Vali Loss: 4.192 Vali Acc: 0.233 Test Loss: 4.192 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 1.3533942
	speed: 0.1660s/iter; left time: 1696.6332s
Epoch: 34 cost time: 6.680453062057495
Epoch: 34, Steps: 154 | Train Loss: 1.274 Vali Loss: 3.846 Vali Acc: 0.265 Test Loss: 3.846 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.8636582
	speed: 0.1667s/iter; left time: 1677.4347s
Epoch: 35 cost time: 6.019646644592285
Epoch: 35, Steps: 154 | Train Loss: 1.188 Vali Loss: 4.081 Vali Acc: 0.215 Test Loss: 4.081 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 1.2130353
	speed: 0.1696s/iter; left time: 1680.5937s
Epoch: 36 cost time: 6.25058126449585
Epoch: 36, Steps: 154 | Train Loss: 1.300 Vali Loss: 4.013 Vali Acc: 0.377 Test Loss: 4.013 Test Acc: 0.377
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 1.3340904
	speed: 0.1810s/iter; left time: 1765.8954s
Epoch: 37 cost time: 6.48480224609375
Epoch: 37, Steps: 154 | Train Loss: 1.135 Vali Loss: 3.830 Vali Acc: 0.366 Test Loss: 3.830 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 1.2862684
	speed: 0.1906s/iter; left time: 1830.2233s
Epoch: 38 cost time: 6.400080919265747
Epoch: 38, Steps: 154 | Train Loss: 1.140 Vali Loss: 4.533 Vali Acc: 0.311 Test Loss: 4.533 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.8864622
	speed: 0.1881s/iter; left time: 1777.6921s
Epoch: 39 cost time: 6.52543568611145
Epoch: 39, Steps: 154 | Train Loss: 1.186 Vali Loss: 4.507 Vali Acc: 0.210 Test Loss: 4.507 Test Acc: 0.210
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.9132100
	speed: 0.1707s/iter; left time: 1587.0993s
Epoch: 40 cost time: 6.381721496582031
Epoch: 40, Steps: 154 | Train Loss: 1.222 Vali Loss: 4.795 Vali Acc: 0.325 Test Loss: 4.795 Test Acc: 0.325
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3775344687753447
model parameter : 626998
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9734554
	speed: 0.0576s/iter; left time: 881.1250s
Epoch: 1 cost time: 7.7309253215789795
Epoch: 1, Steps: 154 | Train Loss: 2.212 Vali Loss: 2.136 Vali Acc: 0.320 Test Loss: 2.136 Test Acc: 0.320
Validation loss decreased (inf --> -0.319524).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3880289
	speed: 0.1671s/iter; left time: 2531.4089s
Epoch: 2 cost time: 5.814863681793213
Epoch: 2, Steps: 154 | Train Loss: 2.054 Vali Loss: 2.161 Vali Acc: 0.322 Test Loss: 2.161 Test Acc: 0.322
Validation loss decreased (-0.319524 --> -0.321552).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1220446
	speed: 0.1653s/iter; left time: 2478.2142s
Epoch: 3 cost time: 5.816687107086182
Epoch: 3, Steps: 154 | Train Loss: 1.994 Vali Loss: 2.156 Vali Acc: 0.327 Test Loss: 2.156 Test Acc: 0.327
Validation loss decreased (-0.321552 --> -0.326824).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0096443
	speed: 0.1649s/iter; left time: 2447.4496s
Epoch: 4 cost time: 6.118879556655884
Epoch: 4, Steps: 154 | Train Loss: 1.950 Vali Loss: 2.126 Vali Acc: 0.322 Test Loss: 2.126 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.1962235
	speed: 0.1774s/iter; left time: 2604.4612s
Epoch: 5 cost time: 6.334819078445435
Epoch: 5, Steps: 154 | Train Loss: 1.904 Vali Loss: 2.136 Vali Acc: 0.332 Test Loss: 2.136 Test Acc: 0.332
Validation loss decreased (-0.326824 --> -0.331690).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0675256
	speed: 0.1798s/iter; left time: 2611.9909s
Epoch: 6 cost time: 6.273608922958374
Epoch: 6, Steps: 154 | Train Loss: 1.853 Vali Loss: 2.188 Vali Acc: 0.332 Test Loss: 2.188 Test Acc: 0.332
Validation loss decreased (-0.331690 --> -0.332095).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2238474
	speed: 0.1798s/iter; left time: 2584.3050s
Epoch: 7 cost time: 6.822558164596558
Epoch: 7, Steps: 154 | Train Loss: 1.786 Vali Loss: 2.190 Vali Acc: 0.336 Test Loss: 2.190 Test Acc: 0.336
Validation loss decreased (-0.332095 --> -0.335745).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.1405637
	speed: 0.1696s/iter; left time: 2411.7182s
Epoch: 8 cost time: 5.8269288539886475
Epoch: 8, Steps: 154 | Train Loss: 1.783 Vali Loss: 2.277 Vali Acc: 0.340 Test Loss: 2.277 Test Acc: 0.340
Validation loss decreased (-0.335745 --> -0.340204).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7542775
	speed: 0.1643s/iter; left time: 2311.0795s
Epoch: 9 cost time: 5.665255546569824
Epoch: 9, Steps: 154 | Train Loss: 1.837 Vali Loss: 2.294 Vali Acc: 0.346 Test Loss: 2.294 Test Acc: 0.346
Validation loss decreased (-0.340204 --> -0.345881).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0135062
	speed: 0.1636s/iter; left time: 2276.3497s
Epoch: 10 cost time: 5.385279417037964
Epoch: 10, Steps: 154 | Train Loss: 1.683 Vali Loss: 2.280 Vali Acc: 0.347 Test Loss: 2.280 Test Acc: 0.347
Validation loss decreased (-0.345881 --> -0.347098).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9303980
	speed: 0.1374s/iter; left time: 1890.1396s
Epoch: 11 cost time: 5.2594780921936035
Epoch: 11, Steps: 154 | Train Loss: 1.645 Vali Loss: 2.445 Vali Acc: 0.348 Test Loss: 2.445 Test Acc: 0.348
Validation loss decreased (-0.347098 --> -0.348313).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4840429
	speed: 0.1583s/iter; left time: 2153.5865s
Epoch: 12 cost time: 5.453058242797852
Epoch: 12, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.368 Vali Acc: 0.350 Test Loss: 2.368 Test Acc: 0.350
Validation loss decreased (-0.348313 --> -0.349530).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2428776
	speed: 0.1643s/iter; left time: 2209.9819s
Epoch: 13 cost time: 5.979698181152344
Epoch: 13, Steps: 154 | Train Loss: 1.592 Vali Loss: 2.440 Vali Acc: 0.356 Test Loss: 2.440 Test Acc: 0.356
Validation loss decreased (-0.349530 --> -0.355612).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5358373
	speed: 0.1746s/iter; left time: 2322.0886s
Epoch: 14 cost time: 6.272504568099976
Epoch: 14, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.505 Vali Acc: 0.361 Test Loss: 2.505 Test Acc: 0.361
Validation loss decreased (-0.355612 --> -0.361289).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.5628951
	speed: 0.1767s/iter; left time: 2322.0801s
Epoch: 15 cost time: 6.2340052127838135
Epoch: 15, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.566 Vali Acc: 0.349 Test Loss: 2.566 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.3111976
	speed: 0.1849s/iter; left time: 2402.3270s
Epoch: 16 cost time: 5.9687745571136475
Epoch: 16, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.759 Vali Acc: 0.359 Test Loss: 2.759 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.9935050
	speed: 0.1597s/iter; left time: 2050.5360s
Epoch: 17 cost time: 5.799821615219116
Epoch: 17, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.618 Vali Acc: 0.353 Test Loss: 2.618 Test Acc: 0.353
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.4283001
	speed: 0.1644s/iter; left time: 2084.9598s
Epoch: 18 cost time: 5.807784795761108
Epoch: 18, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.815 Vali Acc: 0.353 Test Loss: 2.815 Test Acc: 0.353
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.1441638
	speed: 0.1618s/iter; left time: 2027.5648s
Epoch: 19 cost time: 5.8410398960113525
Epoch: 19, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.572 Vali Acc: 0.362 Test Loss: 2.572 Test Acc: 0.362
Validation loss decreased (-0.361289 --> -0.362099).  Saving model ...
	iters: 100, epoch: 20 | loss: 3.9040246
	speed: 0.1611s/iter; left time: 1993.8281s
Epoch: 20 cost time: 5.972462177276611
Epoch: 20, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.611 Vali Acc: 0.359 Test Loss: 2.611 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.3782620
	speed: 0.1587s/iter; left time: 1938.8943s
Epoch: 21 cost time: 5.950734376907349
Epoch: 21, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.803 Vali Acc: 0.370 Test Loss: 2.803 Test Acc: 0.370
Validation loss decreased (-0.362099 --> -0.369802).  Saving model ...
	iters: 100, epoch: 22 | loss: 2.1874249
	speed: 0.1673s/iter; left time: 2018.8342s
Epoch: 22 cost time: 6.1658713817596436
Epoch: 22, Steps: 154 | Train Loss: 1.704 Vali Loss: 2.735 Vali Acc: 0.364 Test Loss: 2.735 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.1239139
	speed: 0.1840s/iter; left time: 2191.6246s
Epoch: 23 cost time: 6.297058820724487
Epoch: 23, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.904 Vali Acc: 0.366 Test Loss: 2.904 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.4431372
	speed: 0.1758s/iter; left time: 2066.8996s
Epoch: 24 cost time: 6.387667894363403
Epoch: 24, Steps: 154 | Train Loss: 1.354 Vali Loss: 3.047 Vali Acc: 0.369 Test Loss: 3.047 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.9475347
	speed: 0.1789s/iter; left time: 2075.8930s
Epoch: 25 cost time: 6.249470233917236
Epoch: 25, Steps: 154 | Train Loss: 1.439 Vali Loss: 3.188 Vali Acc: 0.213 Test Loss: 3.188 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.5222856
	speed: 0.1641s/iter; left time: 1879.1183s
Epoch: 26 cost time: 5.79689884185791
Epoch: 26, Steps: 154 | Train Loss: 1.518 Vali Loss: 3.092 Vali Acc: 0.367 Test Loss: 3.092 Test Acc: 0.367
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.7949104
	speed: 0.1637s/iter; left time: 1849.0124s
Epoch: 27 cost time: 6.1409077644348145
Epoch: 27, Steps: 154 | Train Loss: 1.309 Vali Loss: 3.250 Vali Acc: 0.369 Test Loss: 3.250 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.3329462
	speed: 0.1628s/iter; left time: 1814.2387s
Epoch: 28 cost time: 5.745075225830078
Epoch: 28, Steps: 154 | Train Loss: 1.304 Vali Loss: 3.506 Vali Acc: 0.353 Test Loss: 3.506 Test Acc: 0.353
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.9177262
	speed: 0.1673s/iter; left time: 1838.7950s
Epoch: 29 cost time: 5.876693964004517
Epoch: 29, Steps: 154 | Train Loss: 1.324 Vali Loss: 3.130 Vali Acc: 0.377 Test Loss: 3.130 Test Acc: 0.377
Validation loss decreased (-0.369802 --> -0.376692).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.1089623
	speed: 0.1660s/iter; left time: 1799.0631s
Epoch: 30 cost time: 5.828721761703491
Epoch: 30, Steps: 154 | Train Loss: 1.291 Vali Loss: 3.543 Vali Acc: 0.371 Test Loss: 3.543 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.7386503
	speed: 0.1806s/iter; left time: 1929.4022s
Epoch: 31 cost time: 6.580772161483765
Epoch: 31, Steps: 154 | Train Loss: 1.440 Vali Loss: 3.417 Vali Acc: 0.373 Test Loss: 3.417 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.3425333
	speed: 0.1819s/iter; left time: 1914.7865s
Epoch: 32 cost time: 5.883242845535278
Epoch: 32, Steps: 154 | Train Loss: 1.261 Vali Loss: 3.604 Vali Acc: 0.373 Test Loss: 3.604 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 2.5380661
	speed: 0.1772s/iter; left time: 1837.8187s
Epoch: 33 cost time: 6.026876211166382
Epoch: 33, Steps: 154 | Train Loss: 1.187 Vali Loss: 3.864 Vali Acc: 0.383 Test Loss: 3.864 Test Acc: 0.383
Validation loss decreased (-0.376692 --> -0.382768).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.2652045
	speed: 0.1771s/iter; left time: 1809.6174s
Epoch: 34 cost time: 6.500023603439331
Epoch: 34, Steps: 154 | Train Loss: 1.085 Vali Loss: 3.788 Vali Acc: 0.375 Test Loss: 3.788 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.8569593
	speed: 0.1912s/iter; left time: 1924.1471s
Epoch: 35 cost time: 6.424572944641113
Epoch: 35, Steps: 154 | Train Loss: 1.348 Vali Loss: 3.870 Vali Acc: 0.371 Test Loss: 3.870 Test Acc: 0.371
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.9912155
	speed: 0.1325s/iter; left time: 1312.9350s
Epoch: 36 cost time: 4.58576774597168
Epoch: 36, Steps: 154 | Train Loss: 1.209 Vali Loss: 3.643 Vali Acc: 0.375 Test Loss: 3.643 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 1.0987624
	speed: 0.1498s/iter; left time: 1461.3412s
Epoch: 37 cost time: 5.843526840209961
Epoch: 37, Steps: 154 | Train Loss: 1.344 Vali Loss: 3.368 Vali Acc: 0.384 Test Loss: 3.368 Test Acc: 0.384
Validation loss decreased (-0.382768 --> -0.383584).  Saving model ...
	iters: 100, epoch: 38 | loss: 1.1613735
	speed: 0.1646s/iter; left time: 1581.0035s
Epoch: 38 cost time: 6.000169277191162
Epoch: 38, Steps: 154 | Train Loss: 1.210 Vali Loss: 3.994 Vali Acc: 0.377 Test Loss: 3.994 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.9608290
	speed: 0.1610s/iter; left time: 1520.9275s
Epoch: 39 cost time: 5.779824733734131
Epoch: 39, Steps: 154 | Train Loss: 1.260 Vali Loss: 3.852 Vali Acc: 0.374 Test Loss: 3.852 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 1.1141554
	speed: 0.1608s/iter; left time: 1495.0719s
Epoch: 40 cost time: 5.831930875778198
Epoch: 40, Steps: 154 | Train Loss: 1.264 Vali Loss: 3.534 Vali Acc: 0.385 Test Loss: 3.534 Test Acc: 0.385
Validation loss decreased (-0.383584 --> -0.385204).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.5433540
	speed: 0.1586s/iter; left time: 1450.2020s
Epoch: 41 cost time: 5.508768796920776
Epoch: 41, Steps: 154 | Train Loss: 1.046 Vali Loss: 3.806 Vali Acc: 0.240 Test Loss: 3.806 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.5846845
	speed: 0.1331s/iter; left time: 1196.1044s
Epoch: 42 cost time: 5.499552011489868
Epoch: 42, Steps: 154 | Train Loss: 1.040 Vali Loss: 4.038 Vali Acc: 0.220 Test Loss: 4.038 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.9620433
	speed: 0.1898s/iter; left time: 1676.1077s
Epoch: 43 cost time: 6.16945481300354
Epoch: 43, Steps: 154 | Train Loss: 1.233 Vali Loss: 3.935 Vali Acc: 0.233 Test Loss: 3.935 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 1.4622899
	speed: 0.1837s/iter; left time: 1593.9610s
Epoch: 44 cost time: 6.363029718399048
Epoch: 44, Steps: 154 | Train Loss: 1.145 Vali Loss: 4.055 Vali Acc: 0.275 Test Loss: 4.055 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.6984478
	speed: 0.1826s/iter; left time: 1556.5849s
Epoch: 45 cost time: 6.489325284957886
Epoch: 45, Steps: 154 | Train Loss: 1.475 Vali Loss: 4.288 Vali Acc: 0.163 Test Loss: 4.288 Test Acc: 0.163
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.6012037
	speed: 0.1643s/iter; left time: 1375.2626s
Epoch: 46 cost time: 5.752972841262817
Epoch: 46, Steps: 154 | Train Loss: 1.157 Vali Loss: 4.189 Vali Acc: 0.273 Test Loss: 4.189 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.7824866
	speed: 0.1593s/iter; left time: 1308.6519s
Epoch: 47 cost time: 5.666790246963501
Epoch: 47, Steps: 154 | Train Loss: 0.974 Vali Loss: 4.417 Vali Acc: 0.120 Test Loss: 4.417 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 13.3780031
	speed: 0.1628s/iter; left time: 1312.7446s
Epoch: 48 cost time: 5.814703941345215
Epoch: 48, Steps: 154 | Train Loss: 1.133 Vali Loss: 4.331 Vali Acc: 0.376 Test Loss: 4.331 Test Acc: 0.376
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.7351162
	speed: 0.1647s/iter; left time: 1302.6943s
Epoch: 49 cost time: 6.012368440628052
Epoch: 49, Steps: 154 | Train Loss: 1.272 Vali Loss: 4.067 Vali Acc: 0.212 Test Loss: 4.067 Test Acc: 0.212
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 0.9160229
	speed: 0.1633s/iter; left time: 1266.0174s
Epoch: 50 cost time: 5.864951133728027
Epoch: 50, Steps: 154 | Train Loss: 0.995 Vali Loss: 3.999 Vali Acc: 0.302 Test Loss: 3.999 Test Acc: 0.302
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38523925385239255
model parameter : 626998
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1692350
	speed: 0.0615s/iter; left time: 940.5090s
Epoch: 1 cost time: 8.276888847351074
Epoch: 1, Steps: 154 | Train Loss: 2.222 Vali Loss: 2.155 Vali Acc: 0.318 Test Loss: 2.155 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0069323
	speed: 0.1810s/iter; left time: 2742.2200s
Epoch: 2 cost time: 6.972221612930298
Epoch: 2, Steps: 154 | Train Loss: 2.082 Vali Loss: 2.153 Vali Acc: 0.321 Test Loss: 2.153 Test Acc: 0.321
Validation loss decreased (-0.318308 --> -0.321146).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3536987
	speed: 0.1851s/iter; left time: 2775.6928s
Epoch: 3 cost time: 6.185036659240723
Epoch: 3, Steps: 154 | Train Loss: 1.972 Vali Loss: 2.166 Vali Acc: 0.323 Test Loss: 2.166 Test Acc: 0.323
Validation loss decreased (-0.321146 --> -0.323174).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6290548
	speed: 0.1629s/iter; left time: 2416.7443s
Epoch: 4 cost time: 6.25098443031311
Epoch: 4, Steps: 154 | Train Loss: 1.944 Vali Loss: 2.179 Vali Acc: 0.324 Test Loss: 2.179 Test Acc: 0.324
Validation loss decreased (-0.323174 --> -0.324390).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9074885
	speed: 0.1705s/iter; left time: 2503.5604s
Epoch: 5 cost time: 6.497029066085815
Epoch: 5, Steps: 154 | Train Loss: 1.882 Vali Loss: 2.211 Vali Acc: 0.332 Test Loss: 2.211 Test Acc: 0.332
Validation loss decreased (-0.324390 --> -0.332095).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9286847
	speed: 0.1687s/iter; left time: 2451.1025s
Epoch: 6 cost time: 6.395935773849487
Epoch: 6, Steps: 154 | Train Loss: 1.860 Vali Loss: 2.205 Vali Acc: 0.328 Test Loss: 2.205 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4893788
	speed: 0.1715s/iter; left time: 2465.3894s
Epoch: 7 cost time: 6.377072811126709
Epoch: 7, Steps: 154 | Train Loss: 1.833 Vali Loss: 2.218 Vali Acc: 0.328 Test Loss: 2.218 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.3800529
	speed: 0.1647s/iter; left time: 2342.6234s
Epoch: 8 cost time: 6.013712406158447
Epoch: 8, Steps: 154 | Train Loss: 1.785 Vali Loss: 2.260 Vali Acc: 0.332 Test Loss: 2.260 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5743499
	speed: 0.1874s/iter; left time: 2636.6571s
Epoch: 9 cost time: 6.858946323394775
Epoch: 9, Steps: 154 | Train Loss: 1.708 Vali Loss: 2.209 Vali Acc: 0.338 Test Loss: 2.209 Test Acc: 0.338
Validation loss decreased (-0.332095 --> -0.338177).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4497375
	speed: 0.1813s/iter; left time: 2523.1070s
Epoch: 10 cost time: 6.673910617828369
Epoch: 10, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.231 Vali Acc: 0.345 Test Loss: 2.231 Test Acc: 0.345
Validation loss decreased (-0.338177 --> -0.344665).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4825827
	speed: 0.1821s/iter; left time: 2506.2254s
Epoch: 11 cost time: 6.235131502151489
Epoch: 11, Steps: 154 | Train Loss: 1.653 Vali Loss: 2.468 Vali Acc: 0.343 Test Loss: 2.468 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3129002
	speed: 0.1719s/iter; left time: 2339.1342s
Epoch: 12 cost time: 6.294190883636475
Epoch: 12, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.435 Vali Acc: 0.350 Test Loss: 2.435 Test Acc: 0.350
Validation loss decreased (-0.344665 --> -0.349935).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3604866
	speed: 0.1736s/iter; left time: 2335.2891s
Epoch: 13 cost time: 6.7729902267456055
Epoch: 13, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.476 Vali Acc: 0.358 Test Loss: 2.476 Test Acc: 0.358
Validation loss decreased (-0.349935 --> -0.358451).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5400597
	speed: 0.1673s/iter; left time: 2224.6494s
Epoch: 14 cost time: 6.582853555679321
Epoch: 14, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.554 Vali Acc: 0.354 Test Loss: 2.554 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9983742
	speed: 0.1685s/iter; left time: 2215.0065s
Epoch: 15 cost time: 6.45337700843811
Epoch: 15, Steps: 154 | Train Loss: 1.738 Vali Loss: 2.506 Vali Acc: 0.188 Test Loss: 2.506 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0180091
	speed: 0.1551s/iter; left time: 2015.3406s
Epoch: 16 cost time: 5.396608829498291
Epoch: 16, Steps: 154 | Train Loss: 1.668 Vali Loss: 2.624 Vali Acc: 0.348 Test Loss: 2.624 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.4005007
	speed: 0.1578s/iter; left time: 2025.7218s
Epoch: 17 cost time: 7.2704057693481445
Epoch: 17, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.670 Vali Acc: 0.353 Test Loss: 2.670 Test Acc: 0.353
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.7641973
	speed: 0.1912s/iter; left time: 2424.9829s
Epoch: 18 cost time: 6.57176399230957
Epoch: 18, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.626 Vali Acc: 0.357 Test Loss: 2.626 Test Acc: 0.357
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.8852109
	speed: 0.1825s/iter; left time: 2287.0197s
Epoch: 19 cost time: 6.5645835399627686
Epoch: 19, Steps: 154 | Train Loss: 1.458 Vali Loss: 2.699 Vali Acc: 0.361 Test Loss: 2.699 Test Acc: 0.361
Validation loss decreased (-0.358451 --> -0.361287).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.7209064
	speed: 0.1903s/iter; left time: 2354.9291s
Epoch: 20 cost time: 6.20189905166626
Epoch: 20, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.695 Vali Acc: 0.199 Test Loss: 2.695 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.6914033
	speed: 0.1643s/iter; left time: 2007.7228s
Epoch: 21 cost time: 6.16031551361084
Epoch: 21, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.509 Vali Acc: 0.371 Test Loss: 2.509 Test Acc: 0.371
Validation loss decreased (-0.361287 --> -0.370616).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.4406867
	speed: 0.1613s/iter; left time: 1946.1071s
Epoch: 22 cost time: 6.5714380741119385
Epoch: 22, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.811 Vali Acc: 0.369 Test Loss: 2.811 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.5648965
	speed: 0.1656s/iter; left time: 1972.7107s
Epoch: 23 cost time: 5.960992813110352
Epoch: 23, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.834 Vali Acc: 0.362 Test Loss: 2.834 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 2.3194726
	speed: 0.1620s/iter; left time: 1904.4317s
Epoch: 24 cost time: 6.166081666946411
Epoch: 24, Steps: 154 | Train Loss: 1.353 Vali Loss: 2.745 Vali Acc: 0.337 Test Loss: 2.745 Test Acc: 0.337
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.7236488
	speed: 0.1697s/iter; left time: 1969.1386s
Epoch: 25 cost time: 6.276395797729492
Epoch: 25, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.928 Vali Acc: 0.214 Test Loss: 2.928 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.3071463
	speed: 0.1901s/iter; left time: 2176.6093s
Epoch: 26 cost time: 6.7487664222717285
Epoch: 26, Steps: 154 | Train Loss: 1.337 Vali Loss: 2.873 Vali Acc: 0.378 Test Loss: 2.873 Test Acc: 0.378
Validation loss decreased (-0.370616 --> -0.377506).  Saving model ...
	iters: 100, epoch: 27 | loss: 3.2315795
	speed: 0.1889s/iter; left time: 2134.1236s
Epoch: 27 cost time: 6.597050666809082
Epoch: 27, Steps: 154 | Train Loss: 1.326 Vali Loss: 3.197 Vali Acc: 0.318 Test Loss: 3.197 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.5755095
	speed: 0.1858s/iter; left time: 2070.8791s
Epoch: 28 cost time: 6.520294904708862
Epoch: 28, Steps: 154 | Train Loss: 1.281 Vali Loss: 3.346 Vali Acc: 0.210 Test Loss: 3.346 Test Acc: 0.210
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 2.3711448
	speed: 0.1714s/iter; left time: 1883.7747s
Epoch: 29 cost time: 6.439524173736572
Epoch: 29, Steps: 154 | Train Loss: 1.418 Vali Loss: 3.468 Vali Acc: 0.371 Test Loss: 3.468 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.7448158
	speed: 0.1689s/iter; left time: 1829.4921s
Epoch: 30 cost time: 6.525862693786621
Epoch: 30, Steps: 154 | Train Loss: 1.244 Vali Loss: 3.340 Vali Acc: 0.294 Test Loss: 3.340 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 1.3578463
	speed: 0.1679s/iter; left time: 1793.1269s
Epoch: 31 cost time: 6.51179313659668
Epoch: 31, Steps: 154 | Train Loss: 1.567 Vali Loss: 3.725 Vali Acc: 0.367 Test Loss: 3.725 Test Acc: 0.367
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 1.4732881
	speed: 0.1666s/iter; left time: 1754.1815s
Epoch: 32 cost time: 6.4303343296051025
Epoch: 32, Steps: 154 | Train Loss: 1.196 Vali Loss: 3.824 Vali Acc: 0.189 Test Loss: 3.824 Test Acc: 0.189
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 1.6647716
	speed: 0.1670s/iter; left time: 1732.3230s
Epoch: 33 cost time: 6.1109654903411865
Epoch: 33, Steps: 154 | Train Loss: 1.283 Vali Loss: 3.921 Vali Acc: 0.120 Test Loss: 3.921 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.7743509
	speed: 0.1618s/iter; left time: 1653.4374s
Epoch: 34 cost time: 5.856677293777466
Epoch: 34, Steps: 154 | Train Loss: 1.381 Vali Loss: 3.132 Vali Acc: 0.291 Test Loss: 3.132 Test Acc: 0.291
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 1.1374140
	speed: 0.1848s/iter; left time: 1860.1570s
Epoch: 35 cost time: 7.049642562866211
Epoch: 35, Steps: 154 | Train Loss: 1.377 Vali Loss: 3.964 Vali Acc: 0.388 Test Loss: 3.964 Test Acc: 0.388
Validation loss decreased (-0.377506 --> -0.388038).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.9403626
	speed: 0.1788s/iter; left time: 1771.8223s
Epoch: 36 cost time: 6.343367576599121
Epoch: 36, Steps: 154 | Train Loss: 1.352 Vali Loss: 3.801 Vali Acc: 0.132 Test Loss: 3.801 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 1.3742850
	speed: 0.1858s/iter; left time: 1812.7129s
Epoch: 37 cost time: 6.569085121154785
Epoch: 37, Steps: 154 | Train Loss: 1.233 Vali Loss: 3.796 Vali Acc: 0.219 Test Loss: 3.796 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 1.1896373
	speed: 0.1701s/iter; left time: 1633.0403s
Epoch: 38 cost time: 5.9208033084869385
Epoch: 38, Steps: 154 | Train Loss: 1.124 Vali Loss: 3.732 Vali Acc: 0.094 Test Loss: 3.732 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 1.1479540
	speed: 0.1700s/iter; left time: 1606.0024s
Epoch: 39 cost time: 6.605769395828247
Epoch: 39, Steps: 154 | Train Loss: 1.138 Vali Loss: 3.573 Vali Acc: 0.116 Test Loss: 3.573 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 1.6663965
	speed: 0.1650s/iter; left time: 1533.4123s
Epoch: 40 cost time: 6.135464668273926
Epoch: 40, Steps: 154 | Train Loss: 1.272 Vali Loss: 3.309 Vali Acc: 0.259 Test Loss: 3.309 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.8274305
	speed: 0.1671s/iter; left time: 1527.8612s
Epoch: 41 cost time: 5.914107799530029
Epoch: 41, Steps: 154 | Train Loss: 1.194 Vali Loss: 3.814 Vali Acc: 0.094 Test Loss: 3.814 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 1.2613955
	speed: 0.1630s/iter; left time: 1464.9844s
Epoch: 42 cost time: 6.237077713012695
Epoch: 42, Steps: 154 | Train Loss: 1.223 Vali Loss: 3.589 Vali Acc: 0.376 Test Loss: 3.589 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 1.0939595
	speed: 0.1838s/iter; left time: 1623.1279s
Epoch: 43 cost time: 6.907907962799072
Epoch: 43, Steps: 154 | Train Loss: 1.204 Vali Loss: 4.215 Vali Acc: 0.207 Test Loss: 4.215 Test Acc: 0.207
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 1.4517286
	speed: 0.1801s/iter; left time: 1563.3935s
Epoch: 44 cost time: 6.503008127212524
Epoch: 44, Steps: 154 | Train Loss: 1.215 Vali Loss: 4.563 Vali Acc: 0.205 Test Loss: 4.563 Test Acc: 0.205
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 1.2272370
	speed: 0.1921s/iter; left time: 1637.6507s
Epoch: 45 cost time: 6.596857309341431
Epoch: 45, Steps: 154 | Train Loss: 1.355 Vali Loss: 4.201 Vali Acc: 0.185 Test Loss: 4.201 Test Acc: 0.185
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3880778588807786
model parameter : 364854
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1645839
	speed: 0.0623s/iter; left time: 953.9641s
Epoch: 1 cost time: 8.5471351146698
Epoch: 1, Steps: 154 | Train Loss: 2.213 Vali Loss: 2.154 Vali Acc: 0.318 Test Loss: 2.154 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0072112
	speed: 0.1689s/iter; left time: 2559.0223s
Epoch: 2 cost time: 6.433002233505249
Epoch: 2, Steps: 154 | Train Loss: 2.076 Vali Loss: 2.151 Vali Acc: 0.321 Test Loss: 2.151 Test Acc: 0.321
Validation loss decreased (-0.317497 --> -0.321146).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3306551
	speed: 0.1604s/iter; left time: 2404.7355s
Epoch: 3 cost time: 6.014724254608154
Epoch: 3, Steps: 154 | Train Loss: 1.961 Vali Loss: 2.170 Vali Acc: 0.323 Test Loss: 2.170 Test Acc: 0.323
Validation loss decreased (-0.321146 --> -0.322768).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6422092
	speed: 0.1671s/iter; left time: 2478.8692s
Epoch: 4 cost time: 6.401490688323975
Epoch: 4, Steps: 154 | Train Loss: 1.940 Vali Loss: 2.180 Vali Acc: 0.324 Test Loss: 2.180 Test Acc: 0.324
Validation loss decreased (-0.322768 --> -0.323985).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8980455
	speed: 0.1676s/iter; left time: 2461.0479s
Epoch: 5 cost time: 6.449559688568115
Epoch: 5, Steps: 154 | Train Loss: 1.880 Vali Loss: 2.178 Vali Acc: 0.335 Test Loss: 2.178 Test Acc: 0.335
Validation loss decreased (-0.323985 --> -0.335339).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9632117
	speed: 0.1911s/iter; left time: 2777.4563s
Epoch: 6 cost time: 7.102112054824829
Epoch: 6, Steps: 154 | Train Loss: 1.856 Vali Loss: 2.186 Vali Acc: 0.328 Test Loss: 2.186 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4377000
	speed: 0.1826s/iter; left time: 2625.1124s
Epoch: 7 cost time: 6.522194862365723
Epoch: 7, Steps: 154 | Train Loss: 1.786 Vali Loss: 2.221 Vali Acc: 0.327 Test Loss: 2.221 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.3197646
	speed: 0.1621s/iter; left time: 2305.4130s
Epoch: 8 cost time: 5.527139902114868
Epoch: 8, Steps: 154 | Train Loss: 1.754 Vali Loss: 2.260 Vali Acc: 0.341 Test Loss: 2.260 Test Acc: 0.341
Validation loss decreased (-0.335339 --> -0.340610).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5842730
	speed: 0.1554s/iter; left time: 2185.9435s
Epoch: 9 cost time: 6.118283033370972
Epoch: 9, Steps: 154 | Train Loss: 1.770 Vali Loss: 2.245 Vali Acc: 0.342 Test Loss: 2.245 Test Acc: 0.342
Validation loss decreased (-0.340610 --> -0.342232).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9588860
	speed: 0.1595s/iter; left time: 2219.1865s
Epoch: 10 cost time: 6.293298244476318
Epoch: 10, Steps: 154 | Train Loss: 1.694 Vali Loss: 2.236 Vali Acc: 0.346 Test Loss: 2.236 Test Acc: 0.346
Validation loss decreased (-0.342232 --> -0.346287).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4971077
	speed: 0.1718s/iter; left time: 2364.3306s
Epoch: 11 cost time: 6.474403142929077
Epoch: 11, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.437 Vali Acc: 0.343 Test Loss: 2.437 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2811924
	speed: 0.1689s/iter; left time: 2298.3021s
Epoch: 12 cost time: 6.3750975131988525
Epoch: 12, Steps: 154 | Train Loss: 1.669 Vali Loss: 2.413 Vali Acc: 0.348 Test Loss: 2.413 Test Acc: 0.348
Validation loss decreased (-0.346287 --> -0.348313).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2633908
	speed: 0.1673s/iter; left time: 2251.2663s
Epoch: 13 cost time: 6.192953109741211
Epoch: 13, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.457 Vali Acc: 0.347 Test Loss: 2.457 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5974569
	speed: 0.1799s/iter; left time: 2392.4718s
Epoch: 14 cost time: 6.772231101989746
Epoch: 14, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.579 Vali Acc: 0.352 Test Loss: 2.579 Test Acc: 0.352
Validation loss decreased (-0.348313 --> -0.351961).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.3783805
	speed: 0.1786s/iter; left time: 2347.6431s
Epoch: 15 cost time: 6.69336724281311
Epoch: 15, Steps: 154 | Train Loss: 1.712 Vali Loss: 2.576 Vali Acc: 0.200 Test Loss: 2.576 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0738186
	speed: 0.1785s/iter; left time: 2318.8287s
Epoch: 16 cost time: 6.610946416854858
Epoch: 16, Steps: 154 | Train Loss: 1.668 Vali Loss: 2.674 Vali Acc: 0.374 Test Loss: 2.674 Test Acc: 0.374
Validation loss decreased (-0.351961 --> -0.373858).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.3053437
	speed: 0.1763s/iter; left time: 2262.7686s
Epoch: 17 cost time: 5.993832349777222
Epoch: 17, Steps: 154 | Train Loss: 1.578 Vali Loss: 2.542 Vali Acc: 0.363 Test Loss: 2.542 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.7529428
	speed: 0.1651s/iter; left time: 2093.5360s
Epoch: 18 cost time: 6.010797023773193
Epoch: 18, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.520 Vali Acc: 0.358 Test Loss: 2.520 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.8518998
	speed: 0.1700s/iter; left time: 2130.4325s
Epoch: 19 cost time: 6.512315034866333
Epoch: 19, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.679 Vali Acc: 0.356 Test Loss: 2.679 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.7232022
	speed: 0.1594s/iter; left time: 1972.3736s
Epoch: 20 cost time: 5.963575601577759
Epoch: 20, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.787 Vali Acc: 0.197 Test Loss: 2.787 Test Acc: 0.197
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.6992383
	speed: 0.1604s/iter; left time: 1960.6175s
Epoch: 21 cost time: 6.117945909500122
Epoch: 21, Steps: 154 | Train Loss: 1.445 Vali Loss: 2.569 Vali Acc: 0.299 Test Loss: 2.569 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.3488363
	speed: 0.1654s/iter; left time: 1995.3391s
Epoch: 22 cost time: 6.262426376342773
Epoch: 22, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.992 Vali Acc: 0.228 Test Loss: 2.992 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.6449816
	speed: 0.1775s/iter; left time: 2115.0281s
Epoch: 23 cost time: 6.483878135681152
Epoch: 23, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.928 Vali Acc: 0.332 Test Loss: 2.928 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.8515267
	speed: 0.1823s/iter; left time: 2143.6573s
Epoch: 24 cost time: 6.684727907180786
Epoch: 24, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.852 Vali Acc: 0.358 Test Loss: 2.852 Test Acc: 0.358
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.7606633
	speed: 0.1860s/iter; left time: 2158.6422s
Epoch: 25 cost time: 5.75961709022522
Epoch: 25, Steps: 154 | Train Loss: 1.432 Vali Loss: 3.100 Vali Acc: 0.205 Test Loss: 3.100 Test Acc: 0.205
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.2172060
	speed: 0.1644s/iter; left time: 1882.7198s
Epoch: 26 cost time: 6.152931213378906
Epoch: 26, Steps: 154 | Train Loss: 1.303 Vali Loss: 2.813 Vali Acc: 0.376 Test Loss: 2.813 Test Acc: 0.376
Validation loss decreased (-0.373858 --> -0.376290).  Saving model ...
	iters: 100, epoch: 27 | loss: 2.5167961
	speed: 0.1659s/iter; left time: 1874.6585s
Epoch: 27 cost time: 6.405650854110718
Epoch: 27, Steps: 154 | Train Loss: 1.314 Vali Loss: 3.386 Vali Acc: 0.341 Test Loss: 3.386 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.0656519
	speed: 0.1627s/iter; left time: 1813.5190s
Epoch: 28 cost time: 6.577711820602417
Epoch: 28, Steps: 154 | Train Loss: 1.223 Vali Loss: 3.325 Vali Acc: 0.232 Test Loss: 3.325 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.2369636
	speed: 0.1648s/iter; left time: 1810.7121s
Epoch: 29 cost time: 6.5656726360321045
Epoch: 29, Steps: 154 | Train Loss: 1.321 Vali Loss: 3.764 Vali Acc: 0.291 Test Loss: 3.764 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.5800741
	speed: 0.1677s/iter; left time: 1816.9376s
Epoch: 30 cost time: 6.294137239456177
Epoch: 30, Steps: 154 | Train Loss: 1.371 Vali Loss: 3.529 Vali Acc: 0.374 Test Loss: 3.529 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 1.4819326
	speed: 0.1798s/iter; left time: 1920.4260s
Epoch: 31 cost time: 6.781038761138916
Epoch: 31, Steps: 154 | Train Loss: 1.311 Vali Loss: 3.915 Vali Acc: 0.377 Test Loss: 3.915 Test Acc: 0.377
Validation loss decreased (-0.376290 --> -0.377090).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.5188559
	speed: 0.1864s/iter; left time: 1961.8258s
Epoch: 32 cost time: 6.356877565383911
Epoch: 32, Steps: 154 | Train Loss: 1.244 Vali Loss: 4.007 Vali Acc: 0.216 Test Loss: 4.007 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 1.7970027
	speed: 0.1850s/iter; left time: 1918.7762s
Epoch: 33 cost time: 6.588826894760132
Epoch: 33, Steps: 154 | Train Loss: 1.161 Vali Loss: 4.283 Vali Acc: 0.100 Test Loss: 4.283 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 1.0517108
	speed: 0.1715s/iter; left time: 1752.1036s
Epoch: 34 cost time: 6.301703691482544
Epoch: 34, Steps: 154 | Train Loss: 1.372 Vali Loss: 3.802 Vali Acc: 0.344 Test Loss: 3.802 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 1.0567368
	speed: 0.1664s/iter; left time: 1674.8073s
Epoch: 35 cost time: 6.0912253856658936
Epoch: 35, Steps: 154 | Train Loss: 1.371 Vali Loss: 4.461 Vali Acc: 0.387 Test Loss: 4.461 Test Acc: 0.387
Validation loss decreased (-0.377090 --> -0.386817).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.7248737
	speed: 0.1571s/iter; left time: 1557.2727s
Epoch: 36 cost time: 5.791995286941528
Epoch: 36, Steps: 154 | Train Loss: 1.324 Vali Loss: 4.502 Vali Acc: 0.249 Test Loss: 4.502 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 1.0875976
	speed: 0.1524s/iter; left time: 1486.7105s
Epoch: 37 cost time: 5.502520799636841
Epoch: 37, Steps: 154 | Train Loss: 1.195 Vali Loss: 3.990 Vali Acc: 0.230 Test Loss: 3.990 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.9993963
	speed: 0.1592s/iter; left time: 1529.2558s
Epoch: 38 cost time: 6.8531334400177
Epoch: 38, Steps: 154 | Train Loss: 1.194 Vali Loss: 3.947 Vali Acc: 0.089 Test Loss: 3.947 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 1.3838679
	speed: 0.1755s/iter; left time: 1658.2735s
Epoch: 39 cost time: 6.411328554153442
Epoch: 39, Steps: 154 | Train Loss: 1.183 Vali Loss: 3.962 Vali Acc: 0.349 Test Loss: 3.962 Test Acc: 0.349
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 1.1340973
	speed: 0.1866s/iter; left time: 1734.7745s
Epoch: 40 cost time: 6.385707378387451
Epoch: 40, Steps: 154 | Train Loss: 1.192 Vali Loss: 3.611 Vali Acc: 0.119 Test Loss: 3.611 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.7703094
	speed: 0.1808s/iter; left time: 1653.0264s
Epoch: 41 cost time: 6.8805108070373535
Epoch: 41, Steps: 154 | Train Loss: 1.197 Vali Loss: 4.096 Vali Acc: 0.295 Test Loss: 4.096 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 1.1174924
	speed: 0.1718s/iter; left time: 1544.1221s
Epoch: 42 cost time: 5.722782611846924
Epoch: 42, Steps: 154 | Train Loss: 1.113 Vali Loss: 4.331 Vali Acc: 0.387 Test Loss: 4.331 Test Acc: 0.387
Validation loss decreased (-0.386817 --> -0.386818).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.7557122
	speed: 0.1985s/iter; left time: 1753.6357s
Epoch: 43 cost time: 7.6851348876953125
Epoch: 43, Steps: 154 | Train Loss: 1.280 Vali Loss: 4.369 Vali Acc: 0.384 Test Loss: 4.369 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 1.2179072
	speed: 0.1464s/iter; left time: 1270.3913s
Epoch: 44 cost time: 4.701214551925659
Epoch: 44, Steps: 154 | Train Loss: 1.174 Vali Loss: 4.435 Vali Acc: 0.182 Test Loss: 4.435 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 1.0092272
	speed: 0.1503s/iter; left time: 1281.0371s
Epoch: 45 cost time: 6.540852308273315
Epoch: 45, Steps: 154 | Train Loss: 1.072 Vali Loss: 4.403 Vali Acc: 0.181 Test Loss: 4.403 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 46 | loss: 6.4618273
	speed: 0.1680s/iter; left time: 1406.1401s
Epoch: 46 cost time: 6.726490497589111
Epoch: 46, Steps: 154 | Train Loss: 1.217 Vali Loss: 5.103 Vali Acc: 0.114 Test Loss: 5.103 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 47 | loss: 0.9200049
	speed: 0.1605s/iter; left time: 1318.7133s
Epoch: 47 cost time: 6.2366859912872314
Epoch: 47, Steps: 154 | Train Loss: 1.218 Vali Loss: 4.326 Vali Acc: 0.112 Test Loss: 4.326 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 48 | loss: 1.5047922
	speed: 0.1662s/iter; left time: 1340.2354s
Epoch: 48 cost time: 6.2070841789245605
Epoch: 48, Steps: 154 | Train Loss: 1.093 Vali Loss: 3.834 Vali Acc: 0.219 Test Loss: 3.834 Test Acc: 0.219
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 49 | loss: 1.1198375
	speed: 0.1657s/iter; left time: 1310.2018s
Epoch: 49 cost time: 6.331619739532471
Epoch: 49, Steps: 154 | Train Loss: 1.071 Vali Loss: 4.304 Vali Acc: 0.243 Test Loss: 4.304 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 50 | loss: 0.8357958
	speed: 0.1692s/iter; left time: 1312.0281s
Epoch: 50 cost time: 6.791414499282837
Epoch: 50, Steps: 154 | Train Loss: 1.113 Vali Loss: 4.377 Vali Acc: 0.205 Test Loss: 4.377 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 51 | loss: 0.5323613
	speed: 0.1882s/iter; left time: 1430.3067s
Epoch: 51 cost time: 6.381393909454346
Epoch: 51, Steps: 154 | Train Loss: 1.008 Vali Loss: 4.341 Vali Acc: 0.108 Test Loss: 4.341 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 52 | loss: 1.0294871
	speed: 0.1865s/iter; left time: 1388.9004s
Epoch: 52 cost time: 6.633391380310059
Epoch: 52, Steps: 154 | Train Loss: 0.968 Vali Loss: 4.671 Vali Acc: 0.110 Test Loss: 4.671 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38686131386861317
model parameter : 364854
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1801047
	speed: 0.0548s/iter; left time: 837.7697s
Epoch: 1 cost time: 7.565892696380615
Epoch: 1, Steps: 154 | Train Loss: 2.201 Vali Loss: 2.157 Vali Acc: 0.317 Test Loss: 2.157 Test Acc: 0.317
Validation loss decreased (inf --> -0.316686).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0016847
	speed: 0.1589s/iter; left time: 2407.4223s
Epoch: 2 cost time: 5.798587322235107
Epoch: 2, Steps: 154 | Train Loss: 2.069 Vali Loss: 2.149 Vali Acc: 0.320 Test Loss: 2.149 Test Acc: 0.320
Validation loss decreased (-0.316686 --> -0.319930).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4201221
	speed: 0.1590s/iter; left time: 2383.5090s
Epoch: 3 cost time: 6.1422507762908936
Epoch: 3, Steps: 154 | Train Loss: 1.975 Vali Loss: 2.153 Vali Acc: 0.323 Test Loss: 2.153 Test Acc: 0.323
Validation loss decreased (-0.319930 --> -0.322768).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6704129
	speed: 0.1620s/iter; left time: 2403.8299s
Epoch: 4 cost time: 6.124152183532715
Epoch: 4, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.169 Vali Acc: 0.325 Test Loss: 2.169 Test Acc: 0.325
Validation loss decreased (-0.322768 --> -0.324796).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8957204
	speed: 0.1636s/iter; left time: 2402.3653s
Epoch: 5 cost time: 5.984342336654663
Epoch: 5, Steps: 154 | Train Loss: 1.889 Vali Loss: 2.162 Vali Acc: 0.331 Test Loss: 2.162 Test Acc: 0.331
Validation loss decreased (-0.324796 --> -0.331284).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1336207
	speed: 0.1657s/iter; left time: 2408.4468s
Epoch: 6 cost time: 6.4330666065216064
Epoch: 6, Steps: 154 | Train Loss: 1.835 Vali Loss: 2.168 Vali Acc: 0.333 Test Loss: 2.168 Test Acc: 0.333
Validation loss decreased (-0.331284 --> -0.332501).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4150016
	speed: 0.1774s/iter; left time: 2550.4651s
Epoch: 7 cost time: 7.030484199523926
Epoch: 7, Steps: 154 | Train Loss: 1.805 Vali Loss: 2.235 Vali Acc: 0.331 Test Loss: 2.235 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3518648
	speed: 0.1776s/iter; left time: 2525.8500s
Epoch: 8 cost time: 6.321028709411621
Epoch: 8, Steps: 154 | Train Loss: 1.785 Vali Loss: 2.242 Vali Acc: 0.346 Test Loss: 2.242 Test Acc: 0.346
Validation loss decreased (-0.332501 --> -0.345882).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5645344
	speed: 0.1739s/iter; left time: 2445.9762s
Epoch: 9 cost time: 5.4494469165802
Epoch: 9, Steps: 154 | Train Loss: 1.694 Vali Loss: 2.222 Vali Acc: 0.348 Test Loss: 2.222 Test Acc: 0.348
Validation loss decreased (-0.345882 --> -0.348315).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6319686
	speed: 0.1548s/iter; left time: 2154.4290s
Epoch: 10 cost time: 6.197875261306763
Epoch: 10, Steps: 154 | Train Loss: 1.691 Vali Loss: 2.291 Vali Acc: 0.349 Test Loss: 2.291 Test Acc: 0.349
Validation loss decreased (-0.348315 --> -0.349126).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5530380
	speed: 0.1626s/iter; left time: 2237.1447s
Epoch: 11 cost time: 5.779635667800903
Epoch: 11, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.514 Vali Acc: 0.342 Test Loss: 2.514 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.5998820
	speed: 0.1621s/iter; left time: 2205.3087s
Epoch: 12 cost time: 5.930803537368774
Epoch: 12, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.431 Vali Acc: 0.358 Test Loss: 2.431 Test Acc: 0.358
Validation loss decreased (-0.349126 --> -0.358451).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1550565
	speed: 0.1565s/iter; left time: 2105.6723s
Epoch: 13 cost time: 6.380680561065674
Epoch: 13, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.552 Vali Acc: 0.354 Test Loss: 2.552 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4791000
	speed: 0.1585s/iter; left time: 2108.3831s
Epoch: 14 cost time: 5.76424241065979
Epoch: 14, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.656 Vali Acc: 0.347 Test Loss: 2.656 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.1338874
	speed: 0.1688s/iter; left time: 2219.2688s
Epoch: 15 cost time: 6.2641119956970215
Epoch: 15, Steps: 154 | Train Loss: 1.723 Vali Loss: 2.729 Vali Acc: 0.206 Test Loss: 2.729 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.0622153
	speed: 0.1758s/iter; left time: 2283.9478s
Epoch: 16 cost time: 6.458001375198364
Epoch: 16, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.671 Vali Acc: 0.363 Test Loss: 2.671 Test Acc: 0.363
Validation loss decreased (-0.358451 --> -0.362909).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.4483870
	speed: 0.1850s/iter; left time: 2375.0449s
Epoch: 17 cost time: 6.250941276550293
Epoch: 17, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.858 Vali Acc: 0.358 Test Loss: 2.858 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.7571907
	speed: 0.1734s/iter; left time: 2198.8679s
Epoch: 18 cost time: 5.936628580093384
Epoch: 18, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.976 Vali Acc: 0.351 Test Loss: 2.976 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.8775268
	speed: 0.1642s/iter; left time: 2057.2117s
Epoch: 19 cost time: 6.413991212844849
Epoch: 19, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.843 Vali Acc: 0.356 Test Loss: 2.843 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.6609505
	speed: 0.1576s/iter; left time: 1950.3618s
Epoch: 20 cost time: 6.443025827407837
Epoch: 20, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.977 Vali Acc: 0.201 Test Loss: 2.977 Test Acc: 0.201
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.5072758
	speed: 0.1611s/iter; left time: 1968.8660s
Epoch: 21 cost time: 6.06640362739563
Epoch: 21, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.741 Vali Acc: 0.374 Test Loss: 2.741 Test Acc: 0.374
Validation loss decreased (-0.362909 --> -0.374263).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.5420166
	speed: 0.1639s/iter; left time: 1977.8307s
Epoch: 22 cost time: 6.243046283721924
Epoch: 22, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.981 Vali Acc: 0.365 Test Loss: 2.981 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.5737170
	speed: 0.1609s/iter; left time: 1916.3351s
Epoch: 23 cost time: 6.435237407684326
Epoch: 23, Steps: 154 | Train Loss: 1.417 Vali Loss: 3.012 Vali Acc: 0.365 Test Loss: 3.012 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 2.0242295
	speed: 0.1727s/iter; left time: 2030.5031s
Epoch: 24 cost time: 5.981419324874878
Epoch: 24, Steps: 154 | Train Loss: 1.411 Vali Loss: 3.199 Vali Acc: 0.362 Test Loss: 3.199 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.7365905
	speed: 0.1799s/iter; left time: 2088.1544s
Epoch: 25 cost time: 6.237696409225464
Epoch: 25, Steps: 154 | Train Loss: 1.295 Vali Loss: 3.257 Vali Acc: 0.228 Test Loss: 3.257 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 4.1492672
	speed: 0.1773s/iter; left time: 2030.7087s
Epoch: 26 cost time: 6.673751354217529
Epoch: 26, Steps: 154 | Train Loss: 1.261 Vali Loss: 3.151 Vali Acc: 0.379 Test Loss: 3.151 Test Acc: 0.379
Validation loss decreased (-0.374263 --> -0.379125).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.6237988
	speed: 0.1764s/iter; left time: 1992.2287s
Epoch: 27 cost time: 5.527179718017578
Epoch: 27, Steps: 154 | Train Loss: 1.305 Vali Loss: 3.501 Vali Acc: 0.372 Test Loss: 3.501 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.1706027
	speed: 0.1584s/iter; left time: 1764.6532s
Epoch: 28 cost time: 6.131706953048706
Epoch: 28, Steps: 154 | Train Loss: 1.360 Vali Loss: 3.468 Vali Acc: 0.225 Test Loss: 3.468 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.0725863
	speed: 0.1620s/iter; left time: 1780.5500s
Epoch: 29 cost time: 6.255319356918335
Epoch: 29, Steps: 154 | Train Loss: 1.345 Vali Loss: 3.331 Vali Acc: 0.275 Test Loss: 3.331 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.3585382
	speed: 0.1640s/iter; left time: 1776.8988s
Epoch: 30 cost time: 6.111015796661377
Epoch: 30, Steps: 154 | Train Loss: 1.410 Vali Loss: 3.325 Vali Acc: 0.370 Test Loss: 3.325 Test Acc: 0.370
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 1.4052765
	speed: 0.1642s/iter; left time: 1753.6546s
Epoch: 31 cost time: 6.043307304382324
Epoch: 31, Steps: 154 | Train Loss: 1.160 Vali Loss: 3.712 Vali Acc: 0.372 Test Loss: 3.712 Test Acc: 0.372
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 1.4491609
	speed: 0.1668s/iter; left time: 1756.2723s
Epoch: 32 cost time: 6.051928997039795
Epoch: 32, Steps: 154 | Train Loss: 1.155 Vali Loss: 4.016 Vali Acc: 0.189 Test Loss: 4.016 Test Acc: 0.189
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 2.1574814
	speed: 0.1633s/iter; left time: 1694.0157s
Epoch: 33 cost time: 5.781393766403198
Epoch: 33, Steps: 154 | Train Loss: 1.190 Vali Loss: 4.155 Vali Acc: 0.380 Test Loss: 4.155 Test Acc: 0.380
Validation loss decreased (-0.379125 --> -0.379520).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.6736432
	speed: 0.1750s/iter; left time: 1788.6965s
Epoch: 34 cost time: 6.524860382080078
Epoch: 34, Steps: 154 | Train Loss: 1.145 Vali Loss: 4.112 Vali Acc: 0.226 Test Loss: 4.112 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 1.0676378
	speed: 0.1874s/iter; left time: 1886.6273s
Epoch: 35 cost time: 6.756592035293579
Epoch: 35, Steps: 154 | Train Loss: 1.253 Vali Loss: 3.581 Vali Acc: 0.378 Test Loss: 3.581 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.5762443
	speed: 0.1562s/iter; left time: 1547.6564s
Epoch: 36 cost time: 6.171849250793457
Epoch: 36, Steps: 154 | Train Loss: 1.215 Vali Loss: 4.175 Vali Acc: 0.379 Test Loss: 4.175 Test Acc: 0.379
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 1.0607946
	speed: 0.1632s/iter; left time: 1591.9463s
Epoch: 37 cost time: 6.161222696304321
Epoch: 37, Steps: 154 | Train Loss: 1.289 Vali Loss: 4.085 Vali Acc: 0.235 Test Loss: 4.085 Test Acc: 0.235
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.6731974
	speed: 0.1532s/iter; left time: 1471.2865s
Epoch: 38 cost time: 5.266942739486694
Epoch: 38, Steps: 154 | Train Loss: 1.350 Vali Loss: 4.159 Vali Acc: 0.133 Test Loss: 4.159 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 1.7340209
	speed: 0.1416s/iter; left time: 1337.7796s
Epoch: 39 cost time: 6.505280256271362
Epoch: 39, Steps: 154 | Train Loss: 1.366 Vali Loss: 3.962 Vali Acc: 0.378 Test Loss: 3.962 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 1.1262829
	speed: 0.1593s/iter; left time: 1480.6587s
Epoch: 40 cost time: 5.998099088668823
Epoch: 40, Steps: 154 | Train Loss: 1.342 Vali Loss: 4.052 Vali Acc: 0.228 Test Loss: 4.052 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 0.6218822
	speed: 0.1553s/iter; left time: 1419.5375s
Epoch: 41 cost time: 5.703556060791016
Epoch: 41, Steps: 154 | Train Loss: 1.122 Vali Loss: 4.197 Vali Acc: 0.376 Test Loss: 4.197 Test Acc: 0.376
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 1.0840626
	speed: 0.1783s/iter; left time: 1602.0460s
Epoch: 42 cost time: 6.267174243927002
Epoch: 42, Steps: 154 | Train Loss: 1.058 Vali Loss: 4.129 Vali Acc: 0.373 Test Loss: 4.129 Test Acc: 0.373
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 43 | loss: 0.7029181
	speed: 0.1703s/iter; left time: 1504.1043s
Epoch: 43 cost time: 6.473482370376587
Epoch: 43, Steps: 154 | Train Loss: 1.215 Vali Loss: 4.496 Vali Acc: 0.376 Test Loss: 4.496 Test Acc: 0.376
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3795620437956204
model parameter : 364854
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1485393
	speed: 0.0547s/iter; left time: 836.5558s
Epoch: 1 cost time: 7.2454657554626465
Epoch: 1, Steps: 154 | Train Loss: 2.196 Vali Loss: 2.158 Vali Acc: 0.316 Test Loss: 2.158 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0357628
	speed: 0.1577s/iter; left time: 2388.0235s
Epoch: 2 cost time: 5.615882873535156
Epoch: 2, Steps: 154 | Train Loss: 2.080 Vali Loss: 2.151 Vali Acc: 0.319 Test Loss: 2.151 Test Acc: 0.319
Validation loss decreased (-0.315875 --> -0.319119).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3188279
	speed: 0.1541s/iter; left time: 2310.4256s
Epoch: 3 cost time: 5.706108570098877
Epoch: 3, Steps: 154 | Train Loss: 1.993 Vali Loss: 2.150 Vali Acc: 0.321 Test Loss: 2.150 Test Acc: 0.321
Validation loss decreased (-0.319119 --> -0.320741).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7357941
	speed: 0.1575s/iter; left time: 2337.1105s
Epoch: 4 cost time: 5.471524238586426
Epoch: 4, Steps: 154 | Train Loss: 1.950 Vali Loss: 2.162 Vali Acc: 0.323 Test Loss: 2.162 Test Acc: 0.323
Validation loss decreased (-0.320741 --> -0.322768).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8797535
	speed: 0.1549s/iter; left time: 2274.9100s
Epoch: 5 cost time: 5.653395891189575
Epoch: 5, Steps: 154 | Train Loss: 1.897 Vali Loss: 2.172 Vali Acc: 0.337 Test Loss: 2.172 Test Acc: 0.337
Validation loss decreased (-0.322768 --> -0.337367).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4098032
	speed: 0.1551s/iter; left time: 2253.7001s
Epoch: 6 cost time: 6.084418773651123
Epoch: 6, Steps: 154 | Train Loss: 1.878 Vali Loss: 2.145 Vali Acc: 0.333 Test Loss: 2.145 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3898183
	speed: 0.1729s/iter; left time: 2485.1386s
Epoch: 7 cost time: 5.961055517196655
Epoch: 7, Steps: 154 | Train Loss: 1.800 Vali Loss: 2.198 Vali Acc: 0.336 Test Loss: 2.198 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.2516928
	speed: 0.1720s/iter; left time: 2446.4959s
Epoch: 8 cost time: 6.107202768325806
Epoch: 8, Steps: 154 | Train Loss: 1.754 Vali Loss: 2.297 Vali Acc: 0.347 Test Loss: 2.297 Test Acc: 0.347
Validation loss decreased (-0.337367 --> -0.346692).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5164918
	speed: 0.1777s/iter; left time: 2499.4735s
Epoch: 9 cost time: 5.882884502410889
Epoch: 9, Steps: 154 | Train Loss: 1.697 Vali Loss: 2.255 Vali Acc: 0.345 Test Loss: 2.255 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.4900784
	speed: 0.1630s/iter; left time: 2268.6108s
Epoch: 10 cost time: 5.7430579662323
Epoch: 10, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.269 Vali Acc: 0.350 Test Loss: 2.269 Test Acc: 0.350
Validation loss decreased (-0.346692 --> -0.349531).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5629033
	speed: 0.1502s/iter; left time: 2067.0759s
Epoch: 11 cost time: 5.421777248382568
Epoch: 11, Steps: 154 | Train Loss: 1.675 Vali Loss: 2.496 Vali Acc: 0.344 Test Loss: 2.496 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 3.9483464
	speed: 0.1519s/iter; left time: 2066.4278s
Epoch: 12 cost time: 5.379107713699341
Epoch: 12, Steps: 154 | Train Loss: 1.644 Vali Loss: 2.447 Vali Acc: 0.356 Test Loss: 2.447 Test Acc: 0.356
Validation loss decreased (-0.349531 --> -0.356423).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1998196
	speed: 0.1552s/iter; left time: 2087.8352s
Epoch: 13 cost time: 5.718112230300903
Epoch: 13, Steps: 154 | Train Loss: 1.661 Vali Loss: 2.542 Vali Acc: 0.355 Test Loss: 2.542 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3988273
	speed: 0.1525s/iter; left time: 2027.5642s
Epoch: 14 cost time: 5.809339284896851
Epoch: 14, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.550 Vali Acc: 0.356 Test Loss: 2.550 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.1735337
	speed: 0.1515s/iter; left time: 1991.1052s
Epoch: 15 cost time: 5.41490912437439
Epoch: 15, Steps: 154 | Train Loss: 1.605 Vali Loss: 2.634 Vali Acc: 0.204 Test Loss: 2.634 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.0233154
	speed: 0.1717s/iter; left time: 2230.6867s
Epoch: 16 cost time: 5.899344205856323
Epoch: 16, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.539 Vali Acc: 0.364 Test Loss: 2.539 Test Acc: 0.364
Validation loss decreased (-0.356423 --> -0.364127).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.3441138
	speed: 0.1710s/iter; left time: 2194.5846s
Epoch: 17 cost time: 6.07228684425354
Epoch: 17, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.717 Vali Acc: 0.365 Test Loss: 2.717 Test Acc: 0.365
Validation loss decreased (-0.364127 --> -0.364531).  Saving model ...
	iters: 100, epoch: 18 | loss: 9.9740152
	speed: 0.1740s/iter; left time: 2206.3354s
Epoch: 18 cost time: 5.7413129806518555
Epoch: 18, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.799 Vali Acc: 0.356 Test Loss: 2.799 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.8285326
	speed: 0.1603s/iter; left time: 2008.1839s
Epoch: 19 cost time: 5.490165710449219
Epoch: 19, Steps: 154 | Train Loss: 1.612 Vali Loss: 2.723 Vali Acc: 0.360 Test Loss: 2.723 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.8509074
	speed: 0.1574s/iter; left time: 1947.8580s
Epoch: 20 cost time: 5.780527591705322
Epoch: 20, Steps: 154 | Train Loss: 1.488 Vali Loss: 3.099 Vali Acc: 0.206 Test Loss: 3.099 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.2949195
	speed: 0.1576s/iter; left time: 1925.8642s
Epoch: 21 cost time: 5.9276111125946045
Epoch: 21, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.886 Vali Acc: 0.364 Test Loss: 2.886 Test Acc: 0.364
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.5240748
	speed: 0.1562s/iter; left time: 1885.0474s
Epoch: 22 cost time: 5.813175201416016
Epoch: 22, Steps: 154 | Train Loss: 1.579 Vali Loss: 3.070 Vali Acc: 0.363 Test Loss: 3.070 Test Acc: 0.363
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 4.0628443
	speed: 0.1586s/iter; left time: 1889.6695s
Epoch: 23 cost time: 5.583867073059082
Epoch: 23, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.939 Vali Acc: 0.366 Test Loss: 2.939 Test Acc: 0.366
Validation loss decreased (-0.364531 --> -0.366151).  Saving model ...
	iters: 100, epoch: 24 | loss: 2.0774958
	speed: 0.1586s/iter; left time: 1865.4367s
Epoch: 24 cost time: 5.910606861114502
Epoch: 24, Steps: 154 | Train Loss: 1.514 Vali Loss: 3.251 Vali Acc: 0.365 Test Loss: 3.251 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.5589001
	speed: 0.1707s/iter; left time: 1980.7261s
Epoch: 25 cost time: 6.263028860092163
Epoch: 25, Steps: 154 | Train Loss: 1.441 Vali Loss: 3.014 Vali Acc: 0.287 Test Loss: 3.014 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.3606826
	speed: 0.1750s/iter; left time: 2004.2477s
Epoch: 26 cost time: 5.714649200439453
Epoch: 26, Steps: 154 | Train Loss: 1.363 Vali Loss: 3.248 Vali Acc: 0.369 Test Loss: 3.248 Test Acc: 0.369
Validation loss decreased (-0.366151 --> -0.368986).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.2419367
	speed: 0.1767s/iter; left time: 1995.6279s
Epoch: 27 cost time: 6.099128007888794
Epoch: 27, Steps: 154 | Train Loss: 1.416 Vali Loss: 3.406 Vali Acc: 0.365 Test Loss: 3.406 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.7626846
	speed: 0.1664s/iter; left time: 1854.0674s
Epoch: 28 cost time: 5.680072069168091
Epoch: 28, Steps: 154 | Train Loss: 1.290 Vali Loss: 3.116 Vali Acc: 0.376 Test Loss: 3.116 Test Acc: 0.376
Validation loss decreased (-0.368986 --> -0.375881).  Saving model ...
	iters: 100, epoch: 29 | loss: 5.7444401
	speed: 0.1571s/iter; left time: 1725.8264s
Epoch: 29 cost time: 5.675541162490845
Epoch: 29, Steps: 154 | Train Loss: 1.385 Vali Loss: 3.202 Vali Acc: 0.371 Test Loss: 3.202 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.5117781
	speed: 0.1581s/iter; left time: 1712.8464s
Epoch: 30 cost time: 5.523835897445679
Epoch: 30, Steps: 154 | Train Loss: 1.245 Vali Loss: 3.530 Vali Acc: 0.365 Test Loss: 3.530 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.2924929
	speed: 0.1554s/iter; left time: 1659.6707s
Epoch: 31 cost time: 5.60919976234436
Epoch: 31, Steps: 154 | Train Loss: 1.182 Vali Loss: 3.996 Vali Acc: 0.368 Test Loss: 3.996 Test Acc: 0.368
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 2.3060400
	speed: 0.1578s/iter; left time: 1661.4654s
Epoch: 32 cost time: 5.871315240859985
Epoch: 32, Steps: 154 | Train Loss: 1.438 Vali Loss: 4.060 Vali Acc: 0.288 Test Loss: 4.060 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 1.3649830
	speed: 0.1574s/iter; left time: 1633.1692s
Epoch: 33 cost time: 5.635617733001709
Epoch: 33, Steps: 154 | Train Loss: 1.327 Vali Loss: 3.527 Vali Acc: 0.376 Test Loss: 3.527 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.6678362
	speed: 0.1772s/iter; left time: 1810.9697s
Epoch: 34 cost time: 5.927814483642578
Epoch: 34, Steps: 154 | Train Loss: 1.274 Vali Loss: 3.667 Vali Acc: 0.371 Test Loss: 3.667 Test Acc: 0.371
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.9895626
	speed: 0.1740s/iter; left time: 1751.2590s
Epoch: 35 cost time: 5.993006944656372
Epoch: 35, Steps: 154 | Train Loss: 1.285 Vali Loss: 4.278 Vali Acc: 0.371 Test Loss: 4.278 Test Acc: 0.371
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.7380683
	speed: 0.1762s/iter; left time: 1746.6528s
Epoch: 36 cost time: 6.361379623413086
Epoch: 36, Steps: 154 | Train Loss: 1.230 Vali Loss: 3.910 Vali Acc: 0.378 Test Loss: 3.910 Test Acc: 0.378
Validation loss decreased (-0.375881 --> -0.377495).  Saving model ...
	iters: 100, epoch: 37 | loss: 1.0128129
	speed: 0.1667s/iter; left time: 1626.6092s
Epoch: 37 cost time: 5.710407018661499
Epoch: 37, Steps: 154 | Train Loss: 1.148 Vali Loss: 4.658 Vali Acc: 0.380 Test Loss: 4.658 Test Acc: 0.380
Validation loss decreased (-0.377495 --> -0.380326).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.7162685
	speed: 0.1614s/iter; left time: 1549.5841s
Epoch: 38 cost time: 5.650839328765869
Epoch: 38, Steps: 154 | Train Loss: 1.882 Vali Loss: 4.456 Vali Acc: 0.346 Test Loss: 4.456 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 1.5640442
	speed: 0.1585s/iter; left time: 1497.5075s
Epoch: 39 cost time: 5.823344469070435
Epoch: 39, Steps: 154 | Train Loss: 1.103 Vali Loss: 4.657 Vali Acc: 0.373 Test Loss: 4.657 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 0.8828167
	speed: 0.1541s/iter; left time: 1432.5552s
Epoch: 40 cost time: 5.935019254684448
Epoch: 40, Steps: 154 | Train Loss: 1.267 Vali Loss: 4.259 Vali Acc: 0.380 Test Loss: 4.259 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 0.5868857
	speed: 0.1482s/iter; left time: 1354.6337s
Epoch: 41 cost time: 5.425855398178101
Epoch: 41, Steps: 154 | Train Loss: 1.181 Vali Loss: 4.467 Vali Acc: 0.376 Test Loss: 4.467 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 42 | loss: 1.0249865
	speed: 0.1508s/iter; left time: 1354.9115s
Epoch: 42 cost time: 5.474638223648071
Epoch: 42, Steps: 154 | Train Loss: 1.179 Vali Loss: 4.518 Vali Acc: 0.375 Test Loss: 4.518 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 43 | loss: 1.3348659
	speed: 0.1726s/iter; left time: 1524.4327s
Epoch: 43 cost time: 6.186475038528442
Epoch: 43, Steps: 154 | Train Loss: 1.497 Vali Loss: 4.251 Vali Acc: 0.374 Test Loss: 4.251 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 44 | loss: 1.1279578
	speed: 0.1760s/iter; left time: 1527.7628s
Epoch: 44 cost time: 5.737191677093506
Epoch: 44, Steps: 154 | Train Loss: 1.170 Vali Loss: 4.419 Vali Acc: 0.385 Test Loss: 4.419 Test Acc: 0.385
Validation loss decreased (-0.380326 --> -0.384790).  Saving model ...
	iters: 100, epoch: 45 | loss: 0.9811751
	speed: 0.1745s/iter; left time: 1487.5727s
Epoch: 45 cost time: 5.901865720748901
Epoch: 45, Steps: 154 | Train Loss: 1.188 Vali Loss: 4.504 Vali Acc: 0.358 Test Loss: 4.504 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 46 | loss: 0.7525941
	speed: 0.1681s/iter; left time: 1407.0745s
Epoch: 46 cost time: 5.413667678833008
Epoch: 46, Steps: 154 | Train Loss: 1.040 Vali Loss: 4.480 Vali Acc: 0.372 Test Loss: 4.480 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 47 | loss: 0.9260194
	speed: 0.1515s/iter; left time: 1244.7087s
Epoch: 47 cost time: 5.861316919326782
Epoch: 47, Steps: 154 | Train Loss: 0.940 Vali Loss: 4.501 Vali Acc: 0.379 Test Loss: 4.501 Test Acc: 0.379
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 48 | loss: 1.3195677
	speed: 0.1562s/iter; left time: 1259.4930s
Epoch: 48 cost time: 5.581018686294556
Epoch: 48, Steps: 154 | Train Loss: 0.954 Vali Loss: 4.614 Vali Acc: 0.241 Test Loss: 4.614 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 49 | loss: 0.8441835
	speed: 0.1597s/iter; left time: 1262.8107s
Epoch: 49 cost time: 5.503815174102783
Epoch: 49, Steps: 154 | Train Loss: 1.113 Vali Loss: 4.974 Vali Acc: 0.368 Test Loss: 4.974 Test Acc: 0.368
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 50 | loss: 1.0828844
	speed: 0.1563s/iter; left time: 1212.0943s
Epoch: 50 cost time: 5.649621486663818
Epoch: 50, Steps: 154 | Train Loss: 1.922 Vali Loss: 4.398 Vali Acc: 0.290 Test Loss: 4.398 Test Acc: 0.290
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 51 | loss: 0.5275750
	speed: 0.1563s/iter; left time: 1187.9404s
Epoch: 51 cost time: 5.6946494579315186
Epoch: 51, Steps: 154 | Train Loss: 1.241 Vali Loss: 5.022 Vali Acc: 0.210 Test Loss: 5.022 Test Acc: 0.210
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 52 | loss: 0.7987432
	speed: 0.1772s/iter; left time: 1319.2663s
Epoch: 52 cost time: 6.079155921936035
Epoch: 52, Steps: 154 | Train Loss: 1.545 Vali Loss: 5.312 Vali Acc: 0.340 Test Loss: 5.312 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 53 | loss: 0.6825975
	speed: 0.1757s/iter; left time: 1281.6147s
Epoch: 53 cost time: 5.734622955322266
Epoch: 53, Steps: 154 | Train Loss: 1.030 Vali Loss: 4.814 Vali Acc: 0.356 Test Loss: 4.814 Test Acc: 0.356
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 54 | loss: 4.5488205
	speed: 0.1788s/iter; left time: 1276.1620s
Epoch: 54 cost time: 5.90826153755188
Epoch: 54, Steps: 154 | Train Loss: 1.211 Vali Loss: 5.607 Vali Acc: 0.365 Test Loss: 5.607 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3848337388483374
model parameter : 364854
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2797327
	speed: 0.0559s/iter; left time: 855.3579s
Epoch: 1 cost time: 7.399524211883545
Epoch: 1, Steps: 154 | Train Loss: 2.253 Vali Loss: 2.172 Vali Acc: 0.321 Test Loss: 2.172 Test Acc: 0.321
Validation loss decreased (inf --> -0.320741).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0777144
	speed: 0.1578s/iter; left time: 2390.1032s
Epoch: 2 cost time: 5.9228668212890625
Epoch: 2, Steps: 154 | Train Loss: 2.083 Vali Loss: 2.181 Vali Acc: 0.324 Test Loss: 2.181 Test Acc: 0.324
Validation loss decreased (-0.320741 --> -0.323579).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7047240
	speed: 0.1586s/iter; left time: 2378.4752s
Epoch: 3 cost time: 6.163865804672241
Epoch: 3, Steps: 154 | Train Loss: 1.973 Vali Loss: 2.164 Vali Acc: 0.325 Test Loss: 2.164 Test Acc: 0.325
Validation loss decreased (-0.323579 --> -0.325201).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1446600
	speed: 0.1618s/iter; left time: 2401.5427s
Epoch: 4 cost time: 6.259743928909302
Epoch: 4, Steps: 154 | Train Loss: 1.910 Vali Loss: 2.239 Vali Acc: 0.321 Test Loss: 2.239 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6957175
	speed: 0.1572s/iter; left time: 2309.1286s
Epoch: 5 cost time: 5.9851531982421875
Epoch: 5, Steps: 154 | Train Loss: 1.920 Vali Loss: 2.222 Vali Acc: 0.326 Test Loss: 2.222 Test Acc: 0.326
Validation loss decreased (-0.325201 --> -0.325606).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8670869
	speed: 0.1731s/iter; left time: 2515.7760s
Epoch: 6 cost time: 5.911938190460205
Epoch: 6, Steps: 154 | Train Loss: 1.835 Vali Loss: 2.306 Vali Acc: 0.324 Test Loss: 2.306 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9120765
	speed: 0.1723s/iter; left time: 2477.1412s
Epoch: 7 cost time: 6.475910425186157
Epoch: 7, Steps: 154 | Train Loss: 1.802 Vali Loss: 2.195 Vali Acc: 0.327 Test Loss: 2.195 Test Acc: 0.327
Validation loss decreased (-0.325606 --> -0.326823).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4611323
	speed: 0.1777s/iter; left time: 2527.8926s
Epoch: 8 cost time: 6.727234125137329
Epoch: 8, Steps: 154 | Train Loss: 1.736 Vali Loss: 2.241 Vali Acc: 0.332 Test Loss: 2.241 Test Acc: 0.332
Validation loss decreased (-0.326823 --> -0.332094).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5393473
	speed: 0.1654s/iter; left time: 2327.1831s
Epoch: 9 cost time: 5.896346807479858
Epoch: 9, Steps: 154 | Train Loss: 1.749 Vali Loss: 2.337 Vali Acc: 0.335 Test Loss: 2.337 Test Acc: 0.335
Validation loss decreased (-0.332094 --> -0.335338).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8798443
	speed: 0.1577s/iter; left time: 2194.6080s
Epoch: 10 cost time: 5.943033456802368
Epoch: 10, Steps: 154 | Train Loss: 1.716 Vali Loss: 2.284 Vali Acc: 0.346 Test Loss: 2.284 Test Acc: 0.346
Validation loss decreased (-0.335338 --> -0.346287).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5972577
	speed: 0.1640s/iter; left time: 2256.9742s
Epoch: 11 cost time: 6.273521423339844
Epoch: 11, Steps: 154 | Train Loss: 1.681 Vali Loss: 2.313 Vali Acc: 0.343 Test Loss: 2.313 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4229145
	speed: 0.1614s/iter; left time: 2195.8194s
Epoch: 12 cost time: 6.390401124954224
Epoch: 12, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.319 Vali Acc: 0.354 Test Loss: 2.319 Test Acc: 0.354
Validation loss decreased (-0.346287 --> -0.353991).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.1357100
	speed: 0.1653s/iter; left time: 2223.4708s
Epoch: 13 cost time: 6.192946672439575
Epoch: 13, Steps: 154 | Train Loss: 1.678 Vali Loss: 2.409 Vali Acc: 0.361 Test Loss: 2.409 Test Acc: 0.361
Validation loss decreased (-0.353991 --> -0.361290).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2374110
	speed: 0.1604s/iter; left time: 2132.7427s
Epoch: 14 cost time: 5.893156290054321
Epoch: 14, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.508 Vali Acc: 0.349 Test Loss: 2.508 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.2013440
	speed: 0.1851s/iter; left time: 2433.3654s
Epoch: 15 cost time: 6.893848180770874
Epoch: 15, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.418 Vali Acc: 0.355 Test Loss: 2.418 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.2169071
	speed: 0.1722s/iter; left time: 2236.7550s
Epoch: 16 cost time: 6.567303657531738
Epoch: 16, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.579 Vali Acc: 0.357 Test Loss: 2.579 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.7225894
	speed: 0.1787s/iter; left time: 2293.8495s
Epoch: 17 cost time: 5.996418237686157
Epoch: 17, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.872 Vali Acc: 0.361 Test Loss: 2.872 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.2448645
	speed: 0.1616s/iter; left time: 2050.0818s
Epoch: 18 cost time: 6.027851581573486
Epoch: 18, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.704 Vali Acc: 0.371 Test Loss: 2.704 Test Acc: 0.371
Validation loss decreased (-0.361290 --> -0.371019).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.2037570
	speed: 0.1603s/iter; left time: 2008.0899s
Epoch: 19 cost time: 6.0850749015808105
Epoch: 19, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.738 Vali Acc: 0.368 Test Loss: 2.738 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.6130663
	speed: 0.1576s/iter; left time: 1950.2911s
Epoch: 20 cost time: 6.0445640087127686
Epoch: 20, Steps: 154 | Train Loss: 1.459 Vali Loss: 3.135 Vali Acc: 0.148 Test Loss: 3.135 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.0716572
	speed: 0.1341s/iter; left time: 1639.3929s
Epoch: 21 cost time: 5.2910239696502686
Epoch: 21, Steps: 154 | Train Loss: 1.424 Vali Loss: 3.108 Vali Acc: 0.369 Test Loss: 3.108 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.5483105
	speed: 0.1512s/iter; left time: 1824.5831s
Epoch: 22 cost time: 5.682450294494629
Epoch: 22, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.805 Vali Acc: 0.365 Test Loss: 2.805 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.4729460
	speed: 0.1585s/iter; left time: 1888.7777s
Epoch: 23 cost time: 6.5318639278411865
Epoch: 23, Steps: 154 | Train Loss: 1.356 Vali Loss: 2.885 Vali Acc: 0.373 Test Loss: 2.885 Test Acc: 0.373
Validation loss decreased (-0.371019 --> -0.372639).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.8139759
	speed: 0.1735s/iter; left time: 2040.5273s
Epoch: 24 cost time: 6.360388517379761
Epoch: 24, Steps: 154 | Train Loss: 1.457 Vali Loss: 3.318 Vali Acc: 0.108 Test Loss: 3.318 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.5227926
	speed: 0.1732s/iter; left time: 2010.3618s
Epoch: 25 cost time: 6.285566568374634
Epoch: 25, Steps: 154 | Train Loss: 1.425 Vali Loss: 3.252 Vali Acc: 0.198 Test Loss: 3.252 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.0719711
	speed: 0.1789s/iter; left time: 2048.7689s
Epoch: 26 cost time: 6.327162027359009
Epoch: 26, Steps: 154 | Train Loss: 1.357 Vali Loss: 3.313 Vali Acc: 0.187 Test Loss: 3.313 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.8950897
	speed: 0.1810s/iter; left time: 2045.2202s
Epoch: 27 cost time: 7.335997581481934
Epoch: 27, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.447 Vali Acc: 0.198 Test Loss: 3.447 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.0110700
	speed: 0.1544s/iter; left time: 1720.7029s
Epoch: 28 cost time: 4.376028299331665
Epoch: 28, Steps: 154 | Train Loss: 1.479 Vali Loss: 3.171 Vali Acc: 0.208 Test Loss: 3.171 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 1.3249484
	speed: 0.1082s/iter; left time: 1188.6514s
Epoch: 29 cost time: 4.481676816940308
Epoch: 29, Steps: 154 | Train Loss: 1.258 Vali Loss: 3.509 Vali Acc: 0.348 Test Loss: 3.509 Test Acc: 0.348
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 1.1678505
	speed: 0.1474s/iter; left time: 1596.7834s
Epoch: 30 cost time: 5.983568429946899
Epoch: 30, Steps: 154 | Train Loss: 1.274 Vali Loss: 3.561 Vali Acc: 0.353 Test Loss: 3.561 Test Acc: 0.353
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 1.2911512
	speed: 0.1581s/iter; left time: 1688.2896s
Epoch: 31 cost time: 5.931101322174072
Epoch: 31, Steps: 154 | Train Loss: 1.239 Vali Loss: 3.716 Vali Acc: 0.164 Test Loss: 3.716 Test Acc: 0.164
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 1.1685321
	speed: 0.1622s/iter; left time: 1707.9989s
Epoch: 32 cost time: 6.384021282196045
Epoch: 32, Steps: 154 | Train Loss: 1.356 Vali Loss: 4.105 Vali Acc: 0.217 Test Loss: 4.105 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 1.1933603
	speed: 0.1613s/iter; left time: 1672.9972s
Epoch: 33 cost time: 6.032137393951416
Epoch: 33, Steps: 154 | Train Loss: 1.735 Vali Loss: 3.477 Vali Acc: 0.198 Test Loss: 3.477 Test Acc: 0.198
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3726682887266829
model parameter : 233782
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2815645
	speed: 0.0583s/iter; left time: 892.2322s
Epoch: 1 cost time: 7.866101264953613
Epoch: 1, Steps: 154 | Train Loss: 2.245 Vali Loss: 2.170 Vali Acc: 0.320 Test Loss: 2.170 Test Acc: 0.320
Validation loss decreased (inf --> -0.320335).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0673809
	speed: 0.1688s/iter; left time: 2556.4916s
Epoch: 2 cost time: 6.160337686538696
Epoch: 2, Steps: 154 | Train Loss: 2.075 Vali Loss: 2.182 Vali Acc: 0.321 Test Loss: 2.182 Test Acc: 0.321
Validation loss decreased (-0.320335 --> -0.321146).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7235023
	speed: 0.1721s/iter; left time: 2580.9929s
Epoch: 3 cost time: 6.208288908004761
Epoch: 3, Steps: 154 | Train Loss: 1.966 Vali Loss: 2.159 Vali Acc: 0.324 Test Loss: 2.159 Test Acc: 0.324
Validation loss decreased (-0.321146 --> -0.323985).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1638825
	speed: 0.1648s/iter; left time: 2445.5432s
Epoch: 4 cost time: 5.868427276611328
Epoch: 4, Steps: 154 | Train Loss: 1.904 Vali Loss: 2.244 Vali Acc: 0.321 Test Loss: 2.244 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7049994
	speed: 0.1543s/iter; left time: 2266.5228s
Epoch: 5 cost time: 5.645413637161255
Epoch: 5, Steps: 154 | Train Loss: 1.901 Vali Loss: 2.210 Vali Acc: 0.325 Test Loss: 2.210 Test Acc: 0.325
Validation loss decreased (-0.323985 --> -0.325201).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8847090
	speed: 0.1547s/iter; left time: 2247.5685s
Epoch: 6 cost time: 6.370426893234253
Epoch: 6, Steps: 154 | Train Loss: 1.802 Vali Loss: 2.276 Vali Acc: 0.324 Test Loss: 2.276 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8663095
	speed: 0.1526s/iter; left time: 2194.4959s
Epoch: 7 cost time: 5.975323915481567
Epoch: 7, Steps: 154 | Train Loss: 1.811 Vali Loss: 2.209 Vali Acc: 0.332 Test Loss: 2.209 Test Acc: 0.332
Validation loss decreased (-0.325201 --> -0.331689).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4272748
	speed: 0.1571s/iter; left time: 2233.9822s
Epoch: 8 cost time: 6.024591445922852
Epoch: 8, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.280 Vali Acc: 0.329 Test Loss: 2.280 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5977454
	speed: 0.1571s/iter; left time: 2209.9593s
Epoch: 9 cost time: 6.008248329162598
Epoch: 9, Steps: 154 | Train Loss: 1.743 Vali Loss: 2.342 Vali Acc: 0.340 Test Loss: 2.342 Test Acc: 0.340
Validation loss decreased (-0.331689 --> -0.339798).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9759679
	speed: 0.1772s/iter; left time: 2465.1791s
Epoch: 10 cost time: 6.539550542831421
Epoch: 10, Steps: 154 | Train Loss: 1.725 Vali Loss: 2.318 Vali Acc: 0.343 Test Loss: 2.318 Test Acc: 0.343
Validation loss decreased (-0.339798 --> -0.343043).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8977984
	speed: 0.1680s/iter; left time: 2311.6699s
Epoch: 11 cost time: 6.575647354125977
Epoch: 11, Steps: 154 | Train Loss: 1.699 Vali Loss: 2.410 Vali Acc: 0.341 Test Loss: 2.410 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9940000
	speed: 0.1802s/iter; left time: 2452.5179s
Epoch: 12 cost time: 6.180883407592773
Epoch: 12, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.312 Vali Acc: 0.357 Test Loss: 2.312 Test Acc: 0.357
Validation loss decreased (-0.343043 --> -0.357236).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.9464128
	speed: 0.1577s/iter; left time: 2120.9895s
Epoch: 13 cost time: 5.765042781829834
Epoch: 13, Steps: 154 | Train Loss: 1.633 Vali Loss: 2.365 Vali Acc: 0.361 Test Loss: 2.365 Test Acc: 0.361
Validation loss decreased (-0.357236 --> -0.360885).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0897914
	speed: 0.1594s/iter; left time: 2119.2098s
Epoch: 14 cost time: 5.879987716674805
Epoch: 14, Steps: 154 | Train Loss: 1.571 Vali Loss: 2.537 Vali Acc: 0.349 Test Loss: 2.537 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.2220917
	speed: 0.1614s/iter; left time: 2121.3027s
Epoch: 15 cost time: 6.06364631652832
Epoch: 15, Steps: 154 | Train Loss: 1.552 Vali Loss: 2.357 Vali Acc: 0.361 Test Loss: 2.357 Test Acc: 0.361
Validation loss decreased (-0.360885 --> -0.360885).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.0221212
	speed: 0.1557s/iter; left time: 2022.0947s
Epoch: 16 cost time: 5.771305084228516
Epoch: 16, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.489 Vali Acc: 0.357 Test Loss: 2.489 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.5816929
	speed: 0.1527s/iter; left time: 1960.7226s
Epoch: 17 cost time: 5.647693634033203
Epoch: 17, Steps: 154 | Train Loss: 1.585 Vali Loss: 2.593 Vali Acc: 0.359 Test Loss: 2.593 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.2683331
	speed: 0.1672s/iter; left time: 2120.0177s
Epoch: 18 cost time: 6.385672569274902
Epoch: 18, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.652 Vali Acc: 0.364 Test Loss: 2.652 Test Acc: 0.364
Validation loss decreased (-0.360885 --> -0.363720).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.0369029
	speed: 0.1723s/iter; left time: 2158.7152s
Epoch: 19 cost time: 6.4443535804748535
Epoch: 19, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.780 Vali Acc: 0.365 Test Loss: 2.780 Test Acc: 0.365
Validation loss decreased (-0.363720 --> -0.364530).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.5890284
	speed: 0.1766s/iter; left time: 2186.0313s
Epoch: 20 cost time: 6.172068357467651
Epoch: 20, Steps: 154 | Train Loss: 1.423 Vali Loss: 3.499 Vali Acc: 0.195 Test Loss: 3.499 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.9882981
	speed: 0.1617s/iter; left time: 1976.0181s
Epoch: 21 cost time: 6.032721281051636
Epoch: 21, Steps: 154 | Train Loss: 1.517 Vali Loss: 3.230 Vali Acc: 0.371 Test Loss: 3.230 Test Acc: 0.371
Validation loss decreased (-0.364530 --> -0.371419).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.2522386
	speed: 0.1604s/iter; left time: 1935.3165s
Epoch: 22 cost time: 6.047266244888306
Epoch: 22, Steps: 154 | Train Loss: 1.381 Vali Loss: 2.933 Vali Acc: 0.365 Test Loss: 2.933 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.3770666
	speed: 0.1631s/iter; left time: 1942.8077s
Epoch: 23 cost time: 6.3086097240448
Epoch: 23, Steps: 154 | Train Loss: 1.462 Vali Loss: 3.024 Vali Acc: 0.380 Test Loss: 3.024 Test Acc: 0.380
Validation loss decreased (-0.371419 --> -0.379532).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.8002268
	speed: 0.1596s/iter; left time: 1877.0845s
Epoch: 24 cost time: 6.412189483642578
Epoch: 24, Steps: 154 | Train Loss: 1.346 Vali Loss: 3.152 Vali Acc: 0.201 Test Loss: 3.152 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.4777350
	speed: 0.1600s/iter; left time: 1856.9793s
Epoch: 25 cost time: 5.950620651245117
Epoch: 25, Steps: 154 | Train Loss: 1.443 Vali Loss: 3.327 Vali Acc: 0.365 Test Loss: 3.327 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.0643699
	speed: 0.1588s/iter; left time: 1818.2807s
Epoch: 26 cost time: 6.413957357406616
Epoch: 26, Steps: 154 | Train Loss: 1.389 Vali Loss: 3.542 Vali Acc: 0.207 Test Loss: 3.542 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.7376897
	speed: 0.1819s/iter; left time: 2055.4346s
Epoch: 27 cost time: 6.370483875274658
Epoch: 27, Steps: 154 | Train Loss: 1.442 Vali Loss: 3.661 Vali Acc: 0.221 Test Loss: 3.661 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.0263001
	speed: 0.1755s/iter; left time: 1955.2671s
Epoch: 28 cost time: 6.65052342414856
Epoch: 28, Steps: 154 | Train Loss: 1.273 Vali Loss: 3.716 Vali Acc: 0.205 Test Loss: 3.716 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 1.2531359
	speed: 0.1826s/iter; left time: 2006.7465s
Epoch: 29 cost time: 5.9322357177734375
Epoch: 29, Steps: 154 | Train Loss: 1.373 Vali Loss: 3.396 Vali Acc: 0.377 Test Loss: 3.396 Test Acc: 0.377
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 1.0414106
	speed: 0.1579s/iter; left time: 1710.5393s
Epoch: 30 cost time: 5.8724071979522705
Epoch: 30, Steps: 154 | Train Loss: 1.348 Vali Loss: 3.796 Vali Acc: 0.367 Test Loss: 3.796 Test Acc: 0.367
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 1.0516026
	speed: 0.1616s/iter; left time: 1726.0866s
Epoch: 31 cost time: 6.114077568054199
Epoch: 31, Steps: 154 | Train Loss: 1.227 Vali Loss: 3.714 Vali Acc: 0.368 Test Loss: 3.714 Test Acc: 0.368
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 1.0916401
	speed: 0.1619s/iter; left time: 1704.1461s
Epoch: 32 cost time: 6.269564628601074
Epoch: 32, Steps: 154 | Train Loss: 1.415 Vali Loss: 4.253 Vali Acc: 0.270 Test Loss: 4.253 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 1.1496192
	speed: 0.1575s/iter; left time: 1633.8624s
Epoch: 33 cost time: 5.980345010757446
Epoch: 33, Steps: 154 | Train Loss: 1.413 Vali Loss: 3.650 Vali Acc: 0.223 Test Loss: 3.650 Test Acc: 0.223
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3795620437956204
model parameter : 233782
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2584112
	speed: 0.0574s/iter; left time: 878.7781s
Epoch: 1 cost time: 7.728607654571533
Epoch: 1, Steps: 154 | Train Loss: 2.229 Vali Loss: 2.162 Vali Acc: 0.320 Test Loss: 2.162 Test Acc: 0.320
Validation loss decreased (inf --> -0.320335).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0812910
	speed: 0.1676s/iter; left time: 2539.2296s
Epoch: 2 cost time: 6.2479705810546875
Epoch: 2, Steps: 154 | Train Loss: 2.065 Vali Loss: 2.171 Vali Acc: 0.321 Test Loss: 2.171 Test Acc: 0.321
Validation loss decreased (-0.320335 --> -0.320741).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7202001
	speed: 0.1532s/iter; left time: 2297.1223s
Epoch: 3 cost time: 5.892016649246216
Epoch: 3, Steps: 154 | Train Loss: 1.971 Vali Loss: 2.152 Vali Acc: 0.326 Test Loss: 2.152 Test Acc: 0.326
Validation loss decreased (-0.320741 --> -0.326013).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1625187
	speed: 0.1602s/iter; left time: 2377.7256s
Epoch: 4 cost time: 5.955496549606323
Epoch: 4, Steps: 154 | Train Loss: 1.905 Vali Loss: 2.212 Vali Acc: 0.320 Test Loss: 2.212 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6586726
	speed: 0.1545s/iter; left time: 2269.3032s
Epoch: 5 cost time: 5.898757696151733
Epoch: 5, Steps: 154 | Train Loss: 1.916 Vali Loss: 2.207 Vali Acc: 0.326 Test Loss: 2.207 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.8819700
	speed: 0.1551s/iter; left time: 2253.4526s
Epoch: 6 cost time: 5.982910394668579
Epoch: 6, Steps: 154 | Train Loss: 1.822 Vali Loss: 2.275 Vali Acc: 0.325 Test Loss: 2.275 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.8979547
	speed: 0.1559s/iter; left time: 2241.1257s
Epoch: 7 cost time: 6.4400856494903564
Epoch: 7, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.193 Vali Acc: 0.333 Test Loss: 2.193 Test Acc: 0.333
Validation loss decreased (-0.326013 --> -0.333311).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4147766
	speed: 0.1553s/iter; left time: 2208.6020s
Epoch: 8 cost time: 5.7201619148254395
Epoch: 8, Steps: 154 | Train Loss: 1.761 Vali Loss: 2.265 Vali Acc: 0.335 Test Loss: 2.265 Test Acc: 0.335
Validation loss decreased (-0.333311 --> -0.335338).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6438630
	speed: 0.1647s/iter; left time: 2317.8508s
Epoch: 9 cost time: 6.2143027782440186
Epoch: 9, Steps: 154 | Train Loss: 1.836 Vali Loss: 2.347 Vali Acc: 0.339 Test Loss: 2.347 Test Acc: 0.339
Validation loss decreased (-0.335338 --> -0.339393).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8337840
	speed: 0.1796s/iter; left time: 2498.8583s
Epoch: 10 cost time: 6.140247821807861
Epoch: 10, Steps: 154 | Train Loss: 1.728 Vali Loss: 2.293 Vali Acc: 0.350 Test Loss: 2.293 Test Acc: 0.350
Validation loss decreased (-0.339393 --> -0.349531).  Saving model ...
	iters: 100, epoch: 11 | loss: 4.3063049
	speed: 0.1784s/iter; left time: 2454.9928s
Epoch: 11 cost time: 6.492055177688599
Epoch: 11, Steps: 154 | Train Loss: 1.688 Vali Loss: 2.392 Vali Acc: 0.343 Test Loss: 2.392 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4106978
	speed: 0.1732s/iter; left time: 2356.6458s
Epoch: 12 cost time: 5.922138452529907
Epoch: 12, Steps: 154 | Train Loss: 1.696 Vali Loss: 2.363 Vali Acc: 0.355 Test Loss: 2.363 Test Acc: 0.355
Validation loss decreased (-0.349531 --> -0.355208).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.8766799
	speed: 0.1625s/iter; left time: 2185.5188s
Epoch: 13 cost time: 6.0123982429504395
Epoch: 13, Steps: 154 | Train Loss: 1.636 Vali Loss: 2.445 Vali Acc: 0.352 Test Loss: 2.445 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1689305
	speed: 0.1632s/iter; left time: 2170.9824s
Epoch: 14 cost time: 6.010560750961304
Epoch: 14, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.606 Vali Acc: 0.350 Test Loss: 2.606 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.1198540
	speed: 0.1623s/iter; left time: 2132.9347s
Epoch: 15 cost time: 6.127914190292358
Epoch: 15, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.471 Vali Acc: 0.358 Test Loss: 2.471 Test Acc: 0.358
Validation loss decreased (-0.355208 --> -0.358451).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.9959281
	speed: 0.1610s/iter; left time: 2091.1676s
Epoch: 16 cost time: 6.177090167999268
Epoch: 16, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.616 Vali Acc: 0.355 Test Loss: 2.616 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.4871935
	speed: 0.1682s/iter; left time: 2158.5651s
Epoch: 17 cost time: 6.501330852508545
Epoch: 17, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.508 Vali Acc: 0.363 Test Loss: 2.508 Test Acc: 0.363
Validation loss decreased (-0.358451 --> -0.362911).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.3869870
	speed: 0.1795s/iter; left time: 2277.1154s
Epoch: 18 cost time: 5.9484288692474365
Epoch: 18, Steps: 154 | Train Loss: 1.542 Vali Loss: 2.713 Vali Acc: 0.379 Test Loss: 2.713 Test Acc: 0.379
Validation loss decreased (-0.362911 --> -0.379129).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.9915224
	speed: 0.1761s/iter; left time: 2206.1559s
Epoch: 19 cost time: 6.584940195083618
Epoch: 19, Steps: 154 | Train Loss: 1.635 Vali Loss: 2.649 Vali Acc: 0.361 Test Loss: 2.649 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.4910693
	speed: 0.1742s/iter; left time: 2156.0146s
Epoch: 20 cost time: 6.6085309982299805
Epoch: 20, Steps: 154 | Train Loss: 1.525 Vali Loss: 3.012 Vali Acc: 0.233 Test Loss: 3.012 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.1855354
	speed: 0.1603s/iter; left time: 1958.8451s
Epoch: 21 cost time: 6.041462182998657
Epoch: 21, Steps: 154 | Train Loss: 1.399 Vali Loss: 2.887 Vali Acc: 0.376 Test Loss: 2.887 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.3778772
	speed: 0.1582s/iter; left time: 1908.9263s
Epoch: 22 cost time: 6.166294097900391
Epoch: 22, Steps: 154 | Train Loss: 1.338 Vali Loss: 3.104 Vali Acc: 0.362 Test Loss: 3.104 Test Acc: 0.362
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.5045632
	speed: 0.1558s/iter; left time: 1856.1070s
Epoch: 23 cost time: 5.716740608215332
Epoch: 23, Steps: 154 | Train Loss: 1.362 Vali Loss: 2.978 Vali Acc: 0.380 Test Loss: 2.978 Test Acc: 0.380
Validation loss decreased (-0.379129 --> -0.379938).  Saving model ...
	iters: 100, epoch: 24 | loss: 2.2726321
	speed: 0.1616s/iter; left time: 1900.4576s
Epoch: 24 cost time: 6.152331352233887
Epoch: 24, Steps: 154 | Train Loss: 1.441 Vali Loss: 3.151 Vali Acc: 0.233 Test Loss: 3.151 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.4754388
	speed: 0.1638s/iter; left time: 1900.5410s
Epoch: 25 cost time: 6.55503511428833
Epoch: 25, Steps: 154 | Train Loss: 1.278 Vali Loss: 3.521 Vali Acc: 0.236 Test Loss: 3.521 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.0007516
	speed: 0.1831s/iter; left time: 2096.1240s
Epoch: 26 cost time: 6.179608106613159
Epoch: 26, Steps: 154 | Train Loss: 1.281 Vali Loss: 3.569 Vali Acc: 0.238 Test Loss: 3.569 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.7122595
	speed: 0.1701s/iter; left time: 1921.2040s
Epoch: 27 cost time: 6.172130823135376
Epoch: 27, Steps: 154 | Train Loss: 1.290 Vali Loss: 3.972 Vali Acc: 0.266 Test Loss: 3.972 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.9153202
	speed: 0.1759s/iter; left time: 1960.3034s
Epoch: 28 cost time: 5.89862585067749
Epoch: 28, Steps: 154 | Train Loss: 1.346 Vali Loss: 3.212 Vali Acc: 0.222 Test Loss: 3.212 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 1.5207644
	speed: 0.1560s/iter; left time: 1714.5714s
Epoch: 29 cost time: 5.93449330329895
Epoch: 29, Steps: 154 | Train Loss: 1.397 Vali Loss: 3.529 Vali Acc: 0.372 Test Loss: 3.529 Test Acc: 0.372
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 1.0588723
	speed: 0.1520s/iter; left time: 1646.7186s
Epoch: 30 cost time: 6.149296045303345
Epoch: 30, Steps: 154 | Train Loss: 1.572 Vali Loss: 4.070 Vali Acc: 0.198 Test Loss: 4.070 Test Acc: 0.198
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 1.0931895
	speed: 0.1645s/iter; left time: 1756.9763s
Epoch: 31 cost time: 6.143436670303345
Epoch: 31, Steps: 154 | Train Loss: 1.298 Vali Loss: 3.584 Vali Acc: 0.378 Test Loss: 3.584 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.9664223
	speed: 0.1587s/iter; left time: 1670.6830s
Epoch: 32 cost time: 5.980139255523682
Epoch: 32, Steps: 154 | Train Loss: 1.303 Vali Loss: 3.924 Vali Acc: 0.378 Test Loss: 3.924 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 1.1856425
	speed: 0.1525s/iter; left time: 1581.8724s
Epoch: 33 cost time: 6.097886562347412
Epoch: 33, Steps: 154 | Train Loss: 1.352 Vali Loss: 3.889 Vali Acc: 0.301 Test Loss: 3.889 Test Acc: 0.301
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 233782
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2384462
	speed: 0.0551s/iter; left time: 842.4054s
Epoch: 1 cost time: 7.6458587646484375
Epoch: 1, Steps: 154 | Train Loss: 2.213 Vali Loss: 2.153 Vali Acc: 0.319 Test Loss: 2.153 Test Acc: 0.319
Validation loss decreased (inf --> -0.319119).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0846786
	speed: 0.1735s/iter; left time: 2627.6719s
Epoch: 2 cost time: 5.933875560760498
Epoch: 2, Steps: 154 | Train Loss: 2.062 Vali Loss: 2.178 Vali Acc: 0.320 Test Loss: 2.178 Test Acc: 0.320
Validation loss decreased (-0.319119 --> -0.319524).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7648563
	speed: 0.1598s/iter; left time: 2395.3458s
Epoch: 3 cost time: 5.631634473800659
Epoch: 3, Steps: 154 | Train Loss: 1.993 Vali Loss: 2.137 Vali Acc: 0.325 Test Loss: 2.137 Test Acc: 0.325
Validation loss decreased (-0.319524 --> -0.325202).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1858616
	speed: 0.1469s/iter; left time: 2180.3530s
Epoch: 4 cost time: 5.4072535037994385
Epoch: 4, Steps: 154 | Train Loss: 1.935 Vali Loss: 2.192 Vali Acc: 0.322 Test Loss: 2.192 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7150403
	speed: 0.1508s/iter; left time: 2214.6576s
Epoch: 5 cost time: 5.249562501907349
Epoch: 5, Steps: 154 | Train Loss: 1.879 Vali Loss: 2.176 Vali Acc: 0.328 Test Loss: 2.176 Test Acc: 0.328
Validation loss decreased (-0.325202 --> -0.328040).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7959398
	speed: 0.1493s/iter; left time: 2169.1193s
Epoch: 6 cost time: 5.332219123840332
Epoch: 6, Steps: 154 | Train Loss: 1.818 Vali Loss: 2.256 Vali Acc: 0.330 Test Loss: 2.256 Test Acc: 0.330
Validation loss decreased (-0.328040 --> -0.330472).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9117002
	speed: 0.1495s/iter; left time: 2150.0772s
Epoch: 7 cost time: 5.531452178955078
Epoch: 7, Steps: 154 | Train Loss: 1.804 Vali Loss: 2.181 Vali Acc: 0.338 Test Loss: 2.181 Test Acc: 0.338
Validation loss decreased (-0.330472 --> -0.337772).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4673812
	speed: 0.1548s/iter; left time: 2202.0182s
Epoch: 8 cost time: 5.73365330696106
Epoch: 8, Steps: 154 | Train Loss: 1.846 Vali Loss: 2.355 Vali Acc: 0.338 Test Loss: 2.355 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5467819
	speed: 0.1742s/iter; left time: 2450.7365s
Epoch: 9 cost time: 6.086158990859985
Epoch: 9, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.240 Vali Acc: 0.347 Test Loss: 2.240 Test Acc: 0.347
Validation loss decreased (-0.337772 --> -0.347098).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8626150
	speed: 0.1691s/iter; left time: 2353.0466s
Epoch: 10 cost time: 5.555129528045654
Epoch: 10, Steps: 154 | Train Loss: 1.730 Vali Loss: 2.249 Vali Acc: 0.346 Test Loss: 2.249 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3369907
	speed: 0.1546s/iter; left time: 2126.8977s
Epoch: 11 cost time: 5.741033554077148
Epoch: 11, Steps: 154 | Train Loss: 1.692 Vali Loss: 2.433 Vali Acc: 0.347 Test Loss: 2.433 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.6258599
	speed: 0.1528s/iter; left time: 2079.0781s
Epoch: 12 cost time: 5.395978689193726
Epoch: 12, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.324 Vali Acc: 0.361 Test Loss: 2.324 Test Acc: 0.361
Validation loss decreased (-0.347098 --> -0.360885).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5841892
	speed: 0.1620s/iter; left time: 2178.9040s
Epoch: 13 cost time: 5.9580888748168945
Epoch: 13, Steps: 154 | Train Loss: 1.647 Vali Loss: 2.386 Vali Acc: 0.354 Test Loss: 2.386 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.2121227
	speed: 0.1590s/iter; left time: 2114.5067s
Epoch: 14 cost time: 6.057796478271484
Epoch: 14, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.576 Vali Acc: 0.350 Test Loss: 2.576 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.1728413
	speed: 0.1618s/iter; left time: 2126.9422s
Epoch: 15 cost time: 5.860137462615967
Epoch: 15, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.384 Vali Acc: 0.358 Test Loss: 2.384 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 5.4515967
	speed: 0.1602s/iter; left time: 2081.1971s
Epoch: 16 cost time: 5.670882225036621
Epoch: 16, Steps: 154 | Train Loss: 1.693 Vali Loss: 2.438 Vali Acc: 0.361 Test Loss: 2.438 Test Acc: 0.361
Validation loss decreased (-0.360885 --> -0.361289).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.1767745
	speed: 0.1653s/iter; left time: 2122.5547s
Epoch: 17 cost time: 6.7738423347473145
Epoch: 17, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.748 Vali Acc: 0.360 Test Loss: 2.748 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.0491745
	speed: 0.1791s/iter; left time: 2271.7672s
Epoch: 18 cost time: 6.1286211013793945
Epoch: 18, Steps: 154 | Train Loss: 1.638 Vali Loss: 2.624 Vali Acc: 0.369 Test Loss: 2.624 Test Acc: 0.369
Validation loss decreased (-0.361289 --> -0.369398).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.1377993
	speed: 0.1747s/iter; left time: 2188.8420s
Epoch: 19 cost time: 6.149606704711914
Epoch: 19, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.781 Vali Acc: 0.367 Test Loss: 2.781 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.4606099
	speed: 0.1787s/iter; left time: 2211.8325s
Epoch: 20 cost time: 6.064187526702881
Epoch: 20, Steps: 154 | Train Loss: 1.511 Vali Loss: 2.669 Vali Acc: 0.237 Test Loss: 2.669 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.0543211
	speed: 0.1605s/iter; left time: 1961.7013s
Epoch: 21 cost time: 5.787579774856567
Epoch: 21, Steps: 154 | Train Loss: 1.456 Vali Loss: 3.037 Vali Acc: 0.377 Test Loss: 3.037 Test Acc: 0.377
Validation loss decreased (-0.369398 --> -0.376693).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.2853444
	speed: 0.1601s/iter; left time: 1931.4497s
Epoch: 22 cost time: 5.803497076034546
Epoch: 22, Steps: 154 | Train Loss: 1.332 Vali Loss: 3.045 Vali Acc: 0.361 Test Loss: 3.045 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.2463655
	speed: 0.1605s/iter; left time: 1912.0453s
Epoch: 23 cost time: 5.738311529159546
Epoch: 23, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.941 Vali Acc: 0.370 Test Loss: 2.941 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.8706995
	speed: 0.1608s/iter; left time: 1890.5767s
Epoch: 24 cost time: 5.723762512207031
Epoch: 24, Steps: 154 | Train Loss: 1.291 Vali Loss: 3.168 Vali Acc: 0.341 Test Loss: 3.168 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.4766131
	speed: 0.1567s/iter; left time: 1818.0715s
Epoch: 25 cost time: 5.741368055343628
Epoch: 25, Steps: 154 | Train Loss: 1.264 Vali Loss: 3.182 Vali Acc: 0.373 Test Loss: 3.182 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.8931364
	speed: 0.1803s/iter; left time: 2064.9670s
Epoch: 26 cost time: 6.099751949310303
Epoch: 26, Steps: 154 | Train Loss: 1.459 Vali Loss: 3.265 Vali Acc: 0.217 Test Loss: 3.265 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.5589923
	speed: 0.1814s/iter; left time: 2049.4243s
Epoch: 27 cost time: 6.435492753982544
Epoch: 27, Steps: 154 | Train Loss: 1.521 Vali Loss: 3.195 Vali Acc: 0.384 Test Loss: 3.195 Test Acc: 0.384
Validation loss decreased (-0.376693 --> -0.383991).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.8243501
	speed: 0.1805s/iter; left time: 2011.6407s
Epoch: 28 cost time: 6.492354869842529
Epoch: 28, Steps: 154 | Train Loss: 1.606 Vali Loss: 3.207 Vali Acc: 0.219 Test Loss: 3.207 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 2.2661047
	speed: 0.1681s/iter; left time: 1847.2888s
Epoch: 29 cost time: 5.770425796508789
Epoch: 29, Steps: 154 | Train Loss: 1.313 Vali Loss: 3.439 Vali Acc: 0.372 Test Loss: 3.439 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 1.1804976
	speed: 0.1607s/iter; left time: 1740.8393s
Epoch: 30 cost time: 5.965791940689087
Epoch: 30, Steps: 154 | Train Loss: 1.538 Vali Loss: 3.583 Vali Acc: 0.376 Test Loss: 3.583 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.9452719
	speed: 0.1598s/iter; left time: 1706.4655s
Epoch: 31 cost time: 5.941142320632935
Epoch: 31, Steps: 154 | Train Loss: 1.224 Vali Loss: 3.143 Vali Acc: 0.384 Test Loss: 3.143 Test Acc: 0.384
Validation loss decreased (-0.383991 --> -0.384397).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.9889163
	speed: 0.1625s/iter; left time: 1710.4464s
Epoch: 32 cost time: 5.898058652877808
Epoch: 32, Steps: 154 | Train Loss: 1.262 Vali Loss: 3.324 Vali Acc: 0.388 Test Loss: 3.324 Test Acc: 0.388
Validation loss decreased (-0.384397 --> -0.387639).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.2705367
	speed: 0.1617s/iter; left time: 1677.6455s
Epoch: 33 cost time: 5.921180009841919
Epoch: 33, Steps: 154 | Train Loss: 1.349 Vali Loss: 3.567 Vali Acc: 0.276 Test Loss: 3.567 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.7715709
	speed: 0.1605s/iter; left time: 1640.3424s
Epoch: 34 cost time: 6.215911149978638
Epoch: 34, Steps: 154 | Train Loss: 1.207 Vali Loss: 3.305 Vali Acc: 0.231 Test Loss: 3.305 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.9572664
	speed: 0.1812s/iter; left time: 1823.4877s
Epoch: 35 cost time: 6.259565591812134
Epoch: 35, Steps: 154 | Train Loss: 1.468 Vali Loss: 3.962 Vali Acc: 0.383 Test Loss: 3.962 Test Acc: 0.383
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 4.7642832
	speed: 0.1827s/iter; left time: 1811.0414s
Epoch: 36 cost time: 6.0802085399627686
Epoch: 36, Steps: 154 | Train Loss: 1.219 Vali Loss: 3.777 Vali Acc: 0.219 Test Loss: 3.777 Test Acc: 0.219
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 1.3213197
	speed: 0.1802s/iter; left time: 1757.9787s
Epoch: 37 cost time: 6.198354482650757
Epoch: 37, Steps: 154 | Train Loss: 1.152 Vali Loss: 3.992 Vali Acc: 0.234 Test Loss: 3.992 Test Acc: 0.234
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 1.2640548
	speed: 0.1580s/iter; left time: 1517.4581s
Epoch: 38 cost time: 6.037803411483765
Epoch: 38, Steps: 154 | Train Loss: 1.208 Vali Loss: 3.462 Vali Acc: 0.385 Test Loss: 3.462 Test Acc: 0.385
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.8656152
	speed: 0.1606s/iter; left time: 1517.2922s
Epoch: 39 cost time: 5.7610862255096436
Epoch: 39, Steps: 154 | Train Loss: 1.259 Vali Loss: 3.522 Vali Acc: 0.340 Test Loss: 3.522 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.5313955
	speed: 0.1621s/iter; left time: 1506.5514s
Epoch: 40 cost time: 5.858001708984375
Epoch: 40, Steps: 154 | Train Loss: 1.339 Vali Loss: 4.090 Vali Acc: 0.276 Test Loss: 4.090 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 1.1467946
	speed: 0.1660s/iter; left time: 1517.8530s
Epoch: 41 cost time: 5.934795618057251
Epoch: 41, Steps: 154 | Train Loss: 1.164 Vali Loss: 4.242 Vali Acc: 0.388 Test Loss: 4.242 Test Acc: 0.388
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.8130049
	speed: 0.1581s/iter; left time: 1420.7532s
Epoch: 42 cost time: 5.6820969581604
Epoch: 42, Steps: 154 | Train Loss: 1.137 Vali Loss: 3.727 Vali Acc: 0.389 Test Loss: 3.727 Test Acc: 0.389
Validation loss decreased (-0.387639 --> -0.389257).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.9323755
	speed: 0.1778s/iter; left time: 1570.1957s
Epoch: 43 cost time: 5.952823162078857
Epoch: 43, Steps: 154 | Train Loss: 1.349 Vali Loss: 4.369 Vali Acc: 0.211 Test Loss: 4.369 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 0.5520338
	speed: 0.1740s/iter; left time: 1510.3142s
Epoch: 44 cost time: 5.975462198257446
Epoch: 44, Steps: 154 | Train Loss: 1.035 Vali Loss: 3.824 Vali Acc: 0.389 Test Loss: 3.824 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 0.6658653
	speed: 0.1733s/iter; left time: 1477.5181s
Epoch: 45 cost time: 6.104808330535889
Epoch: 45, Steps: 154 | Train Loss: 1.448 Vali Loss: 4.222 Vali Acc: 0.369 Test Loss: 4.222 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 46 | loss: 0.7515748
	speed: 0.1625s/iter; left time: 1360.1470s
Epoch: 46 cost time: 5.408405065536499
Epoch: 46, Steps: 154 | Train Loss: 1.084 Vali Loss: 4.243 Vali Acc: 0.377 Test Loss: 4.243 Test Acc: 0.377
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 47 | loss: 0.8903912
	speed: 0.1471s/iter; left time: 1208.3689s
Epoch: 47 cost time: 5.346129894256592
Epoch: 47, Steps: 154 | Train Loss: 0.974 Vali Loss: 4.582 Vali Acc: 0.150 Test Loss: 4.582 Test Acc: 0.150
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 48 | loss: 0.6884673
	speed: 0.1474s/iter; left time: 1188.4480s
Epoch: 48 cost time: 5.898982524871826
Epoch: 48, Steps: 154 | Train Loss: 1.038 Vali Loss: 4.468 Vali Acc: 0.222 Test Loss: 4.468 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 49 | loss: 0.9430769
	speed: 0.1557s/iter; left time: 1231.6592s
Epoch: 49 cost time: 5.677160978317261
Epoch: 49, Steps: 154 | Train Loss: 1.112 Vali Loss: 4.494 Vali Acc: 0.376 Test Loss: 4.494 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 50 | loss: 0.5341443
	speed: 0.1460s/iter; left time: 1132.4938s
Epoch: 50 cost time: 5.0737855434417725
Epoch: 50, Steps: 154 | Train Loss: 1.758 Vali Loss: 4.802 Vali Acc: 0.252 Test Loss: 4.802 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 51 | loss: 1.0670567
	speed: 0.1458s/iter; left time: 1108.4127s
Epoch: 51 cost time: 6.249333143234253
Epoch: 51, Steps: 154 | Train Loss: 1.070 Vali Loss: 4.906 Vali Acc: 0.382 Test Loss: 4.906 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 52 | loss: 0.5329332
	speed: 0.1721s/iter; left time: 1281.5700s
Epoch: 52 cost time: 5.963752508163452
Epoch: 52, Steps: 154 | Train Loss: 1.282 Vali Loss: 4.726 Vali Acc: 0.327 Test Loss: 4.726 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38929440389294406
model parameter : 233782
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6369116
	speed: 0.0582s/iter; left time: 889.9819s
Epoch: 1 cost time: 7.901277780532837
Epoch: 1, Steps: 154 | Train Loss: 2.249 Vali Loss: 2.176 Vali Acc: 0.318 Test Loss: 2.176 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0655446
	speed: 0.1673s/iter; left time: 2533.4442s
Epoch: 2 cost time: 6.441453695297241
Epoch: 2, Steps: 154 | Train Loss: 2.072 Vali Loss: 2.193 Vali Acc: 0.324 Test Loss: 2.193 Test Acc: 0.324
Validation loss decreased (-0.317902 --> -0.323579).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9678831
	speed: 0.1617s/iter; left time: 2424.3436s
Epoch: 3 cost time: 5.9173948764801025
Epoch: 3, Steps: 154 | Train Loss: 1.996 Vali Loss: 2.180 Vali Acc: 0.324 Test Loss: 2.180 Test Acc: 0.324
Validation loss decreased (-0.323579 --> -0.323985).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9668261
	speed: 0.1593s/iter; left time: 2364.2021s
Epoch: 4 cost time: 5.849807262420654
Epoch: 4, Steps: 154 | Train Loss: 1.904 Vali Loss: 2.188 Vali Acc: 0.324 Test Loss: 2.188 Test Acc: 0.324
Validation loss decreased (-0.323985 --> -0.324390).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7468405
	speed: 0.1637s/iter; left time: 2404.1704s
Epoch: 5 cost time: 6.405776262283325
Epoch: 5, Steps: 154 | Train Loss: 1.927 Vali Loss: 2.191 Vali Acc: 0.327 Test Loss: 2.191 Test Acc: 0.327
Validation loss decreased (-0.324390 --> -0.327229).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5517873
	speed: 0.1598s/iter; left time: 2322.0653s
Epoch: 6 cost time: 6.288219213485718
Epoch: 6, Steps: 154 | Train Loss: 1.831 Vali Loss: 2.197 Vali Acc: 0.325 Test Loss: 2.197 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9123375
	speed: 0.1741s/iter; left time: 2503.3488s
Epoch: 7 cost time: 6.1497979164123535
Epoch: 7, Steps: 154 | Train Loss: 1.798 Vali Loss: 2.210 Vali Acc: 0.332 Test Loss: 2.210 Test Acc: 0.332
Validation loss decreased (-0.327229 --> -0.331689).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9583486
	speed: 0.1758s/iter; left time: 2501.0532s
Epoch: 8 cost time: 6.04054069519043
Epoch: 8, Steps: 154 | Train Loss: 1.812 Vali Loss: 2.299 Vali Acc: 0.331 Test Loss: 2.299 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3518974
	speed: 0.1761s/iter; left time: 2477.8061s
Epoch: 9 cost time: 6.416590213775635
Epoch: 9, Steps: 154 | Train Loss: 1.715 Vali Loss: 2.287 Vali Acc: 0.343 Test Loss: 2.287 Test Acc: 0.343
Validation loss decreased (-0.331689 --> -0.343043).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6726615
	speed: 0.1671s/iter; left time: 2324.5575s
Epoch: 10 cost time: 5.906000137329102
Epoch: 10, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.315 Vali Acc: 0.350 Test Loss: 2.315 Test Acc: 0.350
Validation loss decreased (-0.343043 --> -0.350342).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7107338
	speed: 0.1601s/iter; left time: 2203.4733s
Epoch: 11 cost time: 6.069592237472534
Epoch: 11, Steps: 154 | Train Loss: 1.753 Vali Loss: 2.310 Vali Acc: 0.347 Test Loss: 2.310 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8532513
	speed: 0.1607s/iter; left time: 2186.6286s
Epoch: 12 cost time: 6.097474098205566
Epoch: 12, Steps: 154 | Train Loss: 1.660 Vali Loss: 2.426 Vali Acc: 0.348 Test Loss: 2.426 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.0364950
	speed: 0.1576s/iter; left time: 2120.8220s
Epoch: 13 cost time: 6.598649263381958
Epoch: 13, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.406 Vali Acc: 0.356 Test Loss: 2.406 Test Acc: 0.356
Validation loss decreased (-0.350342 --> -0.356424).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6358670
	speed: 0.1580s/iter; left time: 2101.5375s
Epoch: 14 cost time: 6.081049203872681
Epoch: 14, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.484 Vali Acc: 0.348 Test Loss: 2.484 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.0335207
	speed: 0.1604s/iter; left time: 2108.2932s
Epoch: 15 cost time: 6.0680787563323975
Epoch: 15, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.773 Vali Acc: 0.107 Test Loss: 2.773 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.2958872
	speed: 0.1726s/iter; left time: 2241.7951s
Epoch: 16 cost time: 6.782732009887695
Epoch: 16, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.384 Vali Acc: 0.361 Test Loss: 2.384 Test Acc: 0.361
Validation loss decreased (-0.356424 --> -0.360885).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.8972409
	speed: 0.1740s/iter; left time: 2234.1835s
Epoch: 17 cost time: 6.203356981277466
Epoch: 17, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.585 Vali Acc: 0.341 Test Loss: 2.585 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.4924003
	speed: 0.1678s/iter; left time: 2128.1580s
Epoch: 18 cost time: 5.7372658252716064
Epoch: 18, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.551 Vali Acc: 0.368 Test Loss: 2.551 Test Acc: 0.368
Validation loss decreased (-0.360885 --> -0.368182).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.5319088
	speed: 0.1660s/iter; left time: 2080.1600s
Epoch: 19 cost time: 5.906132698059082
Epoch: 19, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.625 Vali Acc: 0.364 Test Loss: 2.625 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.4933531
	speed: 0.1617s/iter; left time: 2001.1454s
Epoch: 20 cost time: 6.130688667297363
Epoch: 20, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.550 Vali Acc: 0.204 Test Loss: 2.550 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 3.2327263
	speed: 0.1606s/iter; left time: 1963.0816s
Epoch: 21 cost time: 6.117553949356079
Epoch: 21, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.716 Vali Acc: 0.351 Test Loss: 2.716 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.7463995
	speed: 0.1593s/iter; left time: 1922.5027s
Epoch: 22 cost time: 5.990342617034912
Epoch: 22, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.676 Vali Acc: 0.344 Test Loss: 2.676 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.0328525
	speed: 0.1610s/iter; left time: 1917.4575s
Epoch: 23 cost time: 5.860771894454956
Epoch: 23, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.988 Vali Acc: 0.097 Test Loss: 2.988 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.8774927
	speed: 0.1663s/iter; left time: 1955.6828s
Epoch: 24 cost time: 6.676391839981079
Epoch: 24, Steps: 154 | Train Loss: 1.340 Vali Loss: 2.988 Vali Acc: 0.208 Test Loss: 2.988 Test Acc: 0.208
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.8239004
	speed: 0.1839s/iter; left time: 2134.1046s
Epoch: 25 cost time: 6.450337886810303
Epoch: 25, Steps: 154 | Train Loss: 1.390 Vali Loss: 2.880 Vali Acc: 0.374 Test Loss: 2.880 Test Acc: 0.374
Validation loss decreased (-0.368182 --> -0.374262).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.4391322
	speed: 0.1692s/iter; left time: 1937.2611s
Epoch: 26 cost time: 6.092118501663208
Epoch: 26, Steps: 154 | Train Loss: 1.464 Vali Loss: 3.663 Vali Acc: 0.333 Test Loss: 3.663 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.8279170
	speed: 0.1750s/iter; left time: 1976.6827s
Epoch: 27 cost time: 5.992569446563721
Epoch: 27, Steps: 154 | Train Loss: 1.250 Vali Loss: 4.033 Vali Acc: 0.082 Test Loss: 4.033 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.2250785
	speed: 0.1595s/iter; left time: 1777.2478s
Epoch: 28 cost time: 6.412450551986694
Epoch: 28, Steps: 154 | Train Loss: 1.329 Vali Loss: 3.456 Vali Acc: 0.340 Test Loss: 3.456 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.0553861
	speed: 0.1579s/iter; left time: 1735.6238s
Epoch: 29 cost time: 6.4436023235321045
Epoch: 29, Steps: 154 | Train Loss: 1.420 Vali Loss: 3.274 Vali Acc: 0.190 Test Loss: 3.274 Test Acc: 0.190
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.4606061
	speed: 0.1588s/iter; left time: 1720.2609s
Epoch: 30 cost time: 6.193441152572632
Epoch: 30, Steps: 154 | Train Loss: 1.245 Vali Loss: 3.253 Vali Acc: 0.212 Test Loss: 3.253 Test Acc: 0.212
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 1.8314934
	speed: 0.1595s/iter; left time: 1704.0036s
Epoch: 31 cost time: 5.962789058685303
Epoch: 31, Steps: 154 | Train Loss: 1.344 Vali Loss: 3.128 Vali Acc: 0.345 Test Loss: 3.128 Test Acc: 0.345
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 1.8838016
	speed: 0.1550s/iter; left time: 1631.2018s
Epoch: 32 cost time: 6.473417520523071
Epoch: 32, Steps: 154 | Train Loss: 1.263 Vali Loss: 3.255 Vali Acc: 0.203 Test Loss: 3.255 Test Acc: 0.203
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 1.0563865
	speed: 0.1681s/iter; left time: 1743.9365s
Epoch: 33 cost time: 6.090878486633301
Epoch: 33, Steps: 154 | Train Loss: 1.346 Vali Loss: 3.399 Vali Acc: 0.226 Test Loss: 3.399 Test Acc: 0.226
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 1.0886745
	speed: 0.1688s/iter; left time: 1725.1586s
Epoch: 34 cost time: 5.83787727355957
Epoch: 34, Steps: 154 | Train Loss: 1.182 Vali Loss: 4.100 Vali Acc: 0.199 Test Loss: 4.100 Test Acc: 0.199
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.8191019
	speed: 0.1802s/iter; left time: 1813.4229s
Epoch: 35 cost time: 6.320067405700684
Epoch: 35, Steps: 154 | Train Loss: 1.470 Vali Loss: 4.124 Vali Acc: 0.385 Test Loss: 4.124 Test Acc: 0.385
Validation loss decreased (-0.374262 --> -0.384793).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.8962520
	speed: 0.1734s/iter; left time: 1718.7886s
Epoch: 36 cost time: 6.18041729927063
Epoch: 36, Steps: 154 | Train Loss: 1.382 Vali Loss: 4.467 Vali Acc: 0.087 Test Loss: 4.467 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 1.1340952
	speed: 0.1586s/iter; left time: 1547.0984s
Epoch: 37 cost time: 6.05856728553772
Epoch: 37, Steps: 154 | Train Loss: 1.354 Vali Loss: 3.689 Vali Acc: 0.113 Test Loss: 3.689 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.7535712
	speed: 0.1612s/iter; left time: 1548.2089s
Epoch: 38 cost time: 5.932583570480347
Epoch: 38, Steps: 154 | Train Loss: 1.177 Vali Loss: 4.048 Vali Acc: 0.083 Test Loss: 4.048 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.8281025
	speed: 0.1637s/iter; left time: 1546.4153s
Epoch: 39 cost time: 6.256313323974609
Epoch: 39, Steps: 154 | Train Loss: 1.253 Vali Loss: 3.475 Vali Acc: 0.187 Test Loss: 3.475 Test Acc: 0.187
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.9228561
	speed: 0.1644s/iter; left time: 1528.3494s
Epoch: 40 cost time: 6.531275749206543
Epoch: 40, Steps: 154 | Train Loss: 1.276 Vali Loss: 4.056 Vali Acc: 0.134 Test Loss: 4.056 Test Acc: 0.134
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 1.2294701
	speed: 0.1628s/iter; left time: 1488.4227s
Epoch: 41 cost time: 6.2145795822143555
Epoch: 41, Steps: 154 | Train Loss: 1.138 Vali Loss: 3.779 Vali Acc: 0.200 Test Loss: 3.779 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 1.7210028
	speed: 0.1792s/iter; left time: 1610.2143s
Epoch: 42 cost time: 6.38503360748291
Epoch: 42, Steps: 154 | Train Loss: 1.135 Vali Loss: 3.453 Vali Acc: 0.092 Test Loss: 3.453 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.9403433
	speed: 0.1784s/iter; left time: 1575.7556s
Epoch: 43 cost time: 6.713122844696045
Epoch: 43, Steps: 154 | Train Loss: 1.270 Vali Loss: 4.443 Vali Acc: 0.179 Test Loss: 4.443 Test Acc: 0.179
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 1.3578705
	speed: 0.1737s/iter; left time: 1507.8189s
Epoch: 44 cost time: 6.089702844619751
Epoch: 44, Steps: 154 | Train Loss: 1.572 Vali Loss: 4.083 Vali Acc: 0.097 Test Loss: 4.083 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 1.1830759
	speed: 0.1559s/iter; left time: 1328.9951s
Epoch: 45 cost time: 6.1202874183654785
Epoch: 45, Steps: 154 | Train Loss: 1.179 Vali Loss: 3.744 Vali Acc: 0.205 Test Loss: 3.744 Test Acc: 0.205
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3848337388483374
model parameter : 168246
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6364841
	speed: 0.0592s/iter; left time: 905.0848s
Epoch: 1 cost time: 7.937592029571533
Epoch: 1, Steps: 154 | Train Loss: 2.242 Vali Loss: 2.188 Vali Acc: 0.318 Test Loss: 2.188 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0910029
	speed: 0.1602s/iter; left time: 2425.8791s
Epoch: 2 cost time: 6.253845930099487
Epoch: 2, Steps: 154 | Train Loss: 2.063 Vali Loss: 2.188 Vali Acc: 0.322 Test Loss: 2.188 Test Acc: 0.322
Validation loss decreased (-0.317902 --> -0.322363).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9337288
	speed: 0.1593s/iter; left time: 2387.9298s
Epoch: 3 cost time: 5.647541046142578
Epoch: 3, Steps: 154 | Train Loss: 1.988 Vali Loss: 2.186 Vali Acc: 0.322 Test Loss: 2.186 Test Acc: 0.322
Validation loss decreased (-0.322363 --> -0.322363).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9804425
	speed: 0.1738s/iter; left time: 2579.2239s
Epoch: 4 cost time: 6.197786092758179
Epoch: 4, Steps: 154 | Train Loss: 1.921 Vali Loss: 2.192 Vali Acc: 0.324 Test Loss: 2.192 Test Acc: 0.324
Validation loss decreased (-0.322363 --> -0.324390).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6863655
	speed: 0.1744s/iter; left time: 2560.4381s
Epoch: 5 cost time: 6.079923868179321
Epoch: 5, Steps: 154 | Train Loss: 1.896 Vali Loss: 2.175 Vali Acc: 0.326 Test Loss: 2.175 Test Acc: 0.326
Validation loss decreased (-0.324390 --> -0.326012).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4895582
	speed: 0.1829s/iter; left time: 2657.7846s
Epoch: 6 cost time: 6.100929021835327
Epoch: 6, Steps: 154 | Train Loss: 1.831 Vali Loss: 2.162 Vali Acc: 0.328 Test Loss: 2.162 Test Acc: 0.328
Validation loss decreased (-0.326012 --> -0.328446).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9024017
	speed: 0.1464s/iter; left time: 2104.8545s
Epoch: 7 cost time: 5.357881784439087
Epoch: 7, Steps: 154 | Train Loss: 1.781 Vali Loss: 2.191 Vali Acc: 0.330 Test Loss: 2.191 Test Acc: 0.330
Validation loss decreased (-0.328446 --> -0.330473).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9892236
	speed: 0.1559s/iter; left time: 2217.0082s
Epoch: 8 cost time: 5.793509244918823
Epoch: 8, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.230 Vali Acc: 0.336 Test Loss: 2.230 Test Acc: 0.336
Validation loss decreased (-0.330473 --> -0.335744).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3160654
	speed: 0.1607s/iter; left time: 2260.9763s
Epoch: 9 cost time: 6.217933893203735
Epoch: 9, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.246 Vali Acc: 0.343 Test Loss: 2.246 Test Acc: 0.343
Validation loss decreased (-0.335744 --> -0.342638).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5776536
	speed: 0.1653s/iter; left time: 2299.6771s
Epoch: 10 cost time: 6.47220778465271
Epoch: 10, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.248 Vali Acc: 0.347 Test Loss: 2.248 Test Acc: 0.347
Validation loss decreased (-0.342638 --> -0.346693).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7470042
	speed: 0.1611s/iter; left time: 2216.4323s
Epoch: 11 cost time: 5.930095672607422
Epoch: 11, Steps: 154 | Train Loss: 1.681 Vali Loss: 2.322 Vali Acc: 0.343 Test Loss: 2.322 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9195838
	speed: 0.1564s/iter; left time: 2128.1282s
Epoch: 12 cost time: 5.745478868484497
Epoch: 12, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.398 Vali Acc: 0.349 Test Loss: 2.398 Test Acc: 0.349
Validation loss decreased (-0.346693 --> -0.348719).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.0767016
	speed: 0.1764s/iter; left time: 2373.1884s
Epoch: 13 cost time: 6.434261083602905
Epoch: 13, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.394 Vali Acc: 0.354 Test Loss: 2.394 Test Acc: 0.354
Validation loss decreased (-0.348719 --> -0.353991).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5354580
	speed: 0.1726s/iter; left time: 2295.5965s
Epoch: 14 cost time: 6.727862119674683
Epoch: 14, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.431 Vali Acc: 0.346 Test Loss: 2.431 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9125339
	speed: 0.1697s/iter; left time: 2230.1002s
Epoch: 15 cost time: 5.684458255767822
Epoch: 15, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.736 Vali Acc: 0.205 Test Loss: 2.736 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.2129619
	speed: 0.1580s/iter; left time: 2052.7624s
Epoch: 16 cost time: 5.917582035064697
Epoch: 16, Steps: 154 | Train Loss: 1.578 Vali Loss: 2.290 Vali Acc: 0.363 Test Loss: 2.290 Test Acc: 0.363
Validation loss decreased (-0.353991 --> -0.362508).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.9113505
	speed: 0.1567s/iter; left time: 2011.1048s
Epoch: 17 cost time: 5.871492862701416
Epoch: 17, Steps: 154 | Train Loss: 1.538 Vali Loss: 2.692 Vali Acc: 0.199 Test Loss: 2.692 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.6169358
	speed: 0.1575s/iter; left time: 1997.9394s
Epoch: 18 cost time: 6.297532081604004
Epoch: 18, Steps: 154 | Train Loss: 1.401 Vali Loss: 2.550 Vali Acc: 0.373 Test Loss: 2.550 Test Acc: 0.373
Validation loss decreased (-0.362508 --> -0.373454).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.4532473
	speed: 0.1565s/iter; left time: 1960.2554s
Epoch: 19 cost time: 5.768998146057129
Epoch: 19, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.601 Vali Acc: 0.215 Test Loss: 2.601 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.5429571
	speed: 0.1571s/iter; left time: 1943.9535s
Epoch: 20 cost time: 6.211559772491455
Epoch: 20, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.876 Vali Acc: 0.199 Test Loss: 2.876 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.4120764
	speed: 0.1734s/iter; left time: 2118.6188s
Epoch: 21 cost time: 5.943481922149658
Epoch: 21, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.674 Vali Acc: 0.373 Test Loss: 2.674 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.8180871
	speed: 0.1728s/iter; left time: 2085.1693s
Epoch: 22 cost time: 6.280143737792969
Epoch: 22, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.772 Vali Acc: 0.380 Test Loss: 2.772 Test Acc: 0.380
Validation loss decreased (-0.373454 --> -0.379940).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.8867465
	speed: 0.1744s/iter; left time: 2077.9730s
Epoch: 23 cost time: 6.463271856307983
Epoch: 23, Steps: 154 | Train Loss: 1.411 Vali Loss: 2.983 Vali Acc: 0.206 Test Loss: 2.983 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.9395506
	speed: 0.1565s/iter; left time: 1839.9354s
Epoch: 24 cost time: 5.848101854324341
Epoch: 24, Steps: 154 | Train Loss: 1.304 Vali Loss: 2.984 Vali Acc: 0.200 Test Loss: 2.984 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.8591045
	speed: 0.1612s/iter; left time: 1870.4610s
Epoch: 25 cost time: 6.174354553222656
Epoch: 25, Steps: 154 | Train Loss: 1.400 Vali Loss: 3.088 Vali Acc: 0.372 Test Loss: 3.088 Test Acc: 0.372
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.4768041
	speed: 0.1649s/iter; left time: 1887.9430s
Epoch: 26 cost time: 6.321289539337158
Epoch: 26, Steps: 154 | Train Loss: 1.610 Vali Loss: 3.124 Vali Acc: 0.276 Test Loss: 3.124 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.9585143
	speed: 0.1592s/iter; left time: 1798.0284s
Epoch: 27 cost time: 6.261922597885132
Epoch: 27, Steps: 154 | Train Loss: 1.324 Vali Loss: 3.695 Vali Acc: 0.110 Test Loss: 3.695 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 1.0087912
	speed: 0.1618s/iter; left time: 1802.5752s
Epoch: 28 cost time: 6.062394380569458
Epoch: 28, Steps: 154 | Train Loss: 1.343 Vali Loss: 3.443 Vali Acc: 0.195 Test Loss: 3.443 Test Acc: 0.195
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.8724543
	speed: 0.1714s/iter; left time: 1883.9047s
Epoch: 29 cost time: 6.0397560596466064
Epoch: 29, Steps: 154 | Train Loss: 1.247 Vali Loss: 3.338 Vali Acc: 0.201 Test Loss: 3.338 Test Acc: 0.201
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.5759872
	speed: 0.1691s/iter; left time: 1832.2968s
Epoch: 30 cost time: 5.882475137710571
Epoch: 30, Steps: 154 | Train Loss: 1.351 Vali Loss: 3.394 Vali Acc: 0.215 Test Loss: 3.394 Test Acc: 0.215
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 1.4239683
	speed: 0.1773s/iter; left time: 1893.4766s
Epoch: 31 cost time: 6.523059606552124
Epoch: 31, Steps: 154 | Train Loss: 1.387 Vali Loss: 3.206 Vali Acc: 0.380 Test Loss: 3.206 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 1.5042868
	speed: 0.1634s/iter; left time: 1719.8167s
Epoch: 32 cost time: 5.689325571060181
Epoch: 32, Steps: 154 | Train Loss: 1.217 Vali Loss: 3.471 Vali Acc: 0.206 Test Loss: 3.471 Test Acc: 0.206
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 168246
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6428009
	speed: 0.0548s/iter; left time: 838.3624s
Epoch: 1 cost time: 7.450924396514893
Epoch: 1, Steps: 154 | Train Loss: 2.236 Vali Loss: 2.174 Vali Acc: 0.316 Test Loss: 2.174 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1068332
	speed: 0.1560s/iter; left time: 2362.2840s
Epoch: 2 cost time: 6.13690447807312
Epoch: 2, Steps: 154 | Train Loss: 2.073 Vali Loss: 2.181 Vali Acc: 0.323 Test Loss: 2.181 Test Acc: 0.323
Validation loss decreased (-0.316280 --> -0.323174).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9494886
	speed: 0.1533s/iter; left time: 2299.0490s
Epoch: 3 cost time: 5.869800329208374
Epoch: 3, Steps: 154 | Train Loss: 1.984 Vali Loss: 2.176 Vali Acc: 0.322 Test Loss: 2.176 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.0204337
	speed: 0.1541s/iter; left time: 2286.8959s
Epoch: 4 cost time: 5.957709789276123
Epoch: 4, Steps: 154 | Train Loss: 1.906 Vali Loss: 2.161 Vali Acc: 0.326 Test Loss: 2.161 Test Acc: 0.326
Validation loss decreased (-0.323174 --> -0.326418).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6578069
	speed: 0.1721s/iter; left time: 2527.2297s
Epoch: 5 cost time: 6.419585704803467
Epoch: 5, Steps: 154 | Train Loss: 1.909 Vali Loss: 2.178 Vali Acc: 0.328 Test Loss: 2.178 Test Acc: 0.328
Validation loss decreased (-0.326418 --> -0.327634).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5838892
	speed: 0.1657s/iter; left time: 2408.3897s
Epoch: 6 cost time: 6.150184869766235
Epoch: 6, Steps: 154 | Train Loss: 1.820 Vali Loss: 2.177 Vali Acc: 0.333 Test Loss: 2.177 Test Acc: 0.333
Validation loss decreased (-0.327634 --> -0.332501).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8752867
	speed: 0.1775s/iter; left time: 2552.4021s
Epoch: 7 cost time: 5.735581159591675
Epoch: 7, Steps: 154 | Train Loss: 1.797 Vali Loss: 2.179 Vali Acc: 0.335 Test Loss: 2.179 Test Acc: 0.335
Validation loss decreased (-0.332501 --> -0.334528).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0068328
	speed: 0.1726s/iter; left time: 2454.7827s
Epoch: 8 cost time: 7.19771671295166
Epoch: 8, Steps: 154 | Train Loss: 1.773 Vali Loss: 2.208 Vali Acc: 0.335 Test Loss: 2.208 Test Acc: 0.335
Validation loss decreased (-0.334528 --> -0.334933).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3037000
	speed: 0.1533s/iter; left time: 2156.8486s
Epoch: 9 cost time: 4.555379152297974
Epoch: 9, Steps: 154 | Train Loss: 1.715 Vali Loss: 2.299 Vali Acc: 0.343 Test Loss: 2.299 Test Acc: 0.343
Validation loss decreased (-0.334933 --> -0.342637).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5464264
	speed: 0.1163s/iter; left time: 1618.4402s
Epoch: 10 cost time: 5.0653698444366455
Epoch: 10, Steps: 154 | Train Loss: 1.701 Vali Loss: 2.339 Vali Acc: 0.352 Test Loss: 2.339 Test Acc: 0.352
Validation loss decreased (-0.342637 --> -0.352369).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7671415
	speed: 0.1482s/iter; left time: 2039.2972s
Epoch: 11 cost time: 5.459479570388794
Epoch: 11, Steps: 154 | Train Loss: 1.754 Vali Loss: 2.301 Vali Acc: 0.354 Test Loss: 2.301 Test Acc: 0.354
Validation loss decreased (-0.352369 --> -0.353586).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8974974
	speed: 0.1533s/iter; left time: 2086.6121s
Epoch: 12 cost time: 5.427456378936768
Epoch: 12, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.513 Vali Acc: 0.348 Test Loss: 2.513 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.2101030
	speed: 0.1466s/iter; left time: 1971.9728s
Epoch: 13 cost time: 6.029468536376953
Epoch: 13, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.489 Vali Acc: 0.354 Test Loss: 2.489 Test Acc: 0.354
Validation loss decreased (-0.353586 --> -0.353990).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5973544
	speed: 0.1466s/iter; left time: 1948.9869s
Epoch: 14 cost time: 5.362038850784302
Epoch: 14, Steps: 154 | Train Loss: 1.661 Vali Loss: 2.624 Vali Acc: 0.352 Test Loss: 2.624 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9535486
	speed: 0.1475s/iter; left time: 1938.4368s
Epoch: 15 cost time: 5.528501749038696
Epoch: 15, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.906 Vali Acc: 0.210 Test Loss: 2.906 Test Acc: 0.210
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.1436070
	speed: 0.1609s/iter; left time: 2089.8687s
Epoch: 16 cost time: 5.820905685424805
Epoch: 16, Steps: 154 | Train Loss: 1.645 Vali Loss: 2.625 Vali Acc: 0.355 Test Loss: 2.625 Test Acc: 0.355
Validation loss decreased (-0.353990 --> -0.354799).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.9268258
	speed: 0.1613s/iter; left time: 2070.0449s
Epoch: 17 cost time: 5.87207818031311
Epoch: 17, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.759 Vali Acc: 0.208 Test Loss: 2.759 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.6975671
	speed: 0.1574s/iter; left time: 1995.6743s
Epoch: 18 cost time: 5.247112274169922
Epoch: 18, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.642 Vali Acc: 0.363 Test Loss: 2.642 Test Acc: 0.363
Validation loss decreased (-0.354799 --> -0.362504).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.3398401
	speed: 0.1421s/iter; left time: 1780.4508s
Epoch: 19 cost time: 5.287939548492432
Epoch: 19, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.706 Vali Acc: 0.372 Test Loss: 2.706 Test Acc: 0.372
Validation loss decreased (-0.362504 --> -0.371830).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.2011429
	speed: 0.1492s/iter; left time: 1846.4801s
Epoch: 20 cost time: 5.911803722381592
Epoch: 20, Steps: 154 | Train Loss: 1.408 Vali Loss: 3.000 Vali Acc: 0.209 Test Loss: 3.000 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.4399800
	speed: 0.1465s/iter; left time: 1790.5243s
Epoch: 21 cost time: 6.084214448928833
Epoch: 21, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.827 Vali Acc: 0.217 Test Loss: 2.827 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.7762115
	speed: 0.1462s/iter; left time: 1764.5686s
Epoch: 22 cost time: 5.331972599029541
Epoch: 22, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.843 Vali Acc: 0.363 Test Loss: 2.843 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.7668033
	speed: 0.1459s/iter; left time: 1737.8225s
Epoch: 23 cost time: 5.603354454040527
Epoch: 23, Steps: 154 | Train Loss: 1.471 Vali Loss: 3.243 Vali Acc: 0.209 Test Loss: 3.243 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.8487223
	speed: 0.1632s/iter; left time: 1919.3426s
Epoch: 24 cost time: 6.12446928024292
Epoch: 24, Steps: 154 | Train Loss: 1.396 Vali Loss: 3.074 Vali Acc: 0.210 Test Loss: 3.074 Test Acc: 0.210
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.7222718
	speed: 0.1643s/iter; left time: 1906.9647s
Epoch: 25 cost time: 6.083268880844116
Epoch: 25, Steps: 154 | Train Loss: 1.430 Vali Loss: 3.106 Vali Acc: 0.365 Test Loss: 3.106 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.4104401
	speed: 0.1662s/iter; left time: 1903.5399s
Epoch: 26 cost time: 5.523554563522339
Epoch: 26, Steps: 154 | Train Loss: 1.368 Vali Loss: 3.104 Vali Acc: 0.375 Test Loss: 3.104 Test Acc: 0.375
Validation loss decreased (-0.371830 --> -0.375070).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.7669472
	speed: 0.1466s/iter; left time: 1655.8617s
Epoch: 27 cost time: 5.303669214248657
Epoch: 27, Steps: 154 | Train Loss: 1.243 Vali Loss: 3.537 Vali Acc: 0.325 Test Loss: 3.537 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.8633354
	speed: 0.1460s/iter; left time: 1627.4306s
Epoch: 28 cost time: 6.0475382804870605
Epoch: 28, Steps: 154 | Train Loss: 1.297 Vali Loss: 3.526 Vali Acc: 0.282 Test Loss: 3.526 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.0395695
	speed: 0.1497s/iter; left time: 1645.3787s
Epoch: 29 cost time: 5.39966082572937
Epoch: 29, Steps: 154 | Train Loss: 1.279 Vali Loss: 3.299 Vali Acc: 0.213 Test Loss: 3.299 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.5071036
	speed: 0.1498s/iter; left time: 1623.4248s
Epoch: 30 cost time: 5.43904709815979
Epoch: 30, Steps: 154 | Train Loss: 1.258 Vali Loss: 3.558 Vali Acc: 0.217 Test Loss: 3.558 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 1.1696501
	speed: 0.1470s/iter; left time: 1569.7682s
Epoch: 31 cost time: 5.708508491516113
Epoch: 31, Steps: 154 | Train Loss: 1.299 Vali Loss: 3.381 Vali Acc: 0.381 Test Loss: 3.381 Test Acc: 0.381
Validation loss decreased (-0.375070 --> -0.380745).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.7203989
	speed: 0.1603s/iter; left time: 1687.4116s
Epoch: 32 cost time: 5.792831897735596
Epoch: 32, Steps: 154 | Train Loss: 1.396 Vali Loss: 3.457 Vali Acc: 0.208 Test Loss: 3.457 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.8114485
	speed: 0.1577s/iter; left time: 1635.3918s
Epoch: 33 cost time: 5.664719104766846
Epoch: 33, Steps: 154 | Train Loss: 1.220 Vali Loss: 3.643 Vali Acc: 0.209 Test Loss: 3.643 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 1.2869331
	speed: 0.1559s/iter; left time: 1593.5010s
Epoch: 34 cost time: 5.368441343307495
Epoch: 34, Steps: 154 | Train Loss: 1.154 Vali Loss: 4.044 Vali Acc: 0.208 Test Loss: 4.044 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 1.7377598
	speed: 0.1478s/iter; left time: 1487.5609s
Epoch: 35 cost time: 5.808099746704102
Epoch: 35, Steps: 154 | Train Loss: 1.165 Vali Loss: 4.034 Vali Acc: 0.379 Test Loss: 4.034 Test Acc: 0.379
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.9354806
	speed: 0.1441s/iter; left time: 1428.3517s
Epoch: 36 cost time: 5.847564220428467
Epoch: 36, Steps: 154 | Train Loss: 1.675 Vali Loss: 4.123 Vali Acc: 0.232 Test Loss: 4.123 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 1.1985941
	speed: 0.1489s/iter; left time: 1452.4017s
Epoch: 37 cost time: 5.430438995361328
Epoch: 37, Steps: 154 | Train Loss: 1.204 Vali Loss: 4.350 Vali Acc: 0.218 Test Loss: 4.350 Test Acc: 0.218
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 1.0686723
	speed: 0.1325s/iter; left time: 1272.0981s
Epoch: 38 cost time: 4.972385406494141
Epoch: 38, Steps: 154 | Train Loss: 1.320 Vali Loss: 4.040 Vali Acc: 0.093 Test Loss: 4.040 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 5.6736460
	speed: 0.1319s/iter; left time: 1246.0706s
Epoch: 39 cost time: 6.121169328689575
Epoch: 39, Steps: 154 | Train Loss: 1.271 Vali Loss: 4.097 Vali Acc: 0.208 Test Loss: 4.097 Test Acc: 0.208
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.8367789
	speed: 0.1608s/iter; left time: 1494.2356s
Epoch: 40 cost time: 5.621170520782471
Epoch: 40, Steps: 154 | Train Loss: 1.104 Vali Loss: 4.459 Vali Acc: 0.213 Test Loss: 4.459 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 1.4053720
	speed: 0.1568s/iter; left time: 1432.9810s
Epoch: 41 cost time: 5.925260066986084
Epoch: 41, Steps: 154 | Train Loss: 1.067 Vali Loss: 3.721 Vali Acc: 0.221 Test Loss: 3.721 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38077858880778587
model parameter : 168246
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6503146
	speed: 0.0521s/iter; left time: 796.9057s
Epoch: 1 cost time: 7.018467426300049
Epoch: 1, Steps: 154 | Train Loss: 2.228 Vali Loss: 2.178 Vali Acc: 0.317 Test Loss: 2.178 Test Acc: 0.317
Validation loss decreased (inf --> -0.316685).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1035748
	speed: 0.1484s/iter; left time: 2248.2296s
Epoch: 2 cost time: 5.334744930267334
Epoch: 2, Steps: 154 | Train Loss: 2.065 Vali Loss: 2.175 Vali Acc: 0.320 Test Loss: 2.175 Test Acc: 0.320
Validation loss decreased (-0.316685 --> -0.320335).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9362825
	speed: 0.1488s/iter; left time: 2231.2818s
Epoch: 3 cost time: 5.188680171966553
Epoch: 3, Steps: 154 | Train Loss: 1.990 Vali Loss: 2.156 Vali Acc: 0.322 Test Loss: 2.156 Test Acc: 0.322
Validation loss decreased (-0.320335 --> -0.321552).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1221561
	speed: 0.1362s/iter; left time: 2021.2487s
Epoch: 4 cost time: 4.7795515060424805
Epoch: 4, Steps: 154 | Train Loss: 1.914 Vali Loss: 2.156 Vali Acc: 0.327 Test Loss: 2.156 Test Acc: 0.327
Validation loss decreased (-0.321552 --> -0.327229).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6622045
	speed: 0.1472s/iter; left time: 2162.2610s
Epoch: 5 cost time: 5.5742409229278564
Epoch: 5, Steps: 154 | Train Loss: 1.929 Vali Loss: 2.163 Vali Acc: 0.327 Test Loss: 2.163 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5440884
	speed: 0.1599s/iter; left time: 2323.5512s
Epoch: 6 cost time: 5.4944374561309814
Epoch: 6, Steps: 154 | Train Loss: 1.827 Vali Loss: 2.156 Vali Acc: 0.336 Test Loss: 2.156 Test Acc: 0.336
Validation loss decreased (-0.327229 --> -0.335745).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0583916
	speed: 0.1542s/iter; left time: 2217.2562s
Epoch: 7 cost time: 5.432467222213745
Epoch: 7, Steps: 154 | Train Loss: 1.806 Vali Loss: 2.155 Vali Acc: 0.339 Test Loss: 2.155 Test Acc: 0.339
Validation loss decreased (-0.335745 --> -0.338989).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9566028
	speed: 0.1538s/iter; left time: 2186.9180s
Epoch: 8 cost time: 4.9974751472473145
Epoch: 8, Steps: 154 | Train Loss: 1.812 Vali Loss: 2.223 Vali Acc: 0.343 Test Loss: 2.223 Test Acc: 0.343
Validation loss decreased (-0.338989 --> -0.342638).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.2753377
	speed: 0.1399s/iter; left time: 1968.4238s
Epoch: 9 cost time: 5.416226625442505
Epoch: 9, Steps: 154 | Train Loss: 1.701 Vali Loss: 2.305 Vali Acc: 0.344 Test Loss: 2.305 Test Acc: 0.344
Validation loss decreased (-0.342638 --> -0.344259).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3911074
	speed: 0.1379s/iter; left time: 1918.8494s
Epoch: 10 cost time: 5.121356964111328
Epoch: 10, Steps: 154 | Train Loss: 1.737 Vali Loss: 2.304 Vali Acc: 0.345 Test Loss: 2.304 Test Acc: 0.345
Validation loss decreased (-0.344259 --> -0.345476).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7405189
	speed: 0.1381s/iter; left time: 1901.0584s
Epoch: 11 cost time: 5.040569305419922
Epoch: 11, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.273 Vali Acc: 0.347 Test Loss: 2.273 Test Acc: 0.347
Validation loss decreased (-0.345476 --> -0.347098).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7175725
	speed: 0.1404s/iter; left time: 1909.8641s
Epoch: 12 cost time: 5.368189096450806
Epoch: 12, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.382 Vali Acc: 0.351 Test Loss: 2.382 Test Acc: 0.351
Validation loss decreased (-0.347098 --> -0.351152).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.1616912
	speed: 0.1406s/iter; left time: 1891.7051s
Epoch: 13 cost time: 5.504529714584351
Epoch: 13, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.500 Vali Acc: 0.356 Test Loss: 2.500 Test Acc: 0.356
Validation loss decreased (-0.351152 --> -0.356423).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.7114675
	speed: 0.1512s/iter; left time: 2011.4529s
Epoch: 14 cost time: 5.409543991088867
Epoch: 14, Steps: 154 | Train Loss: 1.660 Vali Loss: 2.521 Vali Acc: 0.352 Test Loss: 2.521 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1652696
	speed: 0.1507s/iter; left time: 1980.4200s
Epoch: 15 cost time: 5.396624565124512
Epoch: 15, Steps: 154 | Train Loss: 1.542 Vali Loss: 2.666 Vali Acc: 0.361 Test Loss: 2.666 Test Acc: 0.361
Validation loss decreased (-0.356423 --> -0.360476).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.1963938
	speed: 0.1568s/iter; left time: 2036.5668s
Epoch: 16 cost time: 5.446341276168823
Epoch: 16, Steps: 154 | Train Loss: 1.644 Vali Loss: 2.574 Vali Acc: 0.360 Test Loss: 2.574 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.8763450
	speed: 0.1373s/iter; left time: 1762.1298s
Epoch: 17 cost time: 5.122056007385254
Epoch: 17, Steps: 154 | Train Loss: 1.612 Vali Loss: 2.750 Vali Acc: 0.363 Test Loss: 2.750 Test Acc: 0.363
Validation loss decreased (-0.360476 --> -0.363314).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.7369788
	speed: 0.1462s/iter; left time: 1853.9088s
Epoch: 18 cost time: 5.143216609954834
Epoch: 18, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.620 Vali Acc: 0.365 Test Loss: 2.620 Test Acc: 0.365
Validation loss decreased (-0.363314 --> -0.364937).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.8331296
	speed: 0.1430s/iter; left time: 1791.3938s
Epoch: 19 cost time: 5.0697925090789795
Epoch: 19, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.779 Vali Acc: 0.367 Test Loss: 2.779 Test Acc: 0.367
Validation loss decreased (-0.364937 --> -0.367369).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.5854099
	speed: 0.1400s/iter; left time: 1732.2629s
Epoch: 20 cost time: 5.513185024261475
Epoch: 20, Steps: 154 | Train Loss: 1.473 Vali Loss: 2.831 Vali Acc: 0.241 Test Loss: 2.831 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.4562360
	speed: 0.1471s/iter; left time: 1797.9546s
Epoch: 21 cost time: 5.225844621658325
Epoch: 21, Steps: 154 | Train Loss: 1.442 Vali Loss: 3.045 Vali Acc: 0.372 Test Loss: 3.045 Test Acc: 0.372
Validation loss decreased (-0.367369 --> -0.372232).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.7005723
	speed: 0.1601s/iter; left time: 1932.4015s
Epoch: 22 cost time: 5.3991570472717285
Epoch: 22, Steps: 154 | Train Loss: 1.519 Vali Loss: 3.175 Vali Acc: 0.379 Test Loss: 3.175 Test Acc: 0.379
Validation loss decreased (-0.372232 --> -0.379125).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.7180403
	speed: 0.1569s/iter; left time: 1869.2603s
Epoch: 23 cost time: 5.452934265136719
Epoch: 23, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.913 Vali Acc: 0.376 Test Loss: 2.913 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.8356799
	speed: 0.1587s/iter; left time: 1865.6914s
Epoch: 24 cost time: 5.424662113189697
Epoch: 24, Steps: 154 | Train Loss: 1.400 Vali Loss: 3.054 Vali Acc: 0.216 Test Loss: 3.054 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.6947697
	speed: 0.1432s/iter; left time: 1661.6783s
Epoch: 25 cost time: 5.1800031661987305
Epoch: 25, Steps: 154 | Train Loss: 1.485 Vali Loss: 3.217 Vali Acc: 0.367 Test Loss: 3.217 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.5044889
	speed: 0.1424s/iter; left time: 1630.0852s
Epoch: 26 cost time: 5.232250213623047
Epoch: 26, Steps: 154 | Train Loss: 1.308 Vali Loss: 3.320 Vali Acc: 0.393 Test Loss: 3.320 Test Acc: 0.393
Validation loss decreased (-0.379125 --> -0.392911).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.7733664
	speed: 0.1417s/iter; left time: 1600.9963s
Epoch: 27 cost time: 5.303974151611328
Epoch: 27, Steps: 154 | Train Loss: 1.462 Vali Loss: 3.421 Vali Acc: 0.369 Test Loss: 3.421 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.1862007
	speed: 0.1410s/iter; left time: 1570.6500s
Epoch: 28 cost time: 5.381878137588501
Epoch: 28, Steps: 154 | Train Loss: 1.239 Vali Loss: 3.487 Vali Acc: 0.383 Test Loss: 3.487 Test Acc: 0.383
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.9548213
	speed: 0.1390s/iter; left time: 1527.0536s
Epoch: 29 cost time: 5.036101579666138
Epoch: 29, Steps: 154 | Train Loss: 1.430 Vali Loss: 3.325 Vali Acc: 0.385 Test Loss: 3.325 Test Acc: 0.385
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.2636708
	speed: 0.1442s/iter; left time: 1562.3704s
Epoch: 30 cost time: 5.466901779174805
Epoch: 30, Steps: 154 | Train Loss: 1.193 Vali Loss: 3.288 Vali Acc: 0.388 Test Loss: 3.288 Test Acc: 0.388
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 1.2384992
	speed: 0.1583s/iter; left time: 1691.0803s
Epoch: 31 cost time: 5.381350755691528
Epoch: 31, Steps: 154 | Train Loss: 1.298 Vali Loss: 3.409 Vali Acc: 0.386 Test Loss: 3.409 Test Acc: 0.386
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 1.4587535
	speed: 0.1503s/iter; left time: 1582.1842s
Epoch: 32 cost time: 5.365977764129639
Epoch: 32, Steps: 154 | Train Loss: 1.291 Vali Loss: 3.428 Vali Acc: 0.385 Test Loss: 3.428 Test Acc: 0.385
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.7470325
	speed: 0.1498s/iter; left time: 1553.5251s
Epoch: 33 cost time: 5.15894341468811
Epoch: 33, Steps: 154 | Train Loss: 1.339 Vali Loss: 3.816 Vali Acc: 0.298 Test Loss: 3.816 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 1.3591053
	speed: 0.1396s/iter; left time: 1426.3172s
Epoch: 34 cost time: 4.844154119491577
Epoch: 34, Steps: 154 | Train Loss: 1.280 Vali Loss: 3.859 Vali Acc: 0.225 Test Loss: 3.859 Test Acc: 0.225
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 2.7388413
	speed: 0.1220s/iter; left time: 1228.2404s
Epoch: 35 cost time: 5.3955442905426025
Epoch: 35, Steps: 154 | Train Loss: 1.174 Vali Loss: 3.481 Vali Acc: 0.389 Test Loss: 3.481 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 1.2312849
	speed: 0.1467s/iter; left time: 1454.0841s
Epoch: 36 cost time: 5.294413328170776
Epoch: 36, Steps: 154 | Train Loss: 1.277 Vali Loss: 3.763 Vali Acc: 0.382 Test Loss: 3.763 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3929440389294404
model parameter : 168246
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2224379
	speed: 0.0569s/iter; left time: 869.9804s
Epoch: 1 cost time: 7.83870005607605
Epoch: 1, Steps: 154 | Train Loss: 2.204 Vali Loss: 2.147 Vali Acc: 0.324 Test Loss: 2.147 Test Acc: 0.324
Validation loss decreased (inf --> -0.323580).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1509228
	speed: 0.1622s/iter; left time: 2456.9596s
Epoch: 2 cost time: 5.515658855438232
Epoch: 2, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.142 Vali Acc: 0.324 Test Loss: 2.142 Test Acc: 0.324
Validation loss decreased (-0.323580 --> -0.323985).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9442316
	speed: 0.1611s/iter; left time: 2414.9256s
Epoch: 3 cost time: 5.736469268798828
Epoch: 3, Steps: 154 | Train Loss: 1.973 Vali Loss: 2.152 Vali Acc: 0.324 Test Loss: 2.152 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5608541
	speed: 0.1621s/iter; left time: 2405.8596s
Epoch: 4 cost time: 5.873221158981323
Epoch: 4, Steps: 154 | Train Loss: 1.926 Vali Loss: 2.192 Vali Acc: 0.324 Test Loss: 2.192 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.6542592
	speed: 0.1480s/iter; left time: 2173.4843s
Epoch: 5 cost time: 5.776835680007935
Epoch: 5, Steps: 154 | Train Loss: 1.894 Vali Loss: 2.167 Vali Acc: 0.324 Test Loss: 2.167 Test Acc: 0.324
Validation loss decreased (-0.323985 --> -0.324390).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7835912
	speed: 0.1493s/iter; left time: 2169.1701s
Epoch: 6 cost time: 5.581181764602661
Epoch: 6, Steps: 154 | Train Loss: 1.830 Vali Loss: 2.231 Vali Acc: 0.326 Test Loss: 2.231 Test Acc: 0.326
Validation loss decreased (-0.324390 --> -0.326012).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8063860
	speed: 0.1524s/iter; left time: 2190.5784s
Epoch: 7 cost time: 5.914364576339722
Epoch: 7, Steps: 154 | Train Loss: 1.805 Vali Loss: 2.257 Vali Acc: 0.327 Test Loss: 2.257 Test Acc: 0.327
Validation loss decreased (-0.326012 --> -0.326823).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7584629
	speed: 0.1541s/iter; left time: 2191.9229s
Epoch: 8 cost time: 6.421802759170532
Epoch: 8, Steps: 154 | Train Loss: 1.801 Vali Loss: 2.238 Vali Acc: 0.329 Test Loss: 2.238 Test Acc: 0.329
Validation loss decreased (-0.326823 --> -0.329256).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4726837
	speed: 0.1536s/iter; left time: 2160.4336s
Epoch: 9 cost time: 5.850430965423584
Epoch: 9, Steps: 154 | Train Loss: 1.786 Vali Loss: 2.309 Vali Acc: 0.335 Test Loss: 2.309 Test Acc: 0.335
Validation loss decreased (-0.329256 --> -0.335338).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5856810
	speed: 0.1672s/iter; left time: 2326.8053s
Epoch: 10 cost time: 5.910854816436768
Epoch: 10, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.232 Vali Acc: 0.339 Test Loss: 2.232 Test Acc: 0.339
Validation loss decreased (-0.335338 --> -0.338583).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5201844
	speed: 0.1641s/iter; left time: 2258.3790s
Epoch: 11 cost time: 5.958622455596924
Epoch: 11, Steps: 154 | Train Loss: 1.729 Vali Loss: 2.450 Vali Acc: 0.339 Test Loss: 2.450 Test Acc: 0.339
Validation loss decreased (-0.338583 --> -0.339392).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4929994
	speed: 0.1630s/iter; left time: 2218.5783s
Epoch: 12 cost time: 5.917272567749023
Epoch: 12, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.290 Vali Acc: 0.349 Test Loss: 2.290 Test Acc: 0.349
Validation loss decreased (-0.339392 --> -0.349126).  Saving model ...
	iters: 100, epoch: 13 | loss: 6.2382035
	speed: 0.1534s/iter; left time: 2063.0936s
Epoch: 13 cost time: 5.574173212051392
Epoch: 13, Steps: 154 | Train Loss: 1.636 Vali Loss: 2.349 Vali Acc: 0.347 Test Loss: 2.349 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3165473
	speed: 0.1481s/iter; left time: 1969.8146s
Epoch: 14 cost time: 5.4565887451171875
Epoch: 14, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.416 Vali Acc: 0.351 Test Loss: 2.416 Test Acc: 0.351
Validation loss decreased (-0.349126 --> -0.351152).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2581142
	speed: 0.1575s/iter; left time: 2069.9252s
Epoch: 15 cost time: 6.263058423995972
Epoch: 15, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.574 Vali Acc: 0.357 Test Loss: 2.574 Test Acc: 0.357
Validation loss decreased (-0.351152 --> -0.356827).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.6072720
	speed: 0.1486s/iter; left time: 1930.5644s
Epoch: 16 cost time: 5.489442825317383
Epoch: 16, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.548 Vali Acc: 0.364 Test Loss: 2.548 Test Acc: 0.364
Validation loss decreased (-0.356827 --> -0.363721).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.9793732
	speed: 0.1578s/iter; left time: 2025.2202s
Epoch: 17 cost time: 5.771326541900635
Epoch: 17, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.494 Vali Acc: 0.354 Test Loss: 2.494 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.5797614
	speed: 0.1728s/iter; left time: 2191.1578s
Epoch: 18 cost time: 6.330406665802002
Epoch: 18, Steps: 154 | Train Loss: 1.442 Vali Loss: 2.509 Vali Acc: 0.360 Test Loss: 2.509 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.6221753
	speed: 0.1647s/iter; left time: 2063.2363s
Epoch: 19 cost time: 6.138306140899658
Epoch: 19, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.634 Vali Acc: 0.361 Test Loss: 2.634 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 3.5711896
	speed: 0.1727s/iter; left time: 2137.7503s
Epoch: 20 cost time: 5.871197700500488
Epoch: 20, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.525 Vali Acc: 0.367 Test Loss: 2.525 Test Acc: 0.367
Validation loss decreased (-0.363721 --> -0.366966).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.3175144
	speed: 0.1550s/iter; left time: 1893.8804s
Epoch: 21 cost time: 5.671037197113037
Epoch: 21, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.642 Vali Acc: 0.366 Test Loss: 2.642 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.1432770
	speed: 0.1565s/iter; left time: 1888.5799s
Epoch: 22 cost time: 6.2620530128479
Epoch: 22, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.750 Vali Acc: 0.230 Test Loss: 2.750 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.0773468
	speed: 0.1555s/iter; left time: 1852.7949s
Epoch: 23 cost time: 5.979626417160034
Epoch: 23, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.735 Vali Acc: 0.373 Test Loss: 2.735 Test Acc: 0.373
Validation loss decreased (-0.366966 --> -0.372641).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.4203281
	speed: 0.1560s/iter; left time: 1834.0691s
Epoch: 24 cost time: 5.621565341949463
Epoch: 24, Steps: 154 | Train Loss: 1.350 Vali Loss: 2.941 Vali Acc: 0.361 Test Loss: 2.941 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.7224772
	speed: 0.1554s/iter; left time: 1802.8697s
Epoch: 25 cost time: 5.89751410484314
Epoch: 25, Steps: 154 | Train Loss: 1.343 Vali Loss: 3.206 Vali Acc: 0.368 Test Loss: 3.206 Test Acc: 0.368
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.6009645
	speed: 0.1647s/iter; left time: 1886.3246s
Epoch: 26 cost time: 6.326355218887329
Epoch: 26, Steps: 154 | Train Loss: 1.357 Vali Loss: 2.973 Vali Acc: 0.215 Test Loss: 2.973 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.3784317
	speed: 0.1660s/iter; left time: 1875.7941s
Epoch: 27 cost time: 5.756492614746094
Epoch: 27, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.993 Vali Acc: 0.202 Test Loss: 2.993 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.1101677
	speed: 0.1624s/iter; left time: 1809.6925s
Epoch: 28 cost time: 5.510948657989502
Epoch: 28, Steps: 154 | Train Loss: 1.315 Vali Loss: 3.257 Vali Acc: 0.244 Test Loss: 3.257 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 1.4548528
	speed: 0.1512s/iter; left time: 1661.3372s
Epoch: 29 cost time: 5.954975605010986
Epoch: 29, Steps: 154 | Train Loss: 1.320 Vali Loss: 3.610 Vali Acc: 0.199 Test Loss: 3.610 Test Acc: 0.199
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 1.2182864
	speed: 0.1515s/iter; left time: 1641.1068s
Epoch: 30 cost time: 5.84387993812561
Epoch: 30, Steps: 154 | Train Loss: 1.320 Vali Loss: 3.670 Vali Acc: 0.096 Test Loss: 3.670 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.7975179
	speed: 0.1508s/iter; left time: 1611.0855s
Epoch: 31 cost time: 5.592088460922241
Epoch: 31, Steps: 154 | Train Loss: 1.337 Vali Loss: 3.244 Vali Acc: 0.214 Test Loss: 3.244 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.5018197
	speed: 0.1529s/iter; left time: 1609.2313s
Epoch: 32 cost time: 5.702307224273682
Epoch: 32, Steps: 154 | Train Loss: 1.907 Vali Loss: 3.579 Vali Acc: 0.151 Test Loss: 3.579 Test Acc: 0.151
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 1.5103554
	speed: 0.1545s/iter; left time: 1602.5457s
Epoch: 33 cost time: 6.624335765838623
Epoch: 33, Steps: 154 | Train Loss: 1.276 Vali Loss: 3.656 Vali Acc: 0.189 Test Loss: 3.656 Test Acc: 0.189
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3726682887266829
model parameter : 135478
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2052557
	speed: 0.0576s/iter; left time: 881.3177s
Epoch: 1 cost time: 7.6412034034729
Epoch: 1, Steps: 154 | Train Loss: 2.203 Vali Loss: 2.145 Vali Acc: 0.322 Test Loss: 2.145 Test Acc: 0.322
Validation loss decreased (inf --> -0.322363).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0954523
	speed: 0.1610s/iter; left time: 2438.9317s
Epoch: 2 cost time: 6.067675352096558
Epoch: 2, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.140 Vali Acc: 0.324 Test Loss: 2.140 Test Acc: 0.324
Validation loss decreased (-0.322363 --> -0.323985).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9663231
	speed: 0.1518s/iter; left time: 2275.6868s
Epoch: 3 cost time: 5.596385955810547
Epoch: 3, Steps: 154 | Train Loss: 1.962 Vali Loss: 2.146 Vali Acc: 0.322 Test Loss: 2.146 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5527761
	speed: 0.1523s/iter; left time: 2260.6549s
Epoch: 4 cost time: 5.551347494125366
Epoch: 4, Steps: 154 | Train Loss: 1.958 Vali Loss: 2.184 Vali Acc: 0.325 Test Loss: 2.184 Test Acc: 0.325
Validation loss decreased (-0.323985 --> -0.324796).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6430290
	speed: 0.1515s/iter; left time: 2224.7086s
Epoch: 5 cost time: 5.672730445861816
Epoch: 5, Steps: 154 | Train Loss: 1.867 Vali Loss: 2.163 Vali Acc: 0.325 Test Loss: 2.163 Test Acc: 0.325
Validation loss decreased (-0.324796 --> -0.325201).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7470322
	speed: 0.1488s/iter; left time: 2161.7519s
Epoch: 6 cost time: 5.774518966674805
Epoch: 6, Steps: 154 | Train Loss: 1.864 Vali Loss: 2.249 Vali Acc: 0.326 Test Loss: 2.249 Test Acc: 0.326
Validation loss decreased (-0.325201 --> -0.325606).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8480897
	speed: 0.1527s/iter; left time: 2195.0521s
Epoch: 7 cost time: 5.7311851978302
Epoch: 7, Steps: 154 | Train Loss: 1.815 Vali Loss: 2.237 Vali Acc: 0.328 Test Loss: 2.237 Test Acc: 0.328
Validation loss decreased (-0.325606 --> -0.327634).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6116549
	speed: 0.1655s/iter; left time: 2353.9116s
Epoch: 8 cost time: 5.616475582122803
Epoch: 8, Steps: 154 | Train Loss: 1.812 Vali Loss: 2.225 Vali Acc: 0.333 Test Loss: 2.225 Test Acc: 0.333
Validation loss decreased (-0.327634 --> -0.332906).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3980647
	speed: 0.1523s/iter; left time: 2142.9441s
Epoch: 9 cost time: 5.893908500671387
Epoch: 9, Steps: 154 | Train Loss: 1.763 Vali Loss: 2.383 Vali Acc: 0.341 Test Loss: 2.383 Test Acc: 0.341
Validation loss decreased (-0.332906 --> -0.341420).  Saving model ...
	iters: 100, epoch: 10 | loss: 4.5976009
	speed: 0.1650s/iter; left time: 2296.3695s
Epoch: 10 cost time: 5.290789365768433
Epoch: 10, Steps: 154 | Train Loss: 1.745 Vali Loss: 2.199 Vali Acc: 0.341 Test Loss: 2.199 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5053582
	speed: 0.1463s/iter; left time: 2013.7658s
Epoch: 11 cost time: 5.532812833786011
Epoch: 11, Steps: 154 | Train Loss: 1.651 Vali Loss: 2.453 Vali Acc: 0.342 Test Loss: 2.453 Test Acc: 0.342
Validation loss decreased (-0.341420 --> -0.341825).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1832699
	speed: 0.1510s/iter; left time: 2055.2027s
Epoch: 12 cost time: 6.297529935836792
Epoch: 12, Steps: 154 | Train Loss: 1.671 Vali Loss: 2.275 Vali Acc: 0.348 Test Loss: 2.275 Test Acc: 0.348
Validation loss decreased (-0.341825 --> -0.347504).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5691177
	speed: 0.1538s/iter; left time: 2068.8193s
Epoch: 13 cost time: 5.756069898605347
Epoch: 13, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.387 Vali Acc: 0.349 Test Loss: 2.387 Test Acc: 0.349
Validation loss decreased (-0.347504 --> -0.348719).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4379673
	speed: 0.1520s/iter; left time: 2020.8975s
Epoch: 14 cost time: 5.916562795639038
Epoch: 14, Steps: 154 | Train Loss: 1.670 Vali Loss: 2.355 Vali Acc: 0.356 Test Loss: 2.355 Test Acc: 0.356
Validation loss decreased (-0.348719 --> -0.356424).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2747735
	speed: 0.1535s/iter; left time: 2017.4360s
Epoch: 15 cost time: 6.274928569793701
Epoch: 15, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.515 Vali Acc: 0.359 Test Loss: 2.515 Test Acc: 0.359
Validation loss decreased (-0.356424 --> -0.359261).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5252142
	speed: 0.1634s/iter; left time: 2122.6967s
Epoch: 16 cost time: 6.237436056137085
Epoch: 16, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.630 Vali Acc: 0.351 Test Loss: 2.630 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.0050290
	speed: 0.1676s/iter; left time: 2152.0022s
Epoch: 17 cost time: 5.980892658233643
Epoch: 17, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.566 Vali Acc: 0.355 Test Loss: 2.566 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.5374507
	speed: 0.1665s/iter; left time: 2111.9676s
Epoch: 18 cost time: 5.67256498336792
Epoch: 18, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.427 Vali Acc: 0.361 Test Loss: 2.427 Test Acc: 0.361
Validation loss decreased (-0.359261 --> -0.360884).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.6729938
	speed: 0.1524s/iter; left time: 1909.6530s
Epoch: 19 cost time: 5.830510139465332
Epoch: 19, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.688 Vali Acc: 0.360 Test Loss: 2.688 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.5061643
	speed: 0.1293s/iter; left time: 1600.6697s
Epoch: 20 cost time: 5.061004638671875
Epoch: 20, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.775 Vali Acc: 0.362 Test Loss: 2.775 Test Acc: 0.362
Validation loss decreased (-0.360884 --> -0.361692).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.3890072
	speed: 0.1486s/iter; left time: 1816.0378s
Epoch: 21 cost time: 5.707425117492676
Epoch: 21, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.941 Vali Acc: 0.363 Test Loss: 2.941 Test Acc: 0.363
Validation loss decreased (-0.361692 --> -0.363312).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.1518270
	speed: 0.1603s/iter; left time: 1934.6077s
Epoch: 22 cost time: 6.015578269958496
Epoch: 22, Steps: 154 | Train Loss: 1.411 Vali Loss: 2.796 Vali Acc: 0.369 Test Loss: 2.796 Test Acc: 0.369
Validation loss decreased (-0.363312 --> -0.368585).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.9453658
	speed: 0.1563s/iter; left time: 1862.4455s
Epoch: 23 cost time: 6.005157709121704
Epoch: 23, Steps: 154 | Train Loss: 1.501 Vali Loss: 3.025 Vali Acc: 0.370 Test Loss: 3.025 Test Acc: 0.370
Validation loss decreased (-0.368585 --> -0.370205).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.3659559
	speed: 0.1582s/iter; left time: 1859.6974s
Epoch: 24 cost time: 5.486115217208862
Epoch: 24, Steps: 154 | Train Loss: 1.573 Vali Loss: 3.445 Vali Acc: 0.361 Test Loss: 3.445 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.6871717
	speed: 0.1647s/iter; left time: 1911.9224s
Epoch: 25 cost time: 5.963014125823975
Epoch: 25, Steps: 154 | Train Loss: 1.340 Vali Loss: 3.186 Vali Acc: 0.350 Test Loss: 3.186 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.5412863
	speed: 0.1616s/iter; left time: 1850.0244s
Epoch: 26 cost time: 5.72541880607605
Epoch: 26, Steps: 154 | Train Loss: 1.312 Vali Loss: 3.597 Vali Acc: 0.364 Test Loss: 3.597 Test Acc: 0.364
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.3340086
	speed: 0.1553s/iter; left time: 1754.5046s
Epoch: 27 cost time: 6.163375377655029
Epoch: 27, Steps: 154 | Train Loss: 1.294 Vali Loss: 3.513 Vali Acc: 0.377 Test Loss: 3.513 Test Acc: 0.377
Validation loss decreased (-0.370205 --> -0.377094).  Saving model ...
	iters: 100, epoch: 28 | loss: 9.8568649
	speed: 0.1546s/iter; left time: 1722.4263s
Epoch: 28 cost time: 5.6618125438690186
Epoch: 28, Steps: 154 | Train Loss: 1.293 Vali Loss: 3.582 Vali Acc: 0.361 Test Loss: 3.582 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.2309575
	speed: 0.1496s/iter; left time: 1643.6319s
Epoch: 29 cost time: 5.736503601074219
Epoch: 29, Steps: 154 | Train Loss: 1.337 Vali Loss: 3.391 Vali Acc: 0.202 Test Loss: 3.391 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.9740226
	speed: 0.1575s/iter; left time: 1706.3562s
Epoch: 30 cost time: 6.225029706954956
Epoch: 30, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.623 Vali Acc: 0.118 Test Loss: 3.623 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.9876288
	speed: 0.1531s/iter; left time: 1635.6089s
Epoch: 31 cost time: 6.269107341766357
Epoch: 31, Steps: 154 | Train Loss: 1.292 Vali Loss: 4.093 Vali Acc: 0.232 Test Loss: 4.093 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.5307043
	speed: 0.1699s/iter; left time: 1788.9561s
Epoch: 32 cost time: 6.2369866371154785
Epoch: 32, Steps: 154 | Train Loss: 1.295 Vali Loss: 4.054 Vali Acc: 0.093 Test Loss: 4.054 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 1.0068519
	speed: 0.1692s/iter; left time: 1754.9582s
Epoch: 33 cost time: 6.158385992050171
Epoch: 33, Steps: 154 | Train Loss: 1.406 Vali Loss: 3.877 Vali Acc: 0.160 Test Loss: 3.877 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 2.4995768
	speed: 0.1700s/iter; left time: 1737.5339s
Epoch: 34 cost time: 5.845876693725586
Epoch: 34, Steps: 154 | Train Loss: 1.255 Vali Loss: 4.033 Vali Acc: 0.223 Test Loss: 4.033 Test Acc: 0.223
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 1.0448192
	speed: 0.1554s/iter; left time: 1563.6134s
Epoch: 35 cost time: 6.27545166015625
Epoch: 35, Steps: 154 | Train Loss: 1.283 Vali Loss: 4.574 Vali Acc: 0.359 Test Loss: 4.574 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 1.3379645
	speed: 0.1548s/iter; left time: 1534.0370s
Epoch: 36 cost time: 5.700300455093384
Epoch: 36, Steps: 154 | Train Loss: 1.330 Vali Loss: 4.035 Vali Acc: 0.217 Test Loss: 4.035 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.9627100
	speed: 0.1581s/iter; left time: 1542.1233s
Epoch: 37 cost time: 5.736462116241455
Epoch: 37, Steps: 154 | Train Loss: 1.177 Vali Loss: 4.259 Vali Acc: 0.369 Test Loss: 4.259 Test Acc: 0.369
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3771289537712895
model parameter : 135478
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2079391
	speed: 0.0591s/iter; left time: 904.6480s
Epoch: 1 cost time: 8.101438522338867
Epoch: 1, Steps: 154 | Train Loss: 2.198 Vali Loss: 2.149 Vali Acc: 0.322 Test Loss: 2.149 Test Acc: 0.322
Validation loss decreased (inf --> -0.321552).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0272887
	speed: 0.1704s/iter; left time: 2580.4149s
Epoch: 2 cost time: 5.597064733505249
Epoch: 2, Steps: 154 | Train Loss: 2.066 Vali Loss: 2.138 Vali Acc: 0.322 Test Loss: 2.138 Test Acc: 0.322
Validation loss decreased (-0.321552 --> -0.322363).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9987426
	speed: 0.1590s/iter; left time: 2383.3839s
Epoch: 3 cost time: 5.490344524383545
Epoch: 3, Steps: 154 | Train Loss: 1.977 Vali Loss: 2.144 Vali Acc: 0.324 Test Loss: 2.144 Test Acc: 0.324
Validation loss decreased (-0.322363 --> -0.323580).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5665843
	speed: 0.1631s/iter; left time: 2420.3210s
Epoch: 4 cost time: 5.925070285797119
Epoch: 4, Steps: 154 | Train Loss: 1.952 Vali Loss: 2.168 Vali Acc: 0.323 Test Loss: 2.168 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6702352
	speed: 0.1480s/iter; left time: 2173.9915s
Epoch: 5 cost time: 5.795562028884888
Epoch: 5, Steps: 154 | Train Loss: 1.864 Vali Loss: 2.141 Vali Acc: 0.328 Test Loss: 2.141 Test Acc: 0.328
Validation loss decreased (-0.323580 --> -0.328040).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8051271
	speed: 0.1477s/iter; left time: 2146.4986s
Epoch: 6 cost time: 5.510441541671753
Epoch: 6, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.219 Vali Acc: 0.325 Test Loss: 2.219 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7872236
	speed: 0.1509s/iter; left time: 2169.7072s
Epoch: 7 cost time: 5.8050196170806885
Epoch: 7, Steps: 154 | Train Loss: 1.807 Vali Loss: 2.257 Vali Acc: 0.329 Test Loss: 2.257 Test Acc: 0.329
Validation loss decreased (-0.328040 --> -0.329256).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6320227
	speed: 0.1492s/iter; left time: 2122.4397s
Epoch: 8 cost time: 6.201346397399902
Epoch: 8, Steps: 154 | Train Loss: 1.770 Vali Loss: 2.269 Vali Acc: 0.333 Test Loss: 2.269 Test Acc: 0.333
Validation loss decreased (-0.329256 --> -0.332905).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7249866
	speed: 0.1478s/iter; left time: 2078.8235s
Epoch: 9 cost time: 5.851142883300781
Epoch: 9, Steps: 154 | Train Loss: 1.789 Vali Loss: 2.364 Vali Acc: 0.336 Test Loss: 2.364 Test Acc: 0.336
Validation loss decreased (-0.332905 --> -0.336148).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.5028253
	speed: 0.1677s/iter; left time: 2333.3466s
Epoch: 10 cost time: 5.8180906772613525
Epoch: 10, Steps: 154 | Train Loss: 1.699 Vali Loss: 2.300 Vali Acc: 0.342 Test Loss: 2.300 Test Acc: 0.342
Validation loss decreased (-0.336148 --> -0.341826).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6222411
	speed: 0.1639s/iter; left time: 2254.7748s
Epoch: 11 cost time: 5.891858816146851
Epoch: 11, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.473 Vali Acc: 0.342 Test Loss: 2.473 Test Acc: 0.342
Validation loss decreased (-0.341826 --> -0.342230).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1312591
	speed: 0.1656s/iter; left time: 2253.3394s
Epoch: 12 cost time: 6.134149789810181
Epoch: 12, Steps: 154 | Train Loss: 1.653 Vali Loss: 2.378 Vali Acc: 0.344 Test Loss: 2.378 Test Acc: 0.344
Validation loss decreased (-0.342230 --> -0.343853).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5220541
	speed: 0.1499s/iter; left time: 2016.2429s
Epoch: 13 cost time: 5.629830360412598
Epoch: 13, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.528 Vali Acc: 0.349 Test Loss: 2.528 Test Acc: 0.349
Validation loss decreased (-0.343853 --> -0.349123).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4394875
	speed: 0.1517s/iter; left time: 2016.8384s
Epoch: 14 cost time: 5.398742437362671
Epoch: 14, Steps: 154 | Train Loss: 1.713 Vali Loss: 2.513 Vali Acc: 0.350 Test Loss: 2.513 Test Acc: 0.350
Validation loss decreased (-0.349123 --> -0.349934).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2308651
	speed: 0.1438s/iter; left time: 1890.2797s
Epoch: 15 cost time: 5.25081205368042
Epoch: 15, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.703 Vali Acc: 0.356 Test Loss: 2.703 Test Acc: 0.356
Validation loss decreased (-0.349934 --> -0.356015).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3822808
	speed: 0.1320s/iter; left time: 1714.9415s
Epoch: 16 cost time: 5.457464933395386
Epoch: 16, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.694 Vali Acc: 0.356 Test Loss: 2.694 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.0818141
	speed: 0.1470s/iter; left time: 1887.4063s
Epoch: 17 cost time: 5.373379945755005
Epoch: 17, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.944 Vali Acc: 0.354 Test Loss: 2.944 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.6506976
	speed: 0.1665s/iter; left time: 2112.2648s
Epoch: 18 cost time: 5.8148839473724365
Epoch: 18, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.708 Vali Acc: 0.361 Test Loss: 2.708 Test Acc: 0.361
Validation loss decreased (-0.356015 --> -0.360881).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.6529136
	speed: 0.1687s/iter; left time: 2113.3261s
Epoch: 19 cost time: 5.807665586471558
Epoch: 19, Steps: 154 | Train Loss: 1.420 Vali Loss: 2.855 Vali Acc: 0.331 Test Loss: 2.855 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 4.4859161
	speed: 0.1627s/iter; left time: 2013.3301s
Epoch: 20 cost time: 6.024441480636597
Epoch: 20, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.930 Vali Acc: 0.362 Test Loss: 2.930 Test Acc: 0.362
Validation loss decreased (-0.360881 --> -0.361690).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.0796347
	speed: 0.1522s/iter; left time: 1859.5890s
Epoch: 21 cost time: 5.509427547454834
Epoch: 21, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.885 Vali Acc: 0.366 Test Loss: 2.885 Test Acc: 0.366
Validation loss decreased (-0.361690 --> -0.365746).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.1319796
	speed: 0.1467s/iter; left time: 1769.9282s
Epoch: 22 cost time: 5.840163946151733
Epoch: 22, Steps: 154 | Train Loss: 1.475 Vali Loss: 3.034 Vali Acc: 0.332 Test Loss: 3.034 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.0783403
	speed: 0.1542s/iter; left time: 1836.9526s
Epoch: 23 cost time: 6.213899850845337
Epoch: 23, Steps: 154 | Train Loss: 1.397 Vali Loss: 3.345 Vali Acc: 0.363 Test Loss: 3.345 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.4191508
	speed: 0.1516s/iter; left time: 1783.0426s
Epoch: 24 cost time: 5.827236652374268
Epoch: 24, Steps: 154 | Train Loss: 1.504 Vali Loss: 3.311 Vali Acc: 0.372 Test Loss: 3.311 Test Acc: 0.372
Validation loss decreased (-0.365746 --> -0.372230).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.5815578
	speed: 0.1512s/iter; left time: 1754.5674s
Epoch: 25 cost time: 5.726321697235107
Epoch: 25, Steps: 154 | Train Loss: 1.270 Vali Loss: 3.644 Vali Acc: 0.373 Test Loss: 3.644 Test Acc: 0.373
Validation loss decreased (-0.372230 --> -0.373443).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.2565448
	speed: 0.1589s/iter; left time: 1819.1403s
Epoch: 26 cost time: 5.690708875656128
Epoch: 26, Steps: 154 | Train Loss: 1.384 Vali Loss: 3.724 Vali Acc: 0.217 Test Loss: 3.724 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.3970664
	speed: 0.1606s/iter; left time: 1814.1169s
Epoch: 27 cost time: 5.776970386505127
Epoch: 27, Steps: 154 | Train Loss: 1.374 Vali Loss: 3.607 Vali Acc: 0.276 Test Loss: 3.607 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.6986357
	speed: 0.1651s/iter; left time: 1839.6912s
Epoch: 28 cost time: 6.4694013595581055
Epoch: 28, Steps: 154 | Train Loss: 1.351 Vali Loss: 3.515 Vali Acc: 0.231 Test Loss: 3.515 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.4363061
	speed: 0.1559s/iter; left time: 1713.7219s
Epoch: 29 cost time: 5.490003347396851
Epoch: 29, Steps: 154 | Train Loss: 1.429 Vali Loss: 3.944 Vali Acc: 0.208 Test Loss: 3.944 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.4988977
	speed: 0.1484s/iter; left time: 1608.3241s
Epoch: 30 cost time: 5.704920768737793
Epoch: 30, Steps: 154 | Train Loss: 1.249 Vali Loss: 3.631 Vali Acc: 0.329 Test Loss: 3.631 Test Acc: 0.329
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 1.0269815
	speed: 0.1510s/iter; left time: 1612.6862s
Epoch: 31 cost time: 5.439100980758667
Epoch: 31, Steps: 154 | Train Loss: 1.306 Vali Loss: 3.642 Vali Acc: 0.238 Test Loss: 3.642 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.4829433
	speed: 0.1521s/iter; left time: 1601.6820s
Epoch: 32 cost time: 6.178220987319946
Epoch: 32, Steps: 154 | Train Loss: 1.330 Vali Loss: 4.578 Vali Acc: 0.163 Test Loss: 4.578 Test Acc: 0.163
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 1.5120847
	speed: 0.1524s/iter; left time: 1581.3606s
Epoch: 33 cost time: 5.6557464599609375
Epoch: 33, Steps: 154 | Train Loss: 1.458 Vali Loss: 4.401 Vali Acc: 0.116 Test Loss: 4.401 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 1.9785842
	speed: 0.1690s/iter; left time: 1727.1960s
Epoch: 34 cost time: 5.368409156799316
Epoch: 34, Steps: 154 | Train Loss: 1.213 Vali Loss: 4.020 Vali Acc: 0.218 Test Loss: 4.020 Test Acc: 0.218
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.9716554
	speed: 0.1601s/iter; left time: 1611.0696s
Epoch: 35 cost time: 5.522407293319702
Epoch: 35, Steps: 154 | Train Loss: 1.181 Vali Loss: 4.192 Vali Acc: 0.376 Test Loss: 4.192 Test Acc: 0.376
Validation loss decreased (-0.373443 --> -0.376276).  Saving model ...
	iters: 100, epoch: 36 | loss: 4.4196734
	speed: 0.1690s/iter; left time: 1675.0035s
Epoch: 36 cost time: 6.418240547180176
Epoch: 36, Steps: 154 | Train Loss: 1.275 Vali Loss: 4.029 Vali Acc: 0.236 Test Loss: 4.029 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.4279161
	speed: 0.1636s/iter; left time: 1595.7883s
Epoch: 37 cost time: 6.826981067657471
Epoch: 37, Steps: 154 | Train Loss: 1.283 Vali Loss: 3.820 Vali Acc: 0.378 Test Loss: 3.820 Test Acc: 0.378
Validation loss decreased (-0.376276 --> -0.377496).  Saving model ...
	iters: 100, epoch: 38 | loss: 1.3999991
	speed: 0.1620s/iter; left time: 1556.0474s
Epoch: 38 cost time: 4.499221324920654
Epoch: 38, Steps: 154 | Train Loss: 1.094 Vali Loss: 4.959 Vali Acc: 0.251 Test Loss: 4.959 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 1.3086042
	speed: 0.1218s/iter; left time: 1151.3183s
Epoch: 39 cost time: 4.365675687789917
Epoch: 39, Steps: 154 | Train Loss: 1.383 Vali Loss: 4.346 Vali Acc: 0.212 Test Loss: 4.346 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 0.9421543
	speed: 0.1376s/iter; left time: 1279.2784s
Epoch: 40 cost time: 6.2836058139801025
Epoch: 40, Steps: 154 | Train Loss: 1.203 Vali Loss: 4.271 Vali Acc: 0.199 Test Loss: 4.271 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 1.1199733
	speed: 0.1477s/iter; left time: 1350.2769s
Epoch: 41 cost time: 5.787994623184204
Epoch: 41, Steps: 154 | Train Loss: 1.320 Vali Loss: 4.218 Vali Acc: 0.215 Test Loss: 4.218 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 42 | loss: 0.9574748
	speed: 0.1452s/iter; left time: 1304.8767s
Epoch: 42 cost time: 5.397150039672852
Epoch: 42, Steps: 154 | Train Loss: 1.114 Vali Loss: 4.380 Vali Acc: 0.124 Test Loss: 4.380 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 43 | loss: 1.6329219
	speed: 0.1507s/iter; left time: 1331.1296s
Epoch: 43 cost time: 5.620134115219116
Epoch: 43, Steps: 154 | Train Loss: 1.024 Vali Loss: 5.479 Vali Acc: 0.206 Test Loss: 5.479 Test Acc: 0.206
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 44 | loss: 1.8228097
	speed: 0.1450s/iter; left time: 1258.3018s
Epoch: 44 cost time: 5.656077861785889
Epoch: 44, Steps: 154 | Train Loss: 1.144 Vali Loss: 4.268 Vali Acc: 0.244 Test Loss: 4.268 Test Acc: 0.244
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 45 | loss: 0.7987376
	speed: 0.1521s/iter; left time: 1296.9912s
Epoch: 45 cost time: 6.032937049865723
Epoch: 45, Steps: 154 | Train Loss: 1.018 Vali Loss: 4.306 Vali Acc: 0.394 Test Loss: 4.306 Test Acc: 0.394
Validation loss decreased (-0.377496 --> -0.394118).  Saving model ...
	iters: 100, epoch: 46 | loss: 0.5564659
	speed: 0.1684s/iter; left time: 1410.0536s
Epoch: 46 cost time: 5.6652326583862305
Epoch: 46, Steps: 154 | Train Loss: 1.294 Vali Loss: 4.463 Vali Acc: 0.214 Test Loss: 4.463 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 47 | loss: 0.4798829
	speed: 0.1548s/iter; left time: 1271.8308s
Epoch: 47 cost time: 5.5837156772613525
Epoch: 47, Steps: 154 | Train Loss: 1.075 Vali Loss: 4.624 Vali Acc: 0.218 Test Loss: 4.624 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 48 | loss: 0.6945719
	speed: 0.1608s/iter; left time: 1296.5221s
Epoch: 48 cost time: 6.1128270626068115
Epoch: 48, Steps: 154 | Train Loss: 1.185 Vali Loss: 4.863 Vali Acc: 0.099 Test Loss: 4.863 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 49 | loss: 1.1272298
	speed: 0.1537s/iter; left time: 1215.9537s
Epoch: 49 cost time: 5.6112401485443115
Epoch: 49, Steps: 154 | Train Loss: 1.370 Vali Loss: 4.379 Vali Acc: 0.225 Test Loss: 4.379 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 50 | loss: 0.9731438
	speed: 0.1465s/iter; left time: 1135.9595s
Epoch: 50 cost time: 5.158501863479614
Epoch: 50, Steps: 154 | Train Loss: 1.147 Vali Loss: 4.710 Vali Acc: 0.283 Test Loss: 4.710 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 51 | loss: 0.5841799
	speed: 0.1414s/iter; left time: 1075.1509s
Epoch: 51 cost time: 5.519425392150879
Epoch: 51, Steps: 154 | Train Loss: 1.220 Vali Loss: 4.672 Vali Acc: 0.180 Test Loss: 4.672 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 52 | loss: 0.6431803
	speed: 0.1532s/iter; left time: 1140.8425s
Epoch: 52 cost time: 5.8939244747161865
Epoch: 52, Steps: 154 | Train Loss: 1.161 Vali Loss: 5.217 Vali Acc: 0.247 Test Loss: 5.217 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 53 | loss: 0.7169517
	speed: 0.1564s/iter; left time: 1140.8683s
Epoch: 53 cost time: 6.012004375457764
Epoch: 53, Steps: 154 | Train Loss: 1.308 Vali Loss: 4.648 Vali Acc: 0.220 Test Loss: 4.648 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 54 | loss: 0.8668963
	speed: 0.1619s/iter; left time: 1156.1157s
Epoch: 54 cost time: 5.773190498352051
Epoch: 54, Steps: 154 | Train Loss: 1.041 Vali Loss: 5.199 Vali Acc: 0.118 Test Loss: 5.199 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 55 | loss: 1.1557933
	speed: 0.1629s/iter; left time: 1138.0996s
Epoch: 55 cost time: 5.65301513671875
Epoch: 55, Steps: 154 | Train Loss: 1.081 Vali Loss: 5.721 Vali Acc: 0.227 Test Loss: 5.721 Test Acc: 0.227
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39416058394160586
model parameter : 135478
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2162871
	speed: 0.0468s/iter; left time: 715.9484s
Epoch: 1 cost time: 6.317370891571045
Epoch: 1, Steps: 154 | Train Loss: 2.194 Vali Loss: 2.154 Vali Acc: 0.320 Test Loss: 2.154 Test Acc: 0.320
Validation loss decreased (inf --> -0.320335).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9434326
	speed: 0.1286s/iter; left time: 1948.1784s
Epoch: 2 cost time: 5.07864785194397
Epoch: 2, Steps: 154 | Train Loss: 2.068 Vali Loss: 2.126 Vali Acc: 0.321 Test Loss: 2.126 Test Acc: 0.321
Validation loss decreased (-0.320335 --> -0.321147).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0805540
	speed: 0.1387s/iter; left time: 2078.8311s
Epoch: 3 cost time: 5.214067697525024
Epoch: 3, Steps: 154 | Train Loss: 1.977 Vali Loss: 2.138 Vali Acc: 0.322 Test Loss: 2.138 Test Acc: 0.322
Validation loss decreased (-0.321147 --> -0.321958).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5546820
	speed: 0.1417s/iter; left time: 2102.6547s
Epoch: 4 cost time: 5.063807487487793
Epoch: 4, Steps: 154 | Train Loss: 1.959 Vali Loss: 2.160 Vali Acc: 0.322 Test Loss: 2.160 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6708103
	speed: 0.1418s/iter; left time: 2082.1554s
Epoch: 5 cost time: 5.632209300994873
Epoch: 5, Steps: 154 | Train Loss: 1.881 Vali Loss: 2.141 Vali Acc: 0.326 Test Loss: 2.141 Test Acc: 0.326
Validation loss decreased (-0.321958 --> -0.325607).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7625358
	speed: 0.1545s/iter; left time: 2244.4900s
Epoch: 6 cost time: 5.454576730728149
Epoch: 6, Steps: 154 | Train Loss: 1.853 Vali Loss: 2.179 Vali Acc: 0.329 Test Loss: 2.179 Test Acc: 0.329
Validation loss decreased (-0.325607 --> -0.328851).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7855353
	speed: 0.1551s/iter; left time: 2229.5978s
Epoch: 7 cost time: 5.49216628074646
Epoch: 7, Steps: 154 | Train Loss: 1.800 Vali Loss: 2.248 Vali Acc: 0.333 Test Loss: 2.248 Test Acc: 0.333
Validation loss decreased (-0.328851 --> -0.332500).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7557898
	speed: 0.1548s/iter; left time: 2201.5697s
Epoch: 8 cost time: 5.202619314193726
Epoch: 8, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.283 Vali Acc: 0.339 Test Loss: 2.283 Test Acc: 0.339
Validation loss decreased (-0.332500 --> -0.338988).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7068530
	speed: 0.1402s/iter; left time: 1972.6063s
Epoch: 9 cost time: 5.36242151260376
Epoch: 9, Steps: 154 | Train Loss: 1.720 Vali Loss: 2.356 Vali Acc: 0.346 Test Loss: 2.356 Test Acc: 0.346
Validation loss decreased (-0.338988 --> -0.345881).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.5684590
	speed: 0.1423s/iter; left time: 1979.4115s
Epoch: 10 cost time: 5.182811975479126
Epoch: 10, Steps: 154 | Train Loss: 1.700 Vali Loss: 2.331 Vali Acc: 0.345 Test Loss: 2.331 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3289440
	speed: 0.1410s/iter; left time: 1939.6931s
Epoch: 11 cost time: 5.158144235610962
Epoch: 11, Steps: 154 | Train Loss: 1.643 Vali Loss: 2.452 Vali Acc: 0.345 Test Loss: 2.452 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1209064
	speed: 0.1421s/iter; left time: 1933.5024s
Epoch: 12 cost time: 5.5329296588897705
Epoch: 12, Steps: 154 | Train Loss: 1.678 Vali Loss: 2.373 Vali Acc: 0.348 Test Loss: 2.373 Test Acc: 0.348
Validation loss decreased (-0.345881 --> -0.347503).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5467184
	speed: 0.1378s/iter; left time: 1853.9510s
Epoch: 13 cost time: 5.163456201553345
Epoch: 13, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.438 Vali Acc: 0.354 Test Loss: 2.438 Test Acc: 0.354
Validation loss decreased (-0.347503 --> -0.353585).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2778323
	speed: 0.1592s/iter; left time: 2117.3854s
Epoch: 14 cost time: 5.491674900054932
Epoch: 14, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.490 Vali Acc: 0.356 Test Loss: 2.490 Test Acc: 0.356
Validation loss decreased (-0.353585 --> -0.356423).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2376188
	speed: 0.1579s/iter; left time: 2075.7663s
Epoch: 15 cost time: 5.465461015701294
Epoch: 15, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.657 Vali Acc: 0.363 Test Loss: 2.657 Test Acc: 0.363
Validation loss decreased (-0.356423 --> -0.363315).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.2610165
	speed: 0.1624s/iter; left time: 2109.1118s
Epoch: 16 cost time: 5.70114278793335
Epoch: 16, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.688 Vali Acc: 0.358 Test Loss: 2.688 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.5561974
	speed: 0.1508s/iter; left time: 1935.5959s
Epoch: 17 cost time: 5.217397451400757
Epoch: 17, Steps: 154 | Train Loss: 1.630 Vali Loss: 2.639 Vali Acc: 0.362 Test Loss: 2.639 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.3566288
	speed: 0.1443s/iter; left time: 1830.1793s
Epoch: 18 cost time: 5.141855239868164
Epoch: 18, Steps: 154 | Train Loss: 1.612 Vali Loss: 2.655 Vali Acc: 0.364 Test Loss: 2.655 Test Acc: 0.364
Validation loss decreased (-0.363315 --> -0.364126).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.8349150
	speed: 0.1463s/iter; left time: 1832.6461s
Epoch: 19 cost time: 5.403146743774414
Epoch: 19, Steps: 154 | Train Loss: 1.396 Vali Loss: 2.951 Vali Acc: 0.365 Test Loss: 2.951 Test Acc: 0.365
Validation loss decreased (-0.364126 --> -0.364528).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.9420952
	speed: 0.1371s/iter; left time: 1696.5511s
Epoch: 20 cost time: 4.959666728973389
Epoch: 20, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.925 Vali Acc: 0.363 Test Loss: 2.925 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.0837042
	speed: 0.1428s/iter; left time: 1745.1532s
Epoch: 21 cost time: 5.039556980133057
Epoch: 21, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.906 Vali Acc: 0.366 Test Loss: 2.906 Test Acc: 0.366
Validation loss decreased (-0.364528 --> -0.365745).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.0672994
	speed: 0.1448s/iter; left time: 1746.8200s
Epoch: 22 cost time: 5.303348779678345
Epoch: 22, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.933 Vali Acc: 0.376 Test Loss: 2.933 Test Acc: 0.376
Validation loss decreased (-0.365745 --> -0.376289).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.1981542
	speed: 0.1555s/iter; left time: 1852.5641s
Epoch: 23 cost time: 5.489537477493286
Epoch: 23, Steps: 154 | Train Loss: 1.499 Vali Loss: 3.166 Vali Acc: 0.373 Test Loss: 3.166 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.4274431
	speed: 0.1578s/iter; left time: 1855.9438s
Epoch: 24 cost time: 5.4202165603637695
Epoch: 24, Steps: 154 | Train Loss: 1.492 Vali Loss: 3.133 Vali Acc: 0.374 Test Loss: 3.133 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.6317210
	speed: 0.1472s/iter; left time: 1708.0980s
Epoch: 25 cost time: 5.007213830947876
Epoch: 25, Steps: 154 | Train Loss: 1.285 Vali Loss: 3.265 Vali Acc: 0.371 Test Loss: 3.265 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.0977380
	speed: 0.1405s/iter; left time: 1609.1944s
Epoch: 26 cost time: 5.253150224685669
Epoch: 26, Steps: 154 | Train Loss: 1.291 Vali Loss: 3.155 Vali Acc: 0.378 Test Loss: 3.155 Test Acc: 0.378
Validation loss decreased (-0.376289 --> -0.378314).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.0977100
	speed: 0.1402s/iter; left time: 1583.3648s
Epoch: 27 cost time: 5.234197616577148
Epoch: 27, Steps: 154 | Train Loss: 1.581 Vali Loss: 3.377 Vali Acc: 0.382 Test Loss: 3.377 Test Acc: 0.382
Validation loss decreased (-0.378314 --> -0.381961).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.4082509
	speed: 0.1427s/iter; left time: 1590.4251s
Epoch: 28 cost time: 5.132182598114014
Epoch: 28, Steps: 154 | Train Loss: 1.424 Vali Loss: 3.362 Vali Acc: 0.384 Test Loss: 3.362 Test Acc: 0.384
Validation loss decreased (-0.381961 --> -0.383584).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.2128142
	speed: 0.1437s/iter; left time: 1579.6387s
Epoch: 29 cost time: 5.238198757171631
Epoch: 29, Steps: 154 | Train Loss: 1.597 Vali Loss: 3.618 Vali Acc: 0.211 Test Loss: 3.618 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.0175384
	speed: 0.1441s/iter; left time: 1561.1205s
Epoch: 30 cost time: 5.352343797683716
Epoch: 30, Steps: 154 | Train Loss: 1.164 Vali Loss: 3.617 Vali Acc: 0.300 Test Loss: 3.617 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.8803231
	speed: 0.1590s/iter; left time: 1698.5469s
Epoch: 31 cost time: 5.639224052429199
Epoch: 31, Steps: 154 | Train Loss: 1.420 Vali Loss: 3.565 Vali Acc: 0.370 Test Loss: 3.565 Test Acc: 0.370
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.7186331
	speed: 0.1583s/iter; left time: 1666.0546s
Epoch: 32 cost time: 5.500519037246704
Epoch: 32, Steps: 154 | Train Loss: 1.193 Vali Loss: 4.016 Vali Acc: 0.382 Test Loss: 4.016 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.8650047
	speed: 0.1642s/iter; left time: 1702.9335s
Epoch: 33 cost time: 5.394026517868042
Epoch: 33, Steps: 154 | Train Loss: 1.372 Vali Loss: 4.008 Vali Acc: 0.225 Test Loss: 4.008 Test Acc: 0.225
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 1.1309319
	speed: 0.1424s/iter; left time: 1455.6384s
Epoch: 34 cost time: 5.201700925827026
Epoch: 34, Steps: 154 | Train Loss: 1.250 Vali Loss: 3.640 Vali Acc: 0.224 Test Loss: 3.640 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 1.0591066
	speed: 0.1383s/iter; left time: 1391.9465s
Epoch: 35 cost time: 4.892847537994385
Epoch: 35, Steps: 154 | Train Loss: 1.488 Vali Loss: 3.683 Vali Acc: 0.288 Test Loss: 3.683 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.8482455
	speed: 0.1385s/iter; left time: 1372.3099s
Epoch: 36 cost time: 5.052841424942017
Epoch: 36, Steps: 154 | Train Loss: 1.372 Vali Loss: 4.046 Vali Acc: 0.254 Test Loss: 4.046 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.5430270
	speed: 0.1368s/iter; left time: 1335.1871s
Epoch: 37 cost time: 4.99373722076416
Epoch: 37, Steps: 154 | Train Loss: 1.224 Vali Loss: 4.178 Vali Acc: 0.377 Test Loss: 4.178 Test Acc: 0.377
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 1.2441404
	speed: 0.1203s/iter; left time: 1154.8041s
Epoch: 38 cost time: 4.483921766281128
Epoch: 38, Steps: 154 | Train Loss: 1.198 Vali Loss: 4.106 Vali Acc: 0.376 Test Loss: 4.106 Test Acc: 0.376
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38361719383617193
model parameter : 135478
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0839386
	speed: 0.0567s/iter; left time: 868.0624s
Epoch: 1 cost time: 7.771789789199829
Epoch: 1, Steps: 154 | Train Loss: 2.257 Vali Loss: 2.149 Vali Acc: 0.323 Test Loss: 2.149 Test Acc: 0.323
Validation loss decreased (inf --> -0.322768).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7270337
	speed: 0.1627s/iter; left time: 2464.0732s
Epoch: 2 cost time: 5.859407424926758
Epoch: 2, Steps: 154 | Train Loss: 2.045 Vali Loss: 2.175 Vali Acc: 0.324 Test Loss: 2.175 Test Acc: 0.324
Validation loss decreased (-0.322768 --> -0.323579).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4763429
	speed: 0.1591s/iter; left time: 2385.1850s
Epoch: 3 cost time: 5.88744044303894
Epoch: 3, Steps: 154 | Train Loss: 1.987 Vali Loss: 2.152 Vali Acc: 0.321 Test Loss: 2.152 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.0319061
	speed: 0.1555s/iter; left time: 2306.8578s
Epoch: 4 cost time: 5.757299423217773
Epoch: 4, Steps: 154 | Train Loss: 1.964 Vali Loss: 2.186 Vali Acc: 0.323 Test Loss: 2.186 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.0405524
	speed: 0.1491s/iter; left time: 2188.9292s
Epoch: 5 cost time: 5.990008592605591
Epoch: 5, Steps: 154 | Train Loss: 1.880 Vali Loss: 2.164 Vali Acc: 0.328 Test Loss: 2.164 Test Acc: 0.328
Validation loss decreased (-0.323579 --> -0.327634).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4467411
	speed: 0.1534s/iter; left time: 2228.9264s
Epoch: 6 cost time: 5.871193885803223
Epoch: 6, Steps: 154 | Train Loss: 1.870 Vali Loss: 2.145 Vali Acc: 0.328 Test Loss: 2.145 Test Acc: 0.328
Validation loss decreased (-0.327634 --> -0.327635).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2483103
	speed: 0.1550s/iter; left time: 2228.3501s
Epoch: 7 cost time: 5.88733172416687
Epoch: 7, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.218 Vali Acc: 0.328 Test Loss: 2.218 Test Acc: 0.328
Validation loss decreased (-0.327635 --> -0.328445).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0943666
	speed: 0.1642s/iter; left time: 2335.5113s
Epoch: 8 cost time: 6.58787202835083
Epoch: 8, Steps: 154 | Train Loss: 1.791 Vali Loss: 2.158 Vali Acc: 0.343 Test Loss: 2.158 Test Acc: 0.343
Validation loss decreased (-0.328445 --> -0.343044).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9338691
	speed: 0.1670s/iter; left time: 2349.4490s
Epoch: 9 cost time: 6.071483612060547
Epoch: 9, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.239 Vali Acc: 0.337 Test Loss: 2.239 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4994518
	speed: 0.1653s/iter; left time: 2300.3794s
Epoch: 10 cost time: 5.747779130935669
Epoch: 10, Steps: 154 | Train Loss: 1.729 Vali Loss: 2.325 Vali Acc: 0.342 Test Loss: 2.325 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.6227534
	speed: 0.1601s/iter; left time: 2203.1418s
Epoch: 11 cost time: 5.5140955448150635
Epoch: 11, Steps: 154 | Train Loss: 1.663 Vali Loss: 2.403 Vali Acc: 0.343 Test Loss: 2.403 Test Acc: 0.343
Validation loss decreased (-0.343044 --> -0.343447).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5237262
	speed: 0.1516s/iter; left time: 2062.9634s
Epoch: 12 cost time: 6.009650230407715
Epoch: 12, Steps: 154 | Train Loss: 1.653 Vali Loss: 2.363 Vali Acc: 0.355 Test Loss: 2.363 Test Acc: 0.355
Validation loss decreased (-0.343447 --> -0.355208).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7178035
	speed: 0.1501s/iter; left time: 2018.6955s
Epoch: 13 cost time: 5.58589768409729
Epoch: 13, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.386 Vali Acc: 0.352 Test Loss: 2.386 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.6441745
	speed: 0.1480s/iter; left time: 1968.5343s
Epoch: 14 cost time: 5.7393269538879395
Epoch: 14, Steps: 154 | Train Loss: 1.571 Vali Loss: 2.397 Vali Acc: 0.354 Test Loss: 2.397 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.9211072
	speed: 0.1504s/iter; left time: 1977.3800s
Epoch: 15 cost time: 5.868576288223267
Epoch: 15, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.374 Vali Acc: 0.356 Test Loss: 2.374 Test Acc: 0.356
Validation loss decreased (-0.355208 --> -0.355613).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4658260
	speed: 0.1542s/iter; left time: 2003.1958s
Epoch: 16 cost time: 6.33607816696167
Epoch: 16, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.494 Vali Acc: 0.355 Test Loss: 2.494 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.2804458
	speed: 0.1660s/iter; left time: 2131.0646s
Epoch: 17 cost time: 5.679534435272217
Epoch: 17, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.765 Vali Acc: 0.357 Test Loss: 2.765 Test Acc: 0.357
Validation loss decreased (-0.355613 --> -0.356826).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.3646305
	speed: 0.1657s/iter; left time: 2101.6314s
Epoch: 18 cost time: 6.134129047393799
Epoch: 18, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.519 Vali Acc: 0.354 Test Loss: 2.519 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.2467687
	speed: 0.1736s/iter; left time: 2175.0040s
Epoch: 19 cost time: 6.558207273483276
Epoch: 19, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.739 Vali Acc: 0.365 Test Loss: 2.739 Test Acc: 0.365
Validation loss decreased (-0.356826 --> -0.364531).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.7039253
	speed: 0.1547s/iter; left time: 1913.8174s
Epoch: 20 cost time: 5.781613826751709
Epoch: 20, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.580 Vali Acc: 0.362 Test Loss: 2.580 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.9914910
	speed: 0.1539s/iter; left time: 1880.8023s
Epoch: 21 cost time: 5.87861180305481
Epoch: 21, Steps: 154 | Train Loss: 1.420 Vali Loss: 3.329 Vali Acc: 0.194 Test Loss: 3.329 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.8816097
	speed: 0.1588s/iter; left time: 1915.7041s
Epoch: 22 cost time: 5.9794533252716064
Epoch: 22, Steps: 154 | Train Loss: 1.390 Vali Loss: 2.953 Vali Acc: 0.368 Test Loss: 2.953 Test Acc: 0.368
Validation loss decreased (-0.364531 --> -0.368178).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.6489735
	speed: 0.1548s/iter; left time: 1844.0817s
Epoch: 23 cost time: 6.2562575340271
Epoch: 23, Steps: 154 | Train Loss: 1.420 Vali Loss: 3.185 Vali Acc: 0.347 Test Loss: 3.185 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.0950147
	speed: 0.1498s/iter; left time: 1761.4772s
Epoch: 24 cost time: 5.4046409130096436
Epoch: 24, Steps: 154 | Train Loss: 1.397 Vali Loss: 3.271 Vali Acc: 0.238 Test Loss: 3.271 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.0586716
	speed: 0.1656s/iter; left time: 1922.2988s
Epoch: 25 cost time: 5.847572326660156
Epoch: 25, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.275 Vali Acc: 0.372 Test Loss: 3.275 Test Acc: 0.372
Validation loss decreased (-0.368178 --> -0.372230).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.7763247
	speed: 0.1680s/iter; left time: 1924.1303s
Epoch: 26 cost time: 6.588628768920898
Epoch: 26, Steps: 154 | Train Loss: 1.388 Vali Loss: 3.139 Vali Acc: 0.212 Test Loss: 3.139 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.3748156
	speed: 0.1644s/iter; left time: 1857.4599s
Epoch: 27 cost time: 5.667850017547607
Epoch: 27, Steps: 154 | Train Loss: 1.371 Vali Loss: 3.254 Vali Acc: 0.371 Test Loss: 3.254 Test Acc: 0.371
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.5994589
	speed: 0.1560s/iter; left time: 1738.2357s
Epoch: 28 cost time: 5.588310956954956
Epoch: 28, Steps: 154 | Train Loss: 1.315 Vali Loss: 3.802 Vali Acc: 0.238 Test Loss: 3.802 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 2.0001144
	speed: 0.1520s/iter; left time: 1670.2373s
Epoch: 29 cost time: 5.738535642623901
Epoch: 29, Steps: 154 | Train Loss: 1.313 Vali Loss: 3.924 Vali Acc: 0.091 Test Loss: 3.924 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.2745893
	speed: 0.1500s/iter; left time: 1625.3650s
Epoch: 30 cost time: 5.899080038070679
Epoch: 30, Steps: 154 | Train Loss: 1.281 Vali Loss: 3.885 Vali Acc: 0.371 Test Loss: 3.885 Test Acc: 0.371
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 1.0352379
	speed: 0.1547s/iter; left time: 1652.4688s
Epoch: 31 cost time: 5.710628032684326
Epoch: 31, Steps: 154 | Train Loss: 1.287 Vali Loss: 4.459 Vali Acc: 0.072 Test Loss: 4.459 Test Acc: 0.072
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 1.2174842
	speed: 0.1527s/iter; left time: 1607.2675s
Epoch: 32 cost time: 5.762832880020142
Epoch: 32, Steps: 154 | Train Loss: 1.433 Vali Loss: 3.504 Vali Acc: 0.355 Test Loss: 3.504 Test Acc: 0.355
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 1.3102622
	speed: 0.1696s/iter; left time: 1759.3895s
Epoch: 33 cost time: 6.860084772109985
Epoch: 33, Steps: 154 | Train Loss: 1.601 Vali Loss: 3.815 Vali Acc: 0.210 Test Loss: 3.815 Test Acc: 0.210
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 1.8219503
	speed: 0.1680s/iter; left time: 1717.0061s
Epoch: 34 cost time: 5.7819664478302
Epoch: 34, Steps: 154 | Train Loss: 1.236 Vali Loss: 4.195 Vali Acc: 0.337 Test Loss: 4.195 Test Acc: 0.337
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.8362592
	speed: 0.1703s/iter; left time: 1714.1901s
Epoch: 35 cost time: 5.96284556388855
Epoch: 35, Steps: 154 | Train Loss: 1.192 Vali Loss: 4.526 Vali Acc: 0.194 Test Loss: 4.526 Test Acc: 0.194
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3722627737226277
model parameter : 119094
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0718603
	speed: 0.0545s/iter; left time: 834.4552s
Epoch: 1 cost time: 7.662620544433594
Epoch: 1, Steps: 154 | Train Loss: 2.244 Vali Loss: 2.154 Vali Acc: 0.322 Test Loss: 2.154 Test Acc: 0.322
Validation loss decreased (inf --> -0.322363).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7225646
	speed: 0.1522s/iter; left time: 2305.0147s
Epoch: 2 cost time: 5.595045566558838
Epoch: 2, Steps: 154 | Train Loss: 2.035 Vali Loss: 2.172 Vali Acc: 0.322 Test Loss: 2.172 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.4734671
	speed: 0.1481s/iter; left time: 2220.6324s
Epoch: 3 cost time: 5.453968048095703
Epoch: 3, Steps: 154 | Train Loss: 1.987 Vali Loss: 2.159 Vali Acc: 0.321 Test Loss: 2.159 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.0289829
	speed: 0.1494s/iter; left time: 2216.7779s
Epoch: 4 cost time: 6.068605422973633
Epoch: 4, Steps: 154 | Train Loss: 1.929 Vali Loss: 2.174 Vali Acc: 0.326 Test Loss: 2.174 Test Acc: 0.326
Validation loss decreased (-0.322363 --> -0.325607).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0401018
	speed: 0.1554s/iter; left time: 2282.2164s
Epoch: 5 cost time: 5.6647772789001465
Epoch: 5, Steps: 154 | Train Loss: 1.862 Vali Loss: 2.149 Vali Acc: 0.329 Test Loss: 2.149 Test Acc: 0.329
Validation loss decreased (-0.325607 --> -0.328851).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4073223
	speed: 0.1596s/iter; left time: 2318.8600s
Epoch: 6 cost time: 5.587908506393433
Epoch: 6, Steps: 154 | Train Loss: 1.867 Vali Loss: 2.160 Vali Acc: 0.328 Test Loss: 2.160 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2851912
	speed: 0.1700s/iter; left time: 2443.9121s
Epoch: 7 cost time: 6.753955602645874
Epoch: 7, Steps: 154 | Train Loss: 1.800 Vali Loss: 2.175 Vali Acc: 0.330 Test Loss: 2.175 Test Acc: 0.330
Validation loss decreased (-0.328851 --> -0.329662).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9905270
	speed: 0.1634s/iter; left time: 2323.8763s
Epoch: 8 cost time: 5.728856086730957
Epoch: 8, Steps: 154 | Train Loss: 1.752 Vali Loss: 2.157 Vali Acc: 0.341 Test Loss: 2.157 Test Acc: 0.341
Validation loss decreased (-0.329662 --> -0.340611).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0684609
	speed: 0.1466s/iter; left time: 2063.1596s
Epoch: 9 cost time: 5.566520929336548
Epoch: 9, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.153 Vali Acc: 0.344 Test Loss: 2.153 Test Acc: 0.344
Validation loss decreased (-0.340611 --> -0.344261).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5746291
	speed: 0.1552s/iter; left time: 2159.4331s
Epoch: 10 cost time: 5.532796382904053
Epoch: 10, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.224 Vali Acc: 0.340 Test Loss: 2.224 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.6298933
	speed: 0.1490s/iter; left time: 2049.9664s
Epoch: 11 cost time: 5.7307093143463135
Epoch: 11, Steps: 154 | Train Loss: 1.658 Vali Loss: 2.448 Vali Acc: 0.346 Test Loss: 2.448 Test Acc: 0.346
Validation loss decreased (-0.344261 --> -0.346285).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4070567
	speed: 0.1563s/iter; left time: 2126.8916s
Epoch: 12 cost time: 5.611907005310059
Epoch: 12, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.394 Vali Acc: 0.342 Test Loss: 2.394 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4169691
	speed: 0.1559s/iter; left time: 2097.3937s
Epoch: 13 cost time: 5.617888689041138
Epoch: 13, Steps: 154 | Train Loss: 1.585 Vali Loss: 2.373 Vali Acc: 0.354 Test Loss: 2.373 Test Acc: 0.354
Validation loss decreased (-0.346285 --> -0.353991).  Saving model ...
	iters: 100, epoch: 14 | loss: 4.1626596
	speed: 0.1672s/iter; left time: 2223.5944s
Epoch: 14 cost time: 6.829310417175293
Epoch: 14, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.491 Vali Acc: 0.353 Test Loss: 2.491 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.0121894
	speed: 0.1707s/iter; left time: 2243.7341s
Epoch: 15 cost time: 6.042304754257202
Epoch: 15, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.376 Vali Acc: 0.362 Test Loss: 2.376 Test Acc: 0.362
Validation loss decreased (-0.353991 --> -0.362101).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4228561
	speed: 0.1533s/iter; left time: 1990.9043s
Epoch: 16 cost time: 5.105889081954956
Epoch: 16, Steps: 154 | Train Loss: 1.653 Vali Loss: 2.508 Vali Acc: 0.358 Test Loss: 2.508 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.2900378
	speed: 0.1448s/iter; left time: 1859.3294s
Epoch: 17 cost time: 6.103114604949951
Epoch: 17, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.646 Vali Acc: 0.361 Test Loss: 2.646 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.3666251
	speed: 0.1505s/iter; left time: 1908.4444s
Epoch: 18 cost time: 5.85288143157959
Epoch: 18, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.625 Vali Acc: 0.364 Test Loss: 2.625 Test Acc: 0.364
Validation loss decreased (-0.362101 --> -0.363721).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.2621430
	speed: 0.1476s/iter; left time: 1849.3954s
Epoch: 19 cost time: 5.243147611618042
Epoch: 19, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.687 Vali Acc: 0.363 Test Loss: 2.687 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.8414345
	speed: 0.1451s/iter; left time: 1795.5605s
Epoch: 20 cost time: 5.56505274772644
Epoch: 20, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.913 Vali Acc: 0.360 Test Loss: 2.913 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.0741338
	speed: 0.1600s/iter; left time: 1955.3290s
Epoch: 21 cost time: 5.9551100730896
Epoch: 21, Steps: 154 | Train Loss: 1.439 Vali Loss: 3.038 Vali Acc: 0.226 Test Loss: 3.038 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.7662641
	speed: 0.1647s/iter; left time: 1987.3943s
Epoch: 22 cost time: 5.961827754974365
Epoch: 22, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.691 Vali Acc: 0.369 Test Loss: 2.691 Test Acc: 0.369
Validation loss decreased (-0.363721 --> -0.368586).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.4846181
	speed: 0.1656s/iter; left time: 1972.3052s
Epoch: 23 cost time: 5.819945573806763
Epoch: 23, Steps: 154 | Train Loss: 1.407 Vali Loss: 3.277 Vali Acc: 0.360 Test Loss: 3.277 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 9.8798561
	speed: 0.1590s/iter; left time: 1869.8503s
Epoch: 24 cost time: 5.61354660987854
Epoch: 24, Steps: 154 | Train Loss: 1.389 Vali Loss: 3.617 Vali Acc: 0.230 Test Loss: 3.617 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.2524028
	speed: 0.1547s/iter; left time: 1795.6470s
Epoch: 25 cost time: 5.908746242523193
Epoch: 25, Steps: 154 | Train Loss: 1.437 Vali Loss: 3.280 Vali Acc: 0.366 Test Loss: 3.280 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.7299217
	speed: 0.1555s/iter; left time: 1780.8147s
Epoch: 26 cost time: 5.982037305831909
Epoch: 26, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.912 Vali Acc: 0.212 Test Loss: 2.912 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.3738031
	speed: 0.1560s/iter; left time: 1762.3845s
Epoch: 27 cost time: 5.935345411300659
Epoch: 27, Steps: 154 | Train Loss: 1.345 Vali Loss: 2.994 Vali Acc: 0.373 Test Loss: 2.994 Test Acc: 0.373
Validation loss decreased (-0.368586 --> -0.372638).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.0909910
	speed: 0.1565s/iter; left time: 1743.8305s
Epoch: 28 cost time: 5.884431838989258
Epoch: 28, Steps: 154 | Train Loss: 1.363 Vali Loss: 3.190 Vali Acc: 0.301 Test Loss: 3.190 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.7473859
	speed: 0.1653s/iter; left time: 1816.9738s
Epoch: 29 cost time: 5.987551689147949
Epoch: 29, Steps: 154 | Train Loss: 1.331 Vali Loss: 3.741 Vali Acc: 0.166 Test Loss: 3.741 Test Acc: 0.166
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 1.2357103
	speed: 0.1694s/iter; left time: 1835.4198s
Epoch: 30 cost time: 6.383891344070435
Epoch: 30, Steps: 154 | Train Loss: 1.193 Vali Loss: 4.011 Vali Acc: 0.371 Test Loss: 4.011 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 1.0344509
	speed: 0.1634s/iter; left time: 1745.4611s
Epoch: 31 cost time: 6.027972221374512
Epoch: 31, Steps: 154 | Train Loss: 1.340 Vali Loss: 3.438 Vali Acc: 0.188 Test Loss: 3.438 Test Acc: 0.188
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.9124738
	speed: 0.1556s/iter; left time: 1638.1656s
Epoch: 32 cost time: 5.5420098304748535
Epoch: 32, Steps: 154 | Train Loss: 1.239 Vali Loss: 3.966 Vali Acc: 0.375 Test Loss: 3.966 Test Acc: 0.375
Validation loss decreased (-0.372638 --> -0.374656).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.1548080
	speed: 0.1518s/iter; left time: 1574.6947s
Epoch: 33 cost time: 5.672152519226074
Epoch: 33, Steps: 154 | Train Loss: 1.479 Vali Loss: 3.944 Vali Acc: 0.371 Test Loss: 3.944 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 2.0482800
	speed: 0.1551s/iter; left time: 1584.8342s
Epoch: 34 cost time: 5.977380752563477
Epoch: 34, Steps: 154 | Train Loss: 1.289 Vali Loss: 4.387 Vali Acc: 0.186 Test Loss: 4.387 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.8117447
	speed: 0.1508s/iter; left time: 1517.6866s
Epoch: 35 cost time: 5.883774518966675
Epoch: 35, Steps: 154 | Train Loss: 1.165 Vali Loss: 4.013 Vali Acc: 0.200 Test Loss: 4.013 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 1.8542898
	speed: 0.1551s/iter; left time: 1537.1495s
Epoch: 36 cost time: 5.575358867645264
Epoch: 36, Steps: 154 | Train Loss: 1.209 Vali Loss: 4.326 Vali Acc: 0.152 Test Loss: 4.326 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.8327085
	speed: 0.1612s/iter; left time: 1572.8356s
Epoch: 37 cost time: 5.881579637527466
Epoch: 37, Steps: 154 | Train Loss: 1.300 Vali Loss: 4.149 Vali Acc: 0.206 Test Loss: 4.149 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 1.0169306
	speed: 0.1631s/iter; left time: 1565.9958s
Epoch: 38 cost time: 5.805646896362305
Epoch: 38, Steps: 154 | Train Loss: 1.238 Vali Loss: 4.251 Vali Acc: 0.125 Test Loss: 4.251 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.6772352
	speed: 0.1766s/iter; left time: 1668.6484s
Epoch: 39 cost time: 6.331696033477783
Epoch: 39, Steps: 154 | Train Loss: 1.158 Vali Loss: 3.817 Vali Acc: 0.113 Test Loss: 3.817 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 1.0399548
	speed: 0.1615s/iter; left time: 1501.2811s
Epoch: 40 cost time: 5.5743088722229
Epoch: 40, Steps: 154 | Train Loss: 1.241 Vali Loss: 4.840 Vali Acc: 0.163 Test Loss: 4.840 Test Acc: 0.163
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 1.0599728
	speed: 0.1490s/iter; left time: 1362.0243s
Epoch: 41 cost time: 5.725891590118408
Epoch: 41, Steps: 154 | Train Loss: 1.308 Vali Loss: 4.294 Vali Acc: 0.107 Test Loss: 4.294 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.8044899
	speed: 0.1562s/iter; left time: 1404.1284s
Epoch: 42 cost time: 5.899042129516602
Epoch: 42, Steps: 154 | Train Loss: 1.114 Vali Loss: 4.543 Vali Acc: 0.374 Test Loss: 4.543 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3746958637469586
model parameter : 119094
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0612464
	speed: 0.0553s/iter; left time: 846.3468s
Epoch: 1 cost time: 7.778285264968872
Epoch: 1, Steps: 154 | Train Loss: 2.233 Vali Loss: 2.142 Vali Acc: 0.321 Test Loss: 2.142 Test Acc: 0.321
Validation loss decreased (inf --> -0.321146).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7118279
	speed: 0.1549s/iter; left time: 2346.4738s
Epoch: 2 cost time: 5.643043518066406
Epoch: 2, Steps: 154 | Train Loss: 2.043 Vali Loss: 2.160 Vali Acc: 0.322 Test Loss: 2.160 Test Acc: 0.322
Validation loss decreased (-0.321146 --> -0.322363).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4717788
	speed: 0.1591s/iter; left time: 2385.0216s
Epoch: 3 cost time: 5.867722988128662
Epoch: 3, Steps: 154 | Train Loss: 1.984 Vali Loss: 2.145 Vali Acc: 0.321 Test Loss: 2.145 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.0170834
	speed: 0.1598s/iter; left time: 2371.5401s
Epoch: 4 cost time: 6.235921144485474
Epoch: 4, Steps: 154 | Train Loss: 1.931 Vali Loss: 2.156 Vali Acc: 0.325 Test Loss: 2.156 Test Acc: 0.325
Validation loss decreased (-0.322363 --> -0.325201).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0242426
	speed: 0.1453s/iter; left time: 2133.5339s
Epoch: 5 cost time: 5.042074680328369
Epoch: 5, Steps: 154 | Train Loss: 1.872 Vali Loss: 2.158 Vali Acc: 0.329 Test Loss: 2.158 Test Acc: 0.329
Validation loss decreased (-0.325201 --> -0.329257).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4211440
	speed: 0.1427s/iter; left time: 2073.2011s
Epoch: 6 cost time: 5.594034194946289
Epoch: 6, Steps: 154 | Train Loss: 1.841 Vali Loss: 2.108 Vali Acc: 0.330 Test Loss: 2.108 Test Acc: 0.330
Validation loss decreased (-0.329257 --> -0.329663).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3295845
	speed: 0.1475s/iter; left time: 2120.3162s
Epoch: 7 cost time: 5.587269067764282
Epoch: 7, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.174 Vali Acc: 0.330 Test Loss: 2.174 Test Acc: 0.330
Validation loss decreased (-0.329663 --> -0.330473).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9781898
	speed: 0.1413s/iter; left time: 2010.3320s
Epoch: 8 cost time: 5.762918949127197
Epoch: 8, Steps: 154 | Train Loss: 1.737 Vali Loss: 2.152 Vali Acc: 0.348 Test Loss: 2.152 Test Acc: 0.348
Validation loss decreased (-0.330473 --> -0.348316).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2151814
	speed: 0.1478s/iter; left time: 2080.0929s
Epoch: 9 cost time: 5.4026939868927
Epoch: 9, Steps: 154 | Train Loss: 1.748 Vali Loss: 2.174 Vali Acc: 0.345 Test Loss: 2.174 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5356646
	speed: 0.1415s/iter; left time: 1969.6638s
Epoch: 10 cost time: 5.586965084075928
Epoch: 10, Steps: 154 | Train Loss: 1.727 Vali Loss: 2.277 Vali Acc: 0.347 Test Loss: 2.277 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5199182
	speed: 0.1626s/iter; left time: 2237.6443s
Epoch: 11 cost time: 6.394355773925781
Epoch: 11, Steps: 154 | Train Loss: 1.660 Vali Loss: 2.412 Vali Acc: 0.346 Test Loss: 2.412 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.5961879
	speed: 0.1595s/iter; left time: 2170.5818s
Epoch: 12 cost time: 5.665891885757446
Epoch: 12, Steps: 154 | Train Loss: 1.649 Vali Loss: 2.343 Vali Acc: 0.356 Test Loss: 2.343 Test Acc: 0.356
Validation loss decreased (-0.348316 --> -0.356424).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4025438
	speed: 0.1595s/iter; left time: 2145.6641s
Epoch: 13 cost time: 5.511728525161743
Epoch: 13, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.429 Vali Acc: 0.359 Test Loss: 2.429 Test Acc: 0.359
Validation loss decreased (-0.356424 --> -0.359262).  Saving model ...
	iters: 100, epoch: 14 | loss: 7.3886123
	speed: 0.1492s/iter; left time: 1983.7766s
Epoch: 14 cost time: 5.840243339538574
Epoch: 14, Steps: 154 | Train Loss: 1.656 Vali Loss: 2.436 Vali Acc: 0.357 Test Loss: 2.436 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.0779004
	speed: 0.1479s/iter; left time: 1944.3950s
Epoch: 15 cost time: 6.017867088317871
Epoch: 15, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.443 Vali Acc: 0.356 Test Loss: 2.443 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.3534505
	speed: 0.1469s/iter; left time: 1908.9011s
Epoch: 16 cost time: 5.873086214065552
Epoch: 16, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.531 Vali Acc: 0.352 Test Loss: 2.531 Test Acc: 0.352
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.2516209
	speed: 0.1438s/iter; left time: 1845.5024s
Epoch: 17 cost time: 5.430514097213745
Epoch: 17, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.708 Vali Acc: 0.358 Test Loss: 2.708 Test Acc: 0.358
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.2360781
	speed: 0.1466s/iter; left time: 1858.8453s
Epoch: 18 cost time: 5.668334722518921
Epoch: 18, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.555 Vali Acc: 0.362 Test Loss: 2.555 Test Acc: 0.362
Validation loss decreased (-0.359262 --> -0.362099).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.1229985
	speed: 0.1551s/iter; left time: 1942.6358s
Epoch: 19 cost time: 5.582830190658569
Epoch: 19, Steps: 154 | Train Loss: 1.445 Vali Loss: 2.685 Vali Acc: 0.365 Test Loss: 2.685 Test Acc: 0.365
Validation loss decreased (-0.362099 --> -0.364937).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.3723747
	speed: 0.1329s/iter; left time: 1644.3370s
Epoch: 20 cost time: 5.0253002643585205
Epoch: 20, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.894 Vali Acc: 0.358 Test Loss: 2.894 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.0868855
	speed: 0.1576s/iter; left time: 1926.0164s
Epoch: 21 cost time: 5.563914775848389
Epoch: 21, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.862 Vali Acc: 0.319 Test Loss: 2.862 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.8839486
	speed: 0.1438s/iter; left time: 1735.3211s
Epoch: 22 cost time: 5.3403000831604
Epoch: 22, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.681 Vali Acc: 0.370 Test Loss: 2.681 Test Acc: 0.370
Validation loss decreased (-0.364937 --> -0.370208).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.3925122
	speed: 0.1402s/iter; left time: 1670.7884s
Epoch: 23 cost time: 5.747168302536011
Epoch: 23, Steps: 154 | Train Loss: 1.424 Vali Loss: 3.007 Vali Acc: 0.372 Test Loss: 3.007 Test Acc: 0.372
Validation loss decreased (-0.370208 --> -0.371827).  Saving model ...
	iters: 100, epoch: 24 | loss: 7.2961106
	speed: 0.1415s/iter; left time: 1664.4701s
Epoch: 24 cost time: 5.351725816726685
Epoch: 24, Steps: 154 | Train Loss: 1.369 Vali Loss: 3.772 Vali Acc: 0.361 Test Loss: 3.772 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.1587259
	speed: 0.1391s/iter; left time: 1614.4653s
Epoch: 25 cost time: 5.191481590270996
Epoch: 25, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.355 Vali Acc: 0.373 Test Loss: 3.355 Test Acc: 0.373
Validation loss decreased (-0.371827 --> -0.373040).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.7229106
	speed: 0.1442s/iter; left time: 1651.1348s
Epoch: 26 cost time: 5.402812242507935
Epoch: 26, Steps: 154 | Train Loss: 1.419 Vali Loss: 3.503 Vali Acc: 0.278 Test Loss: 3.503 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.3539734
	speed: 0.1518s/iter; left time: 1714.5748s
Epoch: 27 cost time: 5.83536696434021
Epoch: 27, Steps: 154 | Train Loss: 1.364 Vali Loss: 3.259 Vali Acc: 0.369 Test Loss: 3.259 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.0433235
	speed: 0.1560s/iter; left time: 1738.8429s
Epoch: 28 cost time: 5.717002630233765
Epoch: 28, Steps: 154 | Train Loss: 1.216 Vali Loss: 3.656 Vali Acc: 0.362 Test Loss: 3.656 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.5849692
	speed: 0.1629s/iter; left time: 1789.9804s
Epoch: 29 cost time: 5.648104667663574
Epoch: 29, Steps: 154 | Train Loss: 1.273 Vali Loss: 3.682 Vali Acc: 0.213 Test Loss: 3.682 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.2912148
	speed: 0.1493s/iter; left time: 1618.0951s
Epoch: 30 cost time: 5.561593294143677
Epoch: 30, Steps: 154 | Train Loss: 1.397 Vali Loss: 3.534 Vali Acc: 0.383 Test Loss: 3.534 Test Acc: 0.383
Validation loss decreased (-0.373040 --> -0.383176).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.9130273
	speed: 0.1496s/iter; left time: 1597.6309s
Epoch: 31 cost time: 6.015979290008545
Epoch: 31, Steps: 154 | Train Loss: 1.202 Vali Loss: 3.888 Vali Acc: 0.207 Test Loss: 3.888 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.9117030
	speed: 0.1416s/iter; left time: 1490.3771s
Epoch: 32 cost time: 5.492493391036987
Epoch: 32, Steps: 154 | Train Loss: 1.248 Vali Loss: 3.844 Vali Acc: 0.375 Test Loss: 3.844 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 1.5587745
	speed: 0.1444s/iter; left time: 1497.5101s
Epoch: 33 cost time: 5.612975597381592
Epoch: 33, Steps: 154 | Train Loss: 1.166 Vali Loss: 3.546 Vali Acc: 0.378 Test Loss: 3.546 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 2.6897790
	speed: 0.1408s/iter; left time: 1439.2492s
Epoch: 34 cost time: 5.374500036239624
Epoch: 34, Steps: 154 | Train Loss: 1.338 Vali Loss: 3.939 Vali Acc: 0.377 Test Loss: 3.939 Test Acc: 0.377
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.8506373
	speed: 0.1479s/iter; left time: 1488.5143s
Epoch: 35 cost time: 5.641487121582031
Epoch: 35, Steps: 154 | Train Loss: 1.365 Vali Loss: 4.150 Vali Acc: 0.219 Test Loss: 4.150 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 1.3269694
	speed: 0.1592s/iter; left time: 1577.6731s
Epoch: 36 cost time: 5.996293306350708
Epoch: 36, Steps: 154 | Train Loss: 1.206 Vali Loss: 4.586 Vali Acc: 0.232 Test Loss: 4.586 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.6386032
	speed: 0.1539s/iter; left time: 1501.1979s
Epoch: 37 cost time: 5.435550928115845
Epoch: 37, Steps: 154 | Train Loss: 1.278 Vali Loss: 4.686 Vali Acc: 0.204 Test Loss: 4.686 Test Acc: 0.204
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.9798748
	speed: 0.1509s/iter; left time: 1448.9680s
Epoch: 38 cost time: 5.315029859542847
Epoch: 38, Steps: 154 | Train Loss: 1.165 Vali Loss: 4.368 Vali Acc: 0.150 Test Loss: 4.368 Test Acc: 0.150
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.8787676
	speed: 0.1417s/iter; left time: 1338.5915s
Epoch: 39 cost time: 5.408493995666504
Epoch: 39, Steps: 154 | Train Loss: 1.423 Vali Loss: 4.393 Vali Acc: 0.285 Test Loss: 4.393 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 1.4748201
	speed: 0.1409s/iter; left time: 1310.0247s
Epoch: 40 cost time: 5.807839870452881
Epoch: 40, Steps: 154 | Train Loss: 1.080 Vali Loss: 4.471 Vali Acc: 0.190 Test Loss: 4.471 Test Acc: 0.190
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38321167883211676
model parameter : 119094
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0513699
	speed: 0.0504s/iter; left time: 770.4930s
Epoch: 1 cost time: 6.838658332824707
Epoch: 1, Steps: 154 | Train Loss: 2.225 Vali Loss: 2.142 Vali Acc: 0.322 Test Loss: 2.142 Test Acc: 0.322
Validation loss decreased (inf --> -0.321552).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7262579
	speed: 0.1476s/iter; left time: 2235.1370s
Epoch: 2 cost time: 5.313116550445557
Epoch: 2, Steps: 154 | Train Loss: 2.052 Vali Loss: 2.160 Vali Acc: 0.322 Test Loss: 2.160 Test Acc: 0.322
Validation loss decreased (-0.321552 --> -0.321957).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4528551
	speed: 0.1553s/iter; left time: 2327.8600s
Epoch: 3 cost time: 5.915127277374268
Epoch: 3, Steps: 154 | Train Loss: 1.984 Vali Loss: 2.139 Vali Acc: 0.321 Test Loss: 2.139 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.0600452
	speed: 0.1528s/iter; left time: 2267.6662s
Epoch: 4 cost time: 5.248998403549194
Epoch: 4, Steps: 154 | Train Loss: 1.947 Vali Loss: 2.159 Vali Acc: 0.325 Test Loss: 2.159 Test Acc: 0.325
Validation loss decreased (-0.321957 --> -0.324796).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0789225
	speed: 0.1546s/iter; left time: 2269.6243s
Epoch: 5 cost time: 4.9811131954193115
Epoch: 5, Steps: 154 | Train Loss: 1.871 Vali Loss: 2.158 Vali Acc: 0.330 Test Loss: 2.158 Test Acc: 0.330
Validation loss decreased (-0.324796 --> -0.330473).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4193842
	speed: 0.1403s/iter; left time: 2039.3195s
Epoch: 6 cost time: 5.409329891204834
Epoch: 6, Steps: 154 | Train Loss: 1.867 Vali Loss: 2.141 Vali Acc: 0.334 Test Loss: 2.141 Test Acc: 0.334
Validation loss decreased (-0.330473 --> -0.333717).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3769190
	speed: 0.1389s/iter; left time: 1996.4897s
Epoch: 7 cost time: 5.288356781005859
Epoch: 7, Steps: 154 | Train Loss: 1.802 Vali Loss: 2.185 Vali Acc: 0.338 Test Loss: 2.185 Test Acc: 0.338
Validation loss decreased (-0.333717 --> -0.337772).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9689192
	speed: 0.1349s/iter; left time: 1918.4395s
Epoch: 8 cost time: 5.064530849456787
Epoch: 8, Steps: 154 | Train Loss: 1.755 Vali Loss: 2.252 Vali Acc: 0.252 Test Loss: 2.252 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.1034570
	speed: 0.1431s/iter; left time: 2013.3075s
Epoch: 9 cost time: 5.034196615219116
Epoch: 9, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.223 Vali Acc: 0.353 Test Loss: 2.223 Test Acc: 0.353
Validation loss decreased (-0.337772 --> -0.352776).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4584409
	speed: 0.1331s/iter; left time: 1851.4256s
Epoch: 10 cost time: 4.878468990325928
Epoch: 10, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.263 Vali Acc: 0.352 Test Loss: 2.263 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4278991
	speed: 0.1441s/iter; left time: 1982.7482s
Epoch: 11 cost time: 5.594855546951294
Epoch: 11, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.497 Vali Acc: 0.346 Test Loss: 2.497 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.7207172
	speed: 0.1534s/iter; left time: 2087.4818s
Epoch: 12 cost time: 5.034958124160767
Epoch: 12, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.424 Vali Acc: 0.201 Test Loss: 2.424 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.9880935
	speed: 0.1572s/iter; left time: 2114.7127s
Epoch: 13 cost time: 5.390763521194458
Epoch: 13, Steps: 154 | Train Loss: 1.649 Vali Loss: 2.438 Vali Acc: 0.360 Test Loss: 2.438 Test Acc: 0.360
Validation loss decreased (-0.352776 --> -0.359667).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.8298534
	speed: 0.1437s/iter; left time: 1910.9955s
Epoch: 14 cost time: 5.428600311279297
Epoch: 14, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.475 Vali Acc: 0.361 Test Loss: 2.475 Test Acc: 0.361
Validation loss decreased (-0.359667 --> -0.360884).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.9970969
	speed: 0.1397s/iter; left time: 1836.2594s
Epoch: 15 cost time: 5.048246622085571
Epoch: 15, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.533 Vali Acc: 0.358 Test Loss: 2.533 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.3632565
	speed: 0.1411s/iter; left time: 1833.5117s
Epoch: 16 cost time: 5.048218727111816
Epoch: 16, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.404 Vali Acc: 0.360 Test Loss: 2.404 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.2638867
	speed: 0.1425s/iter; left time: 1829.1911s
Epoch: 17 cost time: 5.387685060501099
Epoch: 17, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.485 Vali Acc: 0.362 Test Loss: 2.485 Test Acc: 0.362
Validation loss decreased (-0.360884 --> -0.361695).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.3621620
	speed: 0.1446s/iter; left time: 1833.3973s
Epoch: 18 cost time: 5.4689319133758545
Epoch: 18, Steps: 154 | Train Loss: 1.691 Vali Loss: 2.510 Vali Acc: 0.367 Test Loss: 2.510 Test Acc: 0.367
Validation loss decreased (-0.361695 --> -0.366560).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.0747088
	speed: 0.1408s/iter; left time: 1763.5340s
Epoch: 19 cost time: 5.643915414810181
Epoch: 19, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.934 Vali Acc: 0.357 Test Loss: 2.934 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.5625859
	speed: 0.1472s/iter; left time: 1821.6398s
Epoch: 20 cost time: 4.743510007858276
Epoch: 20, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.931 Vali Acc: 0.356 Test Loss: 2.931 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.1601765
	speed: 0.1440s/iter; left time: 1759.8761s
Epoch: 21 cost time: 5.3708250522613525
Epoch: 21, Steps: 154 | Train Loss: 1.425 Vali Loss: 2.841 Vali Acc: 0.365 Test Loss: 2.841 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.8310304
	speed: 0.1562s/iter; left time: 1884.6552s
Epoch: 22 cost time: 5.687236070632935
Epoch: 22, Steps: 154 | Train Loss: 1.554 Vali Loss: 2.847 Vali Acc: 0.374 Test Loss: 2.847 Test Acc: 0.374
Validation loss decreased (-0.366560 --> -0.373856).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.3408934
	speed: 0.1335s/iter; left time: 1590.6733s
Epoch: 23 cost time: 4.899479389190674
Epoch: 23, Steps: 154 | Train Loss: 1.290 Vali Loss: 2.770 Vali Acc: 0.376 Test Loss: 2.770 Test Acc: 0.376
Validation loss decreased (-0.373856 --> -0.375479).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.8586032
	speed: 0.1373s/iter; left time: 1614.2701s
Epoch: 24 cost time: 5.065556049346924
Epoch: 24, Steps: 154 | Train Loss: 1.539 Vali Loss: 3.227 Vali Acc: 0.368 Test Loss: 3.227 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.1154981
	speed: 0.1342s/iter; left time: 1557.6031s
Epoch: 25 cost time: 5.123767375946045
Epoch: 25, Steps: 154 | Train Loss: 1.408 Vali Loss: 3.144 Vali Acc: 0.374 Test Loss: 3.144 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.0315473
	speed: 0.1342s/iter; left time: 1536.7231s
Epoch: 26 cost time: 5.200033187866211
Epoch: 26, Steps: 154 | Train Loss: 1.269 Vali Loss: 3.079 Vali Acc: 0.377 Test Loss: 3.079 Test Acc: 0.377
Validation loss decreased (-0.375479 --> -0.376693).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.3184558
	speed: 0.1351s/iter; left time: 1526.3076s
Epoch: 27 cost time: 4.991949081420898
Epoch: 27, Steps: 154 | Train Loss: 1.588 Vali Loss: 3.116 Vali Acc: 0.365 Test Loss: 3.116 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.0189197
	speed: 0.1437s/iter; left time: 1601.4268s
Epoch: 28 cost time: 5.225675582885742
Epoch: 28, Steps: 154 | Train Loss: 1.334 Vali Loss: 3.340 Vali Acc: 0.239 Test Loss: 3.340 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.3664485
	speed: 0.1531s/iter; left time: 1681.8726s
Epoch: 29 cost time: 5.225628852844238
Epoch: 29, Steps: 154 | Train Loss: 1.287 Vali Loss: 3.470 Vali Acc: 0.222 Test Loss: 3.470 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.1264870
	speed: 0.1521s/iter; left time: 1647.7115s
Epoch: 30 cost time: 5.495290040969849
Epoch: 30, Steps: 154 | Train Loss: 1.411 Vali Loss: 3.705 Vali Acc: 0.379 Test Loss: 3.705 Test Acc: 0.379
Validation loss decreased (-0.376693 --> -0.378714).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.9573302
	speed: 0.1495s/iter; left time: 1596.8315s
Epoch: 31 cost time: 5.042625665664673
Epoch: 31, Steps: 154 | Train Loss: 1.604 Vali Loss: 3.884 Vali Acc: 0.341 Test Loss: 3.884 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 1.1367109
	speed: 0.1413s/iter; left time: 1487.2951s
Epoch: 32 cost time: 5.17574667930603
Epoch: 32, Steps: 154 | Train Loss: 1.307 Vali Loss: 4.361 Vali Acc: 0.382 Test Loss: 4.361 Test Acc: 0.382
Validation loss decreased (-0.378714 --> -0.381546).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.1950334
	speed: 0.1445s/iter; left time: 1498.4092s
Epoch: 33 cost time: 5.492286205291748
Epoch: 33, Steps: 154 | Train Loss: 1.236 Vali Loss: 3.543 Vali Acc: 0.374 Test Loss: 3.543 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 1.3207587
	speed: 0.1422s/iter; left time: 1452.9950s
Epoch: 34 cost time: 5.266488790512085
Epoch: 34, Steps: 154 | Train Loss: 1.302 Vali Loss: 3.704 Vali Acc: 0.376 Test Loss: 3.704 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.8134702
	speed: 0.1410s/iter; left time: 1418.8146s
Epoch: 35 cost time: 5.3284759521484375
Epoch: 35, Steps: 154 | Train Loss: 1.071 Vali Loss: 3.643 Vali Acc: 0.219 Test Loss: 3.643 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 1.4284693
	speed: 0.1399s/iter; left time: 1386.3487s
Epoch: 36 cost time: 5.223466396331787
Epoch: 36, Steps: 154 | Train Loss: 1.189 Vali Loss: 3.685 Vali Acc: 0.370 Test Loss: 3.685 Test Acc: 0.370
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.6195771
	speed: 0.1517s/iter; left time: 1480.1464s
Epoch: 37 cost time: 6.051145792007446
Epoch: 37, Steps: 154 | Train Loss: 1.116 Vali Loss: 4.091 Vali Acc: 0.254 Test Loss: 4.091 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 1.0286047
	speed: 0.1516s/iter; left time: 1455.8460s
Epoch: 38 cost time: 5.4212729930877686
Epoch: 38, Steps: 154 | Train Loss: 1.215 Vali Loss: 4.617 Vali Acc: 0.195 Test Loss: 4.617 Test Acc: 0.195
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.9415124
	speed: 0.1446s/iter; left time: 1365.9625s
Epoch: 39 cost time: 4.702472925186157
Epoch: 39, Steps: 154 | Train Loss: 1.148 Vali Loss: 3.949 Vali Acc: 0.380 Test Loss: 3.949 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 1.6760733
	speed: 0.1617s/iter; left time: 1503.1941s
Epoch: 40 cost time: 5.899080753326416
Epoch: 40, Steps: 154 | Train Loss: 1.148 Vali Loss: 4.347 Vali Acc: 0.213 Test Loss: 4.347 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.9604000
	speed: 0.1135s/iter; left time: 1037.3962s
Epoch: 41 cost time: 4.165729761123657
Epoch: 41, Steps: 154 | Train Loss: 1.351 Vali Loss: 4.213 Vali Acc: 0.112 Test Loss: 4.213 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.7289572
	speed: 0.1124s/iter; left time: 1009.8631s
Epoch: 42 cost time: 4.562563180923462
Epoch: 42, Steps: 154 | Train Loss: 1.170 Vali Loss: 4.349 Vali Acc: 0.386 Test Loss: 4.349 Test Acc: 0.386
Validation loss decreased (-0.381546 --> -0.386007).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.9759872
	speed: 0.1367s/iter; left time: 1207.4894s
Epoch: 43 cost time: 4.993981122970581
Epoch: 43, Steps: 154 | Train Loss: 1.194 Vali Loss: 4.142 Vali Acc: 0.394 Test Loss: 4.142 Test Acc: 0.394
Validation loss decreased (-0.386007 --> -0.393714).  Saving model ...
	iters: 100, epoch: 44 | loss: 0.6789808
	speed: 0.1343s/iter; left time: 1165.9374s
Epoch: 44 cost time: 5.204266548156738
Epoch: 44, Steps: 154 | Train Loss: 1.037 Vali Loss: 4.906 Vali Acc: 0.224 Test Loss: 4.906 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 0.9673396
	speed: 0.1386s/iter; left time: 1181.9109s
Epoch: 45 cost time: 5.143056869506836
Epoch: 45, Steps: 154 | Train Loss: 1.225 Vali Loss: 4.664 Vali Acc: 0.201 Test Loss: 4.664 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 0.7130927
	speed: 0.1390s/iter; left time: 1163.9515s
Epoch: 46 cost time: 5.13434910774231
Epoch: 46, Steps: 154 | Train Loss: 1.307 Vali Loss: 5.010 Vali Acc: 0.112 Test Loss: 5.010 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 47 | loss: 0.7558069
	speed: 0.1435s/iter; left time: 1178.7411s
Epoch: 47 cost time: 5.043710470199585
Epoch: 47, Steps: 154 | Train Loss: 1.211 Vali Loss: 4.058 Vali Acc: 0.290 Test Loss: 4.058 Test Acc: 0.290
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 48 | loss: 1.0777552
	speed: 0.1524s/iter; left time: 1228.9622s
Epoch: 48 cost time: 5.373163938522339
Epoch: 48, Steps: 154 | Train Loss: 1.172 Vali Loss: 4.516 Vali Acc: 0.234 Test Loss: 4.516 Test Acc: 0.234
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 49 | loss: 0.6711166
	speed: 0.1340s/iter; left time: 1059.5927s
Epoch: 49 cost time: 4.7954676151275635
Epoch: 49, Steps: 154 | Train Loss: 1.163 Vali Loss: 4.929 Vali Acc: 0.166 Test Loss: 4.929 Test Acc: 0.166
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 50 | loss: 0.6321955
	speed: 0.1589s/iter; left time: 1232.2289s
Epoch: 50 cost time: 5.624940395355225
Epoch: 50, Steps: 154 | Train Loss: 1.293 Vali Loss: 4.122 Vali Acc: 0.385 Test Loss: 4.122 Test Acc: 0.385
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 51 | loss: 0.9532732
	speed: 0.1498s/iter; left time: 1138.2620s
Epoch: 51 cost time: 5.815064907073975
Epoch: 51, Steps: 154 | Train Loss: 0.960 Vali Loss: 4.758 Vali Acc: 0.214 Test Loss: 4.758 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 52 | loss: 0.9596185
	speed: 0.1410s/iter; left time: 1050.2851s
Epoch: 52 cost time: 5.174519777297974
Epoch: 52, Steps: 154 | Train Loss: 0.965 Vali Loss: 5.031 Vali Acc: 0.186 Test Loss: 5.031 Test Acc: 0.186
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 53 | loss: 0.3627465
	speed: 0.1420s/iter; left time: 1035.9090s
Epoch: 53 cost time: 5.305615425109863
Epoch: 53, Steps: 154 | Train Loss: 1.033 Vali Loss: 5.457 Vali Acc: 0.126 Test Loss: 5.457 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3937550689375507
model parameter : 119094
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9348582
	speed: 0.0526s/iter; left time: 805.2554s
Epoch: 1 cost time: 7.451208591461182
Epoch: 1, Steps: 154 | Train Loss: 2.285 Vali Loss: 2.152 Vali Acc: 0.320 Test Loss: 2.152 Test Acc: 0.320
Validation loss decreased (inf --> -0.319524).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7057986
	speed: 0.1369s/iter; left time: 2073.3098s
Epoch: 2 cost time: 5.096667528152466
Epoch: 2, Steps: 154 | Train Loss: 2.070 Vali Loss: 2.138 Vali Acc: 0.324 Test Loss: 2.138 Test Acc: 0.324
Validation loss decreased (-0.319524 --> -0.323580).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8013142
	speed: 0.1385s/iter; left time: 2076.4956s
Epoch: 3 cost time: 5.268148183822632
Epoch: 3, Steps: 154 | Train Loss: 2.012 Vali Loss: 2.165 Vali Acc: 0.322 Test Loss: 2.165 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3081579
	speed: 0.1307s/iter; left time: 1939.5113s
Epoch: 4 cost time: 5.3022918701171875
Epoch: 4, Steps: 154 | Train Loss: 1.973 Vali Loss: 2.141 Vali Acc: 0.323 Test Loss: 2.141 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.6743069
	speed: 0.1403s/iter; left time: 2059.7800s
Epoch: 5 cost time: 5.068462371826172
Epoch: 5, Steps: 154 | Train Loss: 1.933 Vali Loss: 2.131 Vali Acc: 0.326 Test Loss: 2.131 Test Acc: 0.326
Validation loss decreased (-0.323580 --> -0.326013).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9206706
	speed: 0.1287s/iter; left time: 1869.9937s
Epoch: 6 cost time: 5.766191244125366
Epoch: 6, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.128 Vali Acc: 0.327 Test Loss: 2.128 Test Acc: 0.327
Validation loss decreased (-0.326013 --> -0.327229).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9619640
	speed: 0.1362s/iter; left time: 1958.8319s
Epoch: 7 cost time: 5.243244409561157
Epoch: 7, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.159 Vali Acc: 0.330 Test Loss: 2.159 Test Acc: 0.330
Validation loss decreased (-0.327229 --> -0.329662).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7091355
	speed: 0.1415s/iter; left time: 2013.0196s
Epoch: 8 cost time: 5.411943674087524
Epoch: 8, Steps: 154 | Train Loss: 1.816 Vali Loss: 2.165 Vali Acc: 0.329 Test Loss: 2.165 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7808151
	speed: 0.1288s/iter; left time: 1811.6085s
Epoch: 9 cost time: 5.428753852844238
Epoch: 9, Steps: 154 | Train Loss: 1.797 Vali Loss: 2.152 Vali Acc: 0.328 Test Loss: 2.152 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.4723699
	speed: 0.1398s/iter; left time: 1945.7546s
Epoch: 10 cost time: 5.336896657943726
Epoch: 10, Steps: 154 | Train Loss: 1.770 Vali Loss: 2.166 Vali Acc: 0.333 Test Loss: 2.166 Test Acc: 0.333
Validation loss decreased (-0.329662 --> -0.333312).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7461563
	speed: 0.1379s/iter; left time: 1897.0858s
Epoch: 11 cost time: 5.058144807815552
Epoch: 11, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.170 Vali Acc: 0.336 Test Loss: 2.170 Test Acc: 0.336
Validation loss decreased (-0.333312 --> -0.336150).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7777946
	speed: 0.1356s/iter; left time: 1844.6703s
Epoch: 12 cost time: 5.718332052230835
Epoch: 12, Steps: 154 | Train Loss: 1.731 Vali Loss: 2.151 Vali Acc: 0.336 Test Loss: 2.151 Test Acc: 0.336
Validation loss decreased (-0.336150 --> -0.336150).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6534760
	speed: 0.1475s/iter; left time: 1983.8525s
Epoch: 13 cost time: 5.466766595840454
Epoch: 13, Steps: 154 | Train Loss: 1.702 Vali Loss: 2.210 Vali Acc: 0.337 Test Loss: 2.210 Test Acc: 0.337
Validation loss decreased (-0.336150 --> -0.336555).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5073659
	speed: 0.1482s/iter; left time: 1970.4733s
Epoch: 14 cost time: 6.062117576599121
Epoch: 14, Steps: 154 | Train Loss: 1.687 Vali Loss: 2.273 Vali Acc: 0.342 Test Loss: 2.273 Test Acc: 0.342
Validation loss decreased (-0.336555 --> -0.342232).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.8181781
	speed: 0.1344s/iter; left time: 1766.7041s
Epoch: 15 cost time: 5.579256772994995
Epoch: 15, Steps: 154 | Train Loss: 1.674 Vali Loss: 2.300 Vali Acc: 0.343 Test Loss: 2.300 Test Acc: 0.343
Validation loss decreased (-0.342232 --> -0.342637).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5210382
	speed: 0.1430s/iter; left time: 1857.8619s
Epoch: 16 cost time: 5.5874505043029785
Epoch: 16, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.286 Vali Acc: 0.346 Test Loss: 2.286 Test Acc: 0.346
Validation loss decreased (-0.342637 --> -0.346287).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.7759056
	speed: 0.1409s/iter; left time: 1808.8297s
Epoch: 17 cost time: 5.72186017036438
Epoch: 17, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.381 Vali Acc: 0.189 Test Loss: 2.381 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.4162874
	speed: 0.1338s/iter; left time: 1696.5325s
Epoch: 18 cost time: 5.394219398498535
Epoch: 18, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.342 Vali Acc: 0.347 Test Loss: 2.342 Test Acc: 0.347
Validation loss decreased (-0.346287 --> -0.347097).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.2921164
	speed: 0.1413s/iter; left time: 1770.0098s
Epoch: 19 cost time: 5.41820502281189
Epoch: 19, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.187 Vali Acc: 0.359 Test Loss: 2.187 Test Acc: 0.359
Validation loss decreased (-0.347097 --> -0.358859).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.1901215
	speed: 0.1350s/iter; left time: 1670.8325s
Epoch: 20 cost time: 5.374223709106445
Epoch: 20, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.287 Vali Acc: 0.349 Test Loss: 2.287 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.6748724
	speed: 0.1333s/iter; left time: 1628.4583s
Epoch: 21 cost time: 5.475701332092285
Epoch: 21, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.373 Vali Acc: 0.356 Test Loss: 2.373 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.7415198
	speed: 0.1425s/iter; left time: 1720.0802s
Epoch: 22 cost time: 4.506040096282959
Epoch: 22, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.489 Vali Acc: 0.357 Test Loss: 2.489 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.0964934
	speed: 0.1305s/iter; left time: 1554.4983s
Epoch: 23 cost time: 5.5870466232299805
Epoch: 23, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.398 Vali Acc: 0.355 Test Loss: 2.398 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.4313293
	speed: 0.1420s/iter; left time: 1670.1587s
Epoch: 24 cost time: 5.118750095367432
Epoch: 24, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.532 Vali Acc: 0.364 Test Loss: 2.532 Test Acc: 0.364
Validation loss decreased (-0.358859 --> -0.364127).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.6133214
	speed: 0.1416s/iter; left time: 1643.0864s
Epoch: 25 cost time: 5.541053533554077
Epoch: 25, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.437 Vali Acc: 0.369 Test Loss: 2.437 Test Acc: 0.369
Validation loss decreased (-0.364127 --> -0.368589).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.9126662
	speed: 0.1313s/iter; left time: 1503.1837s
Epoch: 26 cost time: 5.383432865142822
Epoch: 26, Steps: 154 | Train Loss: 1.538 Vali Loss: 2.586 Vali Acc: 0.354 Test Loss: 2.586 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.3584610
	speed: 0.1416s/iter; left time: 1599.5008s
Epoch: 27 cost time: 5.497063159942627
Epoch: 27, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.522 Vali Acc: 0.368 Test Loss: 2.522 Test Acc: 0.368
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.0976508
	speed: 0.1411s/iter; left time: 1571.9036s
Epoch: 28 cost time: 5.43890118598938
Epoch: 28, Steps: 154 | Train Loss: 1.412 Vali Loss: 2.558 Vali Acc: 0.363 Test Loss: 2.558 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.1108534
	speed: 0.1329s/iter; left time: 1459.9466s
Epoch: 29 cost time: 5.3523781299591064
Epoch: 29, Steps: 154 | Train Loss: 1.399 Vali Loss: 2.702 Vali Acc: 0.359 Test Loss: 2.702 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.5026522
	speed: 0.1349s/iter; left time: 1461.7905s
Epoch: 30 cost time: 5.301357269287109
Epoch: 30, Steps: 154 | Train Loss: 1.383 Vali Loss: 2.697 Vali Acc: 0.363 Test Loss: 2.697 Test Acc: 0.363
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 1.1896108
	speed: 0.1471s/iter; left time: 1571.2250s
Epoch: 31 cost time: 5.666525840759277
Epoch: 31, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.154 Vali Acc: 0.369 Test Loss: 3.154 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 1.3718255
	speed: 0.1377s/iter; left time: 1449.6133s
Epoch: 32 cost time: 5.278213024139404
Epoch: 32, Steps: 154 | Train Loss: 1.388 Vali Loss: 2.628 Vali Acc: 0.371 Test Loss: 2.628 Test Acc: 0.371
Validation loss decreased (-0.368589 --> -0.370614).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.5030966
	speed: 0.1427s/iter; left time: 1480.6256s
Epoch: 33 cost time: 5.588696479797363
Epoch: 33, Steps: 154 | Train Loss: 1.425 Vali Loss: 2.841 Vali Acc: 0.371 Test Loss: 2.841 Test Acc: 0.371
Validation loss decreased (-0.370614 --> -0.371018).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.3075999
	speed: 0.1402s/iter; left time: 1432.5170s
Epoch: 34 cost time: 5.574703216552734
Epoch: 34, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.773 Vali Acc: 0.373 Test Loss: 2.773 Test Acc: 0.373
Validation loss decreased (-0.371018 --> -0.372641).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.1937454
	speed: 0.1339s/iter; left time: 1347.5775s
Epoch: 35 cost time: 5.58995509147644
Epoch: 35, Steps: 154 | Train Loss: 1.404 Vali Loss: 3.012 Vali Acc: 0.378 Test Loss: 3.012 Test Acc: 0.378
Validation loss decreased (-0.372641 --> -0.377910).  Saving model ...
	iters: 100, epoch: 36 | loss: 1.4226402
	speed: 0.1371s/iter; left time: 1358.9360s
Epoch: 36 cost time: 5.2064948081970215
Epoch: 36, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.852 Vali Acc: 0.378 Test Loss: 2.852 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.8687018
	speed: 0.1386s/iter; left time: 1352.6869s
Epoch: 37 cost time: 5.362032175064087
Epoch: 37, Steps: 154 | Train Loss: 1.328 Vali Loss: 2.900 Vali Acc: 0.374 Test Loss: 2.900 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 1.1246632
	speed: 0.1264s/iter; left time: 1213.7594s
Epoch: 38 cost time: 4.934026718139648
Epoch: 38, Steps: 154 | Train Loss: 1.394 Vali Loss: 3.213 Vali Acc: 0.368 Test Loss: 3.213 Test Acc: 0.368
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 1.0009665
	speed: 0.1393s/iter; left time: 1316.0309s
Epoch: 39 cost time: 5.19929051399231
Epoch: 39, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.898 Vali Acc: 0.380 Test Loss: 2.898 Test Acc: 0.380
Validation loss decreased (-0.377910 --> -0.379939).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.2471241
	speed: 0.1298s/iter; left time: 1206.5187s
Epoch: 40 cost time: 4.261090517044067
Epoch: 40, Steps: 154 | Train Loss: 1.331 Vali Loss: 2.855 Vali Acc: 0.374 Test Loss: 2.855 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 1.7496668
	speed: 0.1110s/iter; left time: 1014.5426s
Epoch: 41 cost time: 4.4299232959747314
Epoch: 41, Steps: 154 | Train Loss: 1.358 Vali Loss: 3.186 Vali Acc: 0.369 Test Loss: 3.186 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 1.1471022
	speed: 0.1377s/iter; left time: 1237.8514s
Epoch: 42 cost time: 4.942753791809082
Epoch: 42, Steps: 154 | Train Loss: 1.343 Vali Loss: 3.018 Vali Acc: 0.380 Test Loss: 3.018 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 0.9695629
	speed: 0.1365s/iter; left time: 1205.4762s
Epoch: 43 cost time: 5.590590238571167
Epoch: 43, Steps: 154 | Train Loss: 1.259 Vali Loss: 3.000 Vali Acc: 0.373 Test Loss: 3.000 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 1.2941074
	speed: 0.1329s/iter; left time: 1153.5051s
Epoch: 44 cost time: 5.687201738357544
Epoch: 44, Steps: 154 | Train Loss: 1.244 Vali Loss: 3.462 Vali Acc: 0.370 Test Loss: 3.462 Test Acc: 0.370
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 1.0709766
	speed: 0.1413s/iter; left time: 1205.0028s
Epoch: 45 cost time: 5.62458610534668
Epoch: 45, Steps: 154 | Train Loss: 1.279 Vali Loss: 3.315 Vali Acc: 0.376 Test Loss: 3.315 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 46 | loss: 1.9162569
	speed: 0.1384s/iter; left time: 1158.8659s
Epoch: 46 cost time: 5.231206893920898
Epoch: 46, Steps: 154 | Train Loss: 1.290 Vali Loss: 3.228 Vali Acc: 0.377 Test Loss: 3.228 Test Acc: 0.377
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 47 | loss: 0.8249875
	speed: 0.1388s/iter; left time: 1140.4717s
Epoch: 47 cost time: 6.279652118682861
Epoch: 47, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.938 Vali Acc: 0.379 Test Loss: 2.938 Test Acc: 0.379
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 48 | loss: 1.1893785
	speed: 0.1390s/iter; left time: 1120.4759s
Epoch: 48 cost time: 5.327872276306152
Epoch: 48, Steps: 154 | Train Loss: 1.360 Vali Loss: 3.263 Vali Acc: 0.369 Test Loss: 3.263 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 49 | loss: 0.5066736
	speed: 0.1402s/iter; left time: 1108.4653s
Epoch: 49 cost time: 5.276658296585083
Epoch: 49, Steps: 154 | Train Loss: 1.234 Vali Loss: 3.437 Vali Acc: 0.379 Test Loss: 3.437 Test Acc: 0.379
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 305334
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9364505
	speed: 0.0457s/iter; left time: 699.9835s
Epoch: 1 cost time: 6.4559485912323
Epoch: 1, Steps: 154 | Train Loss: 2.280 Vali Loss: 2.151 Vali Acc: 0.318 Test Loss: 2.151 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6778731
	speed: 0.1338s/iter; left time: 2026.3710s
Epoch: 2 cost time: 5.320544958114624
Epoch: 2, Steps: 154 | Train Loss: 2.065 Vali Loss: 2.139 Vali Acc: 0.321 Test Loss: 2.139 Test Acc: 0.321
Validation loss decreased (-0.318308 --> -0.321146).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8101008
	speed: 0.1393s/iter; left time: 2088.3489s
Epoch: 3 cost time: 5.473168134689331
Epoch: 3, Steps: 154 | Train Loss: 2.010 Vali Loss: 2.165 Vali Acc: 0.321 Test Loss: 2.165 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.2907674
	speed: 0.1331s/iter; left time: 1974.7917s
Epoch: 4 cost time: 5.572617530822754
Epoch: 4, Steps: 154 | Train Loss: 1.972 Vali Loss: 2.139 Vali Acc: 0.323 Test Loss: 2.139 Test Acc: 0.323
Validation loss decreased (-0.321146 --> -0.323174).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5454431
	speed: 0.1374s/iter; left time: 2017.8051s
Epoch: 5 cost time: 5.222805738449097
Epoch: 5, Steps: 154 | Train Loss: 1.923 Vali Loss: 2.130 Vali Acc: 0.327 Test Loss: 2.130 Test Acc: 0.327
Validation loss decreased (-0.323174 --> -0.327229).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9267801
	speed: 0.1405s/iter; left time: 2041.9760s
Epoch: 6 cost time: 5.305193185806274
Epoch: 6, Steps: 154 | Train Loss: 1.883 Vali Loss: 2.126 Vali Acc: 0.324 Test Loss: 2.126 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9662871
	speed: 0.1298s/iter; left time: 1866.4040s
Epoch: 7 cost time: 5.519638776779175
Epoch: 7, Steps: 154 | Train Loss: 1.871 Vali Loss: 2.158 Vali Acc: 0.328 Test Loss: 2.158 Test Acc: 0.328
Validation loss decreased (-0.327229 --> -0.328446).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7542880
	speed: 0.1352s/iter; left time: 1922.3952s
Epoch: 8 cost time: 5.097398996353149
Epoch: 8, Steps: 154 | Train Loss: 1.810 Vali Loss: 2.160 Vali Acc: 0.328 Test Loss: 2.160 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7919941
	speed: 0.1411s/iter; left time: 1985.4133s
Epoch: 9 cost time: 4.883108854293823
Epoch: 9, Steps: 154 | Train Loss: 1.791 Vali Loss: 2.152 Vali Acc: 0.329 Test Loss: 2.152 Test Acc: 0.329
Validation loss decreased (-0.328446 --> -0.328851).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.4671757
	speed: 0.1250s/iter; left time: 1738.8777s
Epoch: 10 cost time: 4.911438465118408
Epoch: 10, Steps: 154 | Train Loss: 1.774 Vali Loss: 2.148 Vali Acc: 0.334 Test Loss: 2.148 Test Acc: 0.334
Validation loss decreased (-0.328851 --> -0.333717).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7758543
	speed: 0.1337s/iter; left time: 1839.7281s
Epoch: 11 cost time: 5.660604953765869
Epoch: 11, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.201 Vali Acc: 0.333 Test Loss: 2.201 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7425120
	speed: 0.1405s/iter; left time: 1911.1536s
Epoch: 12 cost time: 5.394617080688477
Epoch: 12, Steps: 154 | Train Loss: 1.694 Vali Loss: 2.154 Vali Acc: 0.339 Test Loss: 2.154 Test Acc: 0.339
Validation loss decreased (-0.333717 --> -0.338583).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7054079
	speed: 0.1384s/iter; left time: 1862.5356s
Epoch: 13 cost time: 6.179441928863525
Epoch: 13, Steps: 154 | Train Loss: 1.719 Vali Loss: 2.216 Vali Acc: 0.340 Test Loss: 2.216 Test Acc: 0.340
Validation loss decreased (-0.338583 --> -0.339799).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5461345
	speed: 0.1373s/iter; left time: 1826.5734s
Epoch: 14 cost time: 5.644313097000122
Epoch: 14, Steps: 154 | Train Loss: 1.673 Vali Loss: 2.219 Vali Acc: 0.343 Test Loss: 2.219 Test Acc: 0.343
Validation loss decreased (-0.339799 --> -0.342638).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.8548775
	speed: 0.1392s/iter; left time: 1829.5952s
Epoch: 15 cost time: 5.361129999160767
Epoch: 15, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.304 Vali Acc: 0.349 Test Loss: 2.304 Test Acc: 0.349
Validation loss decreased (-0.342638 --> -0.348720).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3743057
	speed: 0.1374s/iter; left time: 1785.1172s
Epoch: 16 cost time: 5.910113573074341
Epoch: 16, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.236 Vali Acc: 0.349 Test Loss: 2.236 Test Acc: 0.349
Validation loss decreased (-0.348720 --> -0.349126).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.7194630
	speed: 0.1389s/iter; left time: 1783.5322s
Epoch: 17 cost time: 5.680110216140747
Epoch: 17, Steps: 154 | Train Loss: 1.612 Vali Loss: 2.338 Vali Acc: 0.357 Test Loss: 2.338 Test Acc: 0.357
Validation loss decreased (-0.349126 --> -0.356830).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.3963176
	speed: 0.1320s/iter; left time: 1674.2041s
Epoch: 18 cost time: 4.669984340667725
Epoch: 18, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.382 Vali Acc: 0.356 Test Loss: 2.382 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.2369249
	speed: 0.1328s/iter; left time: 1663.7079s
Epoch: 19 cost time: 5.38822865486145
Epoch: 19, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.271 Vali Acc: 0.359 Test Loss: 2.271 Test Acc: 0.359
Validation loss decreased (-0.356830 --> -0.358858).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.2708633
	speed: 0.1103s/iter; left time: 1364.7823s
Epoch: 20 cost time: 4.480940341949463
Epoch: 20, Steps: 154 | Train Loss: 1.552 Vali Loss: 2.435 Vali Acc: 0.347 Test Loss: 2.435 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.5900512
	speed: 0.1290s/iter; left time: 1576.8334s
Epoch: 21 cost time: 4.984618425369263
Epoch: 21, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.329 Vali Acc: 0.355 Test Loss: 2.329 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.9920691
	speed: 0.1341s/iter; left time: 1618.3839s
Epoch: 22 cost time: 5.56225848197937
Epoch: 22, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.507 Vali Acc: 0.359 Test Loss: 2.507 Test Acc: 0.359
Validation loss decreased (-0.358858 --> -0.359261).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.1081023
	speed: 0.1331s/iter; left time: 1586.0887s
Epoch: 23 cost time: 5.407798528671265
Epoch: 23, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.466 Vali Acc: 0.355 Test Loss: 2.466 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.2604159
	speed: 0.1329s/iter; left time: 1563.0771s
Epoch: 24 cost time: 4.956027269363403
Epoch: 24, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.400 Vali Acc: 0.373 Test Loss: 2.400 Test Acc: 0.373
Validation loss decreased (-0.359261 --> -0.372644).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.4498117
	speed: 0.1352s/iter; left time: 1569.2072s
Epoch: 25 cost time: 5.522574186325073
Epoch: 25, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.462 Vali Acc: 0.370 Test Loss: 2.462 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.7375346
	speed: 0.1328s/iter; left time: 1521.0853s
Epoch: 26 cost time: 5.210433721542358
Epoch: 26, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.508 Vali Acc: 0.360 Test Loss: 2.508 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.4627432
	speed: 0.1329s/iter; left time: 1501.8126s
Epoch: 27 cost time: 5.529878854751587
Epoch: 27, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.516 Vali Acc: 0.376 Test Loss: 2.516 Test Acc: 0.376
Validation loss decreased (-0.372644 --> -0.376293).  Saving model ...
	iters: 100, epoch: 28 | loss: 2.0652857
	speed: 0.1467s/iter; left time: 1635.1007s
Epoch: 28 cost time: 5.171227931976318
Epoch: 28, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.720 Vali Acc: 0.363 Test Loss: 2.720 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.2089875
	speed: 0.1310s/iter; left time: 1439.5800s
Epoch: 29 cost time: 5.672791242599487
Epoch: 29, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.733 Vali Acc: 0.358 Test Loss: 2.733 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 1.3678088
	speed: 0.1336s/iter; left time: 1447.5723s
Epoch: 30 cost time: 5.514217853546143
Epoch: 30, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.739 Vali Acc: 0.365 Test Loss: 2.739 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 1.1603091
	speed: 0.1376s/iter; left time: 1469.8529s
Epoch: 31 cost time: 5.653318405151367
Epoch: 31, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.835 Vali Acc: 0.372 Test Loss: 2.835 Test Acc: 0.372
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 3.4042695
	speed: 0.1351s/iter; left time: 1421.9585s
Epoch: 32 cost time: 5.13370418548584
Epoch: 32, Steps: 154 | Train Loss: 1.348 Vali Loss: 2.753 Vali Acc: 0.376 Test Loss: 2.753 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 1.1774206
	speed: 0.1339s/iter; left time: 1388.7455s
Epoch: 33 cost time: 5.836623191833496
Epoch: 33, Steps: 154 | Train Loss: 1.399 Vali Loss: 3.045 Vali Acc: 0.327 Test Loss: 3.045 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 1.5050861
	speed: 0.1306s/iter; left time: 1334.4882s
Epoch: 34 cost time: 5.166828393936157
Epoch: 34, Steps: 154 | Train Loss: 1.316 Vali Loss: 3.100 Vali Acc: 0.378 Test Loss: 3.100 Test Acc: 0.378
Validation loss decreased (-0.376293 --> -0.377909).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.1785475
	speed: 0.1332s/iter; left time: 1340.5313s
Epoch: 35 cost time: 4.912714958190918
Epoch: 35, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.982 Vali Acc: 0.376 Test Loss: 2.982 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 1.5776290
	speed: 0.1314s/iter; left time: 1302.1763s
Epoch: 36 cost time: 5.793680906295776
Epoch: 36, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.833 Vali Acc: 0.373 Test Loss: 2.833 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.8524052
	speed: 0.1367s/iter; left time: 1333.5564s
Epoch: 37 cost time: 4.9146082401275635
Epoch: 37, Steps: 154 | Train Loss: 1.415 Vali Loss: 2.908 Vali Acc: 0.369 Test Loss: 2.908 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 1.2379886
	speed: 0.1260s/iter; left time: 1209.6422s
Epoch: 38 cost time: 5.146401882171631
Epoch: 38, Steps: 154 | Train Loss: 1.369 Vali Loss: 3.232 Vali Acc: 0.369 Test Loss: 3.232 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 1.0700119
	speed: 0.1332s/iter; left time: 1258.6224s
Epoch: 39 cost time: 5.591142892837524
Epoch: 39, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.942 Vali Acc: 0.380 Test Loss: 2.942 Test Acc: 0.380
Validation loss decreased (-0.377909 --> -0.380344).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.7928345
	speed: 0.1317s/iter; left time: 1224.0636s
Epoch: 40 cost time: 4.9585254192352295
Epoch: 40, Steps: 154 | Train Loss: 1.296 Vali Loss: 2.749 Vali Acc: 0.373 Test Loss: 2.749 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 1.6322783
	speed: 0.1328s/iter; left time: 1214.3401s
Epoch: 41 cost time: 5.124319076538086
Epoch: 41, Steps: 154 | Train Loss: 1.307 Vali Loss: 3.282 Vali Acc: 0.372 Test Loss: 3.282 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 1.5668452
	speed: 0.1335s/iter; left time: 1199.3789s
Epoch: 42 cost time: 5.793851137161255
Epoch: 42, Steps: 154 | Train Loss: 1.441 Vali Loss: 3.375 Vali Acc: 0.378 Test Loss: 3.375 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 6.9726453
	speed: 0.1298s/iter; left time: 1146.7214s
Epoch: 43 cost time: 4.939637899398804
Epoch: 43, Steps: 154 | Train Loss: 1.398 Vali Loss: 3.602 Vali Acc: 0.369 Test Loss: 3.602 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 1.3547326
	speed: 0.1396s/iter; left time: 1211.3761s
Epoch: 44 cost time: 5.519417762756348
Epoch: 44, Steps: 154 | Train Loss: 1.318 Vali Loss: 3.314 Vali Acc: 0.374 Test Loss: 3.314 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 0.8429398
	speed: 0.1433s/iter; left time: 1221.2918s
Epoch: 45 cost time: 5.380159139633179
Epoch: 45, Steps: 154 | Train Loss: 1.290 Vali Loss: 3.289 Vali Acc: 0.379 Test Loss: 3.289 Test Acc: 0.379
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 46 | loss: 1.7618604
	speed: 0.1310s/iter; left time: 1096.4412s
Epoch: 46 cost time: 5.3443968296051025
Epoch: 46, Steps: 154 | Train Loss: 1.243 Vali Loss: 3.486 Vali Acc: 0.240 Test Loss: 3.486 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 47 | loss: 0.8853459
	speed: 0.1381s/iter; left time: 1134.4220s
Epoch: 47 cost time: 5.310389757156372
Epoch: 47, Steps: 154 | Train Loss: 1.289 Vali Loss: 3.260 Vali Acc: 0.374 Test Loss: 3.260 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 48 | loss: 0.9893632
	speed: 0.1317s/iter; left time: 1062.2915s
Epoch: 48 cost time: 4.861684322357178
Epoch: 48, Steps: 154 | Train Loss: 1.254 Vali Loss: 3.215 Vali Acc: 0.378 Test Loss: 3.215 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 49 | loss: 0.5807676
	speed: 0.1078s/iter; left time: 852.7120s
Epoch: 49 cost time: 4.8468177318573
Epoch: 49, Steps: 154 | Train Loss: 1.221 Vali Loss: 3.368 Vali Acc: 0.386 Test Loss: 3.368 Test Acc: 0.386
Validation loss decreased (-0.380344 --> -0.386422).  Saving model ...
	iters: 100, epoch: 50 | loss: 1.1840284
	speed: 0.1233s/iter; left time: 956.0864s
Epoch: 50 cost time: 4.6806840896606445
Epoch: 50, Steps: 154 | Train Loss: 1.151 Vali Loss: 3.175 Vali Acc: 0.380 Test Loss: 3.175 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 51 | loss: 1.2166636
	speed: 0.1250s/iter; left time: 950.0861s
Epoch: 51 cost time: 4.9795081615448
Epoch: 51, Steps: 154 | Train Loss: 1.206 Vali Loss: 3.101 Vali Acc: 0.252 Test Loss: 3.101 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 52 | loss: 1.2941839
	speed: 0.1274s/iter; left time: 948.9565s
Epoch: 52 cost time: 5.268653392791748
Epoch: 52, Steps: 154 | Train Loss: 1.321 Vali Loss: 3.007 Vali Acc: 0.374 Test Loss: 3.007 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 53 | loss: 0.8084931
	speed: 0.1254s/iter; left time: 914.3830s
Epoch: 53 cost time: 4.606522083282471
Epoch: 53, Steps: 154 | Train Loss: 1.346 Vali Loss: 3.070 Vali Acc: 0.385 Test Loss: 3.070 Test Acc: 0.385
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 54 | loss: 0.5476641
	speed: 0.1295s/iter; left time: 924.8316s
Epoch: 54 cost time: 4.994103670120239
Epoch: 54, Steps: 154 | Train Loss: 1.184 Vali Loss: 3.819 Vali Acc: 0.380 Test Loss: 3.819 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 55 | loss: 2.5088716
	speed: 0.1265s/iter; left time: 883.3793s
Epoch: 55 cost time: 4.997073411941528
Epoch: 55, Steps: 154 | Train Loss: 1.167 Vali Loss: 3.224 Vali Acc: 0.376 Test Loss: 3.224 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 56 | loss: 0.9299957
	speed: 0.1246s/iter; left time: 851.1835s
Epoch: 56 cost time: 4.49297571182251
Epoch: 56, Steps: 154 | Train Loss: 1.192 Vali Loss: 3.588 Vali Acc: 0.375 Test Loss: 3.588 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 57 | loss: 1.2155496
	speed: 0.1293s/iter; left time: 863.0829s
Epoch: 57 cost time: 5.387519359588623
Epoch: 57, Steps: 154 | Train Loss: 1.382 Vali Loss: 3.146 Vali Acc: 0.380 Test Loss: 3.146 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 58 | loss: 1.7501787
	speed: 0.1278s/iter; left time: 833.5468s
Epoch: 58 cost time: 5.0946831703186035
Epoch: 58, Steps: 154 | Train Loss: 1.332 Vali Loss: 3.269 Vali Acc: 0.382 Test Loss: 3.269 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 59 | loss: 1.0849339
	speed: 0.1272s/iter; left time: 810.0200s
Epoch: 59 cost time: 4.898084878921509
Epoch: 59, Steps: 154 | Train Loss: 1.224 Vali Loss: 3.634 Vali Acc: 0.385 Test Loss: 3.634 Test Acc: 0.385
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.386455798864558
model parameter : 305334
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9162861
	speed: 0.0491s/iter; left time: 751.1207s
Epoch: 1 cost time: 6.589667558670044
Epoch: 1, Steps: 154 | Train Loss: 2.270 Vali Loss: 2.155 Vali Acc: 0.318 Test Loss: 2.155 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6151171
	speed: 0.1310s/iter; left time: 1983.7580s
Epoch: 2 cost time: 4.850353956222534
Epoch: 2, Steps: 154 | Train Loss: 2.068 Vali Loss: 2.139 Vali Acc: 0.322 Test Loss: 2.139 Test Acc: 0.322
Validation loss decreased (-0.317902 --> -0.321552).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8266068
	speed: 0.1372s/iter; left time: 2056.3409s
Epoch: 3 cost time: 4.743412733078003
Epoch: 3, Steps: 154 | Train Loss: 2.024 Vali Loss: 2.155 Vali Acc: 0.322 Test Loss: 2.155 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.2947819
	speed: 0.1247s/iter; left time: 1849.8517s
Epoch: 4 cost time: 4.895744800567627
Epoch: 4, Steps: 154 | Train Loss: 1.977 Vali Loss: 2.133 Vali Acc: 0.322 Test Loss: 2.133 Test Acc: 0.322
Validation loss decreased (-0.321552 --> -0.321958).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3604829
	speed: 0.1247s/iter; left time: 1831.0377s
Epoch: 5 cost time: 4.703588247299194
Epoch: 5, Steps: 154 | Train Loss: 1.934 Vali Loss: 2.118 Vali Acc: 0.327 Test Loss: 2.118 Test Acc: 0.327
Validation loss decreased (-0.321958 --> -0.326824).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9218850
	speed: 0.1295s/iter; left time: 1881.4134s
Epoch: 6 cost time: 4.787702798843384
Epoch: 6, Steps: 154 | Train Loss: 1.878 Vali Loss: 2.106 Vali Acc: 0.325 Test Loss: 2.106 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9515250
	speed: 0.1216s/iter; left time: 1747.8281s
Epoch: 7 cost time: 4.958545684814453
Epoch: 7, Steps: 154 | Train Loss: 1.855 Vali Loss: 2.135 Vali Acc: 0.327 Test Loss: 2.135 Test Acc: 0.327
Validation loss decreased (-0.326824 --> -0.327229).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7278205
	speed: 0.1261s/iter; left time: 1793.5438s
Epoch: 8 cost time: 4.859068870544434
Epoch: 8, Steps: 154 | Train Loss: 1.820 Vali Loss: 2.132 Vali Acc: 0.333 Test Loss: 2.132 Test Acc: 0.333
Validation loss decreased (-0.327229 --> -0.332501).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7891409
	speed: 0.1277s/iter; left time: 1796.3619s
Epoch: 9 cost time: 4.640753984451294
Epoch: 9, Steps: 154 | Train Loss: 1.794 Vali Loss: 2.132 Vali Acc: 0.329 Test Loss: 2.132 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.4442947
	speed: 0.1207s/iter; left time: 1679.4795s
Epoch: 10 cost time: 4.961626291275024
Epoch: 10, Steps: 154 | Train Loss: 1.763 Vali Loss: 2.136 Vali Acc: 0.338 Test Loss: 2.136 Test Acc: 0.338
Validation loss decreased (-0.332501 --> -0.337773).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7555398
	speed: 0.1246s/iter; left time: 1715.2456s
Epoch: 11 cost time: 4.635308265686035
Epoch: 11, Steps: 154 | Train Loss: 1.746 Vali Loss: 2.203 Vali Acc: 0.338 Test Loss: 2.203 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7953118
	speed: 0.1316s/iter; left time: 1790.8439s
Epoch: 12 cost time: 4.542784929275513
Epoch: 12, Steps: 154 | Train Loss: 1.724 Vali Loss: 2.180 Vali Acc: 0.343 Test Loss: 2.180 Test Acc: 0.343
Validation loss decreased (-0.337773 --> -0.343044).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6732117
	speed: 0.1175s/iter; left time: 1581.1389s
Epoch: 13 cost time: 4.749554872512817
Epoch: 13, Steps: 154 | Train Loss: 1.673 Vali Loss: 2.239 Vali Acc: 0.339 Test Loss: 2.239 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5071774
	speed: 0.1340s/iter; left time: 1782.0616s
Epoch: 14 cost time: 4.871604681015015
Epoch: 14, Steps: 154 | Train Loss: 1.700 Vali Loss: 2.221 Vali Acc: 0.344 Test Loss: 2.221 Test Acc: 0.344
Validation loss decreased (-0.343044 --> -0.344260).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.8655469
	speed: 0.1251s/iter; left time: 1644.1366s
Epoch: 15 cost time: 5.105975151062012
Epoch: 15, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.282 Vali Acc: 0.344 Test Loss: 2.282 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.3969151
	speed: 0.1193s/iter; left time: 1549.8305s
Epoch: 16 cost time: 4.623093366622925
Epoch: 16, Steps: 154 | Train Loss: 1.681 Vali Loss: 2.253 Vali Acc: 0.350 Test Loss: 2.253 Test Acc: 0.350
Validation loss decreased (-0.344260 --> -0.349937).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.6925153
	speed: 0.1167s/iter; left time: 1498.7123s
Epoch: 17 cost time: 4.589972496032715
Epoch: 17, Steps: 154 | Train Loss: 1.605 Vali Loss: 2.360 Vali Acc: 0.353 Test Loss: 2.360 Test Acc: 0.353
Validation loss decreased (-0.349937 --> -0.352774).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.3657646
	speed: 0.1143s/iter; left time: 1449.7118s
Epoch: 18 cost time: 5.047153949737549
Epoch: 18, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.424 Vali Acc: 0.361 Test Loss: 2.424 Test Acc: 0.361
Validation loss decreased (-0.352774 --> -0.360479).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.3405285
	speed: 0.1266s/iter; left time: 1585.6982s
Epoch: 19 cost time: 4.9673686027526855
Epoch: 19, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.487 Vali Acc: 0.358 Test Loss: 2.487 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.2038651
	speed: 0.1279s/iter; left time: 1582.9417s
Epoch: 20 cost time: 4.692122220993042
Epoch: 20, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.454 Vali Acc: 0.350 Test Loss: 2.454 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.7364005
	speed: 0.1323s/iter; left time: 1616.2677s
Epoch: 21 cost time: 5.158897399902344
Epoch: 21, Steps: 154 | Train Loss: 1.557 Vali Loss: 2.535 Vali Acc: 0.348 Test Loss: 2.535 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.6796546
	speed: 0.1285s/iter; left time: 1550.1972s
Epoch: 22 cost time: 4.868997097015381
Epoch: 22, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.573 Vali Acc: 0.365 Test Loss: 2.573 Test Acc: 0.365
Validation loss decreased (-0.360479 --> -0.364532).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.1832188
	speed: 0.1393s/iter; left time: 1659.3436s
Epoch: 23 cost time: 5.126040697097778
Epoch: 23, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.520 Vali Acc: 0.358 Test Loss: 2.520 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.8107758
	speed: 0.1203s/iter; left time: 1414.9235s
Epoch: 24 cost time: 4.6978371143341064
Epoch: 24, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.543 Vali Acc: 0.371 Test Loss: 2.543 Test Acc: 0.371
Validation loss decreased (-0.364532 --> -0.370615).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.3315965
	speed: 0.1235s/iter; left time: 1433.3077s
Epoch: 25 cost time: 4.916942119598389
Epoch: 25, Steps: 154 | Train Loss: 1.763 Vali Loss: 2.525 Vali Acc: 0.362 Test Loss: 2.525 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.9174275
	speed: 0.1272s/iter; left time: 1456.0892s
Epoch: 26 cost time: 4.6895363330841064
Epoch: 26, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.622 Vali Acc: 0.361 Test Loss: 2.622 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.4840591
	speed: 0.1216s/iter; left time: 1373.8896s
Epoch: 27 cost time: 4.853226184844971
Epoch: 27, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.693 Vali Acc: 0.364 Test Loss: 2.693 Test Acc: 0.364
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 2.8529310
	speed: 0.1250s/iter; left time: 1392.6433s
Epoch: 28 cost time: 4.739923477172852
Epoch: 28, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.638 Vali Acc: 0.361 Test Loss: 2.638 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 1.1643298
	speed: 0.1266s/iter; left time: 1391.6167s
Epoch: 29 cost time: 4.655139684677124
Epoch: 29, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.759 Vali Acc: 0.361 Test Loss: 2.759 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 1.5049677
	speed: 0.1212s/iter; left time: 1312.7530s
Epoch: 30 cost time: 4.957041025161743
Epoch: 30, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.801 Vali Acc: 0.361 Test Loss: 2.801 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 1.0333220
	speed: 0.1296s/iter; left time: 1383.7826s
Epoch: 31 cost time: 4.809544324874878
Epoch: 31, Steps: 154 | Train Loss: 1.506 Vali Loss: 3.066 Vali Acc: 0.366 Test Loss: 3.066 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.8331587
	speed: 0.1289s/iter; left time: 1357.0223s
Epoch: 32 cost time: 4.6608757972717285
Epoch: 32, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.894 Vali Acc: 0.366 Test Loss: 2.894 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 1.2536837
	speed: 0.1234s/iter; left time: 1279.9708s
Epoch: 33 cost time: 4.920079946517944
Epoch: 33, Steps: 154 | Train Loss: 1.332 Vali Loss: 3.194 Vali Acc: 0.380 Test Loss: 3.194 Test Acc: 0.380
Validation loss decreased (-0.370615 --> -0.379936).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.2036763
	speed: 0.1255s/iter; left time: 1282.4376s
Epoch: 34 cost time: 4.993481874465942
Epoch: 34, Steps: 154 | Train Loss: 1.352 Vali Loss: 2.917 Vali Acc: 0.373 Test Loss: 2.917 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 1.0846746
	speed: 0.1286s/iter; left time: 1294.2409s
Epoch: 35 cost time: 4.620048761367798
Epoch: 35, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.950 Vali Acc: 0.377 Test Loss: 2.950 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 1.9475580
	speed: 0.1232s/iter; left time: 1220.8274s
Epoch: 36 cost time: 5.171344041824341
Epoch: 36, Steps: 154 | Train Loss: 1.362 Vali Loss: 3.111 Vali Acc: 0.371 Test Loss: 3.111 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.8918817
	speed: 0.1284s/iter; left time: 1252.7584s
Epoch: 37 cost time: 4.870483160018921
Epoch: 37, Steps: 154 | Train Loss: 1.288 Vali Loss: 3.025 Vali Acc: 0.368 Test Loss: 3.025 Test Acc: 0.368
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 1.1864853
	speed: 0.1281s/iter; left time: 1230.1127s
Epoch: 38 cost time: 4.893995046615601
Epoch: 38, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.829 Vali Acc: 0.367 Test Loss: 2.829 Test Acc: 0.367
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 1.0244340
	speed: 0.1259s/iter; left time: 1189.9481s
Epoch: 39 cost time: 5.018684148788452
Epoch: 39, Steps: 154 | Train Loss: 1.370 Vali Loss: 2.906 Vali Acc: 0.380 Test Loss: 2.906 Test Acc: 0.380
Validation loss decreased (-0.379936 --> -0.380344).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.2043655
	speed: 0.1339s/iter; left time: 1244.6372s
Epoch: 40 cost time: 4.921302795410156
Epoch: 40, Steps: 154 | Train Loss: 1.248 Vali Loss: 2.967 Vali Acc: 0.372 Test Loss: 2.967 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 1.3922114
	speed: 0.1290s/iter; left time: 1178.8222s
Epoch: 41 cost time: 4.550557374954224
Epoch: 41, Steps: 154 | Train Loss: 1.276 Vali Loss: 3.223 Vali Acc: 0.378 Test Loss: 3.223 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 1.4983311
	speed: 0.1225s/iter; left time: 1100.6267s
Epoch: 42 cost time: 5.270124912261963
Epoch: 42, Steps: 154 | Train Loss: 1.296 Vali Loss: 3.437 Vali Acc: 0.381 Test Loss: 3.437 Test Acc: 0.381
Validation loss decreased (-0.380344 --> -0.381150).  Saving model ...
	iters: 100, epoch: 43 | loss: 1.0457908
	speed: 0.1230s/iter; left time: 1086.5385s
Epoch: 43 cost time: 4.526681661605835
Epoch: 43, Steps: 154 | Train Loss: 1.355 Vali Loss: 3.200 Vali Acc: 0.369 Test Loss: 3.200 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 1.3554643
	speed: 0.1509s/iter; left time: 1309.7624s
Epoch: 44 cost time: 5.329794645309448
Epoch: 44, Steps: 154 | Train Loss: 1.444 Vali Loss: 3.311 Vali Acc: 0.373 Test Loss: 3.311 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 0.8617114
	speed: 0.1045s/iter; left time: 890.8249s
Epoch: 45 cost time: 3.8563835620880127
Epoch: 45, Steps: 154 | Train Loss: 1.406 Vali Loss: 3.513 Vali Acc: 0.372 Test Loss: 3.513 Test Acc: 0.372
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 46 | loss: 2.5435376
	speed: 0.0945s/iter; left time: 790.8489s
Epoch: 46 cost time: 3.993964672088623
Epoch: 46, Steps: 154 | Train Loss: 1.242 Vali Loss: 3.774 Vali Acc: 0.376 Test Loss: 3.774 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 47 | loss: 0.7976241
	speed: 0.1166s/iter; left time: 958.1383s
Epoch: 47 cost time: 4.58614706993103
Epoch: 47, Steps: 154 | Train Loss: 1.245 Vali Loss: 3.340 Vali Acc: 0.374 Test Loss: 3.340 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 48 | loss: 1.0149518
	speed: 0.1211s/iter; left time: 976.0437s
Epoch: 48 cost time: 4.816695928573608
Epoch: 48, Steps: 154 | Train Loss: 1.296 Vali Loss: 3.218 Vali Acc: 0.377 Test Loss: 3.218 Test Acc: 0.377
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 49 | loss: 0.5547211
	speed: 0.1264s/iter; left time: 999.9711s
Epoch: 49 cost time: 4.756971597671509
Epoch: 49, Steps: 154 | Train Loss: 1.556 Vali Loss: 3.439 Vali Acc: 0.380 Test Loss: 3.439 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 50 | loss: 1.3587015
	speed: 0.1235s/iter; left time: 957.5957s
Epoch: 50 cost time: 4.820703506469727
Epoch: 50, Steps: 154 | Train Loss: 1.234 Vali Loss: 3.308 Vali Acc: 0.381 Test Loss: 3.308 Test Acc: 0.381
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 51 | loss: 3.3603890
	speed: 0.1279s/iter; left time: 972.2625s
Epoch: 51 cost time: 5.321223020553589
Epoch: 51, Steps: 154 | Train Loss: 1.209 Vali Loss: 3.357 Vali Acc: 0.380 Test Loss: 3.357 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 52 | loss: 1.2272332
	speed: 0.1300s/iter; left time: 968.2941s
Epoch: 52 cost time: 4.952543497085571
Epoch: 52, Steps: 154 | Train Loss: 1.187 Vali Loss: 3.352 Vali Acc: 0.370 Test Loss: 3.352 Test Acc: 0.370
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38118410381184104
model parameter : 305334
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9055649
	speed: 0.0504s/iter; left time: 771.7681s
Epoch: 1 cost time: 6.909970283508301
Epoch: 1, Steps: 154 | Train Loss: 2.241 Vali Loss: 2.159 Vali Acc: 0.318 Test Loss: 2.159 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5792708
	speed: 0.1318s/iter; left time: 1996.4494s
Epoch: 2 cost time: 4.653258323669434
Epoch: 2, Steps: 154 | Train Loss: 2.055 Vali Loss: 2.147 Vali Acc: 0.320 Test Loss: 2.147 Test Acc: 0.320
Validation loss decreased (-0.317497 --> -0.319930).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8524661
	speed: 0.1247s/iter; left time: 1869.2474s
Epoch: 3 cost time: 4.8385255336761475
Epoch: 3, Steps: 154 | Train Loss: 2.021 Vali Loss: 2.153 Vali Acc: 0.320 Test Loss: 2.153 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3290589
	speed: 0.1233s/iter; left time: 1829.7589s
Epoch: 4 cost time: 5.14802622795105
Epoch: 4, Steps: 154 | Train Loss: 1.978 Vali Loss: 2.129 Vali Acc: 0.320 Test Loss: 2.129 Test Acc: 0.320
Validation loss decreased (-0.319930 --> -0.320336).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2606075
	speed: 0.1214s/iter; left time: 1782.8010s
Epoch: 5 cost time: 4.534285068511963
Epoch: 5, Steps: 154 | Train Loss: 1.948 Vali Loss: 2.118 Vali Acc: 0.324 Test Loss: 2.118 Test Acc: 0.324
Validation loss decreased (-0.320336 --> -0.323985).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9301146
	speed: 0.1147s/iter; left time: 1666.2191s
Epoch: 6 cost time: 4.627495288848877
Epoch: 6, Steps: 154 | Train Loss: 1.889 Vali Loss: 2.110 Vali Acc: 0.325 Test Loss: 2.110 Test Acc: 0.325
Validation loss decreased (-0.323985 --> -0.325202).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9822887
	speed: 0.1152s/iter; left time: 1656.3311s
Epoch: 7 cost time: 4.962749481201172
Epoch: 7, Steps: 154 | Train Loss: 1.859 Vali Loss: 2.139 Vali Acc: 0.334 Test Loss: 2.139 Test Acc: 0.334
Validation loss decreased (-0.325202 --> -0.333717).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8419790
	speed: 0.1157s/iter; left time: 1646.1270s
Epoch: 8 cost time: 4.4612343311309814
Epoch: 8, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.127 Vali Acc: 0.337 Test Loss: 2.127 Test Acc: 0.337
Validation loss decreased (-0.333717 --> -0.336962).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7518429
	speed: 0.1259s/iter; left time: 1771.4160s
Epoch: 9 cost time: 4.634329557418823
Epoch: 9, Steps: 154 | Train Loss: 1.806 Vali Loss: 2.100 Vali Acc: 0.337 Test Loss: 2.100 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.5108895
	speed: 0.1191s/iter; left time: 1657.7099s
Epoch: 10 cost time: 4.772337913513184
Epoch: 10, Steps: 154 | Train Loss: 1.753 Vali Loss: 2.147 Vali Acc: 0.341 Test Loss: 2.147 Test Acc: 0.341
Validation loss decreased (-0.336962 --> -0.340611).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7900760
	speed: 0.1199s/iter; left time: 1650.0609s
Epoch: 11 cost time: 4.4941465854644775
Epoch: 11, Steps: 154 | Train Loss: 1.769 Vali Loss: 2.223 Vali Acc: 0.339 Test Loss: 2.223 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8382195
	speed: 0.1169s/iter; left time: 1590.6797s
Epoch: 12 cost time: 4.8635573387146
Epoch: 12, Steps: 154 | Train Loss: 1.698 Vali Loss: 2.190 Vali Acc: 0.346 Test Loss: 2.190 Test Acc: 0.346
Validation loss decreased (-0.340611 --> -0.345882).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6099992
	speed: 0.1235s/iter; left time: 1661.6562s
Epoch: 13 cost time: 4.978892087936401
Epoch: 13, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.232 Vali Acc: 0.346 Test Loss: 2.232 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5330803
	speed: 0.1248s/iter; left time: 1659.7318s
Epoch: 14 cost time: 4.500119686126709
Epoch: 14, Steps: 154 | Train Loss: 1.650 Vali Loss: 2.268 Vali Acc: 0.345 Test Loss: 2.268 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.7646337
	speed: 0.1255s/iter; left time: 1649.7182s
Epoch: 15 cost time: 4.971718072891235
Epoch: 15, Steps: 154 | Train Loss: 1.619 Vali Loss: 2.258 Vali Acc: 0.345 Test Loss: 2.258 Test Acc: 0.345
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.3952597
	speed: 0.1308s/iter; left time: 1698.6804s
Epoch: 16 cost time: 5.212207317352295
Epoch: 16, Steps: 154 | Train Loss: 1.717 Vali Loss: 2.248 Vali Acc: 0.361 Test Loss: 2.248 Test Acc: 0.361
Validation loss decreased (-0.345882 --> -0.360480).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.8068434
	speed: 0.1257s/iter; left time: 1613.8346s
Epoch: 17 cost time: 4.503384113311768
Epoch: 17, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.328 Vali Acc: 0.359 Test Loss: 2.328 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.4316880
	speed: 0.1301s/iter; left time: 1650.2581s
Epoch: 18 cost time: 4.849692344665527
Epoch: 18, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.419 Vali Acc: 0.341 Test Loss: 2.419 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.2834225
	speed: 0.1284s/iter; left time: 1609.0239s
Epoch: 19 cost time: 5.070604562759399
Epoch: 19, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.267 Vali Acc: 0.358 Test Loss: 2.267 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.1779788
	speed: 0.1274s/iter; left time: 1577.0089s
Epoch: 20 cost time: 4.639089822769165
Epoch: 20, Steps: 154 | Train Loss: 1.623 Vali Loss: 2.307 Vali Acc: 0.356 Test Loss: 2.307 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.5827626
	speed: 0.1240s/iter; left time: 1515.1545s
Epoch: 21 cost time: 4.909595012664795
Epoch: 21, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.438 Vali Acc: 0.355 Test Loss: 2.438 Test Acc: 0.355
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.6618971
	speed: 0.1243s/iter; left time: 1499.6453s
Epoch: 22 cost time: 4.821994781494141
Epoch: 22, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.419 Vali Acc: 0.360 Test Loss: 2.419 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.1780047
	speed: 0.1177s/iter; left time: 1402.7151s
Epoch: 23 cost time: 4.585216760635376
Epoch: 23, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.649 Vali Acc: 0.354 Test Loss: 2.649 Test Acc: 0.354
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.3303431
	speed: 0.1158s/iter; left time: 1361.6723s
Epoch: 24 cost time: 4.287134647369385
Epoch: 24, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.504 Vali Acc: 0.361 Test Loss: 2.504 Test Acc: 0.361
Validation loss decreased (-0.360480 --> -0.360883).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.4265752
	speed: 0.1151s/iter; left time: 1335.4219s
Epoch: 25 cost time: 4.817291975021362
Epoch: 25, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.501 Vali Acc: 0.365 Test Loss: 2.501 Test Acc: 0.365
Validation loss decreased (-0.360883 --> -0.364938).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.9747596
	speed: 0.1203s/iter; left time: 1377.8086s
Epoch: 26 cost time: 4.655172824859619
Epoch: 26, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.716 Vali Acc: 0.359 Test Loss: 2.716 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.4182110
	speed: 0.1234s/iter; left time: 1394.4897s
Epoch: 27 cost time: 4.476398944854736
Epoch: 27, Steps: 154 | Train Loss: 1.481 Vali Loss: 2.640 Vali Acc: 0.360 Test Loss: 2.640 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.0786461
	speed: 0.1224s/iter; left time: 1363.8904s
Epoch: 28 cost time: 4.687975883483887
Epoch: 28, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.637 Vali Acc: 0.359 Test Loss: 2.637 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.1292901
	speed: 0.1197s/iter; left time: 1315.6037s
Epoch: 29 cost time: 4.805523633956909
Epoch: 29, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.735 Vali Acc: 0.360 Test Loss: 2.735 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.2456834
	speed: 0.1246s/iter; left time: 1350.4627s
Epoch: 30 cost time: 4.3701331615448
Epoch: 30, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.651 Vali Acc: 0.364 Test Loss: 2.651 Test Acc: 0.364
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 1.0604454
	speed: 0.1208s/iter; left time: 1290.5540s
Epoch: 31 cost time: 5.189967155456543
Epoch: 31, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.758 Vali Acc: 0.364 Test Loss: 2.758 Test Acc: 0.364
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.8124917
	speed: 0.1233s/iter; left time: 1297.6545s
Epoch: 32 cost time: 4.798030376434326
Epoch: 32, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.660 Vali Acc: 0.366 Test Loss: 2.660 Test Acc: 0.366
Validation loss decreased (-0.364938 --> -0.366153).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.6390089
	speed: 0.1242s/iter; left time: 1287.8908s
Epoch: 33 cost time: 4.584923028945923
Epoch: 33, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.921 Vali Acc: 0.373 Test Loss: 2.921 Test Acc: 0.373
Validation loss decreased (-0.366153 --> -0.373450).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.2882009
	speed: 0.1251s/iter; left time: 1278.6263s
Epoch: 34 cost time: 4.9239888191223145
Epoch: 34, Steps: 154 | Train Loss: 1.405 Vali Loss: 3.092 Vali Acc: 0.368 Test Loss: 3.092 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 1.0911040
	speed: 0.1269s/iter; left time: 1277.6160s
Epoch: 35 cost time: 5.092109680175781
Epoch: 35, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.807 Vali Acc: 0.374 Test Loss: 2.807 Test Acc: 0.374
Validation loss decreased (-0.373450 --> -0.374262).  Saving model ...
	iters: 100, epoch: 36 | loss: 2.1622095
	speed: 0.1207s/iter; left time: 1196.3865s
Epoch: 36 cost time: 4.566388845443726
Epoch: 36, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.682 Vali Acc: 0.373 Test Loss: 2.682 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.9153930
	speed: 0.1339s/iter; left time: 1306.3518s
Epoch: 37 cost time: 4.868780851364136
Epoch: 37, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.837 Vali Acc: 0.365 Test Loss: 2.837 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 1.0273255
	speed: 0.1228s/iter; left time: 1179.0352s
Epoch: 38 cost time: 4.904155492782593
Epoch: 38, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.974 Vali Acc: 0.365 Test Loss: 2.974 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 1.3103136
	speed: 0.1220s/iter; left time: 1152.8945s
Epoch: 39 cost time: 4.416067123413086
Epoch: 39, Steps: 154 | Train Loss: 1.241 Vali Loss: 2.791 Vali Acc: 0.379 Test Loss: 2.791 Test Acc: 0.379
Validation loss decreased (-0.374262 --> -0.379129).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.0699062
	speed: 0.1252s/iter; left time: 1163.8681s
Epoch: 40 cost time: 4.806778907775879
Epoch: 40, Steps: 154 | Train Loss: 1.202 Vali Loss: 3.070 Vali Acc: 0.370 Test Loss: 3.070 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 1.4547101
	speed: 0.1221s/iter; left time: 1116.0092s
Epoch: 41 cost time: 4.838693141937256
Epoch: 41, Steps: 154 | Train Loss: 1.179 Vali Loss: 3.157 Vali Acc: 0.366 Test Loss: 3.157 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 1.1502385
	speed: 0.1209s/iter; left time: 1086.4512s
Epoch: 42 cost time: 4.671497583389282
Epoch: 42, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.949 Vali Acc: 0.378 Test Loss: 2.949 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 7.8599391
	speed: 0.1236s/iter; left time: 1091.4774s
Epoch: 43 cost time: 4.763850212097168
Epoch: 43, Steps: 154 | Train Loss: 1.380 Vali Loss: 3.146 Vali Acc: 0.371 Test Loss: 3.146 Test Acc: 0.371
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 1.4891429
	speed: 0.1230s/iter; left time: 1067.3807s
Epoch: 44 cost time: 4.763650417327881
Epoch: 44, Steps: 154 | Train Loss: 1.278 Vali Loss: 3.164 Vali Acc: 0.366 Test Loss: 3.164 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 0.8830462
	speed: 0.1175s/iter; left time: 1001.7032s
Epoch: 45 cost time: 4.511089086532593
Epoch: 45, Steps: 154 | Train Loss: 1.360 Vali Loss: 2.970 Vali Acc: 0.371 Test Loss: 2.970 Test Acc: 0.371
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 46 | loss: 1.3824311
	speed: 0.1300s/iter; left time: 1088.2796s
Epoch: 46 cost time: 4.685139179229736
Epoch: 46, Steps: 154 | Train Loss: 1.334 Vali Loss: 3.228 Vali Acc: 0.378 Test Loss: 3.228 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 47 | loss: 0.8514917
	speed: 0.1212s/iter; left time: 995.5741s
Epoch: 47 cost time: 4.565778970718384
Epoch: 47, Steps: 154 | Train Loss: 1.193 Vali Loss: 3.260 Vali Acc: 0.375 Test Loss: 3.260 Test Acc: 0.375
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 48 | loss: 1.1530614
	speed: 0.1219s/iter; left time: 983.1822s
Epoch: 48 cost time: 4.76150369644165
Epoch: 48, Steps: 154 | Train Loss: 1.262 Vali Loss: 3.365 Vali Acc: 0.376 Test Loss: 3.365 Test Acc: 0.376
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 49 | loss: 0.5615141
	speed: 0.1287s/iter; left time: 1018.1977s
Epoch: 49 cost time: 4.643203496932983
Epoch: 49, Steps: 154 | Train Loss: 1.250 Vali Loss: 3.366 Vali Acc: 0.385 Test Loss: 3.366 Test Acc: 0.385
Validation loss decreased (-0.379129 --> -0.384800).  Saving model ...
	iters: 100, epoch: 50 | loss: 1.2299567
	speed: 0.1259s/iter; left time: 976.3209s
Epoch: 50 cost time: 4.879302024841309
Epoch: 50, Steps: 154 | Train Loss: 1.248 Vali Loss: 3.232 Vali Acc: 0.389 Test Loss: 3.232 Test Acc: 0.389
Validation loss decreased (-0.384800 --> -0.389262).  Saving model ...
	iters: 100, epoch: 51 | loss: 4.0846910
	speed: 0.1239s/iter; left time: 941.4318s
Epoch: 51 cost time: 4.820701837539673
Epoch: 51, Steps: 154 | Train Loss: 1.461 Vali Loss: 3.457 Vali Acc: 0.390 Test Loss: 3.457 Test Acc: 0.390
Validation loss decreased (-0.389262 --> -0.390071).  Saving model ...
	iters: 100, epoch: 52 | loss: 1.1560892
	speed: 0.1271s/iter; left time: 946.2289s
Epoch: 52 cost time: 4.785768508911133
Epoch: 52, Steps: 154 | Train Loss: 1.242 Vali Loss: 3.360 Vali Acc: 0.375 Test Loss: 3.360 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 53 | loss: 1.6304630
	speed: 0.1230s/iter; left time: 896.9994s
Epoch: 53 cost time: 4.607207775115967
Epoch: 53, Steps: 154 | Train Loss: 1.247 Vali Loss: 3.203 Vali Acc: 0.381 Test Loss: 3.203 Test Acc: 0.381
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 54 | loss: 0.5657957
	speed: 0.1234s/iter; left time: 880.7063s
Epoch: 54 cost time: 4.926140785217285
Epoch: 54, Steps: 154 | Train Loss: 1.271 Vali Loss: 3.248 Vali Acc: 0.389 Test Loss: 3.248 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 55 | loss: 0.7701250
	speed: 0.1141s/iter; left time: 797.2901s
Epoch: 55 cost time: 4.590489149093628
Epoch: 55, Steps: 154 | Train Loss: 1.308 Vali Loss: 3.547 Vali Acc: 0.376 Test Loss: 3.547 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 56 | loss: 0.8904099
	speed: 0.1234s/iter; left time: 843.0343s
Epoch: 56 cost time: 4.437720537185669
Epoch: 56, Steps: 154 | Train Loss: 1.103 Vali Loss: 3.461 Vali Acc: 0.384 Test Loss: 3.461 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 57 | loss: 1.1654201
	speed: 0.1182s/iter; left time: 789.3463s
Epoch: 57 cost time: 4.933339357376099
Epoch: 57, Steps: 154 | Train Loss: 1.360 Vali Loss: 3.567 Vali Acc: 0.377 Test Loss: 3.567 Test Acc: 0.377
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 58 | loss: 1.5967669
	speed: 0.1306s/iter; left time: 851.6655s
Epoch: 58 cost time: 4.384347438812256
Epoch: 58, Steps: 154 | Train Loss: 1.096 Vali Loss: 3.642 Vali Acc: 0.384 Test Loss: 3.642 Test Acc: 0.384
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 59 | loss: 0.8283461
	speed: 0.1200s/iter; left time: 764.0570s
Epoch: 59 cost time: 4.658585071563721
Epoch: 59, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.677 Vali Acc: 0.373 Test Loss: 3.677 Test Acc: 0.373
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 60 | loss: 1.0324022
	speed: 0.1233s/iter; left time: 766.0080s
Epoch: 60 cost time: 4.8907270431518555
Epoch: 60, Steps: 154 | Train Loss: 1.233 Vali Loss: 3.549 Vali Acc: 0.384 Test Loss: 3.549 Test Acc: 0.384
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 61 | loss: 1.0179160
	speed: 0.1220s/iter; left time: 739.2642s
Epoch: 61 cost time: 4.611820697784424
Epoch: 61, Steps: 154 | Train Loss: 1.088 Vali Loss: 3.517 Vali Acc: 0.388 Test Loss: 3.517 Test Acc: 0.388
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39010543390105434
model parameter : 305334
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9511276
	speed: 0.0489s/iter; left time: 748.9376s
Epoch: 1 cost time: 6.462537527084351
Epoch: 1, Steps: 154 | Train Loss: 2.264 Vali Loss: 2.135 Vali Acc: 0.318 Test Loss: 2.135 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1029251
	speed: 0.1180s/iter; left time: 1787.4389s
Epoch: 2 cost time: 4.772488594055176
Epoch: 2, Steps: 154 | Train Loss: 2.073 Vali Loss: 2.135 Vali Acc: 0.320 Test Loss: 2.135 Test Acc: 0.320
Validation loss decreased (-0.317497 --> -0.320336).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9094343
	speed: 0.1250s/iter; left time: 1873.7425s
Epoch: 3 cost time: 4.862778186798096
Epoch: 3, Steps: 154 | Train Loss: 1.985 Vali Loss: 2.179 Vali Acc: 0.322 Test Loss: 2.179 Test Acc: 0.322
Validation loss decreased (-0.320336 --> -0.321552).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4178405
	speed: 0.1252s/iter; left time: 1857.7648s
Epoch: 4 cost time: 4.873432159423828
Epoch: 4, Steps: 154 | Train Loss: 1.962 Vali Loss: 2.134 Vali Acc: 0.324 Test Loss: 2.134 Test Acc: 0.324
Validation loss decreased (-0.321552 --> -0.323580).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7513349
	speed: 0.1204s/iter; left time: 1768.2623s
Epoch: 5 cost time: 4.948165416717529
Epoch: 5, Steps: 154 | Train Loss: 1.907 Vali Loss: 2.177 Vali Acc: 0.327 Test Loss: 2.177 Test Acc: 0.327
Validation loss decreased (-0.323580 --> -0.327229).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6037605
	speed: 0.1223s/iter; left time: 1776.6826s
Epoch: 6 cost time: 4.857081174850464
Epoch: 6, Steps: 154 | Train Loss: 1.895 Vali Loss: 2.144 Vali Acc: 0.330 Test Loss: 2.144 Test Acc: 0.330
Validation loss decreased (-0.327229 --> -0.330068).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9822170
	speed: 0.1187s/iter; left time: 1706.8928s
Epoch: 7 cost time: 4.360118865966797
Epoch: 7, Steps: 154 | Train Loss: 1.863 Vali Loss: 2.159 Vali Acc: 0.327 Test Loss: 2.159 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0340059
	speed: 0.1023s/iter; left time: 1454.5735s
Epoch: 8 cost time: 4.498448133468628
Epoch: 8, Steps: 154 | Train Loss: 1.812 Vali Loss: 2.123 Vali Acc: 0.327 Test Loss: 2.123 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7659466
	speed: 0.1239s/iter; left time: 1742.8175s
Epoch: 9 cost time: 5.042358160018921
Epoch: 9, Steps: 154 | Train Loss: 1.808 Vali Loss: 2.168 Vali Acc: 0.328 Test Loss: 2.168 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.5587927
	speed: 0.1251s/iter; left time: 1741.1359s
Epoch: 10 cost time: 4.736093997955322
Epoch: 10, Steps: 154 | Train Loss: 1.752 Vali Loss: 2.179 Vali Acc: 0.328 Test Loss: 2.179 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.0005865
	speed: 0.1187s/iter; left time: 1633.1298s
Epoch: 11 cost time: 5.187564134597778
Epoch: 11, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.206 Vali Acc: 0.328 Test Loss: 2.206 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.6185734
	speed: 0.1253s/iter; left time: 1704.5082s
Epoch: 12 cost time: 4.770570993423462
Epoch: 12, Steps: 154 | Train Loss: 1.693 Vali Loss: 2.178 Vali Acc: 0.332 Test Loss: 2.178 Test Acc: 0.332
Validation loss decreased (-0.330068 --> -0.332095).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2989366
	speed: 0.1235s/iter; left time: 1661.1995s
Epoch: 13 cost time: 4.484231472015381
Epoch: 13, Steps: 154 | Train Loss: 1.705 Vali Loss: 2.238 Vali Acc: 0.335 Test Loss: 2.238 Test Acc: 0.335
Validation loss decreased (-0.332095 --> -0.335339).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5717832
	speed: 0.1144s/iter; left time: 1521.5880s
Epoch: 14 cost time: 4.671817064285278
Epoch: 14, Steps: 154 | Train Loss: 1.701 Vali Loss: 2.188 Vali Acc: 0.342 Test Loss: 2.188 Test Acc: 0.342
Validation loss decreased (-0.335339 --> -0.342233).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.8046465
	speed: 0.1164s/iter; left time: 1529.9439s
Epoch: 15 cost time: 4.7079758644104
Epoch: 15, Steps: 154 | Train Loss: 1.717 Vali Loss: 2.419 Vali Acc: 0.351 Test Loss: 2.419 Test Acc: 0.351
Validation loss decreased (-0.342233 --> -0.351152).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.1617134
	speed: 0.1219s/iter; left time: 1583.4225s
Epoch: 16 cost time: 4.643277645111084
Epoch: 16, Steps: 154 | Train Loss: 1.661 Vali Loss: 2.244 Vali Acc: 0.352 Test Loss: 2.244 Test Acc: 0.352
Validation loss decreased (-0.351152 --> -0.351965).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.3776745
	speed: 0.1150s/iter; left time: 1476.1395s
Epoch: 17 cost time: 4.652639865875244
Epoch: 17, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.262 Vali Acc: 0.348 Test Loss: 2.262 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.1089916
	speed: 0.1225s/iter; left time: 1553.3161s
Epoch: 18 cost time: 4.7091522216796875
Epoch: 18, Steps: 154 | Train Loss: 1.581 Vali Loss: 2.300 Vali Acc: 0.348 Test Loss: 2.300 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.3468969
	speed: 0.1224s/iter; left time: 1533.9880s
Epoch: 19 cost time: 4.742176055908203
Epoch: 19, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.331 Vali Acc: 0.351 Test Loss: 2.331 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.0274731
	speed: 0.1290s/iter; left time: 1595.9568s
Epoch: 20 cost time: 5.784481763839722
Epoch: 20, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.419 Vali Acc: 0.354 Test Loss: 2.419 Test Acc: 0.354
Validation loss decreased (-0.351965 --> -0.353990).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.6541342
	speed: 0.1643s/iter; left time: 2007.9719s
Epoch: 21 cost time: 6.1845433712005615
Epoch: 21, Steps: 154 | Train Loss: 1.511 Vali Loss: 2.404 Vali Acc: 0.347 Test Loss: 2.404 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.9912459
	speed: 0.1380s/iter; left time: 1665.0210s
Epoch: 22 cost time: 4.525304079055786
Epoch: 22, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.451 Vali Acc: 0.351 Test Loss: 2.451 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.7487659
	speed: 0.1237s/iter; left time: 1473.1262s
Epoch: 23 cost time: 5.231476783752441
Epoch: 23, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.458 Vali Acc: 0.368 Test Loss: 2.458 Test Acc: 0.368
Validation loss decreased (-0.353990 --> -0.367778).  Saving model ...
	iters: 100, epoch: 24 | loss: 4.3265705
	speed: 0.1281s/iter; left time: 1505.8490s
Epoch: 24 cost time: 4.84339165687561
Epoch: 24, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.571 Vali Acc: 0.365 Test Loss: 2.571 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.1964967
	speed: 0.1234s/iter; left time: 1432.4323s
Epoch: 25 cost time: 4.984789848327637
Epoch: 25, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.916 Vali Acc: 0.325 Test Loss: 2.916 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.3518213
	speed: 0.1221s/iter; left time: 1397.8062s
Epoch: 26 cost time: 5.112815856933594
Epoch: 26, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.578 Vali Acc: 0.369 Test Loss: 2.578 Test Acc: 0.369
Validation loss decreased (-0.367778 --> -0.369398).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.2466302
	speed: 0.1272s/iter; left time: 1437.0677s
Epoch: 27 cost time: 5.018667221069336
Epoch: 27, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.601 Vali Acc: 0.368 Test Loss: 2.601 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 2.4112506
	speed: 0.1221s/iter; left time: 1360.4858s
Epoch: 28 cost time: 4.66048526763916
Epoch: 28, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.670 Vali Acc: 0.363 Test Loss: 2.670 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 2.0138419
	speed: 0.1178s/iter; left time: 1294.6541s
Epoch: 29 cost time: 4.818182706832886
Epoch: 29, Steps: 154 | Train Loss: 1.377 Vali Loss: 2.579 Vali Acc: 0.367 Test Loss: 2.579 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.2407715
	speed: 0.1153s/iter; left time: 1249.6947s
Epoch: 30 cost time: 4.756448984146118
Epoch: 30, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.664 Vali Acc: 0.371 Test Loss: 2.664 Test Acc: 0.371
Validation loss decreased (-0.369398 --> -0.371425).  Saving model ...
	iters: 100, epoch: 31 | loss: 1.5270357
	speed: 0.1266s/iter; left time: 1352.3197s
Epoch: 31 cost time: 4.808111190795898
Epoch: 31, Steps: 154 | Train Loss: 1.362 Vali Loss: 2.671 Vali Acc: 0.369 Test Loss: 2.671 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 1.3918936
	speed: 0.1224s/iter; left time: 1288.7244s
Epoch: 32 cost time: 4.776936292648315
Epoch: 32, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.952 Vali Acc: 0.373 Test Loss: 2.952 Test Acc: 0.373
Validation loss decreased (-0.371425 --> -0.373044).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.5415685
	speed: 0.1225s/iter; left time: 1271.0244s
Epoch: 33 cost time: 4.647244691848755
Epoch: 33, Steps: 154 | Train Loss: 1.420 Vali Loss: 2.810 Vali Acc: 0.369 Test Loss: 2.810 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 1.5865854
	speed: 0.1266s/iter; left time: 1293.3965s
Epoch: 34 cost time: 4.92547607421875
Epoch: 34, Steps: 154 | Train Loss: 1.376 Vali Loss: 3.149 Vali Acc: 0.207 Test Loss: 3.149 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 1.4520354
	speed: 0.1213s/iter; left time: 1221.0102s
Epoch: 35 cost time: 4.9642417430877686
Epoch: 35, Steps: 154 | Train Loss: 1.316 Vali Loss: 3.077 Vali Acc: 0.232 Test Loss: 3.077 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 1.4120134
	speed: 0.1248s/iter; left time: 1236.7906s
Epoch: 36 cost time: 4.926051139831543
Epoch: 36, Steps: 154 | Train Loss: 1.406 Vali Loss: 3.152 Vali Acc: 0.354 Test Loss: 3.152 Test Acc: 0.354
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.9136785
	speed: 0.1263s/iter; left time: 1232.0869s
Epoch: 37 cost time: 4.962540149688721
Epoch: 37, Steps: 154 | Train Loss: 1.324 Vali Loss: 2.994 Vali Acc: 0.382 Test Loss: 2.994 Test Acc: 0.382
Validation loss decreased (-0.373044 --> -0.381965).  Saving model ...
	iters: 100, epoch: 38 | loss: 1.1220599
	speed: 0.1280s/iter; left time: 1228.7156s
Epoch: 38 cost time: 5.493412017822266
Epoch: 38, Steps: 154 | Train Loss: 1.291 Vali Loss: 3.142 Vali Acc: 0.382 Test Loss: 3.142 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 1.1263043
	speed: 0.1310s/iter; left time: 1237.6027s
Epoch: 39 cost time: 4.977607250213623
Epoch: 39, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.976 Vali Acc: 0.382 Test Loss: 2.976 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 1.1475006
	speed: 0.1286s/iter; left time: 1195.3736s
Epoch: 40 cost time: 4.7815234661102295
Epoch: 40, Steps: 154 | Train Loss: 1.330 Vali Loss: 3.001 Vali Acc: 0.381 Test Loss: 3.001 Test Acc: 0.381
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 1.2922108
	speed: 0.1284s/iter; left time: 1173.3813s
Epoch: 41 cost time: 5.537093877792358
Epoch: 41, Steps: 154 | Train Loss: 1.319 Vali Loss: 3.186 Vali Acc: 0.386 Test Loss: 3.186 Test Acc: 0.386
Validation loss decreased (-0.381965 --> -0.386424).  Saving model ...
	iters: 100, epoch: 42 | loss: 1.2224671
	speed: 0.1287s/iter; left time: 1156.6072s
Epoch: 42 cost time: 4.929490327835083
Epoch: 42, Steps: 154 | Train Loss: 1.349 Vali Loss: 3.149 Vali Acc: 0.385 Test Loss: 3.149 Test Acc: 0.385
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 1.3132327
	speed: 0.1277s/iter; left time: 1127.7939s
Epoch: 43 cost time: 4.988072633743286
Epoch: 43, Steps: 154 | Train Loss: 1.315 Vali Loss: 3.210 Vali Acc: 0.228 Test Loss: 3.210 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 44 | loss: 1.2430618
	speed: 0.1255s/iter; left time: 1089.5480s
Epoch: 44 cost time: 5.255520820617676
Epoch: 44, Steps: 154 | Train Loss: 1.353 Vali Loss: 3.078 Vali Acc: 0.376 Test Loss: 3.078 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 45 | loss: 0.8803487
	speed: 0.1214s/iter; left time: 1035.3136s
Epoch: 45 cost time: 4.761036396026611
Epoch: 45, Steps: 154 | Train Loss: 1.493 Vali Loss: 3.249 Vali Acc: 0.380 Test Loss: 3.249 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 46 | loss: 1.4043775
	speed: 0.1169s/iter; left time: 978.5618s
Epoch: 46 cost time: 4.448516845703125
Epoch: 46, Steps: 154 | Train Loss: 1.193 Vali Loss: 2.991 Vali Acc: 0.310 Test Loss: 2.991 Test Acc: 0.310
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 47 | loss: 1.1713043
	speed: 0.1203s/iter; left time: 988.2028s
Epoch: 47 cost time: 4.777606010437012
Epoch: 47, Steps: 154 | Train Loss: 1.260 Vali Loss: 3.369 Vali Acc: 0.220 Test Loss: 3.369 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 48 | loss: 1.3615363
	speed: 0.1175s/iter; left time: 947.5840s
Epoch: 48 cost time: 4.813440561294556
Epoch: 48, Steps: 154 | Train Loss: 1.373 Vali Loss: 3.407 Vali Acc: 0.380 Test Loss: 3.407 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 49 | loss: 0.8956200
	speed: 0.1245s/iter; left time: 984.7828s
Epoch: 49 cost time: 4.46466064453125
Epoch: 49, Steps: 154 | Train Loss: 1.223 Vali Loss: 3.251 Vali Acc: 0.382 Test Loss: 3.251 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 50 | loss: 0.8255195
	speed: 0.1201s/iter; left time: 931.1127s
Epoch: 50 cost time: 4.911153078079224
Epoch: 50, Steps: 154 | Train Loss: 1.263 Vali Loss: 3.374 Vali Acc: 0.381 Test Loss: 3.374 Test Acc: 0.381
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 51 | loss: 1.4545120
	speed: 0.1126s/iter; left time: 855.7249s
Epoch: 51 cost time: 4.27372932434082
Epoch: 51, Steps: 154 | Train Loss: 1.303 Vali Loss: 3.499 Vali Acc: 0.373 Test Loss: 3.499 Test Acc: 0.373
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.386455798864558
model parameter : 174262
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9805316
	speed: 0.0481s/iter; left time: 736.4698s
Epoch: 1 cost time: 6.4018237590789795
Epoch: 1, Steps: 154 | Train Loss: 2.257 Vali Loss: 2.134 Vali Acc: 0.318 Test Loss: 2.134 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1014950
	speed: 0.1177s/iter; left time: 1782.2530s
Epoch: 2 cost time: 5.025552272796631
Epoch: 2, Steps: 154 | Train Loss: 2.075 Vali Loss: 2.140 Vali Acc: 0.320 Test Loss: 2.140 Test Acc: 0.320
Validation loss decreased (-0.317497 --> -0.319524).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9165776
	speed: 0.1228s/iter; left time: 1841.0308s
Epoch: 3 cost time: 4.838555097579956
Epoch: 3, Steps: 154 | Train Loss: 1.988 Vali Loss: 2.179 Vali Acc: 0.323 Test Loss: 2.179 Test Acc: 0.323
Validation loss decreased (-0.319524 --> -0.322768).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8353398
	speed: 0.1232s/iter; left time: 1828.8097s
Epoch: 4 cost time: 4.510180950164795
Epoch: 4, Steps: 154 | Train Loss: 1.961 Vali Loss: 2.135 Vali Acc: 0.326 Test Loss: 2.135 Test Acc: 0.326
Validation loss decreased (-0.322768 --> -0.325607).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7365409
	speed: 0.1192s/iter; left time: 1750.7654s
Epoch: 5 cost time: 4.614517450332642
Epoch: 5, Steps: 154 | Train Loss: 1.908 Vali Loss: 2.212 Vali Acc: 0.328 Test Loss: 2.212 Test Acc: 0.328
Validation loss decreased (-0.325607 --> -0.327634).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3608167
	speed: 0.1159s/iter; left time: 1683.8130s
Epoch: 6 cost time: 4.482698678970337
Epoch: 6, Steps: 154 | Train Loss: 1.899 Vali Loss: 2.146 Vali Acc: 0.328 Test Loss: 2.146 Test Acc: 0.328
Validation loss decreased (-0.327634 --> -0.328040).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9911705
	speed: 0.1138s/iter; left time: 1636.0916s
Epoch: 7 cost time: 4.393079996109009
Epoch: 7, Steps: 154 | Train Loss: 1.853 Vali Loss: 2.170 Vali Acc: 0.326 Test Loss: 2.170 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9601948
	speed: 0.1231s/iter; left time: 1750.8827s
Epoch: 8 cost time: 4.852100372314453
Epoch: 8, Steps: 154 | Train Loss: 1.814 Vali Loss: 2.125 Vali Acc: 0.327 Test Loss: 2.125 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.6720849
	speed: 0.1201s/iter; left time: 1689.5730s
Epoch: 9 cost time: 5.132813930511475
Epoch: 9, Steps: 154 | Train Loss: 1.802 Vali Loss: 2.144 Vali Acc: 0.330 Test Loss: 2.144 Test Acc: 0.330
Validation loss decreased (-0.328040 --> -0.330473).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5741383
	speed: 0.1259s/iter; left time: 1752.3436s
Epoch: 10 cost time: 4.889939308166504
Epoch: 10, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.164 Vali Acc: 0.333 Test Loss: 2.164 Test Acc: 0.333
Validation loss decreased (-0.330473 --> -0.333312).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0570993
	speed: 0.1236s/iter; left time: 1700.7525s
Epoch: 11 cost time: 4.9079978466033936
Epoch: 11, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.175 Vali Acc: 0.332 Test Loss: 2.175 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6781054
	speed: 0.1282s/iter; left time: 1744.9171s
Epoch: 12 cost time: 5.267585039138794
Epoch: 12, Steps: 154 | Train Loss: 1.716 Vali Loss: 2.204 Vali Acc: 0.339 Test Loss: 2.204 Test Acc: 0.339
Validation loss decreased (-0.333312 --> -0.338583).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3380256
	speed: 0.1259s/iter; left time: 1693.2499s
Epoch: 13 cost time: 5.05890417098999
Epoch: 13, Steps: 154 | Train Loss: 1.680 Vali Loss: 2.250 Vali Acc: 0.339 Test Loss: 2.250 Test Acc: 0.339
Validation loss decreased (-0.338583 --> -0.339394).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5822366
	speed: 0.1185s/iter; left time: 1576.1082s
Epoch: 14 cost time: 4.817844867706299
Epoch: 14, Steps: 154 | Train Loss: 1.685 Vali Loss: 2.218 Vali Acc: 0.345 Test Loss: 2.218 Test Acc: 0.345
Validation loss decreased (-0.339394 --> -0.344666).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.8981481
	speed: 0.1276s/iter; left time: 1676.8420s
Epoch: 15 cost time: 4.666629791259766
Epoch: 15, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.360 Vali Acc: 0.353 Test Loss: 2.360 Test Acc: 0.353
Validation loss decreased (-0.344666 --> -0.353180).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.0093558
	speed: 0.1215s/iter; left time: 1579.0078s
Epoch: 16 cost time: 4.969096422195435
Epoch: 16, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.289 Vali Acc: 0.354 Test Loss: 2.289 Test Acc: 0.354
Validation loss decreased (-0.353180 --> -0.353586).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.3846903
	speed: 0.1233s/iter; left time: 1582.7312s
Epoch: 17 cost time: 4.736699342727661
Epoch: 17, Steps: 154 | Train Loss: 1.648 Vali Loss: 2.338 Vali Acc: 0.349 Test Loss: 2.338 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 4.3592296
	speed: 0.1225s/iter; left time: 1553.2393s
Epoch: 18 cost time: 4.8041253089904785
Epoch: 18, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.275 Vali Acc: 0.352 Test Loss: 2.275 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.4376813
	speed: 0.1191s/iter; left time: 1492.7129s
Epoch: 19 cost time: 4.978276968002319
Epoch: 19, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.468 Vali Acc: 0.354 Test Loss: 2.468 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.9473702
	speed: 0.1178s/iter; left time: 1457.4469s
Epoch: 20 cost time: 4.87331748008728
Epoch: 20, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.499 Vali Acc: 0.356 Test Loss: 2.499 Test Acc: 0.356
Validation loss decreased (-0.353586 --> -0.356423).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.6141220
	speed: 0.1237s/iter; left time: 1512.0062s
Epoch: 21 cost time: 4.884461402893066
Epoch: 21, Steps: 154 | Train Loss: 1.547 Vali Loss: 2.554 Vali Acc: 0.351 Test Loss: 2.554 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.9473415
	speed: 0.1233s/iter; left time: 1487.3906s
Epoch: 22 cost time: 4.637302398681641
Epoch: 22, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.513 Vali Acc: 0.356 Test Loss: 2.513 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.6444850
	speed: 0.1172s/iter; left time: 1396.6797s
Epoch: 23 cost time: 4.978083848953247
Epoch: 23, Steps: 154 | Train Loss: 1.485 Vali Loss: 2.436 Vali Acc: 0.364 Test Loss: 2.436 Test Acc: 0.364
Validation loss decreased (-0.356423 --> -0.364128).  Saving model ...
	iters: 100, epoch: 24 | loss: 3.3319483
	speed: 0.1278s/iter; left time: 1502.5528s
Epoch: 24 cost time: 4.916051864624023
Epoch: 24, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.614 Vali Acc: 0.362 Test Loss: 2.614 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.3406156
	speed: 0.1235s/iter; left time: 1433.0568s
Epoch: 25 cost time: 4.328018426895142
Epoch: 25, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.744 Vali Acc: 0.358 Test Loss: 2.744 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.2832453
	speed: 0.1211s/iter; left time: 1386.2574s
Epoch: 26 cost time: 5.120270252227783
Epoch: 26, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.663 Vali Acc: 0.369 Test Loss: 2.663 Test Acc: 0.369
Validation loss decreased (-0.364128 --> -0.368587).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.2428851
	speed: 0.1255s/iter; left time: 1417.7404s
Epoch: 27 cost time: 4.882120132446289
Epoch: 27, Steps: 154 | Train Loss: 1.441 Vali Loss: 2.697 Vali Acc: 0.368 Test Loss: 2.697 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.9146316
	speed: 0.1241s/iter; left time: 1382.9293s
Epoch: 28 cost time: 4.662666320800781
Epoch: 28, Steps: 154 | Train Loss: 1.425 Vali Loss: 2.709 Vali Acc: 0.362 Test Loss: 2.709 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.8058360
	speed: 0.1249s/iter; left time: 1372.9035s
Epoch: 29 cost time: 4.9812188148498535
Epoch: 29, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.682 Vali Acc: 0.360 Test Loss: 2.682 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.3370156
	speed: 0.1262s/iter; left time: 1366.8888s
Epoch: 30 cost time: 5.3037073612213135
Epoch: 30, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.837 Vali Acc: 0.368 Test Loss: 2.837 Test Acc: 0.368
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 1.5779316
	speed: 0.1203s/iter; left time: 1285.0623s
Epoch: 31 cost time: 4.60673975944519
Epoch: 31, Steps: 154 | Train Loss: 1.373 Vali Loss: 3.110 Vali Acc: 0.362 Test Loss: 3.110 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 1.3012177
	speed: 0.1151s/iter; left time: 1212.1714s
Epoch: 32 cost time: 4.177680492401123
Epoch: 32, Steps: 154 | Train Loss: 1.430 Vali Loss: 3.240 Vali Acc: 0.371 Test Loss: 3.240 Test Acc: 0.371
Validation loss decreased (-0.368587 --> -0.371419).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.7309407
	speed: 0.1160s/iter; left time: 1203.5532s
Epoch: 33 cost time: 4.711843729019165
Epoch: 33, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.912 Vali Acc: 0.360 Test Loss: 2.912 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 1.5413800
	speed: 0.1247s/iter; left time: 1273.9394s
Epoch: 34 cost time: 4.938410043716431
Epoch: 34, Steps: 154 | Train Loss: 1.311 Vali Loss: 2.925 Vali Acc: 0.323 Test Loss: 2.925 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 1.3615458
	speed: 0.1221s/iter; left time: 1229.3544s
Epoch: 35 cost time: 4.405948162078857
Epoch: 35, Steps: 154 | Train Loss: 1.417 Vali Loss: 3.114 Vali Acc: 0.373 Test Loss: 3.114 Test Acc: 0.373
Validation loss decreased (-0.371419 --> -0.372637).  Saving model ...
	iters: 100, epoch: 36 | loss: 1.5738882
	speed: 0.1208s/iter; left time: 1197.5938s
Epoch: 36 cost time: 4.661970138549805
Epoch: 36, Steps: 154 | Train Loss: 1.409 Vali Loss: 3.180 Vali Acc: 0.377 Test Loss: 3.180 Test Acc: 0.377
Validation loss decreased (-0.372637 --> -0.377097).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.8998026
	speed: 0.1195s/iter; left time: 1165.7371s
Epoch: 37 cost time: 5.216470718383789
Epoch: 37, Steps: 154 | Train Loss: 1.290 Vali Loss: 3.138 Vali Acc: 0.380 Test Loss: 3.138 Test Acc: 0.380
Validation loss decreased (-0.377097 --> -0.379936).  Saving model ...
	iters: 100, epoch: 38 | loss: 1.2176405
	speed: 0.1203s/iter; left time: 1154.9025s
Epoch: 38 cost time: 4.7739787101745605
Epoch: 38, Steps: 154 | Train Loss: 1.272 Vali Loss: 3.639 Vali Acc: 0.375 Test Loss: 3.639 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 1.0059702
	speed: 0.1233s/iter; left time: 1164.6400s
Epoch: 39 cost time: 4.785566091537476
Epoch: 39, Steps: 154 | Train Loss: 1.362 Vali Loss: 3.239 Vali Acc: 0.376 Test Loss: 3.239 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 1.0008799
	speed: 0.1275s/iter; left time: 1185.5335s
Epoch: 40 cost time: 4.895908832550049
Epoch: 40, Steps: 154 | Train Loss: 1.274 Vali Loss: 3.612 Vali Acc: 0.378 Test Loss: 3.612 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 1.2236480
	speed: 0.1225s/iter; left time: 1119.5583s
Epoch: 41 cost time: 5.170961618423462
Epoch: 41, Steps: 154 | Train Loss: 1.411 Vali Loss: 3.509 Vali Acc: 0.379 Test Loss: 3.509 Test Acc: 0.379
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 42 | loss: 1.2039872
	speed: 0.1245s/iter; left time: 1119.2912s
Epoch: 42 cost time: 5.005462408065796
Epoch: 42, Steps: 154 | Train Loss: 1.311 Vali Loss: 3.462 Vali Acc: 0.385 Test Loss: 3.462 Test Acc: 0.385
Validation loss decreased (-0.379936 --> -0.384799).  Saving model ...
	iters: 100, epoch: 43 | loss: 1.1006545
	speed: 0.1300s/iter; left time: 1148.1543s
Epoch: 43 cost time: 4.872427225112915
Epoch: 43, Steps: 154 | Train Loss: 1.575 Vali Loss: 3.122 Vali Acc: 0.219 Test Loss: 3.122 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 1.2007456
	speed: 0.1272s/iter; left time: 1104.0684s
Epoch: 44 cost time: 5.307118892669678
Epoch: 44, Steps: 154 | Train Loss: 1.229 Vali Loss: 3.253 Vali Acc: 0.376 Test Loss: 3.253 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 1.0139627
	speed: 0.1268s/iter; left time: 1081.2050s
Epoch: 45 cost time: 4.661709785461426
Epoch: 45, Steps: 154 | Train Loss: 1.250 Vali Loss: 3.228 Vali Acc: 0.374 Test Loss: 3.228 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 46 | loss: 1.3711023
	speed: 0.1249s/iter; left time: 1045.5351s
Epoch: 46 cost time: 4.981958389282227
Epoch: 46, Steps: 154 | Train Loss: 1.186 Vali Loss: 3.263 Vali Acc: 0.386 Test Loss: 3.263 Test Acc: 0.386
Validation loss decreased (-0.384799 --> -0.386018).  Saving model ...
	iters: 100, epoch: 47 | loss: 1.2536434
	speed: 0.1217s/iter; left time: 999.9363s
Epoch: 47 cost time: 4.773967742919922
Epoch: 47, Steps: 154 | Train Loss: 1.194 Vali Loss: 3.483 Vali Acc: 0.222 Test Loss: 3.483 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 48 | loss: 1.1507719
	speed: 0.1242s/iter; left time: 1001.1076s
Epoch: 48 cost time: 5.2599170207977295
Epoch: 48, Steps: 154 | Train Loss: 1.263 Vali Loss: 3.632 Vali Acc: 0.349 Test Loss: 3.632 Test Acc: 0.349
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 49 | loss: 1.0322115
	speed: 0.1198s/iter; left time: 947.6091s
Epoch: 49 cost time: 4.4995503425598145
Epoch: 49, Steps: 154 | Train Loss: 1.276 Vali Loss: 3.262 Vali Acc: 0.351 Test Loss: 3.262 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 50 | loss: 0.9726886
	speed: 0.1107s/iter; left time: 858.4694s
Epoch: 50 cost time: 4.503961801528931
Epoch: 50, Steps: 154 | Train Loss: 1.428 Vali Loss: 3.240 Vali Acc: 0.383 Test Loss: 3.240 Test Acc: 0.383
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 51 | loss: 1.5290793
	speed: 0.1166s/iter; left time: 886.4642s
Epoch: 51 cost time: 5.236448764801025
Epoch: 51, Steps: 154 | Train Loss: 1.211 Vali Loss: 3.565 Vali Acc: 0.376 Test Loss: 3.565 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 52 | loss: 3.8432407
	speed: 0.1222s/iter; left time: 909.9700s
Epoch: 52 cost time: 4.703031539916992
Epoch: 52, Steps: 154 | Train Loss: 1.517 Vali Loss: 3.235 Vali Acc: 0.351 Test Loss: 3.235 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 53 | loss: 0.6289815
	speed: 0.1216s/iter; left time: 886.8438s
Epoch: 53 cost time: 4.672518014907837
Epoch: 53, Steps: 154 | Train Loss: 1.146 Vali Loss: 3.691 Vali Acc: 0.383 Test Loss: 3.691 Test Acc: 0.383
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 54 | loss: 0.7924433
	speed: 0.1238s/iter; left time: 883.6747s
Epoch: 54 cost time: 5.02272629737854
Epoch: 54, Steps: 154 | Train Loss: 1.172 Vali Loss: 3.101 Vali Acc: 0.225 Test Loss: 3.101 Test Acc: 0.225
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 55 | loss: 0.9331864
	speed: 0.1222s/iter; left time: 853.5671s
Epoch: 55 cost time: 5.226713180541992
Epoch: 55, Steps: 154 | Train Loss: 1.194 Vali Loss: 3.496 Vali Acc: 0.258 Test Loss: 3.496 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 56 | loss: 1.4920098
	speed: 0.1175s/iter; left time: 802.9478s
Epoch: 56 cost time: 3.8266608715057373
Epoch: 56, Steps: 154 | Train Loss: 1.212 Vali Loss: 3.640 Vali Acc: 0.382 Test Loss: 3.640 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38605028386050283
model parameter : 174262
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9258313
	speed: 0.0449s/iter; left time: 687.6743s
Epoch: 1 cost time: 6.066812753677368
Epoch: 1, Steps: 154 | Train Loss: 2.255 Vali Loss: 2.138 Vali Acc: 0.318 Test Loss: 2.138 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0767384
	speed: 0.1154s/iter; left time: 1747.7286s
Epoch: 2 cost time: 4.56365180015564
Epoch: 2, Steps: 154 | Train Loss: 2.076 Vali Loss: 2.141 Vali Acc: 0.319 Test Loss: 2.141 Test Acc: 0.319
Validation loss decreased (-0.317902 --> -0.318713).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8904161
	speed: 0.1138s/iter; left time: 1706.9212s
Epoch: 3 cost time: 4.317951679229736
Epoch: 3, Steps: 154 | Train Loss: 1.989 Vali Loss: 2.171 Vali Acc: 0.322 Test Loss: 2.171 Test Acc: 0.322
Validation loss decreased (-0.318713 --> -0.321552).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.3009133
	speed: 0.1175s/iter; left time: 1744.2711s
Epoch: 4 cost time: 4.903468608856201
Epoch: 4, Steps: 154 | Train Loss: 1.970 Vali Loss: 2.126 Vali Acc: 0.324 Test Loss: 2.126 Test Acc: 0.324
Validation loss decreased (-0.321552 --> -0.323985).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7423481
	speed: 0.1214s/iter; left time: 1782.5270s
Epoch: 5 cost time: 4.614511489868164
Epoch: 5, Steps: 154 | Train Loss: 1.912 Vali Loss: 2.180 Vali Acc: 0.327 Test Loss: 2.180 Test Acc: 0.327
Validation loss decreased (-0.323985 --> -0.326823).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2764909
	speed: 0.1196s/iter; left time: 1737.8400s
Epoch: 6 cost time: 4.4917991161346436
Epoch: 6, Steps: 154 | Train Loss: 1.889 Vali Loss: 2.128 Vali Acc: 0.329 Test Loss: 2.128 Test Acc: 0.329
Validation loss decreased (-0.326823 --> -0.328851).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0215471
	speed: 0.1170s/iter; left time: 1682.3084s
Epoch: 7 cost time: 4.810083389282227
Epoch: 7, Steps: 154 | Train Loss: 1.883 Vali Loss: 2.150 Vali Acc: 0.325 Test Loss: 2.150 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9420553
	speed: 0.1189s/iter; left time: 1691.1109s
Epoch: 8 cost time: 4.316861867904663
Epoch: 8, Steps: 154 | Train Loss: 1.814 Vali Loss: 2.112 Vali Acc: 0.331 Test Loss: 2.112 Test Acc: 0.331
Validation loss decreased (-0.328851 --> -0.330879).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6993958
	speed: 0.1177s/iter; left time: 1656.0741s
Epoch: 9 cost time: 4.502263784408569
Epoch: 9, Steps: 154 | Train Loss: 1.809 Vali Loss: 2.139 Vali Acc: 0.332 Test Loss: 2.139 Test Acc: 0.332
Validation loss decreased (-0.330879 --> -0.331690).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5440865
	speed: 0.1150s/iter; left time: 1600.2621s
Epoch: 10 cost time: 4.6273016929626465
Epoch: 10, Steps: 154 | Train Loss: 1.761 Vali Loss: 2.161 Vali Acc: 0.331 Test Loss: 2.161 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.9588599
	speed: 0.1158s/iter; left time: 1593.7949s
Epoch: 11 cost time: 4.521035432815552
Epoch: 11, Steps: 154 | Train Loss: 1.790 Vali Loss: 2.206 Vali Acc: 0.334 Test Loss: 2.206 Test Acc: 0.334
Validation loss decreased (-0.331690 --> -0.334122).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6202731
	speed: 0.1194s/iter; left time: 1625.0474s
Epoch: 12 cost time: 4.5696704387664795
Epoch: 12, Steps: 154 | Train Loss: 1.686 Vali Loss: 2.241 Vali Acc: 0.341 Test Loss: 2.241 Test Acc: 0.341
Validation loss decreased (-0.334122 --> -0.340610).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2827718
	speed: 0.1161s/iter; left time: 1561.4818s
Epoch: 13 cost time: 4.713834047317505
Epoch: 13, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.298 Vali Acc: 0.339 Test Loss: 2.298 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.6099811
	speed: 0.1210s/iter; left time: 1608.5577s
Epoch: 14 cost time: 4.541346549987793
Epoch: 14, Steps: 154 | Train Loss: 1.697 Vali Loss: 2.225 Vali Acc: 0.343 Test Loss: 2.225 Test Acc: 0.343
Validation loss decreased (-0.340610 --> -0.343043).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.9386859
	speed: 0.1135s/iter; left time: 1492.3857s
Epoch: 15 cost time: 4.18435263633728
Epoch: 15, Steps: 154 | Train Loss: 1.630 Vali Loss: 2.504 Vali Acc: 0.352 Test Loss: 2.504 Test Acc: 0.352
Validation loss decreased (-0.343043 --> -0.351962).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.9789894
	speed: 0.0988s/iter; left time: 1282.9432s
Epoch: 16 cost time: 4.050971508026123
Epoch: 16, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.375 Vali Acc: 0.352 Test Loss: 2.375 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.3938890
	speed: 0.1101s/iter; left time: 1412.8778s
Epoch: 17 cost time: 4.306996583938599
Epoch: 17, Steps: 154 | Train Loss: 1.568 Vali Loss: 2.338 Vali Acc: 0.352 Test Loss: 2.338 Test Acc: 0.352
Validation loss decreased (-0.351962 --> -0.351964).  Saving model ...
	iters: 100, epoch: 18 | loss: 6.1079712
	speed: 0.1196s/iter; left time: 1516.9039s
Epoch: 18 cost time: 5.0379111766815186
Epoch: 18, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.336 Vali Acc: 0.354 Test Loss: 2.336 Test Acc: 0.354
Validation loss decreased (-0.351964 --> -0.353586).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.4068435
	speed: 0.1188s/iter; left time: 1487.9569s
Epoch: 19 cost time: 4.479896068572998
Epoch: 19, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.497 Vali Acc: 0.352 Test Loss: 2.497 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1622357
	speed: 0.1167s/iter; left time: 1443.8589s
Epoch: 20 cost time: 4.819811582565308
Epoch: 20, Steps: 154 | Train Loss: 1.538 Vali Loss: 2.584 Vali Acc: 0.351 Test Loss: 2.584 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.5354940
	speed: 0.1205s/iter; left time: 1472.3442s
Epoch: 21 cost time: 5.003236293792725
Epoch: 21, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.525 Vali Acc: 0.349 Test Loss: 2.525 Test Acc: 0.349
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.8856884
	speed: 0.1181s/iter; left time: 1424.9836s
Epoch: 22 cost time: 4.540451765060425
Epoch: 22, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.683 Vali Acc: 0.348 Test Loss: 2.683 Test Acc: 0.348
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.5500714
	speed: 0.1198s/iter; left time: 1427.7228s
Epoch: 23 cost time: 4.712307453155518
Epoch: 23, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.631 Vali Acc: 0.357 Test Loss: 2.631 Test Acc: 0.357
Validation loss decreased (-0.353586 --> -0.357232).  Saving model ...
	iters: 100, epoch: 24 | loss: 2.8902175
	speed: 0.1212s/iter; left time: 1424.6204s
Epoch: 24 cost time: 4.612460136413574
Epoch: 24, Steps: 154 | Train Loss: 1.632 Vali Loss: 2.634 Vali Acc: 0.360 Test Loss: 2.634 Test Acc: 0.360
Validation loss decreased (-0.357232 --> -0.359665).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.1997964
	speed: 0.1127s/iter; left time: 1307.7110s
Epoch: 25 cost time: 4.461057901382446
Epoch: 25, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.606 Vali Acc: 0.358 Test Loss: 2.606 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.1799822
	speed: 0.1189s/iter; left time: 1361.5739s
Epoch: 26 cost time: 4.360964059829712
Epoch: 26, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.681 Vali Acc: 0.363 Test Loss: 2.681 Test Acc: 0.363
Validation loss decreased (-0.359665 --> -0.363315).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.7142531
	speed: 0.1148s/iter; left time: 1296.9427s
Epoch: 27 cost time: 4.57103705406189
Epoch: 27, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.845 Vali Acc: 0.368 Test Loss: 2.845 Test Acc: 0.368
Validation loss decreased (-0.363315 --> -0.368179).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.7462019
	speed: 0.1147s/iter; left time: 1278.2308s
Epoch: 28 cost time: 4.299177408218384
Epoch: 28, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.770 Vali Acc: 0.363 Test Loss: 2.770 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.6349353
	speed: 0.1156s/iter; left time: 1269.9918s
Epoch: 29 cost time: 4.15590238571167
Epoch: 29, Steps: 154 | Train Loss: 1.462 Vali Loss: 2.734 Vali Acc: 0.363 Test Loss: 2.734 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 1.2832744
	speed: 0.1153s/iter; left time: 1248.8103s
Epoch: 30 cost time: 4.747342348098755
Epoch: 30, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.865 Vali Acc: 0.367 Test Loss: 2.865 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 1.5541325
	speed: 0.1128s/iter; left time: 1205.0184s
Epoch: 31 cost time: 4.416849613189697
Epoch: 31, Steps: 154 | Train Loss: 1.381 Vali Loss: 2.751 Vali Acc: 0.369 Test Loss: 2.751 Test Acc: 0.369
Validation loss decreased (-0.368179 --> -0.368991).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.2649584
	speed: 0.1186s/iter; left time: 1248.1254s
Epoch: 32 cost time: 4.475362539291382
Epoch: 32, Steps: 154 | Train Loss: 1.557 Vali Loss: 3.203 Vali Acc: 0.368 Test Loss: 3.203 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 1.9522717
	speed: 0.1186s/iter; left time: 1230.2547s
Epoch: 33 cost time: 4.648118734359741
Epoch: 33, Steps: 154 | Train Loss: 1.390 Vali Loss: 2.707 Vali Acc: 0.365 Test Loss: 2.707 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 6.4484625
	speed: 0.1119s/iter; left time: 1143.7170s
Epoch: 34 cost time: 4.576155185699463
Epoch: 34, Steps: 154 | Train Loss: 1.362 Vali Loss: 2.709 Vali Acc: 0.377 Test Loss: 2.709 Test Acc: 0.377
Validation loss decreased (-0.368991 --> -0.377102).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.4502074
	speed: 0.1201s/iter; left time: 1209.2042s
Epoch: 35 cost time: 4.552231550216675
Epoch: 35, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.738 Vali Acc: 0.375 Test Loss: 2.738 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 1.3601776
	speed: 0.1242s/iter; left time: 1230.7039s
Epoch: 36 cost time: 4.507075548171997
Epoch: 36, Steps: 154 | Train Loss: 1.330 Vali Loss: 3.139 Vali Acc: 0.369 Test Loss: 3.139 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.7886490
	speed: 0.1174s/iter; left time: 1145.2679s
Epoch: 37 cost time: 4.582661867141724
Epoch: 37, Steps: 154 | Train Loss: 1.405 Vali Loss: 2.799 Vali Acc: 0.369 Test Loss: 2.799 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 1.1215336
	speed: 0.1227s/iter; left time: 1178.7069s
Epoch: 38 cost time: 4.27594780921936
Epoch: 38, Steps: 154 | Train Loss: 1.370 Vali Loss: 3.162 Vali Acc: 0.370 Test Loss: 3.162 Test Acc: 0.370
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 1.4459374
	speed: 0.1164s/iter; left time: 1099.7493s
Epoch: 39 cost time: 4.834796905517578
Epoch: 39, Steps: 154 | Train Loss: 1.285 Vali Loss: 3.193 Vali Acc: 0.369 Test Loss: 3.193 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.8546534
	speed: 0.1187s/iter; left time: 1103.5066s
Epoch: 40 cost time: 4.728624582290649
Epoch: 40, Steps: 154 | Train Loss: 1.280 Vali Loss: 3.186 Vali Acc: 0.373 Test Loss: 3.186 Test Acc: 0.373
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 1.2311926
	speed: 0.1217s/iter; left time: 1112.6467s
Epoch: 41 cost time: 4.617234945297241
Epoch: 41, Steps: 154 | Train Loss: 1.322 Vali Loss: 3.181 Vali Acc: 0.370 Test Loss: 3.181 Test Acc: 0.370
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 1.1288754
	speed: 0.1167s/iter; left time: 1048.3632s
Epoch: 42 cost time: 4.545181512832642
Epoch: 42, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.473 Vali Acc: 0.371 Test Loss: 3.473 Test Acc: 0.371
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 1.1007525
	speed: 0.1154s/iter; left time: 1018.9447s
Epoch: 43 cost time: 4.748250484466553
Epoch: 43, Steps: 154 | Train Loss: 1.283 Vali Loss: 3.119 Vali Acc: 0.376 Test Loss: 3.119 Test Acc: 0.376
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 1.2206596
	speed: 0.1152s/iter; left time: 999.6992s
Epoch: 44 cost time: 4.389547348022461
Epoch: 44, Steps: 154 | Train Loss: 1.307 Vali Loss: 3.419 Vali Acc: 0.373 Test Loss: 3.419 Test Acc: 0.373
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3771289537712895
model parameter : 174262
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0225568
	speed: 0.0471s/iter; left time: 720.3375s
Epoch: 1 cost time: 6.34235692024231
Epoch: 1, Steps: 154 | Train Loss: 2.244 Vali Loss: 2.141 Vali Acc: 0.318 Test Loss: 2.141 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0670264
	speed: 0.1118s/iter; left time: 1693.9523s
Epoch: 2 cost time: 3.9461510181427
Epoch: 2, Steps: 154 | Train Loss: 2.072 Vali Loss: 2.141 Vali Acc: 0.319 Test Loss: 2.141 Test Acc: 0.319
Validation loss decreased (-0.317497 --> -0.319119).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8885947
	speed: 0.1084s/iter; left time: 1625.4414s
Epoch: 3 cost time: 4.46580696105957
Epoch: 3, Steps: 154 | Train Loss: 1.999 Vali Loss: 2.166 Vali Acc: 0.322 Test Loss: 2.166 Test Acc: 0.322
Validation loss decreased (-0.319119 --> -0.322363).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.0519834
	speed: 0.1106s/iter; left time: 1641.9149s
Epoch: 4 cost time: 4.264402151107788
Epoch: 4, Steps: 154 | Train Loss: 1.984 Vali Loss: 2.124 Vali Acc: 0.322 Test Loss: 2.124 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7579802
	speed: 0.1027s/iter; left time: 1507.7341s
Epoch: 5 cost time: 3.9263107776641846
Epoch: 5, Steps: 154 | Train Loss: 1.929 Vali Loss: 2.139 Vali Acc: 0.328 Test Loss: 2.139 Test Acc: 0.328
Validation loss decreased (-0.322363 --> -0.328040).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0998034
	speed: 0.1056s/iter; left time: 1534.0827s
Epoch: 6 cost time: 4.596008539199829
Epoch: 6, Steps: 154 | Train Loss: 1.900 Vali Loss: 2.120 Vali Acc: 0.332 Test Loss: 2.120 Test Acc: 0.332
Validation loss decreased (-0.328040 --> -0.331690).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9578110
	speed: 0.1137s/iter; left time: 1634.3895s
Epoch: 7 cost time: 4.474567413330078
Epoch: 7, Steps: 154 | Train Loss: 1.882 Vali Loss: 2.139 Vali Acc: 0.330 Test Loss: 2.139 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9557844
	speed: 0.1112s/iter; left time: 1581.7336s
Epoch: 8 cost time: 4.2673070430755615
Epoch: 8, Steps: 154 | Train Loss: 1.824 Vali Loss: 2.108 Vali Acc: 0.332 Test Loss: 2.108 Test Acc: 0.332
Validation loss decreased (-0.331690 --> -0.332096).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7200569
	speed: 0.1139s/iter; left time: 1601.9893s
Epoch: 9 cost time: 4.621039867401123
Epoch: 9, Steps: 154 | Train Loss: 1.788 Vali Loss: 2.135 Vali Acc: 0.336 Test Loss: 2.135 Test Acc: 0.336
Validation loss decreased (-0.332096 --> -0.336151).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5799656
	speed: 0.1183s/iter; left time: 1645.8526s
Epoch: 10 cost time: 4.532187461853027
Epoch: 10, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.152 Vali Acc: 0.338 Test Loss: 2.152 Test Acc: 0.338
Validation loss decreased (-0.336151 --> -0.338178).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9166760
	speed: 0.1201s/iter; left time: 1652.4283s
Epoch: 11 cost time: 4.579022645950317
Epoch: 11, Steps: 154 | Train Loss: 1.738 Vali Loss: 2.175 Vali Acc: 0.337 Test Loss: 2.175 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.3746300
	speed: 0.1089s/iter; left time: 1481.6133s
Epoch: 12 cost time: 4.478037357330322
Epoch: 12, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.234 Vali Acc: 0.338 Test Loss: 2.234 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.0726559
	speed: 0.1144s/iter; left time: 1538.3689s
Epoch: 13 cost time: 4.512260437011719
Epoch: 13, Steps: 154 | Train Loss: 1.721 Vali Loss: 2.227 Vali Acc: 0.341 Test Loss: 2.227 Test Acc: 0.341
Validation loss decreased (-0.338178 --> -0.341421).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6052803
	speed: 0.1136s/iter; left time: 1510.2512s
Epoch: 14 cost time: 4.425311803817749
Epoch: 14, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.245 Vali Acc: 0.343 Test Loss: 2.245 Test Acc: 0.343
Validation loss decreased (-0.341421 --> -0.342638).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.9135870
	speed: 0.1096s/iter; left time: 1441.3049s
Epoch: 15 cost time: 4.449324607849121
Epoch: 15, Steps: 154 | Train Loss: 1.733 Vali Loss: 2.347 Vali Acc: 0.352 Test Loss: 2.347 Test Acc: 0.352
Validation loss decreased (-0.342638 --> -0.351558).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.0140247
	speed: 0.1144s/iter; left time: 1486.5542s
Epoch: 16 cost time: 4.422496795654297
Epoch: 16, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.320 Vali Acc: 0.351 Test Loss: 2.320 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.3323811
	speed: 0.1102s/iter; left time: 1414.7141s
Epoch: 17 cost time: 4.246936798095703
Epoch: 17, Steps: 154 | Train Loss: 1.661 Vali Loss: 2.280 Vali Acc: 0.349 Test Loss: 2.280 Test Acc: 0.349
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.3705264
	speed: 0.1081s/iter; left time: 1371.3119s
Epoch: 18 cost time: 4.315238952636719
Epoch: 18, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.278 Vali Acc: 0.355 Test Loss: 2.278 Test Acc: 0.355
Validation loss decreased (-0.351558 --> -0.354803).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.8232954
	speed: 0.1154s/iter; left time: 1446.4081s
Epoch: 19 cost time: 4.473534822463989
Epoch: 19, Steps: 154 | Train Loss: 1.720 Vali Loss: 2.520 Vali Acc: 0.355 Test Loss: 2.520 Test Acc: 0.355
Validation loss decreased (-0.354803 --> -0.355206).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.3420177
	speed: 0.1091s/iter; left time: 1349.8024s
Epoch: 20 cost time: 4.421257019042969
Epoch: 20, Steps: 154 | Train Loss: 1.571 Vali Loss: 2.477 Vali Acc: 0.353 Test Loss: 2.477 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.6630793
	speed: 0.1150s/iter; left time: 1405.0217s
Epoch: 21 cost time: 4.402529239654541
Epoch: 21, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.344 Vali Acc: 0.355 Test Loss: 2.344 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.0222554
	speed: 0.1113s/iter; left time: 1343.1899s
Epoch: 22 cost time: 4.588643312454224
Epoch: 22, Steps: 154 | Train Loss: 1.632 Vali Loss: 2.470 Vali Acc: 0.356 Test Loss: 2.470 Test Acc: 0.356
Validation loss decreased (-0.355206 --> -0.356423).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.6516256
	speed: 0.1130s/iter; left time: 1346.0930s
Epoch: 23 cost time: 4.211264133453369
Epoch: 23, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.375 Vali Acc: 0.358 Test Loss: 2.375 Test Acc: 0.358
Validation loss decreased (-0.356423 --> -0.357640).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.2439337
	speed: 0.1085s/iter; left time: 1275.8120s
Epoch: 24 cost time: 4.174970865249634
Epoch: 24, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.651 Vali Acc: 0.356 Test Loss: 2.651 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.4073822
	speed: 0.1140s/iter; left time: 1322.6069s
Epoch: 25 cost time: 4.5772552490234375
Epoch: 25, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.618 Vali Acc: 0.354 Test Loss: 2.618 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.2392706
	speed: 0.1122s/iter; left time: 1285.0020s
Epoch: 26 cost time: 4.300696134567261
Epoch: 26, Steps: 154 | Train Loss: 1.568 Vali Loss: 2.538 Vali Acc: 0.363 Test Loss: 2.538 Test Acc: 0.363
Validation loss decreased (-0.357640 --> -0.362505).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.3321235
	speed: 0.1075s/iter; left time: 1213.8711s
Epoch: 27 cost time: 3.802523136138916
Epoch: 27, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.552 Vali Acc: 0.363 Test Loss: 2.552 Test Acc: 0.363
Validation loss decreased (-0.362505 --> -0.363316).  Saving model ...
	iters: 100, epoch: 28 | loss: 2.0395048
	speed: 0.1080s/iter; left time: 1203.2561s
Epoch: 28 cost time: 4.765669345855713
Epoch: 28, Steps: 154 | Train Loss: 1.442 Vali Loss: 2.534 Vali Acc: 0.362 Test Loss: 2.534 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.6481658
	speed: 0.1156s/iter; left time: 1270.2980s
Epoch: 29 cost time: 4.162828207015991
Epoch: 29, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.730 Vali Acc: 0.362 Test Loss: 2.730 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 1.6753099
	speed: 0.1187s/iter; left time: 1286.1889s
Epoch: 30 cost time: 4.371250629425049
Epoch: 30, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.688 Vali Acc: 0.357 Test Loss: 2.688 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 1.4612795
	speed: 0.1082s/iter; left time: 1155.6908s
Epoch: 31 cost time: 4.15865159034729
Epoch: 31, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.625 Vali Acc: 0.364 Test Loss: 2.625 Test Acc: 0.364
Validation loss decreased (-0.363316 --> -0.363721).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.2221062
	speed: 0.1130s/iter; left time: 1189.2225s
Epoch: 32 cost time: 4.321751356124878
Epoch: 32, Steps: 154 | Train Loss: 1.373 Vali Loss: 2.767 Vali Acc: 0.364 Test Loss: 2.767 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 1.8727995
	speed: 0.1141s/iter; left time: 1183.2566s
Epoch: 33 cost time: 4.277044057846069
Epoch: 33, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.778 Vali Acc: 0.365 Test Loss: 2.778 Test Acc: 0.365
Validation loss decreased (-0.363721 --> -0.364936).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.6013118
	speed: 0.1122s/iter; left time: 1146.8974s
Epoch: 34 cost time: 4.53140664100647
Epoch: 34, Steps: 154 | Train Loss: 1.571 Vali Loss: 3.005 Vali Acc: 0.378 Test Loss: 3.005 Test Acc: 0.378
Validation loss decreased (-0.364936 --> -0.377504).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.4840511
	speed: 0.1181s/iter; left time: 1188.9027s
Epoch: 35 cost time: 4.3772711753845215
Epoch: 35, Steps: 154 | Train Loss: 1.325 Vali Loss: 2.959 Vali Acc: 0.365 Test Loss: 2.959 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 2.8848710
	speed: 0.1133s/iter; left time: 1122.5059s
Epoch: 36 cost time: 4.257705211639404
Epoch: 36, Steps: 154 | Train Loss: 1.402 Vali Loss: 3.019 Vali Acc: 0.371 Test Loss: 3.019 Test Acc: 0.371
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.9133289
	speed: 0.1090s/iter; left time: 1063.2457s
Epoch: 37 cost time: 4.415970325469971
Epoch: 37, Steps: 154 | Train Loss: 1.257 Vali Loss: 2.867 Vali Acc: 0.373 Test Loss: 2.867 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 1.0452133
	speed: 0.1180s/iter; left time: 1133.1333s
Epoch: 38 cost time: 4.271095275878906
Epoch: 38, Steps: 154 | Train Loss: 1.238 Vali Loss: 3.135 Vali Acc: 0.377 Test Loss: 3.135 Test Acc: 0.377
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 1.0299958
	speed: 0.1075s/iter; left time: 1016.1246s
Epoch: 39 cost time: 4.322402000427246
Epoch: 39, Steps: 154 | Train Loss: 1.285 Vali Loss: 3.118 Vali Acc: 0.373 Test Loss: 3.118 Test Acc: 0.373
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 1.0487738
	speed: 0.1133s/iter; left time: 1053.4709s
Epoch: 40 cost time: 4.176797866821289
Epoch: 40, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.815 Vali Acc: 0.374 Test Loss: 2.815 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 1.9626828
	speed: 0.1093s/iter; left time: 998.9357s
Epoch: 41 cost time: 4.143805265426636
Epoch: 41, Steps: 154 | Train Loss: 1.344 Vali Loss: 3.009 Vali Acc: 0.390 Test Loss: 3.009 Test Acc: 0.390
Validation loss decreased (-0.377504 --> -0.389670).  Saving model ...
	iters: 100, epoch: 42 | loss: 1.1240796
	speed: 0.1064s/iter; left time: 956.4316s
Epoch: 42 cost time: 4.56336522102356
Epoch: 42, Steps: 154 | Train Loss: 1.363 Vali Loss: 3.293 Vali Acc: 0.382 Test Loss: 3.293 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 1.0110431
	speed: 0.1169s/iter; left time: 1032.2497s
Epoch: 43 cost time: 4.476452589035034
Epoch: 43, Steps: 154 | Train Loss: 1.534 Vali Loss: 3.124 Vali Acc: 0.382 Test Loss: 3.124 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 44 | loss: 1.2513502
	speed: 0.1145s/iter; left time: 994.1730s
Epoch: 44 cost time: 4.490121841430664
Epoch: 44, Steps: 154 | Train Loss: 1.281 Vali Loss: 3.109 Vali Acc: 0.375 Test Loss: 3.109 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 45 | loss: 0.9476931
	speed: 0.1130s/iter; left time: 963.6689s
Epoch: 45 cost time: 4.676510334014893
Epoch: 45, Steps: 154 | Train Loss: 1.382 Vali Loss: 3.337 Vali Acc: 0.369 Test Loss: 3.337 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 46 | loss: 1.2512586
	speed: 0.1166s/iter; left time: 975.9448s
Epoch: 46 cost time: 4.621747255325317
Epoch: 46, Steps: 154 | Train Loss: 1.332 Vali Loss: 2.972 Vali Acc: 0.389 Test Loss: 2.972 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 47 | loss: 0.9557152
	speed: 0.1133s/iter; left time: 930.5978s
Epoch: 47 cost time: 4.254864454269409
Epoch: 47, Steps: 154 | Train Loss: 1.189 Vali Loss: 3.169 Vali Acc: 0.385 Test Loss: 3.169 Test Acc: 0.385
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 48 | loss: 2.4490223
	speed: 0.1129s/iter; left time: 910.6166s
Epoch: 48 cost time: 4.700197458267212
Epoch: 48, Steps: 154 | Train Loss: 1.259 Vali Loss: 3.403 Vali Acc: 0.376 Test Loss: 3.403 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 49 | loss: 1.0817529
	speed: 0.1169s/iter; left time: 924.3910s
Epoch: 49 cost time: 4.179007053375244
Epoch: 49, Steps: 154 | Train Loss: 1.308 Vali Loss: 3.119 Vali Acc: 0.383 Test Loss: 3.119 Test Acc: 0.383
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 50 | loss: 1.8524104
	speed: 0.1128s/iter; left time: 874.3784s
Epoch: 50 cost time: 4.47031044960022
Epoch: 50, Steps: 154 | Train Loss: 1.347 Vali Loss: 2.980 Vali Acc: 0.376 Test Loss: 2.980 Test Acc: 0.376
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 51 | loss: 1.3519818
	speed: 0.1081s/iter; left time: 821.6464s
Epoch: 51 cost time: 4.165519952774048
Epoch: 51, Steps: 154 | Train Loss: 1.369 Vali Loss: 3.060 Vali Acc: 0.382 Test Loss: 3.060 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3896999188969992
model parameter : 174262
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4753556
	speed: 0.0477s/iter; left time: 730.5869s
Epoch: 1 cost time: 6.279929876327515
Epoch: 1, Steps: 154 | Train Loss: 2.273 Vali Loss: 2.130 Vali Acc: 0.317 Test Loss: 2.130 Test Acc: 0.317
Validation loss decreased (inf --> -0.316686).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9381764
	speed: 0.1145s/iter; left time: 1734.4004s
Epoch: 2 cost time: 4.766271114349365
Epoch: 2, Steps: 154 | Train Loss: 2.051 Vali Loss: 2.166 Vali Acc: 0.319 Test Loss: 2.166 Test Acc: 0.319
Validation loss decreased (-0.316686 --> -0.318713).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3791890
	speed: 0.1142s/iter; left time: 1712.8134s
Epoch: 3 cost time: 4.204930067062378
Epoch: 3, Steps: 154 | Train Loss: 2.005 Vali Loss: 2.146 Vali Acc: 0.321 Test Loss: 2.146 Test Acc: 0.321
Validation loss decreased (-0.318713 --> -0.320741).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5123928
	speed: 0.1130s/iter; left time: 1677.0325s
Epoch: 4 cost time: 4.8543336391448975
Epoch: 4, Steps: 154 | Train Loss: 1.965 Vali Loss: 2.146 Vali Acc: 0.324 Test Loss: 2.146 Test Acc: 0.324
Validation loss decreased (-0.320741 --> -0.324391).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0854237
	speed: 0.1119s/iter; left time: 1643.5002s
Epoch: 5 cost time: 4.174585580825806
Epoch: 5, Steps: 154 | Train Loss: 1.909 Vali Loss: 2.170 Vali Acc: 0.325 Test Loss: 2.170 Test Acc: 0.325
Validation loss decreased (-0.324391 --> -0.324796).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2408874
	speed: 0.1109s/iter; left time: 1611.5711s
Epoch: 6 cost time: 4.17647123336792
Epoch: 6, Steps: 154 | Train Loss: 1.884 Vali Loss: 2.134 Vali Acc: 0.327 Test Loss: 2.134 Test Acc: 0.327
Validation loss decreased (-0.324796 --> -0.326824).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8084197
	speed: 0.1115s/iter; left time: 1603.6350s
Epoch: 7 cost time: 4.655410528182983
Epoch: 7, Steps: 154 | Train Loss: 1.868 Vali Loss: 2.141 Vali Acc: 0.329 Test Loss: 2.141 Test Acc: 0.329
Validation loss decreased (-0.326824 --> -0.328851).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7280451
	speed: 0.1187s/iter; left time: 1687.9752s
Epoch: 8 cost time: 4.403110504150391
Epoch: 8, Steps: 154 | Train Loss: 1.811 Vali Loss: 2.119 Vali Acc: 0.331 Test Loss: 2.119 Test Acc: 0.331
Validation loss decreased (-0.328851 --> -0.331285).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6222367
	speed: 0.1073s/iter; left time: 1509.7587s
Epoch: 9 cost time: 4.3204426765441895
Epoch: 9, Steps: 154 | Train Loss: 1.807 Vali Loss: 2.140 Vali Acc: 0.334 Test Loss: 2.140 Test Acc: 0.334
Validation loss decreased (-0.331285 --> -0.334123).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9987987
	speed: 0.1029s/iter; left time: 1431.7713s
Epoch: 10 cost time: 4.5254950523376465
Epoch: 10, Steps: 154 | Train Loss: 1.769 Vali Loss: 2.191 Vali Acc: 0.329 Test Loss: 2.191 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5505427
	speed: 0.1182s/iter; left time: 1626.3637s
Epoch: 11 cost time: 4.677306890487671
Epoch: 11, Steps: 154 | Train Loss: 1.750 Vali Loss: 2.154 Vali Acc: 0.339 Test Loss: 2.154 Test Acc: 0.339
Validation loss decreased (-0.334123 --> -0.338989).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4419541
	speed: 0.1218s/iter; left time: 1657.7802s
Epoch: 12 cost time: 4.91049337387085
Epoch: 12, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.218 Vali Acc: 0.336 Test Loss: 2.218 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.8925691
	speed: 0.1224s/iter; left time: 1647.0061s
Epoch: 13 cost time: 5.122142314910889
Epoch: 13, Steps: 154 | Train Loss: 1.666 Vali Loss: 2.129 Vali Acc: 0.338 Test Loss: 2.129 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.1677752
	speed: 0.1144s/iter; left time: 1521.6363s
Epoch: 14 cost time: 4.308912992477417
Epoch: 14, Steps: 154 | Train Loss: 1.727 Vali Loss: 2.201 Vali Acc: 0.344 Test Loss: 2.201 Test Acc: 0.344
Validation loss decreased (-0.338989 --> -0.343855).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.5784279
	speed: 0.1191s/iter; left time: 1566.0785s
Epoch: 15 cost time: 4.483645677566528
Epoch: 15, Steps: 154 | Train Loss: 1.680 Vali Loss: 2.219 Vali Acc: 0.346 Test Loss: 2.219 Test Acc: 0.346
Validation loss decreased (-0.343855 --> -0.345882).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.1150682
	speed: 0.1153s/iter; left time: 1497.2478s
Epoch: 16 cost time: 4.591862440109253
Epoch: 16, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.276 Vali Acc: 0.354 Test Loss: 2.276 Test Acc: 0.354
Validation loss decreased (-0.345882 --> -0.353586).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.5579864
	speed: 0.1131s/iter; left time: 1452.0686s
Epoch: 17 cost time: 4.205854892730713
Epoch: 17, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.453 Vali Acc: 0.351 Test Loss: 2.453 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.7301309
	speed: 0.1157s/iter; left time: 1467.0396s
Epoch: 18 cost time: 4.702376842498779
Epoch: 18, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.442 Vali Acc: 0.349 Test Loss: 2.442 Test Acc: 0.349
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.5304073
	speed: 0.1134s/iter; left time: 1421.0280s
Epoch: 19 cost time: 4.606215238571167
Epoch: 19, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.495 Vali Acc: 0.347 Test Loss: 2.495 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.3137506
	speed: 0.1128s/iter; left time: 1395.9157s
Epoch: 20 cost time: 4.504018068313599
Epoch: 20, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.480 Vali Acc: 0.353 Test Loss: 2.480 Test Acc: 0.353
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.7245488
	speed: 0.1189s/iter; left time: 1453.3556s
Epoch: 21 cost time: 4.7339277267456055
Epoch: 21, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.412 Vali Acc: 0.356 Test Loss: 2.412 Test Acc: 0.356
Validation loss decreased (-0.353586 --> -0.355613).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.0039051
	speed: 0.1132s/iter; left time: 1366.5412s
Epoch: 22 cost time: 4.679373264312744
Epoch: 22, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.359 Vali Acc: 0.363 Test Loss: 2.359 Test Acc: 0.363
Validation loss decreased (-0.355613 --> -0.362507).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.2109286
	speed: 0.1148s/iter; left time: 1367.4154s
Epoch: 23 cost time: 4.66779899597168
Epoch: 23, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.517 Vali Acc: 0.363 Test Loss: 2.517 Test Acc: 0.363
Validation loss decreased (-0.362507 --> -0.363316).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.7747388
	speed: 0.1188s/iter; left time: 1396.8443s
Epoch: 24 cost time: 4.265183925628662
Epoch: 24, Steps: 154 | Train Loss: 1.511 Vali Loss: 2.505 Vali Acc: 0.255 Test Loss: 2.505 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 2.0671659
	speed: 0.1178s/iter; left time: 1366.4918s
Epoch: 25 cost time: 4.833375453948975
Epoch: 25, Steps: 154 | Train Loss: 1.424 Vali Loss: 2.445 Vali Acc: 0.363 Test Loss: 2.445 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.1135756
	speed: 0.1191s/iter; left time: 1363.5941s
Epoch: 26 cost time: 4.578878402709961
Epoch: 26, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.535 Vali Acc: 0.361 Test Loss: 2.535 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.1049963
	speed: 0.1223s/iter; left time: 1381.1627s
Epoch: 27 cost time: 4.554904222488403
Epoch: 27, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.842 Vali Acc: 0.360 Test Loss: 2.842 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.3759257
	speed: 0.1188s/iter; left time: 1324.0103s
Epoch: 28 cost time: 4.986649751663208
Epoch: 28, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.682 Vali Acc: 0.367 Test Loss: 2.682 Test Acc: 0.367
Validation loss decreased (-0.363316 --> -0.366964).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.5845208
	speed: 0.1204s/iter; left time: 1323.2683s
Epoch: 29 cost time: 5.078243017196655
Epoch: 29, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.617 Vali Acc: 0.305 Test Loss: 2.617 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.7071722
	speed: 0.1189s/iter; left time: 1288.0453s
Epoch: 30 cost time: 4.592087507247925
Epoch: 30, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.730 Vali Acc: 0.365 Test Loss: 2.730 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.2493469
	speed: 0.1199s/iter; left time: 1280.8739s
Epoch: 31 cost time: 4.67704701423645
Epoch: 31, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.863 Vali Acc: 0.369 Test Loss: 2.863 Test Acc: 0.369
Validation loss decreased (-0.366964 --> -0.369396).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.4031245
	speed: 0.1163s/iter; left time: 1224.1736s
Epoch: 32 cost time: 4.47178316116333
Epoch: 32, Steps: 154 | Train Loss: 1.381 Vali Loss: 2.902 Vali Acc: 0.362 Test Loss: 2.902 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 1.3816417
	speed: 0.1079s/iter; left time: 1119.5278s
Epoch: 33 cost time: 4.394413948059082
Epoch: 33, Steps: 154 | Train Loss: 1.344 Vali Loss: 3.092 Vali Acc: 0.272 Test Loss: 3.092 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 1.2144213
	speed: 0.1174s/iter; left time: 1199.5312s
Epoch: 34 cost time: 4.385502576828003
Epoch: 34, Steps: 154 | Train Loss: 1.437 Vali Loss: 3.039 Vali Acc: 0.375 Test Loss: 3.039 Test Acc: 0.375
Validation loss decreased (-0.369396 --> -0.375071).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.2876686
	speed: 0.1133s/iter; left time: 1140.5034s
Epoch: 35 cost time: 4.237579822540283
Epoch: 35, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.771 Vali Acc: 0.375 Test Loss: 2.771 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 1.2439847
	speed: 0.1074s/iter; left time: 1064.4175s
Epoch: 36 cost time: 4.380873441696167
Epoch: 36, Steps: 154 | Train Loss: 1.330 Vali Loss: 2.899 Vali Acc: 0.378 Test Loss: 2.899 Test Acc: 0.378
Validation loss decreased (-0.375071 --> -0.377911).  Saving model ...
	iters: 100, epoch: 37 | loss: 1.0336646
	speed: 0.1128s/iter; left time: 1100.6131s
Epoch: 37 cost time: 4.649377107620239
Epoch: 37, Steps: 154 | Train Loss: 1.331 Vali Loss: 3.218 Vali Acc: 0.364 Test Loss: 3.218 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 1.0017030
	speed: 0.1160s/iter; left time: 1113.7987s
Epoch: 38 cost time: 4.752527952194214
Epoch: 38, Steps: 154 | Train Loss: 1.326 Vali Loss: 3.035 Vali Acc: 0.378 Test Loss: 3.035 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 1.0214975
	speed: 0.1175s/iter; left time: 1110.4412s
Epoch: 39 cost time: 4.570860147476196
Epoch: 39, Steps: 154 | Train Loss: 1.278 Vali Loss: 3.150 Vali Acc: 0.216 Test Loss: 3.150 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 1.2481922
	speed: 0.1190s/iter; left time: 1106.5662s
Epoch: 40 cost time: 4.594108581542969
Epoch: 40, Steps: 154 | Train Loss: 1.301 Vali Loss: 3.204 Vali Acc: 0.377 Test Loss: 3.204 Test Acc: 0.377
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 1.2240282
	speed: 0.1157s/iter; left time: 1057.9785s
Epoch: 41 cost time: 4.877015113830566
Epoch: 41, Steps: 154 | Train Loss: 1.327 Vali Loss: 2.944 Vali Acc: 0.220 Test Loss: 2.944 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 1.2997050
	speed: 0.1212s/iter; left time: 1089.4947s
Epoch: 42 cost time: 4.83684778213501
Epoch: 42, Steps: 154 | Train Loss: 1.413 Vali Loss: 3.016 Vali Acc: 0.379 Test Loss: 3.016 Test Acc: 0.379
Validation loss decreased (-0.377911 --> -0.378721).  Saving model ...
	iters: 100, epoch: 43 | loss: 1.3077683
	speed: 0.1237s/iter; left time: 1092.7132s
Epoch: 43 cost time: 4.424001216888428
Epoch: 43, Steps: 154 | Train Loss: 1.287 Vali Loss: 2.776 Vali Acc: 0.383 Test Loss: 2.776 Test Acc: 0.383
Validation loss decreased (-0.378721 --> -0.383184).  Saving model ...
	iters: 100, epoch: 44 | loss: 1.0892023
	speed: 0.1190s/iter; left time: 1032.4775s
Epoch: 44 cost time: 5.179581642150879
Epoch: 44, Steps: 154 | Train Loss: 1.269 Vali Loss: 2.963 Vali Acc: 0.376 Test Loss: 2.963 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 0.9023064
	speed: 0.1252s/iter; left time: 1067.2281s
Epoch: 45 cost time: 4.651980876922607
Epoch: 45, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.962 Vali Acc: 0.230 Test Loss: 2.962 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 1.1166240
	speed: 0.1195s/iter; left time: 1000.5334s
Epoch: 46 cost time: 4.979555606842041
Epoch: 46, Steps: 154 | Train Loss: 1.309 Vali Loss: 2.927 Vali Acc: 0.379 Test Loss: 2.927 Test Acc: 0.379
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 47 | loss: 0.7393644
	speed: 0.1214s/iter; left time: 997.6475s
Epoch: 47 cost time: 5.246037483215332
Epoch: 47, Steps: 154 | Train Loss: 1.230 Vali Loss: 3.090 Vali Acc: 0.236 Test Loss: 3.090 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 48 | loss: 1.4496226
	speed: 0.1225s/iter; left time: 987.8897s
Epoch: 48 cost time: 4.726546287536621
Epoch: 48, Steps: 154 | Train Loss: 1.231 Vali Loss: 3.313 Vali Acc: 0.378 Test Loss: 3.313 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 49 | loss: 1.0581310
	speed: 0.1148s/iter; left time: 908.0895s
Epoch: 49 cost time: 4.4703638553619385
Epoch: 49, Steps: 154 | Train Loss: 1.197 Vali Loss: 3.006 Vali Acc: 0.224 Test Loss: 3.006 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 50 | loss: 0.8796502
	speed: 0.1169s/iter; left time: 906.3031s
Epoch: 50 cost time: 4.84467625617981
Epoch: 50, Steps: 154 | Train Loss: 1.216 Vali Loss: 3.225 Vali Acc: 0.376 Test Loss: 3.225 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 51 | loss: 1.0175844
	speed: 0.1107s/iter; left time: 841.7400s
Epoch: 51 cost time: 4.463702201843262
Epoch: 51, Steps: 154 | Train Loss: 1.227 Vali Loss: 3.534 Vali Acc: 0.380 Test Loss: 3.534 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 52 | loss: 1.3633543
	speed: 0.1181s/iter; left time: 879.8071s
Epoch: 52 cost time: 4.54197096824646
Epoch: 52, Steps: 154 | Train Loss: 1.203 Vali Loss: 3.206 Vali Acc: 0.158 Test Loss: 3.206 Test Acc: 0.158
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 53 | loss: 1.0803775
	speed: 0.1169s/iter; left time: 852.3720s
Epoch: 53 cost time: 4.727302551269531
Epoch: 53, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.499 Vali Acc: 0.218 Test Loss: 3.499 Test Acc: 0.218
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38321167883211676
model parameter : 108726
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4905502
	speed: 0.0483s/iter; left time: 739.3641s
Epoch: 1 cost time: 6.356513500213623
Epoch: 1, Steps: 154 | Train Loss: 2.267 Vali Loss: 2.131 Vali Acc: 0.315 Test Loss: 2.131 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9358975
	speed: 0.1197s/iter; left time: 1812.3798s
Epoch: 2 cost time: 4.659176826477051
Epoch: 2, Steps: 154 | Train Loss: 2.048 Vali Loss: 2.166 Vali Acc: 0.320 Test Loss: 2.166 Test Acc: 0.320
Validation loss decreased (-0.315469 --> -0.319524).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9327283
	speed: 0.1131s/iter; left time: 1695.0936s
Epoch: 3 cost time: 4.630836486816406
Epoch: 3, Steps: 154 | Train Loss: 2.000 Vali Loss: 2.149 Vali Acc: 0.320 Test Loss: 2.149 Test Acc: 0.320
Validation loss decreased (-0.319524 --> -0.320335).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5014679
	speed: 0.1159s/iter; left time: 1719.5912s
Epoch: 4 cost time: 4.40544319152832
Epoch: 4, Steps: 154 | Train Loss: 1.966 Vali Loss: 2.147 Vali Acc: 0.324 Test Loss: 2.147 Test Acc: 0.324
Validation loss decreased (-0.320335 --> -0.323985).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1366498
	speed: 0.1203s/iter; left time: 1766.5402s
Epoch: 5 cost time: 4.842043876647949
Epoch: 5, Steps: 154 | Train Loss: 1.914 Vali Loss: 2.168 Vali Acc: 0.326 Test Loss: 2.168 Test Acc: 0.326
Validation loss decreased (-0.323985 --> -0.325607).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2321041
	speed: 0.1129s/iter; left time: 1640.1616s
Epoch: 6 cost time: 4.464187145233154
Epoch: 6, Steps: 154 | Train Loss: 1.881 Vali Loss: 2.127 Vali Acc: 0.326 Test Loss: 2.127 Test Acc: 0.326
Validation loss decreased (-0.325607 --> -0.326418).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8314207
	speed: 0.1160s/iter; left time: 1667.7463s
Epoch: 7 cost time: 4.586596488952637
Epoch: 7, Steps: 154 | Train Loss: 1.877 Vali Loss: 2.130 Vali Acc: 0.326 Test Loss: 2.130 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7249341
	speed: 0.1205s/iter; left time: 1713.6047s
Epoch: 8 cost time: 4.616310119628906
Epoch: 8, Steps: 154 | Train Loss: 1.816 Vali Loss: 2.113 Vali Acc: 0.331 Test Loss: 2.113 Test Acc: 0.331
Validation loss decreased (-0.326418 --> -0.331285).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6318434
	speed: 0.1242s/iter; left time: 1747.9601s
Epoch: 9 cost time: 5.001113176345825
Epoch: 9, Steps: 154 | Train Loss: 1.824 Vali Loss: 2.137 Vali Acc: 0.334 Test Loss: 2.137 Test Acc: 0.334
Validation loss decreased (-0.331285 --> -0.334123).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9522846
	speed: 0.1193s/iter; left time: 1659.6605s
Epoch: 10 cost time: 4.799645662307739
Epoch: 10, Steps: 154 | Train Loss: 1.789 Vali Loss: 2.187 Vali Acc: 0.331 Test Loss: 2.187 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5677321
	speed: 0.1205s/iter; left time: 1658.0586s
Epoch: 11 cost time: 4.667894124984741
Epoch: 11, Steps: 154 | Train Loss: 1.731 Vali Loss: 2.142 Vali Acc: 0.342 Test Loss: 2.142 Test Acc: 0.342
Validation loss decreased (-0.334123 --> -0.342233).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3720268
	speed: 0.1155s/iter; left time: 1571.7763s
Epoch: 12 cost time: 4.7994065284729
Epoch: 12, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.220 Vali Acc: 0.337 Test Loss: 2.220 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.8708148
	speed: 0.1178s/iter; left time: 1585.1992s
Epoch: 13 cost time: 4.622954368591309
Epoch: 13, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.181 Vali Acc: 0.337 Test Loss: 2.181 Test Acc: 0.337
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2727556
	speed: 0.1188s/iter; left time: 1580.2384s
Epoch: 14 cost time: 4.611152410507202
Epoch: 14, Steps: 154 | Train Loss: 1.720 Vali Loss: 2.258 Vali Acc: 0.341 Test Loss: 2.258 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.5653350
	speed: 0.1153s/iter; left time: 1515.8649s
Epoch: 15 cost time: 4.4676337242126465
Epoch: 15, Steps: 154 | Train Loss: 1.638 Vali Loss: 2.276 Vali Acc: 0.348 Test Loss: 2.276 Test Acc: 0.348
Validation loss decreased (-0.342233 --> -0.347909).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.0497220
	speed: 0.1165s/iter; left time: 1513.6952s
Epoch: 16 cost time: 4.451256036758423
Epoch: 16, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.331 Vali Acc: 0.358 Test Loss: 2.331 Test Acc: 0.358
Validation loss decreased (-0.347909 --> -0.357641).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.6013389
	speed: 0.1193s/iter; left time: 1531.0735s
Epoch: 17 cost time: 4.295801639556885
Epoch: 17, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.429 Vali Acc: 0.350 Test Loss: 2.429 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.3848339
	speed: 0.1121s/iter; left time: 1421.9277s
Epoch: 18 cost time: 4.694761037826538
Epoch: 18, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.345 Vali Acc: 0.349 Test Loss: 2.345 Test Acc: 0.349
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.4838654
	speed: 0.1179s/iter; left time: 1477.7801s
Epoch: 19 cost time: 4.063440322875977
Epoch: 19, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.458 Vali Acc: 0.348 Test Loss: 2.458 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.3883870
	speed: 0.1299s/iter; left time: 1607.9626s
Epoch: 20 cost time: 5.693247079849243
Epoch: 20, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.550 Vali Acc: 0.351 Test Loss: 2.550 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.9069791
	speed: 0.1015s/iter; left time: 1240.8330s
Epoch: 21 cost time: 3.746605157852173
Epoch: 21, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.329 Vali Acc: 0.355 Test Loss: 2.329 Test Acc: 0.355
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.0095978
	speed: 0.0871s/iter; left time: 1050.6533s
Epoch: 22 cost time: 3.5650954246520996
Epoch: 22, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.429 Vali Acc: 0.360 Test Loss: 2.429 Test Acc: 0.360
Validation loss decreased (-0.357641 --> -0.360073).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.3162432
	speed: 0.1135s/iter; left time: 1352.3485s
Epoch: 23 cost time: 4.908133268356323
Epoch: 23, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.617 Vali Acc: 0.358 Test Loss: 2.617 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.7949413
	speed: 0.1173s/iter; left time: 1379.3021s
Epoch: 24 cost time: 5.068424940109253
Epoch: 24, Steps: 154 | Train Loss: 1.605 Vali Loss: 2.599 Vali Acc: 0.368 Test Loss: 2.599 Test Acc: 0.368
Validation loss decreased (-0.360073 --> -0.367776).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.9372818
	speed: 0.1222s/iter; left time: 1417.6322s
Epoch: 25 cost time: 4.731322288513184
Epoch: 25, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.592 Vali Acc: 0.354 Test Loss: 2.592 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.1968490
	speed: 0.1114s/iter; left time: 1275.9813s
Epoch: 26 cost time: 4.275429010391235
Epoch: 26, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.505 Vali Acc: 0.361 Test Loss: 2.505 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.1097295
	speed: 0.1102s/iter; left time: 1245.1881s
Epoch: 27 cost time: 5.095005035400391
Epoch: 27, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.852 Vali Acc: 0.365 Test Loss: 2.852 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.4114192
	speed: 0.1224s/iter; left time: 1363.8631s
Epoch: 28 cost time: 4.862786293029785
Epoch: 28, Steps: 154 | Train Loss: 1.410 Vali Loss: 2.495 Vali Acc: 0.370 Test Loss: 2.495 Test Acc: 0.370
Validation loss decreased (-0.367776 --> -0.370210).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.5757257
	speed: 0.1169s/iter; left time: 1284.5959s
Epoch: 29 cost time: 4.303333044052124
Epoch: 29, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.642 Vali Acc: 0.373 Test Loss: 2.642 Test Acc: 0.373
Validation loss decreased (-0.370210 --> -0.373453).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.7258747
	speed: 0.1131s/iter; left time: 1225.4196s
Epoch: 30 cost time: 4.674059152603149
Epoch: 30, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.610 Vali Acc: 0.362 Test Loss: 2.610 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.2654288
	speed: 0.1215s/iter; left time: 1298.1191s
Epoch: 31 cost time: 4.329087734222412
Epoch: 31, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.815 Vali Acc: 0.373 Test Loss: 2.815 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.3596740
	speed: 0.1127s/iter; left time: 1186.5185s
Epoch: 32 cost time: 4.905545949935913
Epoch: 32, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.905 Vali Acc: 0.364 Test Loss: 2.905 Test Acc: 0.364
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 1.3980439
	speed: 0.1133s/iter; left time: 1175.2587s
Epoch: 33 cost time: 4.518201589584351
Epoch: 33, Steps: 154 | Train Loss: 1.364 Vali Loss: 3.197 Vali Acc: 0.240 Test Loss: 3.197 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 1.1903719
	speed: 0.1163s/iter; left time: 1188.5884s
Epoch: 34 cost time: 4.721540212631226
Epoch: 34, Steps: 154 | Train Loss: 1.443 Vali Loss: 2.808 Vali Acc: 0.375 Test Loss: 2.808 Test Acc: 0.375
Validation loss decreased (-0.373453 --> -0.375073).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.1017342
	speed: 0.1145s/iter; left time: 1152.1550s
Epoch: 35 cost time: 4.585209608078003
Epoch: 35, Steps: 154 | Train Loss: 1.408 Vali Loss: 3.065 Vali Acc: 0.374 Test Loss: 3.065 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.9523630
	speed: 0.1160s/iter; left time: 1150.1213s
Epoch: 36 cost time: 4.998534440994263
Epoch: 36, Steps: 154 | Train Loss: 1.325 Vali Loss: 2.980 Vali Acc: 0.377 Test Loss: 2.980 Test Acc: 0.377
Validation loss decreased (-0.375073 --> -0.377099).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.9605938
	speed: 0.1161s/iter; left time: 1132.3591s
Epoch: 37 cost time: 4.21550178527832
Epoch: 37, Steps: 154 | Train Loss: 1.298 Vali Loss: 3.344 Vali Acc: 0.377 Test Loss: 3.344 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 1.0022197
	speed: 0.1163s/iter; left time: 1116.5225s
Epoch: 38 cost time: 4.633401155471802
Epoch: 38, Steps: 154 | Train Loss: 1.291 Vali Loss: 3.232 Vali Acc: 0.373 Test Loss: 3.232 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 1.0789255
	speed: 0.1128s/iter; left time: 1065.5719s
Epoch: 39 cost time: 4.418627977371216
Epoch: 39, Steps: 154 | Train Loss: 1.436 Vali Loss: 3.287 Vali Acc: 0.220 Test Loss: 3.287 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 1.1990056
	speed: 0.1197s/iter; left time: 1112.2727s
Epoch: 40 cost time: 4.4267895221710205
Epoch: 40, Steps: 154 | Train Loss: 1.307 Vali Loss: 3.567 Vali Acc: 0.368 Test Loss: 3.567 Test Acc: 0.368
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 1.6471657
	speed: 0.1132s/iter; left time: 1034.5338s
Epoch: 41 cost time: 4.396296501159668
Epoch: 41, Steps: 154 | Train Loss: 1.299 Vali Loss: 3.491 Vali Acc: 0.383 Test Loss: 3.491 Test Acc: 0.383
Validation loss decreased (-0.377099 --> -0.382771).  Saving model ...
	iters: 100, epoch: 42 | loss: 1.4709231
	speed: 0.1106s/iter; left time: 994.3799s
Epoch: 42 cost time: 4.780141353607178
Epoch: 42, Steps: 154 | Train Loss: 1.401 Vali Loss: 3.429 Vali Acc: 0.371 Test Loss: 3.429 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 1.4316875
	speed: 0.1198s/iter; left time: 1057.9432s
Epoch: 43 cost time: 4.6244940757751465
Epoch: 43, Steps: 154 | Train Loss: 1.204 Vali Loss: 3.269 Vali Acc: 0.376 Test Loss: 3.269 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 44 | loss: 2.7205038
	speed: 0.1193s/iter; left time: 1035.3393s
Epoch: 44 cost time: 5.088532209396362
Epoch: 44, Steps: 154 | Train Loss: 1.362 Vali Loss: 3.361 Vali Acc: 0.368 Test Loss: 3.361 Test Acc: 0.368
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 45 | loss: 0.9139255
	speed: 0.1206s/iter; left time: 1027.8091s
Epoch: 45 cost time: 4.8549463748931885
Epoch: 45, Steps: 154 | Train Loss: 1.313 Vali Loss: 3.471 Vali Acc: 0.377 Test Loss: 3.471 Test Acc: 0.377
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 46 | loss: 1.1110591
	speed: 0.1182s/iter; left time: 989.0465s
Epoch: 46 cost time: 4.589916467666626
Epoch: 46, Steps: 154 | Train Loss: 1.269 Vali Loss: 3.511 Vali Acc: 0.370 Test Loss: 3.511 Test Acc: 0.370
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 47 | loss: 0.7091836
	speed: 0.1163s/iter; left time: 955.7014s
Epoch: 47 cost time: 4.698861837387085
Epoch: 47, Steps: 154 | Train Loss: 1.317 Vali Loss: 3.359 Vali Acc: 0.230 Test Loss: 3.359 Test Acc: 0.230
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 48 | loss: 1.1630800
	speed: 0.1123s/iter; left time: 905.7769s
Epoch: 48 cost time: 4.637902736663818
Epoch: 48, Steps: 154 | Train Loss: 1.222 Vali Loss: 3.460 Vali Acc: 0.372 Test Loss: 3.460 Test Acc: 0.372
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 49 | loss: 1.1126792
	speed: 0.1131s/iter; left time: 894.1337s
Epoch: 49 cost time: 4.276808977127075
Epoch: 49, Steps: 154 | Train Loss: 1.228 Vali Loss: 3.314 Vali Acc: 0.386 Test Loss: 3.314 Test Acc: 0.386
Validation loss decreased (-0.382771 --> -0.386017).  Saving model ...
	iters: 100, epoch: 50 | loss: 0.9155545
	speed: 0.1149s/iter; left time: 891.4002s
Epoch: 50 cost time: 5.0177857875823975
Epoch: 50, Steps: 154 | Train Loss: 1.209 Vali Loss: 4.221 Vali Acc: 0.380 Test Loss: 4.221 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 51 | loss: 1.2789644
	speed: 0.1164s/iter; left time: 885.0750s
Epoch: 51 cost time: 4.50436544418335
Epoch: 51, Steps: 154 | Train Loss: 1.365 Vali Loss: 3.085 Vali Acc: 0.384 Test Loss: 3.085 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 52 | loss: 0.9055168
	speed: 0.1154s/iter; left time: 859.5159s
Epoch: 52 cost time: 4.468506813049316
Epoch: 52, Steps: 154 | Train Loss: 1.407 Vali Loss: 3.984 Vali Acc: 0.253 Test Loss: 3.984 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 53 | loss: 2.9518228
	speed: 0.1137s/iter; left time: 828.9457s
Epoch: 53 cost time: 4.521822690963745
Epoch: 53, Steps: 154 | Train Loss: 1.442 Vali Loss: 3.595 Vali Acc: 0.380 Test Loss: 3.595 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 54 | loss: 1.1803969
	speed: 0.1067s/iter; left time: 761.7231s
Epoch: 54 cost time: 4.527592182159424
Epoch: 54, Steps: 154 | Train Loss: 1.130 Vali Loss: 3.641 Vali Acc: 0.382 Test Loss: 3.641 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 55 | loss: 1.5436348
	speed: 0.1165s/iter; left time: 813.7432s
Epoch: 55 cost time: 4.511806488037109
Epoch: 55, Steps: 154 | Train Loss: 1.280 Vali Loss: 3.909 Vali Acc: 0.379 Test Loss: 3.909 Test Acc: 0.379
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 56 | loss: 6.0115223
	speed: 0.1167s/iter; left time: 797.0595s
Epoch: 56 cost time: 4.972443342208862
Epoch: 56, Steps: 154 | Train Loss: 1.222 Vali Loss: 3.891 Vali Acc: 0.227 Test Loss: 3.891 Test Acc: 0.227
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 57 | loss: 0.9490906
	speed: 0.1163s/iter; left time: 776.6701s
Epoch: 57 cost time: 4.6459033489227295
Epoch: 57, Steps: 154 | Train Loss: 1.304 Vali Loss: 3.948 Vali Acc: 0.379 Test Loss: 3.948 Test Acc: 0.379
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 58 | loss: 1.7233003
	speed: 0.1227s/iter; left time: 800.4785s
Epoch: 58 cost time: 4.727468013763428
Epoch: 58, Steps: 154 | Train Loss: 1.222 Vali Loss: 4.030 Vali Acc: 0.373 Test Loss: 4.030 Test Acc: 0.373
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 59 | loss: 0.8790148
	speed: 0.1214s/iter; left time: 773.1109s
Epoch: 59 cost time: 4.882308721542358
Epoch: 59, Steps: 154 | Train Loss: 1.177 Vali Loss: 3.891 Vali Acc: 0.385 Test Loss: 3.891 Test Acc: 0.385
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38605028386050283
model parameter : 108726
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4884354
	speed: 0.0445s/iter; left time: 681.2946s
Epoch: 1 cost time: 6.012216329574585
Epoch: 1, Steps: 154 | Train Loss: 2.262 Vali Loss: 2.133 Vali Acc: 0.316 Test Loss: 2.133 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9190849
	speed: 0.1139s/iter; left time: 1725.7167s
Epoch: 2 cost time: 4.190945148468018
Epoch: 2, Steps: 154 | Train Loss: 2.045 Vali Loss: 2.156 Vali Acc: 0.320 Test Loss: 2.156 Test Acc: 0.320
Validation loss decreased (-0.316280 --> -0.319930).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9798255
	speed: 0.1127s/iter; left time: 1689.2148s
Epoch: 3 cost time: 4.6515138149261475
Epoch: 3, Steps: 154 | Train Loss: 2.003 Vali Loss: 2.144 Vali Acc: 0.319 Test Loss: 2.144 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5132928
	speed: 0.1130s/iter; left time: 1677.2395s
Epoch: 4 cost time: 4.29482889175415
Epoch: 4, Steps: 154 | Train Loss: 1.974 Vali Loss: 2.137 Vali Acc: 0.325 Test Loss: 2.137 Test Acc: 0.325
Validation loss decreased (-0.319930 --> -0.324796).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1532114
	speed: 0.1122s/iter; left time: 1648.0822s
Epoch: 5 cost time: 4.462237596511841
Epoch: 5, Steps: 154 | Train Loss: 1.918 Vali Loss: 2.153 Vali Acc: 0.324 Test Loss: 2.153 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.2335219
	speed: 0.1167s/iter; left time: 1695.5960s
Epoch: 6 cost time: 4.538388013839722
Epoch: 6, Steps: 154 | Train Loss: 1.895 Vali Loss: 2.119 Vali Acc: 0.326 Test Loss: 2.119 Test Acc: 0.326
Validation loss decreased (-0.324796 --> -0.326013).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8580379
	speed: 0.1122s/iter; left time: 1613.6966s
Epoch: 7 cost time: 4.222840785980225
Epoch: 7, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.115 Vali Acc: 0.327 Test Loss: 2.115 Test Acc: 0.327
Validation loss decreased (-0.326013 --> -0.327229).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7212453
	speed: 0.1172s/iter; left time: 1667.1934s
Epoch: 8 cost time: 4.53058385848999
Epoch: 8, Steps: 154 | Train Loss: 1.818 Vali Loss: 2.105 Vali Acc: 0.331 Test Loss: 2.105 Test Acc: 0.331
Validation loss decreased (-0.327229 --> -0.330879).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5674759
	speed: 0.1132s/iter; left time: 1593.1438s
Epoch: 9 cost time: 4.4869585037231445
Epoch: 9, Steps: 154 | Train Loss: 1.835 Vali Loss: 2.124 Vali Acc: 0.337 Test Loss: 2.124 Test Acc: 0.337
Validation loss decreased (-0.330879 --> -0.336962).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9818621
	speed: 0.1164s/iter; left time: 1619.7463s
Epoch: 10 cost time: 4.374382972717285
Epoch: 10, Steps: 154 | Train Loss: 1.751 Vali Loss: 2.171 Vali Acc: 0.335 Test Loss: 2.171 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5440179
	speed: 0.1149s/iter; left time: 1581.6083s
Epoch: 11 cost time: 4.807832717895508
Epoch: 11, Steps: 154 | Train Loss: 1.748 Vali Loss: 2.154 Vali Acc: 0.343 Test Loss: 2.154 Test Acc: 0.343
Validation loss decreased (-0.336962 --> -0.342639).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5123545
	speed: 0.1170s/iter; left time: 1592.3026s
Epoch: 12 cost time: 4.532570838928223
Epoch: 12, Steps: 154 | Train Loss: 1.702 Vali Loss: 2.218 Vali Acc: 0.339 Test Loss: 2.218 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6997218
	speed: 0.1179s/iter; left time: 1585.7246s
Epoch: 13 cost time: 4.458420038223267
Epoch: 13, Steps: 154 | Train Loss: 1.731 Vali Loss: 2.199 Vali Acc: 0.340 Test Loss: 2.199 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2158309
	speed: 0.1154s/iter; left time: 1534.3279s
Epoch: 14 cost time: 4.55765962600708
Epoch: 14, Steps: 154 | Train Loss: 1.697 Vali Loss: 2.217 Vali Acc: 0.344 Test Loss: 2.217 Test Acc: 0.344
Validation loss decreased (-0.342639 --> -0.344260).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.5440918
	speed: 0.1185s/iter; left time: 1557.6160s
Epoch: 15 cost time: 4.563736438751221
Epoch: 15, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.338 Vali Acc: 0.348 Test Loss: 2.338 Test Acc: 0.348
Validation loss decreased (-0.344260 --> -0.347908).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.7865734
	speed: 0.1194s/iter; left time: 1550.9173s
Epoch: 16 cost time: 4.497788190841675
Epoch: 16, Steps: 154 | Train Loss: 1.619 Vali Loss: 2.329 Vali Acc: 0.358 Test Loss: 2.329 Test Acc: 0.358
Validation loss decreased (-0.347908 --> -0.358046).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.5951010
	speed: 0.1212s/iter; left time: 1555.8941s
Epoch: 17 cost time: 5.1165056228637695
Epoch: 17, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.315 Vali Acc: 0.350 Test Loss: 2.315 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.4689801
	speed: 0.1186s/iter; left time: 1503.9896s
Epoch: 18 cost time: 4.5764570236206055
Epoch: 18, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.442 Vali Acc: 0.346 Test Loss: 2.442 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.4272430
	speed: 0.1153s/iter; left time: 1444.1781s
Epoch: 19 cost time: 4.292921543121338
Epoch: 19, Steps: 154 | Train Loss: 1.542 Vali Loss: 2.358 Vali Acc: 0.357 Test Loss: 2.358 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.3924125
	speed: 0.1153s/iter; left time: 1426.4120s
Epoch: 20 cost time: 4.893094539642334
Epoch: 20, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.674 Vali Acc: 0.349 Test Loss: 2.674 Test Acc: 0.349
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.7370671
	speed: 0.1170s/iter; left time: 1430.0339s
Epoch: 21 cost time: 4.5937888622283936
Epoch: 21, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.489 Vali Acc: 0.354 Test Loss: 2.489 Test Acc: 0.354
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.0607580
	speed: 0.1154s/iter; left time: 1393.1247s
Epoch: 22 cost time: 4.351294040679932
Epoch: 22, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.551 Vali Acc: 0.356 Test Loss: 2.551 Test Acc: 0.356
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.2690766
	speed: 0.1160s/iter; left time: 1381.9088s
Epoch: 23 cost time: 4.781360864639282
Epoch: 23, Steps: 154 | Train Loss: 1.441 Vali Loss: 2.568 Vali Acc: 0.357 Test Loss: 2.568 Test Acc: 0.357
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.7531017
	speed: 0.1172s/iter; left time: 1377.7370s
Epoch: 24 cost time: 4.344857692718506
Epoch: 24, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.684 Vali Acc: 0.366 Test Loss: 2.684 Test Acc: 0.366
Validation loss decreased (-0.358046 --> -0.365748).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.6071806
	speed: 0.1154s/iter; left time: 1339.5455s
Epoch: 25 cost time: 4.3885698318481445
Epoch: 25, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.711 Vali Acc: 0.356 Test Loss: 2.711 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.1449138
	speed: 0.1201s/iter; left time: 1375.3891s
Epoch: 26 cost time: 4.832195997238159
Epoch: 26, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.617 Vali Acc: 0.355 Test Loss: 2.617 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.1319525
	speed: 0.1193s/iter; left time: 1347.7437s
Epoch: 27 cost time: 4.4251837730407715
Epoch: 27, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.651 Vali Acc: 0.358 Test Loss: 2.651 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.4576248
	speed: 0.1100s/iter; left time: 1226.1963s
Epoch: 28 cost time: 4.220592975616455
Epoch: 28, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.984 Vali Acc: 0.361 Test Loss: 2.984 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 1.4758669
	speed: 0.1029s/iter; left time: 1130.5802s
Epoch: 29 cost time: 4.568512678146362
Epoch: 29, Steps: 154 | Train Loss: 1.423 Vali Loss: 3.045 Vali Acc: 0.363 Test Loss: 3.045 Test Acc: 0.363
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.8634840
	speed: 0.1181s/iter; left time: 1279.5068s
Epoch: 30 cost time: 4.494275331497192
Epoch: 30, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.956 Vali Acc: 0.361 Test Loss: 2.956 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 1.2321857
	speed: 0.1170s/iter; left time: 1249.3105s
Epoch: 31 cost time: 4.763028621673584
Epoch: 31, Steps: 154 | Train Loss: 1.370 Vali Loss: 3.014 Vali Acc: 0.369 Test Loss: 3.014 Test Acc: 0.369
Validation loss decreased (-0.365748 --> -0.368583).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.3175582
	speed: 0.1177s/iter; left time: 1238.6904s
Epoch: 32 cost time: 4.775814771652222
Epoch: 32, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.591 Vali Acc: 0.366 Test Loss: 2.591 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 1.2184763
	speed: 0.1177s/iter; left time: 1220.7393s
Epoch: 33 cost time: 4.476053953170776
Epoch: 33, Steps: 154 | Train Loss: 1.350 Vali Loss: 3.061 Vali Acc: 0.372 Test Loss: 3.061 Test Acc: 0.372
Validation loss decreased (-0.368583 --> -0.371827).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.2573147
	speed: 0.1173s/iter; left time: 1198.9413s
Epoch: 34 cost time: 4.397929668426514
Epoch: 34, Steps: 154 | Train Loss: 1.370 Vali Loss: 3.094 Vali Acc: 0.361 Test Loss: 3.094 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 1.0360285
	speed: 0.1214s/iter; left time: 1222.0519s
Epoch: 35 cost time: 4.987885475158691
Epoch: 35, Steps: 154 | Train Loss: 1.460 Vali Loss: 3.001 Vali Acc: 0.374 Test Loss: 3.001 Test Acc: 0.374
Validation loss decreased (-0.371827 --> -0.373855).  Saving model ...
	iters: 100, epoch: 36 | loss: 1.0498112
	speed: 0.1174s/iter; left time: 1163.2584s
Epoch: 36 cost time: 4.238336563110352
Epoch: 36, Steps: 154 | Train Loss: 1.272 Vali Loss: 3.021 Vali Acc: 0.373 Test Loss: 3.021 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.8254442
	speed: 0.1154s/iter; left time: 1126.2801s
Epoch: 37 cost time: 4.476885557174683
Epoch: 37, Steps: 154 | Train Loss: 1.326 Vali Loss: 3.395 Vali Acc: 0.363 Test Loss: 3.395 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 1.0402728
	speed: 0.1151s/iter; left time: 1105.5638s
Epoch: 38 cost time: 4.540813446044922
Epoch: 38, Steps: 154 | Train Loss: 1.277 Vali Loss: 3.185 Vali Acc: 0.378 Test Loss: 3.185 Test Acc: 0.378
Validation loss decreased (-0.373855 --> -0.378314).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.9965867
	speed: 0.1134s/iter; left time: 1071.8847s
Epoch: 39 cost time: 4.40037989616394
Epoch: 39, Steps: 154 | Train Loss: 1.336 Vali Loss: 3.446 Vali Acc: 0.245 Test Loss: 3.446 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 1.3515151
	speed: 0.1163s/iter; left time: 1080.5765s
Epoch: 40 cost time: 4.405594348907471
Epoch: 40, Steps: 154 | Train Loss: 1.339 Vali Loss: 3.813 Vali Acc: 0.372 Test Loss: 3.813 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 1.2700237
	speed: 0.1141s/iter; left time: 1043.4201s
Epoch: 41 cost time: 4.457759618759155
Epoch: 41, Steps: 154 | Train Loss: 1.332 Vali Loss: 3.470 Vali Acc: 0.384 Test Loss: 3.470 Test Acc: 0.384
Validation loss decreased (-0.378314 --> -0.383988).  Saving model ...
	iters: 100, epoch: 42 | loss: 1.4785695
	speed: 0.1133s/iter; left time: 1017.9553s
Epoch: 42 cost time: 4.360238313674927
Epoch: 42, Steps: 154 | Train Loss: 1.307 Vali Loss: 3.403 Vali Acc: 0.377 Test Loss: 3.403 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 1.3514688
	speed: 0.1176s/iter; left time: 1038.9870s
Epoch: 43 cost time: 4.325231552124023
Epoch: 43, Steps: 154 | Train Loss: 1.230 Vali Loss: 3.611 Vali Acc: 0.374 Test Loss: 3.611 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 44 | loss: 1.0087390
	speed: 0.1141s/iter; left time: 990.0147s
Epoch: 44 cost time: 4.557217121124268
Epoch: 44, Steps: 154 | Train Loss: 1.245 Vali Loss: 3.728 Vali Acc: 0.371 Test Loss: 3.728 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 45 | loss: 0.8815824
	speed: 0.1128s/iter; left time: 961.4766s
Epoch: 45 cost time: 4.087753534317017
Epoch: 45, Steps: 154 | Train Loss: 1.339 Vali Loss: 3.474 Vali Acc: 0.377 Test Loss: 3.474 Test Acc: 0.377
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 46 | loss: 1.3306620
	speed: 0.1116s/iter; left time: 934.2042s
Epoch: 46 cost time: 4.56086802482605
Epoch: 46, Steps: 154 | Train Loss: 1.231 Vali Loss: 3.225 Vali Acc: 0.374 Test Loss: 3.225 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 47 | loss: 0.6017463
	speed: 0.1142s/iter; left time: 938.1265s
Epoch: 47 cost time: 4.62559962272644
Epoch: 47, Steps: 154 | Train Loss: 1.216 Vali Loss: 3.602 Vali Acc: 0.264 Test Loss: 3.602 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 48 | loss: 1.3000723
	speed: 0.1133s/iter; left time: 913.7579s
Epoch: 48 cost time: 4.5150697231292725
Epoch: 48, Steps: 154 | Train Loss: 1.193 Vali Loss: 3.354 Vali Acc: 0.375 Test Loss: 3.354 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 49 | loss: 0.8752781
	speed: 0.1169s/iter; left time: 924.4682s
Epoch: 49 cost time: 4.591720104217529
Epoch: 49, Steps: 154 | Train Loss: 1.208 Vali Loss: 3.658 Vali Acc: 0.380 Test Loss: 3.658 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 50 | loss: 0.8772581
	speed: 0.1172s/iter; left time: 908.9947s
Epoch: 50 cost time: 4.640636444091797
Epoch: 50, Steps: 154 | Train Loss: 1.299 Vali Loss: 3.603 Vali Acc: 0.383 Test Loss: 3.603 Test Acc: 0.383
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 51 | loss: 0.9401286
	speed: 0.1165s/iter; left time: 885.5361s
Epoch: 51 cost time: 4.5883872509002686
Epoch: 51, Steps: 154 | Train Loss: 1.226 Vali Loss: 3.453 Vali Acc: 0.378 Test Loss: 3.453 Test Acc: 0.378
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3840227088402271
model parameter : 108726
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4898621
	speed: 0.0455s/iter; left time: 696.4081s
Epoch: 1 cost time: 5.938021898269653
Epoch: 1, Steps: 154 | Train Loss: 2.233 Vali Loss: 2.136 Vali Acc: 0.316 Test Loss: 2.136 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9189540
	speed: 0.1112s/iter; left time: 1684.4278s
Epoch: 2 cost time: 4.098073720932007
Epoch: 2, Steps: 154 | Train Loss: 2.045 Vali Loss: 2.162 Vali Acc: 0.317 Test Loss: 2.162 Test Acc: 0.317
Validation loss decreased (-0.315875 --> -0.317091).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.7720513
	speed: 0.1019s/iter; left time: 1528.3703s
Epoch: 3 cost time: 3.956033229827881
Epoch: 3, Steps: 154 | Train Loss: 2.016 Vali Loss: 2.139 Vali Acc: 0.319 Test Loss: 2.139 Test Acc: 0.319
Validation loss decreased (-0.317091 --> -0.319119).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5878330
	speed: 0.1028s/iter; left time: 1524.8851s
Epoch: 4 cost time: 4.465691804885864
Epoch: 4, Steps: 154 | Train Loss: 1.991 Vali Loss: 2.139 Vali Acc: 0.321 Test Loss: 2.139 Test Acc: 0.321
Validation loss decreased (-0.319119 --> -0.321146).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0966685
	speed: 0.1067s/iter; left time: 1566.3066s
Epoch: 5 cost time: 4.204272747039795
Epoch: 5, Steps: 154 | Train Loss: 1.929 Vali Loss: 2.163 Vali Acc: 0.322 Test Loss: 2.163 Test Acc: 0.322
Validation loss decreased (-0.321146 --> -0.322363).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2431207
	speed: 0.1104s/iter; left time: 1604.3463s
Epoch: 6 cost time: 4.296785831451416
Epoch: 6, Steps: 154 | Train Loss: 1.873 Vali Loss: 2.140 Vali Acc: 0.328 Test Loss: 2.140 Test Acc: 0.328
Validation loss decreased (-0.322363 --> -0.328446).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9376222
	speed: 0.1079s/iter; left time: 1550.7930s
Epoch: 7 cost time: 4.371978759765625
Epoch: 7, Steps: 154 | Train Loss: 1.872 Vali Loss: 2.120 Vali Acc: 0.331 Test Loss: 2.120 Test Acc: 0.331
Validation loss decreased (-0.328446 --> -0.330879).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7460999
	speed: 0.1100s/iter; left time: 1564.7753s
Epoch: 8 cost time: 4.379665851593018
Epoch: 8, Steps: 154 | Train Loss: 1.826 Vali Loss: 2.121 Vali Acc: 0.333 Test Loss: 2.121 Test Acc: 0.333
Validation loss decreased (-0.330879 --> -0.332501).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6178335
	speed: 0.1156s/iter; left time: 1626.5334s
Epoch: 9 cost time: 4.259246587753296
Epoch: 9, Steps: 154 | Train Loss: 1.815 Vali Loss: 2.153 Vali Acc: 0.340 Test Loss: 2.153 Test Acc: 0.340
Validation loss decreased (-0.332501 --> -0.339800).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9854226
	speed: 0.1101s/iter; left time: 1532.2638s
Epoch: 10 cost time: 4.4963538646698
Epoch: 10, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.170 Vali Acc: 0.335 Test Loss: 2.170 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.6191876
	speed: 0.1090s/iter; left time: 1499.9967s
Epoch: 11 cost time: 4.307623386383057
Epoch: 11, Steps: 154 | Train Loss: 1.733 Vali Loss: 2.202 Vali Acc: 0.345 Test Loss: 2.202 Test Acc: 0.345
Validation loss decreased (-0.339800 --> -0.345071).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.5397642
	speed: 0.1128s/iter; left time: 1534.9450s
Epoch: 12 cost time: 4.373515844345093
Epoch: 12, Steps: 154 | Train Loss: 1.708 Vali Loss: 2.226 Vali Acc: 0.339 Test Loss: 2.226 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.7575610
	speed: 0.1135s/iter; left time: 1526.3757s
Epoch: 13 cost time: 4.445740699768066
Epoch: 13, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.270 Vali Acc: 0.347 Test Loss: 2.270 Test Acc: 0.347
Validation loss decreased (-0.345071 --> -0.346693).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2834243
	speed: 0.1150s/iter; left time: 1529.3544s
Epoch: 14 cost time: 4.816608667373657
Epoch: 14, Steps: 154 | Train Loss: 1.769 Vali Loss: 2.281 Vali Acc: 0.346 Test Loss: 2.281 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.5059423
	speed: 0.1160s/iter; left time: 1524.4022s
Epoch: 15 cost time: 4.348126649856567
Epoch: 15, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.367 Vali Acc: 0.348 Test Loss: 2.367 Test Acc: 0.348
Validation loss decreased (-0.346693 --> -0.347908).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.0190642
	speed: 0.1161s/iter; left time: 1507.7028s
Epoch: 16 cost time: 4.3881354331970215
Epoch: 16, Steps: 154 | Train Loss: 1.647 Vali Loss: 2.260 Vali Acc: 0.360 Test Loss: 2.260 Test Acc: 0.360
Validation loss decreased (-0.347908 --> -0.359669).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.4823608
	speed: 0.1144s/iter; left time: 1468.5603s
Epoch: 17 cost time: 4.602581262588501
Epoch: 17, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.397 Vali Acc: 0.350 Test Loss: 2.397 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.5217965
	speed: 0.1132s/iter; left time: 1435.3900s
Epoch: 18 cost time: 4.167112827301025
Epoch: 18, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.456 Vali Acc: 0.348 Test Loss: 2.456 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.4954448
	speed: 0.1116s/iter; left time: 1398.1520s
Epoch: 19 cost time: 4.13536524772644
Epoch: 19, Steps: 154 | Train Loss: 1.585 Vali Loss: 2.347 Vali Acc: 0.351 Test Loss: 2.347 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.6290083
	speed: 0.1109s/iter; left time: 1372.2753s
Epoch: 20 cost time: 4.68065619468689
Epoch: 20, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.525 Vali Acc: 0.354 Test Loss: 2.525 Test Acc: 0.354
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.9765888
	speed: 0.1104s/iter; left time: 1348.6877s
Epoch: 21 cost time: 4.058618545532227
Epoch: 21, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.462 Vali Acc: 0.354 Test Loss: 2.462 Test Acc: 0.354
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.1199878
	speed: 0.1099s/iter; left time: 1326.1695s
Epoch: 22 cost time: 4.254489183425903
Epoch: 22, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.501 Vali Acc: 0.354 Test Loss: 2.501 Test Acc: 0.354
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.1858003
	speed: 0.1096s/iter; left time: 1305.8886s
Epoch: 23 cost time: 4.710706472396851
Epoch: 23, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.570 Vali Acc: 0.360 Test Loss: 2.570 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.7995359
	speed: 0.1098s/iter; left time: 1290.9185s
Epoch: 24 cost time: 4.220580101013184
Epoch: 24, Steps: 154 | Train Loss: 1.592 Vali Loss: 2.625 Vali Acc: 0.362 Test Loss: 2.625 Test Acc: 0.362
Validation loss decreased (-0.359669 --> -0.362099).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.3473052
	speed: 0.1091s/iter; left time: 1266.4895s
Epoch: 25 cost time: 4.220309734344482
Epoch: 25, Steps: 154 | Train Loss: 1.542 Vali Loss: 2.503 Vali Acc: 0.356 Test Loss: 2.503 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.2142298
	speed: 0.1054s/iter; left time: 1206.6128s
Epoch: 26 cost time: 4.3055808544158936
Epoch: 26, Steps: 154 | Train Loss: 1.462 Vali Loss: 2.581 Vali Acc: 0.356 Test Loss: 2.581 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.1925896
	speed: 0.1108s/iter; left time: 1251.2749s
Epoch: 27 cost time: 4.3159167766571045
Epoch: 27, Steps: 154 | Train Loss: 1.412 Vali Loss: 2.712 Vali Acc: 0.362 Test Loss: 2.712 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.4858837
	speed: 0.1179s/iter; left time: 1314.1505s
Epoch: 28 cost time: 4.39106822013855
Epoch: 28, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.741 Vali Acc: 0.363 Test Loss: 2.741 Test Acc: 0.363
Validation loss decreased (-0.362099 --> -0.362503).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.5075734
	speed: 0.1098s/iter; left time: 1207.0735s
Epoch: 29 cost time: 4.275400161743164
Epoch: 29, Steps: 154 | Train Loss: 1.466 Vali Loss: 2.793 Vali Acc: 0.361 Test Loss: 2.793 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.9106392
	speed: 0.1071s/iter; left time: 1160.0167s
Epoch: 30 cost time: 4.259991645812988
Epoch: 30, Steps: 154 | Train Loss: 1.396 Vali Loss: 2.629 Vali Acc: 0.363 Test Loss: 2.629 Test Acc: 0.363
Validation loss decreased (-0.362503 --> -0.362910).  Saving model ...
	iters: 100, epoch: 31 | loss: 1.1607795
	speed: 0.1152s/iter; left time: 1230.7504s
Epoch: 31 cost time: 4.38474440574646
Epoch: 31, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.572 Vali Acc: 0.374 Test Loss: 2.572 Test Acc: 0.374
Validation loss decreased (-0.362910 --> -0.373859).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.3831077
	speed: 0.1137s/iter; left time: 1196.4265s
Epoch: 32 cost time: 4.6790525913238525
Epoch: 32, Steps: 154 | Train Loss: 1.371 Vali Loss: 2.810 Vali Acc: 0.364 Test Loss: 2.810 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 1.3514037
	speed: 0.1155s/iter; left time: 1198.1929s
Epoch: 33 cost time: 4.626171827316284
Epoch: 33, Steps: 154 | Train Loss: 1.317 Vali Loss: 2.913 Vali Acc: 0.382 Test Loss: 2.913 Test Acc: 0.382
Validation loss decreased (-0.373859 --> -0.382372).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.2883297
	speed: 0.1143s/iter; left time: 1168.4021s
Epoch: 34 cost time: 4.481610298156738
Epoch: 34, Steps: 154 | Train Loss: 1.364 Vali Loss: 2.942 Vali Acc: 0.365 Test Loss: 2.942 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.9185683
	speed: 0.1086s/iter; left time: 1092.8717s
Epoch: 35 cost time: 4.597361087799072
Epoch: 35, Steps: 154 | Train Loss: 1.332 Vali Loss: 2.765 Vali Acc: 0.373 Test Loss: 2.765 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 1.1538157
	speed: 0.1130s/iter; left time: 1119.8270s
Epoch: 36 cost time: 4.368111848831177
Epoch: 36, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.695 Vali Acc: 0.371 Test Loss: 2.695 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.8728309
	speed: 0.1144s/iter; left time: 1116.4053s
Epoch: 37 cost time: 4.169145107269287
Epoch: 37, Steps: 154 | Train Loss: 1.315 Vali Loss: 2.825 Vali Acc: 0.371 Test Loss: 2.825 Test Acc: 0.371
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 1.0889378
	speed: 0.1101s/iter; left time: 1056.8214s
Epoch: 38 cost time: 4.646492958068848
Epoch: 38, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.890 Vali Acc: 0.376 Test Loss: 2.890 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.9560238
	speed: 0.1136s/iter; left time: 1073.5361s
Epoch: 39 cost time: 4.357805490493774
Epoch: 39, Steps: 154 | Train Loss: 1.350 Vali Loss: 3.079 Vali Acc: 0.240 Test Loss: 3.079 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 1.2396832
	speed: 0.1179s/iter; left time: 1096.3192s
Epoch: 40 cost time: 4.370764493942261
Epoch: 40, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.851 Vali Acc: 0.374 Test Loss: 2.851 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 1.3209354
	speed: 0.1120s/iter; left time: 1023.3377s
Epoch: 41 cost time: 4.4438135623931885
Epoch: 41, Steps: 154 | Train Loss: 1.335 Vali Loss: 2.931 Vali Acc: 0.380 Test Loss: 2.931 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 1.3634605
	speed: 0.1144s/iter; left time: 1027.7997s
Epoch: 42 cost time: 4.301942348480225
Epoch: 42, Steps: 154 | Train Loss: 1.264 Vali Loss: 2.968 Vali Acc: 0.374 Test Loss: 2.968 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 43 | loss: 1.1890806
	speed: 0.1146s/iter; left time: 1012.5243s
Epoch: 43 cost time: 4.342286586761475
Epoch: 43, Steps: 154 | Train Loss: 1.322 Vali Loss: 2.806 Vali Acc: 0.379 Test Loss: 2.806 Test Acc: 0.379
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3824006488240065
model parameter : 108726
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0836582
	speed: 0.0480s/iter; left time: 734.4661s
Epoch: 1 cost time: 6.304626703262329
Epoch: 1, Steps: 154 | Train Loss: 2.291 Vali Loss: 2.148 Vali Acc: 0.317 Test Loss: 2.148 Test Acc: 0.317
Validation loss decreased (inf --> -0.316686).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4011800
	speed: 0.1187s/iter; left time: 1798.4368s
Epoch: 2 cost time: 4.523175477981567
Epoch: 2, Steps: 154 | Train Loss: 2.050 Vali Loss: 2.182 Vali Acc: 0.319 Test Loss: 2.182 Test Acc: 0.319
Validation loss decreased (-0.316686 --> -0.319118).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9249297
	speed: 0.1206s/iter; left time: 1808.7250s
Epoch: 3 cost time: 5.080085039138794
Epoch: 3, Steps: 154 | Train Loss: 2.013 Vali Loss: 2.133 Vali Acc: 0.321 Test Loss: 2.133 Test Acc: 0.321
Validation loss decreased (-0.319118 --> -0.321147).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3912339
	speed: 0.1197s/iter; left time: 1775.9938s
Epoch: 4 cost time: 4.58120322227478
Epoch: 4, Steps: 154 | Train Loss: 1.964 Vali Loss: 2.161 Vali Acc: 0.320 Test Loss: 2.161 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9228849
	speed: 0.1162s/iter; left time: 1706.5806s
Epoch: 5 cost time: 4.292831897735596
Epoch: 5, Steps: 154 | Train Loss: 1.919 Vali Loss: 2.151 Vali Acc: 0.325 Test Loss: 2.151 Test Acc: 0.325
Validation loss decreased (-0.321147 --> -0.325202).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7345606
	speed: 0.1158s/iter; left time: 1682.9117s
Epoch: 6 cost time: 4.939086437225342
Epoch: 6, Steps: 154 | Train Loss: 1.893 Vali Loss: 2.150 Vali Acc: 0.325 Test Loss: 2.150 Test Acc: 0.325
Validation loss decreased (-0.325202 --> -0.325202).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5540828
	speed: 0.1149s/iter; left time: 1651.3396s
Epoch: 7 cost time: 4.475338697433472
Epoch: 7, Steps: 154 | Train Loss: 1.842 Vali Loss: 2.181 Vali Acc: 0.325 Test Loss: 2.181 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7938467
	speed: 0.1136s/iter; left time: 1616.3370s
Epoch: 8 cost time: 4.496650457382202
Epoch: 8, Steps: 154 | Train Loss: 1.825 Vali Loss: 2.164 Vali Acc: 0.330 Test Loss: 2.164 Test Acc: 0.330
Validation loss decreased (-0.325202 --> -0.329662).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7131716
	speed: 0.1192s/iter; left time: 1676.9837s
Epoch: 9 cost time: 5.04534125328064
Epoch: 9, Steps: 154 | Train Loss: 1.791 Vali Loss: 2.184 Vali Acc: 0.330 Test Loss: 2.184 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4950837
	speed: 0.1141s/iter; left time: 1587.5327s
Epoch: 10 cost time: 4.528663396835327
Epoch: 10, Steps: 154 | Train Loss: 1.789 Vali Loss: 2.261 Vali Acc: 0.327 Test Loss: 2.261 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.8609376
	speed: 0.1172s/iter; left time: 1612.3571s
Epoch: 11 cost time: 4.6065309047698975
Epoch: 11, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.169 Vali Acc: 0.334 Test Loss: 2.169 Test Acc: 0.334
Validation loss decreased (-0.329662 --> -0.334123).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7869860
	speed: 0.1177s/iter; left time: 1602.0598s
Epoch: 12 cost time: 4.889755725860596
Epoch: 12, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.168 Vali Acc: 0.339 Test Loss: 2.168 Test Acc: 0.339
Validation loss decreased (-0.334123 --> -0.339394).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.8552662
	speed: 0.1139s/iter; left time: 1531.6830s
Epoch: 13 cost time: 4.300496816635132
Epoch: 13, Steps: 154 | Train Loss: 1.733 Vali Loss: 2.156 Vali Acc: 0.341 Test Loss: 2.156 Test Acc: 0.341
Validation loss decreased (-0.339394 --> -0.340611).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.8255506
	speed: 0.1175s/iter; left time: 1562.6265s
Epoch: 14 cost time: 4.59809684753418
Epoch: 14, Steps: 154 | Train Loss: 1.706 Vali Loss: 2.235 Vali Acc: 0.336 Test Loss: 2.235 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.7193298
	speed: 0.1165s/iter; left time: 1531.8653s
Epoch: 15 cost time: 4.911882638931274
Epoch: 15, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.248 Vali Acc: 0.342 Test Loss: 2.248 Test Acc: 0.342
Validation loss decreased (-0.340611 --> -0.341827).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.7424673
	speed: 0.1192s/iter; left time: 1548.0872s
Epoch: 16 cost time: 4.4527268409729
Epoch: 16, Steps: 154 | Train Loss: 1.623 Vali Loss: 2.313 Vali Acc: 0.342 Test Loss: 2.313 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.3425332
	speed: 0.1171s/iter; left time: 1503.1448s
Epoch: 17 cost time: 4.734527111053467
Epoch: 17, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.243 Vali Acc: 0.352 Test Loss: 2.243 Test Acc: 0.352
Validation loss decreased (-0.341827 --> -0.351559).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.7194030
	speed: 0.1181s/iter; left time: 1497.8790s
Epoch: 18 cost time: 5.1950743198394775
Epoch: 18, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.309 Vali Acc: 0.344 Test Loss: 2.309 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.6430142
	speed: 0.1162s/iter; left time: 1455.2645s
Epoch: 19 cost time: 4.6289613246917725
Epoch: 19, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.430 Vali Acc: 0.360 Test Loss: 2.430 Test Acc: 0.360
Validation loss decreased (-0.351559 --> -0.360073).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.2840821
	speed: 0.1177s/iter; left time: 1456.4040s
Epoch: 20 cost time: 4.828407287597656
Epoch: 20, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.374 Vali Acc: 0.355 Test Loss: 2.374 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.8230879
	speed: 0.1240s/iter; left time: 1515.4532s
Epoch: 21 cost time: 5.2855308055877686
Epoch: 21, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.565 Vali Acc: 0.212 Test Loss: 2.565 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.6723975
	speed: 0.1140s/iter; left time: 1375.7170s
Epoch: 22 cost time: 4.546024560928345
Epoch: 22, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.414 Vali Acc: 0.355 Test Loss: 2.414 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.7173938
	speed: 0.1233s/iter; left time: 1468.3922s
Epoch: 23 cost time: 4.655966758728027
Epoch: 23, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.500 Vali Acc: 0.362 Test Loss: 2.500 Test Acc: 0.362
Validation loss decreased (-0.360073 --> -0.362100).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.8547627
	speed: 0.1152s/iter; left time: 1355.0567s
Epoch: 24 cost time: 4.796321868896484
Epoch: 24, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.493 Vali Acc: 0.364 Test Loss: 2.493 Test Acc: 0.364
Validation loss decreased (-0.362100 --> -0.363722).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.4151615
	speed: 0.1110s/iter; left time: 1288.5223s
Epoch: 25 cost time: 4.29319429397583
Epoch: 25, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.454 Vali Acc: 0.370 Test Loss: 2.454 Test Acc: 0.370
Validation loss decreased (-0.363722 --> -0.370211).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.8684561
	speed: 0.1166s/iter; left time: 1334.8998s
Epoch: 26 cost time: 4.692682981491089
Epoch: 26, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.485 Vali Acc: 0.374 Test Loss: 2.485 Test Acc: 0.374
Validation loss decreased (-0.370211 --> -0.373860).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.2641547
	speed: 0.1166s/iter; left time: 1317.4817s
Epoch: 27 cost time: 4.7298219203948975
Epoch: 27, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.733 Vali Acc: 0.363 Test Loss: 2.733 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.7769305
	speed: 0.1125s/iter; left time: 1254.1397s
Epoch: 28 cost time: 4.3831946849823
Epoch: 28, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.662 Vali Acc: 0.374 Test Loss: 2.662 Test Acc: 0.374
Validation loss decreased (-0.373860 --> -0.374264).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.6097980
	speed: 0.1158s/iter; left time: 1272.8408s
Epoch: 29 cost time: 4.493717432022095
Epoch: 29, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.806 Vali Acc: 0.369 Test Loss: 2.806 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.5129944
	speed: 0.1161s/iter; left time: 1258.3738s
Epoch: 30 cost time: 4.554550886154175
Epoch: 30, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.625 Vali Acc: 0.360 Test Loss: 2.625 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.2836896
	speed: 0.1121s/iter; left time: 1196.9533s
Epoch: 31 cost time: 4.061557769775391
Epoch: 31, Steps: 154 | Train Loss: 1.381 Vali Loss: 3.089 Vali Acc: 0.232 Test Loss: 3.089 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.0702338
	speed: 0.1164s/iter; left time: 1225.3360s
Epoch: 32 cost time: 4.540796756744385
Epoch: 32, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.956 Vali Acc: 0.215 Test Loss: 2.956 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.8165317
	speed: 0.1078s/iter; left time: 1118.2330s
Epoch: 33 cost time: 4.068064212799072
Epoch: 33, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.951 Vali Acc: 0.376 Test Loss: 2.951 Test Acc: 0.376
Validation loss decreased (-0.374264 --> -0.376288).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.7390139
	speed: 0.1123s/iter; left time: 1147.9987s
Epoch: 34 cost time: 4.807030439376831
Epoch: 34, Steps: 154 | Train Loss: 1.310 Vali Loss: 2.993 Vali Acc: 0.346 Test Loss: 2.993 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 2.3051293
	speed: 0.1198s/iter; left time: 1206.0334s
Epoch: 35 cost time: 5.168653964996338
Epoch: 35, Steps: 154 | Train Loss: 1.310 Vali Loss: 3.081 Vali Acc: 0.228 Test Loss: 3.081 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 2.0886152
	speed: 0.1163s/iter; left time: 1152.4973s
Epoch: 36 cost time: 4.745219945907593
Epoch: 36, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.920 Vali Acc: 0.380 Test Loss: 2.920 Test Acc: 0.380
Validation loss decreased (-0.376288 --> -0.380344).  Saving model ...
	iters: 100, epoch: 37 | loss: 1.1413398
	speed: 0.1182s/iter; left time: 1153.6901s
Epoch: 37 cost time: 4.881183862686157
Epoch: 37, Steps: 154 | Train Loss: 1.527 Vali Loss: 3.160 Vali Acc: 0.381 Test Loss: 3.160 Test Acc: 0.381
Validation loss decreased (-0.380344 --> -0.380747).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.9189609
	speed: 0.1198s/iter; left time: 1150.3319s
Epoch: 38 cost time: 4.777037143707275
Epoch: 38, Steps: 154 | Train Loss: 1.358 Vali Loss: 2.806 Vali Acc: 0.232 Test Loss: 2.806 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 1.5273772
	speed: 0.1157s/iter; left time: 1092.8828s
Epoch: 39 cost time: 4.710479021072388
Epoch: 39, Steps: 154 | Train Loss: 1.268 Vali Loss: 3.169 Vali Acc: 0.375 Test Loss: 3.169 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 1.0175517
	speed: 0.1126s/iter; left time: 1046.4648s
Epoch: 40 cost time: 4.405439376831055
Epoch: 40, Steps: 154 | Train Loss: 1.307 Vali Loss: 2.947 Vali Acc: 0.376 Test Loss: 2.947 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 0.9110394
	speed: 0.1167s/iter; left time: 1066.3190s
Epoch: 41 cost time: 5.049345254898071
Epoch: 41, Steps: 154 | Train Loss: 1.284 Vali Loss: 3.135 Vali Acc: 0.212 Test Loss: 3.135 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 42 | loss: 1.0741875
	speed: 0.1132s/iter; left time: 1017.3995s
Epoch: 42 cost time: 4.32410192489624
Epoch: 42, Steps: 154 | Train Loss: 1.408 Vali Loss: 3.297 Vali Acc: 0.204 Test Loss: 3.297 Test Acc: 0.204
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 43 | loss: 2.2057762
	speed: 0.1136s/iter; left time: 1003.3693s
Epoch: 43 cost time: 4.343417167663574
Epoch: 43, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.902 Vali Acc: 0.356 Test Loss: 2.902 Test Acc: 0.356
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 44 | loss: 1.1587977
	speed: 0.1072s/iter; left time: 930.7010s
Epoch: 44 cost time: 4.627790212631226
Epoch: 44, Steps: 154 | Train Loss: 1.266 Vali Loss: 2.962 Vali Acc: 0.382 Test Loss: 2.962 Test Acc: 0.382
Validation loss decreased (-0.380747 --> -0.382371).  Saving model ...
	iters: 100, epoch: 45 | loss: 1.0108564
	speed: 0.1142s/iter; left time: 973.4342s
Epoch: 45 cost time: 4.640389919281006
Epoch: 45, Steps: 154 | Train Loss: 1.254 Vali Loss: 3.204 Vali Acc: 0.379 Test Loss: 3.204 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 46 | loss: 0.7635075
	speed: 0.1118s/iter; left time: 935.9347s
Epoch: 46 cost time: 4.244810581207275
Epoch: 46, Steps: 154 | Train Loss: 1.205 Vali Loss: 3.631 Vali Acc: 0.369 Test Loss: 3.631 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 47 | loss: 1.1824723
	speed: 0.1116s/iter; left time: 916.9277s
Epoch: 47 cost time: 5.105794668197632
Epoch: 47, Steps: 154 | Train Loss: 1.278 Vali Loss: 3.454 Vali Acc: 0.378 Test Loss: 3.454 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 48 | loss: 0.9313688
	speed: 0.1156s/iter; left time: 931.8733s
Epoch: 48 cost time: 4.377863168716431
Epoch: 48, Steps: 154 | Train Loss: 1.296 Vali Loss: 3.491 Vali Acc: 0.209 Test Loss: 3.491 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 49 | loss: 1.2330948
	speed: 0.1138s/iter; left time: 899.9386s
Epoch: 49 cost time: 4.389620780944824
Epoch: 49, Steps: 154 | Train Loss: 1.327 Vali Loss: 3.684 Vali Acc: 0.385 Test Loss: 3.684 Test Acc: 0.385
Validation loss decreased (-0.382371 --> -0.384797).  Saving model ...
	iters: 100, epoch: 50 | loss: 1.2896125
	speed: 0.1109s/iter; left time: 859.6431s
Epoch: 50 cost time: 4.462600231170654
Epoch: 50, Steps: 154 | Train Loss: 1.245 Vali Loss: 3.860 Vali Acc: 0.370 Test Loss: 3.860 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 51 | loss: 0.8254501
	speed: 0.1182s/iter; left time: 898.7819s
Epoch: 51 cost time: 4.671180486679077
Epoch: 51, Steps: 154 | Train Loss: 1.263 Vali Loss: 3.845 Vali Acc: 0.345 Test Loss: 3.845 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 52 | loss: 0.6860154
	speed: 0.1151s/iter; left time: 857.2969s
Epoch: 52 cost time: 4.535454511642456
Epoch: 52, Steps: 154 | Train Loss: 1.265 Vali Loss: 3.611 Vali Acc: 0.208 Test Loss: 3.611 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 53 | loss: 0.8196164
	speed: 0.1134s/iter; left time: 827.3870s
Epoch: 53 cost time: 4.934874534606934
Epoch: 53, Steps: 154 | Train Loss: 1.397 Vali Loss: 3.378 Vali Acc: 0.373 Test Loss: 3.378 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 54 | loss: 0.9791460
	speed: 0.1179s/iter; left time: 841.3903s
Epoch: 54 cost time: 4.410684585571289
Epoch: 54, Steps: 154 | Train Loss: 1.250 Vali Loss: 3.651 Vali Acc: 0.380 Test Loss: 3.651 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 55 | loss: 1.2364168
	speed: 0.1177s/iter; left time: 822.2388s
Epoch: 55 cost time: 4.856035470962524
Epoch: 55, Steps: 154 | Train Loss: 1.468 Vali Loss: 3.836 Vali Acc: 0.380 Test Loss: 3.836 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 56 | loss: 1.0202447
	speed: 0.1182s/iter; left time: 807.5136s
Epoch: 56 cost time: 4.889214515686035
Epoch: 56, Steps: 154 | Train Loss: 1.141 Vali Loss: 3.775 Vali Acc: 0.203 Test Loss: 3.775 Test Acc: 0.203
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 57 | loss: 1.6687022
	speed: 0.1163s/iter; left time: 776.5207s
Epoch: 57 cost time: 4.4316089153289795
Epoch: 57, Steps: 154 | Train Loss: 1.325 Vali Loss: 3.953 Vali Acc: 0.182 Test Loss: 3.953 Test Acc: 0.182
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 58 | loss: 1.2877311
	speed: 0.1156s/iter; left time: 754.2732s
Epoch: 58 cost time: 4.425245046615601
Epoch: 58, Steps: 154 | Train Loss: 1.324 Vali Loss: 3.397 Vali Acc: 0.097 Test Loss: 3.397 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 59 | loss: 1.0065966
	speed: 0.1132s/iter; left time: 720.8585s
Epoch: 59 cost time: 4.6748151779174805
Epoch: 59, Steps: 154 | Train Loss: 1.279 Vali Loss: 3.490 Vali Acc: 0.220 Test Loss: 3.490 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3848337388483374
model parameter : 75958
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0708232
	speed: 0.0435s/iter; left time: 665.4545s
Epoch: 1 cost time: 5.842100143432617
Epoch: 1, Steps: 154 | Train Loss: 2.282 Vali Loss: 2.148 Vali Acc: 0.316 Test Loss: 2.148 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4026906
	speed: 0.1113s/iter; left time: 1685.6342s
Epoch: 2 cost time: 4.627526760101318
Epoch: 2, Steps: 154 | Train Loss: 2.045 Vali Loss: 2.178 Vali Acc: 0.320 Test Loss: 2.178 Test Acc: 0.320
Validation loss decreased (-0.315875 --> -0.319930).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9275132
	speed: 0.1100s/iter; left time: 1648.5223s
Epoch: 3 cost time: 4.386829137802124
Epoch: 3, Steps: 154 | Train Loss: 2.012 Vali Loss: 2.133 Vali Acc: 0.322 Test Loss: 2.133 Test Acc: 0.322
Validation loss decreased (-0.319930 --> -0.321552).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4242504
	speed: 0.1168s/iter; left time: 1732.9946s
Epoch: 4 cost time: 4.450684547424316
Epoch: 4, Steps: 154 | Train Loss: 1.961 Vali Loss: 2.157 Vali Acc: 0.322 Test Loss: 2.157 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9174579
	speed: 0.1103s/iter; left time: 1620.2822s
Epoch: 5 cost time: 4.4168291091918945
Epoch: 5, Steps: 154 | Train Loss: 1.918 Vali Loss: 2.146 Vali Acc: 0.325 Test Loss: 2.146 Test Acc: 0.325
Validation loss decreased (-0.321552 --> -0.325202).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7799367
	speed: 0.1121s/iter; left time: 1628.2663s
Epoch: 6 cost time: 4.369481086730957
Epoch: 6, Steps: 154 | Train Loss: 1.891 Vali Loss: 2.141 Vali Acc: 0.326 Test Loss: 2.141 Test Acc: 0.326
Validation loss decreased (-0.325202 --> -0.326418).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5475323
	speed: 0.1167s/iter; left time: 1677.6316s
Epoch: 7 cost time: 4.4025609493255615
Epoch: 7, Steps: 154 | Train Loss: 1.859 Vali Loss: 2.159 Vali Acc: 0.326 Test Loss: 2.159 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7854472
	speed: 0.1077s/iter; left time: 1531.1172s
Epoch: 8 cost time: 4.506462335586548
Epoch: 8, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.155 Vali Acc: 0.331 Test Loss: 2.155 Test Acc: 0.331
Validation loss decreased (-0.326418 --> -0.330879).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7095464
	speed: 0.1160s/iter; left time: 1631.9310s
Epoch: 9 cost time: 4.565706253051758
Epoch: 9, Steps: 154 | Train Loss: 1.822 Vali Loss: 2.177 Vali Acc: 0.330 Test Loss: 2.177 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2208405
	speed: 0.1181s/iter; left time: 1642.7027s
Epoch: 10 cost time: 5.047032594680786
Epoch: 10, Steps: 154 | Train Loss: 1.773 Vali Loss: 2.240 Vali Acc: 0.330 Test Loss: 2.240 Test Acc: 0.330
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.8827192
	speed: 0.1131s/iter; left time: 1556.1138s
Epoch: 11 cost time: 5.081818103790283
Epoch: 11, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.161 Vali Acc: 0.339 Test Loss: 2.161 Test Acc: 0.339
Validation loss decreased (-0.330879 --> -0.338989).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7467998
	speed: 0.1186s/iter; left time: 1614.4136s
Epoch: 12 cost time: 3.635742425918579
Epoch: 12, Steps: 154 | Train Loss: 1.715 Vali Loss: 2.166 Vali Acc: 0.340 Test Loss: 2.166 Test Acc: 0.340
Validation loss decreased (-0.338989 --> -0.339800).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.0535300
	speed: 0.0881s/iter; left time: 1185.7059s
Epoch: 13 cost time: 3.6194465160369873
Epoch: 13, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.190 Vali Acc: 0.342 Test Loss: 2.190 Test Acc: 0.342
Validation loss decreased (-0.339800 --> -0.341827).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.7882760
	speed: 0.0911s/iter; left time: 1210.9755s
Epoch: 14 cost time: 3.655937671661377
Epoch: 14, Steps: 154 | Train Loss: 1.661 Vali Loss: 2.262 Vali Acc: 0.337 Test Loss: 2.262 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.7332898
	speed: 0.1107s/iter; left time: 1454.7072s
Epoch: 15 cost time: 4.502645015716553
Epoch: 15, Steps: 154 | Train Loss: 1.631 Vali Loss: 2.260 Vali Acc: 0.347 Test Loss: 2.260 Test Acc: 0.347
Validation loss decreased (-0.341827 --> -0.346693).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.6962631
	speed: 0.1113s/iter; left time: 1446.4997s
Epoch: 16 cost time: 4.534371376037598
Epoch: 16, Steps: 154 | Train Loss: 1.677 Vali Loss: 2.374 Vali Acc: 0.344 Test Loss: 2.374 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.3358457
	speed: 0.1117s/iter; left time: 1433.8251s
Epoch: 17 cost time: 4.383629560470581
Epoch: 17, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.359 Vali Acc: 0.351 Test Loss: 2.359 Test Acc: 0.351
Validation loss decreased (-0.346693 --> -0.350747).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6662110
	speed: 0.1139s/iter; left time: 1444.9785s
Epoch: 18 cost time: 4.720297813415527
Epoch: 18, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.390 Vali Acc: 0.353 Test Loss: 2.390 Test Acc: 0.353
Validation loss decreased (-0.350747 --> -0.352774).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.5766066
	speed: 0.1086s/iter; left time: 1361.1951s
Epoch: 19 cost time: 4.47318959236145
Epoch: 19, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.481 Vali Acc: 0.362 Test Loss: 2.481 Test Acc: 0.362
Validation loss decreased (-0.352774 --> -0.362100).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.2923948
	speed: 0.1036s/iter; left time: 1282.4856s
Epoch: 20 cost time: 4.15733003616333
Epoch: 20, Steps: 154 | Train Loss: 1.524 Vali Loss: 2.506 Vali Acc: 0.354 Test Loss: 2.506 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.7686266
	speed: 0.1090s/iter; left time: 1332.6909s
Epoch: 21 cost time: 4.520814657211304
Epoch: 21, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.649 Vali Acc: 0.232 Test Loss: 2.649 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.7881508
	speed: 0.1093s/iter; left time: 1318.4045s
Epoch: 22 cost time: 4.458859443664551
Epoch: 22, Steps: 154 | Train Loss: 1.554 Vali Loss: 2.455 Vali Acc: 0.359 Test Loss: 2.455 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.8034351
	speed: 0.1154s/iter; left time: 1374.4010s
Epoch: 23 cost time: 4.184475660324097
Epoch: 23, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.547 Vali Acc: 0.360 Test Loss: 2.547 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.7849327
	speed: 0.1129s/iter; left time: 1327.0333s
Epoch: 24 cost time: 4.5817177295684814
Epoch: 24, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.668 Vali Acc: 0.361 Test Loss: 2.668 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.2803186
	speed: 0.1133s/iter; left time: 1314.6171s
Epoch: 25 cost time: 4.340658664703369
Epoch: 25, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.508 Vali Acc: 0.358 Test Loss: 2.508 Test Acc: 0.358
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.9071080
	speed: 0.1153s/iter; left time: 1320.4528s
Epoch: 26 cost time: 4.575293064117432
Epoch: 26, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.662 Vali Acc: 0.362 Test Loss: 2.662 Test Acc: 0.362
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.3737465
	speed: 0.1124s/iter; left time: 1269.9142s
Epoch: 27 cost time: 4.989838123321533
Epoch: 27, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.669 Vali Acc: 0.362 Test Loss: 2.669 Test Acc: 0.362
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.8384495
	speed: 0.1147s/iter; left time: 1277.8293s
Epoch: 28 cost time: 4.541506290435791
Epoch: 28, Steps: 154 | Train Loss: 1.585 Vali Loss: 2.569 Vali Acc: 0.376 Test Loss: 2.569 Test Acc: 0.376
Validation loss decreased (-0.362100 --> -0.375481).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.3798695
	speed: 0.1134s/iter; left time: 1246.3080s
Epoch: 29 cost time: 4.471251726150513
Epoch: 29, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.743 Vali Acc: 0.371 Test Loss: 2.743 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.4490712
	speed: 0.1166s/iter; left time: 1263.0905s
Epoch: 30 cost time: 5.2567138671875
Epoch: 30, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.719 Vali Acc: 0.368 Test Loss: 2.719 Test Acc: 0.368
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.1973445
	speed: 0.1204s/iter; left time: 1286.2581s
Epoch: 31 cost time: 4.491491794586182
Epoch: 31, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.662 Vali Acc: 0.374 Test Loss: 2.662 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.2737483
	speed: 0.1146s/iter; left time: 1206.3395s
Epoch: 32 cost time: 4.2770891189575195
Epoch: 32, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.776 Vali Acc: 0.357 Test Loss: 2.776 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.7603357
	speed: 0.1118s/iter; left time: 1160.1552s
Epoch: 33 cost time: 4.422142267227173
Epoch: 33, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.706 Vali Acc: 0.376 Test Loss: 2.706 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 3.2401028
	speed: 0.1062s/iter; left time: 1085.6329s
Epoch: 34 cost time: 4.068209648132324
Epoch: 34, Steps: 154 | Train Loss: 1.328 Vali Loss: 2.735 Vali Acc: 0.346 Test Loss: 2.735 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 1.3844320
	speed: 0.1020s/iter; left time: 1026.3423s
Epoch: 35 cost time: 4.439872741699219
Epoch: 35, Steps: 154 | Train Loss: 1.287 Vali Loss: 2.940 Vali Acc: 0.350 Test Loss: 2.940 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 1.9238938
	speed: 0.1128s/iter; left time: 1117.5718s
Epoch: 36 cost time: 4.6291422843933105
Epoch: 36, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.739 Vali Acc: 0.379 Test Loss: 2.739 Test Acc: 0.379
Validation loss decreased (-0.375481 --> -0.379129).  Saving model ...
	iters: 100, epoch: 37 | loss: 1.1669428
	speed: 0.1159s/iter; left time: 1131.1828s
Epoch: 37 cost time: 4.418368101119995
Epoch: 37, Steps: 154 | Train Loss: 1.328 Vali Loss: 3.082 Vali Acc: 0.382 Test Loss: 3.082 Test Acc: 0.382
Validation loss decreased (-0.379129 --> -0.381559).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.8057749
	speed: 0.1113s/iter; left time: 1068.9050s
Epoch: 38 cost time: 4.726495742797852
Epoch: 38, Steps: 154 | Train Loss: 1.297 Vali Loss: 2.708 Vali Acc: 0.379 Test Loss: 2.708 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 1.5162961
	speed: 0.1094s/iter; left time: 1033.9772s
Epoch: 39 cost time: 4.234098672866821
Epoch: 39, Steps: 154 | Train Loss: 1.282 Vali Loss: 3.096 Vali Acc: 0.375 Test Loss: 3.096 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 0.9703866
	speed: 0.1148s/iter; left time: 1066.6115s
Epoch: 40 cost time: 4.264523506164551
Epoch: 40, Steps: 154 | Train Loss: 1.409 Vali Loss: 3.051 Vali Acc: 0.376 Test Loss: 3.051 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 0.8942820
	speed: 0.1105s/iter; left time: 1009.8792s
Epoch: 41 cost time: 4.321816921234131
Epoch: 41, Steps: 154 | Train Loss: 1.231 Vali Loss: 3.048 Vali Acc: 0.214 Test Loss: 3.048 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 42 | loss: 1.1016955
	speed: 0.1146s/iter; left time: 1029.5399s
Epoch: 42 cost time: 4.371960401535034
Epoch: 42, Steps: 154 | Train Loss: 1.564 Vali Loss: 3.106 Vali Acc: 0.225 Test Loss: 3.106 Test Acc: 0.225
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 43 | loss: 1.2114806
	speed: 0.1151s/iter; left time: 1017.0869s
Epoch: 43 cost time: 4.213181972503662
Epoch: 43, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.854 Vali Acc: 0.384 Test Loss: 2.854 Test Acc: 0.384
Validation loss decreased (-0.381559 --> -0.383589).  Saving model ...
	iters: 100, epoch: 44 | loss: 1.2346263
	speed: 0.1139s/iter; left time: 988.5792s
Epoch: 44 cost time: 4.809199094772339
Epoch: 44, Steps: 154 | Train Loss: 1.320 Vali Loss: 3.032 Vali Acc: 0.387 Test Loss: 3.032 Test Acc: 0.387
Validation loss decreased (-0.383589 --> -0.386831).  Saving model ...
	iters: 100, epoch: 45 | loss: 0.9979572
	speed: 0.1169s/iter; left time: 996.8856s
Epoch: 45 cost time: 4.566558599472046
Epoch: 45, Steps: 154 | Train Loss: 1.242 Vali Loss: 3.135 Vali Acc: 0.380 Test Loss: 3.135 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 46 | loss: 0.8346828
	speed: 0.1151s/iter; left time: 963.1318s
Epoch: 46 cost time: 4.530650854110718
Epoch: 46, Steps: 154 | Train Loss: 1.276 Vali Loss: 3.217 Vali Acc: 0.376 Test Loss: 3.217 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 47 | loss: 1.0759016
	speed: 0.1144s/iter; left time: 940.3784s
Epoch: 47 cost time: 4.903270721435547
Epoch: 47, Steps: 154 | Train Loss: 1.302 Vali Loss: 3.169 Vali Acc: 0.374 Test Loss: 3.169 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 48 | loss: 0.9242862
	speed: 0.1152s/iter; left time: 928.8871s
Epoch: 48 cost time: 4.758864164352417
Epoch: 48, Steps: 154 | Train Loss: 1.383 Vali Loss: 3.591 Vali Acc: 0.209 Test Loss: 3.591 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 49 | loss: 1.0698694
	speed: 0.1120s/iter; left time: 885.5185s
Epoch: 49 cost time: 4.155152797698975
Epoch: 49, Steps: 154 | Train Loss: 1.270 Vali Loss: 3.383 Vali Acc: 0.384 Test Loss: 3.383 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 50 | loss: 1.2999203
	speed: 0.1151s/iter; left time: 892.6378s
Epoch: 50 cost time: 4.661409854888916
Epoch: 50, Steps: 154 | Train Loss: 1.280 Vali Loss: 3.517 Vali Acc: 0.383 Test Loss: 3.517 Test Acc: 0.383
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 51 | loss: 0.7513697
	speed: 0.1129s/iter; left time: 857.9767s
Epoch: 51 cost time: 4.503490686416626
Epoch: 51, Steps: 154 | Train Loss: 1.223 Vali Loss: 3.415 Vali Acc: 0.230 Test Loss: 3.415 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 52 | loss: 0.6998106
	speed: 0.1141s/iter; left time: 849.5321s
Epoch: 52 cost time: 4.1822309494018555
Epoch: 52, Steps: 154 | Train Loss: 1.305 Vali Loss: 3.366 Vali Acc: 0.206 Test Loss: 3.366 Test Acc: 0.206
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 53 | loss: 1.0062877
	speed: 0.1119s/iter; left time: 816.2388s
Epoch: 53 cost time: 4.582557678222656
Epoch: 53, Steps: 154 | Train Loss: 1.265 Vali Loss: 3.351 Vali Acc: 0.373 Test Loss: 3.351 Test Acc: 0.373
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 54 | loss: 1.2092683
	speed: 0.1148s/iter; left time: 819.2194s
Epoch: 54 cost time: 4.349196672439575
Epoch: 54, Steps: 154 | Train Loss: 1.263 Vali Loss: 3.842 Vali Acc: 0.379 Test Loss: 3.842 Test Acc: 0.379
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38686131386861317
model parameter : 75958
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0806305
	speed: 0.0390s/iter; left time: 596.6643s
Epoch: 1 cost time: 5.205213785171509
Epoch: 1, Steps: 154 | Train Loss: 2.266 Vali Loss: 2.150 Vali Acc: 0.316 Test Loss: 2.150 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3949275
	speed: 0.0978s/iter; left time: 1480.6405s
Epoch: 2 cost time: 3.9143667221069336
Epoch: 2, Steps: 154 | Train Loss: 2.045 Vali Loss: 2.171 Vali Acc: 0.319 Test Loss: 2.171 Test Acc: 0.319
Validation loss decreased (-0.316280 --> -0.318713).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9724663
	speed: 0.1064s/iter; left time: 1595.5103s
Epoch: 3 cost time: 4.039029598236084
Epoch: 3, Steps: 154 | Train Loss: 2.016 Vali Loss: 2.126 Vali Acc: 0.322 Test Loss: 2.126 Test Acc: 0.322
Validation loss decreased (-0.318713 --> -0.321552).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4863472
	speed: 0.1142s/iter; left time: 1695.1857s
Epoch: 4 cost time: 4.3089728355407715
Epoch: 4, Steps: 154 | Train Loss: 1.968 Vali Loss: 2.140 Vali Acc: 0.322 Test Loss: 2.140 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9548408
	speed: 0.1134s/iter; left time: 1665.6443s
Epoch: 5 cost time: 4.458299160003662
Epoch: 5, Steps: 154 | Train Loss: 1.918 Vali Loss: 2.138 Vali Acc: 0.325 Test Loss: 2.138 Test Acc: 0.325
Validation loss decreased (-0.321552 --> -0.324796).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7405635
	speed: 0.1215s/iter; left time: 1765.3466s
Epoch: 6 cost time: 4.613510847091675
Epoch: 6, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.127 Vali Acc: 0.325 Test Loss: 2.127 Test Acc: 0.325
Validation loss decreased (-0.324796 --> -0.324796).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5151222
	speed: 0.1165s/iter; left time: 1675.2096s
Epoch: 7 cost time: 4.512022495269775
Epoch: 7, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.141 Vali Acc: 0.325 Test Loss: 2.141 Test Acc: 0.325
Validation loss decreased (-0.324796 --> -0.325202).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8109503
	speed: 0.1177s/iter; left time: 1674.1252s
Epoch: 8 cost time: 4.544425010681152
Epoch: 8, Steps: 154 | Train Loss: 1.828 Vali Loss: 2.129 Vali Acc: 0.330 Test Loss: 2.129 Test Acc: 0.330
Validation loss decreased (-0.325202 --> -0.330068).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7036464
	speed: 0.1171s/iter; left time: 1647.0111s
Epoch: 9 cost time: 4.614619255065918
Epoch: 9, Steps: 154 | Train Loss: 1.811 Vali Loss: 2.171 Vali Acc: 0.330 Test Loss: 2.171 Test Acc: 0.330
Validation loss decreased (-0.330068 --> -0.330473).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2375188
	speed: 0.1143s/iter; left time: 1590.1769s
Epoch: 10 cost time: 4.729003429412842
Epoch: 10, Steps: 154 | Train Loss: 1.774 Vali Loss: 2.242 Vali Acc: 0.329 Test Loss: 2.242 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.8960910
	speed: 0.1146s/iter; left time: 1577.2760s
Epoch: 11 cost time: 4.45542573928833
Epoch: 11, Steps: 154 | Train Loss: 1.759 Vali Loss: 2.135 Vali Acc: 0.337 Test Loss: 2.135 Test Acc: 0.337
Validation loss decreased (-0.330473 --> -0.337367).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7938805
	speed: 0.1145s/iter; left time: 1558.1618s
Epoch: 12 cost time: 4.144842147827148
Epoch: 12, Steps: 154 | Train Loss: 1.718 Vali Loss: 2.184 Vali Acc: 0.341 Test Loss: 2.184 Test Acc: 0.341
Validation loss decreased (-0.337367 --> -0.341422).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.8834716
	speed: 0.1109s/iter; left time: 1491.2815s
Epoch: 13 cost time: 4.510340929031372
Epoch: 13, Steps: 154 | Train Loss: 1.705 Vali Loss: 2.156 Vali Acc: 0.345 Test Loss: 2.156 Test Acc: 0.345
Validation loss decreased (-0.341422 --> -0.345477).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5779328
	speed: 0.1125s/iter; left time: 1496.0977s
Epoch: 14 cost time: 4.473973751068115
Epoch: 14, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.275 Vali Acc: 0.341 Test Loss: 2.275 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.7336953
	speed: 0.1135s/iter; left time: 1492.3143s
Epoch: 15 cost time: 4.3313679695129395
Epoch: 15, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.315 Vali Acc: 0.348 Test Loss: 2.315 Test Acc: 0.348
Validation loss decreased (-0.345477 --> -0.348314).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.7946137
	speed: 0.1147s/iter; left time: 1489.7801s
Epoch: 16 cost time: 4.403884172439575
Epoch: 16, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.337 Vali Acc: 0.348 Test Loss: 2.337 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.2435104
	speed: 0.1125s/iter; left time: 1443.9502s
Epoch: 17 cost time: 4.358520030975342
Epoch: 17, Steps: 154 | Train Loss: 1.605 Vali Loss: 2.363 Vali Acc: 0.350 Test Loss: 2.363 Test Acc: 0.350
Validation loss decreased (-0.348314 --> -0.349936).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6087122
	speed: 0.1144s/iter; left time: 1451.0427s
Epoch: 18 cost time: 4.537028551101685
Epoch: 18, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.329 Vali Acc: 0.352 Test Loss: 2.329 Test Acc: 0.352
Validation loss decreased (-0.349936 --> -0.352369).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.5444365
	speed: 0.1097s/iter; left time: 1374.7870s
Epoch: 19 cost time: 4.247786998748779
Epoch: 19, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.390 Vali Acc: 0.360 Test Loss: 2.390 Test Acc: 0.360
Validation loss decreased (-0.352369 --> -0.359668).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.1913335
	speed: 0.1138s/iter; left time: 1408.7456s
Epoch: 20 cost time: 4.436630964279175
Epoch: 20, Steps: 154 | Train Loss: 1.557 Vali Loss: 2.429 Vali Acc: 0.356 Test Loss: 2.429 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.7945298
	speed: 0.1135s/iter; left time: 1386.6241s
Epoch: 21 cost time: 4.281099081039429
Epoch: 21, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.592 Vali Acc: 0.364 Test Loss: 2.592 Test Acc: 0.364
Validation loss decreased (-0.359668 --> -0.363721).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.6939955
	speed: 0.1070s/iter; left time: 1291.4204s
Epoch: 22 cost time: 4.525266885757446
Epoch: 22, Steps: 154 | Train Loss: 1.511 Vali Loss: 2.408 Vali Acc: 0.358 Test Loss: 2.408 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.7375238
	speed: 0.1210s/iter; left time: 1441.8409s
Epoch: 23 cost time: 4.433401107788086
Epoch: 23, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.505 Vali Acc: 0.363 Test Loss: 2.505 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.6850598
	speed: 0.1135s/iter; left time: 1334.1701s
Epoch: 24 cost time: 4.61529016494751
Epoch: 24, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.501 Vali Acc: 0.363 Test Loss: 2.501 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.4903258
	speed: 0.1168s/iter; left time: 1355.2112s
Epoch: 25 cost time: 4.45884370803833
Epoch: 25, Steps: 154 | Train Loss: 1.466 Vali Loss: 2.421 Vali Acc: 0.364 Test Loss: 2.421 Test Acc: 0.364
Validation loss decreased (-0.363721 --> -0.364128).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.8802834
	speed: 0.1164s/iter; left time: 1333.3106s
Epoch: 26 cost time: 4.512178421020508
Epoch: 26, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.561 Vali Acc: 0.370 Test Loss: 2.561 Test Acc: 0.370
Validation loss decreased (-0.364128 --> -0.370210).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.2339785
	speed: 0.1132s/iter; left time: 1278.4120s
Epoch: 27 cost time: 4.442035913467407
Epoch: 27, Steps: 154 | Train Loss: 1.648 Vali Loss: 2.674 Vali Acc: 0.358 Test Loss: 2.674 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.7307642
	speed: 0.1136s/iter; left time: 1266.0914s
Epoch: 28 cost time: 4.653376340866089
Epoch: 28, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.659 Vali Acc: 0.367 Test Loss: 2.659 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.1922239
	speed: 0.1135s/iter; left time: 1246.7396s
Epoch: 29 cost time: 4.390973091125488
Epoch: 29, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.862 Vali Acc: 0.374 Test Loss: 2.862 Test Acc: 0.374
Validation loss decreased (-0.370210 --> -0.374262).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.5389931
	speed: 0.1114s/iter; left time: 1207.2006s
Epoch: 30 cost time: 4.5538170337677
Epoch: 30, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.734 Vali Acc: 0.369 Test Loss: 2.734 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.3603168
	speed: 0.1076s/iter; left time: 1149.3638s
Epoch: 31 cost time: 4.2558372020721436
Epoch: 31, Steps: 154 | Train Loss: 1.402 Vali Loss: 2.818 Vali Acc: 0.375 Test Loss: 2.818 Test Acc: 0.375
Validation loss decreased (-0.374262 --> -0.374668).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.5729975
	speed: 0.1136s/iter; left time: 1195.8210s
Epoch: 32 cost time: 4.168424606323242
Epoch: 32, Steps: 154 | Train Loss: 1.405 Vali Loss: 3.189 Vali Acc: 0.373 Test Loss: 3.189 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.7974172
	speed: 0.1039s/iter; left time: 1077.2576s
Epoch: 33 cost time: 3.8528945446014404
Epoch: 33, Steps: 154 | Train Loss: 1.303 Vali Loss: 2.743 Vali Acc: 0.374 Test Loss: 2.743 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 2.8052371
	speed: 0.0998s/iter; left time: 1020.2275s
Epoch: 34 cost time: 3.981464147567749
Epoch: 34, Steps: 154 | Train Loss: 1.295 Vali Loss: 2.872 Vali Acc: 0.380 Test Loss: 2.872 Test Acc: 0.380
Validation loss decreased (-0.374668 --> -0.379533).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.3358880
	speed: 0.1039s/iter; left time: 1045.8474s
Epoch: 35 cost time: 4.1723244190216064
Epoch: 35, Steps: 154 | Train Loss: 1.392 Vali Loss: 2.940 Vali Acc: 0.373 Test Loss: 2.940 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 1.7132068
	speed: 0.1066s/iter; left time: 1056.4803s
Epoch: 36 cost time: 4.047656536102295
Epoch: 36, Steps: 154 | Train Loss: 1.437 Vali Loss: 3.059 Vali Acc: 0.365 Test Loss: 3.059 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 1.2283236
	speed: 0.1112s/iter; left time: 1085.0007s
Epoch: 37 cost time: 4.147599697113037
Epoch: 37, Steps: 154 | Train Loss: 1.610 Vali Loss: 3.100 Vali Acc: 0.367 Test Loss: 3.100 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.8617294
	speed: 0.1009s/iter; left time: 968.7454s
Epoch: 38 cost time: 4.000206708908081
Epoch: 38, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.330 Vali Acc: 0.376 Test Loss: 3.330 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 1.3394569
	speed: 0.1067s/iter; left time: 1007.7528s
Epoch: 39 cost time: 4.1979660987854
Epoch: 39, Steps: 154 | Train Loss: 1.436 Vali Loss: 3.164 Vali Acc: 0.368 Test Loss: 3.164 Test Acc: 0.368
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.7696347
	speed: 0.1135s/iter; left time: 1054.5804s
Epoch: 40 cost time: 4.283681869506836
Epoch: 40, Steps: 154 | Train Loss: 1.358 Vali Loss: 2.956 Vali Acc: 0.369 Test Loss: 2.956 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 1.0182446
	speed: 0.1055s/iter; left time: 964.1135s
Epoch: 41 cost time: 4.235403776168823
Epoch: 41, Steps: 154 | Train Loss: 1.277 Vali Loss: 3.044 Vali Acc: 0.326 Test Loss: 3.044 Test Acc: 0.326
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 1.3075176
	speed: 0.1128s/iter; left time: 1013.4826s
Epoch: 42 cost time: 4.245321989059448
Epoch: 42, Steps: 154 | Train Loss: 1.292 Vali Loss: 3.212 Vali Acc: 0.279 Test Loss: 3.212 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 1.2350757
	speed: 0.1120s/iter; left time: 989.5941s
Epoch: 43 cost time: 4.371147155761719
Epoch: 43, Steps: 154 | Train Loss: 1.296 Vali Loss: 3.006 Vali Acc: 0.376 Test Loss: 3.006 Test Acc: 0.376
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.9942409
	speed: 0.1097s/iter; left time: 952.3992s
Epoch: 44 cost time: 4.251720666885376
Epoch: 44, Steps: 154 | Train Loss: 1.386 Vali Loss: 3.388 Vali Acc: 0.379 Test Loss: 3.388 Test Acc: 0.379
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3795620437956204
model parameter : 75958
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0921760
	speed: 0.0440s/iter; left time: 672.8971s
Epoch: 1 cost time: 5.818016767501831
Epoch: 1, Steps: 154 | Train Loss: 2.251 Vali Loss: 2.150 Vali Acc: 0.318 Test Loss: 2.150 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3866978
	speed: 0.1110s/iter; left time: 1680.9637s
Epoch: 2 cost time: 4.380533695220947
Epoch: 2, Steps: 154 | Train Loss: 2.042 Vali Loss: 2.178 Vali Acc: 0.320 Test Loss: 2.178 Test Acc: 0.320
Validation loss decreased (-0.317902 --> -0.319930).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9434148
	speed: 0.1055s/iter; left time: 1582.3581s
Epoch: 3 cost time: 4.151610851287842
Epoch: 3, Steps: 154 | Train Loss: 2.021 Vali Loss: 2.128 Vali Acc: 0.320 Test Loss: 2.128 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.6149616
	speed: 0.1075s/iter; left time: 1595.5013s
Epoch: 4 cost time: 4.133481502532959
Epoch: 4, Steps: 154 | Train Loss: 1.974 Vali Loss: 2.146 Vali Acc: 0.321 Test Loss: 2.146 Test Acc: 0.321
Validation loss decreased (-0.319930 --> -0.321146).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9482659
	speed: 0.1050s/iter; left time: 1542.5707s
Epoch: 5 cost time: 4.125286340713501
Epoch: 5, Steps: 154 | Train Loss: 1.933 Vali Loss: 2.145 Vali Acc: 0.323 Test Loss: 2.145 Test Acc: 0.323
Validation loss decreased (-0.321146 --> -0.323174).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8020033
	speed: 0.1084s/iter; left time: 1575.6972s
Epoch: 6 cost time: 4.179143190383911
Epoch: 6, Steps: 154 | Train Loss: 1.899 Vali Loss: 2.115 Vali Acc: 0.330 Test Loss: 2.115 Test Acc: 0.330
Validation loss decreased (-0.323174 --> -0.330068).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4600879
	speed: 0.1091s/iter; left time: 1568.9255s
Epoch: 7 cost time: 3.973055601119995
Epoch: 7, Steps: 154 | Train Loss: 1.870 Vali Loss: 2.122 Vali Acc: 0.332 Test Loss: 2.122 Test Acc: 0.332
Validation loss decreased (-0.330068 --> -0.332096).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8515793
	speed: 0.1067s/iter; left time: 1517.6059s
Epoch: 8 cost time: 4.417086601257324
Epoch: 8, Steps: 154 | Train Loss: 1.831 Vali Loss: 2.113 Vali Acc: 0.337 Test Loss: 2.113 Test Acc: 0.337
Validation loss decreased (-0.332096 --> -0.336556).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9433134
	speed: 0.1156s/iter; left time: 1625.6796s
Epoch: 9 cost time: 4.249493837356567
Epoch: 9, Steps: 154 | Train Loss: 1.796 Vali Loss: 2.128 Vali Acc: 0.339 Test Loss: 2.128 Test Acc: 0.339
Validation loss decreased (-0.336556 --> -0.338584).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0763315
	speed: 0.1095s/iter; left time: 1523.9559s
Epoch: 10 cost time: 4.295520067214966
Epoch: 10, Steps: 154 | Train Loss: 1.769 Vali Loss: 2.167 Vali Acc: 0.336 Test Loss: 2.167 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.8700370
	speed: 0.1096s/iter; left time: 1507.9319s
Epoch: 11 cost time: 4.388381719589233
Epoch: 11, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.176 Vali Acc: 0.340 Test Loss: 2.176 Test Acc: 0.340
Validation loss decreased (-0.338584 --> -0.339800).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7210485
	speed: 0.1113s/iter; left time: 1513.9156s
Epoch: 12 cost time: 4.1153411865234375
Epoch: 12, Steps: 154 | Train Loss: 1.702 Vali Loss: 2.134 Vali Acc: 0.348 Test Loss: 2.134 Test Acc: 0.348
Validation loss decreased (-0.339800 --> -0.347911).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.9102631
	speed: 0.1126s/iter; left time: 1514.7490s
Epoch: 13 cost time: 4.536083936691284
Epoch: 13, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.156 Vali Acc: 0.348 Test Loss: 2.156 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.7256343
	speed: 0.1097s/iter; left time: 1458.9069s
Epoch: 14 cost time: 4.575904846191406
Epoch: 14, Steps: 154 | Train Loss: 1.721 Vali Loss: 2.298 Vali Acc: 0.341 Test Loss: 2.298 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.7915807
	speed: 0.1022s/iter; left time: 1343.9700s
Epoch: 15 cost time: 3.866549491882324
Epoch: 15, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.257 Vali Acc: 0.356 Test Loss: 2.257 Test Acc: 0.356
Validation loss decreased (-0.347911 --> -0.356425).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.7636915
	speed: 0.1115s/iter; left time: 1448.1132s
Epoch: 16 cost time: 4.610876083374023
Epoch: 16, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.258 Vali Acc: 0.350 Test Loss: 2.258 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.2392290
	speed: 0.1119s/iter; left time: 1436.6755s
Epoch: 17 cost time: 4.400175094604492
Epoch: 17, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.305 Vali Acc: 0.354 Test Loss: 2.305 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.5811014
	speed: 0.1183s/iter; left time: 1499.9326s
Epoch: 18 cost time: 4.3278656005859375
Epoch: 18, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.322 Vali Acc: 0.355 Test Loss: 2.322 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.5408849
	speed: 0.1145s/iter; left time: 1434.4132s
Epoch: 19 cost time: 4.542890787124634
Epoch: 19, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.266 Vali Acc: 0.365 Test Loss: 2.266 Test Acc: 0.365
Validation loss decreased (-0.356425 --> -0.364535).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.1483405
	speed: 0.1128s/iter; left time: 1395.5228s
Epoch: 20 cost time: 4.372464418411255
Epoch: 20, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.333 Vali Acc: 0.355 Test Loss: 2.333 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.8540297
	speed: 0.1126s/iter; left time: 1375.7322s
Epoch: 21 cost time: 4.339041471481323
Epoch: 21, Steps: 154 | Train Loss: 1.597 Vali Loss: 2.467 Vali Acc: 0.236 Test Loss: 2.467 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.7952172
	speed: 0.1134s/iter; left time: 1367.8911s
Epoch: 22 cost time: 4.56529688835144
Epoch: 22, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.366 Vali Acc: 0.359 Test Loss: 2.366 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.8394957
	speed: 0.1125s/iter; left time: 1339.7681s
Epoch: 23 cost time: 4.276846647262573
Epoch: 23, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.420 Vali Acc: 0.362 Test Loss: 2.420 Test Acc: 0.362
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.8600700
	speed: 0.1106s/iter; left time: 1301.0574s
Epoch: 24 cost time: 4.17214822769165
Epoch: 24, Steps: 154 | Train Loss: 1.479 Vali Loss: 2.431 Vali Acc: 0.367 Test Loss: 2.431 Test Acc: 0.367
Validation loss decreased (-0.364535 --> -0.366561).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.4014233
	speed: 0.1144s/iter; left time: 1327.5976s
Epoch: 25 cost time: 4.635280609130859
Epoch: 25, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.458 Vali Acc: 0.367 Test Loss: 2.458 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.2157397
	speed: 0.1121s/iter; left time: 1283.3239s
Epoch: 26 cost time: 4.0946455001831055
Epoch: 26, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.401 Vali Acc: 0.367 Test Loss: 2.401 Test Acc: 0.367
Validation loss decreased (-0.366561 --> -0.366562).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.3204726
	speed: 0.1132s/iter; left time: 1278.9104s
Epoch: 27 cost time: 4.24172043800354
Epoch: 27, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.470 Vali Acc: 0.363 Test Loss: 2.470 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.5355564
	speed: 0.1072s/iter; left time: 1194.4319s
Epoch: 28 cost time: 4.067991018295288
Epoch: 28, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.854 Vali Acc: 0.372 Test Loss: 2.854 Test Acc: 0.372
Validation loss decreased (-0.366562 --> -0.371829).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.3613667
	speed: 0.1097s/iter; left time: 1205.2865s
Epoch: 29 cost time: 4.314951658248901
Epoch: 29, Steps: 154 | Train Loss: 1.437 Vali Loss: 2.625 Vali Acc: 0.378 Test Loss: 2.625 Test Acc: 0.378
Validation loss decreased (-0.371829 --> -0.377508).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.6542737
	speed: 0.1180s/iter; left time: 1278.3097s
Epoch: 30 cost time: 4.400038480758667
Epoch: 30, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.605 Vali Acc: 0.369 Test Loss: 2.605 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.4098456
	speed: 0.1136s/iter; left time: 1213.2688s
Epoch: 31 cost time: 4.377197742462158
Epoch: 31, Steps: 154 | Train Loss: 1.401 Vali Loss: 2.608 Vali Acc: 0.367 Test Loss: 2.608 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.0699540
	speed: 0.1154s/iter; left time: 1215.0783s
Epoch: 32 cost time: 4.328483581542969
Epoch: 32, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.881 Vali Acc: 0.367 Test Loss: 2.881 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.8496874
	speed: 0.1153s/iter; left time: 1195.5884s
Epoch: 33 cost time: 4.478465557098389
Epoch: 33, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.955 Vali Acc: 0.367 Test Loss: 2.955 Test Acc: 0.367
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 1.7758312
	speed: 0.1088s/iter; left time: 1111.4046s
Epoch: 34 cost time: 4.448336601257324
Epoch: 34, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.763 Vali Acc: 0.381 Test Loss: 2.763 Test Acc: 0.381
Validation loss decreased (-0.377508 --> -0.380751).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.3184004
	speed: 0.1235s/iter; left time: 1242.5531s
Epoch: 35 cost time: 4.430616855621338
Epoch: 35, Steps: 154 | Train Loss: 1.330 Vali Loss: 2.680 Vali Acc: 0.373 Test Loss: 2.680 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 1.6644306
	speed: 0.1176s/iter; left time: 1165.8551s
Epoch: 36 cost time: 4.314890146255493
Epoch: 36, Steps: 154 | Train Loss: 1.424 Vali Loss: 2.723 Vali Acc: 0.371 Test Loss: 2.723 Test Acc: 0.371
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 1.1401584
	speed: 0.1100s/iter; left time: 1073.1195s
Epoch: 37 cost time: 4.2313737869262695
Epoch: 37, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.811 Vali Acc: 0.371 Test Loss: 2.811 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.8873967
	speed: 0.1146s/iter; left time: 1100.8252s
Epoch: 38 cost time: 4.494800090789795
Epoch: 38, Steps: 154 | Train Loss: 1.310 Vali Loss: 2.817 Vali Acc: 0.377 Test Loss: 2.817 Test Acc: 0.377
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 1.3826070
	speed: 0.1154s/iter; left time: 1090.7297s
Epoch: 39 cost time: 4.599047899246216
Epoch: 39, Steps: 154 | Train Loss: 1.314 Vali Loss: 2.844 Vali Acc: 0.371 Test Loss: 2.844 Test Acc: 0.371
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.6845295
	speed: 0.1137s/iter; left time: 1056.7220s
Epoch: 40 cost time: 4.42221736907959
Epoch: 40, Steps: 154 | Train Loss: 1.390 Vali Loss: 3.085 Vali Acc: 0.364 Test Loss: 3.085 Test Acc: 0.364
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.9665499
	speed: 0.1172s/iter; left time: 1071.4319s
Epoch: 41 cost time: 4.304417371749878
Epoch: 41, Steps: 154 | Train Loss: 1.230 Vali Loss: 2.819 Vali Acc: 0.381 Test Loss: 2.819 Test Acc: 0.381
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 1.0242037
	speed: 0.1098s/iter; left time: 986.5548s
Epoch: 42 cost time: 4.612236261367798
Epoch: 42, Steps: 154 | Train Loss: 1.417 Vali Loss: 3.002 Vali Acc: 0.301 Test Loss: 3.002 Test Acc: 0.301
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 1.2848387
	speed: 0.1097s/iter; left time: 969.2017s
Epoch: 43 cost time: 4.324281692504883
Epoch: 43, Steps: 154 | Train Loss: 1.356 Vali Loss: 3.122 Vali Acc: 0.376 Test Loss: 3.122 Test Acc: 0.376
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 1.0919393
	speed: 0.1154s/iter; left time: 1001.3025s
Epoch: 44 cost time: 4.496255874633789
Epoch: 44, Steps: 154 | Train Loss: 1.416 Vali Loss: 3.114 Vali Acc: 0.375 Test Loss: 3.114 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38077858880778587
model parameter : 75958
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9112667
	speed: 0.0462s/iter; left time: 707.4561s
Epoch: 1 cost time: 6.062929630279541
Epoch: 1, Steps: 154 | Train Loss: 2.234 Vali Loss: 2.166 Vali Acc: 0.321 Test Loss: 2.166 Test Acc: 0.321
Validation loss decreased (inf --> -0.321146).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8237425
	speed: 0.1164s/iter; left time: 1762.5270s
Epoch: 2 cost time: 4.415071249008179
Epoch: 2, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.128 Vali Acc: 0.322 Test Loss: 2.128 Test Acc: 0.322
Validation loss decreased (-0.321146 --> -0.321552).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9664671
	speed: 0.1162s/iter; left time: 1742.8861s
Epoch: 3 cost time: 5.032235622406006
Epoch: 3, Steps: 154 | Train Loss: 2.015 Vali Loss: 2.145 Vali Acc: 0.324 Test Loss: 2.145 Test Acc: 0.324
Validation loss decreased (-0.321552 --> -0.323985).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0005698
	speed: 0.1209s/iter; left time: 1794.5246s
Epoch: 4 cost time: 4.729206800460815
Epoch: 4, Steps: 154 | Train Loss: 1.949 Vali Loss: 2.132 Vali Acc: 0.323 Test Loss: 2.132 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4701810
	speed: 0.1190s/iter; left time: 1748.0142s
Epoch: 5 cost time: 4.543446063995361
Epoch: 5, Steps: 154 | Train Loss: 1.928 Vali Loss: 2.112 Vali Acc: 0.325 Test Loss: 2.112 Test Acc: 0.325
Validation loss decreased (-0.323985 --> -0.325202).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3259144
	speed: 0.1203s/iter; left time: 1747.8166s
Epoch: 6 cost time: 5.037217378616333
Epoch: 6, Steps: 154 | Train Loss: 1.875 Vali Loss: 2.115 Vali Acc: 0.327 Test Loss: 2.115 Test Acc: 0.327
Validation loss decreased (-0.325202 --> -0.326824).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6316042
	speed: 0.1169s/iter; left time: 1681.2023s
Epoch: 7 cost time: 4.65665340423584
Epoch: 7, Steps: 154 | Train Loss: 1.856 Vali Loss: 2.162 Vali Acc: 0.326 Test Loss: 2.162 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.1949441
	speed: 0.1176s/iter; left time: 1672.2778s
Epoch: 8 cost time: 4.365688800811768
Epoch: 8, Steps: 154 | Train Loss: 1.844 Vali Loss: 2.172 Vali Acc: 0.325 Test Loss: 2.172 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4863188
	speed: 0.1124s/iter; left time: 1580.9371s
Epoch: 9 cost time: 4.875153303146362
Epoch: 9, Steps: 154 | Train Loss: 1.793 Vali Loss: 2.148 Vali Acc: 0.329 Test Loss: 2.148 Test Acc: 0.329
Validation loss decreased (-0.326824 --> -0.328851).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6209441
	speed: 0.1136s/iter; left time: 1580.1479s
Epoch: 10 cost time: 4.214555740356445
Epoch: 10, Steps: 154 | Train Loss: 1.767 Vali Loss: 2.142 Vali Acc: 0.333 Test Loss: 2.142 Test Acc: 0.333
Validation loss decreased (-0.328851 --> -0.332906).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7269413
	speed: 0.1101s/iter; left time: 1515.0154s
Epoch: 11 cost time: 4.586861610412598
Epoch: 11, Steps: 154 | Train Loss: 1.765 Vali Loss: 2.154 Vali Acc: 0.337 Test Loss: 2.154 Test Acc: 0.337
Validation loss decreased (-0.332906 --> -0.336961).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4401236
	speed: 0.1149s/iter; left time: 1563.8240s
Epoch: 12 cost time: 4.754886627197266
Epoch: 12, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.160 Vali Acc: 0.336 Test Loss: 2.160 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5846579
	speed: 0.1157s/iter; left time: 1556.0430s
Epoch: 13 cost time: 4.26503586769104
Epoch: 13, Steps: 154 | Train Loss: 1.732 Vali Loss: 2.223 Vali Acc: 0.338 Test Loss: 2.223 Test Acc: 0.338
Validation loss decreased (-0.336961 --> -0.338177).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6369096
	speed: 0.1188s/iter; left time: 1579.6332s
Epoch: 14 cost time: 4.814516067504883
Epoch: 14, Steps: 154 | Train Loss: 1.658 Vali Loss: 2.210 Vali Acc: 0.333 Test Loss: 2.210 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.4900148
	speed: 0.1139s/iter; left time: 1496.8365s
Epoch: 15 cost time: 4.455984354019165
Epoch: 15, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.314 Vali Acc: 0.337 Test Loss: 2.314 Test Acc: 0.337
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.7315224
	speed: 0.1143s/iter; left time: 1485.3967s
Epoch: 16 cost time: 4.2822301387786865
Epoch: 16, Steps: 154 | Train Loss: 1.646 Vali Loss: 2.346 Vali Acc: 0.341 Test Loss: 2.346 Test Acc: 0.341
Validation loss decreased (-0.338177 --> -0.341015).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.3406063
	speed: 0.1098s/iter; left time: 1409.7211s
Epoch: 17 cost time: 4.467123031616211
Epoch: 17, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.330 Vali Acc: 0.348 Test Loss: 2.330 Test Acc: 0.348
Validation loss decreased (-0.341015 --> -0.347909).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.8786409
	speed: 0.1072s/iter; left time: 1359.6634s
Epoch: 18 cost time: 4.57697868347168
Epoch: 18, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.431 Vali Acc: 0.344 Test Loss: 2.431 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 2.3670094
	speed: 0.1251s/iter; left time: 1567.2544s
Epoch: 19 cost time: 4.669885873794556
Epoch: 19, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.384 Vali Acc: 0.353 Test Loss: 2.384 Test Acc: 0.353
Validation loss decreased (-0.347909 --> -0.353180).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.3080243
	speed: 0.1192s/iter; left time: 1474.5380s
Epoch: 20 cost time: 4.990992784500122
Epoch: 20, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.436 Vali Acc: 0.354 Test Loss: 2.436 Test Acc: 0.354
Validation loss decreased (-0.353180 --> -0.353585).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.2005962
	speed: 0.1165s/iter; left time: 1424.3297s
Epoch: 21 cost time: 4.827934503555298
Epoch: 21, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.427 Vali Acc: 0.351 Test Loss: 2.427 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.1731200
	speed: 0.1216s/iter; left time: 1467.6300s
Epoch: 22 cost time: 4.813517808914185
Epoch: 22, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.556 Vali Acc: 0.356 Test Loss: 2.556 Test Acc: 0.356
Validation loss decreased (-0.353585 --> -0.355611).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.5157262
	speed: 0.1213s/iter; left time: 1444.7740s
Epoch: 23 cost time: 4.826297998428345
Epoch: 23, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.495 Vali Acc: 0.348 Test Loss: 2.495 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.1634126
	speed: 0.1177s/iter; left time: 1383.7233s
Epoch: 24 cost time: 4.827508211135864
Epoch: 24, Steps: 154 | Train Loss: 1.571 Vali Loss: 2.626 Vali Acc: 0.368 Test Loss: 2.626 Test Acc: 0.368
Validation loss decreased (-0.355611 --> -0.367776).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.7794383
	speed: 0.1152s/iter; left time: 1337.2236s
Epoch: 25 cost time: 4.457406759262085
Epoch: 25, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.499 Vali Acc: 0.371 Test Loss: 2.499 Test Acc: 0.371
Validation loss decreased (-0.367776 --> -0.370616).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.1982832
	speed: 0.1133s/iter; left time: 1297.2709s
Epoch: 26 cost time: 4.656820297241211
Epoch: 26, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.543 Vali Acc: 0.276 Test Loss: 2.543 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.4292494
	speed: 0.1101s/iter; left time: 1243.7208s
Epoch: 27 cost time: 4.112760782241821
Epoch: 27, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.500 Vali Acc: 0.369 Test Loss: 2.500 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.3940467
	speed: 0.1181s/iter; left time: 1316.1326s
Epoch: 28 cost time: 4.324735641479492
Epoch: 28, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.648 Vali Acc: 0.360 Test Loss: 2.648 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.4482678
	speed: 0.1085s/iter; left time: 1192.7705s
Epoch: 29 cost time: 4.400061368942261
Epoch: 29, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.634 Vali Acc: 0.372 Test Loss: 2.634 Test Acc: 0.372
Validation loss decreased (-0.370616 --> -0.371831).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.3974012
	speed: 0.1146s/iter; left time: 1241.7177s
Epoch: 30 cost time: 4.37911057472229
Epoch: 30, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.873 Vali Acc: 0.222 Test Loss: 2.873 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.0962521
	speed: 0.1097s/iter; left time: 1171.5184s
Epoch: 31 cost time: 4.080276966094971
Epoch: 31, Steps: 154 | Train Loss: 1.393 Vali Loss: 2.724 Vali Acc: 0.367 Test Loss: 2.724 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.1223702
	speed: 0.1016s/iter; left time: 1069.0285s
Epoch: 32 cost time: 4.481555700302124
Epoch: 32, Steps: 154 | Train Loss: 1.397 Vali Loss: 2.741 Vali Acc: 0.370 Test Loss: 2.741 Test Acc: 0.370
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 1.0935601
	speed: 0.1140s/iter; left time: 1182.6457s
Epoch: 33 cost time: 4.391878843307495
Epoch: 33, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.755 Vali Acc: 0.369 Test Loss: 2.755 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 1.0034940
	speed: 0.1180s/iter; left time: 1205.5342s
Epoch: 34 cost time: 4.487706184387207
Epoch: 34, Steps: 154 | Train Loss: 1.310 Vali Loss: 2.763 Vali Acc: 0.377 Test Loss: 2.763 Test Acc: 0.377
Validation loss decreased (-0.371831 --> -0.376696).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.2734432
	speed: 0.1110s/iter; left time: 1117.0584s
Epoch: 35 cost time: 4.608401775360107
Epoch: 35, Steps: 154 | Train Loss: 1.293 Vali Loss: 2.909 Vali Acc: 0.369 Test Loss: 2.909 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 1.5437905
	speed: 0.1249s/iter; left time: 1237.6639s
Epoch: 36 cost time: 4.445898771286011
Epoch: 36, Steps: 154 | Train Loss: 1.402 Vali Loss: 3.043 Vali Acc: 0.377 Test Loss: 3.043 Test Acc: 0.377
Validation loss decreased (-0.376696 --> -0.377099).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.8644972
	speed: 0.1297s/iter; left time: 1265.5695s
Epoch: 37 cost time: 4.8626909255981445
Epoch: 37, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.996 Vali Acc: 0.217 Test Loss: 2.996 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.9833217
	speed: 0.1161s/iter; left time: 1115.2258s
Epoch: 38 cost time: 4.693377256393433
Epoch: 38, Steps: 154 | Train Loss: 1.510 Vali Loss: 3.053 Vali Acc: 0.374 Test Loss: 3.053 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.4465770
	speed: 0.1173s/iter; left time: 1108.7183s
Epoch: 39 cost time: 4.687201738357544
Epoch: 39, Steps: 154 | Train Loss: 1.330 Vali Loss: 3.354 Vali Acc: 0.363 Test Loss: 3.354 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 1.1329324
	speed: 0.1172s/iter; left time: 1089.6608s
Epoch: 40 cost time: 4.546786546707153
Epoch: 40, Steps: 154 | Train Loss: 1.328 Vali Loss: 3.266 Vali Acc: 0.376 Test Loss: 3.266 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 1.0479705
	speed: 0.1190s/iter; left time: 1087.8824s
Epoch: 41 cost time: 5.056072235107422
Epoch: 41, Steps: 154 | Train Loss: 1.294 Vali Loss: 3.321 Vali Acc: 0.361 Test Loss: 3.321 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.9293404
	speed: 0.1179s/iter; left time: 1059.8689s
Epoch: 42 cost time: 4.396057605743408
Epoch: 42, Steps: 154 | Train Loss: 1.259 Vali Loss: 3.374 Vali Acc: 0.375 Test Loss: 3.374 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 1.2879963
	speed: 0.1153s/iter; left time: 1018.0972s
Epoch: 43 cost time: 4.497570276260376
Epoch: 43, Steps: 154 | Train Loss: 1.361 Vali Loss: 3.754 Vali Acc: 0.218 Test Loss: 3.754 Test Acc: 0.218
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.8854854
	speed: 0.1152s/iter; left time: 999.6619s
Epoch: 44 cost time: 4.729895353317261
Epoch: 44, Steps: 154 | Train Loss: 1.284 Vali Loss: 3.472 Vali Acc: 0.377 Test Loss: 3.472 Test Acc: 0.377
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 1.2021315
	speed: 0.1137s/iter; left time: 969.1307s
Epoch: 45 cost time: 4.2941813468933105
Epoch: 45, Steps: 154 | Train Loss: 1.358 Vali Loss: 3.431 Vali Acc: 0.373 Test Loss: 3.431 Test Acc: 0.373
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 0.8775173
	speed: 0.1133s/iter; left time: 948.4224s
Epoch: 46 cost time: 4.460890531539917
Epoch: 46, Steps: 154 | Train Loss: 1.331 Vali Loss: 3.012 Vali Acc: 0.355 Test Loss: 3.012 Test Acc: 0.355
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3771289537712895
model parameter : 59574
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9443879
	speed: 0.0457s/iter; left time: 699.8381s
Epoch: 1 cost time: 6.158004522323608
Epoch: 1, Steps: 154 | Train Loss: 2.234 Vali Loss: 2.169 Vali Acc: 0.321 Test Loss: 2.169 Test Acc: 0.321
Validation loss decreased (inf --> -0.321146).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8213971
	speed: 0.1174s/iter; left time: 1777.8323s
Epoch: 2 cost time: 4.65807843208313
Epoch: 2, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.130 Vali Acc: 0.321 Test Loss: 2.130 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9514865
	speed: 0.1195s/iter; left time: 1792.3971s
Epoch: 3 cost time: 4.506859302520752
Epoch: 3, Steps: 154 | Train Loss: 2.015 Vali Loss: 2.148 Vali Acc: 0.324 Test Loss: 2.148 Test Acc: 0.324
Validation loss decreased (-0.321146 --> -0.323579).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9988203
	speed: 0.1150s/iter; left time: 1706.8838s
Epoch: 4 cost time: 4.676422595977783
Epoch: 4, Steps: 154 | Train Loss: 1.958 Vali Loss: 2.131 Vali Acc: 0.326 Test Loss: 2.131 Test Acc: 0.326
Validation loss decreased (-0.323579 --> -0.325607).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3660591
	speed: 0.1086s/iter; left time: 1595.2108s
Epoch: 5 cost time: 4.181782245635986
Epoch: 5, Steps: 154 | Train Loss: 1.932 Vali Loss: 2.116 Vali Acc: 0.324 Test Loss: 2.116 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.2997606
	speed: 0.1200s/iter; left time: 1744.0138s
Epoch: 6 cost time: 4.767422199249268
Epoch: 6, Steps: 154 | Train Loss: 1.872 Vali Loss: 2.118 Vali Acc: 0.328 Test Loss: 2.118 Test Acc: 0.328
Validation loss decreased (-0.325607 --> -0.328040).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6327137
	speed: 0.1157s/iter; left time: 1663.7512s
Epoch: 7 cost time: 4.651610612869263
Epoch: 7, Steps: 154 | Train Loss: 1.865 Vali Loss: 2.173 Vali Acc: 0.326 Test Loss: 2.173 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2246153
	speed: 0.1187s/iter; left time: 1687.7480s
Epoch: 8 cost time: 4.458903551101685
Epoch: 8, Steps: 154 | Train Loss: 1.833 Vali Loss: 2.146 Vali Acc: 0.327 Test Loss: 2.146 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4320699
	speed: 0.1167s/iter; left time: 1642.3336s
Epoch: 9 cost time: 4.7612738609313965
Epoch: 9, Steps: 154 | Train Loss: 1.812 Vali Loss: 2.157 Vali Acc: 0.330 Test Loss: 2.157 Test Acc: 0.330
Validation loss decreased (-0.328040 --> -0.329662).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6246467
	speed: 0.1168s/iter; left time: 1625.6845s
Epoch: 10 cost time: 5.020699977874756
Epoch: 10, Steps: 154 | Train Loss: 1.757 Vali Loss: 2.147 Vali Acc: 0.333 Test Loss: 2.147 Test Acc: 0.333
Validation loss decreased (-0.329662 --> -0.332906).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7230386
	speed: 0.1180s/iter; left time: 1623.8879s
Epoch: 11 cost time: 4.446274042129517
Epoch: 11, Steps: 154 | Train Loss: 1.749 Vali Loss: 2.166 Vali Acc: 0.337 Test Loss: 2.166 Test Acc: 0.337
Validation loss decreased (-0.332906 --> -0.336961).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4393513
	speed: 0.1160s/iter; left time: 1578.1427s
Epoch: 12 cost time: 4.5046703815460205
Epoch: 12, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.173 Vali Acc: 0.337 Test Loss: 2.173 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5589545
	speed: 0.1148s/iter; left time: 1544.0211s
Epoch: 13 cost time: 4.647802352905273
Epoch: 13, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.207 Vali Acc: 0.337 Test Loss: 2.207 Test Acc: 0.337
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.6733476
	speed: 0.1118s/iter; left time: 1486.8020s
Epoch: 14 cost time: 4.327059745788574
Epoch: 14, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.246 Vali Acc: 0.338 Test Loss: 2.246 Test Acc: 0.338
Validation loss decreased (-0.336961 --> -0.337772).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4320524
	speed: 0.1184s/iter; left time: 1556.4834s
Epoch: 15 cost time: 4.33352518081665
Epoch: 15, Steps: 154 | Train Loss: 1.692 Vali Loss: 2.366 Vali Acc: 0.343 Test Loss: 2.366 Test Acc: 0.343
Validation loss decreased (-0.337772 --> -0.343448).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.6653454
	speed: 0.1129s/iter; left time: 1466.0703s
Epoch: 16 cost time: 4.528851509094238
Epoch: 16, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.372 Vali Acc: 0.343 Test Loss: 2.372 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.4312990
	speed: 0.1157s/iter; left time: 1485.3603s
Epoch: 17 cost time: 4.543694734573364
Epoch: 17, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.399 Vali Acc: 0.350 Test Loss: 2.399 Test Acc: 0.350
Validation loss decreased (-0.343448 --> -0.349935).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.1878257
	speed: 0.1176s/iter; left time: 1491.2726s
Epoch: 18 cost time: 4.383756637573242
Epoch: 18, Steps: 154 | Train Loss: 1.650 Vali Loss: 2.416 Vali Acc: 0.353 Test Loss: 2.416 Test Acc: 0.353
Validation loss decreased (-0.349935 --> -0.353179).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.2171745
	speed: 0.1126s/iter; left time: 1410.8686s
Epoch: 19 cost time: 4.705973148345947
Epoch: 19, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.368 Vali Acc: 0.357 Test Loss: 2.368 Test Acc: 0.357
Validation loss decreased (-0.353179 --> -0.356830).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.4742512
	speed: 0.1153s/iter; left time: 1426.2594s
Epoch: 20 cost time: 4.540579795837402
Epoch: 20, Steps: 154 | Train Loss: 1.648 Vali Loss: 2.517 Vali Acc: 0.355 Test Loss: 2.517 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.1754140
	speed: 0.1174s/iter; left time: 1435.1345s
Epoch: 21 cost time: 4.514999866485596
Epoch: 21, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.490 Vali Acc: 0.351 Test Loss: 2.490 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.0697263
	speed: 0.1177s/iter; left time: 1420.6797s
Epoch: 22 cost time: 4.964686632156372
Epoch: 22, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.614 Vali Acc: 0.356 Test Loss: 2.614 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.6355422
	speed: 0.1196s/iter; left time: 1425.2461s
Epoch: 23 cost time: 4.663177013397217
Epoch: 23, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.616 Vali Acc: 0.355 Test Loss: 2.616 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.1536967
	speed: 0.1229s/iter; left time: 1445.1223s
Epoch: 24 cost time: 4.307098150253296
Epoch: 24, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.524 Vali Acc: 0.364 Test Loss: 2.524 Test Acc: 0.364
Validation loss decreased (-0.356830 --> -0.364127).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.0122871
	speed: 0.1175s/iter; left time: 1363.6145s
Epoch: 25 cost time: 4.980005979537964
Epoch: 25, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.620 Vali Acc: 0.363 Test Loss: 2.620 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.1755563
	speed: 0.1159s/iter; left time: 1327.2897s
Epoch: 26 cost time: 4.428997755050659
Epoch: 26, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.675 Vali Acc: 0.235 Test Loss: 2.675 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.5135098
	speed: 0.1203s/iter; left time: 1359.2126s
Epoch: 27 cost time: 4.637462615966797
Epoch: 27, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.487 Vali Acc: 0.373 Test Loss: 2.487 Test Acc: 0.373
Validation loss decreased (-0.364127 --> -0.373454).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.4095852
	speed: 0.1163s/iter; left time: 1296.1665s
Epoch: 28 cost time: 4.638427257537842
Epoch: 28, Steps: 154 | Train Loss: 1.473 Vali Loss: 2.655 Vali Acc: 0.365 Test Loss: 2.655 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.2786394
	speed: 0.1172s/iter; left time: 1288.1204s
Epoch: 29 cost time: 4.789198875427246
Epoch: 29, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.652 Vali Acc: 0.369 Test Loss: 2.652 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 1.4097593
	speed: 0.1158s/iter; left time: 1254.8992s
Epoch: 30 cost time: 4.503431797027588
Epoch: 30, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.811 Vali Acc: 0.379 Test Loss: 2.811 Test Acc: 0.379
Validation loss decreased (-0.373454 --> -0.378723).  Saving model ...
	iters: 100, epoch: 31 | loss: 1.1462228
	speed: 0.1172s/iter; left time: 1251.4677s
Epoch: 31 cost time: 4.646889925003052
Epoch: 31, Steps: 154 | Train Loss: 1.379 Vali Loss: 2.711 Vali Acc: 0.369 Test Loss: 2.711 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 1.1728672
	speed: 0.1163s/iter; left time: 1223.7996s
Epoch: 32 cost time: 4.648877859115601
Epoch: 32, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.831 Vali Acc: 0.380 Test Loss: 2.831 Test Acc: 0.380
Validation loss decreased (-0.378723 --> -0.379939).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.0813944
	speed: 0.1125s/iter; left time: 1167.2716s
Epoch: 33 cost time: 4.22446084022522
Epoch: 33, Steps: 154 | Train Loss: 1.338 Vali Loss: 2.763 Vali Acc: 0.379 Test Loss: 2.763 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 4.3772097
	speed: 0.1149s/iter; left time: 1174.1509s
Epoch: 34 cost time: 4.411400556564331
Epoch: 34, Steps: 154 | Train Loss: 1.315 Vali Loss: 2.807 Vali Acc: 0.380 Test Loss: 2.807 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 1.1374472
	speed: 0.1127s/iter; left time: 1134.2440s
Epoch: 35 cost time: 4.310538053512573
Epoch: 35, Steps: 154 | Train Loss: 1.315 Vali Loss: 3.439 Vali Acc: 0.374 Test Loss: 3.439 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 1.4179209
	speed: 0.1129s/iter; left time: 1118.9641s
Epoch: 36 cost time: 4.187873601913452
Epoch: 36, Steps: 154 | Train Loss: 1.370 Vali Loss: 3.320 Vali Acc: 0.375 Test Loss: 3.320 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.8682262
	speed: 0.1102s/iter; left time: 1074.7401s
Epoch: 37 cost time: 4.241658449172974
Epoch: 37, Steps: 154 | Train Loss: 1.484 Vali Loss: 3.155 Vali Acc: 0.232 Test Loss: 3.155 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 1.0402673
	speed: 0.1005s/iter; left time: 964.6588s
Epoch: 38 cost time: 4.230066776275635
Epoch: 38, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.822 Vali Acc: 0.374 Test Loss: 2.822 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.6400971
	speed: 0.1148s/iter; left time: 1084.3102s
Epoch: 39 cost time: 4.536327362060547
Epoch: 39, Steps: 154 | Train Loss: 1.421 Vali Loss: 3.534 Vali Acc: 0.376 Test Loss: 3.534 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 1.1103857
	speed: 0.1127s/iter; left time: 1047.4531s
Epoch: 40 cost time: 4.465188264846802
Epoch: 40, Steps: 154 | Train Loss: 1.290 Vali Loss: 3.486 Vali Acc: 0.374 Test Loss: 3.486 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 1.0355343
	speed: 0.1140s/iter; left time: 1042.3581s
Epoch: 41 cost time: 4.61361289024353
Epoch: 41, Steps: 154 | Train Loss: 1.294 Vali Loss: 3.467 Vali Acc: 0.378 Test Loss: 3.467 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.8848948
	speed: 0.1163s/iter; left time: 1044.8123s
Epoch: 42 cost time: 4.505770921707153
Epoch: 42, Steps: 154 | Train Loss: 1.286 Vali Loss: 3.529 Vali Acc: 0.372 Test Loss: 3.529 Test Acc: 0.372
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 59574
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9270258
	speed: 0.0473s/iter; left time: 722.9992s
Epoch: 1 cost time: 6.41241717338562
Epoch: 1, Steps: 154 | Train Loss: 2.230 Vali Loss: 2.168 Vali Acc: 0.320 Test Loss: 2.168 Test Acc: 0.320
Validation loss decreased (inf --> -0.319524).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8228087
	speed: 0.1132s/iter; left time: 1714.4494s
Epoch: 2 cost time: 4.156447410583496
Epoch: 2, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.128 Vali Acc: 0.320 Test Loss: 2.128 Test Acc: 0.320
Validation loss decreased (-0.319524 --> -0.319525).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9709170
	speed: 0.1106s/iter; left time: 1657.9799s
Epoch: 3 cost time: 4.249177694320679
Epoch: 3, Steps: 154 | Train Loss: 2.022 Vali Loss: 2.142 Vali Acc: 0.323 Test Loss: 2.142 Test Acc: 0.323
Validation loss decreased (-0.319525 --> -0.322769).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0990920
	speed: 0.1127s/iter; left time: 1672.8129s
Epoch: 4 cost time: 4.431321144104004
Epoch: 4, Steps: 154 | Train Loss: 1.963 Vali Loss: 2.130 Vali Acc: 0.324 Test Loss: 2.130 Test Acc: 0.324
Validation loss decreased (-0.322769 --> -0.323580).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3793147
	speed: 0.1122s/iter; left time: 1647.0487s
Epoch: 5 cost time: 4.2513957023620605
Epoch: 5, Steps: 154 | Train Loss: 1.924 Vali Loss: 2.114 Vali Acc: 0.326 Test Loss: 2.114 Test Acc: 0.326
Validation loss decreased (-0.323580 --> -0.325607).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3388925
	speed: 0.1139s/iter; left time: 1654.8205s
Epoch: 6 cost time: 4.370416879653931
Epoch: 6, Steps: 154 | Train Loss: 1.882 Vali Loss: 2.106 Vali Acc: 0.327 Test Loss: 2.106 Test Acc: 0.327
Validation loss decreased (-0.325607 --> -0.327230).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6719695
	speed: 0.1126s/iter; left time: 1619.2334s
Epoch: 7 cost time: 4.518376350402832
Epoch: 7, Steps: 154 | Train Loss: 1.844 Vali Loss: 2.140 Vali Acc: 0.327 Test Loss: 2.140 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2686763
	speed: 0.1119s/iter; left time: 1591.7252s
Epoch: 8 cost time: 4.294360637664795
Epoch: 8, Steps: 154 | Train Loss: 1.820 Vali Loss: 2.141 Vali Acc: 0.329 Test Loss: 2.141 Test Acc: 0.329
Validation loss decreased (-0.327230 --> -0.328851).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4496142
	speed: 0.1134s/iter; left time: 1595.3164s
Epoch: 9 cost time: 4.234957218170166
Epoch: 9, Steps: 154 | Train Loss: 1.780 Vali Loss: 2.149 Vali Acc: 0.335 Test Loss: 2.149 Test Acc: 0.335
Validation loss decreased (-0.328851 --> -0.335339).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5960456
	speed: 0.1091s/iter; left time: 1518.1072s
Epoch: 10 cost time: 4.515816926956177
Epoch: 10, Steps: 154 | Train Loss: 1.783 Vali Loss: 2.118 Vali Acc: 0.337 Test Loss: 2.118 Test Acc: 0.337
Validation loss decreased (-0.335339 --> -0.337367).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7856253
	speed: 0.1107s/iter; left time: 1523.0392s
Epoch: 11 cost time: 4.327928304672241
Epoch: 11, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.157 Vali Acc: 0.338 Test Loss: 2.157 Test Acc: 0.338
Validation loss decreased (-0.337367 --> -0.338178).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4357247
	speed: 0.1106s/iter; left time: 1504.8362s
Epoch: 12 cost time: 4.362449884414673
Epoch: 12, Steps: 154 | Train Loss: 1.731 Vali Loss: 2.165 Vali Acc: 0.339 Test Loss: 2.165 Test Acc: 0.339
Validation loss decreased (-0.338178 --> -0.338583).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6072216
	speed: 0.1102s/iter; left time: 1482.3550s
Epoch: 13 cost time: 4.414423942565918
Epoch: 13, Steps: 154 | Train Loss: 1.691 Vali Loss: 2.240 Vali Acc: 0.339 Test Loss: 2.240 Test Acc: 0.339
Validation loss decreased (-0.338583 --> -0.339394).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6697416
	speed: 0.1130s/iter; left time: 1502.1365s
Epoch: 14 cost time: 4.426244735717773
Epoch: 14, Steps: 154 | Train Loss: 1.646 Vali Loss: 2.157 Vali Acc: 0.345 Test Loss: 2.157 Test Acc: 0.345
Validation loss decreased (-0.339394 --> -0.345072).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.5005343
	speed: 0.1135s/iter; left time: 1491.4707s
Epoch: 15 cost time: 4.425720930099487
Epoch: 15, Steps: 154 | Train Loss: 1.698 Vali Loss: 2.273 Vali Acc: 0.348 Test Loss: 2.273 Test Acc: 0.348
Validation loss decreased (-0.345072 --> -0.347504).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.8787265
	speed: 0.1130s/iter; left time: 1468.3169s
Epoch: 16 cost time: 4.441258430480957
Epoch: 16, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.330 Vali Acc: 0.346 Test Loss: 2.330 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.4601253
	speed: 0.1038s/iter; left time: 1332.5488s
Epoch: 17 cost time: 4.126292705535889
Epoch: 17, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.399 Vali Acc: 0.350 Test Loss: 2.399 Test Acc: 0.350
Validation loss decreased (-0.347504 --> -0.350341).  Saving model ...
	iters: 100, epoch: 18 | loss: 3.8039031
	speed: 0.1036s/iter; left time: 1313.6205s
Epoch: 18 cost time: 4.256798028945923
Epoch: 18, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.367 Vali Acc: 0.354 Test Loss: 2.367 Test Acc: 0.354
Validation loss decreased (-0.350341 --> -0.353585).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.3116677
	speed: 0.1080s/iter; left time: 1353.1535s
Epoch: 19 cost time: 4.415581464767456
Epoch: 19, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.340 Vali Acc: 0.358 Test Loss: 2.340 Test Acc: 0.358
Validation loss decreased (-0.353585 --> -0.357641).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.3026845
	speed: 0.1171s/iter; left time: 1449.2955s
Epoch: 20 cost time: 4.494098424911499
Epoch: 20, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.441 Vali Acc: 0.356 Test Loss: 2.441 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.2800990
	speed: 0.1154s/iter; left time: 1410.7076s
Epoch: 21 cost time: 4.020921468734741
Epoch: 21, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.449 Vali Acc: 0.352 Test Loss: 2.449 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.1313311
	speed: 0.1281s/iter; left time: 1545.7975s
Epoch: 22 cost time: 5.1177544593811035
Epoch: 22, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.721 Vali Acc: 0.356 Test Loss: 2.721 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.5342876
	speed: 0.0958s/iter; left time: 1141.0468s
Epoch: 23 cost time: 3.5895533561706543
Epoch: 23, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.480 Vali Acc: 0.359 Test Loss: 2.480 Test Acc: 0.359
Validation loss decreased (-0.357641 --> -0.359261).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.0288075
	speed: 0.0878s/iter; left time: 1032.6788s
Epoch: 24 cost time: 3.647355079650879
Epoch: 24, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.559 Vali Acc: 0.361 Test Loss: 2.559 Test Acc: 0.361
Validation loss decreased (-0.359261 --> -0.360883).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.9008978
	speed: 0.1105s/iter; left time: 1282.0205s
Epoch: 25 cost time: 4.431183099746704
Epoch: 25, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.519 Vali Acc: 0.369 Test Loss: 2.519 Test Acc: 0.369
Validation loss decreased (-0.360883 --> -0.369399).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.1212476
	speed: 0.1122s/iter; left time: 1284.3179s
Epoch: 26 cost time: 4.43709135055542
Epoch: 26, Steps: 154 | Train Loss: 1.458 Vali Loss: 2.479 Vali Acc: 0.368 Test Loss: 2.479 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.4332938
	speed: 0.1129s/iter; left time: 1275.7230s
Epoch: 27 cost time: 4.185754299163818
Epoch: 27, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.677 Vali Acc: 0.367 Test Loss: 2.677 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.5312630
	speed: 0.1102s/iter; left time: 1227.6792s
Epoch: 28 cost time: 4.35551905632019
Epoch: 28, Steps: 154 | Train Loss: 1.466 Vali Loss: 2.633 Vali Acc: 0.367 Test Loss: 2.633 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.4910038
	speed: 0.1095s/iter; left time: 1203.6157s
Epoch: 29 cost time: 4.5405800342559814
Epoch: 29, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.595 Vali Acc: 0.371 Test Loss: 2.595 Test Acc: 0.371
Validation loss decreased (-0.369399 --> -0.371020).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.5096422
	speed: 0.1089s/iter; left time: 1180.1115s
Epoch: 30 cost time: 4.1703901290893555
Epoch: 30, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.738 Vali Acc: 0.384 Test Loss: 2.738 Test Acc: 0.384
Validation loss decreased (-0.371020 --> -0.383590).  Saving model ...
	iters: 100, epoch: 31 | loss: 1.2704999
	speed: 0.1137s/iter; left time: 1213.9906s
Epoch: 31 cost time: 4.444546937942505
Epoch: 31, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.619 Vali Acc: 0.373 Test Loss: 2.619 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 1.2582425
	speed: 0.1088s/iter; left time: 1145.2351s
Epoch: 32 cost time: 4.402867555618286
Epoch: 32, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.692 Vali Acc: 0.371 Test Loss: 2.692 Test Acc: 0.371
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.9741837
	speed: 0.1135s/iter; left time: 1177.5685s
Epoch: 33 cost time: 4.308758735656738
Epoch: 33, Steps: 154 | Train Loss: 1.376 Vali Loss: 2.814 Vali Acc: 0.385 Test Loss: 2.814 Test Acc: 0.385
Validation loss decreased (-0.383590 --> -0.384806).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.0892893
	speed: 0.1081s/iter; left time: 1104.6319s
Epoch: 34 cost time: 4.456919431686401
Epoch: 34, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.850 Vali Acc: 0.378 Test Loss: 2.850 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 1.0894681
	speed: 0.1080s/iter; left time: 1086.7398s
Epoch: 35 cost time: 4.201706647872925
Epoch: 35, Steps: 154 | Train Loss: 1.436 Vali Loss: 3.074 Vali Acc: 0.317 Test Loss: 3.074 Test Acc: 0.317
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 1.2540797
	speed: 0.1149s/iter; left time: 1138.6255s
Epoch: 36 cost time: 4.390918016433716
Epoch: 36, Steps: 154 | Train Loss: 1.255 Vali Loss: 2.915 Vali Acc: 0.378 Test Loss: 2.915 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.9180213
	speed: 0.1140s/iter; left time: 1111.8628s
Epoch: 37 cost time: 4.595273017883301
Epoch: 37, Steps: 154 | Train Loss: 1.373 Vali Loss: 2.765 Vali Acc: 0.251 Test Loss: 2.765 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.8767062
	speed: 0.1130s/iter; left time: 1084.9980s
Epoch: 38 cost time: 4.642910480499268
Epoch: 38, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.750 Vali Acc: 0.377 Test Loss: 2.750 Test Acc: 0.377
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.7239821
	speed: 0.1110s/iter; left time: 1049.0422s
Epoch: 39 cost time: 4.0897743701934814
Epoch: 39, Steps: 154 | Train Loss: 1.355 Vali Loss: 2.746 Vali Acc: 0.372 Test Loss: 2.746 Test Acc: 0.372
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 1.1732645
	speed: 0.1189s/iter; left time: 1105.4893s
Epoch: 40 cost time: 4.530812501907349
Epoch: 40, Steps: 154 | Train Loss: 1.333 Vali Loss: 3.015 Vali Acc: 0.375 Test Loss: 3.015 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 0.9443285
	speed: 0.1131s/iter; left time: 1034.1264s
Epoch: 41 cost time: 4.348223447799683
Epoch: 41, Steps: 154 | Train Loss: 1.334 Vali Loss: 2.982 Vali Acc: 0.246 Test Loss: 2.982 Test Acc: 0.246
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 0.9167417
	speed: 0.1151s/iter; left time: 1034.8442s
Epoch: 42 cost time: 4.213484287261963
Epoch: 42, Steps: 154 | Train Loss: 1.245 Vali Loss: 3.616 Vali Acc: 0.373 Test Loss: 3.616 Test Acc: 0.373
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 43 | loss: 1.5333402
	speed: 0.1112s/iter; left time: 982.3729s
Epoch: 43 cost time: 4.277370452880859
Epoch: 43, Steps: 154 | Train Loss: 1.477 Vali Loss: 3.185 Vali Acc: 0.262 Test Loss: 3.185 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3848337388483374
model parameter : 59574
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9636313
	speed: 0.0434s/iter; left time: 664.7008s
Epoch: 1 cost time: 5.865588665008545
Epoch: 1, Steps: 154 | Train Loss: 2.208 Vali Loss: 2.162 Vali Acc: 0.320 Test Loss: 2.162 Test Acc: 0.320
Validation loss decreased (inf --> -0.319524).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8333435
	speed: 0.1092s/iter; left time: 1653.7764s
Epoch: 2 cost time: 4.138259649276733
Epoch: 2, Steps: 154 | Train Loss: 2.075 Vali Loss: 2.129 Vali Acc: 0.320 Test Loss: 2.129 Test Acc: 0.320
Validation loss decreased (-0.319524 --> -0.319930).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9953587
	speed: 0.1049s/iter; left time: 1573.0465s
Epoch: 3 cost time: 4.222033977508545
Epoch: 3, Steps: 154 | Train Loss: 2.012 Vali Loss: 2.142 Vali Acc: 0.322 Test Loss: 2.142 Test Acc: 0.322
Validation loss decreased (-0.319930 --> -0.321552).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0634453
	speed: 0.1038s/iter; left time: 1539.9211s
Epoch: 4 cost time: 3.9316771030426025
Epoch: 4, Steps: 154 | Train Loss: 1.965 Vali Loss: 2.128 Vali Acc: 0.322 Test Loss: 2.128 Test Acc: 0.322
Validation loss decreased (-0.321552 --> -0.322363).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3759397
	speed: 0.1040s/iter; left time: 1527.9219s
Epoch: 5 cost time: 4.152680397033691
Epoch: 5, Steps: 154 | Train Loss: 1.931 Vali Loss: 2.119 Vali Acc: 0.325 Test Loss: 2.119 Test Acc: 0.325
Validation loss decreased (-0.322363 --> -0.324796).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3156636
	speed: 0.1100s/iter; left time: 1598.4169s
Epoch: 6 cost time: 4.3711230754852295
Epoch: 6, Steps: 154 | Train Loss: 1.896 Vali Loss: 2.099 Vali Acc: 0.330 Test Loss: 2.099 Test Acc: 0.330
Validation loss decreased (-0.324796 --> -0.329663).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7217603
	speed: 0.1057s/iter; left time: 1519.6467s
Epoch: 7 cost time: 4.1157920360565186
Epoch: 7, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.126 Vali Acc: 0.329 Test Loss: 2.126 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2393665
	speed: 0.1087s/iter; left time: 1546.1191s
Epoch: 8 cost time: 4.191249847412109
Epoch: 8, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.156 Vali Acc: 0.335 Test Loss: 2.156 Test Acc: 0.335
Validation loss decreased (-0.329663 --> -0.335339).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4017298
	speed: 0.1062s/iter; left time: 1494.5253s
Epoch: 9 cost time: 4.3041346073150635
Epoch: 9, Steps: 154 | Train Loss: 1.799 Vali Loss: 2.160 Vali Acc: 0.336 Test Loss: 2.160 Test Acc: 0.336
Validation loss decreased (-0.335339 --> -0.336150).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6393765
	speed: 0.0996s/iter; left time: 1385.2689s
Epoch: 10 cost time: 4.002380609512329
Epoch: 10, Steps: 154 | Train Loss: 1.759 Vali Loss: 2.123 Vali Acc: 0.340 Test Loss: 2.123 Test Acc: 0.340
Validation loss decreased (-0.336150 --> -0.339800).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7311165
	speed: 0.1124s/iter; left time: 1547.0500s
Epoch: 11 cost time: 4.63051176071167
Epoch: 11, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.194 Vali Acc: 0.341 Test Loss: 2.194 Test Acc: 0.341
Validation loss decreased (-0.339800 --> -0.340611).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4717679
	speed: 0.1137s/iter; left time: 1546.7329s
Epoch: 12 cost time: 4.578794002532959
Epoch: 12, Steps: 154 | Train Loss: 1.729 Vali Loss: 2.188 Vali Acc: 0.339 Test Loss: 2.188 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5560727
	speed: 0.1157s/iter; left time: 1555.8910s
Epoch: 13 cost time: 4.3274009227752686
Epoch: 13, Steps: 154 | Train Loss: 1.665 Vali Loss: 2.238 Vali Acc: 0.339 Test Loss: 2.238 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.6491861
	speed: 0.1146s/iter; left time: 1523.7882s
Epoch: 14 cost time: 4.342254877090454
Epoch: 14, Steps: 154 | Train Loss: 1.687 Vali Loss: 2.168 Vali Acc: 0.344 Test Loss: 2.168 Test Acc: 0.344
Validation loss decreased (-0.340611 --> -0.343855).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4680932
	speed: 0.1109s/iter; left time: 1457.8394s
Epoch: 15 cost time: 4.388508558273315
Epoch: 15, Steps: 154 | Train Loss: 1.747 Vali Loss: 2.307 Vali Acc: 0.345 Test Loss: 2.307 Test Acc: 0.345
Validation loss decreased (-0.343855 --> -0.345070).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.7301396
	speed: 0.1125s/iter; left time: 1462.0154s
Epoch: 16 cost time: 4.095771074295044
Epoch: 16, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.323 Vali Acc: 0.345 Test Loss: 2.323 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.5926020
	speed: 0.1134s/iter; left time: 1456.1758s
Epoch: 17 cost time: 4.560791969299316
Epoch: 17, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.326 Vali Acc: 0.348 Test Loss: 2.326 Test Acc: 0.348
Validation loss decreased (-0.345070 --> -0.348314).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6169168
	speed: 0.1090s/iter; left time: 1382.1480s
Epoch: 18 cost time: 4.1627562046051025
Epoch: 18, Steps: 154 | Train Loss: 1.601 Vali Loss: 2.216 Vali Acc: 0.357 Test Loss: 2.216 Test Acc: 0.357
Validation loss decreased (-0.348314 --> -0.356831).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.0157962
	speed: 0.1097s/iter; left time: 1374.0222s
Epoch: 19 cost time: 4.190639495849609
Epoch: 19, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.297 Vali Acc: 0.354 Test Loss: 2.297 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.3383850
	speed: 0.1089s/iter; left time: 1348.0637s
Epoch: 20 cost time: 4.4045798778533936
Epoch: 20, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.379 Vali Acc: 0.354 Test Loss: 2.379 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.3631378
	speed: 0.1079s/iter; left time: 1318.7886s
Epoch: 21 cost time: 4.1667399406433105
Epoch: 21, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.433 Vali Acc: 0.352 Test Loss: 2.433 Test Acc: 0.352
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.1859338
	speed: 0.1088s/iter; left time: 1313.4676s
Epoch: 22 cost time: 4.215424060821533
Epoch: 22, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.481 Vali Acc: 0.354 Test Loss: 2.481 Test Acc: 0.354
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.6437905
	speed: 0.1117s/iter; left time: 1330.3382s
Epoch: 23 cost time: 4.663443565368652
Epoch: 23, Steps: 154 | Train Loss: 1.649 Vali Loss: 2.495 Vali Acc: 0.352 Test Loss: 2.495 Test Acc: 0.352
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.0239922
	speed: 0.1052s/iter; left time: 1237.6158s
Epoch: 24 cost time: 4.0743043422698975
Epoch: 24, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.377 Vali Acc: 0.363 Test Loss: 2.377 Test Acc: 0.363
Validation loss decreased (-0.356831 --> -0.363318).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.7625077
	speed: 0.1104s/iter; left time: 1281.1612s
Epoch: 25 cost time: 4.227221727371216
Epoch: 25, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.518 Vali Acc: 0.359 Test Loss: 2.518 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.1433747
	speed: 0.1134s/iter; left time: 1298.7969s
Epoch: 26 cost time: 4.753077983856201
Epoch: 26, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.472 Vali Acc: 0.370 Test Loss: 2.472 Test Acc: 0.370
Validation loss decreased (-0.363318 --> -0.369805).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.4257220
	speed: 0.1149s/iter; left time: 1298.4172s
Epoch: 27 cost time: 4.262779235839844
Epoch: 27, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.573 Vali Acc: 0.362 Test Loss: 2.573 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.5161108
	speed: 0.1101s/iter; left time: 1227.2154s
Epoch: 28 cost time: 4.395628929138184
Epoch: 28, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.670 Vali Acc: 0.362 Test Loss: 2.670 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.2733581
	speed: 0.1134s/iter; left time: 1246.4705s
Epoch: 29 cost time: 4.742441415786743
Epoch: 29, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.510 Vali Acc: 0.368 Test Loss: 2.510 Test Acc: 0.368
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.4828299
	speed: 0.1124s/iter; left time: 1217.9791s
Epoch: 30 cost time: 4.331005334854126
Epoch: 30, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.763 Vali Acc: 0.373 Test Loss: 2.763 Test Acc: 0.373
Validation loss decreased (-0.369805 --> -0.373046).  Saving model ...
	iters: 100, epoch: 31 | loss: 1.2932655
	speed: 0.1147s/iter; left time: 1225.4810s
Epoch: 31 cost time: 4.506600618362427
Epoch: 31, Steps: 154 | Train Loss: 1.415 Vali Loss: 2.665 Vali Acc: 0.371 Test Loss: 2.665 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 1.3224270
	speed: 0.1160s/iter; left time: 1221.4008s
Epoch: 32 cost time: 4.5202765464782715
Epoch: 32, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.908 Vali Acc: 0.374 Test Loss: 2.908 Test Acc: 0.374
Validation loss decreased (-0.373046 --> -0.374261).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.9082342
	speed: 0.1078s/iter; left time: 1118.3590s
Epoch: 33 cost time: 4.100059509277344
Epoch: 33, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.680 Vali Acc: 0.376 Test Loss: 2.680 Test Acc: 0.376
Validation loss decreased (-0.374261 --> -0.376291).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.1953570
	speed: 0.1141s/iter; left time: 1165.4860s
Epoch: 34 cost time: 4.301873207092285
Epoch: 34, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.611 Vali Acc: 0.376 Test Loss: 2.611 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 1.0457245
	speed: 0.1128s/iter; left time: 1135.6538s
Epoch: 35 cost time: 4.284063100814819
Epoch: 35, Steps: 154 | Train Loss: 1.345 Vali Loss: 2.759 Vali Acc: 0.376 Test Loss: 2.759 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 1.5701686
	speed: 0.1104s/iter; left time: 1094.3722s
Epoch: 36 cost time: 4.182112693786621
Epoch: 36, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.829 Vali Acc: 0.371 Test Loss: 2.829 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.8500154
	speed: 0.1139s/iter; left time: 1110.8527s
Epoch: 37 cost time: 4.23734712600708
Epoch: 37, Steps: 154 | Train Loss: 1.371 Vali Loss: 2.705 Vali Acc: 0.381 Test Loss: 2.705 Test Acc: 0.381
Validation loss decreased (-0.376291 --> -0.380752).  Saving model ...
	iters: 100, epoch: 38 | loss: 1.0009824
	speed: 0.1081s/iter; left time: 1037.9279s
Epoch: 38 cost time: 4.41924262046814
Epoch: 38, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.657 Vali Acc: 0.373 Test Loss: 2.657 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.5827218
	speed: 0.1100s/iter; left time: 1039.6468s
Epoch: 39 cost time: 4.3340065479278564
Epoch: 39, Steps: 154 | Train Loss: 1.332 Vali Loss: 2.836 Vali Acc: 0.372 Test Loss: 2.836 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 1.0779802
	speed: 0.1129s/iter; left time: 1049.6676s
Epoch: 40 cost time: 4.296849727630615
Epoch: 40, Steps: 154 | Train Loss: 1.273 Vali Loss: 3.052 Vali Acc: 0.376 Test Loss: 3.052 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 0.8960260
	speed: 0.1100s/iter; left time: 1005.5832s
Epoch: 41 cost time: 4.6091086864471436
Epoch: 41, Steps: 154 | Train Loss: 1.371 Vali Loss: 3.033 Vali Acc: 0.378 Test Loss: 3.033 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 42 | loss: 0.9235252
	speed: 0.1093s/iter; left time: 982.5157s
Epoch: 42 cost time: 4.274608850479126
Epoch: 42, Steps: 154 | Train Loss: 1.308 Vali Loss: 2.965 Vali Acc: 0.373 Test Loss: 2.965 Test Acc: 0.373
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 43 | loss: 1.3208362
	speed: 0.1131s/iter; left time: 999.1194s
Epoch: 43 cost time: 4.399549245834351
Epoch: 43, Steps: 154 | Train Loss: 1.254 Vali Loss: 3.064 Vali Acc: 0.384 Test Loss: 3.064 Test Acc: 0.384
Validation loss decreased (-0.380752 --> -0.383587).  Saving model ...
	iters: 100, epoch: 44 | loss: 0.9236498
	speed: 0.1152s/iter; left time: 999.6797s
Epoch: 44 cost time: 4.585870027542114
Epoch: 44, Steps: 154 | Train Loss: 1.361 Vali Loss: 3.048 Vali Acc: 0.369 Test Loss: 3.048 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 1.1451194
	speed: 0.1127s/iter; left time: 960.5552s
Epoch: 45 cost time: 4.482904672622681
Epoch: 45, Steps: 154 | Train Loss: 1.261 Vali Loss: 3.350 Vali Acc: 0.379 Test Loss: 3.350 Test Acc: 0.379
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 0.7071372
	speed: 0.1211s/iter; left time: 1013.6007s
Epoch: 46 cost time: 4.258596181869507
Epoch: 46, Steps: 154 | Train Loss: 1.295 Vali Loss: 3.383 Vali Acc: 0.376 Test Loss: 3.383 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 47 | loss: 1.7569691
	speed: 0.1102s/iter; left time: 905.5278s
Epoch: 47 cost time: 4.592342853546143
Epoch: 47, Steps: 154 | Train Loss: 1.335 Vali Loss: 3.116 Vali Acc: 0.382 Test Loss: 3.116 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 48 | loss: 1.4693409
	speed: 0.1132s/iter; left time: 912.4200s
Epoch: 48 cost time: 4.414381265640259
Epoch: 48, Steps: 154 | Train Loss: 1.295 Vali Loss: 2.915 Vali Acc: 0.385 Test Loss: 2.915 Test Acc: 0.385
Validation loss decreased (-0.383587 --> -0.385210).  Saving model ...
	iters: 100, epoch: 49 | loss: 0.6432140
	speed: 0.1186s/iter; left time: 937.7575s
Epoch: 49 cost time: 4.559192895889282
Epoch: 49, Steps: 154 | Train Loss: 1.343 Vali Loss: 3.295 Vali Acc: 0.385 Test Loss: 3.295 Test Acc: 0.385
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 50 | loss: 0.6399493
	speed: 0.1119s/iter; left time: 867.5149s
Epoch: 50 cost time: 4.462573289871216
Epoch: 50, Steps: 154 | Train Loss: 1.241 Vali Loss: 3.320 Vali Acc: 0.387 Test Loss: 3.320 Test Acc: 0.387
Validation loss decreased (-0.385210 --> -0.387234).  Saving model ...
	iters: 100, epoch: 51 | loss: 1.0912309
	speed: 0.1121s/iter; left time: 851.9981s
Epoch: 51 cost time: 4.365480184555054
Epoch: 51, Steps: 154 | Train Loss: 1.358 Vali Loss: 3.099 Vali Acc: 0.386 Test Loss: 3.099 Test Acc: 0.386
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 52 | loss: 1.0817631
	speed: 0.1141s/iter; left time: 849.3535s
Epoch: 52 cost time: 4.273239850997925
Epoch: 52, Steps: 154 | Train Loss: 1.097 Vali Loss: 3.312 Vali Acc: 0.379 Test Loss: 3.312 Test Acc: 0.379
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 53 | loss: 1.0875326
	speed: 0.1160s/iter; left time: 845.8481s
Epoch: 53 cost time: 4.670549392700195
Epoch: 53, Steps: 154 | Train Loss: 1.245 Vali Loss: 3.270 Vali Acc: 0.385 Test Loss: 3.270 Test Acc: 0.385
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 54 | loss: 1.3170851
	speed: 0.1085s/iter; left time: 774.4693s
Epoch: 54 cost time: 4.318010330200195
Epoch: 54, Steps: 154 | Train Loss: 1.217 Vali Loss: 3.335 Vali Acc: 0.390 Test Loss: 3.335 Test Acc: 0.390
Validation loss decreased (-0.387234 --> -0.389667).  Saving model ...
	iters: 100, epoch: 55 | loss: 1.0634769
	speed: 0.1099s/iter; left time: 767.9773s
Epoch: 55 cost time: 3.9850196838378906
Epoch: 55, Steps: 154 | Train Loss: 1.209 Vali Loss: 3.240 Vali Acc: 0.378 Test Loss: 3.240 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 56 | loss: 1.3769920
	speed: 0.0965s/iter; left time: 658.8555s
Epoch: 56 cost time: 3.792421579360962
Epoch: 56, Steps: 154 | Train Loss: 1.284 Vali Loss: 3.317 Vali Acc: 0.382 Test Loss: 3.317 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 57 | loss: 0.6448517
	speed: 0.1090s/iter; left time: 727.4834s
Epoch: 57 cost time: 4.317325592041016
Epoch: 57, Steps: 154 | Train Loss: 1.372 Vali Loss: 3.149 Vali Acc: 0.386 Test Loss: 3.149 Test Acc: 0.386
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 58 | loss: 1.1279658
	speed: 0.1081s/iter; left time: 705.2117s
Epoch: 58 cost time: 4.361410856246948
Epoch: 58, Steps: 154 | Train Loss: 1.512 Vali Loss: 3.414 Vali Acc: 0.382 Test Loss: 3.414 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 59 | loss: 1.0582082
	speed: 0.1064s/iter; left time: 677.6125s
Epoch: 59 cost time: 4.219115972518921
Epoch: 59, Steps: 154 | Train Loss: 1.060 Vali Loss: 3.385 Vali Acc: 0.382 Test Loss: 3.385 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 60 | loss: 5.7703829
	speed: 0.1097s/iter; left time: 681.7641s
Epoch: 60 cost time: 4.425434350967407
Epoch: 60, Steps: 154 | Train Loss: 1.053 Vali Loss: 3.755 Vali Acc: 0.261 Test Loss: 3.755 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 61 | loss: 0.7886978
	speed: 0.1122s/iter; left time: 680.1945s
Epoch: 61 cost time: 4.418961048126221
Epoch: 61, Steps: 154 | Train Loss: 1.209 Vali Loss: 3.613 Vali Acc: 0.386 Test Loss: 3.613 Test Acc: 0.386
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 62 | loss: 2.1185086
	speed: 0.1084s/iter; left time: 640.4689s
Epoch: 62 cost time: 4.522779226303101
Epoch: 62, Steps: 154 | Train Loss: 1.237 Vali Loss: 3.773 Vali Acc: 0.377 Test Loss: 3.773 Test Acc: 0.377
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 63 | loss: 1.1237242
	speed: 0.1174s/iter; left time: 675.2340s
Epoch: 63 cost time: 4.28619122505188
Epoch: 63, Steps: 154 | Train Loss: 1.100 Vali Loss: 3.572 Vali Acc: 0.369 Test Loss: 3.572 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 64 | loss: 0.8676128
	speed: 0.1069s/iter; left time: 598.3997s
Epoch: 64 cost time: 4.561506748199463
Epoch: 64, Steps: 154 | Train Loss: 1.251 Vali Loss: 3.298 Vali Acc: 0.390 Test Loss: 3.298 Test Acc: 0.390
Validation loss decreased (-0.389667 --> -0.389667).  Saving model ...
	iters: 100, epoch: 65 | loss: 0.6251413
	speed: 0.1120s/iter; left time: 609.7140s
Epoch: 65 cost time: 4.4038779735565186
Epoch: 65, Steps: 154 | Train Loss: 1.186 Vali Loss: 3.677 Vali Acc: 0.243 Test Loss: 3.677 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 66 | loss: 1.1608169
	speed: 0.1144s/iter; left time: 605.2068s
Epoch: 66 cost time: 4.365095853805542
Epoch: 66, Steps: 154 | Train Loss: 1.167 Vali Loss: 3.570 Vali Acc: 0.381 Test Loss: 3.570 Test Acc: 0.381
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 67 | loss: 1.3989596
	speed: 0.1065s/iter; left time: 547.2688s
Epoch: 67 cost time: 4.469543933868408
Epoch: 67, Steps: 154 | Train Loss: 1.141 Vali Loss: 3.779 Vali Acc: 0.377 Test Loss: 3.779 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 68 | loss: 1.0516489
	speed: 0.1098s/iter; left time: 546.9653s
Epoch: 68 cost time: 4.315755128860474
Epoch: 68, Steps: 154 | Train Loss: 1.045 Vali Loss: 3.631 Vali Acc: 0.386 Test Loss: 3.631 Test Acc: 0.386
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 69 | loss: 1.0262551
	speed: 0.1116s/iter; left time: 538.7383s
Epoch: 69 cost time: 4.2783262729644775
Epoch: 69, Steps: 154 | Train Loss: 1.143 Vali Loss: 3.889 Vali Acc: 0.371 Test Loss: 3.889 Test Acc: 0.371
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 70 | loss: 1.1850611
	speed: 0.1082s/iter; left time: 505.9765s
Epoch: 70 cost time: 4.434412002563477
Epoch: 70, Steps: 154 | Train Loss: 1.065 Vali Loss: 3.587 Vali Acc: 0.389 Test Loss: 3.587 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 71 | loss: 1.0571740
	speed: 0.1051s/iter; left time: 475.1479s
Epoch: 71 cost time: 4.103269100189209
Epoch: 71, Steps: 154 | Train Loss: 1.105 Vali Loss: 4.129 Vali Acc: 0.388 Test Loss: 4.129 Test Acc: 0.388
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 72 | loss: 0.6363103
	speed: 0.1075s/iter; left time: 469.4545s
Epoch: 72 cost time: 4.466672897338867
Epoch: 72, Steps: 154 | Train Loss: 1.305 Vali Loss: 3.788 Vali Acc: 0.391 Test Loss: 3.788 Test Acc: 0.391
Validation loss decreased (-0.389667 --> -0.390879).  Saving model ...
	iters: 100, epoch: 73 | loss: 0.6218597
	speed: 0.1125s/iter; left time: 474.1463s
Epoch: 73 cost time: 4.4381513595581055
Epoch: 73, Steps: 154 | Train Loss: 1.166 Vali Loss: 3.570 Vali Acc: 0.387 Test Loss: 3.570 Test Acc: 0.387
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 74 | loss: 1.6957357
	speed: 0.1107s/iter; left time: 449.3648s
Epoch: 74 cost time: 4.133191347122192
Epoch: 74, Steps: 154 | Train Loss: 1.316 Vali Loss: 3.763 Vali Acc: 0.393 Test Loss: 3.763 Test Acc: 0.393
Validation loss decreased (-0.390879 --> -0.392906).  Saving model ...
	iters: 100, epoch: 75 | loss: 0.7770342
	speed: 0.1105s/iter; left time: 431.5468s
Epoch: 75 cost time: 4.491401433944702
Epoch: 75, Steps: 154 | Train Loss: 1.089 Vali Loss: 3.730 Vali Acc: 0.388 Test Loss: 3.730 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 76 | loss: 1.3387128
	speed: 0.1126s/iter; left time: 422.4941s
Epoch: 76 cost time: 4.323272943496704
Epoch: 76, Steps: 154 | Train Loss: 1.158 Vali Loss: 3.700 Vali Acc: 0.386 Test Loss: 3.700 Test Acc: 0.386
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 77 | loss: 0.7162832
	speed: 0.1116s/iter; left time: 401.3806s
Epoch: 77 cost time: 4.365336656570435
Epoch: 77, Steps: 154 | Train Loss: 1.103 Vali Loss: 3.929 Vali Acc: 0.382 Test Loss: 3.929 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 78 | loss: 0.8684582
	speed: 0.1128s/iter; left time: 388.2771s
Epoch: 78 cost time: 4.7872161865234375
Epoch: 78, Steps: 154 | Train Loss: 1.153 Vali Loss: 4.180 Vali Acc: 0.382 Test Loss: 4.180 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 79 | loss: 0.6901799
	speed: 0.1145s/iter; left time: 376.5683s
Epoch: 79 cost time: 4.537664413452148
Epoch: 79, Steps: 154 | Train Loss: 1.389 Vali Loss: 3.691 Vali Acc: 0.395 Test Loss: 3.691 Test Acc: 0.395
Validation loss decreased (-0.392906 --> -0.394935).  Saving model ...
	iters: 100, epoch: 80 | loss: 0.9571491
	speed: 0.1133s/iter; left time: 355.3298s
Epoch: 80 cost time: 4.4445788860321045
Epoch: 80, Steps: 154 | Train Loss: 1.260 Vali Loss: 3.991 Vali Acc: 0.386 Test Loss: 3.991 Test Acc: 0.386
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 81 | loss: 0.7369332
	speed: 0.1145s/iter; left time: 341.2161s
Epoch: 81 cost time: 4.814890623092651
Epoch: 81, Steps: 154 | Train Loss: 1.128 Vali Loss: 3.787 Vali Acc: 0.395 Test Loss: 3.787 Test Acc: 0.395
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 82 | loss: 0.8483881
	speed: 0.1128s/iter; left time: 318.9261s
Epoch: 82 cost time: 4.396174192428589
Epoch: 82, Steps: 154 | Train Loss: 1.083 Vali Loss: 4.124 Vali Acc: 0.376 Test Loss: 4.124 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 83 | loss: 0.5634021
	speed: 0.1168s/iter; left time: 312.0846s
Epoch: 83 cost time: 4.350361347198486
Epoch: 83, Steps: 154 | Train Loss: 1.207 Vali Loss: 4.119 Vali Acc: 0.390 Test Loss: 4.119 Test Acc: 0.390
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 84 | loss: 0.8990169
	speed: 0.1133s/iter; left time: 285.4708s
Epoch: 84 cost time: 4.665146112442017
Epoch: 84, Steps: 154 | Train Loss: 1.192 Vali Loss: 4.118 Vali Acc: 0.283 Test Loss: 4.118 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 85 | loss: 0.7159869
	speed: 0.1114s/iter; left time: 263.5112s
Epoch: 85 cost time: 4.178902626037598
Epoch: 85, Steps: 154 | Train Loss: 1.011 Vali Loss: 4.135 Vali Acc: 0.392 Test Loss: 4.135 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 86 | loss: 1.0443438
	speed: 0.1069s/iter; left time: 236.2483s
Epoch: 86 cost time: 4.1911773681640625
Epoch: 86, Steps: 154 | Train Loss: 1.187 Vali Loss: 4.025 Vali Acc: 0.395 Test Loss: 4.025 Test Acc: 0.395
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 87 | loss: 0.7153256
	speed: 0.1087s/iter; left time: 223.6839s
Epoch: 87 cost time: 4.491769075393677
Epoch: 87, Steps: 154 | Train Loss: 1.185 Vali Loss: 4.478 Vali Acc: 0.388 Test Loss: 4.478 Test Acc: 0.388
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 88 | loss: 0.5887679
	speed: 0.1101s/iter; left time: 209.4857s
Epoch: 88 cost time: 4.231896877288818
Epoch: 88, Steps: 154 | Train Loss: 1.042 Vali Loss: 4.518 Vali Acc: 0.380 Test Loss: 4.518 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 89 | loss: 1.1272029
	speed: 0.1093s/iter; left time: 191.1990s
Epoch: 89 cost time: 4.302004098892212
Epoch: 89, Steps: 154 | Train Loss: 0.983 Vali Loss: 4.244 Vali Acc: 0.386 Test Loss: 4.244 Test Acc: 0.386
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39497161394971614
model parameter : 59574
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2170045
	speed: 0.0452s/iter; left time: 692.1408s
Epoch: 1 cost time: 6.079658508300781
Epoch: 1, Steps: 154 | Train Loss: 2.262 Vali Loss: 2.157 Vali Acc: 0.318 Test Loss: 2.157 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6581677
	speed: 0.1081s/iter; left time: 1637.6348s
Epoch: 2 cost time: 4.208567380905151
Epoch: 2, Steps: 154 | Train Loss: 2.068 Vali Loss: 2.140 Vali Acc: 0.321 Test Loss: 2.140 Test Acc: 0.321
Validation loss decreased (-0.317497 --> -0.320741).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0251784
	speed: 0.1176s/iter; left time: 1762.7710s
Epoch: 3 cost time: 4.378770351409912
Epoch: 3, Steps: 154 | Train Loss: 2.015 Vali Loss: 2.132 Vali Acc: 0.325 Test Loss: 2.132 Test Acc: 0.325
Validation loss decreased (-0.320741 --> -0.325202).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0291238
	speed: 0.1211s/iter; left time: 1797.6616s
Epoch: 4 cost time: 4.733736753463745
Epoch: 4, Steps: 154 | Train Loss: 1.948 Vali Loss: 2.150 Vali Acc: 0.324 Test Loss: 2.150 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5741165
	speed: 0.1183s/iter; left time: 1736.8429s
Epoch: 5 cost time: 4.535962343215942
Epoch: 5, Steps: 154 | Train Loss: 1.910 Vali Loss: 2.138 Vali Acc: 0.324 Test Loss: 2.138 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.7604378
	speed: 0.1198s/iter; left time: 1740.9726s
Epoch: 6 cost time: 4.673695802688599
Epoch: 6, Steps: 154 | Train Loss: 1.888 Vali Loss: 2.122 Vali Acc: 0.326 Test Loss: 2.122 Test Acc: 0.326
Validation loss decreased (-0.325202 --> -0.326418).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8568074
	speed: 0.1191s/iter; left time: 1711.7634s
Epoch: 7 cost time: 4.912679433822632
Epoch: 7, Steps: 154 | Train Loss: 1.876 Vali Loss: 2.151 Vali Acc: 0.326 Test Loss: 2.151 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9070888
	speed: 0.1167s/iter; left time: 1659.8058s
Epoch: 8 cost time: 4.807257652282715
Epoch: 8, Steps: 154 | Train Loss: 1.832 Vali Loss: 2.184 Vali Acc: 0.328 Test Loss: 2.184 Test Acc: 0.328
Validation loss decreased (-0.326418 --> -0.328040).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0176423
	speed: 0.1213s/iter; left time: 1706.4081s
Epoch: 9 cost time: 4.804703712463379
Epoch: 9, Steps: 154 | Train Loss: 1.797 Vali Loss: 2.182 Vali Acc: 0.327 Test Loss: 2.182 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5531173
	speed: 0.1145s/iter; left time: 1592.6905s
Epoch: 10 cost time: 4.472414016723633
Epoch: 10, Steps: 154 | Train Loss: 1.764 Vali Loss: 2.180 Vali Acc: 0.330 Test Loss: 2.180 Test Acc: 0.330
Validation loss decreased (-0.328040 --> -0.330473).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7229193
	speed: 0.1138s/iter; left time: 1565.3999s
Epoch: 11 cost time: 5.005730628967285
Epoch: 11, Steps: 154 | Train Loss: 1.740 Vali Loss: 2.217 Vali Acc: 0.333 Test Loss: 2.217 Test Acc: 0.333
Validation loss decreased (-0.330473 --> -0.332906).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.5421648
	speed: 0.1161s/iter; left time: 1579.8984s
Epoch: 12 cost time: 4.327575445175171
Epoch: 12, Steps: 154 | Train Loss: 1.721 Vali Loss: 2.198 Vali Acc: 0.336 Test Loss: 2.198 Test Acc: 0.336
Validation loss decreased (-0.332906 --> -0.335744).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1197311
	speed: 0.1131s/iter; left time: 1521.8003s
Epoch: 13 cost time: 4.529435873031616
Epoch: 13, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.258 Vali Acc: 0.338 Test Loss: 2.258 Test Acc: 0.338
Validation loss decreased (-0.335744 --> -0.337771).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5422425
	speed: 0.1154s/iter; left time: 1535.1123s
Epoch: 14 cost time: 4.661964178085327
Epoch: 14, Steps: 154 | Train Loss: 1.691 Vali Loss: 2.254 Vali Acc: 0.338 Test Loss: 2.254 Test Acc: 0.338
Validation loss decreased (-0.337771 --> -0.337771).  Saving model ...
	iters: 100, epoch: 15 | loss: 4.1108174
	speed: 0.1134s/iter; left time: 1490.6943s
Epoch: 15 cost time: 4.3717827796936035
Epoch: 15, Steps: 154 | Train Loss: 1.643 Vali Loss: 2.322 Vali Acc: 0.339 Test Loss: 2.322 Test Acc: 0.339
Validation loss decreased (-0.337771 --> -0.338582).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3472168
	speed: 0.1127s/iter; left time: 1464.3036s
Epoch: 16 cost time: 4.539421796798706
Epoch: 16, Steps: 154 | Train Loss: 1.677 Vali Loss: 2.363 Vali Acc: 0.345 Test Loss: 2.363 Test Acc: 0.345
Validation loss decreased (-0.338582 --> -0.344664).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.7348911
	speed: 0.1168s/iter; left time: 1499.1853s
Epoch: 17 cost time: 4.965918302536011
Epoch: 17, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.368 Vali Acc: 0.354 Test Loss: 2.368 Test Acc: 0.354
Validation loss decreased (-0.344664 --> -0.353585).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.0326524
	speed: 0.1134s/iter; left time: 1437.6270s
Epoch: 18 cost time: 4.451429605484009
Epoch: 18, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.328 Vali Acc: 0.360 Test Loss: 2.328 Test Acc: 0.360
Validation loss decreased (-0.353585 --> -0.359669).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.2029904
	speed: 0.1157s/iter; left time: 1449.6451s
Epoch: 19 cost time: 4.66540265083313
Epoch: 19, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.406 Vali Acc: 0.345 Test Loss: 2.406 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.6259974
	speed: 0.1135s/iter; left time: 1404.6689s
Epoch: 20 cost time: 4.5231239795684814
Epoch: 20, Steps: 154 | Train Loss: 1.635 Vali Loss: 2.499 Vali Acc: 0.343 Test Loss: 2.499 Test Acc: 0.343
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.3991722
	speed: 0.1072s/iter; left time: 1309.6431s
Epoch: 21 cost time: 4.221322536468506
Epoch: 21, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.638 Vali Acc: 0.352 Test Loss: 2.638 Test Acc: 0.352
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.5668281
	speed: 0.1167s/iter; left time: 1408.3272s
Epoch: 22 cost time: 4.71199893951416
Epoch: 22, Steps: 154 | Train Loss: 1.518 Vali Loss: 2.441 Vali Acc: 0.358 Test Loss: 2.441 Test Acc: 0.358
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.6624470
	speed: 0.1229s/iter; left time: 1464.6815s
Epoch: 23 cost time: 4.88614296913147
Epoch: 23, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.508 Vali Acc: 0.363 Test Loss: 2.508 Test Acc: 0.363
Validation loss decreased (-0.359669 --> -0.363316).  Saving model ...
	iters: 100, epoch: 24 | loss: 2.1815486
	speed: 0.1116s/iter; left time: 1311.9924s
Epoch: 24 cost time: 4.6763739585876465
Epoch: 24, Steps: 154 | Train Loss: 1.427 Vali Loss: 2.624 Vali Acc: 0.352 Test Loss: 2.624 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.3286903
	speed: 0.1193s/iter; left time: 1384.7476s
Epoch: 25 cost time: 4.820773363113403
Epoch: 25, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.618 Vali Acc: 0.376 Test Loss: 2.618 Test Acc: 0.376
Validation loss decreased (-0.363316 --> -0.375886).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.3537148
	speed: 0.1201s/iter; left time: 1375.8326s
Epoch: 26 cost time: 4.866775035858154
Epoch: 26, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.964 Vali Acc: 0.369 Test Loss: 2.964 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.2923030
	speed: 0.1107s/iter; left time: 1250.6211s
Epoch: 27 cost time: 4.527454614639282
Epoch: 27, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.800 Vali Acc: 0.362 Test Loss: 2.800 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.3703924
	speed: 0.1158s/iter; left time: 1290.5355s
Epoch: 28 cost time: 4.57299542427063
Epoch: 28, Steps: 154 | Train Loss: 1.402 Vali Loss: 2.768 Vali Acc: 0.376 Test Loss: 2.768 Test Acc: 0.376
Validation loss decreased (-0.375886 --> -0.376290).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.4492192
	speed: 0.1130s/iter; left time: 1241.5959s
Epoch: 29 cost time: 4.280715227127075
Epoch: 29, Steps: 154 | Train Loss: 1.367 Vali Loss: 2.642 Vali Acc: 0.372 Test Loss: 2.642 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.8100303
	speed: 0.1110s/iter; left time: 1202.6012s
Epoch: 30 cost time: 4.633975028991699
Epoch: 30, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.785 Vali Acc: 0.221 Test Loss: 2.785 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.4211755
	speed: 0.1156s/iter; left time: 1234.4007s
Epoch: 31 cost time: 4.386474370956421
Epoch: 31, Steps: 154 | Train Loss: 1.482 Vali Loss: 3.163 Vali Acc: 0.369 Test Loss: 3.163 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.6475022
	speed: 0.1140s/iter; left time: 1199.9180s
Epoch: 32 cost time: 4.544218063354492
Epoch: 32, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.106 Vali Acc: 0.375 Test Loss: 3.106 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 1.3511446
	speed: 0.1059s/iter; left time: 1098.7978s
Epoch: 33 cost time: 4.503713846206665
Epoch: 33, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.856 Vali Acc: 0.370 Test Loss: 2.856 Test Acc: 0.370
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 1.6891776
	speed: 0.1145s/iter; left time: 1169.9488s
Epoch: 34 cost time: 4.595342397689819
Epoch: 34, Steps: 154 | Train Loss: 1.340 Vali Loss: 3.183 Vali Acc: 0.206 Test Loss: 3.183 Test Acc: 0.206
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 1.1609089
	speed: 0.1128s/iter; left time: 1135.4541s
Epoch: 35 cost time: 4.459343194961548
Epoch: 35, Steps: 154 | Train Loss: 1.312 Vali Loss: 2.942 Vali Acc: 0.372 Test Loss: 2.942 Test Acc: 0.372
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 1.3185178
	speed: 0.1109s/iter; left time: 1099.0616s
Epoch: 36 cost time: 4.806500196456909
Epoch: 36, Steps: 154 | Train Loss: 1.382 Vali Loss: 3.157 Vali Acc: 0.372 Test Loss: 3.157 Test Acc: 0.372
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.7772314
	speed: 0.1162s/iter; left time: 1133.9175s
Epoch: 37 cost time: 4.727900505065918
Epoch: 37, Steps: 154 | Train Loss: 1.505 Vali Loss: 3.501 Vali Acc: 0.376 Test Loss: 3.501 Test Acc: 0.376
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 1.0680341
	speed: 0.1142s/iter; left time: 1097.0581s
Epoch: 38 cost time: 4.516944646835327
Epoch: 38, Steps: 154 | Train Loss: 1.337 Vali Loss: 3.128 Vali Acc: 0.380 Test Loss: 3.128 Test Acc: 0.380
Validation loss decreased (-0.376290 --> -0.379936).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.8229668
	speed: 0.1192s/iter; left time: 1126.4219s
Epoch: 39 cost time: 4.892009735107422
Epoch: 39, Steps: 154 | Train Loss: 1.327 Vali Loss: 3.249 Vali Acc: 0.370 Test Loss: 3.249 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 1.4174999
	speed: 0.1214s/iter; left time: 1128.2379s
Epoch: 40 cost time: 4.742221355438232
Epoch: 40, Steps: 154 | Train Loss: 1.308 Vali Loss: 3.567 Vali Acc: 0.202 Test Loss: 3.567 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 11.8036871
	speed: 0.1166s/iter; left time: 1065.5440s
Epoch: 41 cost time: 4.544993162155151
Epoch: 41, Steps: 154 | Train Loss: 1.402 Vali Loss: 3.242 Vali Acc: 0.382 Test Loss: 3.242 Test Acc: 0.382
Validation loss decreased (-0.379936 --> -0.381557).  Saving model ...
	iters: 100, epoch: 42 | loss: 0.9480816
	speed: 0.1134s/iter; left time: 1019.4770s
Epoch: 42 cost time: 4.871578693389893
Epoch: 42, Steps: 154 | Train Loss: 1.294 Vali Loss: 4.053 Vali Acc: 0.207 Test Loss: 4.053 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 0.8689277
	speed: 0.1169s/iter; left time: 1032.9662s
Epoch: 43 cost time: 4.539287090301514
Epoch: 43, Steps: 154 | Train Loss: 1.348 Vali Loss: 3.301 Vali Acc: 0.217 Test Loss: 3.301 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 44 | loss: 1.6032621
	speed: 0.1138s/iter; left time: 987.9928s
Epoch: 44 cost time: 4.388031721115112
Epoch: 44, Steps: 154 | Train Loss: 1.210 Vali Loss: 3.741 Vali Acc: 0.228 Test Loss: 3.741 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 45 | loss: 1.0173569
	speed: 0.1079s/iter; left time: 920.1016s
Epoch: 45 cost time: 4.47037935256958
Epoch: 45, Steps: 154 | Train Loss: 1.308 Vali Loss: 3.206 Vali Acc: 0.384 Test Loss: 3.206 Test Acc: 0.384
Validation loss decreased (-0.381557 --> -0.383585).  Saving model ...
	iters: 100, epoch: 46 | loss: 0.9916986
	speed: 0.1073s/iter; left time: 898.1460s
Epoch: 46 cost time: 4.570927381515503
Epoch: 46, Steps: 154 | Train Loss: 1.368 Vali Loss: 3.637 Vali Acc: 0.221 Test Loss: 3.637 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 47 | loss: 0.9576319
	speed: 0.1102s/iter; left time: 905.4434s
Epoch: 47 cost time: 4.339565992355347
Epoch: 47, Steps: 154 | Train Loss: 1.245 Vali Loss: 3.963 Vali Acc: 0.374 Test Loss: 3.963 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 48 | loss: 0.8417116
	speed: 0.1095s/iter; left time: 882.9512s
Epoch: 48 cost time: 4.272581577301025
Epoch: 48, Steps: 154 | Train Loss: 1.314 Vali Loss: 3.734 Vali Acc: 0.383 Test Loss: 3.734 Test Acc: 0.383
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 49 | loss: 1.1955271
	speed: 0.1093s/iter; left time: 864.7903s
Epoch: 49 cost time: 4.316852807998657
Epoch: 49, Steps: 154 | Train Loss: 1.217 Vali Loss: 3.662 Vali Acc: 0.251 Test Loss: 3.662 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 50 | loss: 1.5434783
	speed: 0.1173s/iter; left time: 909.4891s
Epoch: 50 cost time: 4.679803371429443
Epoch: 50, Steps: 154 | Train Loss: 1.281 Vali Loss: 3.946 Vali Acc: 0.244 Test Loss: 3.946 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 51 | loss: 1.4883516
	speed: 0.1096s/iter; left time: 833.0465s
Epoch: 51 cost time: 4.362027645111084
Epoch: 51, Steps: 154 | Train Loss: 1.217 Vali Loss: 3.324 Vali Acc: 0.386 Test Loss: 3.324 Test Acc: 0.386
Validation loss decreased (-0.383585 --> -0.386423).  Saving model ...
	iters: 100, epoch: 52 | loss: 1.5589337
	speed: 0.1127s/iter; left time: 839.4180s
Epoch: 52 cost time: 4.4872705936431885
Epoch: 52, Steps: 154 | Train Loss: 1.286 Vali Loss: 3.232 Vali Acc: 0.245 Test Loss: 3.232 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 53 | loss: 0.8196375
	speed: 0.1135s/iter; left time: 827.7969s
Epoch: 53 cost time: 4.763160467147827
Epoch: 53, Steps: 154 | Train Loss: 1.277 Vali Loss: 3.571 Vali Acc: 0.384 Test Loss: 3.571 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 54 | loss: 1.1686829
	speed: 0.1116s/iter; left time: 796.7951s
Epoch: 54 cost time: 4.723484039306641
Epoch: 54, Steps: 154 | Train Loss: 1.174 Vali Loss: 3.413 Vali Acc: 0.381 Test Loss: 3.413 Test Acc: 0.381
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 55 | loss: 0.6922090
	speed: 0.1141s/iter; left time: 796.7878s
Epoch: 55 cost time: 4.616089105606079
Epoch: 55, Steps: 154 | Train Loss: 1.266 Vali Loss: 3.375 Vali Acc: 0.379 Test Loss: 3.375 Test Acc: 0.379
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 56 | loss: 1.5324508
	speed: 0.1133s/iter; left time: 773.7420s
Epoch: 56 cost time: 4.395397663116455
Epoch: 56, Steps: 154 | Train Loss: 1.198 Vali Loss: 4.012 Vali Acc: 0.211 Test Loss: 4.012 Test Acc: 0.211
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 57 | loss: 1.1551342
	speed: 0.1124s/iter; left time: 750.8192s
Epoch: 57 cost time: 4.596236944198608
Epoch: 57, Steps: 154 | Train Loss: 1.236 Vali Loss: 3.559 Vali Acc: 0.223 Test Loss: 3.559 Test Acc: 0.223
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 58 | loss: 0.7411525
	speed: 0.1202s/iter; left time: 784.0879s
Epoch: 58 cost time: 4.366406679153442
Epoch: 58, Steps: 154 | Train Loss: 1.269 Vali Loss: 3.579 Vali Acc: 0.358 Test Loss: 3.579 Test Acc: 0.358
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 59 | loss: 1.4407173
	speed: 0.1184s/iter; left time: 754.1704s
Epoch: 59 cost time: 4.846890926361084
Epoch: 59, Steps: 154 | Train Loss: 1.256 Vali Loss: 3.492 Vali Acc: 0.324 Test Loss: 3.492 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 60 | loss: 0.8676457
	speed: 0.1173s/iter; left time: 728.9369s
Epoch: 60 cost time: 4.67338228225708
Epoch: 60, Steps: 154 | Train Loss: 1.151 Vali Loss: 3.273 Vali Acc: 0.251 Test Loss: 3.273 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 61 | loss: 0.8065086
	speed: 0.1153s/iter; left time: 698.9351s
Epoch: 61 cost time: 4.472886800765991
Epoch: 61, Steps: 154 | Train Loss: 1.177 Vali Loss: 3.498 Vali Acc: 0.374 Test Loss: 3.498 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.386455798864558
model parameter : 51382
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2339344
	speed: 0.0454s/iter; left time: 695.1756s
Epoch: 1 cost time: 6.210914373397827
Epoch: 1, Steps: 154 | Train Loss: 2.256 Vali Loss: 2.158 Vali Acc: 0.318 Test Loss: 2.158 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6391066
	speed: 0.1127s/iter; left time: 1707.0692s
Epoch: 2 cost time: 4.177933692932129
Epoch: 2, Steps: 154 | Train Loss: 2.073 Vali Loss: 2.139 Vali Acc: 0.321 Test Loss: 2.139 Test Acc: 0.321
Validation loss decreased (-0.317902 --> -0.321146).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0135324
	speed: 0.1104s/iter; left time: 1655.2832s
Epoch: 3 cost time: 4.539435148239136
Epoch: 3, Steps: 154 | Train Loss: 2.023 Vali Loss: 2.131 Vali Acc: 0.326 Test Loss: 2.131 Test Acc: 0.326
Validation loss decreased (-0.321146 --> -0.325607).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0248935
	speed: 0.1083s/iter; left time: 1606.4223s
Epoch: 4 cost time: 4.208446502685547
Epoch: 4, Steps: 154 | Train Loss: 1.953 Vali Loss: 2.153 Vali Acc: 0.323 Test Loss: 2.153 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6087731
	speed: 0.1105s/iter; left time: 1622.5321s
Epoch: 5 cost time: 4.227402448654175
Epoch: 5, Steps: 154 | Train Loss: 1.913 Vali Loss: 2.142 Vali Acc: 0.326 Test Loss: 2.142 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.7859588
	speed: 0.1094s/iter; left time: 1589.4119s
Epoch: 6 cost time: 4.604556560516357
Epoch: 6, Steps: 154 | Train Loss: 1.908 Vali Loss: 2.118 Vali Acc: 0.327 Test Loss: 2.118 Test Acc: 0.327
Validation loss decreased (-0.325607 --> -0.326824).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8319092
	speed: 0.1127s/iter; left time: 1620.1159s
Epoch: 7 cost time: 4.3786845207214355
Epoch: 7, Steps: 154 | Train Loss: 1.867 Vali Loss: 2.153 Vali Acc: 0.325 Test Loss: 2.153 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9509325
	speed: 0.1091s/iter; left time: 1551.4647s
Epoch: 8 cost time: 4.274611473083496
Epoch: 8, Steps: 154 | Train Loss: 1.832 Vali Loss: 2.174 Vali Acc: 0.329 Test Loss: 2.174 Test Acc: 0.329
Validation loss decreased (-0.326824 --> -0.328851).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9725531
	speed: 0.1104s/iter; left time: 1553.7281s
Epoch: 9 cost time: 4.813214540481567
Epoch: 9, Steps: 154 | Train Loss: 1.791 Vali Loss: 2.190 Vali Acc: 0.328 Test Loss: 2.190 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5975970
	speed: 0.1142s/iter; left time: 1589.2830s
Epoch: 10 cost time: 4.546300888061523
Epoch: 10, Steps: 154 | Train Loss: 1.756 Vali Loss: 2.189 Vali Acc: 0.332 Test Loss: 2.189 Test Acc: 0.332
Validation loss decreased (-0.328851 --> -0.332095).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7190624
	speed: 0.1146s/iter; left time: 1576.6817s
Epoch: 11 cost time: 4.559162616729736
Epoch: 11, Steps: 154 | Train Loss: 1.736 Vali Loss: 2.193 Vali Acc: 0.332 Test Loss: 2.193 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8899134
	speed: 0.1137s/iter; left time: 1546.6635s
Epoch: 12 cost time: 5.0445311069488525
Epoch: 12, Steps: 154 | Train Loss: 1.709 Vali Loss: 2.200 Vali Acc: 0.339 Test Loss: 2.200 Test Acc: 0.339
Validation loss decreased (-0.332095 --> -0.338989).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0987891
	speed: 0.1118s/iter; left time: 1503.7957s
Epoch: 13 cost time: 4.448674917221069
Epoch: 13, Steps: 154 | Train Loss: 1.709 Vali Loss: 2.241 Vali Acc: 0.338 Test Loss: 2.241 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4591582
	speed: 0.1154s/iter; left time: 1534.3792s
Epoch: 14 cost time: 4.5489888191223145
Epoch: 14, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.279 Vali Acc: 0.339 Test Loss: 2.279 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 7.0557036
	speed: 0.1140s/iter; left time: 1499.0682s
Epoch: 15 cost time: 4.70723557472229
Epoch: 15, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.314 Vali Acc: 0.349 Test Loss: 2.314 Test Acc: 0.349
Validation loss decreased (-0.338989 --> -0.349125).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3860774
	speed: 0.1165s/iter; left time: 1513.5688s
Epoch: 16 cost time: 4.198464632034302
Epoch: 16, Steps: 154 | Train Loss: 1.670 Vali Loss: 2.376 Vali Acc: 0.348 Test Loss: 2.376 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.6550655
	speed: 0.1074s/iter; left time: 1378.6980s
Epoch: 17 cost time: 4.59152364730835
Epoch: 17, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.395 Vali Acc: 0.358 Test Loss: 2.395 Test Acc: 0.358
Validation loss decreased (-0.349125 --> -0.357640).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.9099807
	speed: 0.1115s/iter; left time: 1413.5515s
Epoch: 18 cost time: 4.480060815811157
Epoch: 18, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.297 Vali Acc: 0.355 Test Loss: 2.297 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.5876192
	speed: 0.1113s/iter; left time: 1394.8788s
Epoch: 19 cost time: 4.194458246231079
Epoch: 19, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.421 Vali Acc: 0.350 Test Loss: 2.421 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.2933657
	speed: 0.1114s/iter; left time: 1378.7210s
Epoch: 20 cost time: 4.758070707321167
Epoch: 20, Steps: 154 | Train Loss: 1.572 Vali Loss: 2.359 Vali Acc: 0.351 Test Loss: 2.359 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.3935343
	speed: 0.1123s/iter; left time: 1371.8163s
Epoch: 21 cost time: 4.47550106048584
Epoch: 21, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.396 Vali Acc: 0.352 Test Loss: 2.396 Test Acc: 0.352
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.4792171
	speed: 0.1100s/iter; left time: 1327.5619s
Epoch: 22 cost time: 4.238881826400757
Epoch: 22, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.496 Vali Acc: 0.352 Test Loss: 2.496 Test Acc: 0.352
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.6118542
	speed: 0.1100s/iter; left time: 1310.8397s
Epoch: 23 cost time: 4.4274725914001465
Epoch: 23, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.497 Vali Acc: 0.361 Test Loss: 2.497 Test Acc: 0.361
Validation loss decreased (-0.357640 --> -0.360478).  Saving model ...
	iters: 100, epoch: 24 | loss: 2.0921984
	speed: 0.1138s/iter; left time: 1338.6175s
Epoch: 24 cost time: 4.17556357383728
Epoch: 24, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.503 Vali Acc: 0.351 Test Loss: 2.503 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.2394862
	speed: 0.1100s/iter; left time: 1276.0361s
Epoch: 25 cost time: 4.57940673828125
Epoch: 25, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.478 Vali Acc: 0.371 Test Loss: 2.478 Test Acc: 0.371
Validation loss decreased (-0.360478 --> -0.370616).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.3284490
	speed: 0.1128s/iter; left time: 1291.5769s
Epoch: 26 cost time: 4.401931524276733
Epoch: 26, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.856 Vali Acc: 0.370 Test Loss: 2.856 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.2982377
	speed: 0.1128s/iter; left time: 1274.6752s
Epoch: 27 cost time: 4.65020489692688
Epoch: 27, Steps: 154 | Train Loss: 1.552 Vali Loss: 2.587 Vali Acc: 0.360 Test Loss: 2.587 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.1187892
	speed: 0.1128s/iter; left time: 1257.1348s
Epoch: 28 cost time: 4.844068765640259
Epoch: 28, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.553 Vali Acc: 0.378 Test Loss: 2.553 Test Acc: 0.378
Validation loss decreased (-0.370616 --> -0.377509).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.3305385
	speed: 0.1136s/iter; left time: 1248.6242s
Epoch: 29 cost time: 4.565211534500122
Epoch: 29, Steps: 154 | Train Loss: 1.342 Vali Loss: 2.643 Vali Acc: 0.371 Test Loss: 2.643 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.8136663
	speed: 0.1159s/iter; left time: 1256.0539s
Epoch: 30 cost time: 4.728635549545288
Epoch: 30, Steps: 154 | Train Loss: 1.376 Vali Loss: 2.896 Vali Acc: 0.376 Test Loss: 2.896 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.3860204
	speed: 0.1144s/iter; left time: 1221.8597s
Epoch: 31 cost time: 4.7438459396362305
Epoch: 31, Steps: 154 | Train Loss: 1.401 Vali Loss: 2.849 Vali Acc: 0.367 Test Loss: 2.849 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.6932762
	speed: 0.1077s/iter; left time: 1133.8673s
Epoch: 32 cost time: 4.5008461475372314
Epoch: 32, Steps: 154 | Train Loss: 1.421 Vali Loss: 2.862 Vali Acc: 0.371 Test Loss: 2.862 Test Acc: 0.371
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 1.2428603
	speed: 0.1144s/iter; left time: 1186.8160s
Epoch: 33 cost time: 4.390671253204346
Epoch: 33, Steps: 154 | Train Loss: 1.336 Vali Loss: 2.903 Vali Acc: 0.366 Test Loss: 2.903 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 1.1936656
	speed: 0.1069s/iter; left time: 1092.8983s
Epoch: 34 cost time: 4.273880958557129
Epoch: 34, Steps: 154 | Train Loss: 1.438 Vali Loss: 3.146 Vali Acc: 0.373 Test Loss: 3.146 Test Acc: 0.373
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 1.1583568
	speed: 0.1119s/iter; left time: 1126.1396s
Epoch: 35 cost time: 4.221927165985107
Epoch: 35, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.801 Vali Acc: 0.368 Test Loss: 2.801 Test Acc: 0.368
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 1.1929773
	speed: 0.1121s/iter; left time: 1110.5891s
Epoch: 36 cost time: 4.612717390060425
Epoch: 36, Steps: 154 | Train Loss: 1.340 Vali Loss: 3.003 Vali Acc: 0.370 Test Loss: 3.003 Test Acc: 0.370
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.7943140
	speed: 0.1084s/iter; left time: 1057.4361s
Epoch: 37 cost time: 4.191760540008545
Epoch: 37, Steps: 154 | Train Loss: 1.247 Vali Loss: 3.044 Vali Acc: 0.379 Test Loss: 3.044 Test Acc: 0.379
Validation loss decreased (-0.377509 --> -0.379126).  Saving model ...
	iters: 100, epoch: 38 | loss: 1.1171436
	speed: 0.1127s/iter; left time: 1082.7274s
Epoch: 38 cost time: 4.458492994308472
Epoch: 38, Steps: 154 | Train Loss: 1.341 Vali Loss: 2.880 Vali Acc: 0.386 Test Loss: 2.880 Test Acc: 0.386
Validation loss decreased (-0.379126 --> -0.385616).  Saving model ...
	iters: 100, epoch: 39 | loss: 1.2702039
	speed: 0.1076s/iter; left time: 1016.8272s
Epoch: 39 cost time: 4.420392274856567
Epoch: 39, Steps: 154 | Train Loss: 1.312 Vali Loss: 2.864 Vali Acc: 0.382 Test Loss: 2.864 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 1.2636096
	speed: 0.1036s/iter; left time: 962.7926s
Epoch: 40 cost time: 4.286442756652832
Epoch: 40, Steps: 154 | Train Loss: 1.288 Vali Loss: 3.104 Vali Acc: 0.375 Test Loss: 3.104 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 1.1959454
	speed: 0.1089s/iter; left time: 995.2599s
Epoch: 41 cost time: 4.442385911941528
Epoch: 41, Steps: 154 | Train Loss: 1.277 Vali Loss: 3.220 Vali Acc: 0.376 Test Loss: 3.220 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 42 | loss: 0.8732145
	speed: 0.1098s/iter; left time: 987.1445s
Epoch: 42 cost time: 4.500043869018555
Epoch: 42, Steps: 154 | Train Loss: 1.310 Vali Loss: 3.554 Vali Acc: 0.210 Test Loss: 3.554 Test Acc: 0.210
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 43 | loss: 1.2238539
	speed: 0.1203s/iter; left time: 1062.9440s
Epoch: 43 cost time: 4.371399641036987
Epoch: 43, Steps: 154 | Train Loss: 1.240 Vali Loss: 3.235 Vali Acc: 0.218 Test Loss: 3.235 Test Acc: 0.218
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 44 | loss: 1.4868666
	speed: 0.1205s/iter; left time: 1046.1984s
Epoch: 44 cost time: 5.134630918502808
Epoch: 44, Steps: 154 | Train Loss: 1.263 Vali Loss: 3.348 Vali Acc: 0.231 Test Loss: 3.348 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 45 | loss: 1.1678151
	speed: 0.1157s/iter; left time: 986.2580s
Epoch: 45 cost time: 4.249351263046265
Epoch: 45, Steps: 154 | Train Loss: 1.521 Vali Loss: 3.205 Vali Acc: 0.382 Test Loss: 3.205 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 46 | loss: 0.8444259
	speed: 0.1150s/iter; left time: 962.3124s
Epoch: 46 cost time: 4.772371768951416
Epoch: 46, Steps: 154 | Train Loss: 1.268 Vali Loss: 3.354 Vali Acc: 0.381 Test Loss: 3.354 Test Acc: 0.381
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 47 | loss: 0.9338099
	speed: 0.1163s/iter; left time: 955.7990s
Epoch: 47 cost time: 4.669363975524902
Epoch: 47, Steps: 154 | Train Loss: 1.205 Vali Loss: 3.527 Vali Acc: 0.369 Test Loss: 3.527 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 48 | loss: 0.8385494
	speed: 0.1148s/iter; left time: 925.6534s
Epoch: 48 cost time: 4.890934228897095
Epoch: 48, Steps: 154 | Train Loss: 1.267 Vali Loss: 3.576 Vali Acc: 0.382 Test Loss: 3.576 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38564476885644766
model parameter : 51382
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2570283
	speed: 0.0429s/iter; left time: 656.7359s
Epoch: 1 cost time: 5.643301725387573
Epoch: 1, Steps: 154 | Train Loss: 2.246 Vali Loss: 2.156 Vali Acc: 0.318 Test Loss: 2.156 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6542053
	speed: 0.1049s/iter; left time: 1588.2321s
Epoch: 2 cost time: 3.854332447052002
Epoch: 2, Steps: 154 | Train Loss: 2.077 Vali Loss: 2.137 Vali Acc: 0.320 Test Loss: 2.137 Test Acc: 0.320
Validation loss decreased (-0.317902 --> -0.319930).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0146809
	speed: 0.1037s/iter; left time: 1554.5594s
Epoch: 3 cost time: 4.121479034423828
Epoch: 3, Steps: 154 | Train Loss: 2.030 Vali Loss: 2.129 Vali Acc: 0.325 Test Loss: 2.129 Test Acc: 0.325
Validation loss decreased (-0.319930 --> -0.324796).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0726323
	speed: 0.1106s/iter; left time: 1640.5209s
Epoch: 4 cost time: 4.044491291046143
Epoch: 4, Steps: 154 | Train Loss: 1.957 Vali Loss: 2.147 Vali Acc: 0.321 Test Loss: 2.147 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5858431
	speed: 0.1039s/iter; left time: 1525.5322s
Epoch: 5 cost time: 4.149157285690308
Epoch: 5, Steps: 154 | Train Loss: 1.919 Vali Loss: 2.128 Vali Acc: 0.324 Test Loss: 2.128 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.7609800
	speed: 0.1009s/iter; left time: 1466.2330s
Epoch: 6 cost time: 4.226358652114868
Epoch: 6, Steps: 154 | Train Loss: 1.895 Vali Loss: 2.116 Vali Acc: 0.328 Test Loss: 2.116 Test Acc: 0.328
Validation loss decreased (-0.324796 --> -0.328040).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8451231
	speed: 0.1016s/iter; left time: 1460.2314s
Epoch: 7 cost time: 3.2058911323547363
Epoch: 7, Steps: 154 | Train Loss: 1.869 Vali Loss: 2.131 Vali Acc: 0.325 Test Loss: 2.131 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0013332
	speed: 0.0822s/iter; left time: 1169.5962s
Epoch: 8 cost time: 3.3128933906555176
Epoch: 8, Steps: 154 | Train Loss: 1.815 Vali Loss: 2.152 Vali Acc: 0.328 Test Loss: 2.152 Test Acc: 0.328
Validation loss decreased (-0.328040 --> -0.328446).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0103924
	speed: 0.0874s/iter; left time: 1229.8886s
Epoch: 9 cost time: 3.4444963932037354
Epoch: 9, Steps: 154 | Train Loss: 1.823 Vali Loss: 2.190 Vali Acc: 0.328 Test Loss: 2.190 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5720996
	speed: 0.1054s/iter; left time: 1466.8257s
Epoch: 10 cost time: 4.066451072692871
Epoch: 10, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.165 Vali Acc: 0.333 Test Loss: 2.165 Test Acc: 0.333
Validation loss decreased (-0.328446 --> -0.333312).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6380775
	speed: 0.1060s/iter; left time: 1459.3131s
Epoch: 11 cost time: 4.482633352279663
Epoch: 11, Steps: 154 | Train Loss: 1.729 Vali Loss: 2.198 Vali Acc: 0.335 Test Loss: 2.198 Test Acc: 0.335
Validation loss decreased (-0.333312 --> -0.335339).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6959698
	speed: 0.1113s/iter; left time: 1514.9761s
Epoch: 12 cost time: 4.070523738861084
Epoch: 12, Steps: 154 | Train Loss: 1.708 Vali Loss: 2.171 Vali Acc: 0.343 Test Loss: 2.171 Test Acc: 0.343
Validation loss decreased (-0.335339 --> -0.343449).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0795356
	speed: 0.1089s/iter; left time: 1464.7810s
Epoch: 13 cost time: 4.37827205657959
Epoch: 13, Steps: 154 | Train Loss: 1.740 Vali Loss: 2.284 Vali Acc: 0.340 Test Loss: 2.284 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5006859
	speed: 0.1110s/iter; left time: 1476.2429s
Epoch: 14 cost time: 4.5766425132751465
Epoch: 14, Steps: 154 | Train Loss: 1.716 Vali Loss: 2.299 Vali Acc: 0.340 Test Loss: 2.299 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.4904878
	speed: 0.1088s/iter; left time: 1430.8013s
Epoch: 15 cost time: 3.973964214324951
Epoch: 15, Steps: 154 | Train Loss: 1.631 Vali Loss: 2.328 Vali Acc: 0.346 Test Loss: 2.328 Test Acc: 0.346
Validation loss decreased (-0.343449 --> -0.346287).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.2413681
	speed: 0.1138s/iter; left time: 1477.8254s
Epoch: 16 cost time: 4.215426445007324
Epoch: 16, Steps: 154 | Train Loss: 1.612 Vali Loss: 2.443 Vali Acc: 0.346 Test Loss: 2.443 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.5438550
	speed: 0.1126s/iter; left time: 1445.2834s
Epoch: 17 cost time: 4.572737216949463
Epoch: 17, Steps: 154 | Train Loss: 1.581 Vali Loss: 2.449 Vali Acc: 0.352 Test Loss: 2.449 Test Acc: 0.352
Validation loss decreased (-0.346287 --> -0.351963).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.0438333
	speed: 0.1099s/iter; left time: 1394.0431s
Epoch: 18 cost time: 3.9730417728424072
Epoch: 18, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.403 Vali Acc: 0.359 Test Loss: 2.403 Test Acc: 0.359
Validation loss decreased (-0.351963 --> -0.358857).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.1208413
	speed: 0.1084s/iter; left time: 1358.6449s
Epoch: 19 cost time: 4.124534606933594
Epoch: 19, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.506 Vali Acc: 0.349 Test Loss: 2.506 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.2148858
	speed: 0.1079s/iter; left time: 1335.5434s
Epoch: 20 cost time: 4.430093765258789
Epoch: 20, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.481 Vali Acc: 0.353 Test Loss: 2.481 Test Acc: 0.353
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 2.4520657
	speed: 0.1046s/iter; left time: 1277.9497s
Epoch: 21 cost time: 4.019138813018799
Epoch: 21, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.461 Vali Acc: 0.357 Test Loss: 2.461 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.5067317
	speed: 0.1092s/iter; left time: 1318.2802s
Epoch: 22 cost time: 4.2257184982299805
Epoch: 22, Steps: 154 | Train Loss: 1.498 Vali Loss: 2.553 Vali Acc: 0.355 Test Loss: 2.553 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.5001930
	speed: 0.1109s/iter; left time: 1321.6601s
Epoch: 23 cost time: 4.56771445274353
Epoch: 23, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.681 Vali Acc: 0.363 Test Loss: 2.681 Test Acc: 0.363
Validation loss decreased (-0.358857 --> -0.362504).  Saving model ...
	iters: 100, epoch: 24 | loss: 2.0955727
	speed: 0.1107s/iter; left time: 1301.5552s
Epoch: 24 cost time: 4.4259703159332275
Epoch: 24, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.533 Vali Acc: 0.352 Test Loss: 2.533 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.2316209
	speed: 0.1124s/iter; left time: 1303.9289s
Epoch: 25 cost time: 4.404627323150635
Epoch: 25, Steps: 154 | Train Loss: 1.448 Vali Loss: 2.507 Vali Acc: 0.367 Test Loss: 2.507 Test Acc: 0.367
Validation loss decreased (-0.362504 --> -0.367372).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.2790998
	speed: 0.1171s/iter; left time: 1340.8036s
Epoch: 26 cost time: 4.39535665512085
Epoch: 26, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.711 Vali Acc: 0.364 Test Loss: 2.711 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.2330505
	speed: 0.1093s/iter; left time: 1234.3785s
Epoch: 27 cost time: 4.57383394241333
Epoch: 27, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.775 Vali Acc: 0.355 Test Loss: 2.775 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.2424036
	speed: 0.1138s/iter; left time: 1268.0385s
Epoch: 28 cost time: 4.477762222290039
Epoch: 28, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.840 Vali Acc: 0.370 Test Loss: 2.840 Test Acc: 0.370
Validation loss decreased (-0.367372 --> -0.369801).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.3278002
	speed: 0.1126s/iter; left time: 1236.9032s
Epoch: 29 cost time: 4.56181001663208
Epoch: 29, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.801 Vali Acc: 0.367 Test Loss: 2.801 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.7766032
	speed: 0.1161s/iter; left time: 1258.0812s
Epoch: 30 cost time: 4.763453960418701
Epoch: 30, Steps: 154 | Train Loss: 1.370 Vali Loss: 2.851 Vali Acc: 0.365 Test Loss: 2.851 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.3174897
	speed: 0.1163s/iter; left time: 1241.7959s
Epoch: 31 cost time: 4.6928534507751465
Epoch: 31, Steps: 154 | Train Loss: 1.410 Vali Loss: 2.793 Vali Acc: 0.369 Test Loss: 2.793 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.8179868
	speed: 0.1180s/iter; left time: 1241.6812s
Epoch: 32 cost time: 4.514130592346191
Epoch: 32, Steps: 154 | Train Loss: 1.365 Vali Loss: 3.008 Vali Acc: 0.372 Test Loss: 3.008 Test Acc: 0.372
Validation loss decreased (-0.369801 --> -0.371827).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.0781115
	speed: 0.1172s/iter; left time: 1215.5353s
Epoch: 33 cost time: 4.567076206207275
Epoch: 33, Steps: 154 | Train Loss: 1.293 Vali Loss: 3.278 Vali Acc: 0.367 Test Loss: 3.278 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 1.1791404
	speed: 0.1187s/iter; left time: 1213.2177s
Epoch: 34 cost time: 4.789933204650879
Epoch: 34, Steps: 154 | Train Loss: 1.345 Vali Loss: 3.297 Vali Acc: 0.373 Test Loss: 3.297 Test Acc: 0.373
Validation loss decreased (-0.371827 --> -0.373446).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.1345341
	speed: 0.1153s/iter; left time: 1160.3851s
Epoch: 35 cost time: 4.493360757827759
Epoch: 35, Steps: 154 | Train Loss: 1.316 Vali Loss: 3.130 Vali Acc: 0.371 Test Loss: 3.130 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 1.1250886
	speed: 0.1106s/iter; left time: 1095.7349s
Epoch: 36 cost time: 4.274384021759033
Epoch: 36, Steps: 154 | Train Loss: 1.363 Vali Loss: 3.137 Vali Acc: 0.367 Test Loss: 3.137 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 1.0518608
	speed: 0.1066s/iter; left time: 1040.3860s
Epoch: 37 cost time: 4.429154396057129
Epoch: 37, Steps: 154 | Train Loss: 1.316 Vali Loss: 3.165 Vali Acc: 0.369 Test Loss: 3.165 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 1.2513522
	speed: 0.1138s/iter; left time: 1092.6059s
Epoch: 38 cost time: 4.463671684265137
Epoch: 38, Steps: 154 | Train Loss: 1.340 Vali Loss: 3.563 Vali Acc: 0.373 Test Loss: 3.563 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.5914450
	speed: 0.1100s/iter; left time: 1039.4726s
Epoch: 39 cost time: 4.344506502151489
Epoch: 39, Steps: 154 | Train Loss: 1.449 Vali Loss: 3.378 Vali Acc: 0.380 Test Loss: 3.378 Test Acc: 0.380
Validation loss decreased (-0.373446 --> -0.379528).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.3062521
	speed: 0.1142s/iter; left time: 1061.3973s
Epoch: 40 cost time: 4.801789999008179
Epoch: 40, Steps: 154 | Train Loss: 1.389 Vali Loss: 3.573 Vali Acc: 0.377 Test Loss: 3.573 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 1.2546947
	speed: 0.1132s/iter; left time: 1034.4428s
Epoch: 41 cost time: 4.385124206542969
Epoch: 41, Steps: 154 | Train Loss: 1.317 Vali Loss: 3.670 Vali Acc: 0.372 Test Loss: 3.670 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 0.9895360
	speed: 0.1126s/iter; left time: 1011.4984s
Epoch: 42 cost time: 4.446845293045044
Epoch: 42, Steps: 154 | Train Loss: 1.279 Vali Loss: 3.706 Vali Acc: 0.216 Test Loss: 3.706 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 1.0773609
	speed: 0.1122s/iter; left time: 991.3739s
Epoch: 43 cost time: 4.516672849655151
Epoch: 43, Steps: 154 | Train Loss: 1.349 Vali Loss: 3.414 Vali Acc: 0.247 Test Loss: 3.414 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 0.9104621
	speed: 0.1125s/iter; left time: 976.1728s
Epoch: 44 cost time: 4.34087347984314
Epoch: 44, Steps: 154 | Train Loss: 1.200 Vali Loss: 3.734 Vali Acc: 0.363 Test Loss: 3.734 Test Acc: 0.363
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 1.1292275
	speed: 0.1175s/iter; left time: 1001.4733s
Epoch: 45 cost time: 4.596179485321045
Epoch: 45, Steps: 154 | Train Loss: 1.269 Vali Loss: 3.505 Vali Acc: 0.374 Test Loss: 3.505 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 46 | loss: 1.0689553
	speed: 0.1230s/iter; left time: 1029.3987s
Epoch: 46 cost time: 4.603307723999023
Epoch: 46, Steps: 154 | Train Loss: 1.372 Vali Loss: 3.380 Vali Acc: 0.387 Test Loss: 3.380 Test Acc: 0.387
Validation loss decreased (-0.379528 --> -0.386828).  Saving model ...
	iters: 100, epoch: 47 | loss: 0.8565025
	speed: 0.1130s/iter; left time: 928.8302s
Epoch: 47 cost time: 4.618151903152466
Epoch: 47, Steps: 154 | Train Loss: 1.199 Vali Loss: 3.502 Vali Acc: 0.375 Test Loss: 3.502 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 48 | loss: 0.6696351
	speed: 0.1149s/iter; left time: 926.6435s
Epoch: 48 cost time: 4.4338600635528564
Epoch: 48, Steps: 154 | Train Loss: 1.319 Vali Loss: 3.537 Vali Acc: 0.375 Test Loss: 3.537 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 49 | loss: 1.6054528
	speed: 0.1177s/iter; left time: 930.6250s
Epoch: 49 cost time: 4.688997030258179
Epoch: 49, Steps: 154 | Train Loss: 1.202 Vali Loss: 3.819 Vali Acc: 0.381 Test Loss: 3.819 Test Acc: 0.381
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 50 | loss: 1.5704941
	speed: 0.1169s/iter; left time: 906.3537s
Epoch: 50 cost time: 4.56069803237915
Epoch: 50, Steps: 154 | Train Loss: 1.205 Vali Loss: 3.560 Vali Acc: 0.384 Test Loss: 3.560 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 51 | loss: 1.3925462
	speed: 0.1159s/iter; left time: 880.6441s
Epoch: 51 cost time: 4.389445781707764
Epoch: 51, Steps: 154 | Train Loss: 1.366 Vali Loss: 3.724 Vali Acc: 0.376 Test Loss: 3.724 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 52 | loss: 1.2259488
	speed: 0.1139s/iter; left time: 848.5128s
Epoch: 52 cost time: 4.410655498504639
Epoch: 52, Steps: 154 | Train Loss: 1.234 Vali Loss: 3.988 Vali Acc: 0.383 Test Loss: 3.988 Test Acc: 0.383
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 53 | loss: 0.7622559
	speed: 0.1160s/iter; left time: 846.1774s
Epoch: 53 cost time: 4.621189832687378
Epoch: 53, Steps: 154 | Train Loss: 1.195 Vali Loss: 4.320 Vali Acc: 0.371 Test Loss: 4.320 Test Acc: 0.371
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 54 | loss: 1.1181512
	speed: 0.1183s/iter; left time: 844.5658s
Epoch: 54 cost time: 4.528480291366577
Epoch: 54, Steps: 154 | Train Loss: 1.285 Vali Loss: 3.935 Vali Acc: 0.382 Test Loss: 3.935 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 55 | loss: 0.7459394
	speed: 0.1150s/iter; left time: 803.3638s
Epoch: 55 cost time: 4.430189609527588
Epoch: 55, Steps: 154 | Train Loss: 1.246 Vali Loss: 3.667 Vali Acc: 0.377 Test Loss: 3.667 Test Acc: 0.377
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 56 | loss: 1.2678320
	speed: 0.1131s/iter; left time: 772.6063s
Epoch: 56 cost time: 4.499406337738037
Epoch: 56, Steps: 154 | Train Loss: 1.295 Vali Loss: 3.837 Vali Acc: 0.376 Test Loss: 3.837 Test Acc: 0.376
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38686131386861317
model parameter : 51382
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3383791
	speed: 0.0440s/iter; left time: 673.2915s
Epoch: 1 cost time: 5.799824237823486
Epoch: 1, Steps: 154 | Train Loss: 2.218 Vali Loss: 2.157 Vali Acc: 0.318 Test Loss: 2.157 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6603814
	speed: 0.1076s/iter; left time: 1629.1994s
Epoch: 2 cost time: 4.220060110092163
Epoch: 2, Steps: 154 | Train Loss: 2.078 Vali Loss: 2.137 Vali Acc: 0.318 Test Loss: 2.137 Test Acc: 0.318
Validation loss decreased (-0.318308 --> -0.318308).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0429280
	speed: 0.1077s/iter; left time: 1614.8840s
Epoch: 3 cost time: 4.17370343208313
Epoch: 3, Steps: 154 | Train Loss: 2.032 Vali Loss: 2.132 Vali Acc: 0.322 Test Loss: 2.132 Test Acc: 0.322
Validation loss decreased (-0.318308 --> -0.322363).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0823388
	speed: 0.1114s/iter; left time: 1653.6514s
Epoch: 4 cost time: 4.34943699836731
Epoch: 4, Steps: 154 | Train Loss: 1.971 Vali Loss: 2.142 Vali Acc: 0.322 Test Loss: 2.142 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5663936
	speed: 0.1112s/iter; left time: 1633.1084s
Epoch: 5 cost time: 4.475216865539551
Epoch: 5, Steps: 154 | Train Loss: 1.915 Vali Loss: 2.125 Vali Acc: 0.325 Test Loss: 2.125 Test Acc: 0.325
Validation loss decreased (-0.322363 --> -0.324796).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7756926
	speed: 0.1122s/iter; left time: 1630.8660s
Epoch: 6 cost time: 4.16641902923584
Epoch: 6, Steps: 154 | Train Loss: 1.913 Vali Loss: 2.106 Vali Acc: 0.330 Test Loss: 2.106 Test Acc: 0.330
Validation loss decreased (-0.324796 --> -0.330068).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8697460
	speed: 0.1094s/iter; left time: 1573.2088s
Epoch: 7 cost time: 4.174983739852905
Epoch: 7, Steps: 154 | Train Loss: 1.860 Vali Loss: 2.128 Vali Acc: 0.327 Test Loss: 2.128 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0238261
	speed: 0.1024s/iter; left time: 1457.0667s
Epoch: 8 cost time: 3.9942166805267334
Epoch: 8, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.151 Vali Acc: 0.331 Test Loss: 2.151 Test Acc: 0.331
Validation loss decreased (-0.330068 --> -0.330879).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0064945
	speed: 0.1089s/iter; left time: 1531.9894s
Epoch: 9 cost time: 4.2113189697265625
Epoch: 9, Steps: 154 | Train Loss: 1.799 Vali Loss: 2.184 Vali Acc: 0.330 Test Loss: 2.184 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5663941
	speed: 0.1084s/iter; left time: 1508.1358s
Epoch: 10 cost time: 4.209571361541748
Epoch: 10, Steps: 154 | Train Loss: 1.768 Vali Loss: 2.185 Vali Acc: 0.337 Test Loss: 2.185 Test Acc: 0.337
Validation loss decreased (-0.330879 --> -0.336556).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6632133
	speed: 0.1050s/iter; left time: 1444.9058s
Epoch: 11 cost time: 4.166470527648926
Epoch: 11, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.193 Vali Acc: 0.339 Test Loss: 2.193 Test Acc: 0.339
Validation loss decreased (-0.336556 --> -0.338583).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6202629
	speed: 0.1069s/iter; left time: 1455.0472s
Epoch: 12 cost time: 4.227174758911133
Epoch: 12, Steps: 154 | Train Loss: 1.715 Vali Loss: 2.174 Vali Acc: 0.343 Test Loss: 2.174 Test Acc: 0.343
Validation loss decreased (-0.338583 --> -0.343044).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3522069
	speed: 0.1079s/iter; left time: 1451.6261s
Epoch: 13 cost time: 4.2119176387786865
Epoch: 13, Steps: 154 | Train Loss: 1.709 Vali Loss: 2.331 Vali Acc: 0.338 Test Loss: 2.331 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3926028
	speed: 0.1073s/iter; left time: 1427.1657s
Epoch: 14 cost time: 4.175525426864624
Epoch: 14, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.274 Vali Acc: 0.341 Test Loss: 2.274 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 4.3442831
	speed: 0.1107s/iter; left time: 1454.8506s
Epoch: 15 cost time: 4.2969279289245605
Epoch: 15, Steps: 154 | Train Loss: 1.689 Vali Loss: 2.226 Vali Acc: 0.345 Test Loss: 2.226 Test Acc: 0.345
Validation loss decreased (-0.343044 --> -0.345071).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3188088
	speed: 0.1094s/iter; left time: 1421.8170s
Epoch: 16 cost time: 4.170854806900024
Epoch: 16, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.394 Vali Acc: 0.345 Test Loss: 2.394 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.4995666
	speed: 0.1085s/iter; left time: 1392.8872s
Epoch: 17 cost time: 4.05970025062561
Epoch: 17, Steps: 154 | Train Loss: 1.624 Vali Loss: 2.330 Vali Acc: 0.351 Test Loss: 2.330 Test Acc: 0.351
Validation loss decreased (-0.345071 --> -0.350747).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.0129650
	speed: 0.1079s/iter; left time: 1368.5867s
Epoch: 18 cost time: 4.2830140590667725
Epoch: 18, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.319 Vali Acc: 0.367 Test Loss: 2.319 Test Acc: 0.367
Validation loss decreased (-0.350747 --> -0.366562).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.1648326
	speed: 0.1062s/iter; left time: 1330.3955s
Epoch: 19 cost time: 4.148964166641235
Epoch: 19, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.423 Vali Acc: 0.345 Test Loss: 2.423 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1310586
	speed: 0.1080s/iter; left time: 1336.1842s
Epoch: 20 cost time: 4.320136785507202
Epoch: 20, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.468 Vali Acc: 0.345 Test Loss: 2.468 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.4251937
	speed: 0.1122s/iter; left time: 1370.7161s
Epoch: 21 cost time: 4.386017084121704
Epoch: 21, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.399 Vali Acc: 0.354 Test Loss: 2.399 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.4647614
	speed: 0.1081s/iter; left time: 1304.2091s
Epoch: 22 cost time: 4.313617706298828
Epoch: 22, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.433 Vali Acc: 0.353 Test Loss: 2.433 Test Acc: 0.353
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 3.3061039
	speed: 0.1110s/iter; left time: 1322.5629s
Epoch: 23 cost time: 4.337504625320435
Epoch: 23, Steps: 154 | Train Loss: 1.590 Vali Loss: 2.438 Vali Acc: 0.357 Test Loss: 2.438 Test Acc: 0.357
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.8130912
	speed: 0.1111s/iter; left time: 1306.9998s
Epoch: 24 cost time: 4.192926645278931
Epoch: 24, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.468 Vali Acc: 0.353 Test Loss: 2.468 Test Acc: 0.353
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.2837605
	speed: 0.1021s/iter; left time: 1185.1318s
Epoch: 25 cost time: 4.229360580444336
Epoch: 25, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.466 Vali Acc: 0.365 Test Loss: 2.466 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.4291930
	speed: 0.1132s/iter; left time: 1296.6267s
Epoch: 26 cost time: 4.2352519035339355
Epoch: 26, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.690 Vali Acc: 0.358 Test Loss: 2.690 Test Acc: 0.358
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.2415378
	speed: 0.1043s/iter; left time: 1178.8244s
Epoch: 27 cost time: 4.179044723510742
Epoch: 27, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.515 Vali Acc: 0.361 Test Loss: 2.515 Test Acc: 0.361
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.1335450
	speed: 0.1053s/iter; left time: 1173.5806s
Epoch: 28 cost time: 4.186431407928467
Epoch: 28, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.583 Vali Acc: 0.368 Test Loss: 2.583 Test Acc: 0.368
Validation loss decreased (-0.366562 --> -0.368182).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.4041734
	speed: 0.1080s/iter; left time: 1186.7882s
Epoch: 29 cost time: 4.117292165756226
Epoch: 29, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.673 Vali Acc: 0.368 Test Loss: 2.673 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.8916833
	speed: 0.1041s/iter; left time: 1127.7948s
Epoch: 30 cost time: 4.329905986785889
Epoch: 30, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.667 Vali Acc: 0.365 Test Loss: 2.667 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.3697232
	speed: 0.1058s/iter; left time: 1130.5547s
Epoch: 31 cost time: 4.148930549621582
Epoch: 31, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.721 Vali Acc: 0.368 Test Loss: 2.721 Test Acc: 0.368
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.6295693
	speed: 0.1022s/iter; left time: 1076.0439s
Epoch: 32 cost time: 4.163521766662598
Epoch: 32, Steps: 154 | Train Loss: 1.554 Vali Loss: 2.630 Vali Acc: 0.370 Test Loss: 2.630 Test Acc: 0.370
Validation loss decreased (-0.368182 --> -0.370209).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.2020892
	speed: 0.1088s/iter; left time: 1128.6272s
Epoch: 33 cost time: 4.330792188644409
Epoch: 33, Steps: 154 | Train Loss: 1.331 Vali Loss: 2.960 Vali Acc: 0.369 Test Loss: 2.960 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 1.2228146
	speed: 0.1081s/iter; left time: 1105.1569s
Epoch: 34 cost time: 4.240777492523193
Epoch: 34, Steps: 154 | Train Loss: 1.318 Vali Loss: 2.862 Vali Acc: 0.379 Test Loss: 2.862 Test Acc: 0.379
Validation loss decreased (-0.370209 --> -0.378722).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.1172276
	speed: 0.1095s/iter; left time: 1102.2548s
Epoch: 35 cost time: 4.138843059539795
Epoch: 35, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.863 Vali Acc: 0.370 Test Loss: 2.863 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 1.2269913
	speed: 0.1036s/iter; left time: 1027.1582s
Epoch: 36 cost time: 4.048330783843994
Epoch: 36, Steps: 154 | Train Loss: 1.358 Vali Loss: 2.956 Vali Acc: 0.367 Test Loss: 2.956 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.6472107
	speed: 0.1073s/iter; left time: 1047.2034s
Epoch: 37 cost time: 4.170630693435669
Epoch: 37, Steps: 154 | Train Loss: 1.294 Vali Loss: 2.990 Vali Acc: 0.372 Test Loss: 2.990 Test Acc: 0.372
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 1.1410520
	speed: 0.1031s/iter; left time: 990.4847s
Epoch: 38 cost time: 4.253908395767212
Epoch: 38, Steps: 154 | Train Loss: 1.332 Vali Loss: 3.106 Vali Acc: 0.376 Test Loss: 3.106 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.5051554
	speed: 0.1078s/iter; left time: 1018.6425s
Epoch: 39 cost time: 4.20247483253479
Epoch: 39, Steps: 154 | Train Loss: 1.373 Vali Loss: 2.883 Vali Acc: 0.376 Test Loss: 2.883 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 1.4160275
	speed: 0.1061s/iter; left time: 985.9485s
Epoch: 40 cost time: 4.4545981884002686
Epoch: 40, Steps: 154 | Train Loss: 1.285 Vali Loss: 3.101 Vali Acc: 0.379 Test Loss: 3.101 Test Acc: 0.379
Validation loss decreased (-0.378722 --> -0.379126).  Saving model ...
	iters: 100, epoch: 41 | loss: 20.5955868
	speed: 0.1116s/iter; left time: 1019.9985s
Epoch: 41 cost time: 4.639580249786377
Epoch: 41, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.924 Vali Acc: 0.371 Test Loss: 2.924 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 1.1507894
	speed: 0.1111s/iter; left time: 998.4013s
Epoch: 42 cost time: 4.321204423904419
Epoch: 42, Steps: 154 | Train Loss: 1.228 Vali Loss: 3.353 Vali Acc: 0.230 Test Loss: 3.353 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.8003166
	speed: 0.1151s/iter; left time: 1016.2983s
Epoch: 43 cost time: 4.368468523025513
Epoch: 43, Steps: 154 | Train Loss: 1.300 Vali Loss: 3.174 Vali Acc: 0.384 Test Loss: 3.174 Test Acc: 0.384
Validation loss decreased (-0.379126 --> -0.384396).  Saving model ...
	iters: 100, epoch: 44 | loss: 0.9901610
	speed: 0.1128s/iter; left time: 979.2195s
Epoch: 44 cost time: 4.400914669036865
Epoch: 44, Steps: 154 | Train Loss: 1.289 Vali Loss: 3.398 Vali Acc: 0.380 Test Loss: 3.398 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 1.3348343
	speed: 0.1072s/iter; left time: 913.6873s
Epoch: 45 cost time: 4.069848299026489
Epoch: 45, Steps: 154 | Train Loss: 1.315 Vali Loss: 2.912 Vali Acc: 0.377 Test Loss: 2.912 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 1.0787295
	speed: 0.1046s/iter; left time: 875.2544s
Epoch: 46 cost time: 4.284231185913086
Epoch: 46, Steps: 154 | Train Loss: 1.358 Vali Loss: 3.364 Vali Acc: 0.389 Test Loss: 3.364 Test Acc: 0.389
Validation loss decreased (-0.384396 --> -0.388855).  Saving model ...
	iters: 100, epoch: 47 | loss: 1.0886470
	speed: 0.1091s/iter; left time: 896.6999s
Epoch: 47 cost time: 4.484284162521362
Epoch: 47, Steps: 154 | Train Loss: 1.297 Vali Loss: 3.150 Vali Acc: 0.387 Test Loss: 3.150 Test Acc: 0.387
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 48 | loss: 0.6740974
	speed: 0.1066s/iter; left time: 859.2503s
Epoch: 48 cost time: 4.116553068161011
Epoch: 48, Steps: 154 | Train Loss: 1.223 Vali Loss: 3.010 Vali Acc: 0.380 Test Loss: 3.010 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 49 | loss: 0.9037586
	speed: 0.1083s/iter; left time: 856.6089s
Epoch: 49 cost time: 4.2917797565460205
Epoch: 49, Steps: 154 | Train Loss: 1.372 Vali Loss: 3.194 Vali Acc: 0.384 Test Loss: 3.194 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 50 | loss: 1.4799567
	speed: 0.1067s/iter; left time: 827.2438s
Epoch: 50 cost time: 4.395159482955933
Epoch: 50, Steps: 154 | Train Loss: 1.196 Vali Loss: 2.860 Vali Acc: 0.383 Test Loss: 2.860 Test Acc: 0.383
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 51 | loss: 1.3282762
	speed: 0.1065s/iter; left time: 809.1948s
Epoch: 51 cost time: 4.045165538787842
Epoch: 51, Steps: 154 | Train Loss: 1.223 Vali Loss: 3.260 Vali Acc: 0.378 Test Loss: 3.260 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 52 | loss: 1.3079386
	speed: 0.1095s/iter; left time: 815.6206s
Epoch: 52 cost time: 4.232705354690552
Epoch: 52, Steps: 154 | Train Loss: 1.240 Vali Loss: 2.970 Vali Acc: 0.379 Test Loss: 2.970 Test Acc: 0.379
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 53 | loss: 0.9053758
	speed: 0.1083s/iter; left time: 789.5530s
Epoch: 53 cost time: 4.323716163635254
Epoch: 53, Steps: 154 | Train Loss: 1.233 Vali Loss: 3.374 Vali Acc: 0.378 Test Loss: 3.374 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 54 | loss: 0.9959202
	speed: 0.1088s/iter; left time: 776.7142s
Epoch: 54 cost time: 4.208885431289673
Epoch: 54, Steps: 154 | Train Loss: 1.250 Vali Loss: 2.874 Vali Acc: 0.393 Test Loss: 2.874 Test Acc: 0.393
Validation loss decreased (-0.388855 --> -0.393321).  Saving model ...
	iters: 100, epoch: 55 | loss: 0.5254675
	speed: 0.1089s/iter; left time: 760.3584s
Epoch: 55 cost time: 4.406657457351685
Epoch: 55, Steps: 154 | Train Loss: 1.284 Vali Loss: 3.135 Vali Acc: 0.383 Test Loss: 3.135 Test Acc: 0.383
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 56 | loss: 1.3568302
	speed: 0.1122s/iter; left time: 766.7785s
Epoch: 56 cost time: 4.432677268981934
Epoch: 56, Steps: 154 | Train Loss: 1.160 Vali Loss: 3.165 Vali Acc: 0.386 Test Loss: 3.165 Test Acc: 0.386
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 57 | loss: 0.7921282
	speed: 0.1098s/iter; left time: 732.8081s
Epoch: 57 cost time: 4.243520498275757
Epoch: 57, Steps: 154 | Train Loss: 1.241 Vali Loss: 3.314 Vali Acc: 0.386 Test Loss: 3.314 Test Acc: 0.386
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 58 | loss: 0.6688033
	speed: 0.1111s/iter; left time: 724.7275s
Epoch: 58 cost time: 4.581714868545532
Epoch: 58, Steps: 154 | Train Loss: 1.226 Vali Loss: 3.259 Vali Acc: 0.380 Test Loss: 3.259 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 59 | loss: 1.3420429
	speed: 0.1127s/iter; left time: 717.8169s
Epoch: 59 cost time: 4.273277521133423
Epoch: 59, Steps: 154 | Train Loss: 1.203 Vali Loss: 3.280 Vali Acc: 0.385 Test Loss: 3.280 Test Acc: 0.385
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 60 | loss: 0.6277511
	speed: 0.1115s/iter; left time: 692.7773s
Epoch: 60 cost time: 4.482753038406372
Epoch: 60, Steps: 154 | Train Loss: 1.199 Vali Loss: 3.512 Vali Acc: 0.387 Test Loss: 3.512 Test Acc: 0.387
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 61 | loss: 0.9955060
	speed: 0.1135s/iter; left time: 687.7436s
Epoch: 61 cost time: 4.463642835617065
Epoch: 61, Steps: 154 | Train Loss: 1.188 Vali Loss: 3.394 Vali Acc: 0.387 Test Loss: 3.394 Test Acc: 0.387
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 62 | loss: 0.6888598
	speed: 0.1100s/iter; left time: 650.0471s
Epoch: 62 cost time: 4.06031060218811
Epoch: 62, Steps: 154 | Train Loss: 1.093 Vali Loss: 3.592 Vali Acc: 0.383 Test Loss: 3.592 Test Acc: 0.383
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 63 | loss: 1.3265536
	speed: 0.1045s/iter; left time: 601.3200s
Epoch: 63 cost time: 3.988083839416504
Epoch: 63, Steps: 154 | Train Loss: 1.216 Vali Loss: 3.429 Vali Acc: 0.389 Test Loss: 3.429 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 64 | loss: 1.2509185
	speed: 0.1033s/iter; left time: 578.3793s
Epoch: 64 cost time: 4.0820488929748535
Epoch: 64, Steps: 154 | Train Loss: 1.190 Vali Loss: 3.364 Vali Acc: 0.393 Test Loss: 3.364 Test Acc: 0.393
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3933495539334955
model parameter : 51382
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1085100
	speed: 0.0430s/iter; left time: 657.3759s
Epoch: 1 cost time: 5.756123304367065
Epoch: 1, Steps: 154 | Train Loss: 2.307 Vali Loss: 2.158 Vali Acc: 0.319 Test Loss: 2.158 Test Acc: 0.319
Validation loss decreased (inf --> -0.318713).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7764397
	speed: 0.1087s/iter; left time: 1647.1103s
Epoch: 2 cost time: 4.424413681030273
Epoch: 2, Steps: 154 | Train Loss: 2.093 Vali Loss: 2.137 Vali Acc: 0.319 Test Loss: 2.137 Test Acc: 0.319
Validation loss decreased (-0.318713 --> -0.319119).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1108813
	speed: 0.1054s/iter; left time: 1579.6757s
Epoch: 3 cost time: 4.057270050048828
Epoch: 3, Steps: 154 | Train Loss: 2.024 Vali Loss: 2.142 Vali Acc: 0.321 Test Loss: 2.142 Test Acc: 0.321
Validation loss decreased (-0.319119 --> -0.320741).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0903952
	speed: 0.1052s/iter; left time: 1561.0325s
Epoch: 4 cost time: 4.19886589050293
Epoch: 4, Steps: 154 | Train Loss: 1.990 Vali Loss: 2.122 Vali Acc: 0.320 Test Loss: 2.122 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7272316
	speed: 0.1066s/iter; left time: 1565.1992s
Epoch: 5 cost time: 4.2349231243133545
Epoch: 5, Steps: 154 | Train Loss: 1.951 Vali Loss: 2.158 Vali Acc: 0.322 Test Loss: 2.158 Test Acc: 0.322
Validation loss decreased (-0.320741 --> -0.321552).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0803003
	speed: 0.1074s/iter; left time: 1560.9071s
Epoch: 6 cost time: 4.2466514110565186
Epoch: 6, Steps: 154 | Train Loss: 1.929 Vali Loss: 2.150 Vali Acc: 0.321 Test Loss: 2.150 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.1027465
	speed: 0.1123s/iter; left time: 1614.3339s
Epoch: 7 cost time: 4.242171764373779
Epoch: 7, Steps: 154 | Train Loss: 1.909 Vali Loss: 2.133 Vali Acc: 0.324 Test Loss: 2.133 Test Acc: 0.324
Validation loss decreased (-0.321552 --> -0.323985).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1079385
	speed: 0.1079s/iter; left time: 1534.0454s
Epoch: 8 cost time: 4.3529722690582275
Epoch: 8, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.140 Vali Acc: 0.324 Test Loss: 2.140 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6837484
	speed: 0.1116s/iter; left time: 1570.1907s
Epoch: 9 cost time: 4.35034966468811
Epoch: 9, Steps: 154 | Train Loss: 1.859 Vali Loss: 2.148 Vali Acc: 0.324 Test Loss: 2.148 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.9225408
	speed: 0.1112s/iter; left time: 1547.4255s
Epoch: 10 cost time: 4.513384580612183
Epoch: 10, Steps: 154 | Train Loss: 1.835 Vali Loss: 2.156 Vali Acc: 0.325 Test Loss: 2.156 Test Acc: 0.325
Validation loss decreased (-0.323985 --> -0.325201).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7053895
	speed: 0.1135s/iter; left time: 1561.1946s
Epoch: 11 cost time: 4.578680515289307
Epoch: 11, Steps: 154 | Train Loss: 1.819 Vali Loss: 2.158 Vali Acc: 0.324 Test Loss: 2.158 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.2276390
	speed: 0.1113s/iter; left time: 1514.5012s
Epoch: 12 cost time: 4.258064270019531
Epoch: 12, Steps: 154 | Train Loss: 1.787 Vali Loss: 2.139 Vali Acc: 0.327 Test Loss: 2.139 Test Acc: 0.327
Validation loss decreased (-0.325201 --> -0.327229).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.1675787
	speed: 0.1107s/iter; left time: 1489.1238s
Epoch: 13 cost time: 4.284294843673706
Epoch: 13, Steps: 154 | Train Loss: 1.792 Vali Loss: 2.135 Vali Acc: 0.326 Test Loss: 2.135 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.7981400
	speed: 0.1114s/iter; left time: 1480.8598s
Epoch: 14 cost time: 4.134753942489624
Epoch: 14, Steps: 154 | Train Loss: 1.754 Vali Loss: 2.169 Vali Acc: 0.327 Test Loss: 2.169 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.0630352
	speed: 0.1067s/iter; left time: 1402.3512s
Epoch: 15 cost time: 4.15081000328064
Epoch: 15, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.240 Vali Acc: 0.328 Test Loss: 2.240 Test Acc: 0.328
Validation loss decreased (-0.327229 --> -0.328445).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5855664
	speed: 0.1130s/iter; left time: 1467.4742s
Epoch: 16 cost time: 4.33998441696167
Epoch: 16, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.164 Vali Acc: 0.335 Test Loss: 2.164 Test Acc: 0.335
Validation loss decreased (-0.328445 --> -0.334934).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.9005786
	speed: 0.1110s/iter; left time: 1425.2152s
Epoch: 17 cost time: 4.262373447418213
Epoch: 17, Steps: 154 | Train Loss: 1.728 Vali Loss: 2.213 Vali Acc: 0.339 Test Loss: 2.213 Test Acc: 0.339
Validation loss decreased (-0.334934 --> -0.338988).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6428429
	speed: 0.1115s/iter; left time: 1413.8368s
Epoch: 18 cost time: 4.180482864379883
Epoch: 18, Steps: 154 | Train Loss: 1.704 Vali Loss: 2.235 Vali Acc: 0.339 Test Loss: 2.235 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.1273538
	speed: 0.1078s/iter; left time: 1350.6953s
Epoch: 19 cost time: 4.3886330127716064
Epoch: 19, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.184 Vali Acc: 0.339 Test Loss: 2.184 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.6005843
	speed: 0.1095s/iter; left time: 1355.3480s
Epoch: 20 cost time: 4.2102086544036865
Epoch: 20, Steps: 154 | Train Loss: 1.660 Vali Loss: 2.269 Vali Acc: 0.339 Test Loss: 2.269 Test Acc: 0.339
Validation loss decreased (-0.338988 --> -0.339393).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.7273581
	speed: 0.1049s/iter; left time: 1282.5793s
Epoch: 21 cost time: 4.204405307769775
Epoch: 21, Steps: 154 | Train Loss: 1.677 Vali Loss: 2.304 Vali Acc: 0.341 Test Loss: 2.304 Test Acc: 0.341
Validation loss decreased (-0.339393 --> -0.341421).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.7193438
	speed: 0.1091s/iter; left time: 1316.0938s
Epoch: 22 cost time: 4.177262544631958
Epoch: 22, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.257 Vali Acc: 0.348 Test Loss: 2.257 Test Acc: 0.348
Validation loss decreased (-0.341421 --> -0.347504).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.8326290
	speed: 0.1084s/iter; left time: 1291.1023s
Epoch: 23 cost time: 4.550647497177124
Epoch: 23, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.305 Vali Acc: 0.347 Test Loss: 2.305 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.7724385
	speed: 0.1068s/iter; left time: 1255.3702s
Epoch: 24 cost time: 4.236812353134155
Epoch: 24, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.282 Vali Acc: 0.345 Test Loss: 2.282 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.3701721
	speed: 0.1191s/iter; left time: 1382.0743s
Epoch: 25 cost time: 4.454789876937866
Epoch: 25, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.402 Vali Acc: 0.344 Test Loss: 2.402 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.1623988
	speed: 0.1089s/iter; left time: 1246.8211s
Epoch: 26 cost time: 4.225544691085815
Epoch: 26, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.309 Vali Acc: 0.350 Test Loss: 2.309 Test Acc: 0.350
Validation loss decreased (-0.347504 --> -0.349531).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.5071230
	speed: 0.1130s/iter; left time: 1277.0540s
Epoch: 27 cost time: 4.35765528678894
Epoch: 27, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.314 Vali Acc: 0.350 Test Loss: 2.314 Test Acc: 0.350
Validation loss decreased (-0.349531 --> -0.350342).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.2173764
	speed: 0.1105s/iter; left time: 1231.7604s
Epoch: 28 cost time: 4.460875034332275
Epoch: 28, Steps: 154 | Train Loss: 1.646 Vali Loss: 2.365 Vali Acc: 0.354 Test Loss: 2.365 Test Acc: 0.354
Validation loss decreased (-0.350342 --> -0.354396).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.3413513
	speed: 0.1107s/iter; left time: 1216.2724s
Epoch: 29 cost time: 4.390018701553345
Epoch: 29, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.313 Vali Acc: 0.354 Test Loss: 2.313 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.2661194
	speed: 0.1059s/iter; left time: 1146.9478s
Epoch: 30 cost time: 4.15832781791687
Epoch: 30, Steps: 154 | Train Loss: 1.568 Vali Loss: 2.292 Vali Acc: 0.357 Test Loss: 2.292 Test Acc: 0.357
Validation loss decreased (-0.354396 --> -0.357236).  Saving model ...
	iters: 100, epoch: 31 | loss: 1.8428007
	speed: 0.1090s/iter; left time: 1163.8862s
Epoch: 31 cost time: 4.18971061706543
Epoch: 31, Steps: 154 | Train Loss: 1.603 Vali Loss: 2.343 Vali Acc: 0.353 Test Loss: 2.343 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.9877584
	speed: 0.1065s/iter; left time: 1120.8411s
Epoch: 32 cost time: 4.193156480789185
Epoch: 32, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.348 Vali Acc: 0.355 Test Loss: 2.348 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 1.6545669
	speed: 0.1057s/iter; left time: 1096.7196s
Epoch: 33 cost time: 4.1392974853515625
Epoch: 33, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.379 Vali Acc: 0.355 Test Loss: 2.379 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 1.3168588
	speed: 0.1127s/iter; left time: 1151.4352s
Epoch: 34 cost time: 4.285465478897095
Epoch: 34, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.324 Vali Acc: 0.358 Test Loss: 2.324 Test Acc: 0.358
Validation loss decreased (-0.357236 --> -0.357641).  Saving model ...
	iters: 100, epoch: 35 | loss: 20.0619125
	speed: 0.1057s/iter; left time: 1064.2907s
Epoch: 35 cost time: 3.9211649894714355
Epoch: 35, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.537 Vali Acc: 0.361 Test Loss: 2.537 Test Acc: 0.361
Validation loss decreased (-0.357641 --> -0.360477).  Saving model ...
	iters: 100, epoch: 36 | loss: 1.3314421
	speed: 0.1080s/iter; left time: 1070.6333s
Epoch: 36 cost time: 4.2119739055633545
Epoch: 36, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.501 Vali Acc: 0.359 Test Loss: 2.501 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.9254121
	speed: 0.1101s/iter; left time: 1073.7730s
Epoch: 37 cost time: 4.223349332809448
Epoch: 37, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.320 Vali Acc: 0.366 Test Loss: 2.320 Test Acc: 0.366
Validation loss decreased (-0.360477 --> -0.365751).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.9207875
	speed: 0.1065s/iter; left time: 1022.9138s
Epoch: 38 cost time: 4.18735408782959
Epoch: 38, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.625 Vali Acc: 0.364 Test Loss: 2.625 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 1.4884342
	speed: 0.1079s/iter; left time: 1019.4330s
Epoch: 39 cost time: 4.243169784545898
Epoch: 39, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.544 Vali Acc: 0.373 Test Loss: 2.544 Test Acc: 0.373
Validation loss decreased (-0.365751 --> -0.373454).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.2486150
	speed: 0.1072s/iter; left time: 996.6046s
Epoch: 40 cost time: 4.451354503631592
Epoch: 40, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.676 Vali Acc: 0.364 Test Loss: 2.676 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 1.0846893
	speed: 0.1084s/iter; left time: 991.0255s
Epoch: 41 cost time: 4.275958061218262
Epoch: 41, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.391 Vali Acc: 0.363 Test Loss: 2.391 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 1.2510488
	speed: 0.1109s/iter; left time: 996.5197s
Epoch: 42 cost time: 4.393742561340332
Epoch: 42, Steps: 154 | Train Loss: 1.381 Vali Loss: 2.510 Vali Acc: 0.369 Test Loss: 2.510 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 1.4495392
	speed: 0.1150s/iter; left time: 1016.1195s
Epoch: 43 cost time: 4.651816129684448
Epoch: 43, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.663 Vali Acc: 0.362 Test Loss: 2.663 Test Acc: 0.362
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 1.7810036
	speed: 0.1067s/iter; left time: 926.2965s
Epoch: 44 cost time: 4.146020174026489
Epoch: 44, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.585 Vali Acc: 0.361 Test Loss: 2.585 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 5.7899232
	speed: 0.1112s/iter; left time: 948.1863s
Epoch: 45 cost time: 4.3941404819488525
Epoch: 45, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.744 Vali Acc: 0.226 Test Loss: 2.744 Test Acc: 0.226
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 46 | loss: 1.3525094
	speed: 0.1128s/iter; left time: 944.2816s
Epoch: 46 cost time: 4.51308536529541
Epoch: 46, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.550 Vali Acc: 0.362 Test Loss: 2.550 Test Acc: 0.362
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 47 | loss: 1.6694815
	speed: 0.1053s/iter; left time: 864.9193s
Epoch: 47 cost time: 4.35160756111145
Epoch: 47, Steps: 154 | Train Loss: 1.397 Vali Loss: 2.859 Vali Acc: 0.337 Test Loss: 2.859 Test Acc: 0.337
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 48 | loss: 1.5051343
	speed: 0.1070s/iter; left time: 863.0492s
Epoch: 48 cost time: 4.1515278816223145
Epoch: 48, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.492 Vali Acc: 0.374 Test Loss: 2.492 Test Acc: 0.374
Validation loss decreased (-0.373454 --> -0.374265).  Saving model ...
	iters: 100, epoch: 49 | loss: 1.8056737
	speed: 0.1064s/iter; left time: 841.2923s
Epoch: 49 cost time: 4.297655820846558
Epoch: 49, Steps: 154 | Train Loss: 1.341 Vali Loss: 2.939 Vali Acc: 0.354 Test Loss: 2.939 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 50 | loss: 0.7881062
	speed: 0.0936s/iter; left time: 725.5694s
Epoch: 50 cost time: 3.7571489810943604
Epoch: 50, Steps: 154 | Train Loss: 1.353 Vali Loss: 2.804 Vali Acc: 0.372 Test Loss: 2.804 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 51 | loss: 1.6511458
	speed: 0.1051s/iter; left time: 798.7317s
Epoch: 51 cost time: 4.251506567001343
Epoch: 51, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.495 Vali Acc: 0.376 Test Loss: 2.495 Test Acc: 0.376
Validation loss decreased (-0.374265 --> -0.375482).  Saving model ...
	iters: 100, epoch: 52 | loss: 1.2624133
	speed: 0.1075s/iter; left time: 800.5734s
Epoch: 52 cost time: 4.043324708938599
Epoch: 52, Steps: 154 | Train Loss: 1.344 Vali Loss: 2.833 Vali Acc: 0.373 Test Loss: 2.833 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 53 | loss: 0.8994206
	speed: 0.1063s/iter; left time: 775.0402s
Epoch: 53 cost time: 4.1106860637664795
Epoch: 53, Steps: 154 | Train Loss: 1.404 Vali Loss: 2.567 Vali Acc: 0.376 Test Loss: 2.567 Test Acc: 0.376
Validation loss decreased (-0.375482 --> -0.375887).  Saving model ...
	iters: 100, epoch: 54 | loss: 1.5097866
	speed: 0.1102s/iter; left time: 786.9335s
Epoch: 54 cost time: 4.117974042892456
Epoch: 54, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.905 Vali Acc: 0.380 Test Loss: 2.905 Test Acc: 0.380
Validation loss decreased (-0.375887 --> -0.379533).  Saving model ...
	iters: 100, epoch: 55 | loss: 1.0835509
	speed: 0.1085s/iter; left time: 757.6489s
Epoch: 55 cost time: 4.078479766845703
Epoch: 55, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.717 Vali Acc: 0.380 Test Loss: 2.717 Test Acc: 0.380
Validation loss decreased (-0.379533 --> -0.379940).  Saving model ...
	iters: 100, epoch: 56 | loss: 1.3107717
	speed: 0.1083s/iter; left time: 739.8267s
Epoch: 56 cost time: 4.209649324417114
Epoch: 56, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.805 Vali Acc: 0.374 Test Loss: 2.805 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 57 | loss: 1.4527169
	speed: 0.1010s/iter; left time: 674.3769s
Epoch: 57 cost time: 4.593703746795654
Epoch: 57, Steps: 154 | Train Loss: 1.334 Vali Loss: 2.863 Vali Acc: 0.374 Test Loss: 2.863 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 58 | loss: 0.9233897
	speed: 0.1094s/iter; left time: 713.3081s
Epoch: 58 cost time: 3.93388295173645
Epoch: 58, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.691 Vali Acc: 0.376 Test Loss: 2.691 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 59 | loss: 1.0062187
	speed: 0.0863s/iter; left time: 549.6160s
Epoch: 59 cost time: 3.544147253036499
Epoch: 59, Steps: 154 | Train Loss: 1.329 Vali Loss: 2.831 Vali Acc: 0.371 Test Loss: 2.831 Test Acc: 0.371
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 60 | loss: 1.5334768
	speed: 0.0878s/iter; left time: 545.5996s
Epoch: 60 cost time: 3.5869064331054688
Epoch: 60, Steps: 154 | Train Loss: 1.301 Vali Loss: 2.796 Vali Acc: 0.381 Test Loss: 2.796 Test Acc: 0.381
Validation loss decreased (-0.379940 --> -0.380751).  Saving model ...
	iters: 100, epoch: 61 | loss: 1.3040094
	speed: 0.1093s/iter; left time: 662.3295s
Epoch: 61 cost time: 4.578731536865234
Epoch: 61, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.915 Vali Acc: 0.381 Test Loss: 2.915 Test Acc: 0.381
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 62 | loss: 1.4150645
	speed: 0.1094s/iter; left time: 646.0999s
Epoch: 62 cost time: 4.336925745010376
Epoch: 62, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.804 Vali Acc: 0.380 Test Loss: 2.804 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 63 | loss: 0.9312792
	speed: 0.1097s/iter; left time: 631.3211s
Epoch: 63 cost time: 4.3633081912994385
Epoch: 63, Steps: 154 | Train Loss: 1.340 Vali Loss: 2.828 Vali Acc: 0.376 Test Loss: 2.828 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 64 | loss: 1.6526458
	speed: 0.1092s/iter; left time: 611.6792s
Epoch: 64 cost time: 4.632215261459351
Epoch: 64, Steps: 154 | Train Loss: 1.412 Vali Loss: 2.953 Vali Acc: 0.382 Test Loss: 2.953 Test Acc: 0.382
Validation loss decreased (-0.380751 --> -0.381966).  Saving model ...
	iters: 100, epoch: 65 | loss: 1.2848763
	speed: 0.1101s/iter; left time: 599.5011s
Epoch: 65 cost time: 4.38236665725708
Epoch: 65, Steps: 154 | Train Loss: 1.299 Vali Loss: 3.116 Vali Acc: 0.382 Test Loss: 3.116 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 66 | loss: 1.5910527
	speed: 0.1057s/iter; left time: 559.2170s
Epoch: 66 cost time: 4.1112961769104
Epoch: 66, Steps: 154 | Train Loss: 1.335 Vali Loss: 2.865 Vali Acc: 0.385 Test Loss: 2.865 Test Acc: 0.385
Validation loss decreased (-0.381966 --> -0.384805).  Saving model ...
	iters: 100, epoch: 67 | loss: 1.6237886
	speed: 0.1114s/iter; left time: 572.2017s
Epoch: 67 cost time: 4.52192497253418
Epoch: 67, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.788 Vali Acc: 0.383 Test Loss: 2.788 Test Acc: 0.383
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 68 | loss: 0.6077891
	speed: 0.1067s/iter; left time: 531.5547s
Epoch: 68 cost time: 4.01342511177063
Epoch: 68, Steps: 154 | Train Loss: 1.361 Vali Loss: 2.804 Vali Acc: 0.387 Test Loss: 2.804 Test Acc: 0.387
Validation loss decreased (-0.384805 --> -0.387239).  Saving model ...
	iters: 100, epoch: 69 | loss: 0.9455536
	speed: 0.1059s/iter; left time: 511.5610s
Epoch: 69 cost time: 4.129471063613892
Epoch: 69, Steps: 154 | Train Loss: 1.239 Vali Loss: 2.742 Vali Acc: 0.389 Test Loss: 2.742 Test Acc: 0.389
Validation loss decreased (-0.387239 --> -0.389267).  Saving model ...
	iters: 100, epoch: 70 | loss: 1.4817275
	speed: 0.1056s/iter; left time: 493.8757s
Epoch: 70 cost time: 4.119556665420532
Epoch: 70, Steps: 154 | Train Loss: 1.311 Vali Loss: 2.650 Vali Acc: 0.390 Test Loss: 2.650 Test Acc: 0.390
Validation loss decreased (-0.389267 --> -0.390079).  Saving model ...
	iters: 100, epoch: 71 | loss: 1.6771128
	speed: 0.1050s/iter; left time: 474.8148s
Epoch: 71 cost time: 4.076404094696045
Epoch: 71, Steps: 154 | Train Loss: 1.288 Vali Loss: 2.875 Vali Acc: 0.398 Test Loss: 2.875 Test Acc: 0.398
Validation loss decreased (-0.390079 --> -0.397781).  Saving model ...
	iters: 100, epoch: 72 | loss: 1.2142894
	speed: 0.1049s/iter; left time: 457.9490s
Epoch: 72 cost time: 4.189905881881714
Epoch: 72, Steps: 154 | Train Loss: 1.331 Vali Loss: 2.744 Vali Acc: 0.384 Test Loss: 2.744 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 73 | loss: 1.0536289
	speed: 0.1067s/iter; left time: 449.6134s
Epoch: 73 cost time: 4.394804954528809
Epoch: 73, Steps: 154 | Train Loss: 1.287 Vali Loss: 3.242 Vali Acc: 0.395 Test Loss: 3.242 Test Acc: 0.395
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 74 | loss: 0.9180962
	speed: 0.1050s/iter; left time: 426.1020s
Epoch: 74 cost time: 4.069392919540405
Epoch: 74, Steps: 154 | Train Loss: 1.319 Vali Loss: 3.084 Vali Acc: 0.383 Test Loss: 3.084 Test Acc: 0.383
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 75 | loss: 1.3097408
	speed: 0.1026s/iter; left time: 400.6597s
Epoch: 75 cost time: 4.0266640186309814
Epoch: 75, Steps: 154 | Train Loss: 1.227 Vali Loss: 3.462 Vali Acc: 0.391 Test Loss: 3.462 Test Acc: 0.391
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 76 | loss: 1.2141093
	speed: 0.1024s/iter; left time: 384.2006s
Epoch: 76 cost time: 4.4133405685424805
Epoch: 76, Steps: 154 | Train Loss: 1.262 Vali Loss: 3.311 Vali Acc: 0.388 Test Loss: 3.311 Test Acc: 0.388
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 77 | loss: 1.1656179
	speed: 0.1108s/iter; left time: 398.4352s
Epoch: 77 cost time: 4.153315544128418
Epoch: 77, Steps: 154 | Train Loss: 1.220 Vali Loss: 3.420 Vali Acc: 0.386 Test Loss: 3.420 Test Acc: 0.386
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 78 | loss: 1.3029895
	speed: 0.1071s/iter; left time: 368.6000s
Epoch: 78 cost time: 4.334611177444458
Epoch: 78, Steps: 154 | Train Loss: 1.382 Vali Loss: 3.134 Vali Acc: 0.393 Test Loss: 3.134 Test Acc: 0.393
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 79 | loss: 4.1998110
	speed: 0.1107s/iter; left time: 364.1356s
Epoch: 79 cost time: 4.315230369567871
Epoch: 79, Steps: 154 | Train Loss: 1.472 Vali Loss: 3.210 Vali Acc: 0.373 Test Loss: 3.210 Test Acc: 0.373
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 80 | loss: 1.0931971
	speed: 0.1092s/iter; left time: 342.2743s
Epoch: 80 cost time: 4.15567684173584
Epoch: 80, Steps: 154 | Train Loss: 1.216 Vali Loss: 3.490 Vali Acc: 0.384 Test Loss: 3.490 Test Acc: 0.384
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 81 | loss: 1.0256006
	speed: 0.0987s/iter; left time: 294.2393s
Epoch: 81 cost time: 4.0792036056518555
Epoch: 81, Steps: 154 | Train Loss: 1.292 Vali Loss: 3.118 Vali Acc: 0.383 Test Loss: 3.118 Test Acc: 0.383
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3978102189781022
model parameter : 150646
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0909455
	speed: 0.0440s/iter; left time: 673.6796s
Epoch: 1 cost time: 5.891046047210693
Epoch: 1, Steps: 154 | Train Loss: 2.303 Vali Loss: 2.158 Vali Acc: 0.318 Test Loss: 2.158 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8086511
	speed: 0.1089s/iter; left time: 1649.3434s
Epoch: 2 cost time: 4.268855810165405
Epoch: 2, Steps: 154 | Train Loss: 2.088 Vali Loss: 2.144 Vali Acc: 0.320 Test Loss: 2.144 Test Acc: 0.320
Validation loss decreased (-0.317902 --> -0.319524).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1175849
	speed: 0.1089s/iter; left time: 1632.4197s
Epoch: 3 cost time: 4.209124803543091
Epoch: 3, Steps: 154 | Train Loss: 2.025 Vali Loss: 2.143 Vali Acc: 0.320 Test Loss: 2.143 Test Acc: 0.320
Validation loss decreased (-0.319524 --> -0.319524).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0829711
	speed: 0.1072s/iter; left time: 1590.4812s
Epoch: 4 cost time: 4.226394891738892
Epoch: 4, Steps: 154 | Train Loss: 1.995 Vali Loss: 2.122 Vali Acc: 0.319 Test Loss: 2.122 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7440221
	speed: 0.1125s/iter; left time: 1651.9811s
Epoch: 5 cost time: 4.159286022186279
Epoch: 5, Steps: 154 | Train Loss: 1.950 Vali Loss: 2.156 Vali Acc: 0.319 Test Loss: 2.156 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.1220636
	speed: 0.1142s/iter; left time: 1659.0519s
Epoch: 6 cost time: 4.540189981460571
Epoch: 6, Steps: 154 | Train Loss: 1.937 Vali Loss: 2.153 Vali Acc: 0.322 Test Loss: 2.153 Test Acc: 0.322
Validation loss decreased (-0.319524 --> -0.321552).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1087294
	speed: 0.1058s/iter; left time: 1520.9190s
Epoch: 7 cost time: 3.8509204387664795
Epoch: 7, Steps: 154 | Train Loss: 1.905 Vali Loss: 2.131 Vali Acc: 0.321 Test Loss: 2.131 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.1097436
	speed: 0.1036s/iter; left time: 1474.1699s
Epoch: 8 cost time: 4.113692283630371
Epoch: 8, Steps: 154 | Train Loss: 1.883 Vali Loss: 2.135 Vali Acc: 0.322 Test Loss: 2.135 Test Acc: 0.322
Validation loss decreased (-0.321552 --> -0.321958).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6751577
	speed: 0.1053s/iter; left time: 1481.1753s
Epoch: 9 cost time: 4.179732799530029
Epoch: 9, Steps: 154 | Train Loss: 1.862 Vali Loss: 2.140 Vali Acc: 0.322 Test Loss: 2.140 Test Acc: 0.322
Validation loss decreased (-0.321958 --> -0.322363).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9364951
	speed: 0.1055s/iter; left time: 1467.9718s
Epoch: 10 cost time: 4.164361953735352
Epoch: 10, Steps: 154 | Train Loss: 1.836 Vali Loss: 2.144 Vali Acc: 0.325 Test Loss: 2.144 Test Acc: 0.325
Validation loss decreased (-0.322363 --> -0.325202).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7019565
	speed: 0.1009s/iter; left time: 1389.0928s
Epoch: 11 cost time: 3.917200803756714
Epoch: 11, Steps: 154 | Train Loss: 1.817 Vali Loss: 2.169 Vali Acc: 0.324 Test Loss: 2.169 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.2089579
	speed: 0.0978s/iter; left time: 1331.4374s
Epoch: 12 cost time: 4.300981760025024
Epoch: 12, Steps: 154 | Train Loss: 1.799 Vali Loss: 2.137 Vali Acc: 0.326 Test Loss: 2.137 Test Acc: 0.326
Validation loss decreased (-0.325202 --> -0.326418).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.1872277
	speed: 0.1051s/iter; left time: 1414.1986s
Epoch: 13 cost time: 4.476710796356201
Epoch: 13, Steps: 154 | Train Loss: 1.794 Vali Loss: 2.121 Vali Acc: 0.326 Test Loss: 2.121 Test Acc: 0.326
Validation loss decreased (-0.326418 --> -0.326418).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.8081840
	speed: 0.1113s/iter; left time: 1480.3413s
Epoch: 14 cost time: 4.035077810287476
Epoch: 14, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.157 Vali Acc: 0.327 Test Loss: 2.157 Test Acc: 0.327
Validation loss decreased (-0.326418 --> -0.326824).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0623084
	speed: 0.1075s/iter; left time: 1412.8754s
Epoch: 15 cost time: 4.171077013015747
Epoch: 15, Steps: 154 | Train Loss: 1.751 Vali Loss: 2.215 Vali Acc: 0.330 Test Loss: 2.215 Test Acc: 0.330
Validation loss decreased (-0.326824 --> -0.330067).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5818331
	speed: 0.1100s/iter; left time: 1428.9290s
Epoch: 16 cost time: 4.1434245109558105
Epoch: 16, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.146 Vali Acc: 0.335 Test Loss: 2.146 Test Acc: 0.335
Validation loss decreased (-0.330067 --> -0.335339).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.9408209
	speed: 0.1104s/iter; left time: 1416.8832s
Epoch: 17 cost time: 4.273893594741821
Epoch: 17, Steps: 154 | Train Loss: 1.749 Vali Loss: 2.151 Vali Acc: 0.339 Test Loss: 2.151 Test Acc: 0.339
Validation loss decreased (-0.335339 --> -0.338989).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6347984
	speed: 0.1062s/iter; left time: 1347.0331s
Epoch: 18 cost time: 4.449394702911377
Epoch: 18, Steps: 154 | Train Loss: 1.706 Vali Loss: 2.219 Vali Acc: 0.341 Test Loss: 2.219 Test Acc: 0.341
Validation loss decreased (-0.338989 --> -0.341016).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.0670686
	speed: 0.1043s/iter; left time: 1306.6816s
Epoch: 19 cost time: 4.052844524383545
Epoch: 19, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.235 Vali Acc: 0.339 Test Loss: 2.235 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.5799234
	speed: 0.0998s/iter; left time: 1235.0585s
Epoch: 20 cost time: 4.302454233169556
Epoch: 20, Steps: 154 | Train Loss: 1.662 Vali Loss: 2.276 Vali Acc: 0.340 Test Loss: 2.276 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.7409401
	speed: 0.1078s/iter; left time: 1317.7801s
Epoch: 21 cost time: 4.39814567565918
Epoch: 21, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.280 Vali Acc: 0.342 Test Loss: 2.280 Test Acc: 0.342
Validation loss decreased (-0.341016 --> -0.342232).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.9582144
	speed: 0.1090s/iter; left time: 1314.7835s
Epoch: 22 cost time: 4.344747066497803
Epoch: 22, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.229 Vali Acc: 0.348 Test Loss: 2.229 Test Acc: 0.348
Validation loss decreased (-0.342232 --> -0.347910).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.7869989
	speed: 0.1066s/iter; left time: 1269.7254s
Epoch: 23 cost time: 4.395960807800293
Epoch: 23, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.247 Vali Acc: 0.350 Test Loss: 2.247 Test Acc: 0.350
Validation loss decreased (-0.347910 --> -0.350342).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.8102858
	speed: 0.1114s/iter; left time: 1310.1412s
Epoch: 24 cost time: 4.3155646324157715
Epoch: 24, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.281 Vali Acc: 0.348 Test Loss: 2.281 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.5265762
	speed: 0.1072s/iter; left time: 1243.6235s
Epoch: 25 cost time: 4.120173215866089
Epoch: 25, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.255 Vali Acc: 0.348 Test Loss: 2.255 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.2268550
	speed: 0.1073s/iter; left time: 1228.4591s
Epoch: 26 cost time: 4.356487035751343
Epoch: 26, Steps: 154 | Train Loss: 1.597 Vali Loss: 2.255 Vali Acc: 0.348 Test Loss: 2.255 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.5143170
	speed: 0.1098s/iter; left time: 1240.7203s
Epoch: 27 cost time: 4.186122417449951
Epoch: 27, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.243 Vali Acc: 0.348 Test Loss: 2.243 Test Acc: 0.348
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.1842707
	speed: 0.1080s/iter; left time: 1203.2657s
Epoch: 28 cost time: 4.141341209411621
Epoch: 28, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.310 Vali Acc: 0.356 Test Loss: 2.310 Test Acc: 0.356
Validation loss decreased (-0.350342 --> -0.356425).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.3291235
	speed: 0.1075s/iter; left time: 1181.4771s
Epoch: 29 cost time: 4.372362852096558
Epoch: 29, Steps: 154 | Train Loss: 1.592 Vali Loss: 2.246 Vali Acc: 0.348 Test Loss: 2.246 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.1979361
	speed: 0.1110s/iter; left time: 1202.5060s
Epoch: 30 cost time: 4.2516045570373535
Epoch: 30, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.279 Vali Acc: 0.353 Test Loss: 2.279 Test Acc: 0.353
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 2.0282393
	speed: 0.1091s/iter; left time: 1165.3391s
Epoch: 31 cost time: 4.212625503540039
Epoch: 31, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.348 Vali Acc: 0.354 Test Loss: 2.348 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.0913465
	speed: 0.1086s/iter; left time: 1142.7653s
Epoch: 32 cost time: 4.174433708190918
Epoch: 32, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.401 Vali Acc: 0.350 Test Loss: 2.401 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 1.7801661
	speed: 0.1108s/iter; left time: 1149.0923s
Epoch: 33 cost time: 4.257790803909302
Epoch: 33, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.341 Vali Acc: 0.357 Test Loss: 2.341 Test Acc: 0.357
Validation loss decreased (-0.356425 --> -0.356830).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.3326534
	speed: 0.1121s/iter; left time: 1145.2130s
Epoch: 34 cost time: 4.140835285186768
Epoch: 34, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.375 Vali Acc: 0.358 Test Loss: 2.375 Test Acc: 0.358
Validation loss decreased (-0.356830 --> -0.358046).  Saving model ...
	iters: 100, epoch: 35 | loss: 13.0490465
	speed: 0.1107s/iter; left time: 1114.6745s
Epoch: 35 cost time: 4.56392502784729
Epoch: 35, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.545 Vali Acc: 0.366 Test Loss: 2.545 Test Acc: 0.366
Validation loss decreased (-0.358046 --> -0.366155).  Saving model ...
	iters: 100, epoch: 36 | loss: 1.2729770
	speed: 0.1139s/iter; left time: 1129.2193s
Epoch: 36 cost time: 4.109973907470703
Epoch: 36, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.371 Vali Acc: 0.364 Test Loss: 2.371 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.8662317
	speed: 0.1087s/iter; left time: 1060.6878s
Epoch: 37 cost time: 4.341817855834961
Epoch: 37, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.310 Vali Acc: 0.359 Test Loss: 2.310 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 1.5861176
	speed: 0.1090s/iter; left time: 1046.8131s
Epoch: 38 cost time: 4.37482762336731
Epoch: 38, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.325 Vali Acc: 0.363 Test Loss: 2.325 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 1.4862584
	speed: 0.1089s/iter; left time: 1028.9524s
Epoch: 39 cost time: 4.360028266906738
Epoch: 39, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.311 Vali Acc: 0.367 Test Loss: 2.311 Test Acc: 0.367
Validation loss decreased (-0.366155 --> -0.366562).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.7750043
	speed: 0.1082s/iter; left time: 1005.4871s
Epoch: 40 cost time: 4.309507369995117
Epoch: 40, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.526 Vali Acc: 0.362 Test Loss: 2.526 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 1.0649495
	speed: 0.1101s/iter; left time: 1006.7992s
Epoch: 41 cost time: 4.440216779708862
Epoch: 41, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.406 Vali Acc: 0.361 Test Loss: 2.406 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 1.1246144
	speed: 0.1076s/iter; left time: 966.6661s
Epoch: 42 cost time: 4.270815849304199
Epoch: 42, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.411 Vali Acc: 0.365 Test Loss: 2.411 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 1.3034084
	speed: 0.1091s/iter; left time: 963.8578s
Epoch: 43 cost time: 4.196843385696411
Epoch: 43, Steps: 154 | Train Loss: 1.392 Vali Loss: 2.619 Vali Acc: 0.360 Test Loss: 2.619 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 1.6353139
	speed: 0.1052s/iter; left time: 912.9417s
Epoch: 44 cost time: 4.309516429901123
Epoch: 44, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.450 Vali Acc: 0.365 Test Loss: 2.450 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 10.7778444
	speed: 0.1118s/iter; left time: 952.7407s
Epoch: 45 cost time: 4.261722087860107
Epoch: 45, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.961 Vali Acc: 0.377 Test Loss: 2.961 Test Acc: 0.377
Validation loss decreased (-0.366562 --> -0.376694).  Saving model ...
	iters: 100, epoch: 46 | loss: 1.4095358
	speed: 0.1085s/iter; left time: 907.9991s
Epoch: 46 cost time: 4.305567502975464
Epoch: 46, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.562 Vali Acc: 0.366 Test Loss: 2.562 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 47 | loss: 1.6028899
	speed: 0.1075s/iter; left time: 883.5587s
Epoch: 47 cost time: 4.2477521896362305
Epoch: 47, Steps: 154 | Train Loss: 1.401 Vali Loss: 2.921 Vali Acc: 0.377 Test Loss: 2.921 Test Acc: 0.377
Validation loss decreased (-0.376694 --> -0.377100).  Saving model ...
	iters: 100, epoch: 48 | loss: 1.4119864
	speed: 0.1029s/iter; left time: 829.2853s
Epoch: 48 cost time: 3.940960168838501
Epoch: 48, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.576 Vali Acc: 0.374 Test Loss: 2.576 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 49 | loss: 1.7921994
	speed: 0.0977s/iter; left time: 773.0529s
Epoch: 49 cost time: 4.104554176330566
Epoch: 49, Steps: 154 | Train Loss: 1.372 Vali Loss: 2.769 Vali Acc: 0.372 Test Loss: 2.769 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 50 | loss: 0.7902693
	speed: 0.1066s/iter; left time: 826.3098s
Epoch: 50 cost time: 4.1760406494140625
Epoch: 50, Steps: 154 | Train Loss: 1.370 Vali Loss: 2.636 Vali Acc: 0.367 Test Loss: 2.636 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 51 | loss: 1.7224376
	speed: 0.1066s/iter; left time: 810.0282s
Epoch: 51 cost time: 4.143562078475952
Epoch: 51, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.775 Vali Acc: 0.371 Test Loss: 2.775 Test Acc: 0.371
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 52 | loss: 1.3063998
	speed: 0.1090s/iter; left time: 811.7617s
Epoch: 52 cost time: 4.304964303970337
Epoch: 52, Steps: 154 | Train Loss: 1.352 Vali Loss: 2.729 Vali Acc: 0.375 Test Loss: 2.729 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 53 | loss: 0.9668791
	speed: 0.1104s/iter; left time: 804.8269s
Epoch: 53 cost time: 4.1147706508636475
Epoch: 53, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.692 Vali Acc: 0.376 Test Loss: 2.692 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 54 | loss: 1.5296896
	speed: 0.1132s/iter; left time: 808.2262s
Epoch: 54 cost time: 4.335938930511475
Epoch: 54, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.746 Vali Acc: 0.373 Test Loss: 2.746 Test Acc: 0.373
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 55 | loss: 1.0774634
	speed: 0.1077s/iter; left time: 752.1818s
Epoch: 55 cost time: 4.106139183044434
Epoch: 55, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.582 Vali Acc: 0.372 Test Loss: 2.582 Test Acc: 0.372
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 56 | loss: 1.3402056
	speed: 0.1094s/iter; left time: 747.2980s
Epoch: 56 cost time: 4.371503591537476
Epoch: 56, Steps: 154 | Train Loss: 1.415 Vali Loss: 2.947 Vali Acc: 0.367 Test Loss: 2.947 Test Acc: 0.367
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 57 | loss: 1.5932208
	speed: 0.1105s/iter; left time: 737.6311s
Epoch: 57 cost time: 4.402884244918823
Epoch: 57, Steps: 154 | Train Loss: 1.335 Vali Loss: 3.052 Vali Acc: 0.368 Test Loss: 3.052 Test Acc: 0.368
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3771289537712895
model parameter : 150646
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0995882
	speed: 0.0440s/iter; left time: 673.8794s
Epoch: 1 cost time: 5.826558589935303
Epoch: 1, Steps: 154 | Train Loss: 2.294 Vali Loss: 2.163 Vali Acc: 0.318 Test Loss: 2.163 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8266733
	speed: 0.1037s/iter; left time: 1571.0736s
Epoch: 2 cost time: 3.979780912399292
Epoch: 2, Steps: 154 | Train Loss: 2.085 Vali Loss: 2.143 Vali Acc: 0.319 Test Loss: 2.143 Test Acc: 0.319
Validation loss decreased (-0.317902 --> -0.319119).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1300216
	speed: 0.1048s/iter; left time: 1571.6082s
Epoch: 3 cost time: 4.125863313674927
Epoch: 3, Steps: 154 | Train Loss: 2.024 Vali Loss: 2.143 Vali Acc: 0.319 Test Loss: 2.143 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.0909841
	speed: 0.1102s/iter; left time: 1634.8344s
Epoch: 4 cost time: 4.327038288116455
Epoch: 4, Steps: 154 | Train Loss: 1.991 Vali Loss: 2.122 Vali Acc: 0.318 Test Loss: 2.122 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.7940638
	speed: 0.1103s/iter; left time: 1620.1260s
Epoch: 5 cost time: 4.239532709121704
Epoch: 5, Steps: 154 | Train Loss: 1.962 Vali Loss: 2.142 Vali Acc: 0.319 Test Loss: 2.142 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.1538057
	speed: 0.1113s/iter; left time: 1617.8791s
Epoch: 6 cost time: 4.45991849899292
Epoch: 6, Steps: 154 | Train Loss: 1.949 Vali Loss: 2.147 Vali Acc: 0.320 Test Loss: 2.147 Test Acc: 0.320
Validation loss decreased (-0.319119 --> -0.319524).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1193569
	speed: 0.1051s/iter; left time: 1510.9932s
Epoch: 7 cost time: 4.199485778808594
Epoch: 7, Steps: 154 | Train Loss: 1.913 Vali Loss: 2.120 Vali Acc: 0.321 Test Loss: 2.120 Test Acc: 0.321
Validation loss decreased (-0.319524 --> -0.320741).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0973330
	speed: 0.1071s/iter; left time: 1522.7853s
Epoch: 8 cost time: 4.2003185749053955
Epoch: 8, Steps: 154 | Train Loss: 1.888 Vali Loss: 2.120 Vali Acc: 0.322 Test Loss: 2.120 Test Acc: 0.322
Validation loss decreased (-0.320741 --> -0.322363).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6784892
	speed: 0.1072s/iter; left time: 1508.4859s
Epoch: 9 cost time: 4.2882726192474365
Epoch: 9, Steps: 154 | Train Loss: 1.868 Vali Loss: 2.134 Vali Acc: 0.323 Test Loss: 2.134 Test Acc: 0.323
Validation loss decreased (-0.322363 --> -0.323174).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0112767
	speed: 0.1089s/iter; left time: 1515.3424s
Epoch: 10 cost time: 4.291696071624756
Epoch: 10, Steps: 154 | Train Loss: 1.838 Vali Loss: 2.151 Vali Acc: 0.324 Test Loss: 2.151 Test Acc: 0.324
Validation loss decreased (-0.323174 --> -0.323985).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5662552
	speed: 0.1088s/iter; left time: 1497.5032s
Epoch: 11 cost time: 4.343228340148926
Epoch: 11, Steps: 154 | Train Loss: 1.815 Vali Loss: 2.170 Vali Acc: 0.325 Test Loss: 2.170 Test Acc: 0.325
Validation loss decreased (-0.323985 --> -0.324796).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.1796703
	speed: 0.1088s/iter; left time: 1480.3903s
Epoch: 12 cost time: 4.531678199768066
Epoch: 12, Steps: 154 | Train Loss: 1.794 Vali Loss: 2.131 Vali Acc: 0.329 Test Loss: 2.131 Test Acc: 0.329
Validation loss decreased (-0.324796 --> -0.328851).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.9284724
	speed: 0.1137s/iter; left time: 1529.8410s
Epoch: 13 cost time: 4.357203722000122
Epoch: 13, Steps: 154 | Train Loss: 1.773 Vali Loss: 2.139 Vali Acc: 0.330 Test Loss: 2.139 Test Acc: 0.330
Validation loss decreased (-0.328851 --> -0.330473).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.7742794
	speed: 0.1095s/iter; left time: 1455.7226s
Epoch: 14 cost time: 4.343380689620972
Epoch: 14, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.184 Vali Acc: 0.331 Test Loss: 2.184 Test Acc: 0.331
Validation loss decreased (-0.330473 --> -0.330878).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.8095618
	speed: 0.1114s/iter; left time: 1464.1255s
Epoch: 15 cost time: 4.296623468399048
Epoch: 15, Steps: 154 | Train Loss: 1.749 Vali Loss: 2.218 Vali Acc: 0.330 Test Loss: 2.218 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.5536406
	speed: 0.1068s/iter; left time: 1387.5809s
Epoch: 16 cost time: 4.314902305603027
Epoch: 16, Steps: 154 | Train Loss: 1.741 Vali Loss: 2.157 Vali Acc: 0.339 Test Loss: 2.157 Test Acc: 0.339
Validation loss decreased (-0.330878 --> -0.339394).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.9448850
	speed: 0.1088s/iter; left time: 1396.2233s
Epoch: 17 cost time: 4.340776205062866
Epoch: 17, Steps: 154 | Train Loss: 1.780 Vali Loss: 2.158 Vali Acc: 0.346 Test Loss: 2.158 Test Acc: 0.346
Validation loss decreased (-0.339394 --> -0.345883).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6238695
	speed: 0.1071s/iter; left time: 1358.7902s
Epoch: 18 cost time: 4.230469465255737
Epoch: 18, Steps: 154 | Train Loss: 1.701 Vali Loss: 2.196 Vali Acc: 0.341 Test Loss: 2.196 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.1890755
	speed: 0.1066s/iter; left time: 1334.9881s
Epoch: 19 cost time: 4.169640064239502
Epoch: 19, Steps: 154 | Train Loss: 1.665 Vali Loss: 2.209 Vali Acc: 0.341 Test Loss: 2.209 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.6374079
	speed: 0.1060s/iter; left time: 1311.2753s
Epoch: 20 cost time: 4.380717754364014
Epoch: 20, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.245 Vali Acc: 0.345 Test Loss: 2.245 Test Acc: 0.345
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.7401140
	speed: 0.1040s/iter; left time: 1271.5660s
Epoch: 21 cost time: 4.140438079833984
Epoch: 21, Steps: 154 | Train Loss: 1.691 Vali Loss: 2.269 Vali Acc: 0.347 Test Loss: 2.269 Test Acc: 0.347
Validation loss decreased (-0.345883 --> -0.346693).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.6365019
	speed: 0.1100s/iter; left time: 1327.4246s
Epoch: 22 cost time: 4.109880685806274
Epoch: 22, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.326 Vali Acc: 0.346 Test Loss: 2.326 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.7343322
	speed: 0.1038s/iter; left time: 1236.9895s
Epoch: 23 cost time: 3.9185738563537598
Epoch: 23, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.264 Vali Acc: 0.353 Test Loss: 2.264 Test Acc: 0.353
Validation loss decreased (-0.346693 --> -0.353181).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.7108589
	speed: 0.1094s/iter; left time: 1286.3454s
Epoch: 24 cost time: 4.161635398864746
Epoch: 24, Steps: 154 | Train Loss: 1.578 Vali Loss: 2.371 Vali Acc: 0.351 Test Loss: 2.371 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.4003536
	speed: 0.1081s/iter; left time: 1254.1193s
Epoch: 25 cost time: 4.342772483825684
Epoch: 25, Steps: 154 | Train Loss: 1.644 Vali Loss: 2.288 Vali Acc: 0.349 Test Loss: 2.288 Test Acc: 0.349
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.2596630
	speed: 0.1047s/iter; left time: 1198.8175s
Epoch: 26 cost time: 4.1232521533966064
Epoch: 26, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.289 Vali Acc: 0.352 Test Loss: 2.289 Test Acc: 0.352
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.4495742
	speed: 0.1081s/iter; left time: 1221.1399s
Epoch: 27 cost time: 4.143462896347046
Epoch: 27, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.307 Vali Acc: 0.353 Test Loss: 2.307 Test Acc: 0.353
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.2017394
	speed: 0.1061s/iter; left time: 1182.6468s
Epoch: 28 cost time: 4.337183713912964
Epoch: 28, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.311 Vali Acc: 0.360 Test Loss: 2.311 Test Acc: 0.360
Validation loss decreased (-0.353181 --> -0.359669).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.4698933
	speed: 0.1070s/iter; left time: 1175.3074s
Epoch: 29 cost time: 4.221440315246582
Epoch: 29, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.350 Vali Acc: 0.357 Test Loss: 2.350 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.1051800
	speed: 0.1090s/iter; left time: 1181.1639s
Epoch: 30 cost time: 4.458526849746704
Epoch: 30, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.330 Vali Acc: 0.360 Test Loss: 2.330 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.8332021
	speed: 0.1063s/iter; left time: 1135.6497s
Epoch: 31 cost time: 4.291820049285889
Epoch: 31, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.382 Vali Acc: 0.361 Test Loss: 2.382 Test Acc: 0.361
Validation loss decreased (-0.359669 --> -0.360479).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.9670712
	speed: 0.1087s/iter; left time: 1144.6391s
Epoch: 32 cost time: 4.260515451431274
Epoch: 32, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.390 Vali Acc: 0.357 Test Loss: 2.390 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 1.6703058
	speed: 0.1038s/iter; left time: 1077.1428s
Epoch: 33 cost time: 4.073308944702148
Epoch: 33, Steps: 154 | Train Loss: 1.609 Vali Loss: 2.449 Vali Acc: 0.355 Test Loss: 2.449 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 1.3964686
	speed: 0.1099s/iter; left time: 1122.7337s
Epoch: 34 cost time: 4.654136657714844
Epoch: 34, Steps: 154 | Train Loss: 1.466 Vali Loss: 2.457 Vali Acc: 0.359 Test Loss: 2.457 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 7.5536761
	speed: 0.1079s/iter; left time: 1086.3779s
Epoch: 35 cost time: 4.179402828216553
Epoch: 35, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.791 Vali Acc: 0.363 Test Loss: 2.791 Test Acc: 0.363
Validation loss decreased (-0.360479 --> -0.363314).  Saving model ...
	iters: 100, epoch: 36 | loss: 1.3862789
	speed: 0.1043s/iter; left time: 1033.7120s
Epoch: 36 cost time: 4.238536596298218
Epoch: 36, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.636 Vali Acc: 0.364 Test Loss: 2.636 Test Acc: 0.364
Validation loss decreased (-0.363314 --> -0.364126).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.7854039
	speed: 0.1061s/iter; left time: 1035.4640s
Epoch: 37 cost time: 4.3051111698150635
Epoch: 37, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.508 Vali Acc: 0.364 Test Loss: 2.508 Test Acc: 0.364
Validation loss decreased (-0.364126 --> -0.364127).  Saving model ...
	iters: 100, epoch: 38 | loss: 1.4054164
	speed: 0.1057s/iter; left time: 1014.9103s
Epoch: 38 cost time: 4.148435354232788
Epoch: 38, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.430 Vali Acc: 0.363 Test Loss: 2.430 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 1.5852647
	speed: 0.1057s/iter; left time: 999.1113s
Epoch: 39 cost time: 4.111287593841553
Epoch: 39, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.542 Vali Acc: 0.377 Test Loss: 2.542 Test Acc: 0.377
Validation loss decreased (-0.364127 --> -0.376698).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.1314712
	speed: 0.1050s/iter; left time: 975.7916s
Epoch: 40 cost time: 4.103242874145508
Epoch: 40, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.402 Vali Acc: 0.362 Test Loss: 2.402 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 1.1321617
	speed: 0.1116s/iter; left time: 1020.3574s
Epoch: 41 cost time: 4.242445230484009
Epoch: 41, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.529 Vali Acc: 0.363 Test Loss: 2.529 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 1.1450537
	speed: 0.1088s/iter; left time: 977.8926s
Epoch: 42 cost time: 4.069567680358887
Epoch: 42, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.379 Vali Acc: 0.367 Test Loss: 2.379 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 1.2395154
	speed: 0.1085s/iter; left time: 958.1579s
Epoch: 43 cost time: 4.382166624069214
Epoch: 43, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.687 Vali Acc: 0.361 Test Loss: 2.687 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 1.7910323
	speed: 0.1079s/iter; left time: 936.2311s
Epoch: 44 cost time: 4.100454092025757
Epoch: 44, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.650 Vali Acc: 0.365 Test Loss: 2.650 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 2.4526765
	speed: 0.1025s/iter; left time: 873.8380s
Epoch: 45 cost time: 4.112056255340576
Epoch: 45, Steps: 154 | Train Loss: 1.348 Vali Loss: 2.804 Vali Acc: 0.376 Test Loss: 2.804 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 46 | loss: 1.5185740
	speed: 0.1054s/iter; left time: 881.9048s
Epoch: 46 cost time: 4.278518199920654
Epoch: 46, Steps: 154 | Train Loss: 1.420 Vali Loss: 2.744 Vali Acc: 0.368 Test Loss: 2.744 Test Acc: 0.368
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 47 | loss: 1.5736192
	speed: 0.1054s/iter; left time: 865.9331s
Epoch: 47 cost time: 4.176806211471558
Epoch: 47, Steps: 154 | Train Loss: 1.350 Vali Loss: 2.825 Vali Acc: 0.372 Test Loss: 2.825 Test Acc: 0.372
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 48 | loss: 1.1904533
	speed: 0.1092s/iter; left time: 880.7881s
Epoch: 48 cost time: 4.658924341201782
Epoch: 48, Steps: 154 | Train Loss: 1.328 Vali Loss: 2.619 Vali Acc: 0.369 Test Loss: 2.619 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 49 | loss: 1.7301425
	speed: 0.1095s/iter; left time: 866.2960s
Epoch: 49 cost time: 4.344985246658325
Epoch: 49, Steps: 154 | Train Loss: 1.419 Vali Loss: 3.036 Vali Acc: 0.378 Test Loss: 3.036 Test Acc: 0.378
Validation loss decreased (-0.376698 --> -0.378315).  Saving model ...
	iters: 100, epoch: 50 | loss: 0.7204781
	speed: 0.1038s/iter; left time: 804.9071s
Epoch: 50 cost time: 3.9580399990081787
Epoch: 50, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.742 Vali Acc: 0.372 Test Loss: 2.742 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 51 | loss: 1.6281315
	speed: 0.1105s/iter; left time: 839.7762s
Epoch: 51 cost time: 4.454546928405762
Epoch: 51, Steps: 154 | Train Loss: 1.396 Vali Loss: 2.708 Vali Acc: 0.367 Test Loss: 2.708 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 52 | loss: 1.3655763
	speed: 0.1085s/iter; left time: 808.1947s
Epoch: 52 cost time: 4.019176721572876
Epoch: 52, Steps: 154 | Train Loss: 1.402 Vali Loss: 2.826 Vali Acc: 0.378 Test Loss: 2.826 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 53 | loss: 0.9479784
	speed: 0.1043s/iter; left time: 760.6443s
Epoch: 53 cost time: 4.113291025161743
Epoch: 53, Steps: 154 | Train Loss: 1.376 Vali Loss: 2.688 Vali Acc: 0.376 Test Loss: 2.688 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 54 | loss: 1.6304121
	speed: 0.1017s/iter; left time: 726.1767s
Epoch: 54 cost time: 3.8846516609191895
Epoch: 54, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.938 Vali Acc: 0.378 Test Loss: 2.938 Test Acc: 0.378
Validation loss decreased (-0.378315 --> -0.378316).  Saving model ...
	iters: 100, epoch: 55 | loss: 1.0074466
	speed: 0.1038s/iter; left time: 725.1347s
Epoch: 55 cost time: 3.993114948272705
Epoch: 55, Steps: 154 | Train Loss: 1.346 Vali Loss: 2.799 Vali Acc: 0.376 Test Loss: 2.799 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 56 | loss: 1.1433651
	speed: 0.1031s/iter; left time: 704.1560s
Epoch: 56 cost time: 4.25577187538147
Epoch: 56, Steps: 154 | Train Loss: 1.412 Vali Loss: 2.873 Vali Acc: 0.374 Test Loss: 2.873 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 57 | loss: 1.6551007
	speed: 0.1005s/iter; left time: 670.8756s
Epoch: 57 cost time: 4.0430707931518555
Epoch: 57, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.635 Vali Acc: 0.376 Test Loss: 2.635 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 58 | loss: 0.7705176
	speed: 0.1042s/iter; left time: 679.4535s
Epoch: 58 cost time: 4.190646171569824
Epoch: 58, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.700 Vali Acc: 0.373 Test Loss: 2.700 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 59 | loss: 0.9831028
	speed: 0.1070s/iter; left time: 681.3681s
Epoch: 59 cost time: 4.300293922424316
Epoch: 59, Steps: 154 | Train Loss: 1.301 Vali Loss: 2.578 Vali Acc: 0.376 Test Loss: 2.578 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 60 | loss: 3.2957141
	speed: 0.1087s/iter; left time: 675.6851s
Epoch: 60 cost time: 4.187021732330322
Epoch: 60, Steps: 154 | Train Loss: 1.274 Vali Loss: 2.910 Vali Acc: 0.380 Test Loss: 2.910 Test Acc: 0.380
Validation loss decreased (-0.378316 --> -0.379533).  Saving model ...
	iters: 100, epoch: 61 | loss: 1.3148924
	speed: 0.1092s/iter; left time: 661.6837s
Epoch: 61 cost time: 4.315316200256348
Epoch: 61, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.744 Vali Acc: 0.380 Test Loss: 2.744 Test Acc: 0.380
Validation loss decreased (-0.379533 --> -0.379940).  Saving model ...
	iters: 100, epoch: 62 | loss: 1.6586852
	speed: 0.1089s/iter; left time: 643.3574s
Epoch: 62 cost time: 4.205500364303589
Epoch: 62, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.794 Vali Acc: 0.384 Test Loss: 2.794 Test Acc: 0.384
Validation loss decreased (-0.379940 --> -0.383995).  Saving model ...
	iters: 100, epoch: 63 | loss: 0.8179552
	speed: 0.1107s/iter; left time: 637.0995s
Epoch: 63 cost time: 4.298787593841553
Epoch: 63, Steps: 154 | Train Loss: 1.388 Vali Loss: 2.971 Vali Acc: 0.369 Test Loss: 2.971 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 64 | loss: 1.0811273
	speed: 0.1031s/iter; left time: 576.9873s
Epoch: 64 cost time: 4.3307623863220215
Epoch: 64, Steps: 154 | Train Loss: 1.383 Vali Loss: 2.858 Vali Acc: 0.380 Test Loss: 2.858 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 65 | loss: 1.2421038
	speed: 0.1077s/iter; left time: 586.5078s
Epoch: 65 cost time: 4.249628067016602
Epoch: 65, Steps: 154 | Train Loss: 1.347 Vali Loss: 3.211 Vali Acc: 0.377 Test Loss: 3.211 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 66 | loss: 1.5260863
	speed: 0.1073s/iter; left time: 567.8491s
Epoch: 66 cost time: 4.355787992477417
Epoch: 66, Steps: 154 | Train Loss: 1.278 Vali Loss: 3.016 Vali Acc: 0.382 Test Loss: 3.016 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 67 | loss: 2.3374186
	speed: 0.1076s/iter; left time: 552.5570s
Epoch: 67 cost time: 4.385525703430176
Epoch: 67, Steps: 154 | Train Loss: 1.367 Vali Loss: 2.934 Vali Acc: 0.379 Test Loss: 2.934 Test Acc: 0.379
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 68 | loss: 0.8172486
	speed: 0.1039s/iter; left time: 517.9251s
Epoch: 68 cost time: 4.252282381057739
Epoch: 68, Steps: 154 | Train Loss: 1.357 Vali Loss: 2.955 Vali Acc: 0.378 Test Loss: 2.955 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 69 | loss: 0.9249870
	speed: 0.1088s/iter; left time: 525.5591s
Epoch: 69 cost time: 4.092693090438843
Epoch: 69, Steps: 154 | Train Loss: 1.301 Vali Loss: 3.243 Vali Acc: 0.384 Test Loss: 3.243 Test Acc: 0.384
Validation loss decreased (-0.383995 --> -0.384396).  Saving model ...
	iters: 100, epoch: 70 | loss: 1.6102867
	speed: 0.1161s/iter; left time: 542.9920s
Epoch: 70 cost time: 4.527635097503662
Epoch: 70, Steps: 154 | Train Loss: 1.377 Vali Loss: 2.970 Vali Acc: 0.377 Test Loss: 2.970 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 71 | loss: 1.3697621
	speed: 0.1062s/iter; left time: 480.1450s
Epoch: 71 cost time: 4.036403656005859
Epoch: 71, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.902 Vali Acc: 0.391 Test Loss: 2.902 Test Acc: 0.391
Validation loss decreased (-0.384396 --> -0.390482).  Saving model ...
	iters: 100, epoch: 72 | loss: 1.2290020
	speed: 0.1071s/iter; left time: 467.7977s
Epoch: 72 cost time: 4.093964576721191
Epoch: 72, Steps: 154 | Train Loss: 1.320 Vali Loss: 2.891 Vali Acc: 0.381 Test Loss: 2.891 Test Acc: 0.381
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 73 | loss: 0.9103198
	speed: 0.1121s/iter; left time: 472.3634s
Epoch: 73 cost time: 4.1992387771606445
Epoch: 73, Steps: 154 | Train Loss: 1.248 Vali Loss: 3.032 Vali Acc: 0.388 Test Loss: 3.032 Test Acc: 0.388
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 74 | loss: 0.8672057
	speed: 0.1073s/iter; left time: 435.7333s
Epoch: 74 cost time: 4.561051368713379
Epoch: 74, Steps: 154 | Train Loss: 1.402 Vali Loss: 2.790 Vali Acc: 0.387 Test Loss: 2.790 Test Acc: 0.387
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 75 | loss: 1.1255378
	speed: 0.1091s/iter; left time: 426.2153s
Epoch: 75 cost time: 3.7054154872894287
Epoch: 75, Steps: 154 | Train Loss: 1.247 Vali Loss: 3.094 Vali Acc: 0.379 Test Loss: 3.094 Test Acc: 0.379
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 76 | loss: 1.1144021
	speed: 0.0859s/iter; left time: 322.1863s
Epoch: 76 cost time: 3.3670222759246826
Epoch: 76, Steps: 154 | Train Loss: 1.251 Vali Loss: 3.262 Vali Acc: 0.383 Test Loss: 3.262 Test Acc: 0.383
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 77 | loss: 1.1527462
	speed: 0.1014s/iter; left time: 364.6056s
Epoch: 77 cost time: 4.1883299350738525
Epoch: 77, Steps: 154 | Train Loss: 1.328 Vali Loss: 3.318 Vali Acc: 0.381 Test Loss: 3.318 Test Acc: 0.381
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 78 | loss: 1.2140093
	speed: 0.1080s/iter; left time: 371.9893s
Epoch: 78 cost time: 4.257408142089844
Epoch: 78, Steps: 154 | Train Loss: 1.362 Vali Loss: 3.070 Vali Acc: 0.384 Test Loss: 3.070 Test Acc: 0.384
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 79 | loss: 0.9466258
	speed: 0.1092s/iter; left time: 359.0845s
Epoch: 79 cost time: 4.19819712638855
Epoch: 79, Steps: 154 | Train Loss: 1.411 Vali Loss: 2.970 Vali Acc: 0.382 Test Loss: 2.970 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 80 | loss: 1.1330392
	speed: 0.1047s/iter; left time: 328.0853s
Epoch: 80 cost time: 4.243266582489014
Epoch: 80, Steps: 154 | Train Loss: 1.228 Vali Loss: 3.019 Vali Acc: 0.379 Test Loss: 3.019 Test Acc: 0.379
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 81 | loss: 0.9260160
	speed: 0.1066s/iter; left time: 317.7250s
Epoch: 81 cost time: 4.3149871826171875
Epoch: 81, Steps: 154 | Train Loss: 1.305 Vali Loss: 2.862 Vali Acc: 0.380 Test Loss: 2.862 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3905109489051095
model parameter : 150646
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0646210
	speed: 0.0458s/iter; left time: 700.5484s
Epoch: 1 cost time: 6.056641101837158
Epoch: 1, Steps: 154 | Train Loss: 2.274 Vali Loss: 2.164 Vali Acc: 0.318 Test Loss: 2.164 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8294702
	speed: 0.1052s/iter; left time: 1594.1315s
Epoch: 2 cost time: 4.0552380084991455
Epoch: 2, Steps: 154 | Train Loss: 2.084 Vali Loss: 2.142 Vali Acc: 0.318 Test Loss: 2.142 Test Acc: 0.318
Validation loss decreased (-0.317902 --> -0.318308).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1053913
	speed: 0.1095s/iter; left time: 1641.9320s
Epoch: 3 cost time: 4.088136196136475
Epoch: 3, Steps: 154 | Train Loss: 2.025 Vali Loss: 2.141 Vali Acc: 0.319 Test Loss: 2.141 Test Acc: 0.319
Validation loss decreased (-0.318308 --> -0.318713).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1013772
	speed: 0.1075s/iter; left time: 1595.6173s
Epoch: 4 cost time: 4.404795169830322
Epoch: 4, Steps: 154 | Train Loss: 1.994 Vali Loss: 2.125 Vali Acc: 0.318 Test Loss: 2.125 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7813506
	speed: 0.1049s/iter; left time: 1540.6859s
Epoch: 5 cost time: 4.110482215881348
Epoch: 5, Steps: 154 | Train Loss: 1.970 Vali Loss: 2.144 Vali Acc: 0.319 Test Loss: 2.144 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.1362269
	speed: 0.1008s/iter; left time: 1464.5116s
Epoch: 6 cost time: 4.062150478363037
Epoch: 6, Steps: 154 | Train Loss: 1.946 Vali Loss: 2.137 Vali Acc: 0.320 Test Loss: 2.137 Test Acc: 0.320
Validation loss decreased (-0.318713 --> -0.319524).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1598430
	speed: 0.0975s/iter; left time: 1401.8727s
Epoch: 7 cost time: 4.038066625595093
Epoch: 7, Steps: 154 | Train Loss: 1.921 Vali Loss: 2.118 Vali Acc: 0.323 Test Loss: 2.118 Test Acc: 0.323
Validation loss decreased (-0.319524 --> -0.322769).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1030073
	speed: 0.1052s/iter; left time: 1496.3292s
Epoch: 8 cost time: 4.017894506454468
Epoch: 8, Steps: 154 | Train Loss: 1.906 Vali Loss: 2.118 Vali Acc: 0.324 Test Loss: 2.118 Test Acc: 0.324
Validation loss decreased (-0.322769 --> -0.324391).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7139151
	speed: 0.1073s/iter; left time: 1509.0522s
Epoch: 9 cost time: 4.2118682861328125
Epoch: 9, Steps: 154 | Train Loss: 1.871 Vali Loss: 2.122 Vali Acc: 0.326 Test Loss: 2.122 Test Acc: 0.326
Validation loss decreased (-0.324391 --> -0.325607).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9956224
	speed: 0.1083s/iter; left time: 1507.6139s
Epoch: 10 cost time: 4.1480185985565186
Epoch: 10, Steps: 154 | Train Loss: 1.842 Vali Loss: 2.124 Vali Acc: 0.327 Test Loss: 2.124 Test Acc: 0.327
Validation loss decreased (-0.325607 --> -0.326824).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5729879
	speed: 0.1079s/iter; left time: 1484.9470s
Epoch: 11 cost time: 3.9840240478515625
Epoch: 11, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.165 Vali Acc: 0.327 Test Loss: 2.165 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.2530839
	speed: 0.1093s/iter; left time: 1486.9887s
Epoch: 12 cost time: 4.354488849639893
Epoch: 12, Steps: 154 | Train Loss: 1.807 Vali Loss: 2.133 Vali Acc: 0.330 Test Loss: 2.133 Test Acc: 0.330
Validation loss decreased (-0.326824 --> -0.330068).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.8121231
	speed: 0.1093s/iter; left time: 1470.8378s
Epoch: 13 cost time: 4.234475374221802
Epoch: 13, Steps: 154 | Train Loss: 1.800 Vali Loss: 2.136 Vali Acc: 0.330 Test Loss: 2.136 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.6911803
	speed: 0.1095s/iter; left time: 1456.6332s
Epoch: 14 cost time: 4.30855393409729
Epoch: 14, Steps: 154 | Train Loss: 1.757 Vali Loss: 2.147 Vali Acc: 0.337 Test Loss: 2.147 Test Acc: 0.337
Validation loss decreased (-0.330068 --> -0.337367).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.2460515
	speed: 0.1069s/iter; left time: 1404.9818s
Epoch: 15 cost time: 4.279997110366821
Epoch: 15, Steps: 154 | Train Loss: 1.750 Vali Loss: 2.202 Vali Acc: 0.335 Test Loss: 2.202 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.5534778
	speed: 0.1063s/iter; left time: 1381.5494s
Epoch: 16 cost time: 4.319646596908569
Epoch: 16, Steps: 154 | Train Loss: 1.745 Vali Loss: 2.174 Vali Acc: 0.339 Test Loss: 2.174 Test Acc: 0.339
Validation loss decreased (-0.337367 --> -0.338583).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.8403319
	speed: 0.1062s/iter; left time: 1363.7423s
Epoch: 17 cost time: 4.1191246509552
Epoch: 17, Steps: 154 | Train Loss: 1.792 Vali Loss: 2.170 Vali Acc: 0.343 Test Loss: 2.170 Test Acc: 0.343
Validation loss decreased (-0.338583 --> -0.343450).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6013081
	speed: 0.1077s/iter; left time: 1365.9333s
Epoch: 18 cost time: 4.446941375732422
Epoch: 18, Steps: 154 | Train Loss: 1.751 Vali Loss: 2.221 Vali Acc: 0.340 Test Loss: 2.221 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.1810601
	speed: 0.1080s/iter; left time: 1352.7713s
Epoch: 19 cost time: 4.012494325637817
Epoch: 19, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.230 Vali Acc: 0.343 Test Loss: 2.230 Test Acc: 0.343
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.6082797
	speed: 0.1077s/iter; left time: 1333.0198s
Epoch: 20 cost time: 4.208820104598999
Epoch: 20, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.304 Vali Acc: 0.348 Test Loss: 2.304 Test Acc: 0.348
Validation loss decreased (-0.343450 --> -0.348314).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.6624911
	speed: 0.1088s/iter; left time: 1329.2663s
Epoch: 21 cost time: 3.9961676597595215
Epoch: 21, Steps: 154 | Train Loss: 1.673 Vali Loss: 2.310 Vali Acc: 0.348 Test Loss: 2.310 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.5632222
	speed: 0.1075s/iter; left time: 1296.8026s
Epoch: 22 cost time: 4.078648090362549
Epoch: 22, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.286 Vali Acc: 0.352 Test Loss: 2.286 Test Acc: 0.352
Validation loss decreased (-0.348314 --> -0.351559).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.7109429
	speed: 0.1076s/iter; left time: 1281.2938s
Epoch: 23 cost time: 4.05747127532959
Epoch: 23, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.349 Vali Acc: 0.350 Test Loss: 2.349 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.6850984
	speed: 0.1036s/iter; left time: 1218.8049s
Epoch: 24 cost time: 4.314967155456543
Epoch: 24, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.487 Vali Acc: 0.352 Test Loss: 2.487 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.2854786
	speed: 0.1057s/iter; left time: 1227.0450s
Epoch: 25 cost time: 4.081720590591431
Epoch: 25, Steps: 154 | Train Loss: 1.612 Vali Loss: 2.439 Vali Acc: 0.351 Test Loss: 2.439 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.3872950
	speed: 0.1038s/iter; left time: 1188.1096s
Epoch: 26 cost time: 4.082207441329956
Epoch: 26, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.378 Vali Acc: 0.355 Test Loss: 2.378 Test Acc: 0.355
Validation loss decreased (-0.351559 --> -0.355207).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.4330294
	speed: 0.1070s/iter; left time: 1208.5426s
Epoch: 27 cost time: 4.292527437210083
Epoch: 27, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.427 Vali Acc: 0.352 Test Loss: 2.427 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.3914599
	speed: 0.1058s/iter; left time: 1178.8806s
Epoch: 28 cost time: 4.073645830154419
Epoch: 28, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.414 Vali Acc: 0.360 Test Loss: 2.414 Test Acc: 0.360
Validation loss decreased (-0.355207 --> -0.359668).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.3062031
	speed: 0.1021s/iter; left time: 1121.7160s
Epoch: 29 cost time: 4.153350591659546
Epoch: 29, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.463 Vali Acc: 0.356 Test Loss: 2.463 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.0969044
	speed: 0.1083s/iter; left time: 1173.5127s
Epoch: 30 cost time: 4.278296709060669
Epoch: 30, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.417 Vali Acc: 0.358 Test Loss: 2.417 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.8875459
	speed: 0.1100s/iter; left time: 1174.7088s
Epoch: 31 cost time: 4.070192575454712
Epoch: 31, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.467 Vali Acc: 0.358 Test Loss: 2.467 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.1089667
	speed: 0.1075s/iter; left time: 1131.4158s
Epoch: 32 cost time: 4.087498188018799
Epoch: 32, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.520 Vali Acc: 0.357 Test Loss: 2.520 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 1.5496601
	speed: 0.1057s/iter; left time: 1096.8177s
Epoch: 33 cost time: 3.9021873474121094
Epoch: 33, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.417 Vali Acc: 0.360 Test Loss: 2.417 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 1.3029363
	speed: 0.1013s/iter; left time: 1035.0036s
Epoch: 34 cost time: 4.027204275131226
Epoch: 34, Steps: 154 | Train Loss: 1.485 Vali Loss: 2.439 Vali Acc: 0.359 Test Loss: 2.439 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 1.6347632
	speed: 0.1072s/iter; left time: 1078.8074s
Epoch: 35 cost time: 4.2650299072265625
Epoch: 35, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.728 Vali Acc: 0.356 Test Loss: 2.728 Test Acc: 0.356
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 1.3986288
	speed: 0.1084s/iter; left time: 1074.1610s
Epoch: 36 cost time: 4.314492702484131
Epoch: 36, Steps: 154 | Train Loss: 1.511 Vali Loss: 2.526 Vali Acc: 0.361 Test Loss: 2.526 Test Acc: 0.361
Validation loss decreased (-0.359668 --> -0.361289).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.7278945
	speed: 0.1048s/iter; left time: 1022.7489s
Epoch: 37 cost time: 4.083614349365234
Epoch: 37, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.529 Vali Acc: 0.365 Test Loss: 2.529 Test Acc: 0.365
Validation loss decreased (-0.361289 --> -0.364533).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.8251187
	speed: 0.1056s/iter; left time: 1014.0380s
Epoch: 38 cost time: 4.115410089492798
Epoch: 38, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.536 Vali Acc: 0.358 Test Loss: 2.536 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 1.2936156
	speed: 0.0968s/iter; left time: 915.0014s
Epoch: 39 cost time: 3.961024522781372
Epoch: 39, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.560 Vali Acc: 0.365 Test Loss: 2.560 Test Acc: 0.365
Validation loss decreased (-0.364533 --> -0.365343).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.0376190
	speed: 0.1084s/iter; left time: 1007.8478s
Epoch: 40 cost time: 4.2107672691345215
Epoch: 40, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.637 Vali Acc: 0.358 Test Loss: 2.637 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 1.2380061
	speed: 0.1075s/iter; left time: 982.3964s
Epoch: 41 cost time: 4.396377325057983
Epoch: 41, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.627 Vali Acc: 0.363 Test Loss: 2.627 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 1.3243775
	speed: 0.1107s/iter; left time: 995.1912s
Epoch: 42 cost time: 4.236904621124268
Epoch: 42, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.583 Vali Acc: 0.365 Test Loss: 2.583 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 1.2963378
	speed: 0.1089s/iter; left time: 961.8036s
Epoch: 43 cost time: 4.1685590744018555
Epoch: 43, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.615 Vali Acc: 0.363 Test Loss: 2.615 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 1.7968585
	speed: 0.1067s/iter; left time: 926.3516s
Epoch: 44 cost time: 4.264920711517334
Epoch: 44, Steps: 154 | Train Loss: 1.417 Vali Loss: 2.515 Vali Acc: 0.367 Test Loss: 2.515 Test Acc: 0.367
Validation loss decreased (-0.365343 --> -0.367371).  Saving model ...
	iters: 100, epoch: 45 | loss: 1.0257415
	speed: 0.1080s/iter; left time: 920.3420s
Epoch: 45 cost time: 4.1246514320373535
Epoch: 45, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.669 Vali Acc: 0.370 Test Loss: 2.669 Test Acc: 0.370
Validation loss decreased (-0.367371 --> -0.369803).  Saving model ...
	iters: 100, epoch: 46 | loss: 1.4960480
	speed: 0.1057s/iter; left time: 884.7951s
Epoch: 46 cost time: 4.127440452575684
Epoch: 46, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.634 Vali Acc: 0.363 Test Loss: 2.634 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 47 | loss: 1.5977700
	speed: 0.0998s/iter; left time: 819.7461s
Epoch: 47 cost time: 4.021159410476685
Epoch: 47, Steps: 154 | Train Loss: 1.421 Vali Loss: 2.792 Vali Acc: 0.375 Test Loss: 2.792 Test Acc: 0.375
Validation loss decreased (-0.369803 --> -0.375073).  Saving model ...
	iters: 100, epoch: 48 | loss: 1.3664215
	speed: 0.1058s/iter; left time: 853.1431s
Epoch: 48 cost time: 4.095352411270142
Epoch: 48, Steps: 154 | Train Loss: 1.481 Vali Loss: 2.682 Vali Acc: 0.365 Test Loss: 2.682 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 49 | loss: 1.5983719
	speed: 0.1122s/iter; left time: 887.5088s
Epoch: 49 cost time: 4.105084657669067
Epoch: 49, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.512 Vali Acc: 0.376 Test Loss: 2.512 Test Acc: 0.376
Validation loss decreased (-0.375073 --> -0.376293).  Saving model ...
	iters: 100, epoch: 50 | loss: 0.9207360
	speed: 0.1073s/iter; left time: 832.3794s
Epoch: 50 cost time: 4.145051717758179
Epoch: 50, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.655 Vali Acc: 0.363 Test Loss: 2.655 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 51 | loss: 1.5794166
	speed: 0.1079s/iter; left time: 819.9838s
Epoch: 51 cost time: 4.199244976043701
Epoch: 51, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.566 Vali Acc: 0.369 Test Loss: 2.566 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 52 | loss: 1.3460325
	speed: 0.1094s/iter; left time: 814.9301s
Epoch: 52 cost time: 4.106295585632324
Epoch: 52, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.654 Vali Acc: 0.371 Test Loss: 2.654 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 53 | loss: 1.0847628
	speed: 0.1000s/iter; left time: 729.4454s
Epoch: 53 cost time: 4.213608503341675
Epoch: 53, Steps: 154 | Train Loss: 1.392 Vali Loss: 2.653 Vali Acc: 0.368 Test Loss: 2.653 Test Acc: 0.368
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 54 | loss: 1.5461998
	speed: 0.1098s/iter; left time: 783.7990s
Epoch: 54 cost time: 4.305521011352539
Epoch: 54, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.547 Vali Acc: 0.373 Test Loss: 2.547 Test Acc: 0.373
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 55 | loss: 1.9899660
	speed: 0.1088s/iter; left time: 760.0910s
Epoch: 55 cost time: 4.3067662715911865
Epoch: 55, Steps: 154 | Train Loss: 1.368 Vali Loss: 2.703 Vali Acc: 0.371 Test Loss: 2.703 Test Acc: 0.371
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 56 | loss: 1.2475221
	speed: 0.1097s/iter; left time: 749.5462s
Epoch: 56 cost time: 4.433340072631836
Epoch: 56, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.545 Vali Acc: 0.372 Test Loss: 2.545 Test Acc: 0.372
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 57 | loss: 1.4258882
	speed: 0.1071s/iter; left time: 715.4382s
Epoch: 57 cost time: 4.3273138999938965
Epoch: 57, Steps: 154 | Train Loss: 1.327 Vali Loss: 2.695 Vali Acc: 0.376 Test Loss: 2.695 Test Acc: 0.376
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 58 | loss: 0.8693215
	speed: 0.1057s/iter; left time: 689.1969s
Epoch: 58 cost time: 3.8900022506713867
Epoch: 58, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.665 Vali Acc: 0.367 Test Loss: 2.665 Test Acc: 0.367
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 59 | loss: 0.9997163
	speed: 0.1110s/iter; left time: 706.9666s
Epoch: 59 cost time: 4.479062795639038
Epoch: 59, Steps: 154 | Train Loss: 1.326 Vali Loss: 2.635 Vali Acc: 0.368 Test Loss: 2.635 Test Acc: 0.368
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37631792376317924
model parameter : 150646
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9310762
	speed: 0.0452s/iter; left time: 691.5855s
Epoch: 1 cost time: 5.848195791244507
Epoch: 1, Steps: 154 | Train Loss: 2.328 Vali Loss: 2.140 Vali Acc: 0.317 Test Loss: 2.140 Test Acc: 0.317
Validation loss decreased (inf --> -0.316686).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3304420
	speed: 0.1096s/iter; left time: 1660.6843s
Epoch: 2 cost time: 4.025472402572632
Epoch: 2, Steps: 154 | Train Loss: 2.094 Vali Loss: 2.142 Vali Acc: 0.318 Test Loss: 2.142 Test Acc: 0.318
Validation loss decreased (-0.316686 --> -0.317497).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0875711
	speed: 0.1065s/iter; left time: 1596.5564s
Epoch: 3 cost time: 4.154026985168457
Epoch: 3, Steps: 154 | Train Loss: 2.030 Vali Loss: 2.143 Vali Acc: 0.318 Test Loss: 2.143 Test Acc: 0.318
Validation loss decreased (-0.317497 --> -0.318308).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8039668
	speed: 0.1071s/iter; left time: 1588.7372s
Epoch: 4 cost time: 4.302075624465942
Epoch: 4, Steps: 154 | Train Loss: 1.995 Vali Loss: 2.131 Vali Acc: 0.319 Test Loss: 2.131 Test Acc: 0.319
Validation loss decreased (-0.318308 --> -0.319119).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7785518
	speed: 0.1082s/iter; left time: 1589.2299s
Epoch: 5 cost time: 4.341008901596069
Epoch: 5, Steps: 154 | Train Loss: 1.959 Vali Loss: 2.156 Vali Acc: 0.319 Test Loss: 2.156 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.2175727
	speed: 0.1034s/iter; left time: 1502.2190s
Epoch: 6 cost time: 4.11286735534668
Epoch: 6, Steps: 154 | Train Loss: 1.927 Vali Loss: 2.139 Vali Acc: 0.320 Test Loss: 2.139 Test Acc: 0.320
Validation loss decreased (-0.319119 --> -0.319930).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6718850
	speed: 0.1058s/iter; left time: 1521.6729s
Epoch: 7 cost time: 4.2318785190582275
Epoch: 7, Steps: 154 | Train Loss: 1.910 Vali Loss: 2.139 Vali Acc: 0.322 Test Loss: 2.139 Test Acc: 0.322
Validation loss decreased (-0.319930 --> -0.321552).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6825348
	speed: 0.1064s/iter; left time: 1513.2158s
Epoch: 8 cost time: 4.251369476318359
Epoch: 8, Steps: 154 | Train Loss: 1.887 Vali Loss: 2.145 Vali Acc: 0.323 Test Loss: 2.145 Test Acc: 0.323
Validation loss decreased (-0.321552 --> -0.322768).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5090159
	speed: 0.1039s/iter; left time: 1462.3739s
Epoch: 9 cost time: 4.1081225872039795
Epoch: 9, Steps: 154 | Train Loss: 1.867 Vali Loss: 2.136 Vali Acc: 0.323 Test Loss: 2.136 Test Acc: 0.323
Validation loss decreased (-0.322768 --> -0.323174).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4234216
	speed: 0.1051s/iter; left time: 1462.6421s
Epoch: 10 cost time: 4.185497760772705
Epoch: 10, Steps: 154 | Train Loss: 1.828 Vali Loss: 2.126 Vali Acc: 0.324 Test Loss: 2.126 Test Acc: 0.324
Validation loss decreased (-0.323174 --> -0.324391).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7936456
	speed: 0.1126s/iter; left time: 1549.9737s
Epoch: 11 cost time: 4.498462438583374
Epoch: 11, Steps: 154 | Train Loss: 1.813 Vali Loss: 2.156 Vali Acc: 0.326 Test Loss: 2.156 Test Acc: 0.326
Validation loss decreased (-0.324391 --> -0.325607).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.0299985
	speed: 0.1046s/iter; left time: 1423.6931s
Epoch: 12 cost time: 4.190282583236694
Epoch: 12, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.144 Vali Acc: 0.329 Test Loss: 2.144 Test Acc: 0.329
Validation loss decreased (-0.325607 --> -0.329257).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7616935
	speed: 0.1082s/iter; left time: 1455.5682s
Epoch: 13 cost time: 4.404480218887329
Epoch: 13, Steps: 154 | Train Loss: 1.789 Vali Loss: 2.153 Vali Acc: 0.326 Test Loss: 2.153 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.9565198
	speed: 0.1088s/iter; left time: 1447.4777s
Epoch: 14 cost time: 4.4504711627960205
Epoch: 14, Steps: 154 | Train Loss: 1.759 Vali Loss: 2.147 Vali Acc: 0.328 Test Loss: 2.147 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.6457729
	speed: 0.1061s/iter; left time: 1395.3163s
Epoch: 15 cost time: 4.269007205963135
Epoch: 15, Steps: 154 | Train Loss: 1.725 Vali Loss: 2.146 Vali Acc: 0.330 Test Loss: 2.146 Test Acc: 0.330
Validation loss decreased (-0.329257 --> -0.330068).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.1016045
	speed: 0.1108s/iter; left time: 1438.9512s
Epoch: 16 cost time: 4.252608060836792
Epoch: 16, Steps: 154 | Train Loss: 1.738 Vali Loss: 2.179 Vali Acc: 0.330 Test Loss: 2.179 Test Acc: 0.330
Validation loss decreased (-0.330068 --> -0.330473).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.7946565
	speed: 0.1052s/iter; left time: 1350.2475s
Epoch: 17 cost time: 3.7521095275878906
Epoch: 17, Steps: 154 | Train Loss: 1.683 Vali Loss: 2.205 Vali Acc: 0.335 Test Loss: 2.205 Test Acc: 0.335
Validation loss decreased (-0.330473 --> -0.335339).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6768532
	speed: 0.1075s/iter; left time: 1363.7097s
Epoch: 18 cost time: 4.222012519836426
Epoch: 18, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.221 Vali Acc: 0.332 Test Loss: 2.221 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.7087547
	speed: 0.1111s/iter; left time: 1392.3044s
Epoch: 19 cost time: 4.1829140186309814
Epoch: 19, Steps: 154 | Train Loss: 1.662 Vali Loss: 2.243 Vali Acc: 0.337 Test Loss: 2.243 Test Acc: 0.337
Validation loss decreased (-0.335339 --> -0.336555).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.6800160
	speed: 0.1069s/iter; left time: 1322.8059s
Epoch: 20 cost time: 4.318661689758301
Epoch: 20, Steps: 154 | Train Loss: 1.720 Vali Loss: 2.260 Vali Acc: 0.339 Test Loss: 2.260 Test Acc: 0.339
Validation loss decreased (-0.336555 --> -0.338582).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.3541712
	speed: 0.1113s/iter; left time: 1360.6192s
Epoch: 21 cost time: 4.371147632598877
Epoch: 21, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.232 Vali Acc: 0.338 Test Loss: 2.232 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.2670026
	speed: 0.1082s/iter; left time: 1305.6872s
Epoch: 22 cost time: 4.200294256210327
Epoch: 22, Steps: 154 | Train Loss: 1.633 Vali Loss: 2.242 Vali Acc: 0.340 Test Loss: 2.242 Test Acc: 0.340
Validation loss decreased (-0.338582 --> -0.340205).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.4713218
	speed: 0.1051s/iter; left time: 1251.8396s
Epoch: 23 cost time: 4.116613864898682
Epoch: 23, Steps: 154 | Train Loss: 1.609 Vali Loss: 2.242 Vali Acc: 0.337 Test Loss: 2.242 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.7155799
	speed: 0.1052s/iter; left time: 1237.3391s
Epoch: 24 cost time: 4.166716814041138
Epoch: 24, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.266 Vali Acc: 0.347 Test Loss: 2.266 Test Acc: 0.347
Validation loss decreased (-0.340205 --> -0.347098).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.8267291
	speed: 0.1069s/iter; left time: 1240.8505s
Epoch: 25 cost time: 4.137070655822754
Epoch: 25, Steps: 154 | Train Loss: 1.643 Vali Loss: 2.250 Vali Acc: 0.345 Test Loss: 2.250 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.1657982
	speed: 0.1034s/iter; left time: 1183.9874s
Epoch: 26 cost time: 4.123732089996338
Epoch: 26, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.204 Vali Acc: 0.346 Test Loss: 2.204 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.6891087
	speed: 0.1063s/iter; left time: 1201.2381s
Epoch: 27 cost time: 4.067564964294434
Epoch: 27, Steps: 154 | Train Loss: 1.557 Vali Loss: 2.282 Vali Acc: 0.346 Test Loss: 2.282 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.7175027
	speed: 0.1137s/iter; left time: 1267.3267s
Epoch: 28 cost time: 4.151467561721802
Epoch: 28, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.272 Vali Acc: 0.351 Test Loss: 2.272 Test Acc: 0.351
Validation loss decreased (-0.347098 --> -0.351153).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.2053716
	speed: 0.1060s/iter; left time: 1164.2902s
Epoch: 29 cost time: 4.151782035827637
Epoch: 29, Steps: 154 | Train Loss: 1.542 Vali Loss: 2.289 Vali Acc: 0.352 Test Loss: 2.289 Test Acc: 0.352
Validation loss decreased (-0.351153 --> -0.352370).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.8703089
	speed: 0.1118s/iter; left time: 1211.2663s
Epoch: 30 cost time: 4.2592291831970215
Epoch: 30, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.317 Vali Acc: 0.348 Test Loss: 2.317 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.3945103
	speed: 0.1135s/iter; left time: 1211.8826s
Epoch: 31 cost time: 4.10286283493042
Epoch: 31, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.285 Vali Acc: 0.328 Test Loss: 2.285 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.4859582
	speed: 0.1086s/iter; left time: 1142.8835s
Epoch: 32 cost time: 4.575879812240601
Epoch: 32, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.307 Vali Acc: 0.354 Test Loss: 2.307 Test Acc: 0.354
Validation loss decreased (-0.352370 --> -0.354397).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.1982130
	speed: 0.1127s/iter; left time: 1168.5276s
Epoch: 33 cost time: 4.5172119140625
Epoch: 33, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.289 Vali Acc: 0.355 Test Loss: 2.289 Test Acc: 0.355
Validation loss decreased (-0.354397 --> -0.355208).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.1365643
	speed: 0.1111s/iter; left time: 1135.3110s
Epoch: 34 cost time: 4.196486234664917
Epoch: 34, Steps: 154 | Train Loss: 1.511 Vali Loss: 2.413 Vali Acc: 0.353 Test Loss: 2.413 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 1.3094690
	speed: 0.1074s/iter; left time: 1080.8934s
Epoch: 35 cost time: 4.308160305023193
Epoch: 35, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.404 Vali Acc: 0.352 Test Loss: 2.404 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 1.2696056
	speed: 0.1094s/iter; left time: 1084.1576s
Epoch: 36 cost time: 4.256706476211548
Epoch: 36, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.385 Vali Acc: 0.359 Test Loss: 2.385 Test Acc: 0.359
Validation loss decreased (-0.355208 --> -0.358857).  Saving model ...
	iters: 100, epoch: 37 | loss: 1.4269584
	speed: 0.1048s/iter; left time: 1022.9539s
Epoch: 37 cost time: 4.2016215324401855
Epoch: 37, Steps: 154 | Train Loss: 1.445 Vali Loss: 2.510 Vali Acc: 0.366 Test Loss: 2.510 Test Acc: 0.366
Validation loss decreased (-0.358857 --> -0.365749).  Saving model ...
	iters: 100, epoch: 38 | loss: 1.1729749
	speed: 0.1122s/iter; left time: 1077.7762s
Epoch: 38 cost time: 4.472910404205322
Epoch: 38, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.413 Vali Acc: 0.367 Test Loss: 2.413 Test Acc: 0.367
Validation loss decreased (-0.365749 --> -0.367372).  Saving model ...
	iters: 100, epoch: 39 | loss: 1.2012711
	speed: 0.1081s/iter; left time: 1021.7637s
Epoch: 39 cost time: 4.19864821434021
Epoch: 39, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.500 Vali Acc: 0.362 Test Loss: 2.500 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 1.3089756
	speed: 0.1064s/iter; left time: 989.2919s
Epoch: 40 cost time: 4.073745250701904
Epoch: 40, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.348 Vali Acc: 0.357 Test Loss: 2.348 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 2.1219101
	speed: 0.1064s/iter; left time: 972.4533s
Epoch: 41 cost time: 4.324035882949829
Epoch: 41, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.421 Vali Acc: 0.371 Test Loss: 2.421 Test Acc: 0.371
Validation loss decreased (-0.367372 --> -0.371428).  Saving model ...
	iters: 100, epoch: 42 | loss: 1.1649196
	speed: 0.1071s/iter; left time: 962.2498s
Epoch: 42 cost time: 4.072800159454346
Epoch: 42, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.458 Vali Acc: 0.368 Test Loss: 2.458 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 1.2579426
	speed: 0.1048s/iter; left time: 926.0899s
Epoch: 43 cost time: 4.170973300933838
Epoch: 43, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.571 Vali Acc: 0.374 Test Loss: 2.571 Test Acc: 0.374
Validation loss decreased (-0.371428 --> -0.374265).  Saving model ...
	iters: 100, epoch: 44 | loss: 1.6202912
	speed: 0.1080s/iter; left time: 937.3786s
Epoch: 44 cost time: 4.417587518692017
Epoch: 44, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.684 Vali Acc: 0.362 Test Loss: 2.684 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 1.2112844
	speed: 0.1072s/iter; left time: 913.9413s
Epoch: 45 cost time: 4.026803255081177
Epoch: 45, Steps: 154 | Train Loss: 1.542 Vali Loss: 2.741 Vali Acc: 0.368 Test Loss: 2.741 Test Acc: 0.368
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 1.2922208
	speed: 0.1048s/iter; left time: 877.0641s
Epoch: 46 cost time: 4.313849449157715
Epoch: 46, Steps: 154 | Train Loss: 1.415 Vali Loss: 2.477 Vali Acc: 0.378 Test Loss: 2.477 Test Acc: 0.378
Validation loss decreased (-0.374265 --> -0.377510).  Saving model ...
	iters: 100, epoch: 47 | loss: 1.4998074
	speed: 0.1027s/iter; left time: 843.8173s
Epoch: 47 cost time: 4.303247690200806
Epoch: 47, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.537 Vali Acc: 0.370 Test Loss: 2.537 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 48 | loss: 1.1343852
	speed: 0.1120s/iter; left time: 903.3584s
Epoch: 48 cost time: 4.1711790561676025
Epoch: 48, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.840 Vali Acc: 0.367 Test Loss: 2.840 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 49 | loss: 0.8740425
	speed: 0.1072s/iter; left time: 847.9282s
Epoch: 49 cost time: 4.1896960735321045
Epoch: 49, Steps: 154 | Train Loss: 1.367 Vali Loss: 2.959 Vali Acc: 0.371 Test Loss: 2.959 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 50 | loss: 0.8576624
	speed: 0.1029s/iter; left time: 797.6102s
Epoch: 50 cost time: 4.06174898147583
Epoch: 50, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.694 Vali Acc: 0.383 Test Loss: 2.694 Test Acc: 0.383
Validation loss decreased (-0.377510 --> -0.382779).  Saving model ...
	iters: 100, epoch: 51 | loss: 1.3835666
	speed: 0.1084s/iter; left time: 823.6857s
Epoch: 51 cost time: 4.303347587585449
Epoch: 51, Steps: 154 | Train Loss: 1.334 Vali Loss: 2.851 Vali Acc: 0.369 Test Loss: 2.851 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 52 | loss: 1.6390810
	speed: 0.1077s/iter; left time: 801.6696s
Epoch: 52 cost time: 4.169967889785767
Epoch: 52, Steps: 154 | Train Loss: 1.466 Vali Loss: 2.771 Vali Acc: 0.380 Test Loss: 2.771 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 53 | loss: 1.1805836
	speed: 0.1053s/iter; left time: 768.3110s
Epoch: 53 cost time: 4.232234001159668
Epoch: 53, Steps: 154 | Train Loss: 1.482 Vali Loss: 3.300 Vali Acc: 0.383 Test Loss: 3.300 Test Acc: 0.383
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 54 | loss: 1.2075386
	speed: 0.1078s/iter; left time: 769.5783s
Epoch: 54 cost time: 4.071393966674805
Epoch: 54, Steps: 154 | Train Loss: 1.419 Vali Loss: 3.087 Vali Acc: 0.383 Test Loss: 3.087 Test Acc: 0.383
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 55 | loss: 1.3893620
	speed: 0.1039s/iter; left time: 725.8464s
Epoch: 55 cost time: 4.131211280822754
Epoch: 55, Steps: 154 | Train Loss: 1.316 Vali Loss: 3.306 Vali Acc: 0.230 Test Loss: 3.306 Test Acc: 0.230
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 56 | loss: 1.2112540
	speed: 0.1047s/iter; left time: 714.9125s
Epoch: 56 cost time: 4.422226905822754
Epoch: 56, Steps: 154 | Train Loss: 1.362 Vali Loss: 3.050 Vali Acc: 0.380 Test Loss: 3.050 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 57 | loss: 0.9976774
	speed: 0.1106s/iter; left time: 738.7424s
Epoch: 57 cost time: 4.172488212585449
Epoch: 57, Steps: 154 | Train Loss: 1.335 Vali Loss: 2.793 Vali Acc: 0.376 Test Loss: 2.793 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 58 | loss: 1.3873100
	speed: 0.1042s/iter; left time: 679.5808s
Epoch: 58 cost time: 3.9729204177856445
Epoch: 58, Steps: 154 | Train Loss: 1.372 Vali Loss: 3.123 Vali Acc: 0.380 Test Loss: 3.123 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 59 | loss: 1.3725441
	speed: 0.1071s/iter; left time: 682.1619s
Epoch: 59 cost time: 4.21208643913269
Epoch: 59, Steps: 154 | Train Loss: 1.350 Vali Loss: 3.168 Vali Acc: 0.389 Test Loss: 3.168 Test Acc: 0.389
Validation loss decreased (-0.382779 --> -0.389263).  Saving model ...
	iters: 100, epoch: 60 | loss: 1.3400398
	speed: 0.1086s/iter; left time: 674.8517s
Epoch: 60 cost time: 4.046216011047363
Epoch: 60, Steps: 154 | Train Loss: 1.465 Vali Loss: 3.074 Vali Acc: 0.387 Test Loss: 3.074 Test Acc: 0.387
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 61 | loss: 0.7929780
	speed: 0.1061s/iter; left time: 642.8559s
Epoch: 61 cost time: 4.425101041793823
Epoch: 61, Steps: 154 | Train Loss: 1.337 Vali Loss: 3.231 Vali Acc: 0.358 Test Loss: 3.231 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 62 | loss: 1.5262239
	speed: 0.1061s/iter; left time: 626.7017s
Epoch: 62 cost time: 4.144354343414307
Epoch: 62, Steps: 154 | Train Loss: 1.340 Vali Loss: 3.014 Vali Acc: 0.386 Test Loss: 3.014 Test Acc: 0.386
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 63 | loss: 0.8283790
	speed: 0.1080s/iter; left time: 621.2148s
Epoch: 63 cost time: 4.263168573379517
Epoch: 63, Steps: 154 | Train Loss: 1.293 Vali Loss: 3.035 Vali Acc: 0.382 Test Loss: 3.035 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 64 | loss: 0.9054830
	speed: 0.1107s/iter; left time: 619.6738s
Epoch: 64 cost time: 4.639551401138306
Epoch: 64, Steps: 154 | Train Loss: 1.325 Vali Loss: 3.047 Vali Acc: 0.381 Test Loss: 3.047 Test Acc: 0.381
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 65 | loss: 1.4709187
	speed: 0.1101s/iter; left time: 599.3444s
Epoch: 65 cost time: 4.259167671203613
Epoch: 65, Steps: 154 | Train Loss: 1.440 Vali Loss: 3.127 Vali Acc: 0.380 Test Loss: 3.127 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 66 | loss: 1.1344436
	speed: 0.1092s/iter; left time: 577.7199s
Epoch: 66 cost time: 4.422217607498169
Epoch: 66, Steps: 154 | Train Loss: 1.276 Vali Loss: 3.203 Vali Acc: 0.380 Test Loss: 3.203 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 67 | loss: 1.7726746
	speed: 0.1152s/iter; left time: 591.7355s
Epoch: 67 cost time: 4.503352403640747
Epoch: 67, Steps: 154 | Train Loss: 1.393 Vali Loss: 3.298 Vali Acc: 0.379 Test Loss: 3.298 Test Acc: 0.379
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 68 | loss: 1.0079603
	speed: 0.1094s/iter; left time: 545.2939s
Epoch: 68 cost time: 4.2652223110198975
Epoch: 68, Steps: 154 | Train Loss: 1.542 Vali Loss: 3.194 Vali Acc: 0.381 Test Loss: 3.194 Test Acc: 0.381
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 69 | loss: 0.9002690
	speed: 0.1121s/iter; left time: 541.3529s
Epoch: 69 cost time: 4.248435020446777
Epoch: 69, Steps: 154 | Train Loss: 1.388 Vali Loss: 3.213 Vali Acc: 0.352 Test Loss: 3.213 Test Acc: 0.352
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38929440389294406
model parameter : 85110
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9190249
	speed: 0.0439s/iter; left time: 672.1281s
Epoch: 1 cost time: 5.793184280395508
Epoch: 1, Steps: 154 | Train Loss: 2.327 Vali Loss: 2.142 Vali Acc: 0.317 Test Loss: 2.142 Test Acc: 0.317
Validation loss decreased (inf --> -0.316686).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1645014
	speed: 0.1088s/iter; left time: 1647.4160s
Epoch: 2 cost time: 4.269794702529907
Epoch: 2, Steps: 154 | Train Loss: 2.098 Vali Loss: 2.144 Vali Acc: 0.318 Test Loss: 2.144 Test Acc: 0.318
Validation loss decreased (-0.316686 --> -0.317497).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0986049
	speed: 0.1082s/iter; left time: 1622.9238s
Epoch: 3 cost time: 4.294806241989136
Epoch: 3, Steps: 154 | Train Loss: 2.028 Vali Loss: 2.144 Vali Acc: 0.317 Test Loss: 2.144 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7903409
	speed: 0.1054s/iter; left time: 1564.4856s
Epoch: 4 cost time: 4.0225303173065186
Epoch: 4, Steps: 154 | Train Loss: 2.002 Vali Loss: 2.132 Vali Acc: 0.318 Test Loss: 2.132 Test Acc: 0.318
Validation loss decreased (-0.317497 --> -0.318308).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8034999
	speed: 0.1114s/iter; left time: 1635.6153s
Epoch: 5 cost time: 4.24918270111084
Epoch: 5, Steps: 154 | Train Loss: 1.958 Vali Loss: 2.165 Vali Acc: 0.320 Test Loss: 2.165 Test Acc: 0.320
Validation loss decreased (-0.318308 --> -0.319524).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2214899
	speed: 0.1057s/iter; left time: 1535.4468s
Epoch: 6 cost time: 4.198348045349121
Epoch: 6, Steps: 154 | Train Loss: 1.929 Vali Loss: 2.142 Vali Acc: 0.321 Test Loss: 2.142 Test Acc: 0.321
Validation loss decreased (-0.319524 --> -0.321146).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6733675
	speed: 0.1084s/iter; left time: 1557.7725s
Epoch: 7 cost time: 4.149243354797363
Epoch: 7, Steps: 154 | Train Loss: 1.929 Vali Loss: 2.139 Vali Acc: 0.320 Test Loss: 2.139 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7182373
	speed: 0.1149s/iter; left time: 1633.7766s
Epoch: 8 cost time: 4.266496896743774
Epoch: 8, Steps: 154 | Train Loss: 1.890 Vali Loss: 2.140 Vali Acc: 0.322 Test Loss: 2.140 Test Acc: 0.322
Validation loss decreased (-0.321146 --> -0.321958).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5076844
	speed: 0.1046s/iter; left time: 1471.7755s
Epoch: 9 cost time: 4.188053846359253
Epoch: 9, Steps: 154 | Train Loss: 1.858 Vali Loss: 2.137 Vali Acc: 0.321 Test Loss: 2.137 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4224457
	speed: 0.1061s/iter; left time: 1476.3574s
Epoch: 10 cost time: 4.356513261795044
Epoch: 10, Steps: 154 | Train Loss: 1.835 Vali Loss: 2.117 Vali Acc: 0.324 Test Loss: 2.117 Test Acc: 0.324
Validation loss decreased (-0.321958 --> -0.324391).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8280566
	speed: 0.1096s/iter; left time: 1508.3964s
Epoch: 11 cost time: 4.397225379943848
Epoch: 11, Steps: 154 | Train Loss: 1.808 Vali Loss: 2.145 Vali Acc: 0.324 Test Loss: 2.145 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.0085561
	speed: 0.1049s/iter; left time: 1427.7638s
Epoch: 12 cost time: 4.348464727401733
Epoch: 12, Steps: 154 | Train Loss: 1.817 Vali Loss: 2.141 Vali Acc: 0.329 Test Loss: 2.141 Test Acc: 0.329
Validation loss decreased (-0.324391 --> -0.328851).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7219781
	speed: 0.1087s/iter; left time: 1462.3148s
Epoch: 13 cost time: 4.242801666259766
Epoch: 13, Steps: 154 | Train Loss: 1.797 Vali Loss: 2.140 Vali Acc: 0.328 Test Loss: 2.140 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.9483621
	speed: 0.1053s/iter; left time: 1399.9607s
Epoch: 14 cost time: 4.339740753173828
Epoch: 14, Steps: 154 | Train Loss: 1.779 Vali Loss: 2.119 Vali Acc: 0.326 Test Loss: 2.119 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.7291107
	speed: 0.1083s/iter; left time: 1423.9163s
Epoch: 15 cost time: 4.174749135971069
Epoch: 15, Steps: 154 | Train Loss: 1.736 Vali Loss: 2.144 Vali Acc: 0.330 Test Loss: 2.144 Test Acc: 0.330
Validation loss decreased (-0.328851 --> -0.330068).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.0444667
	speed: 0.1132s/iter; left time: 1471.1112s
Epoch: 16 cost time: 4.305834054946899
Epoch: 16, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.196 Vali Acc: 0.329 Test Loss: 2.196 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.7926061
	speed: 0.1107s/iter; left time: 1421.0476s
Epoch: 17 cost time: 4.181445598602295
Epoch: 17, Steps: 154 | Train Loss: 1.691 Vali Loss: 2.199 Vali Acc: 0.335 Test Loss: 2.199 Test Acc: 0.335
Validation loss decreased (-0.330068 --> -0.335339).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.1861300
	speed: 0.1099s/iter; left time: 1393.5293s
Epoch: 18 cost time: 4.186030387878418
Epoch: 18, Steps: 154 | Train Loss: 1.681 Vali Loss: 2.221 Vali Acc: 0.334 Test Loss: 2.221 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.6956891
	speed: 0.1084s/iter; left time: 1358.2537s
Epoch: 19 cost time: 4.173725605010986
Epoch: 19, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.217 Vali Acc: 0.338 Test Loss: 2.217 Test Acc: 0.338
Validation loss decreased (-0.335339 --> -0.337772).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.7112267
	speed: 0.1051s/iter; left time: 1300.6562s
Epoch: 20 cost time: 4.229292154312134
Epoch: 20, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.236 Vali Acc: 0.340 Test Loss: 2.236 Test Acc: 0.340
Validation loss decreased (-0.337772 --> -0.340205).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.4038928
	speed: 0.1094s/iter; left time: 1337.1461s
Epoch: 21 cost time: 4.212635278701782
Epoch: 21, Steps: 154 | Train Loss: 1.650 Vali Loss: 2.205 Vali Acc: 0.338 Test Loss: 2.205 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.3031181
	speed: 0.1044s/iter; left time: 1259.2912s
Epoch: 22 cost time: 4.18164587020874
Epoch: 22, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.234 Vali Acc: 0.343 Test Loss: 2.234 Test Acc: 0.343
Validation loss decreased (-0.340205 --> -0.343043).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.5683943
	speed: 0.1028s/iter; left time: 1224.7949s
Epoch: 23 cost time: 4.056262969970703
Epoch: 23, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.239 Vali Acc: 0.338 Test Loss: 2.239 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 2.0579257
	speed: 0.1108s/iter; left time: 1302.8556s
Epoch: 24 cost time: 4.1628947257995605
Epoch: 24, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.294 Vali Acc: 0.346 Test Loss: 2.294 Test Acc: 0.346
Validation loss decreased (-0.343043 --> -0.345881).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.8417346
	speed: 0.1062s/iter; left time: 1232.2919s
Epoch: 25 cost time: 3.9450817108154297
Epoch: 25, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.293 Vali Acc: 0.348 Test Loss: 2.293 Test Acc: 0.348
Validation loss decreased (-0.345881 --> -0.347909).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.0761524
	speed: 0.1072s/iter; left time: 1228.0556s
Epoch: 26 cost time: 4.125185489654541
Epoch: 26, Steps: 154 | Train Loss: 1.635 Vali Loss: 2.219 Vali Acc: 0.348 Test Loss: 2.219 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.7303171
	speed: 0.1074s/iter; left time: 1212.9430s
Epoch: 27 cost time: 3.988603353500366
Epoch: 27, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.276 Vali Acc: 0.350 Test Loss: 2.276 Test Acc: 0.350
Validation loss decreased (-0.347909 --> -0.349531).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.7821281
	speed: 0.0959s/iter; left time: 1068.6289s
Epoch: 28 cost time: 4.176170587539673
Epoch: 28, Steps: 154 | Train Loss: 1.686 Vali Loss: 2.328 Vali Acc: 0.354 Test Loss: 2.328 Test Acc: 0.354
Validation loss decreased (-0.349531 --> -0.353586).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.1919855
	speed: 0.1074s/iter; left time: 1179.8805s
Epoch: 29 cost time: 4.443254470825195
Epoch: 29, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.327 Vali Acc: 0.354 Test Loss: 2.327 Test Acc: 0.354
Validation loss decreased (-0.353586 --> -0.353586).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.7799397
	speed: 0.1111s/iter; left time: 1204.1342s
Epoch: 30 cost time: 4.2837584018707275
Epoch: 30, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.377 Vali Acc: 0.352 Test Loss: 2.377 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.4322667
	speed: 0.1115s/iter; left time: 1191.4257s
Epoch: 31 cost time: 4.418311357498169
Epoch: 31, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.352 Vali Acc: 0.362 Test Loss: 2.352 Test Acc: 0.362
Validation loss decreased (-0.353586 --> -0.361696).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.4450059
	speed: 0.1103s/iter; left time: 1161.1187s
Epoch: 32 cost time: 4.198601245880127
Epoch: 32, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.410 Vali Acc: 0.361 Test Loss: 2.410 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 1.2130686
	speed: 0.1091s/iter; left time: 1131.4549s
Epoch: 33 cost time: 4.420887231826782
Epoch: 33, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.367 Vali Acc: 0.365 Test Loss: 2.367 Test Acc: 0.365
Validation loss decreased (-0.361696 --> -0.364534).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.1409345
	speed: 0.1114s/iter; left time: 1138.7361s
Epoch: 34 cost time: 4.228261470794678
Epoch: 34, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.352 Vali Acc: 0.354 Test Loss: 2.352 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 1.2488699
	speed: 0.1065s/iter; left time: 1072.0713s
Epoch: 35 cost time: 4.209747076034546
Epoch: 35, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.341 Vali Acc: 0.355 Test Loss: 2.341 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 1.1541362
	speed: 0.1041s/iter; left time: 1031.3331s
Epoch: 36 cost time: 4.076233148574829
Epoch: 36, Steps: 154 | Train Loss: 1.644 Vali Loss: 2.538 Vali Acc: 0.359 Test Loss: 2.538 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 1.6610837
	speed: 0.0986s/iter; left time: 961.8811s
Epoch: 37 cost time: 3.9162938594818115
Epoch: 37, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.622 Vali Acc: 0.367 Test Loss: 2.622 Test Acc: 0.367
Validation loss decreased (-0.364534 --> -0.367370).  Saving model ...
	iters: 100, epoch: 38 | loss: 1.2830287
	speed: 0.0992s/iter; left time: 952.9524s
Epoch: 38 cost time: 4.140979766845703
Epoch: 38, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.701 Vali Acc: 0.362 Test Loss: 2.701 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 1.1891227
	speed: 0.1065s/iter; left time: 1005.8721s
Epoch: 39 cost time: 4.329981327056885
Epoch: 39, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.628 Vali Acc: 0.361 Test Loss: 2.628 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 1.2908099
	speed: 0.1046s/iter; left time: 972.3071s
Epoch: 40 cost time: 4.05171799659729
Epoch: 40, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.377 Vali Acc: 0.352 Test Loss: 2.377 Test Acc: 0.352
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 2.0075145
	speed: 0.1058s/iter; left time: 967.1423s
Epoch: 41 cost time: 4.3007776737213135
Epoch: 41, Steps: 154 | Train Loss: 1.385 Vali Loss: 2.677 Vali Acc: 0.371 Test Loss: 2.677 Test Acc: 0.371
Validation loss decreased (-0.367370 --> -0.371425).  Saving model ...
	iters: 100, epoch: 42 | loss: 1.1771393
	speed: 0.1041s/iter; left time: 935.9671s
Epoch: 42 cost time: 3.9932119846343994
Epoch: 42, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.502 Vali Acc: 0.369 Test Loss: 2.502 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 1.4340578
	speed: 0.1080s/iter; left time: 954.3744s
Epoch: 43 cost time: 4.022948741912842
Epoch: 43, Steps: 154 | Train Loss: 1.415 Vali Loss: 2.682 Vali Acc: 0.381 Test Loss: 2.682 Test Acc: 0.381
Validation loss decreased (-0.371425 --> -0.380752).  Saving model ...
	iters: 100, epoch: 44 | loss: 1.2684951
	speed: 0.1084s/iter; left time: 941.0352s
Epoch: 44 cost time: 4.261207342147827
Epoch: 44, Steps: 154 | Train Loss: 1.441 Vali Loss: 2.701 Vali Acc: 0.362 Test Loss: 2.701 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 1.0961311
	speed: 0.1032s/iter; left time: 879.4868s
Epoch: 45 cost time: 3.966367483139038
Epoch: 45, Steps: 154 | Train Loss: 1.666 Vali Loss: 2.608 Vali Acc: 0.365 Test Loss: 2.608 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 1.3070235
	speed: 0.1105s/iter; left time: 925.1502s
Epoch: 46 cost time: 4.216374635696411
Epoch: 46, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.498 Vali Acc: 0.373 Test Loss: 2.498 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 47 | loss: 1.7464576
	speed: 0.1035s/iter; left time: 850.1650s
Epoch: 47 cost time: 4.8388214111328125
Epoch: 47, Steps: 154 | Train Loss: 1.396 Vali Loss: 2.765 Vali Acc: 0.366 Test Loss: 2.765 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 48 | loss: 1.1456323
	speed: 0.1184s/iter; left time: 954.7157s
Epoch: 48 cost time: 3.6509788036346436
Epoch: 48, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.869 Vali Acc: 0.369 Test Loss: 2.869 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 49 | loss: 0.8757229
	speed: 0.0810s/iter; left time: 640.9633s
Epoch: 49 cost time: 3.383336305618286
Epoch: 49, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.739 Vali Acc: 0.376 Test Loss: 2.739 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 50 | loss: 0.7664872
	speed: 0.0875s/iter; left time: 678.3549s
Epoch: 50 cost time: 3.5736706256866455
Epoch: 50, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.458 Vali Acc: 0.392 Test Loss: 2.458 Test Acc: 0.392
Validation loss decreased (-0.380752 --> -0.391703).  Saving model ...
	iters: 100, epoch: 51 | loss: 1.4526193
	speed: 0.0975s/iter; left time: 741.1449s
Epoch: 51 cost time: 4.152883052825928
Epoch: 51, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.648 Vali Acc: 0.373 Test Loss: 2.648 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 52 | loss: 1.5822036
	speed: 0.1057s/iter; left time: 787.0448s
Epoch: 52 cost time: 4.270150184631348
Epoch: 52, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.788 Vali Acc: 0.386 Test Loss: 2.788 Test Acc: 0.386
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 53 | loss: 1.2087709
	speed: 0.1068s/iter; left time: 779.2008s
Epoch: 53 cost time: 4.321192026138306
Epoch: 53, Steps: 154 | Train Loss: 1.343 Vali Loss: 2.891 Vali Acc: 0.376 Test Loss: 2.891 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 54 | loss: 3.0129614
	speed: 0.1031s/iter; left time: 736.3417s
Epoch: 54 cost time: 4.0160558223724365
Epoch: 54, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.979 Vali Acc: 0.361 Test Loss: 2.979 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 55 | loss: 3.4314184
	speed: 0.1033s/iter; left time: 721.7061s
Epoch: 55 cost time: 4.093592882156372
Epoch: 55, Steps: 154 | Train Loss: 1.636 Vali Loss: 3.088 Vali Acc: 0.225 Test Loss: 3.088 Test Acc: 0.225
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 56 | loss: 1.7405429
	speed: 0.1070s/iter; left time: 731.2415s
Epoch: 56 cost time: 4.284838438034058
Epoch: 56, Steps: 154 | Train Loss: 1.374 Vali Loss: 2.918 Vali Acc: 0.376 Test Loss: 2.918 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 57 | loss: 1.0441217
	speed: 0.1074s/iter; left time: 717.3378s
Epoch: 57 cost time: 4.147902965545654
Epoch: 57, Steps: 154 | Train Loss: 1.339 Vali Loss: 2.904 Vali Acc: 0.376 Test Loss: 2.904 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 58 | loss: 1.3168343
	speed: 0.1109s/iter; left time: 723.3583s
Epoch: 58 cost time: 4.069370985031128
Epoch: 58, Steps: 154 | Train Loss: 1.306 Vali Loss: 3.153 Vali Acc: 0.371 Test Loss: 3.153 Test Acc: 0.371
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 59 | loss: 1.3003408
	speed: 0.1084s/iter; left time: 690.3553s
Epoch: 59 cost time: 4.1992762088775635
Epoch: 59, Steps: 154 | Train Loss: 1.294 Vali Loss: 3.185 Vali Acc: 0.386 Test Loss: 3.185 Test Acc: 0.386
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 60 | loss: 1.4912580
	speed: 0.1104s/iter; left time: 686.3994s
Epoch: 60 cost time: 3.953151226043701
Epoch: 60, Steps: 154 | Train Loss: 1.475 Vali Loss: 3.238 Vali Acc: 0.390 Test Loss: 3.238 Test Acc: 0.390
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39172749391727496
model parameter : 85110
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9114842
	speed: 0.0430s/iter; left time: 657.4134s
Epoch: 1 cost time: 5.664807081222534
Epoch: 1, Steps: 154 | Train Loss: 2.316 Vali Loss: 2.146 Vali Acc: 0.316 Test Loss: 2.146 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9440246
	speed: 0.1011s/iter; left time: 1530.7631s
Epoch: 2 cost time: 4.085688829421997
Epoch: 2, Steps: 154 | Train Loss: 2.092 Vali Loss: 2.146 Vali Acc: 0.317 Test Loss: 2.146 Test Acc: 0.317
Validation loss decreased (-0.315875 --> -0.316686).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0974383
	speed: 0.1032s/iter; left time: 1547.4447s
Epoch: 3 cost time: 4.369525671005249
Epoch: 3, Steps: 154 | Train Loss: 2.033 Vali Loss: 2.140 Vali Acc: 0.318 Test Loss: 2.140 Test Acc: 0.318
Validation loss decreased (-0.316686 --> -0.317497).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7950104
	speed: 0.0975s/iter; left time: 1447.1680s
Epoch: 4 cost time: 4.1655113697052
Epoch: 4, Steps: 154 | Train Loss: 2.005 Vali Loss: 2.128 Vali Acc: 0.318 Test Loss: 2.128 Test Acc: 0.318
Validation loss decreased (-0.317497 --> -0.317902).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8619542
	speed: 0.1080s/iter; left time: 1586.3931s
Epoch: 5 cost time: 4.189287424087524
Epoch: 5, Steps: 154 | Train Loss: 1.964 Vali Loss: 2.146 Vali Acc: 0.319 Test Loss: 2.146 Test Acc: 0.319
Validation loss decreased (-0.317902 --> -0.318713).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2521222
	speed: 0.1086s/iter; left time: 1578.2202s
Epoch: 6 cost time: 4.27414608001709
Epoch: 6, Steps: 154 | Train Loss: 1.936 Vali Loss: 2.129 Vali Acc: 0.320 Test Loss: 2.129 Test Acc: 0.320
Validation loss decreased (-0.318713 --> -0.319525).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6886896
	speed: 0.1065s/iter; left time: 1530.5190s
Epoch: 7 cost time: 4.289598703384399
Epoch: 7, Steps: 154 | Train Loss: 1.929 Vali Loss: 2.128 Vali Acc: 0.320 Test Loss: 2.128 Test Acc: 0.320
Validation loss decreased (-0.319525 --> -0.319930).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6894016
	speed: 0.1109s/iter; left time: 1577.4732s
Epoch: 8 cost time: 4.298762083053589
Epoch: 8, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.138 Vali Acc: 0.321 Test Loss: 2.138 Test Acc: 0.321
Validation loss decreased (-0.319930 --> -0.321147).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4921981
	speed: 0.1091s/iter; left time: 1534.7299s
Epoch: 9 cost time: 4.115376949310303
Epoch: 9, Steps: 154 | Train Loss: 1.862 Vali Loss: 2.126 Vali Acc: 0.322 Test Loss: 2.126 Test Acc: 0.322
Validation loss decreased (-0.321147 --> -0.321552).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4234749
	speed: 0.1040s/iter; left time: 1447.2818s
Epoch: 10 cost time: 4.174484014511108
Epoch: 10, Steps: 154 | Train Loss: 1.841 Vali Loss: 2.111 Vali Acc: 0.325 Test Loss: 2.111 Test Acc: 0.325
Validation loss decreased (-0.321552 --> -0.324796).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8055949
	speed: 0.1063s/iter; left time: 1463.0972s
Epoch: 11 cost time: 4.0764100551605225
Epoch: 11, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.128 Vali Acc: 0.325 Test Loss: 2.128 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9894484
	speed: 0.1045s/iter; left time: 1421.4868s
Epoch: 12 cost time: 4.131020784378052
Epoch: 12, Steps: 154 | Train Loss: 1.822 Vali Loss: 2.109 Vali Acc: 0.332 Test Loss: 2.109 Test Acc: 0.332
Validation loss decreased (-0.324796 --> -0.332096).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6652642
	speed: 0.1027s/iter; left time: 1381.3612s
Epoch: 13 cost time: 4.148871421813965
Epoch: 13, Steps: 154 | Train Loss: 1.784 Vali Loss: 2.159 Vali Acc: 0.328 Test Loss: 2.159 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.9948826
	speed: 0.1027s/iter; left time: 1366.3847s
Epoch: 14 cost time: 3.9934911727905273
Epoch: 14, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.130 Vali Acc: 0.332 Test Loss: 2.130 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.7039261
	speed: 0.1015s/iter; left time: 1333.6430s
Epoch: 15 cost time: 3.973942995071411
Epoch: 15, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.139 Vali Acc: 0.334 Test Loss: 2.139 Test Acc: 0.334
Validation loss decreased (-0.332096 --> -0.333717).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.0036192
	speed: 0.1039s/iter; left time: 1350.2654s
Epoch: 16 cost time: 4.084070682525635
Epoch: 16, Steps: 154 | Train Loss: 1.717 Vali Loss: 2.170 Vali Acc: 0.337 Test Loss: 2.170 Test Acc: 0.337
Validation loss decreased (-0.333717 --> -0.337367).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.7094083
	speed: 0.1059s/iter; left time: 1359.1548s
Epoch: 17 cost time: 4.053804874420166
Epoch: 17, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.214 Vali Acc: 0.339 Test Loss: 2.214 Test Acc: 0.339
Validation loss decreased (-0.337367 --> -0.339394).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.5511560
	speed: 0.1041s/iter; left time: 1320.6829s
Epoch: 18 cost time: 4.162083864212036
Epoch: 18, Steps: 154 | Train Loss: 1.700 Vali Loss: 2.175 Vali Acc: 0.339 Test Loss: 2.175 Test Acc: 0.339
Validation loss decreased (-0.339394 --> -0.339394).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.6092136
	speed: 0.1027s/iter; left time: 1286.6996s
Epoch: 19 cost time: 4.1502156257629395
Epoch: 19, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.228 Vali Acc: 0.342 Test Loss: 2.228 Test Acc: 0.342
Validation loss decreased (-0.339394 --> -0.341827).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.5171081
	speed: 0.1034s/iter; left time: 1279.0385s
Epoch: 20 cost time: 3.9762167930603027
Epoch: 20, Steps: 154 | Train Loss: 1.723 Vali Loss: 2.250 Vali Acc: 0.345 Test Loss: 2.250 Test Acc: 0.345
Validation loss decreased (-0.341827 --> -0.345071).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.2872033
	speed: 0.1039s/iter; left time: 1269.2938s
Epoch: 21 cost time: 4.2980406284332275
Epoch: 21, Steps: 154 | Train Loss: 1.644 Vali Loss: 2.231 Vali Acc: 0.344 Test Loss: 2.231 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.2980963
	speed: 0.1080s/iter; left time: 1303.2023s
Epoch: 22 cost time: 4.220824241638184
Epoch: 22, Steps: 154 | Train Loss: 1.630 Vali Loss: 2.232 Vali Acc: 0.345 Test Loss: 2.232 Test Acc: 0.345
Validation loss decreased (-0.345071 --> -0.345476).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.5042853
	speed: 0.1036s/iter; left time: 1233.8695s
Epoch: 23 cost time: 4.096335172653198
Epoch: 23, Steps: 154 | Train Loss: 1.630 Vali Loss: 2.276 Vali Acc: 0.343 Test Loss: 2.276 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 3.4641681
	speed: 0.1078s/iter; left time: 1268.1796s
Epoch: 24 cost time: 4.323495388031006
Epoch: 24, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.283 Vali Acc: 0.352 Test Loss: 2.283 Test Acc: 0.352
Validation loss decreased (-0.345476 --> -0.352370).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.7664145
	speed: 0.1100s/iter; left time: 1276.5516s
Epoch: 25 cost time: 4.213881731033325
Epoch: 25, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.300 Vali Acc: 0.353 Test Loss: 2.300 Test Acc: 0.353
Validation loss decreased (-0.352370 --> -0.353181).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.0334562
	speed: 0.1098s/iter; left time: 1257.1723s
Epoch: 26 cost time: 4.188776254653931
Epoch: 26, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.250 Vali Acc: 0.349 Test Loss: 2.250 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.7250655
	speed: 0.1089s/iter; left time: 1230.5916s
Epoch: 27 cost time: 4.340113401412964
Epoch: 27, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.333 Vali Acc: 0.350 Test Loss: 2.333 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.6075934
	speed: 0.1021s/iter; left time: 1137.4790s
Epoch: 28 cost time: 4.046574831008911
Epoch: 28, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.368 Vali Acc: 0.352 Test Loss: 2.368 Test Acc: 0.352
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.2065308
	speed: 0.1020s/iter; left time: 1120.9519s
Epoch: 29 cost time: 4.1120383739471436
Epoch: 29, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.313 Vali Acc: 0.358 Test Loss: 2.313 Test Acc: 0.358
Validation loss decreased (-0.353181 --> -0.358047).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.7808374
	speed: 0.1049s/iter; left time: 1136.1878s
Epoch: 30 cost time: 4.235974311828613
Epoch: 30, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.393 Vali Acc: 0.352 Test Loss: 2.393 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.4750776
	speed: 0.1030s/iter; left time: 1099.7839s
Epoch: 31 cost time: 4.063408374786377
Epoch: 31, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.357 Vali Acc: 0.337 Test Loss: 2.357 Test Acc: 0.337
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.3755411
	speed: 0.1016s/iter; left time: 1069.2213s
Epoch: 32 cost time: 4.076314926147461
Epoch: 32, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.315 Vali Acc: 0.358 Test Loss: 2.315 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 1.1090522
	speed: 0.1010s/iter; left time: 1048.1437s
Epoch: 33 cost time: 3.9279978275299072
Epoch: 33, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.387 Vali Acc: 0.352 Test Loss: 2.387 Test Acc: 0.352
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 1.0741099
	speed: 0.0950s/iter; left time: 971.2265s
Epoch: 34 cost time: 3.747382402420044
Epoch: 34, Steps: 154 | Train Loss: 1.668 Vali Loss: 2.362 Vali Acc: 0.358 Test Loss: 2.362 Test Acc: 0.358
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 1.2627691
	speed: 0.1048s/iter; left time: 1055.1930s
Epoch: 35 cost time: 4.100082635879517
Epoch: 35, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.488 Vali Acc: 0.357 Test Loss: 2.488 Test Acc: 0.357
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 1.1239082
	speed: 0.1085s/iter; left time: 1074.8712s
Epoch: 36 cost time: 4.169031381607056
Epoch: 36, Steps: 154 | Train Loss: 1.557 Vali Loss: 2.411 Vali Acc: 0.359 Test Loss: 2.411 Test Acc: 0.359
Validation loss decreased (-0.358047 --> -0.359262).  Saving model ...
	iters: 100, epoch: 37 | loss: 1.0057406
	speed: 0.1110s/iter; left time: 1083.2290s
Epoch: 37 cost time: 4.056936740875244
Epoch: 37, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.571 Vali Acc: 0.371 Test Loss: 2.571 Test Acc: 0.371
Validation loss decreased (-0.359262 --> -0.371021).  Saving model ...
	iters: 100, epoch: 38 | loss: 1.2291650
	speed: 0.1063s/iter; left time: 1020.8172s
Epoch: 38 cost time: 4.3270423412323
Epoch: 38, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.435 Vali Acc: 0.358 Test Loss: 2.435 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 1.2529924
	speed: 0.1111s/iter; left time: 1049.9436s
Epoch: 39 cost time: 4.09604287147522
Epoch: 39, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.549 Vali Acc: 0.361 Test Loss: 2.549 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 1.0862451
	speed: 0.1073s/iter; left time: 997.5924s
Epoch: 40 cost time: 4.231860160827637
Epoch: 40, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.449 Vali Acc: 0.356 Test Loss: 2.449 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 3.4467256
	speed: 0.1096s/iter; left time: 1002.0866s
Epoch: 41 cost time: 4.365951061248779
Epoch: 41, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.526 Vali Acc: 0.372 Test Loss: 2.526 Test Acc: 0.372
Validation loss decreased (-0.371021 --> -0.371832).  Saving model ...
	iters: 100, epoch: 42 | loss: 1.1304340
	speed: 0.1078s/iter; left time: 968.4299s
Epoch: 42 cost time: 4.311181545257568
Epoch: 42, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.532 Vali Acc: 0.366 Test Loss: 2.532 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 1.2383873
	speed: 0.1081s/iter; left time: 954.9568s
Epoch: 43 cost time: 4.274164915084839
Epoch: 43, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.498 Vali Acc: 0.369 Test Loss: 2.498 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 44 | loss: 1.2765522
	speed: 0.1096s/iter; left time: 951.1015s
Epoch: 44 cost time: 4.244896650314331
Epoch: 44, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.446 Vali Acc: 0.363 Test Loss: 2.446 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 45 | loss: 1.0845568
	speed: 0.1060s/iter; left time: 903.5492s
Epoch: 45 cost time: 4.1642045974731445
Epoch: 45, Steps: 154 | Train Loss: 1.393 Vali Loss: 2.511 Vali Acc: 0.366 Test Loss: 2.511 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 46 | loss: 1.4400412
	speed: 0.1047s/iter; left time: 876.5872s
Epoch: 46 cost time: 4.278853178024292
Epoch: 46, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.514 Vali Acc: 0.371 Test Loss: 2.514 Test Acc: 0.371
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 47 | loss: 1.8349123
	speed: 0.1075s/iter; left time: 883.1355s
Epoch: 47 cost time: 4.054819583892822
Epoch: 47, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.442 Vali Acc: 0.368 Test Loss: 2.442 Test Acc: 0.368
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 48 | loss: 1.0706207
	speed: 0.1053s/iter; left time: 849.2816s
Epoch: 48 cost time: 4.227512359619141
Epoch: 48, Steps: 154 | Train Loss: 1.410 Vali Loss: 2.666 Vali Acc: 0.363 Test Loss: 2.666 Test Acc: 0.363
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 49 | loss: 0.6718436
	speed: 0.1071s/iter; left time: 846.7669s
Epoch: 49 cost time: 4.127218961715698
Epoch: 49, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.685 Vali Acc: 0.367 Test Loss: 2.685 Test Acc: 0.367
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 50 | loss: 0.9478093
	speed: 0.1052s/iter; left time: 815.9828s
Epoch: 50 cost time: 4.123328447341919
Epoch: 50, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.664 Vali Acc: 0.373 Test Loss: 2.664 Test Acc: 0.373
Validation loss decreased (-0.371832 --> -0.373047).  Saving model ...
	iters: 100, epoch: 51 | loss: 1.5395832
	speed: 0.1064s/iter; left time: 808.7441s
Epoch: 51 cost time: 4.280693292617798
Epoch: 51, Steps: 154 | Train Loss: 1.355 Vali Loss: 2.729 Vali Acc: 0.364 Test Loss: 2.729 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 52 | loss: 1.5938063
	speed: 0.1063s/iter; left time: 791.4867s
Epoch: 52 cost time: 4.113659143447876
Epoch: 52, Steps: 154 | Train Loss: 1.297 Vali Loss: 3.058 Vali Acc: 0.366 Test Loss: 3.058 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 53 | loss: 1.2892220
	speed: 0.1043s/iter; left time: 760.6270s
Epoch: 53 cost time: 3.8733859062194824
Epoch: 53, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.838 Vali Acc: 0.372 Test Loss: 2.838 Test Acc: 0.372
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 54 | loss: 4.8053498
	speed: 0.1052s/iter; left time: 750.9998s
Epoch: 54 cost time: 4.127706289291382
Epoch: 54, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.798 Vali Acc: 0.373 Test Loss: 2.798 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 55 | loss: 10.2533369
	speed: 0.1066s/iter; left time: 744.6087s
Epoch: 55 cost time: 4.05419397354126
Epoch: 55, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.862 Vali Acc: 0.261 Test Loss: 2.862 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 56 | loss: 2.0512292
	speed: 0.1028s/iter; left time: 702.1498s
Epoch: 56 cost time: 4.172608137130737
Epoch: 56, Steps: 154 | Train Loss: 1.333 Vali Loss: 2.629 Vali Acc: 0.379 Test Loss: 2.629 Test Acc: 0.379
Validation loss decreased (-0.373047 --> -0.379130).  Saving model ...
	iters: 100, epoch: 57 | loss: 0.8679788
	speed: 0.1077s/iter; left time: 719.3067s
Epoch: 57 cost time: 4.1543333530426025
Epoch: 57, Steps: 154 | Train Loss: 1.361 Vali Loss: 2.652 Vali Acc: 0.372 Test Loss: 2.652 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 58 | loss: 1.2949431
	speed: 0.1057s/iter; left time: 689.6829s
Epoch: 58 cost time: 4.207179546356201
Epoch: 58, Steps: 154 | Train Loss: 1.315 Vali Loss: 2.873 Vali Acc: 0.372 Test Loss: 2.873 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 59 | loss: 3.8413780
	speed: 0.1048s/iter; left time: 667.6455s
Epoch: 59 cost time: 4.177610158920288
Epoch: 59, Steps: 154 | Train Loss: 1.345 Vali Loss: 2.870 Vali Acc: 0.379 Test Loss: 2.870 Test Acc: 0.379
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 60 | loss: 1.7966695
	speed: 0.1041s/iter; left time: 647.2017s
Epoch: 60 cost time: 4.1972057819366455
Epoch: 60, Steps: 154 | Train Loss: 1.372 Vali Loss: 2.813 Vali Acc: 0.382 Test Loss: 2.813 Test Acc: 0.382
Validation loss decreased (-0.379130 --> -0.382373).  Saving model ...
	iters: 100, epoch: 61 | loss: 0.8675020
	speed: 0.1082s/iter; left time: 655.9942s
Epoch: 61 cost time: 4.178199052810669
Epoch: 61, Steps: 154 | Train Loss: 1.300 Vali Loss: 2.914 Vali Acc: 0.380 Test Loss: 2.914 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 62 | loss: 2.2268462
	speed: 0.1075s/iter; left time: 635.2334s
Epoch: 62 cost time: 4.124712944030762
Epoch: 62, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.933 Vali Acc: 0.376 Test Loss: 2.933 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 63 | loss: 0.9581061
	speed: 0.0998s/iter; left time: 573.9872s
Epoch: 63 cost time: 3.917936325073242
Epoch: 63, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.845 Vali Acc: 0.382 Test Loss: 2.845 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 64 | loss: 0.7624739
	speed: 0.1083s/iter; left time: 606.2672s
Epoch: 64 cost time: 4.114456415176392
Epoch: 64, Steps: 154 | Train Loss: 1.343 Vali Loss: 2.949 Vali Acc: 0.376 Test Loss: 2.949 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 65 | loss: 1.5546085
	speed: 0.1063s/iter; left time: 579.0072s
Epoch: 65 cost time: 3.8735034465789795
Epoch: 65, Steps: 154 | Train Loss: 1.319 Vali Loss: 2.995 Vali Acc: 0.380 Test Loss: 2.995 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 66 | loss: 1.4919819
	speed: 0.1100s/iter; left time: 581.8090s
Epoch: 66 cost time: 4.244359970092773
Epoch: 66, Steps: 154 | Train Loss: 1.271 Vali Loss: 3.106 Vali Acc: 0.375 Test Loss: 3.106 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 67 | loss: 1.3296227
	speed: 0.1102s/iter; left time: 565.9879s
Epoch: 67 cost time: 4.015459299087524
Epoch: 67, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.992 Vali Acc: 0.374 Test Loss: 2.992 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 68 | loss: 0.7597966
	speed: 0.1025s/iter; left time: 510.9428s
Epoch: 68 cost time: 4.1714560985565186
Epoch: 68, Steps: 154 | Train Loss: 1.390 Vali Loss: 2.693 Vali Acc: 0.378 Test Loss: 2.693 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 69 | loss: 0.8611245
	speed: 0.1016s/iter; left time: 490.5867s
Epoch: 69 cost time: 4.114515781402588
Epoch: 69, Steps: 154 | Train Loss: 1.268 Vali Loss: 3.049 Vali Acc: 0.385 Test Loss: 3.049 Test Acc: 0.385
Validation loss decreased (-0.382373 --> -0.384803).  Saving model ...
	iters: 100, epoch: 70 | loss: 1.6454359
	speed: 0.1058s/iter; left time: 494.7023s
Epoch: 70 cost time: 4.178901195526123
Epoch: 70, Steps: 154 | Train Loss: 1.272 Vali Loss: 3.228 Vali Acc: 0.375 Test Loss: 3.228 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 71 | loss: 1.0548892
	speed: 0.1040s/iter; left time: 470.2083s
Epoch: 71 cost time: 4.238991022109985
Epoch: 71, Steps: 154 | Train Loss: 1.409 Vali Loss: 3.102 Vali Acc: 0.387 Test Loss: 3.102 Test Acc: 0.387
Validation loss decreased (-0.384803 --> -0.386830).  Saving model ...
	iters: 100, epoch: 72 | loss: 1.1481955
	speed: 0.1053s/iter; left time: 459.8212s
Epoch: 72 cost time: 4.109021902084351
Epoch: 72, Steps: 154 | Train Loss: 1.289 Vali Loss: 3.433 Vali Acc: 0.388 Test Loss: 3.433 Test Acc: 0.388
Validation loss decreased (-0.386830 --> -0.388449).  Saving model ...
	iters: 100, epoch: 73 | loss: 1.0581391
	speed: 0.1037s/iter; left time: 436.7773s
Epoch: 73 cost time: 4.110517263412476
Epoch: 73, Steps: 154 | Train Loss: 1.374 Vali Loss: 2.918 Vali Acc: 0.388 Test Loss: 2.918 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 74 | loss: 0.6624283
	speed: 0.1072s/iter; left time: 435.2479s
Epoch: 74 cost time: 4.25201416015625
Epoch: 74, Steps: 154 | Train Loss: 1.411 Vali Loss: 3.132 Vali Acc: 0.387 Test Loss: 3.132 Test Acc: 0.387
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 75 | loss: 3.3722548
	speed: 0.1092s/iter; left time: 426.3958s
Epoch: 75 cost time: 4.41427755355835
Epoch: 75, Steps: 154 | Train Loss: 1.329 Vali Loss: 3.490 Vali Acc: 0.383 Test Loss: 3.490 Test Acc: 0.383
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 76 | loss: 0.9524398
	speed: 0.1152s/iter; left time: 432.2276s
Epoch: 76 cost time: 4.337828159332275
Epoch: 76, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.113 Vali Acc: 0.295 Test Loss: 3.113 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 77 | loss: 1.7355243
	speed: 0.1075s/iter; left time: 386.5933s
Epoch: 77 cost time: 4.318578481674194
Epoch: 77, Steps: 154 | Train Loss: 1.360 Vali Loss: 3.068 Vali Acc: 0.382 Test Loss: 3.068 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 78 | loss: 0.7418776
	speed: 0.1096s/iter; left time: 377.3871s
Epoch: 78 cost time: 4.205704212188721
Epoch: 78, Steps: 154 | Train Loss: 1.200 Vali Loss: 3.317 Vali Acc: 0.382 Test Loss: 3.317 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 79 | loss: 0.9518611
	speed: 0.1102s/iter; left time: 362.3929s
Epoch: 79 cost time: 4.31818151473999
Epoch: 79, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.419 Vali Acc: 0.380 Test Loss: 3.419 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 80 | loss: 0.8606267
	speed: 0.1072s/iter; left time: 336.0653s
Epoch: 80 cost time: 4.42495059967041
Epoch: 80, Steps: 154 | Train Loss: 1.371 Vali Loss: 3.138 Vali Acc: 0.384 Test Loss: 3.138 Test Acc: 0.384
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 81 | loss: 1.3726218
	speed: 0.1053s/iter; left time: 314.0250s
Epoch: 81 cost time: 4.012908220291138
Epoch: 81, Steps: 154 | Train Loss: 1.280 Vali Loss: 3.186 Vali Acc: 0.380 Test Loss: 3.186 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 82 | loss: 0.7847490
	speed: 0.1036s/iter; left time: 293.0036s
Epoch: 82 cost time: 3.922701358795166
Epoch: 82, Steps: 154 | Train Loss: 1.232 Vali Loss: 3.144 Vali Acc: 0.377 Test Loss: 3.144 Test Acc: 0.377
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3884833738848337
model parameter : 85110
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9261680
	speed: 0.0428s/iter; left time: 655.2842s
Epoch: 1 cost time: 5.584628105163574
Epoch: 1, Steps: 154 | Train Loss: 2.297 Vali Loss: 2.148 Vali Acc: 0.316 Test Loss: 2.148 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8917288
	speed: 0.1031s/iter; left time: 1561.8531s
Epoch: 2 cost time: 3.791943311691284
Epoch: 2, Steps: 154 | Train Loss: 2.079 Vali Loss: 2.146 Vali Acc: 0.317 Test Loss: 2.146 Test Acc: 0.317
Validation loss decreased (-0.315875 --> -0.317091).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1183078
	speed: 0.1039s/iter; left time: 1558.2759s
Epoch: 3 cost time: 4.223619699478149
Epoch: 3, Steps: 154 | Train Loss: 2.036 Vali Loss: 2.144 Vali Acc: 0.318 Test Loss: 2.144 Test Acc: 0.318
Validation loss decreased (-0.317091 --> -0.317902).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7970873
	speed: 0.1099s/iter; left time: 1630.7729s
Epoch: 4 cost time: 4.207212209701538
Epoch: 4, Steps: 154 | Train Loss: 2.014 Vali Loss: 2.136 Vali Acc: 0.318 Test Loss: 2.136 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9130304
	speed: 0.1076s/iter; left time: 1579.3884s
Epoch: 5 cost time: 4.245259761810303
Epoch: 5, Steps: 154 | Train Loss: 1.980 Vali Loss: 2.153 Vali Acc: 0.320 Test Loss: 2.153 Test Acc: 0.320
Validation loss decreased (-0.317902 --> -0.319930).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3390322
	speed: 0.1061s/iter; left time: 1541.3179s
Epoch: 6 cost time: 4.3562541007995605
Epoch: 6, Steps: 154 | Train Loss: 1.956 Vali Loss: 2.138 Vali Acc: 0.322 Test Loss: 2.138 Test Acc: 0.322
Validation loss decreased (-0.319930 --> -0.321552).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6679561
	speed: 0.1092s/iter; left time: 1570.1744s
Epoch: 7 cost time: 4.207512617111206
Epoch: 7, Steps: 154 | Train Loss: 1.925 Vali Loss: 2.133 Vali Acc: 0.323 Test Loss: 2.133 Test Acc: 0.323
Validation loss decreased (-0.321552 --> -0.322769).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6459466
	speed: 0.1024s/iter; left time: 1456.0409s
Epoch: 8 cost time: 3.8947508335113525
Epoch: 8, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.150 Vali Acc: 0.322 Test Loss: 2.150 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4892148
	speed: 0.1041s/iter; left time: 1464.2845s
Epoch: 9 cost time: 4.1942644119262695
Epoch: 9, Steps: 154 | Train Loss: 1.870 Vali Loss: 2.146 Vali Acc: 0.324 Test Loss: 2.146 Test Acc: 0.324
Validation loss decreased (-0.322769 --> -0.323985).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5916892
	speed: 0.1123s/iter; left time: 1562.7855s
Epoch: 10 cost time: 4.499702215194702
Epoch: 10, Steps: 154 | Train Loss: 1.849 Vali Loss: 2.106 Vali Acc: 0.329 Test Loss: 2.106 Test Acc: 0.329
Validation loss decreased (-0.323985 --> -0.328852).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8024737
	speed: 0.1093s/iter; left time: 1504.5244s
Epoch: 11 cost time: 4.4521613121032715
Epoch: 11, Steps: 154 | Train Loss: 1.833 Vali Loss: 2.131 Vali Acc: 0.328 Test Loss: 2.131 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.0072403
	speed: 0.1100s/iter; left time: 1497.3593s
Epoch: 12 cost time: 4.532822608947754
Epoch: 12, Steps: 154 | Train Loss: 1.812 Vali Loss: 2.153 Vali Acc: 0.334 Test Loss: 2.153 Test Acc: 0.334
Validation loss decreased (-0.328852 --> -0.333717).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7962492
	speed: 0.1089s/iter; left time: 1464.8835s
Epoch: 13 cost time: 4.286664962768555
Epoch: 13, Steps: 154 | Train Loss: 1.787 Vali Loss: 2.154 Vali Acc: 0.332 Test Loss: 2.154 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.9941547
	speed: 0.1109s/iter; left time: 1475.2204s
Epoch: 14 cost time: 4.541017293930054
Epoch: 14, Steps: 154 | Train Loss: 1.779 Vali Loss: 2.120 Vali Acc: 0.336 Test Loss: 2.120 Test Acc: 0.336
Validation loss decreased (-0.333717 --> -0.335745).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.5917714
	speed: 0.1115s/iter; left time: 1465.6117s
Epoch: 15 cost time: 4.511833190917969
Epoch: 15, Steps: 154 | Train Loss: 1.763 Vali Loss: 2.150 Vali Acc: 0.339 Test Loss: 2.150 Test Acc: 0.339
Validation loss decreased (-0.335745 --> -0.339395).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.9488041
	speed: 0.1088s/iter; left time: 1412.8015s
Epoch: 16 cost time: 4.280323505401611
Epoch: 16, Steps: 154 | Train Loss: 1.706 Vali Loss: 2.199 Vali Acc: 0.341 Test Loss: 2.199 Test Acc: 0.341
Validation loss decreased (-0.339395 --> -0.341016).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.7240798
	speed: 0.1131s/iter; left time: 1452.1357s
Epoch: 17 cost time: 4.314660310745239
Epoch: 17, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.231 Vali Acc: 0.344 Test Loss: 2.231 Test Acc: 0.344
Validation loss decreased (-0.341016 --> -0.344260).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6554325
	speed: 0.1128s/iter; left time: 1430.7007s
Epoch: 18 cost time: 4.40610146522522
Epoch: 18, Steps: 154 | Train Loss: 1.676 Vali Loss: 2.260 Vali Acc: 0.342 Test Loss: 2.260 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.4525192
	speed: 0.1125s/iter; left time: 1410.0676s
Epoch: 19 cost time: 4.296568393707275
Epoch: 19, Steps: 154 | Train Loss: 1.644 Vali Loss: 2.312 Vali Acc: 0.348 Test Loss: 2.312 Test Acc: 0.348
Validation loss decreased (-0.344260 --> -0.347503).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.4825629
	speed: 0.1094s/iter; left time: 1353.9642s
Epoch: 20 cost time: 4.186152458190918
Epoch: 20, Steps: 154 | Train Loss: 1.751 Vali Loss: 2.283 Vali Acc: 0.353 Test Loss: 2.283 Test Acc: 0.353
Validation loss decreased (-0.347503 --> -0.352775).  Saving model ...
	iters: 100, epoch: 21 | loss: 8.3353577
	speed: 0.1132s/iter; left time: 1383.5707s
Epoch: 21 cost time: 4.3835062980651855
Epoch: 21, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.286 Vali Acc: 0.348 Test Loss: 2.286 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.3335704
	speed: 0.1086s/iter; left time: 1310.3755s
Epoch: 22 cost time: 4.198857307434082
Epoch: 22, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.317 Vali Acc: 0.352 Test Loss: 2.317 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.4240031
	speed: 0.1061s/iter; left time: 1264.1993s
Epoch: 23 cost time: 4.297983407974243
Epoch: 23, Steps: 154 | Train Loss: 1.636 Vali Loss: 2.283 Vali Acc: 0.350 Test Loss: 2.283 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 2.3954959
	speed: 0.1008s/iter; left time: 1184.7870s
Epoch: 24 cost time: 4.232848167419434
Epoch: 24, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.277 Vali Acc: 0.347 Test Loss: 2.277 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 1.6627573
	speed: 0.1083s/iter; left time: 1257.2955s
Epoch: 25 cost time: 4.283026933670044
Epoch: 25, Steps: 154 | Train Loss: 1.733 Vali Loss: 2.350 Vali Acc: 0.351 Test Loss: 2.350 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 1.0861409
	speed: 0.1078s/iter; left time: 1234.8502s
Epoch: 26 cost time: 4.334074020385742
Epoch: 26, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.275 Vali Acc: 0.355 Test Loss: 2.275 Test Acc: 0.355
Validation loss decreased (-0.352775 --> -0.354803).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.8481890
	speed: 0.1096s/iter; left time: 1238.1732s
Epoch: 27 cost time: 4.427377462387085
Epoch: 27, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.331 Vali Acc: 0.354 Test Loss: 2.331 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.5519073
	speed: 0.1121s/iter; left time: 1249.3348s
Epoch: 28 cost time: 4.299962282180786
Epoch: 28, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.353 Vali Acc: 0.361 Test Loss: 2.353 Test Acc: 0.361
Validation loss decreased (-0.354803 --> -0.361290).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.1178163
	speed: 0.1078s/iter; left time: 1184.2109s
Epoch: 29 cost time: 4.191373586654663
Epoch: 29, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.350 Vali Acc: 0.359 Test Loss: 2.350 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.6771522
	speed: 0.1123s/iter; left time: 1217.1164s
Epoch: 30 cost time: 4.48809027671814
Epoch: 30, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.453 Vali Acc: 0.355 Test Loss: 2.453 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.6629734
	speed: 0.1114s/iter; left time: 1190.2402s
Epoch: 31 cost time: 4.297595262527466
Epoch: 31, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.473 Vali Acc: 0.367 Test Loss: 2.473 Test Acc: 0.367
Validation loss decreased (-0.361290 --> -0.366966).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.4725587
	speed: 0.1087s/iter; left time: 1144.3221s
Epoch: 32 cost time: 4.302676677703857
Epoch: 32, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.355 Vali Acc: 0.365 Test Loss: 2.355 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 1.2161006
	speed: 0.1100s/iter; left time: 1140.7526s
Epoch: 33 cost time: 4.284554481506348
Epoch: 33, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.506 Vali Acc: 0.361 Test Loss: 2.506 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 1.0145849
	speed: 0.0980s/iter; left time: 1001.4749s
Epoch: 34 cost time: 3.8329989910125732
Epoch: 34, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.445 Vali Acc: 0.360 Test Loss: 2.445 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 1.0525434
	speed: 0.0993s/iter; left time: 999.9320s
Epoch: 35 cost time: 4.127867698669434
Epoch: 35, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.575 Vali Acc: 0.361 Test Loss: 2.575 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.9969071
	speed: 0.1018s/iter; left time: 1009.1086s
Epoch: 36 cost time: 3.9951322078704834
Epoch: 36, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.606 Vali Acc: 0.358 Test Loss: 2.606 Test Acc: 0.358
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.9654958
	speed: 0.1052s/iter; left time: 1026.2697s
Epoch: 37 cost time: 4.087786436080933
Epoch: 37, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.709 Vali Acc: 0.361 Test Loss: 2.709 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 1.2680870
	speed: 0.1055s/iter; left time: 1012.9280s
Epoch: 38 cost time: 4.2134950160980225
Epoch: 38, Steps: 154 | Train Loss: 1.420 Vali Loss: 2.520 Vali Acc: 0.364 Test Loss: 2.520 Test Acc: 0.364
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 1.1773038
	speed: 0.1082s/iter; left time: 1022.0721s
Epoch: 39 cost time: 4.052352428436279
Epoch: 39, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.563 Vali Acc: 0.364 Test Loss: 2.563 Test Acc: 0.364
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 1.0961399
	speed: 0.1067s/iter; left time: 992.2214s
Epoch: 40 cost time: 4.027668714523315
Epoch: 40, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.669 Vali Acc: 0.359 Test Loss: 2.669 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 1.5014056
	speed: 0.1062s/iter; left time: 971.0831s
Epoch: 41 cost time: 4.276386260986328
Epoch: 41, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.646 Vali Acc: 0.362 Test Loss: 2.646 Test Acc: 0.362
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36699107866991076
model parameter : 85110
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4602513
	speed: 0.0434s/iter; left time: 664.0639s
Epoch: 1 cost time: 5.79997706413269
Epoch: 1, Steps: 154 | Train Loss: 2.300 Vali Loss: 2.166 Vali Acc: 0.316 Test Loss: 2.166 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8484607
	speed: 0.1071s/iter; left time: 1622.5518s
Epoch: 2 cost time: 3.9792182445526123
Epoch: 2, Steps: 154 | Train Loss: 2.082 Vali Loss: 2.152 Vali Acc: 0.318 Test Loss: 2.152 Test Acc: 0.318
Validation loss decreased (-0.316280 --> -0.317497).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0941076
	speed: 0.1046s/iter; left time: 1567.6563s
Epoch: 3 cost time: 4.0126848220825195
Epoch: 3, Steps: 154 | Train Loss: 2.022 Vali Loss: 2.144 Vali Acc: 0.318 Test Loss: 2.144 Test Acc: 0.318
Validation loss decreased (-0.317497 --> -0.317497).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3615897
	speed: 0.1091s/iter; left time: 1618.5158s
Epoch: 4 cost time: 4.2950921058654785
Epoch: 4, Steps: 154 | Train Loss: 1.978 Vali Loss: 2.155 Vali Acc: 0.318 Test Loss: 2.155 Test Acc: 0.318
Validation loss decreased (-0.317497 --> -0.318308).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1531975
	speed: 0.1085s/iter; left time: 1592.5912s
Epoch: 5 cost time: 4.074197769165039
Epoch: 5, Steps: 154 | Train Loss: 1.951 Vali Loss: 2.152 Vali Acc: 0.321 Test Loss: 2.152 Test Acc: 0.321
Validation loss decreased (-0.318308 --> -0.321146).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7191966
	speed: 0.1074s/iter; left time: 1560.6513s
Epoch: 6 cost time: 4.346303701400757
Epoch: 6, Steps: 154 | Train Loss: 1.933 Vali Loss: 2.144 Vali Acc: 0.319 Test Loss: 2.144 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7044481
	speed: 0.1046s/iter; left time: 1504.2650s
Epoch: 7 cost time: 3.941779851913452
Epoch: 7, Steps: 154 | Train Loss: 1.904 Vali Loss: 2.131 Vali Acc: 0.322 Test Loss: 2.131 Test Acc: 0.322
Validation loss decreased (-0.321146 --> -0.321958).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9316162
	speed: 0.0991s/iter; left time: 1409.4173s
Epoch: 8 cost time: 3.9208428859710693
Epoch: 8, Steps: 154 | Train Loss: 1.882 Vali Loss: 2.154 Vali Acc: 0.321 Test Loss: 2.154 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0233951
	speed: 0.1006s/iter; left time: 1415.4219s
Epoch: 9 cost time: 4.105945587158203
Epoch: 9, Steps: 154 | Train Loss: 1.878 Vali Loss: 2.189 Vali Acc: 0.321 Test Loss: 2.189 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8089950
	speed: 0.1016s/iter; left time: 1414.1578s
Epoch: 10 cost time: 4.018518686294556
Epoch: 10, Steps: 154 | Train Loss: 1.843 Vali Loss: 2.171 Vali Acc: 0.323 Test Loss: 2.171 Test Acc: 0.323
Validation loss decreased (-0.321958 --> -0.323174).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7484200
	speed: 0.1009s/iter; left time: 1389.0514s
Epoch: 11 cost time: 3.974820137023926
Epoch: 11, Steps: 154 | Train Loss: 1.831 Vali Loss: 2.167 Vali Acc: 0.324 Test Loss: 2.167 Test Acc: 0.324
Validation loss decreased (-0.323174 --> -0.323985).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.2831111
	speed: 0.1012s/iter; left time: 1376.3620s
Epoch: 12 cost time: 4.109478712081909
Epoch: 12, Steps: 154 | Train Loss: 1.796 Vali Loss: 2.219 Vali Acc: 0.322 Test Loss: 2.219 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6629009
	speed: 0.1006s/iter; left time: 1353.6990s
Epoch: 13 cost time: 3.9544718265533447
Epoch: 13, Steps: 154 | Train Loss: 1.788 Vali Loss: 2.189 Vali Acc: 0.326 Test Loss: 2.189 Test Acc: 0.326
Validation loss decreased (-0.323985 --> -0.326418).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3073126
	speed: 0.1046s/iter; left time: 1391.7108s
Epoch: 14 cost time: 3.941157102584839
Epoch: 14, Steps: 154 | Train Loss: 1.757 Vali Loss: 2.183 Vali Acc: 0.330 Test Loss: 2.183 Test Acc: 0.330
Validation loss decreased (-0.326418 --> -0.330473).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4277480
	speed: 0.1042s/iter; left time: 1369.7364s
Epoch: 15 cost time: 3.9354915618896484
Epoch: 15, Steps: 154 | Train Loss: 1.746 Vali Loss: 2.187 Vali Acc: 0.333 Test Loss: 2.187 Test Acc: 0.333
Validation loss decreased (-0.330473 --> -0.332906).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4954765
	speed: 0.1069s/iter; left time: 1389.2546s
Epoch: 16 cost time: 3.999380350112915
Epoch: 16, Steps: 154 | Train Loss: 1.754 Vali Loss: 2.173 Vali Acc: 0.334 Test Loss: 2.173 Test Acc: 0.334
Validation loss decreased (-0.332906 --> -0.333717).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.5783485
	speed: 0.1084s/iter; left time: 1391.5463s
Epoch: 17 cost time: 4.012732028961182
Epoch: 17, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.227 Vali Acc: 0.332 Test Loss: 2.227 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.1652539
	speed: 0.1019s/iter; left time: 1291.8099s
Epoch: 18 cost time: 4.126795053482056
Epoch: 18, Steps: 154 | Train Loss: 1.693 Vali Loss: 2.199 Vali Acc: 0.334 Test Loss: 2.199 Test Acc: 0.334
Validation loss decreased (-0.333717 --> -0.334122).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.1571009
	speed: 0.1072s/iter; left time: 1343.6486s
Epoch: 19 cost time: 4.149357795715332
Epoch: 19, Steps: 154 | Train Loss: 1.681 Vali Loss: 2.190 Vali Acc: 0.335 Test Loss: 2.190 Test Acc: 0.335
Validation loss decreased (-0.334122 --> -0.334933).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.6059434
	speed: 0.1009s/iter; left time: 1248.2122s
Epoch: 20 cost time: 4.2118918895721436
Epoch: 20, Steps: 154 | Train Loss: 1.674 Vali Loss: 2.253 Vali Acc: 0.336 Test Loss: 2.253 Test Acc: 0.336
Validation loss decreased (-0.334933 --> -0.335744).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.5359994
	speed: 0.1042s/iter; left time: 1273.2690s
Epoch: 21 cost time: 4.099982023239136
Epoch: 21, Steps: 154 | Train Loss: 1.675 Vali Loss: 2.327 Vali Acc: 0.337 Test Loss: 2.327 Test Acc: 0.337
Validation loss decreased (-0.335744 --> -0.336554).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.6866891
	speed: 0.1031s/iter; left time: 1243.5708s
Epoch: 22 cost time: 4.116217374801636
Epoch: 22, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.330 Vali Acc: 0.336 Test Loss: 2.330 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.9799997
	speed: 0.1039s/iter; left time: 1237.5449s
Epoch: 23 cost time: 4.229924201965332
Epoch: 23, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.256 Vali Acc: 0.342 Test Loss: 2.256 Test Acc: 0.342
Validation loss decreased (-0.336554 --> -0.341827).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.6496162
	speed: 0.1035s/iter; left time: 1216.4708s
Epoch: 24 cost time: 4.186551094055176
Epoch: 24, Steps: 154 | Train Loss: 1.601 Vali Loss: 2.266 Vali Acc: 0.341 Test Loss: 2.266 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.7490246
	speed: 0.1027s/iter; left time: 1192.3418s
Epoch: 25 cost time: 3.9860854148864746
Epoch: 25, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.233 Vali Acc: 0.344 Test Loss: 2.233 Test Acc: 0.344
Validation loss decreased (-0.341827 --> -0.343854).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.4983338
	speed: 0.1037s/iter; left time: 1188.0014s
Epoch: 26 cost time: 4.166937589645386
Epoch: 26, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.253 Vali Acc: 0.346 Test Loss: 2.253 Test Acc: 0.346
Validation loss decreased (-0.343854 --> -0.346287).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.3363912
	speed: 0.1023s/iter; left time: 1155.9166s
Epoch: 27 cost time: 4.421305179595947
Epoch: 27, Steps: 154 | Train Loss: 1.609 Vali Loss: 2.280 Vali Acc: 0.345 Test Loss: 2.280 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.5357260
	speed: 0.1087s/iter; left time: 1211.2846s
Epoch: 28 cost time: 3.8322043418884277
Epoch: 28, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.322 Vali Acc: 0.342 Test Loss: 2.322 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.5038134
	speed: 0.0914s/iter; left time: 1004.3020s
Epoch: 29 cost time: 3.4860870838165283
Epoch: 29, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.344 Vali Acc: 0.355 Test Loss: 2.344 Test Acc: 0.355
Validation loss decreased (-0.346287 --> -0.355208).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.7449155
	speed: 0.0859s/iter; left time: 930.3082s
Epoch: 30 cost time: 3.7765555381774902
Epoch: 30, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.377 Vali Acc: 0.353 Test Loss: 2.377 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.5167229
	speed: 0.1027s/iter; left time: 1096.7953s
Epoch: 31 cost time: 4.047613620758057
Epoch: 31, Steps: 154 | Train Loss: 1.554 Vali Loss: 2.396 Vali Acc: 0.354 Test Loss: 2.396 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.1844413
	speed: 0.1017s/iter; left time: 1070.9139s
Epoch: 32 cost time: 3.852590560913086
Epoch: 32, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.506 Vali Acc: 0.348 Test Loss: 2.506 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 1.3765227
	speed: 0.0938s/iter; left time: 972.5828s
Epoch: 33 cost time: 3.648174285888672
Epoch: 33, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.356 Vali Acc: 0.357 Test Loss: 2.356 Test Acc: 0.357
Validation loss decreased (-0.355208 --> -0.356830).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.6801744
	speed: 0.1017s/iter; left time: 1038.9834s
Epoch: 34 cost time: 4.235966444015503
Epoch: 34, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.361 Vali Acc: 0.358 Test Loss: 2.361 Test Acc: 0.358
Validation loss decreased (-0.356830 --> -0.358452).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.5129200
	speed: 0.1027s/iter; left time: 1033.6271s
Epoch: 35 cost time: 4.030425071716309
Epoch: 35, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.379 Vali Acc: 0.361 Test Loss: 2.379 Test Acc: 0.361
Validation loss decreased (-0.358452 --> -0.360479).  Saving model ...
	iters: 100, epoch: 36 | loss: 1.5356100
	speed: 0.1045s/iter; left time: 1035.7661s
Epoch: 36 cost time: 4.1694324016571045
Epoch: 36, Steps: 154 | Train Loss: 1.448 Vali Loss: 2.326 Vali Acc: 0.361 Test Loss: 2.326 Test Acc: 0.361
Validation loss decreased (-0.360479 --> -0.360480).  Saving model ...
	iters: 100, epoch: 37 | loss: 1.9217461
	speed: 0.1085s/iter; left time: 1058.8066s
Epoch: 37 cost time: 4.294515371322632
Epoch: 37, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.404 Vali Acc: 0.368 Test Loss: 2.404 Test Acc: 0.368
Validation loss decreased (-0.360480 --> -0.368184).  Saving model ...
	iters: 100, epoch: 38 | loss: 1.2417240
	speed: 0.1070s/iter; left time: 1027.2501s
Epoch: 38 cost time: 4.067370891571045
Epoch: 38, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.418 Vali Acc: 0.368 Test Loss: 2.418 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 1.7686567
	speed: 0.1063s/iter; left time: 1004.8870s
Epoch: 39 cost time: 4.193828821182251
Epoch: 39, Steps: 154 | Train Loss: 1.511 Vali Loss: 2.576 Vali Acc: 0.369 Test Loss: 2.576 Test Acc: 0.369
Validation loss decreased (-0.368184 --> -0.368993).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.4704618
	speed: 0.1045s/iter; left time: 971.7196s
Epoch: 40 cost time: 4.523118495941162
Epoch: 40, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.463 Vali Acc: 0.358 Test Loss: 2.463 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 0.9440197
	speed: 0.1046s/iter; left time: 956.3742s
Epoch: 41 cost time: 4.097499132156372
Epoch: 41, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.490 Vali Acc: 0.364 Test Loss: 2.490 Test Acc: 0.364
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 1.5454717
	speed: 0.1071s/iter; left time: 962.7114s
Epoch: 42 cost time: 4.201905965805054
Epoch: 42, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.487 Vali Acc: 0.367 Test Loss: 2.487 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 1.3407819
	speed: 0.1030s/iter; left time: 910.1187s
Epoch: 43 cost time: 4.171432733535767
Epoch: 43, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.311 Vali Acc: 0.365 Test Loss: 2.311 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 1.2154119
	speed: 0.1038s/iter; left time: 900.6996s
Epoch: 44 cost time: 4.094569206237793
Epoch: 44, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.789 Vali Acc: 0.369 Test Loss: 2.789 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 1.5461134
	speed: 0.1045s/iter; left time: 890.7925s
Epoch: 45 cost time: 4.127499341964722
Epoch: 45, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.784 Vali Acc: 0.368 Test Loss: 2.784 Test Acc: 0.368
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 46 | loss: 0.9946519
	speed: 0.1081s/iter; left time: 904.8467s
Epoch: 46 cost time: 4.141355991363525
Epoch: 46, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.537 Vali Acc: 0.369 Test Loss: 2.537 Test Acc: 0.369
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 47 | loss: 1.1571599
	speed: 0.1077s/iter; left time: 884.9226s
Epoch: 47 cost time: 4.141030550003052
Epoch: 47, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.540 Vali Acc: 0.365 Test Loss: 2.540 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 48 | loss: 1.3669425
	speed: 0.1047s/iter; left time: 843.8019s
Epoch: 48 cost time: 4.1839210987091064
Epoch: 48, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.743 Vali Acc: 0.366 Test Loss: 2.743 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 49 | loss: 1.6781169
	speed: 0.1029s/iter; left time: 813.8005s
Epoch: 49 cost time: 4.032655715942383
Epoch: 49, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.717 Vali Acc: 0.372 Test Loss: 2.717 Test Acc: 0.372
Validation loss decreased (-0.368993 --> -0.372236).  Saving model ...
	iters: 100, epoch: 50 | loss: 1.3671424
	speed: 0.1014s/iter; left time: 786.1496s
Epoch: 50 cost time: 4.090965509414673
Epoch: 50, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.627 Vali Acc: 0.378 Test Loss: 2.627 Test Acc: 0.378
Validation loss decreased (-0.372236 --> -0.378319).  Saving model ...
	iters: 100, epoch: 51 | loss: 1.6654797
	speed: 0.1034s/iter; left time: 786.1285s
Epoch: 51 cost time: 4.149567127227783
Epoch: 51, Steps: 154 | Train Loss: 1.405 Vali Loss: 2.862 Vali Acc: 0.370 Test Loss: 2.862 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 52 | loss: 1.5364124
	speed: 0.1007s/iter; left time: 749.5917s
Epoch: 52 cost time: 4.016521215438843
Epoch: 52, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.769 Vali Acc: 0.381 Test Loss: 2.769 Test Acc: 0.381
Validation loss decreased (-0.378319 --> -0.380751).  Saving model ...
	iters: 100, epoch: 53 | loss: 1.4011492
	speed: 0.1009s/iter; left time: 735.5365s
Epoch: 53 cost time: 4.206199407577515
Epoch: 53, Steps: 154 | Train Loss: 1.427 Vali Loss: 2.657 Vali Acc: 0.372 Test Loss: 2.657 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 54 | loss: 1.7027552
	speed: 0.1043s/iter; left time: 744.3621s
Epoch: 54 cost time: 4.300654411315918
Epoch: 54, Steps: 154 | Train Loss: 1.410 Vali Loss: 2.715 Vali Acc: 0.378 Test Loss: 2.715 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 55 | loss: 1.2359110
	speed: 0.1032s/iter; left time: 720.5287s
Epoch: 55 cost time: 4.038615942001343
Epoch: 55, Steps: 154 | Train Loss: 1.324 Vali Loss: 2.650 Vali Acc: 0.367 Test Loss: 2.650 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 56 | loss: 0.9387184
	speed: 0.1036s/iter; left time: 707.5406s
Epoch: 56 cost time: 4.1516969203948975
Epoch: 56, Steps: 154 | Train Loss: 1.339 Vali Loss: 2.844 Vali Acc: 0.385 Test Loss: 2.844 Test Acc: 0.385
Validation loss decreased (-0.380751 --> -0.384805).  Saving model ...
	iters: 100, epoch: 57 | loss: 2.2387700
	speed: 0.1117s/iter; left time: 745.8535s
Epoch: 57 cost time: 4.218862533569336
Epoch: 57, Steps: 154 | Train Loss: 1.441 Vali Loss: 2.783 Vali Acc: 0.363 Test Loss: 2.783 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 58 | loss: 1.6209751
	speed: 0.1026s/iter; left time: 669.3599s
Epoch: 58 cost time: 3.9842851161956787
Epoch: 58, Steps: 154 | Train Loss: 1.360 Vali Loss: 2.749 Vali Acc: 0.376 Test Loss: 2.749 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 59 | loss: 0.8491792
	speed: 0.1075s/iter; left time: 684.7061s
Epoch: 59 cost time: 4.08609938621521
Epoch: 59, Steps: 154 | Train Loss: 1.354 Vali Loss: 2.704 Vali Acc: 0.375 Test Loss: 2.704 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 60 | loss: 1.8524811
	speed: 0.1056s/iter; left time: 656.4049s
Epoch: 60 cost time: 4.078219652175903
Epoch: 60, Steps: 154 | Train Loss: 1.396 Vali Loss: 2.850 Vali Acc: 0.377 Test Loss: 2.850 Test Acc: 0.377
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 61 | loss: 1.2165693
	speed: 0.0996s/iter; left time: 603.5524s
Epoch: 61 cost time: 3.795499086380005
Epoch: 61, Steps: 154 | Train Loss: 1.317 Vali Loss: 2.694 Vali Acc: 0.375 Test Loss: 2.694 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 62 | loss: 0.8574092
	speed: 0.0961s/iter; left time: 567.4062s
Epoch: 62 cost time: 3.900224447250366
Epoch: 62, Steps: 154 | Train Loss: 1.294 Vali Loss: 2.914 Vali Acc: 0.376 Test Loss: 2.914 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 63 | loss: 1.2967731
	speed: 0.0926s/iter; left time: 532.9695s
Epoch: 63 cost time: 3.8443186283111572
Epoch: 63, Steps: 154 | Train Loss: 1.421 Vali Loss: 2.881 Vali Acc: 0.381 Test Loss: 2.881 Test Acc: 0.381
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 64 | loss: 1.2523561
	speed: 0.1021s/iter; left time: 571.4955s
Epoch: 64 cost time: 3.9717612266540527
Epoch: 64, Steps: 154 | Train Loss: 1.393 Vali Loss: 3.006 Vali Acc: 0.377 Test Loss: 3.006 Test Acc: 0.377
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 65 | loss: 1.6765816
	speed: 0.1053s/iter; left time: 573.4369s
Epoch: 65 cost time: 4.103673696517944
Epoch: 65, Steps: 154 | Train Loss: 1.306 Vali Loss: 2.902 Vali Acc: 0.379 Test Loss: 2.902 Test Acc: 0.379
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 66 | loss: 1.1386400
	speed: 0.1036s/iter; left time: 548.3247s
Epoch: 66 cost time: 4.037693977355957
Epoch: 66, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.915 Vali Acc: 0.373 Test Loss: 2.915 Test Acc: 0.373
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3848337388483374
model parameter : 52342
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4630001
	speed: 0.0428s/iter; left time: 654.3810s
Epoch: 1 cost time: 5.641171216964722
Epoch: 1, Steps: 154 | Train Loss: 2.295 Vali Loss: 2.161 Vali Acc: 0.316 Test Loss: 2.161 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8659848
	speed: 0.1045s/iter; left time: 1582.9923s
Epoch: 2 cost time: 4.09975528717041
Epoch: 2, Steps: 154 | Train Loss: 2.082 Vali Loss: 2.149 Vali Acc: 0.317 Test Loss: 2.149 Test Acc: 0.317
Validation loss decreased (-0.315875 --> -0.317091).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0871603
	speed: 0.1027s/iter; left time: 1539.9366s
Epoch: 3 cost time: 4.2060160636901855
Epoch: 3, Steps: 154 | Train Loss: 2.022 Vali Loss: 2.146 Vali Acc: 0.318 Test Loss: 2.146 Test Acc: 0.318
Validation loss decreased (-0.317091 --> -0.317497).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3543727
	speed: 0.1077s/iter; left time: 1598.7737s
Epoch: 4 cost time: 4.267368793487549
Epoch: 4, Steps: 154 | Train Loss: 1.987 Vali Loss: 2.152 Vali Acc: 0.318 Test Loss: 2.152 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.1245673
	speed: 0.1067s/iter; left time: 1566.7713s
Epoch: 5 cost time: 4.235203742980957
Epoch: 5, Steps: 154 | Train Loss: 1.964 Vali Loss: 2.149 Vali Acc: 0.319 Test Loss: 2.149 Test Acc: 0.319
Validation loss decreased (-0.317497 --> -0.319119).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7509390
	speed: 0.1098s/iter; left time: 1595.0281s
Epoch: 6 cost time: 4.3786303997039795
Epoch: 6, Steps: 154 | Train Loss: 1.938 Vali Loss: 2.144 Vali Acc: 0.319 Test Loss: 2.144 Test Acc: 0.319
Validation loss decreased (-0.319119 --> -0.319119).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7124419
	speed: 0.1101s/iter; left time: 1583.1615s
Epoch: 7 cost time: 4.438665151596069
Epoch: 7, Steps: 154 | Train Loss: 1.919 Vali Loss: 2.138 Vali Acc: 0.320 Test Loss: 2.138 Test Acc: 0.320
Validation loss decreased (-0.319119 --> -0.319930).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9960120
	speed: 0.1040s/iter; left time: 1479.4786s
Epoch: 8 cost time: 4.283220052719116
Epoch: 8, Steps: 154 | Train Loss: 1.879 Vali Loss: 2.159 Vali Acc: 0.319 Test Loss: 2.159 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0096662
	speed: 0.1102s/iter; left time: 1550.2174s
Epoch: 9 cost time: 3.979215145111084
Epoch: 9, Steps: 154 | Train Loss: 1.878 Vali Loss: 2.178 Vali Acc: 0.320 Test Loss: 2.178 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8263161
	speed: 0.1032s/iter; left time: 1436.4252s
Epoch: 10 cost time: 4.36515474319458
Epoch: 10, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.156 Vali Acc: 0.324 Test Loss: 2.156 Test Acc: 0.324
Validation loss decreased (-0.319930 --> -0.324390).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7377701
	speed: 0.1096s/iter; left time: 1507.8105s
Epoch: 11 cost time: 4.126880645751953
Epoch: 11, Steps: 154 | Train Loss: 1.846 Vali Loss: 2.164 Vali Acc: 0.324 Test Loss: 2.164 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.3048167
	speed: 0.1065s/iter; left time: 1449.0870s
Epoch: 12 cost time: 4.1725568771362305
Epoch: 12, Steps: 154 | Train Loss: 1.807 Vali Loss: 2.223 Vali Acc: 0.321 Test Loss: 2.223 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.6200478
	speed: 0.1090s/iter; left time: 1466.9727s
Epoch: 13 cost time: 4.243819713592529
Epoch: 13, Steps: 154 | Train Loss: 1.786 Vali Loss: 2.176 Vali Acc: 0.325 Test Loss: 2.176 Test Acc: 0.325
Validation loss decreased (-0.324390 --> -0.324796).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3299286
	speed: 0.1065s/iter; left time: 1416.1216s
Epoch: 14 cost time: 4.148907661437988
Epoch: 14, Steps: 154 | Train Loss: 1.758 Vali Loss: 2.160 Vali Acc: 0.329 Test Loss: 2.160 Test Acc: 0.329
Validation loss decreased (-0.324796 --> -0.329257).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.5336609
	speed: 0.1092s/iter; left time: 1435.6339s
Epoch: 15 cost time: 4.315051078796387
Epoch: 15, Steps: 154 | Train Loss: 1.773 Vali Loss: 2.179 Vali Acc: 0.332 Test Loss: 2.179 Test Acc: 0.332
Validation loss decreased (-0.329257 --> -0.331689).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4729428
	speed: 0.1027s/iter; left time: 1334.7939s
Epoch: 16 cost time: 4.050793409347534
Epoch: 16, Steps: 154 | Train Loss: 1.756 Vali Loss: 2.171 Vali Acc: 0.333 Test Loss: 2.171 Test Acc: 0.333
Validation loss decreased (-0.331689 --> -0.333312).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.6070809
	speed: 0.1037s/iter; left time: 1331.0922s
Epoch: 17 cost time: 4.091479063034058
Epoch: 17, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.228 Vali Acc: 0.335 Test Loss: 2.228 Test Acc: 0.335
Validation loss decreased (-0.333312 --> -0.334528).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.1382108
	speed: 0.1043s/iter; left time: 1322.3134s
Epoch: 18 cost time: 4.143724203109741
Epoch: 18, Steps: 154 | Train Loss: 1.723 Vali Loss: 2.242 Vali Acc: 0.333 Test Loss: 2.242 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.2557471
	speed: 0.1072s/iter; left time: 1343.5861s
Epoch: 19 cost time: 4.1393396854400635
Epoch: 19, Steps: 154 | Train Loss: 1.701 Vali Loss: 2.237 Vali Acc: 0.333 Test Loss: 2.237 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.5878994
	speed: 0.1074s/iter; left time: 1329.3468s
Epoch: 20 cost time: 4.219784259796143
Epoch: 20, Steps: 154 | Train Loss: 1.687 Vali Loss: 2.205 Vali Acc: 0.336 Test Loss: 2.205 Test Acc: 0.336
Validation loss decreased (-0.334528 --> -0.336150).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.5181059
	speed: 0.1131s/iter; left time: 1381.6643s
Epoch: 21 cost time: 4.230795860290527
Epoch: 21, Steps: 154 | Train Loss: 1.688 Vali Loss: 2.270 Vali Acc: 0.342 Test Loss: 2.270 Test Acc: 0.342
Validation loss decreased (-0.336150 --> -0.342232).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.7129487
	speed: 0.1082s/iter; left time: 1305.1068s
Epoch: 22 cost time: 4.22338080406189
Epoch: 22, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.281 Vali Acc: 0.335 Test Loss: 2.281 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.7992119
	speed: 0.1093s/iter; left time: 1301.9066s
Epoch: 23 cost time: 4.369843244552612
Epoch: 23, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.228 Vali Acc: 0.344 Test Loss: 2.228 Test Acc: 0.344
Validation loss decreased (-0.342232 --> -0.343854).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.6209035
	speed: 0.1087s/iter; left time: 1278.2998s
Epoch: 24 cost time: 4.304556369781494
Epoch: 24, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.273 Vali Acc: 0.339 Test Loss: 2.273 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.6060299
	speed: 0.1087s/iter; left time: 1261.3051s
Epoch: 25 cost time: 4.265272378921509
Epoch: 25, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.288 Vali Acc: 0.344 Test Loss: 2.288 Test Acc: 0.344
Validation loss decreased (-0.343854 --> -0.344259).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.5570357
	speed: 0.1063s/iter; left time: 1217.3589s
Epoch: 26 cost time: 4.085338115692139
Epoch: 26, Steps: 154 | Train Loss: 1.595 Vali Loss: 2.311 Vali Acc: 0.345 Test Loss: 2.311 Test Acc: 0.345
Validation loss decreased (-0.344259 --> -0.345476).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.3352664
	speed: 0.1095s/iter; left time: 1236.9911s
Epoch: 27 cost time: 4.217733383178711
Epoch: 27, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.345 Vali Acc: 0.345 Test Loss: 2.345 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.4433268
	speed: 0.1088s/iter; left time: 1212.3042s
Epoch: 28 cost time: 3.852531671524048
Epoch: 28, Steps: 154 | Train Loss: 1.561 Vali Loss: 2.345 Vali Acc: 0.347 Test Loss: 2.345 Test Acc: 0.347
Validation loss decreased (-0.345476 --> -0.346692).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.4681665
	speed: 0.1076s/iter; left time: 1182.7531s
Epoch: 29 cost time: 4.227230787277222
Epoch: 29, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.454 Vali Acc: 0.356 Test Loss: 2.454 Test Acc: 0.356
Validation loss decreased (-0.346692 --> -0.356423).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.7740327
	speed: 0.1094s/iter; left time: 1184.8817s
Epoch: 30 cost time: 3.985220432281494
Epoch: 30, Steps: 154 | Train Loss: 1.561 Vali Loss: 2.501 Vali Acc: 0.358 Test Loss: 2.501 Test Acc: 0.358
Validation loss decreased (-0.356423 --> -0.358045).  Saving model ...
	iters: 100, epoch: 31 | loss: 1.5454892
	speed: 0.1043s/iter; left time: 1113.6059s
Epoch: 31 cost time: 3.958400011062622
Epoch: 31, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.346 Vali Acc: 0.354 Test Loss: 2.346 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 1.2160411
	speed: 0.0988s/iter; left time: 1040.2895s
Epoch: 32 cost time: 3.9581103324890137
Epoch: 32, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.448 Vali Acc: 0.354 Test Loss: 2.448 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 1.4574276
	speed: 0.1041s/iter; left time: 1079.5780s
Epoch: 33 cost time: 4.204072713851929
Epoch: 33, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.414 Vali Acc: 0.353 Test Loss: 2.414 Test Acc: 0.353
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 1.4646405
	speed: 0.1046s/iter; left time: 1068.6570s
Epoch: 34 cost time: 4.187582492828369
Epoch: 34, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.358 Vali Acc: 0.359 Test Loss: 2.358 Test Acc: 0.359
Validation loss decreased (-0.358045 --> -0.359263).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.3922094
	speed: 0.1049s/iter; left time: 1056.2734s
Epoch: 35 cost time: 4.10252046585083
Epoch: 35, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.534 Vali Acc: 0.354 Test Loss: 2.534 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 1.6119019
	speed: 0.1048s/iter; left time: 1038.9772s
Epoch: 36 cost time: 4.16604471206665
Epoch: 36, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.437 Vali Acc: 0.356 Test Loss: 2.437 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 1.7368476
	speed: 0.1027s/iter; left time: 1002.0722s
Epoch: 37 cost time: 3.985949754714966
Epoch: 37, Steps: 154 | Train Loss: 1.473 Vali Loss: 2.445 Vali Acc: 0.283 Test Loss: 2.445 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 1.4082153
	speed: 0.1059s/iter; left time: 1016.5497s
Epoch: 38 cost time: 4.211682558059692
Epoch: 38, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.375 Vali Acc: 0.373 Test Loss: 2.375 Test Acc: 0.373
Validation loss decreased (-0.359263 --> -0.373456).  Saving model ...
	iters: 100, epoch: 39 | loss: 1.6409329
	speed: 0.1091s/iter; left time: 1030.5069s
Epoch: 39 cost time: 4.204285621643066
Epoch: 39, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.570 Vali Acc: 0.370 Test Loss: 2.570 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 1.4104403
	speed: 0.1082s/iter; left time: 1006.0737s
Epoch: 40 cost time: 4.228373765945435
Epoch: 40, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.495 Vali Acc: 0.359 Test Loss: 2.495 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 1.1835552
	speed: 0.1083s/iter; left time: 989.9219s
Epoch: 41 cost time: 4.246406316757202
Epoch: 41, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.451 Vali Acc: 0.374 Test Loss: 2.451 Test Acc: 0.374
Validation loss decreased (-0.373456 --> -0.374266).  Saving model ...
	iters: 100, epoch: 42 | loss: 1.6329117
	speed: 0.1097s/iter; left time: 985.7799s
Epoch: 42 cost time: 4.27610969543457
Epoch: 42, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.691 Vali Acc: 0.367 Test Loss: 2.691 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 1.3518522
	speed: 0.1048s/iter; left time: 925.5930s
Epoch: 43 cost time: 4.210043668746948
Epoch: 43, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.438 Vali Acc: 0.360 Test Loss: 2.438 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 44 | loss: 1.2958701
	speed: 0.1074s/iter; left time: 932.5410s
Epoch: 44 cost time: 4.30161452293396
Epoch: 44, Steps: 154 | Train Loss: 1.533 Vali Loss: 2.599 Vali Acc: 0.366 Test Loss: 2.599 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 45 | loss: 1.6472224
	speed: 0.1069s/iter; left time: 911.6869s
Epoch: 45 cost time: 4.1738197803497314
Epoch: 45, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.484 Vali Acc: 0.368 Test Loss: 2.484 Test Acc: 0.368
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 46 | loss: 0.9142907
	speed: 0.1092s/iter; left time: 914.3322s
Epoch: 46 cost time: 4.234196424484253
Epoch: 46, Steps: 154 | Train Loss: 1.397 Vali Loss: 2.727 Vali Acc: 0.365 Test Loss: 2.727 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 47 | loss: 1.2151750
	speed: 0.1075s/iter; left time: 883.1326s
Epoch: 47 cost time: 3.9237027168273926
Epoch: 47, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.535 Vali Acc: 0.369 Test Loss: 2.535 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 48 | loss: 1.3282068
	speed: 0.1120s/iter; left time: 903.1821s
Epoch: 48 cost time: 4.334792613983154
Epoch: 48, Steps: 154 | Train Loss: 1.442 Vali Loss: 2.722 Vali Acc: 0.364 Test Loss: 2.722 Test Acc: 0.364
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 49 | loss: 1.6278616
	speed: 0.1106s/iter; left time: 874.7592s
Epoch: 49 cost time: 4.229739427566528
Epoch: 49, Steps: 154 | Train Loss: 1.481 Vali Loss: 2.703 Vali Acc: 0.374 Test Loss: 2.703 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 50 | loss: 1.4158845
	speed: 0.1082s/iter; left time: 838.9003s
Epoch: 50 cost time: 4.203321933746338
Epoch: 50, Steps: 154 | Train Loss: 1.383 Vali Loss: 2.707 Vali Acc: 0.379 Test Loss: 2.707 Test Acc: 0.379
Validation loss decreased (-0.374266 --> -0.379129).  Saving model ...
	iters: 100, epoch: 51 | loss: 1.5691273
	speed: 0.1042s/iter; left time: 791.9140s
Epoch: 51 cost time: 4.090152025222778
Epoch: 51, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.668 Vali Acc: 0.373 Test Loss: 2.668 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 52 | loss: 1.5672839
	speed: 0.1041s/iter; left time: 774.9864s
Epoch: 52 cost time: 4.173133134841919
Epoch: 52, Steps: 154 | Train Loss: 1.330 Vali Loss: 2.719 Vali Acc: 0.384 Test Loss: 2.719 Test Acc: 0.384
Validation loss decreased (-0.379129 --> -0.384401).  Saving model ...
	iters: 100, epoch: 53 | loss: 1.3986135
	speed: 0.1045s/iter; left time: 762.0459s
Epoch: 53 cost time: 4.093906879425049
Epoch: 53, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.685 Vali Acc: 0.373 Test Loss: 2.685 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 54 | loss: 1.7196410
	speed: 0.1033s/iter; left time: 737.2453s
Epoch: 54 cost time: 4.159883737564087
Epoch: 54, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.611 Vali Acc: 0.379 Test Loss: 2.611 Test Acc: 0.379
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 55 | loss: 1.2611239
	speed: 0.1005s/iter; left time: 702.1571s
Epoch: 55 cost time: 4.106229066848755
Epoch: 55, Steps: 154 | Train Loss: 1.317 Vali Loss: 3.002 Vali Acc: 0.368 Test Loss: 3.002 Test Acc: 0.368
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 56 | loss: 1.0711950
	speed: 0.1065s/iter; left time: 727.2392s
Epoch: 56 cost time: 4.243961572647095
Epoch: 56, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.951 Vali Acc: 0.385 Test Loss: 2.951 Test Acc: 0.385
Validation loss decreased (-0.384401 --> -0.385210).  Saving model ...
	iters: 100, epoch: 57 | loss: 3.5129294
	speed: 0.1094s/iter; left time: 730.5355s
Epoch: 57 cost time: 4.274895191192627
Epoch: 57, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.747 Vali Acc: 0.367 Test Loss: 2.747 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 58 | loss: 1.6250664
	speed: 0.1147s/iter; left time: 748.1701s
Epoch: 58 cost time: 4.2548370361328125
Epoch: 58, Steps: 154 | Train Loss: 1.397 Vali Loss: 2.609 Vali Acc: 0.377 Test Loss: 2.609 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 59 | loss: 0.8082427
	speed: 0.1109s/iter; left time: 706.6244s
Epoch: 59 cost time: 4.42446494102478
Epoch: 59, Steps: 154 | Train Loss: 1.356 Vali Loss: 2.712 Vali Acc: 0.372 Test Loss: 2.712 Test Acc: 0.372
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 60 | loss: 1.7859614
	speed: 0.1083s/iter; left time: 673.0482s
Epoch: 60 cost time: 4.237757682800293
Epoch: 60, Steps: 154 | Train Loss: 1.355 Vali Loss: 2.877 Vali Acc: 0.373 Test Loss: 2.877 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 61 | loss: 1.1735221
	speed: 0.1055s/iter; left time: 639.5255s
Epoch: 61 cost time: 4.136947154998779
Epoch: 61, Steps: 154 | Train Loss: 1.374 Vali Loss: 2.658 Vali Acc: 0.374 Test Loss: 2.658 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 62 | loss: 0.8702890
	speed: 0.1094s/iter; left time: 646.0058s
Epoch: 62 cost time: 4.525899887084961
Epoch: 62, Steps: 154 | Train Loss: 1.458 Vali Loss: 2.944 Vali Acc: 0.378 Test Loss: 2.944 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 63 | loss: 1.3589637
	speed: 0.1067s/iter; left time: 614.0162s
Epoch: 63 cost time: 4.2157957553863525
Epoch: 63, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.918 Vali Acc: 0.376 Test Loss: 2.918 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 64 | loss: 1.2352818
	speed: 0.1044s/iter; left time: 584.4371s
Epoch: 64 cost time: 4.024311065673828
Epoch: 64, Steps: 154 | Train Loss: 1.288 Vali Loss: 3.103 Vali Acc: 0.374 Test Loss: 3.103 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 65 | loss: 1.5196121
	speed: 0.1115s/iter; left time: 607.2119s
Epoch: 65 cost time: 4.385742902755737
Epoch: 65, Steps: 154 | Train Loss: 1.319 Vali Loss: 2.889 Vali Acc: 0.381 Test Loss: 2.889 Test Acc: 0.381
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 66 | loss: 1.1814219
	speed: 0.1080s/iter; left time: 571.1880s
Epoch: 66 cost time: 3.9027912616729736
Epoch: 66, Steps: 154 | Train Loss: 1.344 Vali Loss: 2.779 Vali Acc: 0.369 Test Loss: 2.779 Test Acc: 0.369
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38523925385239255
model parameter : 52342
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4664032
	speed: 0.0425s/iter; left time: 650.1707s
Epoch: 1 cost time: 5.628177881240845
Epoch: 1, Steps: 154 | Train Loss: 2.286 Vali Loss: 2.163 Vali Acc: 0.316 Test Loss: 2.163 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9043167
	speed: 0.1048s/iter; left time: 1587.3813s
Epoch: 2 cost time: 4.141161203384399
Epoch: 2, Steps: 154 | Train Loss: 2.075 Vali Loss: 2.149 Vali Acc: 0.317 Test Loss: 2.149 Test Acc: 0.317
Validation loss decreased (-0.315875 --> -0.316686).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0837793
	speed: 0.0991s/iter; left time: 1485.9815s
Epoch: 3 cost time: 3.9674108028411865
Epoch: 3, Steps: 154 | Train Loss: 2.022 Vali Loss: 2.156 Vali Acc: 0.316 Test Loss: 2.156 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3752129
	speed: 0.1065s/iter; left time: 1580.3578s
Epoch: 4 cost time: 4.340156555175781
Epoch: 4, Steps: 154 | Train Loss: 1.987 Vali Loss: 2.159 Vali Acc: 0.317 Test Loss: 2.159 Test Acc: 0.317
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.1698782
	speed: 0.1074s/iter; left time: 1576.8098s
Epoch: 5 cost time: 4.338080406188965
Epoch: 5, Steps: 154 | Train Loss: 1.970 Vali Loss: 2.143 Vali Acc: 0.318 Test Loss: 2.143 Test Acc: 0.318
Validation loss decreased (-0.316686 --> -0.318308).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7893147
	speed: 0.1043s/iter; left time: 1516.3018s
Epoch: 6 cost time: 4.036197900772095
Epoch: 6, Steps: 154 | Train Loss: 1.948 Vali Loss: 2.133 Vali Acc: 0.318 Test Loss: 2.133 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7161316
	speed: 0.1105s/iter; left time: 1588.4900s
Epoch: 7 cost time: 4.299854040145874
Epoch: 7, Steps: 154 | Train Loss: 1.904 Vali Loss: 2.120 Vali Acc: 0.322 Test Loss: 2.120 Test Acc: 0.322
Validation loss decreased (-0.318308 --> -0.321552).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0668335
	speed: 0.1124s/iter; left time: 1599.0936s
Epoch: 8 cost time: 4.390780925750732
Epoch: 8, Steps: 154 | Train Loss: 1.886 Vali Loss: 2.144 Vali Acc: 0.320 Test Loss: 2.144 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0270901
	speed: 0.1156s/iter; left time: 1626.6955s
Epoch: 9 cost time: 4.496075868606567
Epoch: 9, Steps: 154 | Train Loss: 1.882 Vali Loss: 2.167 Vali Acc: 0.320 Test Loss: 2.167 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8172574
	speed: 0.1176s/iter; left time: 1635.9283s
Epoch: 10 cost time: 4.351163148880005
Epoch: 10, Steps: 154 | Train Loss: 1.846 Vali Loss: 2.129 Vali Acc: 0.324 Test Loss: 2.129 Test Acc: 0.324
Validation loss decreased (-0.321552 --> -0.323985).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7041579
	speed: 0.1014s/iter; left time: 1395.7937s
Epoch: 11 cost time: 4.215138912200928
Epoch: 11, Steps: 154 | Train Loss: 1.829 Vali Loss: 2.144 Vali Acc: 0.325 Test Loss: 2.144 Test Acc: 0.325
Validation loss decreased (-0.323985 --> -0.325202).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.3146551
	speed: 0.1101s/iter; left time: 1498.0180s
Epoch: 12 cost time: 4.644076824188232
Epoch: 12, Steps: 154 | Train Loss: 1.787 Vali Loss: 2.192 Vali Acc: 0.325 Test Loss: 2.192 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5915289
	speed: 0.1120s/iter; left time: 1506.0641s
Epoch: 13 cost time: 4.446088075637817
Epoch: 13, Steps: 154 | Train Loss: 1.809 Vali Loss: 2.171 Vali Acc: 0.327 Test Loss: 2.171 Test Acc: 0.327
Validation loss decreased (-0.325202 --> -0.327229).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2417487
	speed: 0.1075s/iter; left time: 1429.8443s
Epoch: 14 cost time: 4.455702066421509
Epoch: 14, Steps: 154 | Train Loss: 1.774 Vali Loss: 2.149 Vali Acc: 0.334 Test Loss: 2.149 Test Acc: 0.334
Validation loss decreased (-0.327229 --> -0.334123).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.5608723
	speed: 0.1098s/iter; left time: 1442.9505s
Epoch: 15 cost time: 4.202736854553223
Epoch: 15, Steps: 154 | Train Loss: 1.755 Vali Loss: 2.177 Vali Acc: 0.333 Test Loss: 2.177 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.6849746
	speed: 0.1119s/iter; left time: 1453.7019s
Epoch: 16 cost time: 4.195613384246826
Epoch: 16, Steps: 154 | Train Loss: 1.750 Vali Loss: 2.172 Vali Acc: 0.337 Test Loss: 2.172 Test Acc: 0.337
Validation loss decreased (-0.334123 --> -0.336556).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.6778440
	speed: 0.1104s/iter; left time: 1417.1655s
Epoch: 17 cost time: 4.355611801147461
Epoch: 17, Steps: 154 | Train Loss: 1.703 Vali Loss: 2.170 Vali Acc: 0.337 Test Loss: 2.170 Test Acc: 0.337
Validation loss decreased (-0.336556 --> -0.337367).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.0796015
	speed: 0.1115s/iter; left time: 1413.9911s
Epoch: 18 cost time: 4.2711427211761475
Epoch: 18, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.193 Vali Acc: 0.337 Test Loss: 2.193 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.2874914
	speed: 0.1094s/iter; left time: 1371.1208s
Epoch: 19 cost time: 4.2326624393463135
Epoch: 19, Steps: 154 | Train Loss: 1.706 Vali Loss: 2.222 Vali Acc: 0.339 Test Loss: 2.222 Test Acc: 0.339
Validation loss decreased (-0.337367 --> -0.338583).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.6834345
	speed: 0.1067s/iter; left time: 1320.2352s
Epoch: 20 cost time: 4.269632816314697
Epoch: 20, Steps: 154 | Train Loss: 1.725 Vali Loss: 2.229 Vali Acc: 0.341 Test Loss: 2.229 Test Acc: 0.341
Validation loss decreased (-0.338583 --> -0.341016).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.4960915
	speed: 0.1071s/iter; left time: 1308.7557s
Epoch: 21 cost time: 4.1945250034332275
Epoch: 21, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.261 Vali Acc: 0.347 Test Loss: 2.261 Test Acc: 0.347
Validation loss decreased (-0.341016 --> -0.347098).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.6270715
	speed: 0.1043s/iter; left time: 1259.0836s
Epoch: 22 cost time: 4.18488335609436
Epoch: 22, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.323 Vali Acc: 0.341 Test Loss: 2.323 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.5964681
	speed: 0.1060s/iter; left time: 1263.0120s
Epoch: 23 cost time: 4.251889944076538
Epoch: 23, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.254 Vali Acc: 0.352 Test Loss: 2.254 Test Acc: 0.352
Validation loss decreased (-0.347098 --> -0.351559).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.6503696
	speed: 0.1051s/iter; left time: 1235.9139s
Epoch: 24 cost time: 4.140707969665527
Epoch: 24, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.322 Vali Acc: 0.348 Test Loss: 2.322 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.5383753
	speed: 0.1055s/iter; left time: 1224.1386s
Epoch: 25 cost time: 4.269540786743164
Epoch: 25, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.308 Vali Acc: 0.348 Test Loss: 2.308 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.5117964
	speed: 0.1117s/iter; left time: 1279.1040s
Epoch: 26 cost time: 4.437265396118164
Epoch: 26, Steps: 154 | Train Loss: 1.610 Vali Loss: 2.286 Vali Acc: 0.353 Test Loss: 2.286 Test Acc: 0.353
Validation loss decreased (-0.351559 --> -0.352775).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.3976763
	speed: 0.1121s/iter; left time: 1266.4991s
Epoch: 27 cost time: 4.453794240951538
Epoch: 27, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.394 Vali Acc: 0.348 Test Loss: 2.394 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.2822645
	speed: 0.1151s/iter; left time: 1282.9153s
Epoch: 28 cost time: 4.445822477340698
Epoch: 28, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.343 Vali Acc: 0.352 Test Loss: 2.343 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.3653682
	speed: 0.1118s/iter; left time: 1228.6090s
Epoch: 29 cost time: 4.609173059463501
Epoch: 29, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.457 Vali Acc: 0.357 Test Loss: 2.457 Test Acc: 0.357
Validation loss decreased (-0.352775 --> -0.357234).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.7596611
	speed: 0.1089s/iter; left time: 1180.0885s
Epoch: 30 cost time: 4.29919695854187
Epoch: 30, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.405 Vali Acc: 0.355 Test Loss: 2.405 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.9480106
	speed: 0.1044s/iter; left time: 1114.9036s
Epoch: 31 cost time: 4.321140766143799
Epoch: 31, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.395 Vali Acc: 0.355 Test Loss: 2.395 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.1796384
	speed: 0.1106s/iter; left time: 1164.4746s
Epoch: 32 cost time: 4.488821029663086
Epoch: 32, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.511 Vali Acc: 0.356 Test Loss: 2.511 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 1.4604834
	speed: 0.1071s/iter; left time: 1111.0709s
Epoch: 33 cost time: 4.169537544250488
Epoch: 33, Steps: 154 | Train Loss: 1.614 Vali Loss: 2.360 Vali Acc: 0.357 Test Loss: 2.360 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 1.7119159
	speed: 0.1060s/iter; left time: 1083.6467s
Epoch: 34 cost time: 4.189361572265625
Epoch: 34, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.480 Vali Acc: 0.360 Test Loss: 2.480 Test Acc: 0.360
Validation loss decreased (-0.357234 --> -0.359667).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.3914927
	speed: 0.1120s/iter; left time: 1127.6748s
Epoch: 35 cost time: 4.399936676025391
Epoch: 35, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.482 Vali Acc: 0.366 Test Loss: 2.482 Test Acc: 0.366
Validation loss decreased (-0.359667 --> -0.365750).  Saving model ...
	iters: 100, epoch: 36 | loss: 1.6257970
	speed: 0.1096s/iter; left time: 1086.1872s
Epoch: 36 cost time: 4.098674058914185
Epoch: 36, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.434 Vali Acc: 0.366 Test Loss: 2.434 Test Acc: 0.366
Validation loss decreased (-0.365750 --> -0.366156).  Saving model ...
	iters: 100, epoch: 37 | loss: 1.6294910
	speed: 0.1126s/iter; left time: 1098.3664s
Epoch: 37 cost time: 4.255665063858032
Epoch: 37, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.475 Vali Acc: 0.211 Test Loss: 2.475 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 1.5652826
	speed: 0.1065s/iter; left time: 1022.4769s
Epoch: 38 cost time: 4.0349485874176025
Epoch: 38, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.414 Vali Acc: 0.337 Test Loss: 2.414 Test Acc: 0.337
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 1.2794602
	speed: 0.1032s/iter; left time: 975.5832s
Epoch: 39 cost time: 4.065188884735107
Epoch: 39, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.539 Vali Acc: 0.370 Test Loss: 2.539 Test Acc: 0.370
Validation loss decreased (-0.366156 --> -0.369804).  Saving model ...
	iters: 100, epoch: 40 | loss: 2.2216642
	speed: 0.1041s/iter; left time: 967.6042s
Epoch: 40 cost time: 4.210021257400513
Epoch: 40, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.507 Vali Acc: 0.362 Test Loss: 2.507 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 2.7822676
	speed: 0.1034s/iter; left time: 945.3817s
Epoch: 41 cost time: 4.12142014503479
Epoch: 41, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.547 Vali Acc: 0.365 Test Loss: 2.547 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 2.1755474
	speed: 0.1049s/iter; left time: 942.6955s
Epoch: 42 cost time: 4.060889005661011
Epoch: 42, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.565 Vali Acc: 0.366 Test Loss: 2.565 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 1.4252170
	speed: 0.1093s/iter; left time: 965.8714s
Epoch: 43 cost time: 4.3763041496276855
Epoch: 43, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.525 Vali Acc: 0.357 Test Loss: 2.525 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 1.4460083
	speed: 0.1131s/iter; left time: 981.7397s
Epoch: 44 cost time: 4.3889501094818115
Epoch: 44, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.542 Vali Acc: 0.366 Test Loss: 2.542 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 1.9767077
	speed: 0.1141s/iter; left time: 972.3714s
Epoch: 45 cost time: 4.429016351699829
Epoch: 45, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.778 Vali Acc: 0.369 Test Loss: 2.778 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 46 | loss: 1.0069000
	speed: 0.1112s/iter; left time: 930.7097s
Epoch: 46 cost time: 4.594055414199829
Epoch: 46, Steps: 154 | Train Loss: 1.405 Vali Loss: 2.599 Vali Acc: 0.366 Test Loss: 2.599 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 47 | loss: 1.5332227
	speed: 0.1114s/iter; left time: 915.1461s
Epoch: 47 cost time: 4.1301093101501465
Epoch: 47, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.708 Vali Acc: 0.374 Test Loss: 2.708 Test Acc: 0.374
Validation loss decreased (-0.369804 --> -0.374263).  Saving model ...
	iters: 100, epoch: 48 | loss: 1.3666885
	speed: 0.1054s/iter; left time: 850.0795s
Epoch: 48 cost time: 4.311871767044067
Epoch: 48, Steps: 154 | Train Loss: 1.417 Vali Loss: 2.724 Vali Acc: 0.372 Test Loss: 2.724 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 49 | loss: 1.5700570
	speed: 0.1077s/iter; left time: 851.5981s
Epoch: 49 cost time: 4.474142551422119
Epoch: 49, Steps: 154 | Train Loss: 1.372 Vali Loss: 2.722 Vali Acc: 0.367 Test Loss: 2.722 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 50 | loss: 1.2902637
	speed: 0.1069s/iter; left time: 829.0527s
Epoch: 50 cost time: 4.221756219863892
Epoch: 50, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.631 Vali Acc: 0.368 Test Loss: 2.631 Test Acc: 0.368
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 51 | loss: 1.5513470
	speed: 0.1083s/iter; left time: 823.1924s
Epoch: 51 cost time: 4.25349760055542
Epoch: 51, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.632 Vali Acc: 0.369 Test Loss: 2.632 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 52 | loss: 1.6882970
	speed: 0.1100s/iter; left time: 819.1261s
Epoch: 52 cost time: 4.2814857959747314
Epoch: 52, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.856 Vali Acc: 0.381 Test Loss: 2.856 Test Acc: 0.381
Validation loss decreased (-0.374263 --> -0.380750).  Saving model ...
	iters: 100, epoch: 53 | loss: 1.2676710
	speed: 0.1081s/iter; left time: 788.7186s
Epoch: 53 cost time: 4.1770360469818115
Epoch: 53, Steps: 154 | Train Loss: 1.288 Vali Loss: 2.938 Vali Acc: 0.362 Test Loss: 2.938 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 54 | loss: 1.6084297
	speed: 0.1126s/iter; left time: 803.7386s
Epoch: 54 cost time: 4.318462610244751
Epoch: 54, Steps: 154 | Train Loss: 1.363 Vali Loss: 2.766 Vali Acc: 0.375 Test Loss: 2.766 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 55 | loss: 1.1720833
	speed: 0.1050s/iter; left time: 733.6319s
Epoch: 55 cost time: 4.1136908531188965
Epoch: 55, Steps: 154 | Train Loss: 1.315 Vali Loss: 3.090 Vali Acc: 0.367 Test Loss: 3.090 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 56 | loss: 1.6172266
	speed: 0.1073s/iter; left time: 733.1818s
Epoch: 56 cost time: 4.103576898574829
Epoch: 56, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.838 Vali Acc: 0.357 Test Loss: 2.838 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 57 | loss: 1.4255263
	speed: 0.1034s/iter; left time: 690.1749s
Epoch: 57 cost time: 4.334873914718628
Epoch: 57, Steps: 154 | Train Loss: 1.402 Vali Loss: 2.638 Vali Acc: 0.367 Test Loss: 2.638 Test Acc: 0.367
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 58 | loss: 1.6714951
	speed: 0.1038s/iter; left time: 676.8923s
Epoch: 58 cost time: 4.0327959060668945
Epoch: 58, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.985 Vali Acc: 0.373 Test Loss: 2.985 Test Acc: 0.373
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 59 | loss: 0.8936033
	speed: 0.1026s/iter; left time: 653.7702s
Epoch: 59 cost time: 4.20862603187561
Epoch: 59, Steps: 154 | Train Loss: 1.323 Vali Loss: 2.987 Vali Acc: 0.372 Test Loss: 2.987 Test Acc: 0.372
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 60 | loss: 1.9161912
	speed: 0.1099s/iter; left time: 682.7598s
Epoch: 60 cost time: 4.266412258148193
Epoch: 60, Steps: 154 | Train Loss: 1.615 Vali Loss: 3.017 Vali Acc: 0.374 Test Loss: 3.017 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 61 | loss: 1.2216468
	speed: 0.1075s/iter; left time: 651.3148s
Epoch: 61 cost time: 4.1979851722717285
Epoch: 61, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.946 Vali Acc: 0.377 Test Loss: 2.946 Test Acc: 0.377
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 62 | loss: 0.8370851
	speed: 0.1085s/iter; left time: 640.8395s
Epoch: 62 cost time: 4.044844388961792
Epoch: 62, Steps: 154 | Train Loss: 1.371 Vali Loss: 2.864 Vali Acc: 0.379 Test Loss: 2.864 Test Acc: 0.379
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38077858880778587
model parameter : 52342
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4629071
	speed: 0.0434s/iter; left time: 664.2848s
Epoch: 1 cost time: 5.69691014289856
Epoch: 1, Steps: 154 | Train Loss: 2.274 Vali Loss: 2.151 Vali Acc: 0.315 Test Loss: 2.151 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9103041
	speed: 0.1074s/iter; left time: 1627.5090s
Epoch: 2 cost time: 4.127796649932861
Epoch: 2, Steps: 154 | Train Loss: 2.073 Vali Loss: 2.145 Vali Acc: 0.318 Test Loss: 2.145 Test Acc: 0.318
Validation loss decreased (-0.315064 --> -0.317497).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0845296
	speed: 0.1099s/iter; left time: 1647.6527s
Epoch: 3 cost time: 4.965456485748291
Epoch: 3, Steps: 154 | Train Loss: 2.031 Vali Loss: 2.148 Vali Acc: 0.319 Test Loss: 2.148 Test Acc: 0.319
Validation loss decreased (-0.317497 --> -0.318713).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4219155
	speed: 0.1068s/iter; left time: 1584.7911s
Epoch: 4 cost time: 3.4362237453460693
Epoch: 4, Steps: 154 | Train Loss: 1.993 Vali Loss: 2.152 Vali Acc: 0.318 Test Loss: 2.152 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.1950641
	speed: 0.0801s/iter; left time: 1175.7515s
Epoch: 5 cost time: 3.4913599491119385
Epoch: 5, Steps: 154 | Train Loss: 1.983 Vali Loss: 2.144 Vali Acc: 0.319 Test Loss: 2.144 Test Acc: 0.319
Validation loss decreased (-0.318713 --> -0.318713).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8416413
	speed: 0.0986s/iter; left time: 1432.5969s
Epoch: 6 cost time: 4.20055365562439
Epoch: 6, Steps: 154 | Train Loss: 1.951 Vali Loss: 2.137 Vali Acc: 0.321 Test Loss: 2.137 Test Acc: 0.321
Validation loss decreased (-0.318713 --> -0.320741).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7704151
	speed: 0.0997s/iter; left time: 1434.0102s
Epoch: 7 cost time: 3.8409433364868164
Epoch: 7, Steps: 154 | Train Loss: 1.923 Vali Loss: 2.121 Vali Acc: 0.322 Test Loss: 2.121 Test Acc: 0.322
Validation loss decreased (-0.320741 --> -0.321552).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0265903
	speed: 0.1001s/iter; left time: 1424.0463s
Epoch: 8 cost time: 3.948225498199463
Epoch: 8, Steps: 154 | Train Loss: 1.897 Vali Loss: 2.133 Vali Acc: 0.319 Test Loss: 2.133 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0254698
	speed: 0.1012s/iter; left time: 1423.4574s
Epoch: 9 cost time: 4.151033401489258
Epoch: 9, Steps: 154 | Train Loss: 1.875 Vali Loss: 2.153 Vali Acc: 0.324 Test Loss: 2.153 Test Acc: 0.324
Validation loss decreased (-0.321552 --> -0.323985).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8280970
	speed: 0.1022s/iter; left time: 1422.6638s
Epoch: 10 cost time: 3.9804821014404297
Epoch: 10, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.141 Vali Acc: 0.326 Test Loss: 2.141 Test Acc: 0.326
Validation loss decreased (-0.323985 --> -0.325607).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6687493
	speed: 0.1004s/iter; left time: 1381.7612s
Epoch: 11 cost time: 3.910038948059082
Epoch: 11, Steps: 154 | Train Loss: 1.828 Vali Loss: 2.148 Vali Acc: 0.330 Test Loss: 2.148 Test Acc: 0.330
Validation loss decreased (-0.325607 --> -0.329662).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.4052393
	speed: 0.1012s/iter; left time: 1377.0608s
Epoch: 12 cost time: 4.145066261291504
Epoch: 12, Steps: 154 | Train Loss: 1.794 Vali Loss: 2.206 Vali Acc: 0.328 Test Loss: 2.206 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6023334
	speed: 0.1010s/iter; left time: 1359.2112s
Epoch: 13 cost time: 3.7860469818115234
Epoch: 13, Steps: 154 | Train Loss: 1.836 Vali Loss: 2.170 Vali Acc: 0.331 Test Loss: 2.170 Test Acc: 0.331
Validation loss decreased (-0.329662 --> -0.330879).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4456322
	speed: 0.1001s/iter; left time: 1331.2177s
Epoch: 14 cost time: 4.066978454589844
Epoch: 14, Steps: 154 | Train Loss: 1.786 Vali Loss: 2.159 Vali Acc: 0.336 Test Loss: 2.159 Test Acc: 0.336
Validation loss decreased (-0.330879 --> -0.336150).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.5177040
	speed: 0.1040s/iter; left time: 1367.3151s
Epoch: 15 cost time: 4.0420427322387695
Epoch: 15, Steps: 154 | Train Loss: 1.768 Vali Loss: 2.178 Vali Acc: 0.341 Test Loss: 2.178 Test Acc: 0.341
Validation loss decreased (-0.336150 --> -0.341422).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4719056
	speed: 0.1025s/iter; left time: 1331.2914s
Epoch: 16 cost time: 4.108154535293579
Epoch: 16, Steps: 154 | Train Loss: 1.728 Vali Loss: 2.209 Vali Acc: 0.342 Test Loss: 2.209 Test Acc: 0.342
Validation loss decreased (-0.341422 --> -0.342233).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.6087433
	speed: 0.1048s/iter; left time: 1345.6004s
Epoch: 17 cost time: 4.262372016906738
Epoch: 17, Steps: 154 | Train Loss: 1.758 Vali Loss: 2.216 Vali Acc: 0.341 Test Loss: 2.216 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.0708811
	speed: 0.1065s/iter; left time: 1350.2674s
Epoch: 18 cost time: 4.184821844100952
Epoch: 18, Steps: 154 | Train Loss: 1.701 Vali Loss: 2.218 Vali Acc: 0.346 Test Loss: 2.218 Test Acc: 0.346
Validation loss decreased (-0.342233 --> -0.345882).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.0215729
	speed: 0.1046s/iter; left time: 1310.1582s
Epoch: 19 cost time: 4.084354400634766
Epoch: 19, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.257 Vali Acc: 0.340 Test Loss: 2.257 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.7481997
	speed: 0.1031s/iter; left time: 1275.2632s
Epoch: 20 cost time: 4.254297971725464
Epoch: 20, Steps: 154 | Train Loss: 1.670 Vali Loss: 2.261 Vali Acc: 0.347 Test Loss: 2.261 Test Acc: 0.347
Validation loss decreased (-0.345882 --> -0.346693).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.4417295
	speed: 0.1048s/iter; left time: 1280.2647s
Epoch: 21 cost time: 4.369821310043335
Epoch: 21, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.327 Vali Acc: 0.351 Test Loss: 2.327 Test Acc: 0.351
Validation loss decreased (-0.346693 --> -0.351153).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.5536397
	speed: 0.1056s/iter; left time: 1274.4656s
Epoch: 22 cost time: 4.03326416015625
Epoch: 22, Steps: 154 | Train Loss: 1.647 Vali Loss: 2.259 Vali Acc: 0.345 Test Loss: 2.259 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.9572439
	speed: 0.1049s/iter; left time: 1249.5760s
Epoch: 23 cost time: 4.0752129554748535
Epoch: 23, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.342 Vali Acc: 0.354 Test Loss: 2.342 Test Acc: 0.354
Validation loss decreased (-0.351153 --> -0.353991).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.5880579
	speed: 0.1016s/iter; left time: 1194.9693s
Epoch: 24 cost time: 4.020400524139404
Epoch: 24, Steps: 154 | Train Loss: 1.590 Vali Loss: 2.438 Vali Acc: 0.351 Test Loss: 2.438 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.6073477
	speed: 0.1048s/iter; left time: 1216.5307s
Epoch: 25 cost time: 4.081656455993652
Epoch: 25, Steps: 154 | Train Loss: 1.636 Vali Loss: 2.344 Vali Acc: 0.348 Test Loss: 2.344 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.4522897
	speed: 0.1052s/iter; left time: 1204.8939s
Epoch: 26 cost time: 4.268326044082642
Epoch: 26, Steps: 154 | Train Loss: 1.561 Vali Loss: 2.340 Vali Acc: 0.351 Test Loss: 2.340 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.3399704
	speed: 0.1051s/iter; left time: 1187.5370s
Epoch: 27 cost time: 4.029431343078613
Epoch: 27, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.395 Vali Acc: 0.352 Test Loss: 2.395 Test Acc: 0.352
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.2790711
	speed: 0.1036s/iter; left time: 1154.4900s
Epoch: 28 cost time: 4.110651969909668
Epoch: 28, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.411 Vali Acc: 0.356 Test Loss: 2.411 Test Acc: 0.356
Validation loss decreased (-0.353991 --> -0.356018).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.3629363
	speed: 0.1032s/iter; left time: 1133.5920s
Epoch: 29 cost time: 4.192809343338013
Epoch: 29, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.488 Vali Acc: 0.360 Test Loss: 2.488 Test Acc: 0.360
Validation loss decreased (-0.356018 --> -0.359667).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.7373197
	speed: 0.1034s/iter; left time: 1120.1976s
Epoch: 30 cost time: 4.172043323516846
Epoch: 30, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.471 Vali Acc: 0.356 Test Loss: 2.471 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.4815251
	speed: 0.1011s/iter; left time: 1079.3266s
Epoch: 31 cost time: 3.8560476303100586
Epoch: 31, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.439 Vali Acc: 0.352 Test Loss: 2.439 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 1.1211414
	speed: 0.1028s/iter; left time: 1082.3430s
Epoch: 32 cost time: 4.014772653579712
Epoch: 32, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.510 Vali Acc: 0.358 Test Loss: 2.510 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 1.4268981
	speed: 0.1015s/iter; left time: 1052.6931s
Epoch: 33 cost time: 3.867976188659668
Epoch: 33, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.398 Vali Acc: 0.358 Test Loss: 2.398 Test Acc: 0.358
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 1.5386754
	speed: 0.1000s/iter; left time: 1021.8340s
Epoch: 34 cost time: 4.02759575843811
Epoch: 34, Steps: 154 | Train Loss: 1.485 Vali Loss: 2.530 Vali Acc: 0.359 Test Loss: 2.530 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 1.3934820
	speed: 0.1050s/iter; left time: 1057.1948s
Epoch: 35 cost time: 4.242883920669556
Epoch: 35, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.483 Vali Acc: 0.367 Test Loss: 2.483 Test Acc: 0.367
Validation loss decreased (-0.359667 --> -0.366561).  Saving model ...
	iters: 100, epoch: 36 | loss: 1.7891599
	speed: 0.1012s/iter; left time: 1003.4504s
Epoch: 36 cost time: 4.026368618011475
Epoch: 36, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.474 Vali Acc: 0.363 Test Loss: 2.474 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 1.6571161
	speed: 0.1052s/iter; left time: 1026.2184s
Epoch: 37 cost time: 4.5062806606292725
Epoch: 37, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.586 Vali Acc: 0.313 Test Loss: 2.586 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 1.5468726
	speed: 0.1044s/iter; left time: 1002.5129s
Epoch: 38 cost time: 4.259894609451294
Epoch: 38, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.673 Vali Acc: 0.371 Test Loss: 2.673 Test Acc: 0.371
Validation loss decreased (-0.366561 --> -0.371020).  Saving model ...
	iters: 100, epoch: 39 | loss: 1.4938191
	speed: 0.1040s/iter; left time: 982.2806s
Epoch: 39 cost time: 4.090633392333984
Epoch: 39, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.538 Vali Acc: 0.369 Test Loss: 2.538 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 1.4253300
	speed: 0.1043s/iter; left time: 969.9263s
Epoch: 40 cost time: 4.1281774044036865
Epoch: 40, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.601 Vali Acc: 0.361 Test Loss: 2.601 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 1.0114999
	speed: 0.1023s/iter; left time: 935.3286s
Epoch: 41 cost time: 3.9596235752105713
Epoch: 41, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.663 Vali Acc: 0.362 Test Loss: 2.663 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 42 | loss: 1.4119303
	speed: 0.0952s/iter; left time: 855.8973s
Epoch: 42 cost time: 3.7430357933044434
Epoch: 42, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.687 Vali Acc: 0.370 Test Loss: 2.687 Test Acc: 0.370
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 43 | loss: 1.4178741
	speed: 0.0981s/iter; left time: 866.7639s
Epoch: 43 cost time: 3.95790696144104
Epoch: 43, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.649 Vali Acc: 0.362 Test Loss: 2.649 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 44 | loss: 1.4402281
	speed: 0.1025s/iter; left time: 889.9159s
Epoch: 44 cost time: 3.9467008113861084
Epoch: 44, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.707 Vali Acc: 0.365 Test Loss: 2.707 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 45 | loss: 1.2914768
	speed: 0.1053s/iter; left time: 897.4957s
Epoch: 45 cost time: 3.9695074558258057
Epoch: 45, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.578 Vali Acc: 0.363 Test Loss: 2.578 Test Acc: 0.363
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 46 | loss: 1.0884093
	speed: 0.1010s/iter; left time: 845.3060s
Epoch: 46 cost time: 4.166138410568237
Epoch: 46, Steps: 154 | Train Loss: 1.437 Vali Loss: 2.744 Vali Acc: 0.366 Test Loss: 2.744 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 47 | loss: 1.1374434
	speed: 0.1035s/iter; left time: 850.5091s
Epoch: 47 cost time: 4.121333599090576
Epoch: 47, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.809 Vali Acc: 0.365 Test Loss: 2.809 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 48 | loss: 1.4055328
	speed: 0.1044s/iter; left time: 842.0247s
Epoch: 48 cost time: 4.097768306732178
Epoch: 48, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.889 Vali Acc: 0.369 Test Loss: 2.889 Test Acc: 0.369
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3710462287104623
model parameter : 52342
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9351463
	speed: 0.0443s/iter; left time: 678.2216s
Epoch: 1 cost time: 5.690437078475952
Epoch: 1, Steps: 154 | Train Loss: 2.344 Vali Loss: 2.151 Vali Acc: 0.315 Test Loss: 2.151 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8324180
	speed: 0.1045s/iter; left time: 1582.3324s
Epoch: 2 cost time: 4.051497936248779
Epoch: 2, Steps: 154 | Train Loss: 2.070 Vali Loss: 2.127 Vali Acc: 0.317 Test Loss: 2.127 Test Acc: 0.317
Validation loss decreased (-0.315469 --> -0.317091).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1123230
	speed: 0.1091s/iter; left time: 1635.2188s
Epoch: 3 cost time: 4.258939027786255
Epoch: 3, Steps: 154 | Train Loss: 2.018 Vali Loss: 2.142 Vali Acc: 0.319 Test Loss: 2.142 Test Acc: 0.319
Validation loss decreased (-0.317091 --> -0.318713).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9113067
	speed: 0.1020s/iter; left time: 1513.4953s
Epoch: 4 cost time: 3.922316551208496
Epoch: 4, Steps: 154 | Train Loss: 1.975 Vali Loss: 2.130 Vali Acc: 0.318 Test Loss: 2.130 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7757607
	speed: 0.1078s/iter; left time: 1582.3979s
Epoch: 5 cost time: 4.270576000213623
Epoch: 5, Steps: 154 | Train Loss: 1.967 Vali Loss: 2.136 Vali Acc: 0.320 Test Loss: 2.136 Test Acc: 0.320
Validation loss decreased (-0.318713 --> -0.319524).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2676857
	speed: 0.1056s/iter; left time: 1534.5208s
Epoch: 6 cost time: 4.413731336593628
Epoch: 6, Steps: 154 | Train Loss: 1.923 Vali Loss: 2.146 Vali Acc: 0.320 Test Loss: 2.146 Test Acc: 0.320
Validation loss decreased (-0.319524 --> -0.319930).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0160437
	speed: 0.1061s/iter; left time: 1524.7480s
Epoch: 7 cost time: 4.211291313171387
Epoch: 7, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.131 Vali Acc: 0.324 Test Loss: 2.131 Test Acc: 0.324
Validation loss decreased (-0.319930 --> -0.323580).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7544708
	speed: 0.1068s/iter; left time: 1519.1510s
Epoch: 8 cost time: 4.136315107345581
Epoch: 8, Steps: 154 | Train Loss: 1.888 Vali Loss: 2.130 Vali Acc: 0.326 Test Loss: 2.130 Test Acc: 0.326
Validation loss decreased (-0.323580 --> -0.326418).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7290568
	speed: 0.1077s/iter; left time: 1514.6050s
Epoch: 9 cost time: 4.463419437408447
Epoch: 9, Steps: 154 | Train Loss: 1.865 Vali Loss: 2.134 Vali Acc: 0.325 Test Loss: 2.134 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6346146
	speed: 0.1054s/iter; left time: 1467.2179s
Epoch: 10 cost time: 4.092600345611572
Epoch: 10, Steps: 154 | Train Loss: 1.862 Vali Loss: 2.147 Vali Acc: 0.328 Test Loss: 2.147 Test Acc: 0.328
Validation loss decreased (-0.326418 --> -0.327635).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0568278
	speed: 0.1022s/iter; left time: 1406.9165s
Epoch: 11 cost time: 4.012990474700928
Epoch: 11, Steps: 154 | Train Loss: 1.808 Vali Loss: 2.144 Vali Acc: 0.326 Test Loss: 2.144 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4463631
	speed: 0.1065s/iter; left time: 1449.0003s
Epoch: 12 cost time: 4.210690498352051
Epoch: 12, Steps: 154 | Train Loss: 1.819 Vali Loss: 2.191 Vali Acc: 0.324 Test Loss: 2.191 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.6218995
	speed: 0.1014s/iter; left time: 1363.9891s
Epoch: 13 cost time: 3.9042906761169434
Epoch: 13, Steps: 154 | Train Loss: 1.767 Vali Loss: 2.191 Vali Acc: 0.326 Test Loss: 2.191 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.0907805
	speed: 0.1063s/iter; left time: 1413.7606s
Epoch: 14 cost time: 4.0500524044036865
Epoch: 14, Steps: 154 | Train Loss: 1.782 Vali Loss: 2.164 Vali Acc: 0.331 Test Loss: 2.164 Test Acc: 0.331
Validation loss decreased (-0.327635 --> -0.331284).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.0067251
	speed: 0.1038s/iter; left time: 1364.1397s
Epoch: 15 cost time: 3.999746561050415
Epoch: 15, Steps: 154 | Train Loss: 1.728 Vali Loss: 2.189 Vali Acc: 0.330 Test Loss: 2.189 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.5549216
	speed: 0.1003s/iter; left time: 1302.5564s
Epoch: 16 cost time: 4.082589626312256
Epoch: 16, Steps: 154 | Train Loss: 1.719 Vali Loss: 2.143 Vali Acc: 0.332 Test Loss: 2.143 Test Acc: 0.332
Validation loss decreased (-0.331284 --> -0.332095).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.0488584
	speed: 0.1041s/iter; left time: 1335.8834s
Epoch: 17 cost time: 4.017410516738892
Epoch: 17, Steps: 154 | Train Loss: 1.706 Vali Loss: 2.228 Vali Acc: 0.334 Test Loss: 2.228 Test Acc: 0.334
Validation loss decreased (-0.332095 --> -0.334122).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.7770916
	speed: 0.1052s/iter; left time: 1333.8455s
Epoch: 18 cost time: 4.062148809432983
Epoch: 18, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.203 Vali Acc: 0.335 Test Loss: 2.203 Test Acc: 0.335
Validation loss decreased (-0.334122 --> -0.334933).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.5945699
	speed: 0.1045s/iter; left time: 1309.3980s
Epoch: 19 cost time: 4.122175693511963
Epoch: 19, Steps: 154 | Train Loss: 1.676 Vali Loss: 2.220 Vali Acc: 0.339 Test Loss: 2.220 Test Acc: 0.339
Validation loss decreased (-0.334933 --> -0.339394).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.4588410
	speed: 0.1066s/iter; left time: 1318.8691s
Epoch: 20 cost time: 4.2449421882629395
Epoch: 20, Steps: 154 | Train Loss: 1.696 Vali Loss: 2.288 Vali Acc: 0.341 Test Loss: 2.288 Test Acc: 0.341
Validation loss decreased (-0.339394 --> -0.341015).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.6593390
	speed: 0.1059s/iter; left time: 1294.3534s
Epoch: 21 cost time: 4.281923294067383
Epoch: 21, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.244 Vali Acc: 0.341 Test Loss: 2.244 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.2271146
	speed: 0.1104s/iter; left time: 1332.4991s
Epoch: 22 cost time: 4.253059148788452
Epoch: 22, Steps: 154 | Train Loss: 1.635 Vali Loss: 2.300 Vali Acc: 0.345 Test Loss: 2.300 Test Acc: 0.345
Validation loss decreased (-0.341015 --> -0.345070).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.7602808
	speed: 0.1092s/iter; left time: 1301.2682s
Epoch: 23 cost time: 4.519355773925781
Epoch: 23, Steps: 154 | Train Loss: 1.633 Vali Loss: 2.279 Vali Acc: 0.343 Test Loss: 2.279 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.6451712
	speed: 0.1100s/iter; left time: 1293.7181s
Epoch: 24 cost time: 4.173975229263306
Epoch: 24, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.289 Vali Acc: 0.352 Test Loss: 2.289 Test Acc: 0.352
Validation loss decreased (-0.345070 --> -0.352370).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.7880442
	speed: 0.1060s/iter; left time: 1229.9998s
Epoch: 25 cost time: 4.186138391494751
Epoch: 25, Steps: 154 | Train Loss: 1.561 Vali Loss: 2.300 Vali Acc: 0.345 Test Loss: 2.300 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.3983859
	speed: 0.1072s/iter; left time: 1227.1179s
Epoch: 26 cost time: 4.228902578353882
Epoch: 26, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.365 Vali Acc: 0.346 Test Loss: 2.365 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.2935340
	speed: 0.0988s/iter; left time: 1116.3051s
Epoch: 27 cost time: 4.066516399383545
Epoch: 27, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.303 Vali Acc: 0.350 Test Loss: 2.303 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.2338748
	speed: 0.1013s/iter; left time: 1128.6281s
Epoch: 28 cost time: 4.065295457839966
Epoch: 28, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.359 Vali Acc: 0.349 Test Loss: 2.359 Test Acc: 0.349
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 1.3933588
	speed: 0.1040s/iter; left time: 1143.0692s
Epoch: 29 cost time: 4.205132246017456
Epoch: 29, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.330 Vali Acc: 0.348 Test Loss: 2.330 Test Acc: 0.348
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 1.4369663
	speed: 0.1008s/iter; left time: 1092.2736s
Epoch: 30 cost time: 4.010138034820557
Epoch: 30, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.361 Vali Acc: 0.349 Test Loss: 2.361 Test Acc: 0.349
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 1.5623831
	speed: 0.1076s/iter; left time: 1149.2292s
Epoch: 31 cost time: 4.180004358291626
Epoch: 31, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.354 Vali Acc: 0.351 Test Loss: 2.354 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 4.9285631
	speed: 0.1021s/iter; left time: 1075.1616s
Epoch: 32 cost time: 3.998607635498047
Epoch: 32, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.401 Vali Acc: 0.351 Test Loss: 2.401 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 1.5417557
	speed: 0.1039s/iter; left time: 1077.9853s
Epoch: 33 cost time: 4.020602464675903
Epoch: 33, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.260 Vali Acc: 0.355 Test Loss: 2.260 Test Acc: 0.355
Validation loss decreased (-0.352370 --> -0.355209).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.0830398
	speed: 0.1029s/iter; left time: 1051.2903s
Epoch: 34 cost time: 3.823134422302246
Epoch: 34, Steps: 154 | Train Loss: 1.489 Vali Loss: 2.357 Vali Acc: 0.372 Test Loss: 2.357 Test Acc: 0.372
Validation loss decreased (-0.355209 --> -0.371834).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.4342858
	speed: 0.0923s/iter; left time: 929.4439s
Epoch: 35 cost time: 3.9296798706054688
Epoch: 35, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.464 Vali Acc: 0.355 Test Loss: 2.464 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 1.5215367
	speed: 0.1019s/iter; left time: 1009.6293s
Epoch: 36 cost time: 4.060551881790161
Epoch: 36, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.446 Vali Acc: 0.363 Test Loss: 2.446 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 1.3586757
	speed: 0.1031s/iter; left time: 1006.4190s
Epoch: 37 cost time: 4.141736268997192
Epoch: 37, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.415 Vali Acc: 0.358 Test Loss: 2.415 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 1.7046679
	speed: 0.1016s/iter; left time: 975.4401s
Epoch: 38 cost time: 4.216420650482178
Epoch: 38, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.555 Vali Acc: 0.359 Test Loss: 2.555 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 1.1083201
	speed: 0.1077s/iter; left time: 1017.4335s
Epoch: 39 cost time: 4.27388334274292
Epoch: 39, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.540 Vali Acc: 0.373 Test Loss: 2.540 Test Acc: 0.373
Validation loss decreased (-0.371834 --> -0.373454).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.0307921
	speed: 0.1053s/iter; left time: 978.8774s
Epoch: 40 cost time: 4.186749219894409
Epoch: 40, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.421 Vali Acc: 0.373 Test Loss: 2.421 Test Acc: 0.373
Validation loss decreased (-0.373454 --> -0.373455).  Saving model ...
	iters: 100, epoch: 41 | loss: 1.5583543
	speed: 0.1093s/iter; left time: 999.0461s
Epoch: 41 cost time: 4.224255561828613
Epoch: 41, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.484 Vali Acc: 0.367 Test Loss: 2.484 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 1.2621419
	speed: 0.1081s/iter; left time: 971.2287s
Epoch: 42 cost time: 4.315811395645142
Epoch: 42, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.547 Vali Acc: 0.367 Test Loss: 2.547 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 1.4533451
	speed: 0.1090s/iter; left time: 962.5493s
Epoch: 43 cost time: 4.311706066131592
Epoch: 43, Steps: 154 | Train Loss: 1.390 Vali Loss: 2.554 Vali Acc: 0.369 Test Loss: 2.554 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 1.3096993
	speed: 0.1070s/iter; left time: 928.2413s
Epoch: 44 cost time: 4.069066047668457
Epoch: 44, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.466 Vali Acc: 0.361 Test Loss: 2.466 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 1.8104690
	speed: 0.1041s/iter; left time: 887.1696s
Epoch: 45 cost time: 4.057714939117432
Epoch: 45, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.365 Vali Acc: 0.372 Test Loss: 2.365 Test Acc: 0.372
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 1.4537623
	speed: 0.1041s/iter; left time: 871.7919s
Epoch: 46 cost time: 4.119545221328735
Epoch: 46, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.579 Vali Acc: 0.371 Test Loss: 2.579 Test Acc: 0.371
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.8598095
	speed: 0.1047s/iter; left time: 860.0699s
Epoch: 47 cost time: 4.0097503662109375
Epoch: 47, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.477 Vali Acc: 0.366 Test Loss: 2.477 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.8790927
	speed: 0.1026s/iter; left time: 826.9889s
Epoch: 48 cost time: 4.076197862625122
Epoch: 48, Steps: 154 | Train Loss: 1.368 Vali Loss: 2.843 Vali Acc: 0.365 Test Loss: 2.843 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 1.0466056
	speed: 0.1017s/iter; left time: 804.1703s
Epoch: 49 cost time: 4.02760648727417
Epoch: 49, Steps: 154 | Train Loss: 1.385 Vali Loss: 2.928 Vali Acc: 0.372 Test Loss: 2.928 Test Acc: 0.372
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 1.3991128
	speed: 0.1041s/iter; left time: 807.3704s
Epoch: 50 cost time: 3.9964957237243652
Epoch: 50, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.854 Vali Acc: 0.363 Test Loss: 2.854 Test Acc: 0.363
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3734793187347932
model parameter : 35958
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9439104
	speed: 0.0450s/iter; left time: 688.6373s
Epoch: 1 cost time: 5.8370044231414795
Epoch: 1, Steps: 154 | Train Loss: 2.338 Vali Loss: 2.155 Vali Acc: 0.315 Test Loss: 2.155 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8817503
	speed: 0.1055s/iter; left time: 1598.1653s
Epoch: 2 cost time: 4.178443193435669
Epoch: 2, Steps: 154 | Train Loss: 2.069 Vali Loss: 2.131 Vali Acc: 0.316 Test Loss: 2.131 Test Acc: 0.316
Validation loss decreased (-0.315064 --> -0.316280).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1564398
	speed: 0.1032s/iter; left time: 1546.8802s
Epoch: 3 cost time: 4.182467699050903
Epoch: 3, Steps: 154 | Train Loss: 2.027 Vali Loss: 2.146 Vali Acc: 0.318 Test Loss: 2.146 Test Acc: 0.318
Validation loss decreased (-0.316280 --> -0.317902).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8949966
	speed: 0.1069s/iter; left time: 1586.6187s
Epoch: 4 cost time: 4.4212727546691895
Epoch: 4, Steps: 154 | Train Loss: 1.980 Vali Loss: 2.138 Vali Acc: 0.318 Test Loss: 2.138 Test Acc: 0.318
Validation loss decreased (-0.317902 --> -0.318308).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7982259
	speed: 0.1066s/iter; left time: 1565.5484s
Epoch: 5 cost time: 4.1822052001953125
Epoch: 5, Steps: 154 | Train Loss: 1.977 Vali Loss: 2.142 Vali Acc: 0.319 Test Loss: 2.142 Test Acc: 0.319
Validation loss decreased (-0.318308 --> -0.318713).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2838302
	speed: 0.1049s/iter; left time: 1524.5933s
Epoch: 6 cost time: 4.3116559982299805
Epoch: 6, Steps: 154 | Train Loss: 1.928 Vali Loss: 2.149 Vali Acc: 0.320 Test Loss: 2.149 Test Acc: 0.320
Validation loss decreased (-0.318713 --> -0.319930).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0157413
	speed: 0.1068s/iter; left time: 1534.7871s
Epoch: 7 cost time: 4.048042297363281
Epoch: 7, Steps: 154 | Train Loss: 1.901 Vali Loss: 2.124 Vali Acc: 0.325 Test Loss: 2.124 Test Acc: 0.325
Validation loss decreased (-0.319930 --> -0.324796).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8048202
	speed: 0.1077s/iter; left time: 1532.0221s
Epoch: 8 cost time: 4.302805662155151
Epoch: 8, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.131 Vali Acc: 0.325 Test Loss: 2.131 Test Acc: 0.325
Validation loss decreased (-0.324796 --> -0.325202).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7321067
	speed: 0.1051s/iter; left time: 1478.2241s
Epoch: 9 cost time: 3.935211420059204
Epoch: 9, Steps: 154 | Train Loss: 1.867 Vali Loss: 2.126 Vali Acc: 0.325 Test Loss: 2.126 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6507612
	speed: 0.1065s/iter; left time: 1482.2114s
Epoch: 10 cost time: 4.498437881469727
Epoch: 10, Steps: 154 | Train Loss: 1.838 Vali Loss: 2.144 Vali Acc: 0.325 Test Loss: 2.144 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.0474813
	speed: 0.1105s/iter; left time: 1520.8909s
Epoch: 11 cost time: 4.090669870376587
Epoch: 11, Steps: 154 | Train Loss: 1.827 Vali Loss: 2.133 Vali Acc: 0.325 Test Loss: 2.133 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.5075908
	speed: 0.1055s/iter; left time: 1435.3866s
Epoch: 12 cost time: 4.12448263168335
Epoch: 12, Steps: 154 | Train Loss: 1.813 Vali Loss: 2.181 Vali Acc: 0.325 Test Loss: 2.181 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.6147186
	speed: 0.1061s/iter; left time: 1427.7565s
Epoch: 13 cost time: 4.174561262130737
Epoch: 13, Steps: 154 | Train Loss: 1.776 Vali Loss: 2.198 Vali Acc: 0.323 Test Loss: 2.198 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 2.0970984
	speed: 0.1054s/iter; left time: 1401.0832s
Epoch: 14 cost time: 4.254570245742798
Epoch: 14, Steps: 154 | Train Loss: 1.781 Vali Loss: 2.155 Vali Acc: 0.329 Test Loss: 2.155 Test Acc: 0.329
Validation loss decreased (-0.325202 --> -0.328851).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.0439630
	speed: 0.1085s/iter; left time: 1426.6303s
Epoch: 15 cost time: 4.188638210296631
Epoch: 15, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.171 Vali Acc: 0.330 Test Loss: 2.171 Test Acc: 0.330
Validation loss decreased (-0.328851 --> -0.330473).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5154200
	speed: 0.1056s/iter; left time: 1372.1135s
Epoch: 16 cost time: 4.164838552474976
Epoch: 16, Steps: 154 | Train Loss: 1.737 Vali Loss: 2.170 Vali Acc: 0.331 Test Loss: 2.170 Test Acc: 0.331
Validation loss decreased (-0.330473 --> -0.330879).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.0736597
	speed: 0.1058s/iter; left time: 1358.2138s
Epoch: 17 cost time: 4.170729637145996
Epoch: 17, Steps: 154 | Train Loss: 1.727 Vali Loss: 2.220 Vali Acc: 0.330 Test Loss: 2.220 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.7516056
	speed: 0.1080s/iter; left time: 1369.3633s
Epoch: 18 cost time: 4.126293182373047
Epoch: 18, Steps: 154 | Train Loss: 1.700 Vali Loss: 2.207 Vali Acc: 0.336 Test Loss: 2.207 Test Acc: 0.336
Validation loss decreased (-0.330879 --> -0.336150).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.6252676
	speed: 0.1048s/iter; left time: 1312.5933s
Epoch: 19 cost time: 4.224597930908203
Epoch: 19, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.218 Vali Acc: 0.336 Test Loss: 2.218 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.4269264
	speed: 0.1044s/iter; left time: 1292.2799s
Epoch: 20 cost time: 4.067811489105225
Epoch: 20, Steps: 154 | Train Loss: 1.658 Vali Loss: 2.213 Vali Acc: 0.341 Test Loss: 2.213 Test Acc: 0.341
Validation loss decreased (-0.336150 --> -0.341016).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.7133960
	speed: 0.1049s/iter; left time: 1282.5526s
Epoch: 21 cost time: 4.06932520866394
Epoch: 21, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.226 Vali Acc: 0.338 Test Loss: 2.226 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 3.4476750
	speed: 0.1058s/iter; left time: 1277.1166s
Epoch: 22 cost time: 4.493462800979614
Epoch: 22, Steps: 154 | Train Loss: 1.680 Vali Loss: 2.263 Vali Acc: 0.341 Test Loss: 2.263 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.7420118
	speed: 0.1028s/iter; left time: 1225.1420s
Epoch: 23 cost time: 4.330986976623535
Epoch: 23, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.266 Vali Acc: 0.341 Test Loss: 2.266 Test Acc: 0.341
Validation loss decreased (-0.341016 --> -0.341421).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.6351551
	speed: 0.1030s/iter; left time: 1210.8334s
Epoch: 24 cost time: 4.275421380996704
Epoch: 24, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.302 Vali Acc: 0.345 Test Loss: 2.302 Test Acc: 0.345
Validation loss decreased (-0.341421 --> -0.345070).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.7646981
	speed: 0.1090s/iter; left time: 1264.3663s
Epoch: 25 cost time: 4.499680280685425
Epoch: 25, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.274 Vali Acc: 0.343 Test Loss: 2.274 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.3809204
	speed: 0.1062s/iter; left time: 1215.9353s
Epoch: 26 cost time: 4.3364784717559814
Epoch: 26, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.331 Vali Acc: 0.348 Test Loss: 2.331 Test Acc: 0.348
Validation loss decreased (-0.345070 --> -0.347503).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.2680336
	speed: 0.1096s/iter; left time: 1238.6058s
Epoch: 27 cost time: 4.377764940261841
Epoch: 27, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.359 Vali Acc: 0.350 Test Loss: 2.359 Test Acc: 0.350
Validation loss decreased (-0.347503 --> -0.349530).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.3176825
	speed: 0.1066s/iter; left time: 1188.1965s
Epoch: 28 cost time: 4.2200047969818115
Epoch: 28, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.297 Vali Acc: 0.353 Test Loss: 2.297 Test Acc: 0.353
Validation loss decreased (-0.349530 --> -0.352775).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.3366165
	speed: 0.1093s/iter; left time: 1200.9816s
Epoch: 29 cost time: 4.394425392150879
Epoch: 29, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.365 Vali Acc: 0.347 Test Loss: 2.365 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.4176866
	speed: 0.1079s/iter; left time: 1169.1289s
Epoch: 30 cost time: 4.2245094776153564
Epoch: 30, Steps: 154 | Train Loss: 1.612 Vali Loss: 2.311 Vali Acc: 0.353 Test Loss: 2.311 Test Acc: 0.353
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.3942083
	speed: 0.1055s/iter; left time: 1127.1991s
Epoch: 31 cost time: 4.172806024551392
Epoch: 31, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.407 Vali Acc: 0.352 Test Loss: 2.407 Test Acc: 0.352
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 2.7660632
	speed: 0.1085s/iter; left time: 1141.7667s
Epoch: 32 cost time: 4.393600702285767
Epoch: 32, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.386 Vali Acc: 0.347 Test Loss: 2.386 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 1.4229310
	speed: 0.1059s/iter; left time: 1098.8697s
Epoch: 33 cost time: 4.152860164642334
Epoch: 33, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.373 Vali Acc: 0.352 Test Loss: 2.373 Test Acc: 0.352
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 2.2441170
	speed: 0.1044s/iter; left time: 1067.3100s
Epoch: 34 cost time: 4.11830735206604
Epoch: 34, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.354 Vali Acc: 0.363 Test Loss: 2.354 Test Acc: 0.363
Validation loss decreased (-0.352775 --> -0.363318).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.4874823
	speed: 0.1044s/iter; left time: 1050.8480s
Epoch: 35 cost time: 4.379317760467529
Epoch: 35, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.522 Vali Acc: 0.198 Test Loss: 2.522 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 1.4345181
	speed: 0.1104s/iter; left time: 1094.6534s
Epoch: 36 cost time: 4.257294178009033
Epoch: 36, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.467 Vali Acc: 0.358 Test Loss: 2.467 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 1.4215140
	speed: 0.1070s/iter; left time: 1043.5174s
Epoch: 37 cost time: 4.05413031578064
Epoch: 37, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.620 Vali Acc: 0.361 Test Loss: 2.620 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 1.4827819
	speed: 0.1061s/iter; left time: 1018.5180s
Epoch: 38 cost time: 4.098161458969116
Epoch: 38, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.637 Vali Acc: 0.358 Test Loss: 2.637 Test Acc: 0.358
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 1.0712609
	speed: 0.1065s/iter; left time: 1006.2596s
Epoch: 39 cost time: 3.9348363876342773
Epoch: 39, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.615 Vali Acc: 0.373 Test Loss: 2.615 Test Acc: 0.373
Validation loss decreased (-0.363318 --> -0.373048).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.1470680
	speed: 0.1036s/iter; left time: 963.2898s
Epoch: 40 cost time: 4.278582572937012
Epoch: 40, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.652 Vali Acc: 0.374 Test Loss: 2.652 Test Acc: 0.374
Validation loss decreased (-0.373048 --> -0.373858).  Saving model ...
	iters: 100, epoch: 41 | loss: 1.6605601
	speed: 0.1051s/iter; left time: 960.3684s
Epoch: 41 cost time: 4.390468120574951
Epoch: 41, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.840 Vali Acc: 0.348 Test Loss: 2.840 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 1.3155137
	speed: 0.1083s/iter; left time: 973.2813s
Epoch: 42 cost time: 4.257413148880005
Epoch: 42, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.628 Vali Acc: 0.363 Test Loss: 2.628 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 1.4157839
	speed: 0.1060s/iter; left time: 936.0127s
Epoch: 43 cost time: 4.2068517208099365
Epoch: 43, Steps: 154 | Train Loss: 1.424 Vali Loss: 2.522 Vali Acc: 0.361 Test Loss: 2.522 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 1.3742517
	speed: 0.1075s/iter; left time: 932.9700s
Epoch: 44 cost time: 4.494476556777954
Epoch: 44, Steps: 154 | Train Loss: 1.427 Vali Loss: 2.504 Vali Acc: 0.356 Test Loss: 2.504 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 1.7143550
	speed: 0.1068s/iter; left time: 910.7722s
Epoch: 45 cost time: 4.188100814819336
Epoch: 45, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.470 Vali Acc: 0.360 Test Loss: 2.470 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 1.6233685
	speed: 0.1038s/iter; left time: 869.2869s
Epoch: 46 cost time: 4.0306336879730225
Epoch: 46, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.499 Vali Acc: 0.364 Test Loss: 2.499 Test Acc: 0.364
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.9895769
	speed: 0.0972s/iter; left time: 798.6110s
Epoch: 47 cost time: 4.069152355194092
Epoch: 47, Steps: 154 | Train Loss: 1.383 Vali Loss: 2.493 Vali Acc: 0.368 Test Loss: 2.493 Test Acc: 0.368
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.8800192
	speed: 0.1054s/iter; left time: 849.9431s
Epoch: 48 cost time: 4.16545844078064
Epoch: 48, Steps: 154 | Train Loss: 1.371 Vali Loss: 2.736 Vali Acc: 0.367 Test Loss: 2.736 Test Acc: 0.367
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.9974005
	speed: 0.1041s/iter; left time: 823.6622s
Epoch: 49 cost time: 4.262659311294556
Epoch: 49, Steps: 154 | Train Loss: 1.350 Vali Loss: 2.887 Vali Acc: 0.338 Test Loss: 2.887 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 2.1335301
	speed: 0.1056s/iter; left time: 818.8781s
Epoch: 50 cost time: 4.163235187530518
Epoch: 50, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.675 Vali Acc: 0.370 Test Loss: 2.675 Test Acc: 0.370
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37388483373884834
model parameter : 35958
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9285836
	speed: 0.0439s/iter; left time: 671.8660s
Epoch: 1 cost time: 5.7615673542022705
Epoch: 1, Steps: 154 | Train Loss: 2.329 Vali Loss: 2.150 Vali Acc: 0.315 Test Loss: 2.150 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8714052
	speed: 0.1024s/iter; left time: 1550.7767s
Epoch: 2 cost time: 4.013598442077637
Epoch: 2, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.128 Vali Acc: 0.317 Test Loss: 2.128 Test Acc: 0.317
Validation loss decreased (-0.315469 --> -0.316686).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1883957
	speed: 0.0994s/iter; left time: 1490.1724s
Epoch: 3 cost time: 4.013686180114746
Epoch: 3, Steps: 154 | Train Loss: 2.027 Vali Loss: 2.139 Vali Acc: 0.318 Test Loss: 2.139 Test Acc: 0.318
Validation loss decreased (-0.316686 --> -0.317902).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9072434
	speed: 0.1032s/iter; left time: 1531.4221s
Epoch: 4 cost time: 3.9696693420410156
Epoch: 4, Steps: 154 | Train Loss: 1.978 Vali Loss: 2.131 Vali Acc: 0.318 Test Loss: 2.131 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8085735
	speed: 0.1011s/iter; left time: 1484.7511s
Epoch: 5 cost time: 3.9279229640960693
Epoch: 5, Steps: 154 | Train Loss: 1.980 Vali Loss: 2.137 Vali Acc: 0.318 Test Loss: 2.137 Test Acc: 0.318
Validation loss decreased (-0.317902 --> -0.317902).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2820153
	speed: 0.1017s/iter; left time: 1477.1006s
Epoch: 6 cost time: 3.9874606132507324
Epoch: 6, Steps: 154 | Train Loss: 1.941 Vali Loss: 2.136 Vali Acc: 0.318 Test Loss: 2.136 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.0240908
	speed: 0.1029s/iter; left time: 1479.0296s
Epoch: 7 cost time: 4.047114610671997
Epoch: 7, Steps: 154 | Train Loss: 1.911 Vali Loss: 2.117 Vali Acc: 0.323 Test Loss: 2.117 Test Acc: 0.323
Validation loss decreased (-0.317902 --> -0.322769).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8018458
	speed: 0.0999s/iter; left time: 1420.7045s
Epoch: 8 cost time: 3.9204442501068115
Epoch: 8, Steps: 154 | Train Loss: 1.890 Vali Loss: 2.124 Vali Acc: 0.324 Test Loss: 2.124 Test Acc: 0.324
Validation loss decreased (-0.322769 --> -0.323580).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7606374
	speed: 0.0992s/iter; left time: 1395.7263s
Epoch: 9 cost time: 3.925746440887451
Epoch: 9, Steps: 154 | Train Loss: 1.873 Vali Loss: 2.115 Vali Acc: 0.324 Test Loss: 2.115 Test Acc: 0.324
Validation loss decreased (-0.323580 --> -0.323985).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6343063
	speed: 0.1010s/iter; left time: 1405.6702s
Epoch: 10 cost time: 4.22263503074646
Epoch: 10, Steps: 154 | Train Loss: 1.841 Vali Loss: 2.130 Vali Acc: 0.327 Test Loss: 2.130 Test Acc: 0.327
Validation loss decreased (-0.323985 --> -0.326824).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0572764
	speed: 0.0893s/iter; left time: 1228.3441s
Epoch: 11 cost time: 3.5565848350524902
Epoch: 11, Steps: 154 | Train Loss: 1.823 Vali Loss: 2.117 Vali Acc: 0.325 Test Loss: 2.117 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6005223
	speed: 0.0922s/iter; left time: 1254.3671s
Epoch: 12 cost time: 3.808530569076538
Epoch: 12, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.148 Vali Acc: 0.326 Test Loss: 2.148 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5891992
	speed: 0.1014s/iter; left time: 1363.9543s
Epoch: 13 cost time: 4.194713354110718
Epoch: 13, Steps: 154 | Train Loss: 1.779 Vali Loss: 2.155 Vali Acc: 0.328 Test Loss: 2.155 Test Acc: 0.328
Validation loss decreased (-0.326824 --> -0.328446).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.0932841
	speed: 0.1033s/iter; left time: 1374.3545s
Epoch: 14 cost time: 4.015716552734375
Epoch: 14, Steps: 154 | Train Loss: 1.755 Vali Loss: 2.115 Vali Acc: 0.332 Test Loss: 2.115 Test Acc: 0.332
Validation loss decreased (-0.328446 --> -0.332096).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.0359876
	speed: 0.1056s/iter; left time: 1388.3918s
Epoch: 15 cost time: 4.447019577026367
Epoch: 15, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.151 Vali Acc: 0.330 Test Loss: 2.151 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.4609504
	speed: 0.1148s/iter; left time: 1491.3613s
Epoch: 16 cost time: 4.349315166473389
Epoch: 16, Steps: 154 | Train Loss: 1.753 Vali Loss: 2.177 Vali Acc: 0.333 Test Loss: 2.177 Test Acc: 0.333
Validation loss decreased (-0.332096 --> -0.332906).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.0967066
	speed: 0.1050s/iter; left time: 1348.0767s
Epoch: 17 cost time: 4.335925817489624
Epoch: 17, Steps: 154 | Train Loss: 1.713 Vali Loss: 2.182 Vali Acc: 0.335 Test Loss: 2.182 Test Acc: 0.335
Validation loss decreased (-0.332906 --> -0.334528).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.8141258
	speed: 0.1083s/iter; left time: 1373.4156s
Epoch: 18 cost time: 4.396347284317017
Epoch: 18, Steps: 154 | Train Loss: 1.732 Vali Loss: 2.238 Vali Acc: 0.337 Test Loss: 2.238 Test Acc: 0.337
Validation loss decreased (-0.334528 --> -0.337366).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.6184981
	speed: 0.1079s/iter; left time: 1351.9873s
Epoch: 19 cost time: 4.359162092208862
Epoch: 19, Steps: 154 | Train Loss: 1.712 Vali Loss: 2.212 Vali Acc: 0.340 Test Loss: 2.212 Test Acc: 0.340
Validation loss decreased (-0.337366 --> -0.340205).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.3657022
	speed: 0.1072s/iter; left time: 1326.5385s
Epoch: 20 cost time: 4.329678535461426
Epoch: 20, Steps: 154 | Train Loss: 1.631 Vali Loss: 2.215 Vali Acc: 0.350 Test Loss: 2.215 Test Acc: 0.350
Validation loss decreased (-0.340205 --> -0.350343).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.8750978
	speed: 0.1099s/iter; left time: 1343.5874s
Epoch: 21 cost time: 4.207356929779053
Epoch: 21, Steps: 154 | Train Loss: 1.660 Vali Loss: 2.225 Vali Acc: 0.345 Test Loss: 2.225 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 3.8405371
	speed: 0.1048s/iter; left time: 1264.7724s
Epoch: 22 cost time: 4.116724967956543
Epoch: 22, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.308 Vali Acc: 0.345 Test Loss: 2.308 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.6539999
	speed: 0.1076s/iter; left time: 1281.6680s
Epoch: 23 cost time: 4.202483415603638
Epoch: 23, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.292 Vali Acc: 0.345 Test Loss: 2.292 Test Acc: 0.345
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.4900572
	speed: 0.1076s/iter; left time: 1264.7267s
Epoch: 24 cost time: 4.168350458145142
Epoch: 24, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.330 Vali Acc: 0.354 Test Loss: 2.330 Test Acc: 0.354
Validation loss decreased (-0.350343 --> -0.353991).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.7128785
	speed: 0.1065s/iter; left time: 1235.5204s
Epoch: 25 cost time: 4.409005641937256
Epoch: 25, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.368 Vali Acc: 0.342 Test Loss: 2.368 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.7509891
	speed: 0.1060s/iter; left time: 1213.2787s
Epoch: 26 cost time: 4.5884974002838135
Epoch: 26, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.655 Vali Acc: 0.351 Test Loss: 2.655 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.2927443
	speed: 0.1159s/iter; left time: 1309.3372s
Epoch: 27 cost time: 4.037842750549316
Epoch: 27, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.474 Vali Acc: 0.351 Test Loss: 2.474 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.5735687
	speed: 0.0905s/iter; left time: 1008.6114s
Epoch: 28 cost time: 3.561694860458374
Epoch: 28, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.329 Vali Acc: 0.350 Test Loss: 2.329 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 1.2533213
	speed: 0.0981s/iter; left time: 1077.7872s
Epoch: 29 cost time: 4.332947492599487
Epoch: 29, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.491 Vali Acc: 0.350 Test Loss: 2.491 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 1.4567777
	speed: 0.1057s/iter; left time: 1145.2647s
Epoch: 30 cost time: 4.316198110580444
Epoch: 30, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.408 Vali Acc: 0.355 Test Loss: 2.408 Test Acc: 0.355
Validation loss decreased (-0.353991 --> -0.354802).  Saving model ...
	iters: 100, epoch: 31 | loss: 1.6312226
	speed: 0.1092s/iter; left time: 1166.8744s
Epoch: 31 cost time: 4.495672702789307
Epoch: 31, Steps: 154 | Train Loss: 1.675 Vali Loss: 2.715 Vali Acc: 0.351 Test Loss: 2.715 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 1.6163956
	speed: 0.1007s/iter; left time: 1060.2812s
Epoch: 32 cost time: 4.415701389312744
Epoch: 32, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.535 Vali Acc: 0.349 Test Loss: 2.535 Test Acc: 0.349
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 1.5269513
	speed: 0.1086s/iter; left time: 1126.9704s
Epoch: 33 cost time: 4.386645078659058
Epoch: 33, Steps: 154 | Train Loss: 1.479 Vali Loss: 2.545 Vali Acc: 0.353 Test Loss: 2.545 Test Acc: 0.353
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 1.0167708
	speed: 0.1079s/iter; left time: 1102.5191s
Epoch: 34 cost time: 4.185163259506226
Epoch: 34, Steps: 154 | Train Loss: 1.473 Vali Loss: 2.458 Vali Acc: 0.361 Test Loss: 2.458 Test Acc: 0.361
Validation loss decreased (-0.354802 --> -0.360478).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.3215984
	speed: 0.1101s/iter; left time: 1108.6367s
Epoch: 35 cost time: 4.20682692527771
Epoch: 35, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.540 Vali Acc: 0.222 Test Loss: 2.540 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 1.4205447
	speed: 0.1120s/iter; left time: 1110.3312s
Epoch: 36 cost time: 4.3418848514556885
Epoch: 36, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.577 Vali Acc: 0.361 Test Loss: 2.577 Test Acc: 0.361
Validation loss decreased (-0.360478 --> -0.360883).  Saving model ...
	iters: 100, epoch: 37 | loss: 1.3123349
	speed: 0.1104s/iter; left time: 1077.3497s
Epoch: 37 cost time: 4.271523714065552
Epoch: 37, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.697 Vali Acc: 0.359 Test Loss: 2.697 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 1.3453431
	speed: 0.1095s/iter; left time: 1051.5430s
Epoch: 38 cost time: 4.265422344207764
Epoch: 38, Steps: 154 | Train Loss: 1.473 Vali Loss: 2.610 Vali Acc: 0.358 Test Loss: 2.610 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.9762325
	speed: 0.1057s/iter; left time: 998.3227s
Epoch: 39 cost time: 4.240902900695801
Epoch: 39, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.595 Vali Acc: 0.363 Test Loss: 2.595 Test Acc: 0.363
Validation loss decreased (-0.360883 --> -0.363315).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.1407714
	speed: 0.1072s/iter; left time: 996.8231s
Epoch: 40 cost time: 4.279639720916748
Epoch: 40, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.662 Vali Acc: 0.375 Test Loss: 2.662 Test Acc: 0.375
Validation loss decreased (-0.363315 --> -0.374669).  Saving model ...
	iters: 100, epoch: 41 | loss: 1.5885162
	speed: 0.1045s/iter; left time: 955.0748s
Epoch: 41 cost time: 4.2411205768585205
Epoch: 41, Steps: 154 | Train Loss: 1.417 Vali Loss: 2.851 Vali Acc: 0.358 Test Loss: 2.851 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 1.2800680
	speed: 0.1070s/iter; left time: 961.9091s
Epoch: 42 cost time: 4.244936227798462
Epoch: 42, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.919 Vali Acc: 0.365 Test Loss: 2.919 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 1.3943806
	speed: 0.1059s/iter; left time: 935.1402s
Epoch: 43 cost time: 4.209307432174683
Epoch: 43, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.638 Vali Acc: 0.363 Test Loss: 2.638 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 1.4549159
	speed: 0.1108s/iter; left time: 962.0063s
Epoch: 44 cost time: 4.37904953956604
Epoch: 44, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.821 Vali Acc: 0.359 Test Loss: 2.821 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 1.4320291
	speed: 0.1078s/iter; left time: 919.0159s
Epoch: 45 cost time: 4.0683815479278564
Epoch: 45, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.794 Vali Acc: 0.367 Test Loss: 2.794 Test Acc: 0.367
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 1.1662154
	speed: 0.1116s/iter; left time: 934.4804s
Epoch: 46 cost time: 4.137468099594116
Epoch: 46, Steps: 154 | Train Loss: 1.376 Vali Loss: 2.757 Vali Acc: 0.364 Test Loss: 2.757 Test Acc: 0.364
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.9195592
	speed: 0.1074s/iter; left time: 882.4958s
Epoch: 47 cost time: 4.2850542068481445
Epoch: 47, Steps: 154 | Train Loss: 1.388 Vali Loss: 2.883 Vali Acc: 0.367 Test Loss: 2.883 Test Acc: 0.367
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.6860709
	speed: 0.1092s/iter; left time: 880.4872s
Epoch: 48 cost time: 4.323182582855225
Epoch: 48, Steps: 154 | Train Loss: 1.388 Vali Loss: 2.989 Vali Acc: 0.365 Test Loss: 2.989 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 1.0496429
	speed: 0.1079s/iter; left time: 853.0545s
Epoch: 49 cost time: 4.262416362762451
Epoch: 49, Steps: 154 | Train Loss: 1.477 Vali Loss: 3.099 Vali Acc: 0.375 Test Loss: 3.099 Test Acc: 0.375
Validation loss decreased (-0.374669 --> -0.375070).  Saving model ...
	iters: 100, epoch: 50 | loss: 2.6580334
	speed: 0.1107s/iter; left time: 858.6717s
Epoch: 50 cost time: 4.622754096984863
Epoch: 50, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.880 Vali Acc: 0.367 Test Loss: 2.880 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 51 | loss: 1.6432768
	speed: 0.1103s/iter; left time: 838.4425s
Epoch: 51 cost time: 4.38356876373291
Epoch: 51, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.738 Vali Acc: 0.372 Test Loss: 2.738 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 52 | loss: 1.2593918
	speed: 0.1085s/iter; left time: 808.2476s
Epoch: 52 cost time: 4.112913131713867
Epoch: 52, Steps: 154 | Train Loss: 1.354 Vali Loss: 2.736 Vali Acc: 0.369 Test Loss: 2.736 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 53 | loss: 1.4255176
	speed: 0.1118s/iter; left time: 815.2454s
Epoch: 53 cost time: 4.213586807250977
Epoch: 53, Steps: 154 | Train Loss: 1.348 Vali Loss: 2.663 Vali Acc: 0.379 Test Loss: 2.663 Test Acc: 0.379
Validation loss decreased (-0.375070 --> -0.379130).  Saving model ...
	iters: 100, epoch: 54 | loss: 1.6874024
	speed: 0.1073s/iter; left time: 766.3397s
Epoch: 54 cost time: 4.115089178085327
Epoch: 54, Steps: 154 | Train Loss: 1.345 Vali Loss: 2.927 Vali Acc: 0.378 Test Loss: 2.927 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 55 | loss: 1.4864464
	speed: 0.1079s/iter; left time: 753.8143s
Epoch: 55 cost time: 4.233291864395142
Epoch: 55, Steps: 154 | Train Loss: 1.316 Vali Loss: 3.076 Vali Acc: 0.369 Test Loss: 3.076 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 56 | loss: 1.4099818
	speed: 0.1068s/iter; left time: 729.8363s
Epoch: 56 cost time: 3.9528391361236572
Epoch: 56, Steps: 154 | Train Loss: 1.327 Vali Loss: 3.135 Vali Acc: 0.324 Test Loss: 3.135 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 57 | loss: 1.4504790
	speed: 0.1052s/iter; left time: 702.4080s
Epoch: 57 cost time: 4.213153123855591
Epoch: 57, Steps: 154 | Train Loss: 1.367 Vali Loss: 2.837 Vali Acc: 0.256 Test Loss: 2.837 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 58 | loss: 1.2360510
	speed: 0.1039s/iter; left time: 677.8975s
Epoch: 58 cost time: 4.156129837036133
Epoch: 58, Steps: 154 | Train Loss: 1.427 Vali Loss: 2.918 Vali Acc: 0.380 Test Loss: 2.918 Test Acc: 0.380
Validation loss decreased (-0.379130 --> -0.380344).  Saving model ...
	iters: 100, epoch: 59 | loss: 1.7945712
	speed: 0.1065s/iter; left time: 678.5877s
Epoch: 59 cost time: 4.164153575897217
Epoch: 59, Steps: 154 | Train Loss: 1.328 Vali Loss: 2.928 Vali Acc: 0.376 Test Loss: 2.928 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 60 | loss: 1.3496659
	speed: 0.1028s/iter; left time: 639.0568s
Epoch: 60 cost time: 4.078728199005127
Epoch: 60, Steps: 154 | Train Loss: 1.291 Vali Loss: 2.892 Vali Acc: 0.378 Test Loss: 2.892 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 61 | loss: 1.0060483
	speed: 0.1058s/iter; left time: 641.2192s
Epoch: 61 cost time: 4.043988227844238
Epoch: 61, Steps: 154 | Train Loss: 1.255 Vali Loss: 2.815 Vali Acc: 0.371 Test Loss: 2.815 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 62 | loss: 1.2438668
	speed: 0.1073s/iter; left time: 633.8755s
Epoch: 62 cost time: 4.180502891540527
Epoch: 62, Steps: 154 | Train Loss: 1.237 Vali Loss: 2.883 Vali Acc: 0.379 Test Loss: 2.883 Test Acc: 0.379
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 63 | loss: 0.8646308
	speed: 0.1088s/iter; left time: 626.1928s
Epoch: 63 cost time: 4.145882844924927
Epoch: 63, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.744 Vali Acc: 0.376 Test Loss: 2.744 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 64 | loss: 1.1529580
	speed: 0.1109s/iter; left time: 621.2023s
Epoch: 64 cost time: 4.378032445907593
Epoch: 64, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.950 Vali Acc: 0.378 Test Loss: 2.950 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 65 | loss: 0.8246369
	speed: 0.1153s/iter; left time: 627.8559s
Epoch: 65 cost time: 4.211114406585693
Epoch: 65, Steps: 154 | Train Loss: 1.239 Vali Loss: 3.073 Vali Acc: 0.374 Test Loss: 3.073 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 66 | loss: 1.1039956
	speed: 0.1092s/iter; left time: 578.0038s
Epoch: 66 cost time: 4.329991340637207
Epoch: 66, Steps: 154 | Train Loss: 1.352 Vali Loss: 3.211 Vali Acc: 0.383 Test Loss: 3.211 Test Acc: 0.383
Validation loss decreased (-0.380344 --> -0.383180).  Saving model ...
	iters: 100, epoch: 67 | loss: 0.8673857
	speed: 0.1036s/iter; left time: 532.1100s
Epoch: 67 cost time: 4.20179009437561
Epoch: 67, Steps: 154 | Train Loss: 1.308 Vali Loss: 3.159 Vali Acc: 0.388 Test Loss: 3.159 Test Acc: 0.388
Validation loss decreased (-0.383180 --> -0.388452).  Saving model ...
	iters: 100, epoch: 68 | loss: 1.1851615
	speed: 0.1100s/iter; left time: 548.2194s
Epoch: 68 cost time: 4.444710731506348
Epoch: 68, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.856 Vali Acc: 0.309 Test Loss: 2.856 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 69 | loss: 1.0873674
	speed: 0.1111s/iter; left time: 536.6476s
Epoch: 69 cost time: 4.301448583602905
Epoch: 69, Steps: 154 | Train Loss: 1.275 Vali Loss: 2.825 Vali Acc: 0.378 Test Loss: 2.825 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 70 | loss: 0.8268842
	speed: 0.1105s/iter; left time: 516.3761s
Epoch: 70 cost time: 4.292632818222046
Epoch: 70, Steps: 154 | Train Loss: 1.256 Vali Loss: 3.026 Vali Acc: 0.359 Test Loss: 3.026 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 71 | loss: 1.0058240
	speed: 0.1092s/iter; left time: 493.5471s
Epoch: 71 cost time: 4.269987344741821
Epoch: 71, Steps: 154 | Train Loss: 1.289 Vali Loss: 2.882 Vali Acc: 0.382 Test Loss: 2.882 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 72 | loss: 0.7709669
	speed: 0.1082s/iter; left time: 472.5572s
Epoch: 72 cost time: 4.014112949371338
Epoch: 72, Steps: 154 | Train Loss: 1.296 Vali Loss: 2.959 Vali Acc: 0.378 Test Loss: 2.959 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 73 | loss: 2.0472910
	speed: 0.1059s/iter; left time: 446.2360s
Epoch: 73 cost time: 4.331085681915283
Epoch: 73, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.760 Vali Acc: 0.387 Test Loss: 2.760 Test Acc: 0.387
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 74 | loss: 1.0874017
	speed: 0.1083s/iter; left time: 439.5465s
Epoch: 74 cost time: 4.06773567199707
Epoch: 74, Steps: 154 | Train Loss: 1.275 Vali Loss: 2.937 Vali Acc: 0.378 Test Loss: 2.937 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 75 | loss: 0.9670552
	speed: 0.1059s/iter; left time: 413.3530s
Epoch: 75 cost time: 4.227725028991699
Epoch: 75, Steps: 154 | Train Loss: 1.217 Vali Loss: 3.076 Vali Acc: 0.382 Test Loss: 3.076 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 76 | loss: 1.2368417
	speed: 0.1051s/iter; left time: 394.1762s
Epoch: 76 cost time: 4.525313854217529
Epoch: 76, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.858 Vali Acc: 0.386 Test Loss: 2.858 Test Acc: 0.386
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 77 | loss: 1.0928222
	speed: 0.1077s/iter; left time: 387.2920s
Epoch: 77 cost time: 4.207558631896973
Epoch: 77, Steps: 154 | Train Loss: 1.313 Vali Loss: 3.020 Vali Acc: 0.374 Test Loss: 3.020 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3884833738848337
model parameter : 35958
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8992665
	speed: 0.0406s/iter; left time: 621.3716s
Epoch: 1 cost time: 5.311508655548096
Epoch: 1, Steps: 154 | Train Loss: 2.307 Vali Loss: 2.145 Vali Acc: 0.315 Test Loss: 2.145 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8822578
	speed: 0.1010s/iter; left time: 1530.5804s
Epoch: 2 cost time: 3.9520444869995117
Epoch: 2, Steps: 154 | Train Loss: 2.074 Vali Loss: 2.130 Vali Acc: 0.316 Test Loss: 2.130 Test Acc: 0.316
Validation loss decreased (-0.315064 --> -0.316280).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2512918
	speed: 0.1004s/iter; left time: 1504.7738s
Epoch: 3 cost time: 3.810925006866455
Epoch: 3, Steps: 154 | Train Loss: 2.038 Vali Loss: 2.143 Vali Acc: 0.318 Test Loss: 2.143 Test Acc: 0.318
Validation loss decreased (-0.316280 --> -0.317497).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8916001
	speed: 0.0987s/iter; left time: 1464.5844s
Epoch: 4 cost time: 3.821174383163452
Epoch: 4, Steps: 154 | Train Loss: 1.996 Vali Loss: 2.130 Vali Acc: 0.318 Test Loss: 2.130 Test Acc: 0.318
Validation loss decreased (-0.317497 --> -0.317497).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8226722
	speed: 0.0967s/iter; left time: 1420.1076s
Epoch: 5 cost time: 3.941580057144165
Epoch: 5, Steps: 154 | Train Loss: 1.982 Vali Loss: 2.137 Vali Acc: 0.318 Test Loss: 2.137 Test Acc: 0.318
Validation loss decreased (-0.317497 --> -0.318308).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3062749
	speed: 0.1048s/iter; left time: 1523.4391s
Epoch: 6 cost time: 4.228684186935425
Epoch: 6, Steps: 154 | Train Loss: 1.946 Vali Loss: 2.131 Vali Acc: 0.319 Test Loss: 2.131 Test Acc: 0.319
Validation loss decreased (-0.318308 --> -0.318713).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0849392
	speed: 0.1070s/iter; left time: 1537.8990s
Epoch: 7 cost time: 4.381763935089111
Epoch: 7, Steps: 154 | Train Loss: 1.918 Vali Loss: 2.122 Vali Acc: 0.322 Test Loss: 2.122 Test Acc: 0.322
Validation loss decreased (-0.318713 --> -0.322363).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7982382
	speed: 0.1055s/iter; left time: 1500.8754s
Epoch: 8 cost time: 4.2250730991363525
Epoch: 8, Steps: 154 | Train Loss: 1.891 Vali Loss: 2.119 Vali Acc: 0.324 Test Loss: 2.119 Test Acc: 0.324
Validation loss decreased (-0.322363 --> -0.324391).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8075184
	speed: 0.1081s/iter; left time: 1520.2273s
Epoch: 9 cost time: 4.277871370315552
Epoch: 9, Steps: 154 | Train Loss: 1.878 Vali Loss: 2.119 Vali Acc: 0.324 Test Loss: 2.119 Test Acc: 0.324
Validation loss decreased (-0.324391 --> -0.324391).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6517620
	speed: 0.1065s/iter; left time: 1481.7396s
Epoch: 10 cost time: 4.171248912811279
Epoch: 10, Steps: 154 | Train Loss: 1.847 Vali Loss: 2.135 Vali Acc: 0.327 Test Loss: 2.135 Test Acc: 0.327
Validation loss decreased (-0.324391 --> -0.326824).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6109047
	speed: 0.1066s/iter; left time: 1466.3354s
Epoch: 11 cost time: 4.214003801345825
Epoch: 11, Steps: 154 | Train Loss: 1.819 Vali Loss: 2.112 Vali Acc: 0.331 Test Loss: 2.112 Test Acc: 0.331
Validation loss decreased (-0.326824 --> -0.330879).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7454222
	speed: 0.1031s/iter; left time: 1402.2602s
Epoch: 12 cost time: 4.19783878326416
Epoch: 12, Steps: 154 | Train Loss: 1.805 Vali Loss: 2.167 Vali Acc: 0.326 Test Loss: 2.167 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6825997
	speed: 0.1066s/iter; left time: 1433.4507s
Epoch: 13 cost time: 4.201986789703369
Epoch: 13, Steps: 154 | Train Loss: 1.808 Vali Loss: 2.175 Vali Acc: 0.330 Test Loss: 2.175 Test Acc: 0.330
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.1080270
	speed: 0.1115s/iter; left time: 1483.3863s
Epoch: 14 cost time: 4.283241510391235
Epoch: 14, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.124 Vali Acc: 0.335 Test Loss: 2.124 Test Acc: 0.335
Validation loss decreased (-0.330879 --> -0.334934).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.9562842
	speed: 0.1079s/iter; left time: 1418.1052s
Epoch: 15 cost time: 4.163085222244263
Epoch: 15, Steps: 154 | Train Loss: 1.728 Vali Loss: 2.195 Vali Acc: 0.336 Test Loss: 2.195 Test Acc: 0.336
Validation loss decreased (-0.334934 --> -0.335744).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4865334
	speed: 0.1059s/iter; left time: 1375.2809s
Epoch: 16 cost time: 4.202782869338989
Epoch: 16, Steps: 154 | Train Loss: 1.745 Vali Loss: 2.208 Vali Acc: 0.334 Test Loss: 2.208 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.9095777
	speed: 0.1053s/iter; left time: 1352.3293s
Epoch: 17 cost time: 4.276871681213379
Epoch: 17, Steps: 154 | Train Loss: 1.721 Vali Loss: 2.214 Vali Acc: 0.336 Test Loss: 2.214 Test Acc: 0.336
Validation loss decreased (-0.335744 --> -0.336150).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.8579723
	speed: 0.1064s/iter; left time: 1349.8200s
Epoch: 18 cost time: 4.261536598205566
Epoch: 18, Steps: 154 | Train Loss: 1.716 Vali Loss: 2.237 Vali Acc: 0.342 Test Loss: 2.237 Test Acc: 0.342
Validation loss decreased (-0.336150 --> -0.341827).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.6842629
	speed: 0.1052s/iter; left time: 1317.7360s
Epoch: 19 cost time: 4.162738800048828
Epoch: 19, Steps: 154 | Train Loss: 1.709 Vali Loss: 2.219 Vali Acc: 0.345 Test Loss: 2.219 Test Acc: 0.345
Validation loss decreased (-0.341827 --> -0.345477).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.2322853
	speed: 0.1083s/iter; left time: 1340.2281s
Epoch: 20 cost time: 4.2979700565338135
Epoch: 20, Steps: 154 | Train Loss: 1.678 Vali Loss: 2.266 Vali Acc: 0.348 Test Loss: 2.266 Test Acc: 0.348
Validation loss decreased (-0.345477 --> -0.348315).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.8276715
	speed: 0.1087s/iter; left time: 1328.2815s
Epoch: 21 cost time: 4.261587619781494
Epoch: 21, Steps: 154 | Train Loss: 1.728 Vali Loss: 2.297 Vali Acc: 0.345 Test Loss: 2.297 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.3004264
	speed: 0.1058s/iter; left time: 1276.6210s
Epoch: 22 cost time: 4.224750280380249
Epoch: 22, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.307 Vali Acc: 0.345 Test Loss: 2.307 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.6710514
	speed: 0.1135s/iter; left time: 1351.7777s
Epoch: 23 cost time: 4.237519264221191
Epoch: 23, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.354 Vali Acc: 0.346 Test Loss: 2.354 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.4401140
	speed: 0.0978s/iter; left time: 1149.4855s
Epoch: 24 cost time: 4.19351601600647
Epoch: 24, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.374 Vali Acc: 0.355 Test Loss: 2.374 Test Acc: 0.355
Validation loss decreased (-0.348315 --> -0.354802).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.8336754
	speed: 0.1004s/iter; left time: 1164.9325s
Epoch: 25 cost time: 3.970534563064575
Epoch: 25, Steps: 154 | Train Loss: 1.699 Vali Loss: 2.384 Vali Acc: 0.352 Test Loss: 2.384 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 2.2968075
	speed: 0.1021s/iter; left time: 1168.9920s
Epoch: 26 cost time: 4.106299877166748
Epoch: 26, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.449 Vali Acc: 0.352 Test Loss: 2.449 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.4147722
	speed: 0.0979s/iter; left time: 1105.7870s
Epoch: 27 cost time: 3.782078266143799
Epoch: 27, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.408 Vali Acc: 0.350 Test Loss: 2.408 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.0365034
	speed: 0.0996s/iter; left time: 1110.1629s
Epoch: 28 cost time: 3.9536962509155273
Epoch: 28, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.370 Vali Acc: 0.355 Test Loss: 2.370 Test Acc: 0.355
Validation loss decreased (-0.354802 --> -0.354802).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.2770610
	speed: 0.1034s/iter; left time: 1136.3650s
Epoch: 29 cost time: 4.063047885894775
Epoch: 29, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.516 Vali Acc: 0.346 Test Loss: 2.516 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.4917929
	speed: 0.1090s/iter; left time: 1181.1753s
Epoch: 30 cost time: 4.190481662750244
Epoch: 30, Steps: 154 | Train Loss: 1.631 Vali Loss: 2.457 Vali Acc: 0.351 Test Loss: 2.457 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 2.1831932
	speed: 0.1085s/iter; left time: 1158.6287s
Epoch: 31 cost time: 4.204672574996948
Epoch: 31, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.444 Vali Acc: 0.358 Test Loss: 2.444 Test Acc: 0.358
Validation loss decreased (-0.354802 --> -0.357640).  Saving model ...
	iters: 100, epoch: 32 | loss: 2.4532719
	speed: 0.1025s/iter; left time: 1079.4139s
Epoch: 32 cost time: 3.937751531600952
Epoch: 32, Steps: 154 | Train Loss: 1.498 Vali Loss: 2.465 Vali Acc: 0.349 Test Loss: 2.465 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 1.6287739
	speed: 0.1110s/iter; left time: 1151.7549s
Epoch: 33 cost time: 4.316835403442383
Epoch: 33, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.333 Vali Acc: 0.356 Test Loss: 2.333 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 1.0891937
	speed: 0.1034s/iter; left time: 1056.8643s
Epoch: 34 cost time: 4.226004600524902
Epoch: 34, Steps: 154 | Train Loss: 1.443 Vali Loss: 2.457 Vali Acc: 0.364 Test Loss: 2.457 Test Acc: 0.364
Validation loss decreased (-0.357640 --> -0.364128).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.2533271
	speed: 0.1062s/iter; left time: 1068.4861s
Epoch: 35 cost time: 4.217168807983398
Epoch: 35, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.471 Vali Acc: 0.359 Test Loss: 2.471 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 1.2642692
	speed: 0.1075s/iter; left time: 1065.8599s
Epoch: 36 cost time: 4.426637887954712
Epoch: 36, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.460 Vali Acc: 0.362 Test Loss: 2.460 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 1.2434498
	speed: 0.1066s/iter; left time: 1039.9832s
Epoch: 37 cost time: 4.274280548095703
Epoch: 37, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.487 Vali Acc: 0.360 Test Loss: 2.487 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 2.3785501
	speed: 0.1044s/iter; left time: 1002.1139s
Epoch: 38 cost time: 4.348864316940308
Epoch: 38, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.548 Vali Acc: 0.358 Test Loss: 2.548 Test Acc: 0.358
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 1.5273908
	speed: 0.1099s/iter; left time: 1038.5037s
Epoch: 39 cost time: 4.29615044593811
Epoch: 39, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.549 Vali Acc: 0.368 Test Loss: 2.549 Test Acc: 0.368
Validation loss decreased (-0.364128 --> -0.368182).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.0576975
	speed: 0.1074s/iter; left time: 997.8340s
Epoch: 40 cost time: 4.1375415325164795
Epoch: 40, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.520 Vali Acc: 0.369 Test Loss: 2.520 Test Acc: 0.369
Validation loss decreased (-0.368182 --> -0.369399).  Saving model ...
	iters: 100, epoch: 41 | loss: 1.3654562
	speed: 0.1081s/iter; left time: 988.4917s
Epoch: 41 cost time: 4.300581216812134
Epoch: 41, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.604 Vali Acc: 0.358 Test Loss: 2.604 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 1.3487751
	speed: 0.1116s/iter; left time: 1002.5462s
Epoch: 42 cost time: 4.197052001953125
Epoch: 42, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.504 Vali Acc: 0.364 Test Loss: 2.504 Test Acc: 0.364
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 1.4616233
	speed: 0.1062s/iter; left time: 937.7666s
Epoch: 43 cost time: 4.391621112823486
Epoch: 43, Steps: 154 | Train Loss: 1.585 Vali Loss: 2.536 Vali Acc: 0.372 Test Loss: 2.536 Test Acc: 0.372
Validation loss decreased (-0.369399 --> -0.372237).  Saving model ...
	iters: 100, epoch: 44 | loss: 1.4652593
	speed: 0.1086s/iter; left time: 942.5270s
Epoch: 44 cost time: 4.066691875457764
Epoch: 44, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.549 Vali Acc: 0.361 Test Loss: 2.549 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 2.1644881
	speed: 0.1045s/iter; left time: 890.5627s
Epoch: 45 cost time: 4.123133897781372
Epoch: 45, Steps: 154 | Train Loss: 1.356 Vali Loss: 2.548 Vali Acc: 0.366 Test Loss: 2.548 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 1.1187912
	speed: 0.1040s/iter; left time: 870.6646s
Epoch: 46 cost time: 4.264011859893799
Epoch: 46, Steps: 154 | Train Loss: 1.401 Vali Loss: 2.584 Vali Acc: 0.365 Test Loss: 2.584 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 47 | loss: 0.9567685
	speed: 0.1064s/iter; left time: 874.5546s
Epoch: 47 cost time: 4.050149440765381
Epoch: 47, Steps: 154 | Train Loss: 1.356 Vali Loss: 2.633 Vali Acc: 0.369 Test Loss: 2.633 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 48 | loss: 0.9191651
	speed: 0.1053s/iter; left time: 849.3019s
Epoch: 48 cost time: 3.9137771129608154
Epoch: 48, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.672 Vali Acc: 0.367 Test Loss: 2.672 Test Acc: 0.367
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 49 | loss: 1.0555550
	speed: 0.1066s/iter; left time: 842.8665s
Epoch: 49 cost time: 4.088424205780029
Epoch: 49, Steps: 154 | Train Loss: 1.417 Vali Loss: 2.886 Vali Acc: 0.367 Test Loss: 2.886 Test Acc: 0.367
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 50 | loss: 1.1907736
	speed: 0.1090s/iter; left time: 845.3506s
Epoch: 50 cost time: 4.179273366928101
Epoch: 50, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.602 Vali Acc: 0.367 Test Loss: 2.602 Test Acc: 0.367
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 51 | loss: 1.9138672
	speed: 0.1076s/iter; left time: 818.2032s
Epoch: 51 cost time: 4.012211799621582
Epoch: 51, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.863 Vali Acc: 0.368 Test Loss: 2.863 Test Acc: 0.368
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 52 | loss: 1.2028630
	speed: 0.1045s/iter; left time: 778.1081s
Epoch: 52 cost time: 4.257081031799316
Epoch: 52, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.646 Vali Acc: 0.369 Test Loss: 2.646 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 53 | loss: 1.6203579
	speed: 0.1060s/iter; left time: 773.0217s
Epoch: 53 cost time: 4.15142560005188
Epoch: 53, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.564 Vali Acc: 0.373 Test Loss: 2.564 Test Acc: 0.373
Validation loss decreased (-0.372237 --> -0.373048).  Saving model ...
	iters: 100, epoch: 54 | loss: 2.0324309
	speed: 0.1032s/iter; left time: 736.8621s
Epoch: 54 cost time: 4.077611207962036
Epoch: 54, Steps: 154 | Train Loss: 1.392 Vali Loss: 2.640 Vali Acc: 0.375 Test Loss: 2.640 Test Acc: 0.375
Validation loss decreased (-0.373048 --> -0.374669).  Saving model ...
	iters: 100, epoch: 55 | loss: 1.6972911
	speed: 0.1058s/iter; left time: 739.0787s
Epoch: 55 cost time: 4.343925714492798
Epoch: 55, Steps: 154 | Train Loss: 1.329 Vali Loss: 2.765 Vali Acc: 0.366 Test Loss: 2.765 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 56 | loss: 2.2087386
	speed: 0.1052s/iter; left time: 718.3625s
Epoch: 56 cost time: 4.159605503082275
Epoch: 56, Steps: 154 | Train Loss: 1.445 Vali Loss: 2.927 Vali Acc: 0.372 Test Loss: 2.927 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 57 | loss: 1.1638774
	speed: 0.1023s/iter; left time: 682.8924s
Epoch: 57 cost time: 4.233021020889282
Epoch: 57, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.721 Vali Acc: 0.380 Test Loss: 2.721 Test Acc: 0.380
Validation loss decreased (-0.374669 --> -0.379535).  Saving model ...
	iters: 100, epoch: 58 | loss: 1.2676872
	speed: 0.1121s/iter; left time: 730.9714s
Epoch: 58 cost time: 4.285711288452148
Epoch: 58, Steps: 154 | Train Loss: 1.317 Vali Loss: 2.804 Vali Acc: 0.371 Test Loss: 2.804 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 59 | loss: 1.8642124
	speed: 0.1124s/iter; left time: 715.6088s
Epoch: 59 cost time: 4.180876970291138
Epoch: 59, Steps: 154 | Train Loss: 1.399 Vali Loss: 2.799 Vali Acc: 0.370 Test Loss: 2.799 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 60 | loss: 1.4422686
	speed: 0.1077s/iter; left time: 669.0984s
Epoch: 60 cost time: 4.144955396652222
Epoch: 60, Steps: 154 | Train Loss: 1.336 Vali Loss: 2.654 Vali Acc: 0.379 Test Loss: 2.654 Test Acc: 0.379
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 61 | loss: 1.0300530
	speed: 0.1046s/iter; left time: 633.7940s
Epoch: 61 cost time: 4.082557678222656
Epoch: 61, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.896 Vali Acc: 0.369 Test Loss: 2.896 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 62 | loss: 1.6207626
	speed: 0.1038s/iter; left time: 613.1604s
Epoch: 62 cost time: 4.0567052364349365
Epoch: 62, Steps: 154 | Train Loss: 1.321 Vali Loss: 2.693 Vali Acc: 0.382 Test Loss: 2.693 Test Acc: 0.382
Validation loss decreased (-0.379535 --> -0.381968).  Saving model ...
	iters: 100, epoch: 63 | loss: 0.9647776
	speed: 0.1038s/iter; left time: 597.3665s
Epoch: 63 cost time: 4.198018789291382
Epoch: 63, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.858 Vali Acc: 0.379 Test Loss: 2.858 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 64 | loss: 1.1916029
	speed: 0.1044s/iter; left time: 584.5758s
Epoch: 64 cost time: 4.157790899276733
Epoch: 64, Steps: 154 | Train Loss: 1.401 Vali Loss: 2.986 Vali Acc: 0.373 Test Loss: 2.986 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 65 | loss: 0.9251613
	speed: 0.1043s/iter; left time: 567.8670s
Epoch: 65 cost time: 4.075112581253052
Epoch: 65, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.968 Vali Acc: 0.369 Test Loss: 2.968 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 66 | loss: 1.1789060
	speed: 0.1056s/iter; left time: 558.7353s
Epoch: 66 cost time: 4.133325099945068
Epoch: 66, Steps: 154 | Train Loss: 1.390 Vali Loss: 2.925 Vali Acc: 0.375 Test Loss: 2.925 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 67 | loss: 0.9772548
	speed: 0.1080s/iter; left time: 554.9513s
Epoch: 67 cost time: 4.203273296356201
Epoch: 67, Steps: 154 | Train Loss: 1.355 Vali Loss: 3.332 Vali Acc: 0.375 Test Loss: 3.332 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 68 | loss: 0.9984156
	speed: 0.1017s/iter; left time: 506.7641s
Epoch: 68 cost time: 4.107835531234741
Epoch: 68, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.914 Vali Acc: 0.378 Test Loss: 2.914 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 69 | loss: 1.5520858
	speed: 0.1073s/iter; left time: 518.1513s
Epoch: 69 cost time: 4.235722303390503
Epoch: 69, Steps: 154 | Train Loss: 1.402 Vali Loss: 3.003 Vali Acc: 0.373 Test Loss: 3.003 Test Acc: 0.373
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 70 | loss: 0.7659013
	speed: 0.1034s/iter; left time: 483.1681s
Epoch: 70 cost time: 4.354194641113281
Epoch: 70, Steps: 154 | Train Loss: 1.316 Vali Loss: 3.040 Vali Acc: 0.390 Test Loss: 3.040 Test Acc: 0.390
Validation loss decreased (-0.381968 --> -0.389670).  Saving model ...
	iters: 100, epoch: 71 | loss: 0.9674591
	speed: 0.1062s/iter; left time: 480.2648s
Epoch: 71 cost time: 4.029562711715698
Epoch: 71, Steps: 154 | Train Loss: 1.409 Vali Loss: 3.104 Vali Acc: 0.375 Test Loss: 3.104 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 72 | loss: 0.7536507
	speed: 0.1088s/iter; left time: 475.1211s
Epoch: 72 cost time: 4.524651527404785
Epoch: 72, Steps: 154 | Train Loss: 1.517 Vali Loss: 3.086 Vali Acc: 0.376 Test Loss: 3.086 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 73 | loss: 1.4509186
	speed: 0.1085s/iter; left time: 456.9899s
Epoch: 73 cost time: 4.249393939971924
Epoch: 73, Steps: 154 | Train Loss: 1.379 Vali Loss: 2.868 Vali Acc: 0.377 Test Loss: 2.868 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 74 | loss: 0.9461356
	speed: 0.1073s/iter; left time: 435.5780s
Epoch: 74 cost time: 4.246651649475098
Epoch: 74, Steps: 154 | Train Loss: 1.280 Vali Loss: 3.074 Vali Acc: 0.370 Test Loss: 3.074 Test Acc: 0.370
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 75 | loss: 0.9956390
	speed: 0.1068s/iter; left time: 416.8830s
Epoch: 75 cost time: 4.134957551956177
Epoch: 75, Steps: 154 | Train Loss: 1.307 Vali Loss: 3.117 Vali Acc: 0.369 Test Loss: 3.117 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 76 | loss: 1.5207844
	speed: 0.1092s/iter; left time: 409.4557s
Epoch: 76 cost time: 4.1323182582855225
Epoch: 76, Steps: 154 | Train Loss: 1.522 Vali Loss: 3.112 Vali Acc: 0.371 Test Loss: 3.112 Test Acc: 0.371
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 77 | loss: 1.1208748
	speed: 0.1064s/iter; left time: 382.8605s
Epoch: 77 cost time: 4.1159491539001465
Epoch: 77, Steps: 154 | Train Loss: 1.243 Vali Loss: 2.933 Vali Acc: 0.371 Test Loss: 2.933 Test Acc: 0.371
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 78 | loss: 1.5348681
	speed: 0.1112s/iter; left time: 382.9089s
Epoch: 78 cost time: 4.143767356872559
Epoch: 78, Steps: 154 | Train Loss: 1.247 Vali Loss: 3.133 Vali Acc: 0.384 Test Loss: 3.133 Test Acc: 0.384
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 79 | loss: 0.9608455
	speed: 0.1053s/iter; left time: 346.2903s
Epoch: 79 cost time: 4.1346657276153564
Epoch: 79, Steps: 154 | Train Loss: 1.334 Vali Loss: 3.157 Vali Acc: 0.384 Test Loss: 3.157 Test Acc: 0.384
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 80 | loss: 0.7187154
	speed: 0.1035s/iter; left time: 324.5373s
Epoch: 80 cost time: 4.146020412445068
Epoch: 80, Steps: 154 | Train Loss: 1.227 Vali Loss: 3.112 Vali Acc: 0.376 Test Loss: 3.112 Test Acc: 0.376
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3896999188969992
model parameter : 35958
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0694051
	speed: 0.0427s/iter; left time: 653.3322s
Epoch: 1 cost time: 5.554811954498291
Epoch: 1, Steps: 154 | Train Loss: 2.321 Vali Loss: 2.183 Vali Acc: 0.315 Test Loss: 2.183 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1101756
	speed: 0.1024s/iter; left time: 1551.5835s
Epoch: 2 cost time: 4.029737949371338
Epoch: 2, Steps: 154 | Train Loss: 2.096 Vali Loss: 2.151 Vali Acc: 0.317 Test Loss: 2.151 Test Acc: 0.317
Validation loss decreased (-0.315469 --> -0.316686).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9487009
	speed: 0.1020s/iter; left time: 1528.5501s
Epoch: 3 cost time: 3.9687294960021973
Epoch: 3, Steps: 154 | Train Loss: 2.059 Vali Loss: 2.157 Vali Acc: 0.318 Test Loss: 2.157 Test Acc: 0.318
Validation loss decreased (-0.316686 --> -0.317497).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2423108
	speed: 0.1026s/iter; left time: 1522.0629s
Epoch: 4 cost time: 4.1177284717559814
Epoch: 4, Steps: 154 | Train Loss: 1.999 Vali Loss: 2.141 Vali Acc: 0.319 Test Loss: 2.141 Test Acc: 0.319
Validation loss decreased (-0.317497 --> -0.319119).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8529868
	speed: 0.1033s/iter; left time: 1516.7346s
Epoch: 5 cost time: 3.915652275085449
Epoch: 5, Steps: 154 | Train Loss: 1.982 Vali Loss: 2.155 Vali Acc: 0.321 Test Loss: 2.155 Test Acc: 0.321
Validation loss decreased (-0.319119 --> -0.321146).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8106242
	speed: 0.1005s/iter; left time: 1459.8504s
Epoch: 6 cost time: 3.967611789703369
Epoch: 6, Steps: 154 | Train Loss: 1.932 Vali Loss: 2.159 Vali Acc: 0.319 Test Loss: 2.159 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5426364
	speed: 0.1026s/iter; left time: 1475.2045s
Epoch: 7 cost time: 3.926574230194092
Epoch: 7, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.139 Vali Acc: 0.326 Test Loss: 2.139 Test Acc: 0.326
Validation loss decreased (-0.321146 --> -0.325607).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8668898
	speed: 0.1003s/iter; left time: 1426.6732s
Epoch: 8 cost time: 4.255204916000366
Epoch: 8, Steps: 154 | Train Loss: 1.879 Vali Loss: 2.156 Vali Acc: 0.322 Test Loss: 2.156 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8308316
	speed: 0.1016s/iter; left time: 1429.6308s
Epoch: 9 cost time: 4.001973867416382
Epoch: 9, Steps: 154 | Train Loss: 1.875 Vali Loss: 2.166 Vali Acc: 0.324 Test Loss: 2.166 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4521616
	speed: 0.1008s/iter; left time: 1402.6879s
Epoch: 10 cost time: 4.030180215835571
Epoch: 10, Steps: 154 | Train Loss: 1.844 Vali Loss: 2.161 Vali Acc: 0.323 Test Loss: 2.161 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.7560836
	speed: 0.0968s/iter; left time: 1332.0172s
Epoch: 11 cost time: 4.27400279045105
Epoch: 11, Steps: 154 | Train Loss: 1.835 Vali Loss: 2.164 Vali Acc: 0.324 Test Loss: 2.164 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2238623
	speed: 0.1034s/iter; left time: 1406.4726s
Epoch: 12 cost time: 4.05572772026062
Epoch: 12, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.140 Vali Acc: 0.326 Test Loss: 2.140 Test Acc: 0.326
Validation loss decreased (-0.325607 --> -0.326013).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.8103176
	speed: 0.1031s/iter; left time: 1387.5841s
Epoch: 13 cost time: 3.957548141479492
Epoch: 13, Steps: 154 | Train Loss: 1.787 Vali Loss: 2.160 Vali Acc: 0.328 Test Loss: 2.160 Test Acc: 0.328
Validation loss decreased (-0.326013 --> -0.327635).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.0144639
	speed: 0.1054s/iter; left time: 1401.3672s
Epoch: 14 cost time: 4.358247995376587
Epoch: 14, Steps: 154 | Train Loss: 1.789 Vali Loss: 2.195 Vali Acc: 0.326 Test Loss: 2.195 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.0881736
	speed: 0.1046s/iter; left time: 1375.1021s
Epoch: 15 cost time: 4.181831121444702
Epoch: 15, Steps: 154 | Train Loss: 1.755 Vali Loss: 2.168 Vali Acc: 0.329 Test Loss: 2.168 Test Acc: 0.329
Validation loss decreased (-0.327635 --> -0.329256).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5841925
	speed: 0.1046s/iter; left time: 1358.8921s
Epoch: 16 cost time: 3.972989559173584
Epoch: 16, Steps: 154 | Train Loss: 1.723 Vali Loss: 2.196 Vali Acc: 0.333 Test Loss: 2.196 Test Acc: 0.333
Validation loss decreased (-0.329256 --> -0.333311).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.8358496
	speed: 0.1016s/iter; left time: 1303.7667s
Epoch: 17 cost time: 3.9251017570495605
Epoch: 17, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.169 Vali Acc: 0.334 Test Loss: 2.169 Test Acc: 0.334
Validation loss decreased (-0.333311 --> -0.334123).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.3547705
	speed: 0.1009s/iter; left time: 1279.4130s
Epoch: 18 cost time: 3.98073410987854
Epoch: 18, Steps: 154 | Train Loss: 1.699 Vali Loss: 2.185 Vali Acc: 0.332 Test Loss: 2.185 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.9684590
	speed: 0.0970s/iter; left time: 1215.6082s
Epoch: 19 cost time: 3.5745716094970703
Epoch: 19, Steps: 154 | Train Loss: 1.685 Vali Loss: 2.154 Vali Acc: 0.342 Test Loss: 2.154 Test Acc: 0.342
Validation loss decreased (-0.334123 --> -0.341828).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.8412309
	speed: 0.0925s/iter; left time: 1144.2081s
Epoch: 20 cost time: 3.805799961090088
Epoch: 20, Steps: 154 | Train Loss: 1.632 Vali Loss: 2.288 Vali Acc: 0.339 Test Loss: 2.288 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.5847160
	speed: 0.1001s/iter; left time: 1223.2207s
Epoch: 21 cost time: 3.9819705486297607
Epoch: 21, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.275 Vali Acc: 0.341 Test Loss: 2.275 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.4533292
	speed: 0.1002s/iter; left time: 1208.7676s
Epoch: 22 cost time: 4.068628787994385
Epoch: 22, Steps: 154 | Train Loss: 1.648 Vali Loss: 2.242 Vali Acc: 0.342 Test Loss: 2.242 Test Acc: 0.342
Validation loss decreased (-0.341828 --> -0.342232).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.6917922
	speed: 0.0987s/iter; left time: 1175.4143s
Epoch: 23 cost time: 4.100412607192993
Epoch: 23, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.271 Vali Acc: 0.347 Test Loss: 2.271 Test Acc: 0.347
Validation loss decreased (-0.342232 --> -0.346693).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.1705722
	speed: 0.1041s/iter; left time: 1224.0994s
Epoch: 24 cost time: 4.038396120071411
Epoch: 24, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.256 Vali Acc: 0.347 Test Loss: 2.256 Test Acc: 0.347
Validation loss decreased (-0.346693 --> -0.346693).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.4553733
	speed: 0.0999s/iter; left time: 1159.7086s
Epoch: 25 cost time: 4.197478532791138
Epoch: 25, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.232 Vali Acc: 0.350 Test Loss: 2.232 Test Acc: 0.350
Validation loss decreased (-0.346693 --> -0.349532).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.4137740
	speed: 0.1092s/iter; left time: 1251.0185s
Epoch: 26 cost time: 4.091123580932617
Epoch: 26, Steps: 154 | Train Loss: 1.581 Vali Loss: 2.266 Vali Acc: 0.349 Test Loss: 2.266 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.7986858
	speed: 0.1016s/iter; left time: 1147.5033s
Epoch: 27 cost time: 4.270241022109985
Epoch: 27, Steps: 154 | Train Loss: 1.581 Vali Loss: 2.316 Vali Acc: 0.357 Test Loss: 2.316 Test Acc: 0.357
Validation loss decreased (-0.349532 --> -0.356830).  Saving model ...
	iters: 100, epoch: 28 | loss: 2.1308992
	speed: 0.1018s/iter; left time: 1134.1512s
Epoch: 28 cost time: 4.116184949874878
Epoch: 28, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.331 Vali Acc: 0.348 Test Loss: 2.331 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.1799554
	speed: 0.1028s/iter; left time: 1130.0122s
Epoch: 29 cost time: 4.0487236976623535
Epoch: 29, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.407 Vali Acc: 0.347 Test Loss: 2.407 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 1.5594234
	speed: 0.1009s/iter; left time: 1093.5624s
Epoch: 30 cost time: 4.051748275756836
Epoch: 30, Steps: 154 | Train Loss: 1.542 Vali Loss: 2.289 Vali Acc: 0.355 Test Loss: 2.289 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 1.1811980
	speed: 0.1014s/iter; left time: 1082.5680s
Epoch: 31 cost time: 4.11758279800415
Epoch: 31, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.342 Vali Acc: 0.352 Test Loss: 2.342 Test Acc: 0.352
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 1.3683029
	speed: 0.1020s/iter; left time: 1074.1050s
Epoch: 32 cost time: 3.949606418609619
Epoch: 32, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.339 Vali Acc: 0.354 Test Loss: 2.339 Test Acc: 0.354
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.9273758
	speed: 0.1035s/iter; left time: 1074.0263s
Epoch: 33 cost time: 3.83807110786438
Epoch: 33, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.380 Vali Acc: 0.357 Test Loss: 2.380 Test Acc: 0.357
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 1.4187924
	speed: 0.1035s/iter; left time: 1057.4913s
Epoch: 34 cost time: 3.960155963897705
Epoch: 34, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.371 Vali Acc: 0.365 Test Loss: 2.371 Test Acc: 0.365
Validation loss decreased (-0.356830 --> -0.364534).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.3819302
	speed: 0.1028s/iter; left time: 1034.4774s
Epoch: 35 cost time: 4.066117286682129
Epoch: 35, Steps: 154 | Train Loss: 1.485 Vali Loss: 2.533 Vali Acc: 0.352 Test Loss: 2.533 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 1.6232632
	speed: 0.1075s/iter; left time: 1065.5892s
Epoch: 36 cost time: 3.988844871520996
Epoch: 36, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.546 Vali Acc: 0.356 Test Loss: 2.546 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.9624215
	speed: 0.0984s/iter; left time: 960.5663s
Epoch: 37 cost time: 4.050466299057007
Epoch: 37, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.402 Vali Acc: 0.361 Test Loss: 2.402 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 1.2307296
	speed: 0.1030s/iter; left time: 988.7418s
Epoch: 38 cost time: 4.054471731185913
Epoch: 38, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.659 Vali Acc: 0.360 Test Loss: 2.659 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 1.5212426
	speed: 0.1031s/iter; left time: 973.8439s
Epoch: 39 cost time: 3.9418115615844727
Epoch: 39, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.548 Vali Acc: 0.363 Test Loss: 2.548 Test Acc: 0.363
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 1.6269457
	speed: 0.1006s/iter; left time: 935.3315s
Epoch: 40 cost time: 4.206795692443848
Epoch: 40, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.599 Vali Acc: 0.369 Test Loss: 2.599 Test Acc: 0.369
Validation loss decreased (-0.364534 --> -0.368993).  Saving model ...
	iters: 100, epoch: 41 | loss: 1.5998770
	speed: 0.1041s/iter; left time: 951.1724s
Epoch: 41 cost time: 4.136792182922363
Epoch: 41, Steps: 154 | Train Loss: 1.443 Vali Loss: 2.457 Vali Acc: 0.372 Test Loss: 2.457 Test Acc: 0.372
Validation loss decreased (-0.368993 --> -0.372238).  Saving model ...
	iters: 100, epoch: 42 | loss: 1.1926231
	speed: 0.1017s/iter; left time: 914.2979s
Epoch: 42 cost time: 3.9894516468048096
Epoch: 42, Steps: 154 | Train Loss: 1.409 Vali Loss: 2.550 Vali Acc: 0.368 Test Loss: 2.550 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 1.5361151
	speed: 0.1046s/iter; left time: 923.4917s
Epoch: 43 cost time: 4.2154762744903564
Epoch: 43, Steps: 154 | Train Loss: 1.581 Vali Loss: 2.735 Vali Acc: 0.368 Test Loss: 2.735 Test Acc: 0.368
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 44 | loss: 0.9071432
	speed: 0.1053s/iter; left time: 913.7378s
Epoch: 44 cost time: 4.151134252548218
Epoch: 44, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.722 Vali Acc: 0.379 Test Loss: 2.722 Test Acc: 0.379
Validation loss decreased (-0.372238 --> -0.378724).  Saving model ...
	iters: 100, epoch: 45 | loss: 2.2774656
	speed: 0.1075s/iter; left time: 916.8415s
Epoch: 45 cost time: 4.094380855560303
Epoch: 45, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.801 Vali Acc: 0.370 Test Loss: 2.801 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 46 | loss: 1.4011135
	speed: 0.0996s/iter; left time: 834.0121s
Epoch: 46 cost time: 4.295677900314331
Epoch: 46, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.904 Vali Acc: 0.379 Test Loss: 2.904 Test Acc: 0.379
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 47 | loss: 1.4402702
	speed: 0.1053s/iter; left time: 865.5099s
Epoch: 47 cost time: 4.2354912757873535
Epoch: 47, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.813 Vali Acc: 0.371 Test Loss: 2.813 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 48 | loss: 1.7378511
	speed: 0.1065s/iter; left time: 858.7420s
Epoch: 48 cost time: 4.47271203994751
Epoch: 48, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.942 Vali Acc: 0.368 Test Loss: 2.942 Test Acc: 0.368
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 49 | loss: 1.2897624
	speed: 0.1072s/iter; left time: 848.1395s
Epoch: 49 cost time: 4.5354695320129395
Epoch: 49, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.976 Vali Acc: 0.363 Test Loss: 2.976 Test Acc: 0.363
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 50 | loss: 1.8984741
	speed: 0.1042s/iter; left time: 808.4136s
Epoch: 50 cost time: 4.124847650527954
Epoch: 50, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.621 Vali Acc: 0.371 Test Loss: 2.621 Test Acc: 0.371
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 51 | loss: 1.2794107
	speed: 0.0980s/iter; left time: 744.7338s
Epoch: 51 cost time: 3.7144477367401123
Epoch: 51, Steps: 154 | Train Loss: 1.382 Vali Loss: 3.148 Vali Acc: 0.384 Test Loss: 3.148 Test Acc: 0.384
Validation loss decreased (-0.378724 --> -0.384397).  Saving model ...
	iters: 100, epoch: 52 | loss: 1.4957219
	speed: 0.1010s/iter; left time: 751.9512s
Epoch: 52 cost time: 4.209936618804932
Epoch: 52, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.914 Vali Acc: 0.378 Test Loss: 2.914 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 53 | loss: 1.5183985
	speed: 0.1065s/iter; left time: 776.8544s
Epoch: 53 cost time: 3.904080390930176
Epoch: 53, Steps: 154 | Train Loss: 1.312 Vali Loss: 3.191 Vali Acc: 0.372 Test Loss: 3.191 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 54 | loss: 1.1084547
	speed: 0.1050s/iter; left time: 749.8770s
Epoch: 54 cost time: 4.155406951904297
Epoch: 54, Steps: 154 | Train Loss: 1.361 Vali Loss: 2.846 Vali Acc: 0.374 Test Loss: 2.846 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 55 | loss: 1.2830528
	speed: 0.1041s/iter; left time: 726.8794s
Epoch: 55 cost time: 3.993229627609253
Epoch: 55, Steps: 154 | Train Loss: 1.392 Vali Loss: 2.759 Vali Acc: 0.377 Test Loss: 2.759 Test Acc: 0.377
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 56 | loss: 1.2196225
	speed: 0.1011s/iter; left time: 690.6558s
Epoch: 56 cost time: 4.163255453109741
Epoch: 56, Steps: 154 | Train Loss: 1.460 Vali Loss: 3.309 Vali Acc: 0.369 Test Loss: 3.309 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 57 | loss: 1.4553701
	speed: 0.0978s/iter; left time: 652.8263s
Epoch: 57 cost time: 3.5351858139038086
Epoch: 57, Steps: 154 | Train Loss: 1.365 Vali Loss: 3.311 Vali Acc: 0.381 Test Loss: 3.311 Test Acc: 0.381
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 58 | loss: 0.6048570
	speed: 0.0866s/iter; left time: 564.6968s
Epoch: 58 cost time: 3.4713306427001953
Epoch: 58, Steps: 154 | Train Loss: 1.421 Vali Loss: 3.158 Vali Acc: 0.379 Test Loss: 3.158 Test Acc: 0.379
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 59 | loss: 1.4892696
	speed: 0.0873s/iter; left time: 556.1765s
Epoch: 59 cost time: 3.917497158050537
Epoch: 59, Steps: 154 | Train Loss: 1.291 Vali Loss: 3.112 Vali Acc: 0.254 Test Loss: 3.112 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 60 | loss: 1.5630413
	speed: 0.1053s/iter; left time: 654.3483s
Epoch: 60 cost time: 4.059605836868286
Epoch: 60, Steps: 154 | Train Loss: 1.336 Vali Loss: 3.063 Vali Acc: 0.387 Test Loss: 3.063 Test Acc: 0.387
Validation loss decreased (-0.384397 --> -0.387236).  Saving model ...
	iters: 100, epoch: 61 | loss: 1.1445830
	speed: 0.1030s/iter; left time: 624.1729s
Epoch: 61 cost time: 4.20337438583374
Epoch: 61, Steps: 154 | Train Loss: 1.480 Vali Loss: 3.003 Vali Acc: 0.391 Test Loss: 3.003 Test Acc: 0.391
Validation loss decreased (-0.387236 --> -0.390481).  Saving model ...
	iters: 100, epoch: 62 | loss: 1.5460495
	speed: 0.0997s/iter; left time: 589.1153s
Epoch: 62 cost time: 3.9929072856903076
Epoch: 62, Steps: 154 | Train Loss: 1.346 Vali Loss: 3.033 Vali Acc: 0.380 Test Loss: 3.033 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 63 | loss: 1.1346290
	speed: 0.1054s/iter; left time: 606.1181s
Epoch: 63 cost time: 4.256324529647827
Epoch: 63, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.909 Vali Acc: 0.376 Test Loss: 2.909 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 64 | loss: 1.0285872
	speed: 0.1070s/iter; left time: 598.9262s
Epoch: 64 cost time: 4.196373224258423
Epoch: 64, Steps: 154 | Train Loss: 1.324 Vali Loss: 3.201 Vali Acc: 0.386 Test Loss: 3.201 Test Acc: 0.386
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 65 | loss: 1.0106792
	speed: 0.1084s/iter; left time: 590.2373s
Epoch: 65 cost time: 4.217648983001709
Epoch: 65, Steps: 154 | Train Loss: 1.352 Vali Loss: 2.907 Vali Acc: 0.390 Test Loss: 2.907 Test Acc: 0.390
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 66 | loss: 1.1983721
	speed: 0.1126s/iter; left time: 595.6188s
Epoch: 66 cost time: 4.292176961898804
Epoch: 66, Steps: 154 | Train Loss: 1.325 Vali Loss: 3.001 Vali Acc: 0.380 Test Loss: 3.001 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 67 | loss: 4.5657444
	speed: 0.1066s/iter; left time: 547.7572s
Epoch: 67 cost time: 4.07564640045166
Epoch: 67, Steps: 154 | Train Loss: 1.283 Vali Loss: 3.179 Vali Acc: 0.379 Test Loss: 3.179 Test Acc: 0.379
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 68 | loss: 0.9406000
	speed: 0.1066s/iter; left time: 531.3207s
Epoch: 68 cost time: 4.154667139053345
Epoch: 68, Steps: 154 | Train Loss: 1.284 Vali Loss: 3.118 Vali Acc: 0.378 Test Loss: 3.118 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 69 | loss: 1.3045114
	speed: 0.1014s/iter; left time: 489.6172s
Epoch: 69 cost time: 4.166257381439209
Epoch: 69, Steps: 154 | Train Loss: 1.325 Vali Loss: 3.106 Vali Acc: 0.380 Test Loss: 3.106 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 70 | loss: 3.9799302
	speed: 0.1038s/iter; left time: 485.1917s
Epoch: 70 cost time: 4.141700029373169
Epoch: 70, Steps: 154 | Train Loss: 1.307 Vali Loss: 3.124 Vali Acc: 0.384 Test Loss: 3.124 Test Acc: 0.384
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 71 | loss: 1.2987146
	speed: 0.1019s/iter; left time: 460.7974s
Epoch: 71 cost time: 4.202596664428711
Epoch: 71, Steps: 154 | Train Loss: 1.372 Vali Loss: 3.280 Vali Acc: 0.379 Test Loss: 3.280 Test Acc: 0.379
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3905109489051095
model parameter : 27766
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0652208
	speed: 0.0414s/iter; left time: 632.8928s
Epoch: 1 cost time: 5.3866822719573975
Epoch: 1, Steps: 154 | Train Loss: 2.308 Vali Loss: 2.187 Vali Acc: 0.315 Test Loss: 2.187 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0998487
	speed: 0.1055s/iter; left time: 1598.7447s
Epoch: 2 cost time: 4.092060804367065
Epoch: 2, Steps: 154 | Train Loss: 2.094 Vali Loss: 2.158 Vali Acc: 0.317 Test Loss: 2.158 Test Acc: 0.317
Validation loss decreased (-0.315063 --> -0.316686).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9312665
	speed: 0.1006s/iter; left time: 1508.4412s
Epoch: 3 cost time: 3.899474620819092
Epoch: 3, Steps: 154 | Train Loss: 2.055 Vali Loss: 2.164 Vali Acc: 0.317 Test Loss: 2.164 Test Acc: 0.317
Validation loss decreased (-0.316686 --> -0.317091).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2276061
	speed: 0.1068s/iter; left time: 1584.8686s
Epoch: 4 cost time: 4.056730031967163
Epoch: 4, Steps: 154 | Train Loss: 2.006 Vali Loss: 2.155 Vali Acc: 0.318 Test Loss: 2.155 Test Acc: 0.318
Validation loss decreased (-0.317091 --> -0.317497).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8183341
	speed: 0.1070s/iter; left time: 1571.4790s
Epoch: 5 cost time: 4.1013078689575195
Epoch: 5, Steps: 154 | Train Loss: 1.976 Vali Loss: 2.156 Vali Acc: 0.321 Test Loss: 2.156 Test Acc: 0.321
Validation loss decreased (-0.317497 --> -0.320741).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8849453
	speed: 0.1053s/iter; left time: 1529.8760s
Epoch: 6 cost time: 4.207223415374756
Epoch: 6, Steps: 154 | Train Loss: 1.935 Vali Loss: 2.162 Vali Acc: 0.319 Test Loss: 2.162 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5620177
	speed: 0.1041s/iter; left time: 1497.2134s
Epoch: 7 cost time: 4.147900581359863
Epoch: 7, Steps: 154 | Train Loss: 1.904 Vali Loss: 2.144 Vali Acc: 0.323 Test Loss: 2.144 Test Acc: 0.323
Validation loss decreased (-0.320741 --> -0.322769).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8555269
	speed: 0.1057s/iter; left time: 1504.0172s
Epoch: 8 cost time: 4.229909658432007
Epoch: 8, Steps: 154 | Train Loss: 1.883 Vali Loss: 2.162 Vali Acc: 0.322 Test Loss: 2.162 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8278666
	speed: 0.1053s/iter; left time: 1482.1167s
Epoch: 9 cost time: 4.041090726852417
Epoch: 9, Steps: 154 | Train Loss: 1.883 Vali Loss: 2.168 Vali Acc: 0.322 Test Loss: 2.168 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4704623
	speed: 0.1060s/iter; left time: 1474.9693s
Epoch: 10 cost time: 3.987964391708374
Epoch: 10, Steps: 154 | Train Loss: 1.840 Vali Loss: 2.150 Vali Acc: 0.325 Test Loss: 2.150 Test Acc: 0.325
Validation loss decreased (-0.322769 --> -0.324796).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7703965
	speed: 0.1078s/iter; left time: 1482.9362s
Epoch: 11 cost time: 4.066792249679565
Epoch: 11, Steps: 154 | Train Loss: 1.828 Vali Loss: 2.149 Vali Acc: 0.326 Test Loss: 2.149 Test Acc: 0.326
Validation loss decreased (-0.324796 --> -0.326013).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2545793
	speed: 0.1028s/iter; left time: 1398.9163s
Epoch: 12 cost time: 3.911626100540161
Epoch: 12, Steps: 154 | Train Loss: 1.794 Vali Loss: 2.150 Vali Acc: 0.327 Test Loss: 2.150 Test Acc: 0.327
Validation loss decreased (-0.326013 --> -0.327229).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7862241
	speed: 0.1034s/iter; left time: 1391.7061s
Epoch: 13 cost time: 4.067447185516357
Epoch: 13, Steps: 154 | Train Loss: 1.812 Vali Loss: 2.160 Vali Acc: 0.329 Test Loss: 2.160 Test Acc: 0.329
Validation loss decreased (-0.327229 --> -0.328851).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.9476649
	speed: 0.1039s/iter; left time: 1382.0887s
Epoch: 14 cost time: 3.99010968208313
Epoch: 14, Steps: 154 | Train Loss: 1.792 Vali Loss: 2.169 Vali Acc: 0.328 Test Loss: 2.169 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.0625951
	speed: 0.0979s/iter; left time: 1287.2368s
Epoch: 15 cost time: 3.914020299911499
Epoch: 15, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.186 Vali Acc: 0.330 Test Loss: 2.186 Test Acc: 0.330
Validation loss decreased (-0.328851 --> -0.330067).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.6438475
	speed: 0.1007s/iter; left time: 1307.7540s
Epoch: 16 cost time: 4.017290830612183
Epoch: 16, Steps: 154 | Train Loss: 1.765 Vali Loss: 2.205 Vali Acc: 0.335 Test Loss: 2.205 Test Acc: 0.335
Validation loss decreased (-0.330067 --> -0.334528).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.8435181
	speed: 0.1009s/iter; left time: 1294.7413s
Epoch: 17 cost time: 3.8750758171081543
Epoch: 17, Steps: 154 | Train Loss: 1.698 Vali Loss: 2.201 Vali Acc: 0.337 Test Loss: 2.201 Test Acc: 0.337
Validation loss decreased (-0.334528 --> -0.337366).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.3340403
	speed: 0.1000s/iter; left time: 1268.1680s
Epoch: 18 cost time: 4.005703687667847
Epoch: 18, Steps: 154 | Train Loss: 1.694 Vali Loss: 2.215 Vali Acc: 0.335 Test Loss: 2.215 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 2.1811831
	speed: 0.0969s/iter; left time: 1213.6449s
Epoch: 19 cost time: 3.810192346572876
Epoch: 19, Steps: 154 | Train Loss: 1.678 Vali Loss: 2.181 Vali Acc: 0.344 Test Loss: 2.181 Test Acc: 0.344
Validation loss decreased (-0.337366 --> -0.343855).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.7886338
	speed: 0.0997s/iter; left time: 1234.1865s
Epoch: 20 cost time: 4.121176719665527
Epoch: 20, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.284 Vali Acc: 0.340 Test Loss: 2.284 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.6407619
	speed: 0.1092s/iter; left time: 1334.0065s
Epoch: 21 cost time: 4.065433740615845
Epoch: 21, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.310 Vali Acc: 0.342 Test Loss: 2.310 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.4346526
	speed: 0.1028s/iter; left time: 1239.9721s
Epoch: 22 cost time: 4.00787353515625
Epoch: 22, Steps: 154 | Train Loss: 1.704 Vali Loss: 2.249 Vali Acc: 0.346 Test Loss: 2.249 Test Acc: 0.346
Validation loss decreased (-0.343855 --> -0.346287).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.7104518
	speed: 0.1074s/iter; left time: 1279.4175s
Epoch: 23 cost time: 4.277745485305786
Epoch: 23, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.272 Vali Acc: 0.349 Test Loss: 2.272 Test Acc: 0.349
Validation loss decreased (-0.346287 --> -0.348720).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.1541524
	speed: 0.1043s/iter; left time: 1225.8851s
Epoch: 24 cost time: 4.171314716339111
Epoch: 24, Steps: 154 | Train Loss: 1.643 Vali Loss: 2.302 Vali Acc: 0.352 Test Loss: 2.302 Test Acc: 0.352
Validation loss decreased (-0.348720 --> -0.351964).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.4272374
	speed: 0.1044s/iter; left time: 1211.6541s
Epoch: 25 cost time: 4.0030837059021
Epoch: 25, Steps: 154 | Train Loss: 1.585 Vali Loss: 2.229 Vali Acc: 0.351 Test Loss: 2.229 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.0294495
	speed: 0.1033s/iter; left time: 1182.3599s
Epoch: 26 cost time: 4.168663024902344
Epoch: 26, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.305 Vali Acc: 0.350 Test Loss: 2.305 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.6109428
	speed: 0.1056s/iter; left time: 1192.9772s
Epoch: 27 cost time: 4.210695505142212
Epoch: 27, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.295 Vali Acc: 0.357 Test Loss: 2.295 Test Acc: 0.357
Validation loss decreased (-0.351964 --> -0.357236).  Saving model ...
	iters: 100, epoch: 28 | loss: 2.2958896
	speed: 0.1046s/iter; left time: 1165.3200s
Epoch: 28 cost time: 4.061416387557983
Epoch: 28, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.313 Vali Acc: 0.352 Test Loss: 2.313 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.1506293
	speed: 0.1022s/iter; left time: 1123.6218s
Epoch: 29 cost time: 4.042842149734497
Epoch: 29, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.344 Vali Acc: 0.351 Test Loss: 2.344 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 1.7719473
	speed: 0.1058s/iter; left time: 1146.1100s
Epoch: 30 cost time: 4.090927362442017
Epoch: 30, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.338 Vali Acc: 0.354 Test Loss: 2.338 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 1.1980186
	speed: 0.1050s/iter; left time: 1121.1951s
Epoch: 31 cost time: 3.9658379554748535
Epoch: 31, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.347 Vali Acc: 0.355 Test Loss: 2.347 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 1.3056736
	speed: 0.1052s/iter; left time: 1107.0519s
Epoch: 32 cost time: 3.9984285831451416
Epoch: 32, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.382 Vali Acc: 0.358 Test Loss: 2.382 Test Acc: 0.358
Validation loss decreased (-0.357236 --> -0.357640).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.8006924
	speed: 0.1007s/iter; left time: 1044.5489s
Epoch: 33 cost time: 3.8120765686035156
Epoch: 33, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.411 Vali Acc: 0.358 Test Loss: 2.411 Test Acc: 0.358
Validation loss decreased (-0.357640 --> -0.358046).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.4500855
	speed: 0.0976s/iter; left time: 997.1625s
Epoch: 34 cost time: 4.056126356124878
Epoch: 34, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.349 Vali Acc: 0.357 Test Loss: 2.349 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 1.3787360
	speed: 0.0969s/iter; left time: 975.6564s
Epoch: 35 cost time: 4.153483152389526
Epoch: 35, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.438 Vali Acc: 0.354 Test Loss: 2.438 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 1.6020420
	speed: 0.1010s/iter; left time: 1001.3304s
Epoch: 36 cost time: 4.043883323669434
Epoch: 36, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.631 Vali Acc: 0.352 Test Loss: 2.631 Test Acc: 0.352
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 1.0139453
	speed: 0.1030s/iter; left time: 1005.3388s
Epoch: 37 cost time: 4.017951250076294
Epoch: 37, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.404 Vali Acc: 0.362 Test Loss: 2.404 Test Acc: 0.362
Validation loss decreased (-0.358046 --> -0.362101).  Saving model ...
	iters: 100, epoch: 38 | loss: 1.4363043
	speed: 0.1057s/iter; left time: 1015.2105s
Epoch: 38 cost time: 4.116020202636719
Epoch: 38, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.582 Vali Acc: 0.359 Test Loss: 2.582 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 1.6463671
	speed: 0.1034s/iter; left time: 976.6212s
Epoch: 39 cost time: 3.9574134349823
Epoch: 39, Steps: 154 | Train Loss: 1.578 Vali Loss: 2.468 Vali Acc: 0.361 Test Loss: 2.468 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 1.6294273
	speed: 0.1072s/iter; left time: 996.7413s
Epoch: 40 cost time: 3.9996280670166016
Epoch: 40, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.637 Vali Acc: 0.362 Test Loss: 2.637 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 1.6974269
	speed: 0.1045s/iter; left time: 955.2372s
Epoch: 41 cost time: 4.238482475280762
Epoch: 41, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.518 Vali Acc: 0.369 Test Loss: 2.518 Test Acc: 0.369
Validation loss decreased (-0.362101 --> -0.368993).  Saving model ...
	iters: 100, epoch: 42 | loss: 1.2038234
	speed: 0.1087s/iter; left time: 976.6797s
Epoch: 42 cost time: 3.973341464996338
Epoch: 42, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.646 Vali Acc: 0.369 Test Loss: 2.646 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 1.5911208
	speed: 0.1028s/iter; left time: 908.4141s
Epoch: 43 cost time: 4.09033203125
Epoch: 43, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.889 Vali Acc: 0.373 Test Loss: 2.889 Test Acc: 0.373
Validation loss decreased (-0.368993 --> -0.373450).  Saving model ...
	iters: 100, epoch: 44 | loss: 0.8932093
	speed: 0.1046s/iter; left time: 907.9311s
Epoch: 44 cost time: 4.239368200302124
Epoch: 44, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.910 Vali Acc: 0.372 Test Loss: 2.910 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 1.4170768
	speed: 0.1032s/iter; left time: 879.8950s
Epoch: 45 cost time: 4.058131217956543
Epoch: 45, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.828 Vali Acc: 0.363 Test Loss: 2.828 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 1.7916124
	speed: 0.1035s/iter; left time: 866.2990s
Epoch: 46 cost time: 4.214631795883179
Epoch: 46, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.982 Vali Acc: 0.366 Test Loss: 2.982 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 47 | loss: 1.2108724
	speed: 0.1047s/iter; left time: 860.1948s
Epoch: 47 cost time: 4.231780529022217
Epoch: 47, Steps: 154 | Train Loss: 1.425 Vali Loss: 2.814 Vali Acc: 0.367 Test Loss: 2.814 Test Acc: 0.367
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 48 | loss: 1.8393099
	speed: 0.1002s/iter; left time: 807.8218s
Epoch: 48 cost time: 4.001946687698364
Epoch: 48, Steps: 154 | Train Loss: 1.481 Vali Loss: 2.789 Vali Acc: 0.365 Test Loss: 2.789 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 49 | loss: 1.7270893
	speed: 0.1023s/iter; left time: 808.9703s
Epoch: 49 cost time: 3.9557840824127197
Epoch: 49, Steps: 154 | Train Loss: 1.437 Vali Loss: 2.960 Vali Acc: 0.365 Test Loss: 2.960 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 50 | loss: 1.6975930
	speed: 0.1012s/iter; left time: 785.0983s
Epoch: 50 cost time: 3.9997169971466064
Epoch: 50, Steps: 154 | Train Loss: 1.404 Vali Loss: 2.761 Vali Acc: 0.364 Test Loss: 2.761 Test Acc: 0.364
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 51 | loss: 1.3857867
	speed: 0.0999s/iter; left time: 759.1452s
Epoch: 51 cost time: 3.959064483642578
Epoch: 51, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.817 Vali Acc: 0.374 Test Loss: 2.817 Test Acc: 0.374
Validation loss decreased (-0.373450 --> -0.373857).  Saving model ...
	iters: 100, epoch: 52 | loss: 1.4709888
	speed: 0.1036s/iter; left time: 771.8036s
Epoch: 52 cost time: 4.018784284591675
Epoch: 52, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.836 Vali Acc: 0.367 Test Loss: 2.836 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 53 | loss: 1.6395216
	speed: 0.0989s/iter; left time: 721.2835s
Epoch: 53 cost time: 3.9402270317077637
Epoch: 53, Steps: 154 | Train Loss: 1.370 Vali Loss: 3.050 Vali Acc: 0.368 Test Loss: 3.050 Test Acc: 0.368
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 54 | loss: 1.0623746
	speed: 0.1021s/iter; left time: 728.9193s
Epoch: 54 cost time: 3.969309091567993
Epoch: 54, Steps: 154 | Train Loss: 1.390 Vali Loss: 2.486 Vali Acc: 0.371 Test Loss: 2.486 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 55 | loss: 1.2474940
	speed: 0.1026s/iter; left time: 716.7399s
Epoch: 55 cost time: 3.973149538040161
Epoch: 55, Steps: 154 | Train Loss: 1.322 Vali Loss: 2.923 Vali Acc: 0.379 Test Loss: 2.923 Test Acc: 0.379
Validation loss decreased (-0.373857 --> -0.378722).  Saving model ...
	iters: 100, epoch: 56 | loss: 1.3076683
	speed: 0.1038s/iter; left time: 709.0043s
Epoch: 56 cost time: 4.063215494155884
Epoch: 56, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.968 Vali Acc: 0.260 Test Loss: 2.968 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 57 | loss: 1.1465830
	speed: 0.1001s/iter; left time: 668.6703s
Epoch: 57 cost time: 3.79685640335083
Epoch: 57, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.918 Vali Acc: 0.381 Test Loss: 2.918 Test Acc: 0.381
Validation loss decreased (-0.378722 --> -0.381155).  Saving model ...
	iters: 100, epoch: 58 | loss: 0.9091003
	speed: 0.1058s/iter; left time: 690.0369s
Epoch: 58 cost time: 3.9769771099090576
Epoch: 58, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.953 Vali Acc: 0.369 Test Loss: 2.953 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 59 | loss: 1.5192735
	speed: 0.1048s/iter; left time: 667.3576s
Epoch: 59 cost time: 4.0601372718811035
Epoch: 59, Steps: 154 | Train Loss: 1.351 Vali Loss: 3.087 Vali Acc: 0.222 Test Loss: 3.087 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 60 | loss: 1.4628652
	speed: 0.1092s/iter; left time: 678.6709s
Epoch: 60 cost time: 4.150160312652588
Epoch: 60, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.921 Vali Acc: 0.383 Test Loss: 2.921 Test Acc: 0.383
Validation loss decreased (-0.381155 --> -0.382777).  Saving model ...
	iters: 100, epoch: 61 | loss: 1.3678764
	speed: 0.1090s/iter; left time: 660.4829s
Epoch: 61 cost time: 3.885439872741699
Epoch: 61, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.577 Vali Acc: 0.382 Test Loss: 2.577 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 62 | loss: 1.5860554
	speed: 0.1017s/iter; left time: 600.7976s
Epoch: 62 cost time: 4.173894166946411
Epoch: 62, Steps: 154 | Train Loss: 1.310 Vali Loss: 3.289 Vali Acc: 0.379 Test Loss: 3.289 Test Acc: 0.379
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 63 | loss: 1.2253770
	speed: 0.0954s/iter; left time: 548.9274s
Epoch: 63 cost time: 4.005741357803345
Epoch: 63, Steps: 154 | Train Loss: 1.789 Vali Loss: 3.072 Vali Acc: 0.381 Test Loss: 3.072 Test Acc: 0.381
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 64 | loss: 1.0672363
	speed: 0.0988s/iter; left time: 552.9524s
Epoch: 64 cost time: 4.113969564437866
Epoch: 64, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.875 Vali Acc: 0.378 Test Loss: 2.875 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 65 | loss: 1.0119390
	speed: 0.1041s/iter; left time: 566.9761s
Epoch: 65 cost time: 4.328984975814819
Epoch: 65, Steps: 154 | Train Loss: 1.340 Vali Loss: 3.049 Vali Acc: 0.381 Test Loss: 3.049 Test Acc: 0.381
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 66 | loss: 1.2303944
	speed: 0.0998s/iter; left time: 528.1441s
Epoch: 66 cost time: 3.9772424697875977
Epoch: 66, Steps: 154 | Train Loss: 1.294 Vali Loss: 3.123 Vali Acc: 0.379 Test Loss: 3.123 Test Acc: 0.379
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 67 | loss: 1.4666140
	speed: 0.1017s/iter; left time: 522.3137s
Epoch: 67 cost time: 4.175788164138794
Epoch: 67, Steps: 154 | Train Loss: 1.311 Vali Loss: 3.103 Vali Acc: 0.379 Test Loss: 3.103 Test Acc: 0.379
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 68 | loss: 1.1095358
	speed: 0.1036s/iter; left time: 516.0891s
Epoch: 68 cost time: 4.095834255218506
Epoch: 68, Steps: 154 | Train Loss: 1.377 Vali Loss: 2.774 Vali Acc: 0.386 Test Loss: 2.774 Test Acc: 0.386
Validation loss decreased (-0.382777 --> -0.386023).  Saving model ...
	iters: 100, epoch: 69 | loss: 1.1010263
	speed: 0.1029s/iter; left time: 496.7665s
Epoch: 69 cost time: 4.017019510269165
Epoch: 69, Steps: 154 | Train Loss: 1.351 Vali Loss: 3.196 Vali Acc: 0.379 Test Loss: 3.196 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 70 | loss: 4.6290274
	speed: 0.1049s/iter; left time: 490.4524s
Epoch: 70 cost time: 4.064237117767334
Epoch: 70, Steps: 154 | Train Loss: 1.419 Vali Loss: 3.051 Vali Acc: 0.386 Test Loss: 3.051 Test Acc: 0.386
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 71 | loss: 1.2790757
	speed: 0.1061s/iter; left time: 479.4946s
Epoch: 71 cost time: 4.0888895988464355
Epoch: 71, Steps: 154 | Train Loss: 1.409 Vali Loss: 3.336 Vali Acc: 0.373 Test Loss: 3.336 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 72 | loss: 1.1265595
	speed: 0.1032s/iter; left time: 450.5316s
Epoch: 72 cost time: 3.9820988178253174
Epoch: 72, Steps: 154 | Train Loss: 1.287 Vali Loss: 3.416 Vali Acc: 0.384 Test Loss: 3.416 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 73 | loss: 0.8174390
	speed: 0.1047s/iter; left time: 441.0650s
Epoch: 73 cost time: 4.1289896965026855
Epoch: 73, Steps: 154 | Train Loss: 1.229 Vali Loss: 3.248 Vali Acc: 0.382 Test Loss: 3.248 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 74 | loss: 1.3985947
	speed: 0.1037s/iter; left time: 420.8390s
Epoch: 74 cost time: 4.056281089782715
Epoch: 74, Steps: 154 | Train Loss: 1.395 Vali Loss: 3.138 Vali Acc: 0.386 Test Loss: 3.138 Test Acc: 0.386
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 75 | loss: 1.0715799
	speed: 0.1039s/iter; left time: 405.7156s
Epoch: 75 cost time: 4.107003450393677
Epoch: 75, Steps: 154 | Train Loss: 1.279 Vali Loss: 3.120 Vali Acc: 0.382 Test Loss: 3.120 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 76 | loss: 0.6990545
	speed: 0.1002s/iter; left time: 375.9201s
Epoch: 76 cost time: 4.021807909011841
Epoch: 76, Steps: 154 | Train Loss: 1.233 Vali Loss: 3.219 Vali Acc: 0.388 Test Loss: 3.219 Test Acc: 0.388
Validation loss decreased (-0.386023 --> -0.388451).  Saving model ...
	iters: 100, epoch: 77 | loss: 1.0806165
	speed: 0.1099s/iter; left time: 395.2286s
Epoch: 77 cost time: 4.240733623504639
Epoch: 77, Steps: 154 | Train Loss: 1.405 Vali Loss: 3.369 Vali Acc: 0.386 Test Loss: 3.369 Test Acc: 0.386
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 78 | loss: 1.2081746
	speed: 0.1045s/iter; left time: 359.8040s
Epoch: 78 cost time: 4.087421178817749
Epoch: 78, Steps: 154 | Train Loss: 1.268 Vali Loss: 3.545 Vali Acc: 0.375 Test Loss: 3.545 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 79 | loss: 1.2164532
	speed: 0.1056s/iter; left time: 347.4744s
Epoch: 79 cost time: 4.030987024307251
Epoch: 79, Steps: 154 | Train Loss: 1.400 Vali Loss: 3.601 Vali Acc: 0.386 Test Loss: 3.601 Test Acc: 0.386
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 80 | loss: 1.6146854
	speed: 0.1021s/iter; left time: 320.2353s
Epoch: 80 cost time: 3.9996159076690674
Epoch: 80, Steps: 154 | Train Loss: 1.206 Vali Loss: 3.689 Vali Acc: 0.385 Test Loss: 3.689 Test Acc: 0.385
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 81 | loss: 1.3555259
	speed: 0.1028s/iter; left time: 306.5609s
Epoch: 81 cost time: 4.037839889526367
Epoch: 81, Steps: 154 | Train Loss: 1.473 Vali Loss: 3.491 Vali Acc: 0.386 Test Loss: 3.491 Test Acc: 0.386
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 82 | loss: 1.4164205
	speed: 0.1034s/iter; left time: 292.3612s
Epoch: 82 cost time: 4.15862512588501
Epoch: 82, Steps: 154 | Train Loss: 1.244 Vali Loss: 3.561 Vali Acc: 0.279 Test Loss: 3.561 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 83 | loss: 1.1429240
	speed: 0.1024s/iter; left time: 273.7962s
Epoch: 83 cost time: 4.004473447799683
Epoch: 83, Steps: 154 | Train Loss: 1.364 Vali Loss: 3.513 Vali Acc: 0.385 Test Loss: 3.513 Test Acc: 0.385
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 84 | loss: 1.0651472
	speed: 0.0992s/iter; left time: 249.9687s
Epoch: 84 cost time: 4.009186744689941
Epoch: 84, Steps: 154 | Train Loss: 1.511 Vali Loss: 2.916 Vali Acc: 0.392 Test Loss: 2.916 Test Acc: 0.392
Validation loss decreased (-0.388451 --> -0.391698).  Saving model ...
	iters: 100, epoch: 85 | loss: 1.1408536
	speed: 0.0989s/iter; left time: 233.9130s
Epoch: 85 cost time: 3.736689805984497
Epoch: 85, Steps: 154 | Train Loss: 1.230 Vali Loss: 3.218 Vali Acc: 0.384 Test Loss: 3.218 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 86 | loss: 3.4552314
	speed: 0.1002s/iter; left time: 221.5222s
Epoch: 86 cost time: 4.0381951332092285
Epoch: 86, Steps: 154 | Train Loss: 1.533 Vali Loss: 3.132 Vali Acc: 0.401 Test Loss: 3.132 Test Acc: 0.401
Validation loss decreased (-0.391698 --> -0.401023).  Saving model ...
	iters: 100, epoch: 87 | loss: 2.1927388
	speed: 0.1044s/iter; left time: 214.7361s
Epoch: 87 cost time: 4.043952226638794
Epoch: 87, Steps: 154 | Train Loss: 1.417 Vali Loss: 3.360 Vali Acc: 0.386 Test Loss: 3.360 Test Acc: 0.386
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 88 | loss: 1.0017810
	speed: 0.1035s/iter; left time: 196.9554s
Epoch: 88 cost time: 4.002690553665161
Epoch: 88, Steps: 154 | Train Loss: 1.197 Vali Loss: 3.593 Vali Acc: 0.389 Test Loss: 3.593 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 89 | loss: 1.5320535
	speed: 0.1040s/iter; left time: 181.8945s
Epoch: 89 cost time: 3.9536144733428955
Epoch: 89, Steps: 154 | Train Loss: 1.239 Vali Loss: 3.409 Vali Acc: 0.383 Test Loss: 3.409 Test Acc: 0.383
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 90 | loss: 1.0143049
	speed: 0.1030s/iter; left time: 164.2209s
Epoch: 90 cost time: 4.051437616348267
Epoch: 90, Steps: 154 | Train Loss: 1.247 Vali Loss: 3.256 Vali Acc: 0.386 Test Loss: 3.256 Test Acc: 0.386
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 91 | loss: 1.1200449
	speed: 0.1035s/iter; left time: 149.0820s
Epoch: 91 cost time: 4.086132287979126
Epoch: 91, Steps: 154 | Train Loss: 1.292 Vali Loss: 3.303 Vali Acc: 0.389 Test Loss: 3.303 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 92 | loss: 2.6101062
	speed: 0.1011s/iter; left time: 130.0866s
Epoch: 92 cost time: 4.014711380004883
Epoch: 92, Steps: 154 | Train Loss: 1.253 Vali Loss: 3.435 Vali Acc: 0.387 Test Loss: 3.435 Test Acc: 0.387
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 93 | loss: 0.6267639
	speed: 0.1050s/iter; left time: 118.9225s
Epoch: 93 cost time: 4.175182580947876
Epoch: 93, Steps: 154 | Train Loss: 1.248 Vali Loss: 3.443 Vali Acc: 0.384 Test Loss: 3.443 Test Acc: 0.384
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 94 | loss: 1.1546860
	speed: 0.1034s/iter; left time: 101.2219s
Epoch: 94 cost time: 4.149792671203613
Epoch: 94, Steps: 154 | Train Loss: 1.276 Vali Loss: 3.454 Vali Acc: 0.381 Test Loss: 3.454 Test Acc: 0.381
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 95 | loss: 0.7869478
	speed: 0.0973s/iter; left time: 80.3049s
Epoch: 95 cost time: 3.9611361026763916
Epoch: 95, Steps: 154 | Train Loss: 1.240 Vali Loss: 3.289 Vali Acc: 0.384 Test Loss: 3.289 Test Acc: 0.384
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 96 | loss: 2.0762463
	speed: 0.1056s/iter; left time: 70.8784s
Epoch: 96 cost time: 4.1353864669799805
Epoch: 96, Steps: 154 | Train Loss: 1.202 Vali Loss: 3.451 Vali Acc: 0.383 Test Loss: 3.451 Test Acc: 0.383
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4010543390105434
model parameter : 27766
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0908616
	speed: 0.0425s/iter; left time: 649.9416s
Epoch: 1 cost time: 5.541895389556885
Epoch: 1, Steps: 154 | Train Loss: 2.304 Vali Loss: 2.183 Vali Acc: 0.315 Test Loss: 2.183 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1032851
	speed: 0.1021s/iter; left time: 1546.8543s
Epoch: 2 cost time: 4.109232664108276
Epoch: 2, Steps: 154 | Train Loss: 2.087 Vali Loss: 2.154 Vali Acc: 0.316 Test Loss: 2.154 Test Acc: 0.316
Validation loss decreased (-0.315469 --> -0.316280).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9155158
	speed: 0.1019s/iter; left time: 1528.4577s
Epoch: 3 cost time: 4.1185691356658936
Epoch: 3, Steps: 154 | Train Loss: 2.048 Vali Loss: 2.156 Vali Acc: 0.319 Test Loss: 2.156 Test Acc: 0.319
Validation loss decreased (-0.316280 --> -0.318713).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2035134
	speed: 0.1024s/iter; left time: 1518.9511s
Epoch: 4 cost time: 4.10964035987854
Epoch: 4, Steps: 154 | Train Loss: 1.998 Vali Loss: 2.141 Vali Acc: 0.320 Test Loss: 2.141 Test Acc: 0.320
Validation loss decreased (-0.318713 --> -0.319524).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8864424
	speed: 0.1013s/iter; left time: 1487.6153s
Epoch: 5 cost time: 3.974850654602051
Epoch: 5, Steps: 154 | Train Loss: 1.978 Vali Loss: 2.143 Vali Acc: 0.320 Test Loss: 2.143 Test Acc: 0.320
Validation loss decreased (-0.319524 --> -0.319930).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9257517
	speed: 0.1019s/iter; left time: 1481.2357s
Epoch: 6 cost time: 3.9608817100524902
Epoch: 6, Steps: 154 | Train Loss: 1.947 Vali Loss: 2.150 Vali Acc: 0.319 Test Loss: 2.150 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5264431
	speed: 0.1024s/iter; left time: 1471.8285s
Epoch: 7 cost time: 4.0825042724609375
Epoch: 7, Steps: 154 | Train Loss: 1.918 Vali Loss: 2.127 Vali Acc: 0.324 Test Loss: 2.127 Test Acc: 0.324
Validation loss decreased (-0.319930 --> -0.323580).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8532202
	speed: 0.1064s/iter; left time: 1513.4766s
Epoch: 8 cost time: 3.9737329483032227
Epoch: 8, Steps: 154 | Train Loss: 1.890 Vali Loss: 2.143 Vali Acc: 0.324 Test Loss: 2.143 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8191663
	speed: 0.1051s/iter; left time: 1478.7588s
Epoch: 9 cost time: 4.094827890396118
Epoch: 9, Steps: 154 | Train Loss: 1.867 Vali Loss: 2.131 Vali Acc: 0.322 Test Loss: 2.131 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4689639
	speed: 0.1054s/iter; left time: 1467.1403s
Epoch: 10 cost time: 3.9296536445617676
Epoch: 10, Steps: 154 | Train Loss: 1.838 Vali Loss: 2.134 Vali Acc: 0.326 Test Loss: 2.134 Test Acc: 0.326
Validation loss decreased (-0.323580 --> -0.325607).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7451786
	speed: 0.1034s/iter; left time: 1423.3387s
Epoch: 11 cost time: 4.117161512374878
Epoch: 11, Steps: 154 | Train Loss: 1.825 Vali Loss: 2.159 Vali Acc: 0.325 Test Loss: 2.159 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2143378
	speed: 0.1056s/iter; left time: 1437.2224s
Epoch: 12 cost time: 4.138283729553223
Epoch: 12, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.135 Vali Acc: 0.329 Test Loss: 2.135 Test Acc: 0.329
Validation loss decreased (-0.325607 --> -0.329257).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.8197092
	speed: 0.1030s/iter; left time: 1385.2729s
Epoch: 13 cost time: 4.010634899139404
Epoch: 13, Steps: 154 | Train Loss: 1.790 Vali Loss: 2.173 Vali Acc: 0.331 Test Loss: 2.173 Test Acc: 0.331
Validation loss decreased (-0.329257 --> -0.331284).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.8869846
	speed: 0.1025s/iter; left time: 1362.5648s
Epoch: 14 cost time: 3.9648964405059814
Epoch: 14, Steps: 154 | Train Loss: 1.758 Vali Loss: 2.169 Vali Acc: 0.328 Test Loss: 2.169 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.0623980
	speed: 0.1009s/iter; left time: 1326.7588s
Epoch: 15 cost time: 4.075017213821411
Epoch: 15, Steps: 154 | Train Loss: 1.782 Vali Loss: 2.136 Vali Acc: 0.332 Test Loss: 2.136 Test Acc: 0.332
Validation loss decreased (-0.331284 --> -0.332095).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.4176137
	speed: 0.0947s/iter; left time: 1230.5565s
Epoch: 16 cost time: 4.021136999130249
Epoch: 16, Steps: 154 | Train Loss: 1.737 Vali Loss: 2.139 Vali Acc: 0.339 Test Loss: 2.139 Test Acc: 0.339
Validation loss decreased (-0.332095 --> -0.338584).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.8433952
	speed: 0.1060s/iter; left time: 1360.6496s
Epoch: 17 cost time: 4.080597400665283
Epoch: 17, Steps: 154 | Train Loss: 1.730 Vali Loss: 2.188 Vali Acc: 0.337 Test Loss: 2.188 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.2989901
	speed: 0.1037s/iter; left time: 1314.8476s
Epoch: 18 cost time: 4.32402229309082
Epoch: 18, Steps: 154 | Train Loss: 1.685 Vali Loss: 2.205 Vali Acc: 0.339 Test Loss: 2.205 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.9139585
	speed: 0.1060s/iter; left time: 1327.4969s
Epoch: 19 cost time: 4.099365949630737
Epoch: 19, Steps: 154 | Train Loss: 1.681 Vali Loss: 2.170 Vali Acc: 0.353 Test Loss: 2.170 Test Acc: 0.353
Validation loss decreased (-0.338584 --> -0.353182).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.7664069
	speed: 0.1020s/iter; left time: 1262.6591s
Epoch: 20 cost time: 4.177492141723633
Epoch: 20, Steps: 154 | Train Loss: 1.680 Vali Loss: 2.218 Vali Acc: 0.343 Test Loss: 2.218 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.6070861
	speed: 0.1030s/iter; left time: 1258.8416s
Epoch: 21 cost time: 4.152764081954956
Epoch: 21, Steps: 154 | Train Loss: 1.647 Vali Loss: 2.284 Vali Acc: 0.350 Test Loss: 2.284 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.4367322
	speed: 0.1010s/iter; left time: 1218.6467s
Epoch: 22 cost time: 4.034956216812134
Epoch: 22, Steps: 154 | Train Loss: 1.720 Vali Loss: 2.240 Vali Acc: 0.349 Test Loss: 2.240 Test Acc: 0.349
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.6741605
	speed: 0.0993s/iter; left time: 1183.4741s
Epoch: 23 cost time: 3.956352710723877
Epoch: 23, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.274 Vali Acc: 0.350 Test Loss: 2.274 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.1788863
	speed: 0.0972s/iter; left time: 1142.7617s
Epoch: 24 cost time: 3.9499309062957764
Epoch: 24, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.342 Vali Acc: 0.353 Test Loss: 2.342 Test Acc: 0.353
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.4578278
	speed: 0.1034s/iter; left time: 1199.4631s
Epoch: 25 cost time: 4.069535493850708
Epoch: 25, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.272 Vali Acc: 0.354 Test Loss: 2.272 Test Acc: 0.354
Validation loss decreased (-0.353182 --> -0.353992).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.9927562
	speed: 0.1048s/iter; left time: 1200.3817s
Epoch: 26 cost time: 4.1098668575286865
Epoch: 26, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.345 Vali Acc: 0.355 Test Loss: 2.345 Test Acc: 0.355
Validation loss decreased (-0.353992 --> -0.355208).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.6472819
	speed: 0.1051s/iter; left time: 1186.9392s
Epoch: 27 cost time: 3.955247163772583
Epoch: 27, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.371 Vali Acc: 0.352 Test Loss: 2.371 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 2.1425483
	speed: 0.1074s/iter; left time: 1197.2985s
Epoch: 28 cost time: 4.1847243309021
Epoch: 28, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.357 Vali Acc: 0.351 Test Loss: 2.357 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.1926744
	speed: 0.1069s/iter; left time: 1174.6881s
Epoch: 29 cost time: 4.051289319992065
Epoch: 29, Steps: 154 | Train Loss: 1.590 Vali Loss: 2.413 Vali Acc: 0.350 Test Loss: 2.413 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.7394576
	speed: 0.1035s/iter; left time: 1121.3164s
Epoch: 30 cost time: 4.045194149017334
Epoch: 30, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.350 Vali Acc: 0.355 Test Loss: 2.350 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 1.4105991
	speed: 0.1030s/iter; left time: 1100.2635s
Epoch: 31 cost time: 4.006513357162476
Epoch: 31, Steps: 154 | Train Loss: 1.572 Vali Loss: 2.366 Vali Acc: 0.358 Test Loss: 2.366 Test Acc: 0.358
Validation loss decreased (-0.355208 --> -0.357641).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.2261647
	speed: 0.1003s/iter; left time: 1055.7970s
Epoch: 32 cost time: 4.108827829360962
Epoch: 32, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.441 Vali Acc: 0.360 Test Loss: 2.441 Test Acc: 0.360
Validation loss decreased (-0.357641 --> -0.359667).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.7941199
	speed: 0.1013s/iter; left time: 1050.9212s
Epoch: 33 cost time: 3.9913575649261475
Epoch: 33, Steps: 154 | Train Loss: 1.578 Vali Loss: 2.481 Vali Acc: 0.355 Test Loss: 2.481 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 1.5357316
	speed: 0.1023s/iter; left time: 1045.7089s
Epoch: 34 cost time: 4.1298182010650635
Epoch: 34, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.444 Vali Acc: 0.361 Test Loss: 2.444 Test Acc: 0.361
Validation loss decreased (-0.359667 --> -0.360884).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.4622231
	speed: 0.1056s/iter; left time: 1063.0212s
Epoch: 35 cost time: 4.161703586578369
Epoch: 35, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.579 Vali Acc: 0.355 Test Loss: 2.579 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 1.7271158
	speed: 0.1054s/iter; left time: 1044.7534s
Epoch: 36 cost time: 4.129824876785278
Epoch: 36, Steps: 154 | Train Loss: 1.473 Vali Loss: 2.580 Vali Acc: 0.354 Test Loss: 2.580 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 1.2021502
	speed: 0.1035s/iter; left time: 1009.9084s
Epoch: 37 cost time: 4.083211183547974
Epoch: 37, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.598 Vali Acc: 0.361 Test Loss: 2.598 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 1.2897019
	speed: 0.1057s/iter; left time: 1014.9626s
Epoch: 38 cost time: 4.128491163253784
Epoch: 38, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.574 Vali Acc: 0.363 Test Loss: 2.574 Test Acc: 0.363
Validation loss decreased (-0.360884 --> -0.363316).  Saving model ...
	iters: 100, epoch: 39 | loss: 1.4323974
	speed: 0.0967s/iter; left time: 913.5940s
Epoch: 39 cost time: 4.338495254516602
Epoch: 39, Steps: 154 | Train Loss: 1.688 Vali Loss: 2.619 Vali Acc: 0.366 Test Loss: 2.619 Test Acc: 0.366
Validation loss decreased (-0.363316 --> -0.366154).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.6061260
	speed: 0.1093s/iter; left time: 1015.9453s
Epoch: 40 cost time: 3.910118341445923
Epoch: 40, Steps: 154 | Train Loss: 1.417 Vali Loss: 2.583 Vali Acc: 0.365 Test Loss: 2.583 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 6.0953083
	speed: 0.0879s/iter; left time: 803.3747s
Epoch: 41 cost time: 3.412890911102295
Epoch: 41, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.661 Vali Acc: 0.370 Test Loss: 2.661 Test Acc: 0.370
Validation loss decreased (-0.366154 --> -0.370209).  Saving model ...
	iters: 100, epoch: 42 | loss: 1.0736690
	speed: 0.0910s/iter; left time: 817.9120s
Epoch: 42 cost time: 3.7219045162200928
Epoch: 42, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.729 Vali Acc: 0.371 Test Loss: 2.729 Test Acc: 0.371
Validation loss decreased (-0.370209 --> -0.371424).  Saving model ...
	iters: 100, epoch: 43 | loss: 1.5470772
	speed: 0.0991s/iter; left time: 875.5898s
Epoch: 43 cost time: 3.977742910385132
Epoch: 43, Steps: 154 | Train Loss: 1.441 Vali Loss: 2.637 Vali Acc: 0.366 Test Loss: 2.637 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 0.8710941
	speed: 0.1021s/iter; left time: 885.7690s
Epoch: 44 cost time: 3.9927310943603516
Epoch: 44, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.715 Vali Acc: 0.361 Test Loss: 2.715 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 4.1734395
	speed: 0.1003s/iter; left time: 855.0686s
Epoch: 45 cost time: 3.911597967147827
Epoch: 45, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.959 Vali Acc: 0.364 Test Loss: 2.959 Test Acc: 0.364
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 46 | loss: 2.2453566
	speed: 0.0996s/iter; left time: 833.5696s
Epoch: 46 cost time: 3.886833906173706
Epoch: 46, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.842 Vali Acc: 0.374 Test Loss: 2.842 Test Acc: 0.374
Validation loss decreased (-0.371424 --> -0.373856).  Saving model ...
	iters: 100, epoch: 47 | loss: 1.1850034
	speed: 0.1004s/iter; left time: 824.7927s
Epoch: 47 cost time: 3.9022891521453857
Epoch: 47, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.794 Vali Acc: 0.367 Test Loss: 2.794 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 48 | loss: 2.2649131
	speed: 0.1064s/iter; left time: 857.8414s
Epoch: 48 cost time: 4.034748315811157
Epoch: 48, Steps: 154 | Train Loss: 1.511 Vali Loss: 2.867 Vali Acc: 0.368 Test Loss: 2.867 Test Acc: 0.368
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 49 | loss: 1.6437513
	speed: 0.1018s/iter; left time: 804.7642s
Epoch: 49 cost time: 3.875598430633545
Epoch: 49, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.863 Vali Acc: 0.369 Test Loss: 2.863 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 50 | loss: 1.7012138
	speed: 0.1034s/iter; left time: 801.5466s
Epoch: 50 cost time: 4.08315896987915
Epoch: 50, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.851 Vali Acc: 0.375 Test Loss: 2.851 Test Acc: 0.375
Validation loss decreased (-0.373856 --> -0.375073).  Saving model ...
	iters: 100, epoch: 51 | loss: 1.3718195
	speed: 0.1042s/iter; left time: 791.6684s
Epoch: 51 cost time: 4.0278871059417725
Epoch: 51, Steps: 154 | Train Loss: 1.376 Vali Loss: 2.918 Vali Acc: 0.374 Test Loss: 2.918 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 52 | loss: 1.3766438
	speed: 0.1023s/iter; left time: 762.0240s
Epoch: 52 cost time: 4.08541464805603
Epoch: 52, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.950 Vali Acc: 0.371 Test Loss: 2.950 Test Acc: 0.371
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 53 | loss: 1.3617573
	speed: 0.0983s/iter; left time: 716.8923s
Epoch: 53 cost time: 3.883321762084961
Epoch: 53, Steps: 154 | Train Loss: 1.397 Vali Loss: 3.109 Vali Acc: 0.375 Test Loss: 3.109 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 54 | loss: 1.0055362
	speed: 0.0998s/iter; left time: 712.6864s
Epoch: 54 cost time: 4.325193643569946
Epoch: 54, Steps: 154 | Train Loss: 1.411 Vali Loss: 2.897 Vali Acc: 0.375 Test Loss: 2.897 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 55 | loss: 1.2162189
	speed: 0.1014s/iter; left time: 708.2214s
Epoch: 55 cost time: 4.021716117858887
Epoch: 55, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.898 Vali Acc: 0.375 Test Loss: 2.898 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 56 | loss: 1.4498618
	speed: 0.0995s/iter; left time: 679.6867s
Epoch: 56 cost time: 3.878854990005493
Epoch: 56, Steps: 154 | Train Loss: 1.315 Vali Loss: 2.954 Vali Acc: 0.241 Test Loss: 2.954 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 57 | loss: 1.1292137
	speed: 0.0978s/iter; left time: 652.7686s
Epoch: 57 cost time: 3.921283721923828
Epoch: 57, Steps: 154 | Train Loss: 1.622 Vali Loss: 3.270 Vali Acc: 0.384 Test Loss: 3.270 Test Acc: 0.384
Validation loss decreased (-0.375073 --> -0.384396).  Saving model ...
	iters: 100, epoch: 58 | loss: 1.2219284
	speed: 0.1060s/iter; left time: 691.1821s
Epoch: 58 cost time: 4.04826807975769
Epoch: 58, Steps: 154 | Train Loss: 1.347 Vali Loss: 3.089 Vali Acc: 0.373 Test Loss: 3.089 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 59 | loss: 1.3315225
	speed: 0.1047s/iter; left time: 666.9587s
Epoch: 59 cost time: 3.9535698890686035
Epoch: 59, Steps: 154 | Train Loss: 1.455 Vali Loss: 3.246 Vali Acc: 0.380 Test Loss: 3.246 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 60 | loss: 1.4392364
	speed: 0.1037s/iter; left time: 644.2429s
Epoch: 60 cost time: 4.17230486869812
Epoch: 60, Steps: 154 | Train Loss: 1.290 Vali Loss: 2.978 Vali Acc: 0.384 Test Loss: 2.978 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 61 | loss: 1.1054554
	speed: 0.1060s/iter; left time: 642.5271s
Epoch: 61 cost time: 3.9037914276123047
Epoch: 61, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.785 Vali Acc: 0.379 Test Loss: 2.785 Test Acc: 0.379
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 62 | loss: 1.5800574
	speed: 0.0983s/iter; left time: 580.4157s
Epoch: 62 cost time: 3.932130813598633
Epoch: 62, Steps: 154 | Train Loss: 1.282 Vali Loss: 3.454 Vali Acc: 0.374 Test Loss: 3.454 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 63 | loss: 1.2209110
	speed: 0.1009s/iter; left time: 580.5829s
Epoch: 63 cost time: 3.972762107849121
Epoch: 63, Steps: 154 | Train Loss: 1.351 Vali Loss: 3.273 Vali Acc: 0.384 Test Loss: 3.273 Test Acc: 0.384
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 64 | loss: 1.0449511
	speed: 0.0990s/iter; left time: 554.1255s
Epoch: 64 cost time: 3.833250045776367
Epoch: 64, Steps: 154 | Train Loss: 1.300 Vali Loss: 3.277 Vali Acc: 0.376 Test Loss: 3.277 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 65 | loss: 1.0712513
	speed: 0.1004s/iter; left time: 546.5327s
Epoch: 65 cost time: 3.8901031017303467
Epoch: 65, Steps: 154 | Train Loss: 1.396 Vali Loss: 3.098 Vali Acc: 0.376 Test Loss: 3.098 Test Acc: 0.376
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 66 | loss: 1.3119365
	speed: 0.0994s/iter; left time: 526.0246s
Epoch: 66 cost time: 4.031656265258789
Epoch: 66, Steps: 154 | Train Loss: 1.302 Vali Loss: 3.191 Vali Acc: 0.377 Test Loss: 3.191 Test Acc: 0.377
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 67 | loss: 2.6014559
	speed: 0.0992s/iter; left time: 509.4529s
Epoch: 67 cost time: 3.9489622116088867
Epoch: 67, Steps: 154 | Train Loss: 1.333 Vali Loss: 3.264 Vali Acc: 0.378 Test Loss: 3.264 Test Acc: 0.378
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3844282238442822
model parameter : 27766
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0884011
	speed: 0.0442s/iter; left time: 676.4155s
Epoch: 1 cost time: 5.748243808746338
Epoch: 1, Steps: 154 | Train Loss: 2.295 Vali Loss: 2.171 Vali Acc: 0.315 Test Loss: 2.171 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1336401
	speed: 0.0982s/iter; left time: 1487.2501s
Epoch: 2 cost time: 3.7795798778533936
Epoch: 2, Steps: 154 | Train Loss: 2.080 Vali Loss: 2.147 Vali Acc: 0.316 Test Loss: 2.147 Test Acc: 0.316
Validation loss decreased (-0.315469 --> -0.315875).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9308503
	speed: 0.0949s/iter; left time: 1423.3161s
Epoch: 3 cost time: 4.001984596252441
Epoch: 3, Steps: 154 | Train Loss: 2.045 Vali Loss: 2.156 Vali Acc: 0.317 Test Loss: 2.156 Test Acc: 0.317
Validation loss decreased (-0.315875 --> -0.316686).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2088273
	speed: 0.1023s/iter; left time: 1518.3927s
Epoch: 4 cost time: 4.391364812850952
Epoch: 4, Steps: 154 | Train Loss: 2.009 Vali Loss: 2.137 Vali Acc: 0.318 Test Loss: 2.137 Test Acc: 0.318
Validation loss decreased (-0.316686 --> -0.317902).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9285090
	speed: 0.1015s/iter; left time: 1489.8184s
Epoch: 5 cost time: 4.11255669593811
Epoch: 5, Steps: 154 | Train Loss: 1.985 Vali Loss: 2.136 Vali Acc: 0.320 Test Loss: 2.136 Test Acc: 0.320
Validation loss decreased (-0.317902 --> -0.319524).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9345791
	speed: 0.0982s/iter; left time: 1426.7241s
Epoch: 6 cost time: 3.8388805389404297
Epoch: 6, Steps: 154 | Train Loss: 1.951 Vali Loss: 2.147 Vali Acc: 0.318 Test Loss: 2.147 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5607241
	speed: 0.0992s/iter; left time: 1425.6841s
Epoch: 7 cost time: 3.8180553913116455
Epoch: 7, Steps: 154 | Train Loss: 1.930 Vali Loss: 2.113 Vali Acc: 0.322 Test Loss: 2.113 Test Acc: 0.322
Validation loss decreased (-0.319524 --> -0.321958).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8080555
	speed: 0.1014s/iter; left time: 1442.8003s
Epoch: 8 cost time: 3.9975504875183105
Epoch: 8, Steps: 154 | Train Loss: 1.897 Vali Loss: 2.129 Vali Acc: 0.321 Test Loss: 2.129 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8569810
	speed: 0.1061s/iter; left time: 1492.3143s
Epoch: 9 cost time: 3.97405743598938
Epoch: 9, Steps: 154 | Train Loss: 1.879 Vali Loss: 2.116 Vali Acc: 0.322 Test Loss: 2.116 Test Acc: 0.322
Validation loss decreased (-0.321958 --> -0.322363).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4681013
	speed: 0.1038s/iter; left time: 1444.6234s
Epoch: 10 cost time: 3.868230104446411
Epoch: 10, Steps: 154 | Train Loss: 1.848 Vali Loss: 2.136 Vali Acc: 0.327 Test Loss: 2.136 Test Acc: 0.327
Validation loss decreased (-0.322363 --> -0.326824).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7926722
	speed: 0.1041s/iter; left time: 1432.9952s
Epoch: 11 cost time: 3.928156614303589
Epoch: 11, Steps: 154 | Train Loss: 1.825 Vali Loss: 2.137 Vali Acc: 0.328 Test Loss: 2.137 Test Acc: 0.328
Validation loss decreased (-0.326824 --> -0.328446).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2107713
	speed: 0.1019s/iter; left time: 1386.4900s
Epoch: 12 cost time: 3.77651047706604
Epoch: 12, Steps: 154 | Train Loss: 1.818 Vali Loss: 2.124 Vali Acc: 0.333 Test Loss: 2.124 Test Acc: 0.333
Validation loss decreased (-0.328446 --> -0.332501).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.8484600
	speed: 0.0936s/iter; left time: 1259.5661s
Epoch: 13 cost time: 3.9428303241729736
Epoch: 13, Steps: 154 | Train Loss: 1.796 Vali Loss: 2.162 Vali Acc: 0.333 Test Loss: 2.162 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.8091135
	speed: 0.1006s/iter; left time: 1337.6267s
Epoch: 14 cost time: 3.9171957969665527
Epoch: 14, Steps: 154 | Train Loss: 1.757 Vali Loss: 2.178 Vali Acc: 0.330 Test Loss: 2.178 Test Acc: 0.330
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.0967450
	speed: 0.0979s/iter; left time: 1286.4937s
Epoch: 15 cost time: 3.802457809448242
Epoch: 15, Steps: 154 | Train Loss: 1.768 Vali Loss: 2.165 Vali Acc: 0.333 Test Loss: 2.165 Test Acc: 0.333
Validation loss decreased (-0.332501 --> -0.332906).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5305603
	speed: 0.0972s/iter; left time: 1263.2201s
Epoch: 16 cost time: 4.059304475784302
Epoch: 16, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.187 Vali Acc: 0.342 Test Loss: 2.187 Test Acc: 0.342
Validation loss decreased (-0.332906 --> -0.342233).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.7353711
	speed: 0.0973s/iter; left time: 1248.9836s
Epoch: 17 cost time: 3.907092332839966
Epoch: 17, Steps: 154 | Train Loss: 1.765 Vali Loss: 2.214 Vali Acc: 0.341 Test Loss: 2.214 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.4854810
	speed: 0.0977s/iter; left time: 1239.3634s
Epoch: 18 cost time: 3.9946649074554443
Epoch: 18, Steps: 154 | Train Loss: 1.749 Vali Loss: 2.252 Vali Acc: 0.342 Test Loss: 2.252 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.8086435
	speed: 0.1047s/iter; left time: 1311.1730s
Epoch: 19 cost time: 4.081454038619995
Epoch: 19, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.254 Vali Acc: 0.352 Test Loss: 2.254 Test Acc: 0.352
Validation loss decreased (-0.342233 --> -0.352370).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.6656135
	speed: 0.0994s/iter; left time: 1229.7643s
Epoch: 20 cost time: 4.012299537658691
Epoch: 20, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.313 Vali Acc: 0.346 Test Loss: 2.313 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.6020833
	speed: 0.1019s/iter; left time: 1245.1997s
Epoch: 21 cost time: 3.8499398231506348
Epoch: 21, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.322 Vali Acc: 0.350 Test Loss: 2.322 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.4619961
	speed: 0.0936s/iter; left time: 1129.4210s
Epoch: 22 cost time: 3.777378559112549
Epoch: 22, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.346 Vali Acc: 0.349 Test Loss: 2.346 Test Acc: 0.349
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.7794690
	speed: 0.0922s/iter; left time: 1097.8556s
Epoch: 23 cost time: 3.9135613441467285
Epoch: 23, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.405 Vali Acc: 0.352 Test Loss: 2.405 Test Acc: 0.352
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.2941564
	speed: 0.0971s/iter; left time: 1142.3189s
Epoch: 24 cost time: 3.8811891078948975
Epoch: 24, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.429 Vali Acc: 0.356 Test Loss: 2.429 Test Acc: 0.356
Validation loss decreased (-0.352370 --> -0.355612).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.4439945
	speed: 0.1001s/iter; left time: 1161.3849s
Epoch: 25 cost time: 4.023681640625
Epoch: 25, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.329 Vali Acc: 0.354 Test Loss: 2.329 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.2322439
	speed: 0.0987s/iter; left time: 1129.8388s
Epoch: 26 cost time: 3.8299672603607178
Epoch: 26, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.428 Vali Acc: 0.358 Test Loss: 2.428 Test Acc: 0.358
Validation loss decreased (-0.355612 --> -0.358451).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.5625868
	speed: 0.1007s/iter; left time: 1137.6217s
Epoch: 27 cost time: 3.970306873321533
Epoch: 27, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.437 Vali Acc: 0.358 Test Loss: 2.437 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 2.6728158
	speed: 0.1045s/iter; left time: 1164.2105s
Epoch: 28 cost time: 4.132039308547974
Epoch: 28, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.528 Vali Acc: 0.352 Test Loss: 2.528 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.1208557
	speed: 0.1082s/iter; left time: 1189.0101s
Epoch: 29 cost time: 4.010434865951538
Epoch: 29, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.486 Vali Acc: 0.355 Test Loss: 2.486 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.6797247
	speed: 0.1016s/iter; left time: 1100.9330s
Epoch: 30 cost time: 3.852781057357788
Epoch: 30, Steps: 154 | Train Loss: 1.557 Vali Loss: 2.497 Vali Acc: 0.358 Test Loss: 2.497 Test Acc: 0.358
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 1.1017243
	speed: 0.1068s/iter; left time: 1140.3452s
Epoch: 31 cost time: 4.219423055648804
Epoch: 31, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.548 Vali Acc: 0.364 Test Loss: 2.548 Test Acc: 0.364
Validation loss decreased (-0.358451 --> -0.364127).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.2426226
	speed: 0.1015s/iter; left time: 1068.6791s
Epoch: 32 cost time: 3.876441717147827
Epoch: 32, Steps: 154 | Train Loss: 1.578 Vali Loss: 2.428 Vali Acc: 0.361 Test Loss: 2.428 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.8505002
	speed: 0.0989s/iter; left time: 1026.0121s
Epoch: 33 cost time: 3.9396519660949707
Epoch: 33, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.669 Vali Acc: 0.365 Test Loss: 2.669 Test Acc: 0.365
Validation loss decreased (-0.364127 --> -0.364531).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.5347340
	speed: 0.0989s/iter; left time: 1011.0923s
Epoch: 34 cost time: 3.9977169036865234
Epoch: 34, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.583 Vali Acc: 0.362 Test Loss: 2.583 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 1.4618044
	speed: 0.0991s/iter; left time: 997.3761s
Epoch: 35 cost time: 3.910574197769165
Epoch: 35, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.555 Vali Acc: 0.364 Test Loss: 2.555 Test Acc: 0.364
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 1.5068090
	speed: 0.1000s/iter; left time: 990.6823s
Epoch: 36 cost time: 3.923521041870117
Epoch: 36, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.588 Vali Acc: 0.359 Test Loss: 2.588 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 1.7954227
	speed: 0.1038s/iter; left time: 1013.2394s
Epoch: 37 cost time: 4.2416672706604
Epoch: 37, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.503 Vali Acc: 0.363 Test Loss: 2.503 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 1.2040058
	speed: 0.1049s/iter; left time: 1007.4434s
Epoch: 38 cost time: 3.964371919631958
Epoch: 38, Steps: 154 | Train Loss: 1.633 Vali Loss: 2.423 Vali Acc: 0.367 Test Loss: 2.423 Test Acc: 0.367
Validation loss decreased (-0.364531 --> -0.366967).  Saving model ...
	iters: 100, epoch: 39 | loss: 1.6549895
	speed: 0.1047s/iter; left time: 988.9433s
Epoch: 39 cost time: 4.035208463668823
Epoch: 39, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.467 Vali Acc: 0.366 Test Loss: 2.467 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 1.3978873
	speed: 0.1017s/iter; left time: 945.4942s
Epoch: 40 cost time: 4.073732614517212
Epoch: 40, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.562 Vali Acc: 0.365 Test Loss: 2.562 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 6.7342477
	speed: 0.1030s/iter; left time: 941.3542s
Epoch: 41 cost time: 3.8228697776794434
Epoch: 41, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.549 Vali Acc: 0.369 Test Loss: 2.549 Test Acc: 0.369
Validation loss decreased (-0.366967 --> -0.368588).  Saving model ...
	iters: 100, epoch: 42 | loss: 1.1486868
	speed: 0.1006s/iter; left time: 903.8449s
Epoch: 42 cost time: 4.0922276973724365
Epoch: 42, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.573 Vali Acc: 0.362 Test Loss: 2.573 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 1.2498944
	speed: 0.0948s/iter; left time: 837.3521s
Epoch: 43 cost time: 3.908724784851074
Epoch: 43, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.607 Vali Acc: 0.368 Test Loss: 2.607 Test Acc: 0.368
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 44 | loss: 0.9376780
	speed: 0.1007s/iter; left time: 874.3052s
Epoch: 44 cost time: 3.9485344886779785
Epoch: 44, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.597 Vali Acc: 0.376 Test Loss: 2.597 Test Acc: 0.376
Validation loss decreased (-0.368588 --> -0.375886).  Saving model ...
	iters: 100, epoch: 45 | loss: 1.4737545
	speed: 0.0996s/iter; left time: 848.7688s
Epoch: 45 cost time: 4.135603666305542
Epoch: 45, Steps: 154 | Train Loss: 1.333 Vali Loss: 2.639 Vali Acc: 0.367 Test Loss: 2.639 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 46 | loss: 1.2580552
	speed: 0.1007s/iter; left time: 842.6943s
Epoch: 46 cost time: 3.8343777656555176
Epoch: 46, Steps: 154 | Train Loss: 1.335 Vali Loss: 2.710 Vali Acc: 0.367 Test Loss: 2.710 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 47 | loss: 1.1979579
	speed: 0.1063s/iter; left time: 873.0915s
Epoch: 47 cost time: 4.097779273986816
Epoch: 47, Steps: 154 | Train Loss: 1.362 Vali Loss: 2.613 Vali Acc: 0.363 Test Loss: 2.613 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 48 | loss: 2.7602625
	speed: 0.1050s/iter; left time: 846.3320s
Epoch: 48 cost time: 4.066373348236084
Epoch: 48, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.520 Vali Acc: 0.376 Test Loss: 2.520 Test Acc: 0.376
Validation loss decreased (-0.375886 --> -0.376293).  Saving model ...
	iters: 100, epoch: 49 | loss: 1.0261252
	speed: 0.1022s/iter; left time: 808.5319s
Epoch: 49 cost time: 3.9874556064605713
Epoch: 49, Steps: 154 | Train Loss: 1.354 Vali Loss: 2.813 Vali Acc: 0.369 Test Loss: 2.813 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 50 | loss: 1.5340058
	speed: 0.0985s/iter; left time: 763.7574s
Epoch: 50 cost time: 3.812110662460327
Epoch: 50, Steps: 154 | Train Loss: 1.397 Vali Loss: 2.636 Vali Acc: 0.372 Test Loss: 2.636 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 51 | loss: 1.6801200
	speed: 0.0986s/iter; left time: 749.7855s
Epoch: 51 cost time: 3.8677825927734375
Epoch: 51, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.746 Vali Acc: 0.373 Test Loss: 2.746 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 52 | loss: 1.2639447
	speed: 0.0982s/iter; left time: 731.0473s
Epoch: 52 cost time: 3.9159579277038574
Epoch: 52, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.624 Vali Acc: 0.372 Test Loss: 2.624 Test Acc: 0.372
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 53 | loss: 1.4646415
	speed: 0.0964s/iter; left time: 702.8177s
Epoch: 53 cost time: 3.724560022354126
Epoch: 53, Steps: 154 | Train Loss: 1.351 Vali Loss: 2.717 Vali Acc: 0.369 Test Loss: 2.717 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 54 | loss: 0.9329455
	speed: 0.0966s/iter; left time: 689.8055s
Epoch: 54 cost time: 4.122701644897461
Epoch: 54, Steps: 154 | Train Loss: 1.409 Vali Loss: 2.603 Vali Acc: 0.375 Test Loss: 2.603 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 55 | loss: 1.2261651
	speed: 0.1000s/iter; left time: 698.7046s
Epoch: 55 cost time: 3.964944362640381
Epoch: 55, Steps: 154 | Train Loss: 1.448 Vali Loss: 2.736 Vali Acc: 0.373 Test Loss: 2.736 Test Acc: 0.373
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 56 | loss: 4.6642399
	speed: 0.0978s/iter; left time: 667.9916s
Epoch: 56 cost time: 3.812847137451172
Epoch: 56, Steps: 154 | Train Loss: 1.564 Vali Loss: 2.900 Vali Acc: 0.376 Test Loss: 2.900 Test Acc: 0.376
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 57 | loss: 1.8327198
	speed: 0.1014s/iter; left time: 676.7757s
Epoch: 57 cost time: 4.035480260848999
Epoch: 57, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.710 Vali Acc: 0.374 Test Loss: 2.710 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 58 | loss: 0.6006631
	speed: 0.0999s/iter; left time: 651.4660s
Epoch: 58 cost time: 3.9479939937591553
Epoch: 58, Steps: 154 | Train Loss: 1.329 Vali Loss: 2.826 Vali Acc: 0.372 Test Loss: 2.826 Test Acc: 0.372
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37631792376317924
model parameter : 27766
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0912004
	speed: 0.0418s/iter; left time: 639.5507s
Epoch: 1 cost time: 5.625168085098267
Epoch: 1, Steps: 154 | Train Loss: 2.322 Vali Loss: 2.152 Vali Acc: 0.315 Test Loss: 2.152 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1628215
	speed: 0.1054s/iter; left time: 1596.7430s
Epoch: 2 cost time: 4.159810543060303
Epoch: 2, Steps: 154 | Train Loss: 2.096 Vali Loss: 2.137 Vali Acc: 0.316 Test Loss: 2.137 Test Acc: 0.316
Validation loss decreased (-0.315469 --> -0.316280).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1617098
	speed: 0.1022s/iter; left time: 1532.1777s
Epoch: 3 cost time: 4.059948444366455
Epoch: 3, Steps: 154 | Train Loss: 2.050 Vali Loss: 2.155 Vali Acc: 0.318 Test Loss: 2.155 Test Acc: 0.318
Validation loss decreased (-0.316280 --> -0.317902).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1256940
	speed: 0.1037s/iter; left time: 1538.6824s
Epoch: 4 cost time: 4.0898597240448
Epoch: 4, Steps: 154 | Train Loss: 1.990 Vali Loss: 2.130 Vali Acc: 0.320 Test Loss: 2.130 Test Acc: 0.320
Validation loss decreased (-0.317902 --> -0.320336).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8784385
	speed: 0.1018s/iter; left time: 1495.2832s
Epoch: 5 cost time: 4.055273532867432
Epoch: 5, Steps: 154 | Train Loss: 1.951 Vali Loss: 2.134 Vali Acc: 0.319 Test Loss: 2.134 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7704424
	speed: 0.1019s/iter; left time: 1481.0177s
Epoch: 6 cost time: 3.966989517211914
Epoch: 6, Steps: 154 | Train Loss: 1.930 Vali Loss: 2.133 Vali Acc: 0.322 Test Loss: 2.133 Test Acc: 0.322
Validation loss decreased (-0.320336 --> -0.321552).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8450009
	speed: 0.1065s/iter; left time: 1531.3287s
Epoch: 7 cost time: 4.113858699798584
Epoch: 7, Steps: 154 | Train Loss: 1.887 Vali Loss: 2.126 Vali Acc: 0.323 Test Loss: 2.126 Test Acc: 0.323
Validation loss decreased (-0.321552 --> -0.322769).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6864121
	speed: 0.1061s/iter; left time: 1509.5336s
Epoch: 8 cost time: 4.0161120891571045
Epoch: 8, Steps: 154 | Train Loss: 1.879 Vali Loss: 2.142 Vali Acc: 0.324 Test Loss: 2.142 Test Acc: 0.324
Validation loss decreased (-0.322769 --> -0.323985).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7818655
	speed: 0.1031s/iter; left time: 1450.3556s
Epoch: 9 cost time: 3.995346784591675
Epoch: 9, Steps: 154 | Train Loss: 1.867 Vali Loss: 2.129 Vali Acc: 0.324 Test Loss: 2.129 Test Acc: 0.324
Validation loss decreased (-0.323985 --> -0.324391).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5821675
	speed: 0.1058s/iter; left time: 1471.8446s
Epoch: 10 cost time: 4.151163578033447
Epoch: 10, Steps: 154 | Train Loss: 1.833 Vali Loss: 2.143 Vali Acc: 0.324 Test Loss: 2.143 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.4122977
	speed: 0.0969s/iter; left time: 1334.0799s
Epoch: 11 cost time: 3.8555431365966797
Epoch: 11, Steps: 154 | Train Loss: 1.824 Vali Loss: 2.128 Vali Acc: 0.326 Test Loss: 2.128 Test Acc: 0.326
Validation loss decreased (-0.324391 --> -0.325607).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8843037
	speed: 0.0989s/iter; left time: 1346.1726s
Epoch: 12 cost time: 3.949080228805542
Epoch: 12, Steps: 154 | Train Loss: 1.782 Vali Loss: 2.170 Vali Acc: 0.326 Test Loss: 2.170 Test Acc: 0.326
Validation loss decreased (-0.325607 --> -0.326418).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.0559504
	speed: 0.1003s/iter; left time: 1349.2638s
Epoch: 13 cost time: 4.024884939193726
Epoch: 13, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.127 Vali Acc: 0.329 Test Loss: 2.127 Test Acc: 0.329
Validation loss decreased (-0.326418 --> -0.328851).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.1366570
	speed: 0.0998s/iter; left time: 1326.6361s
Epoch: 14 cost time: 3.85339617729187
Epoch: 14, Steps: 154 | Train Loss: 1.747 Vali Loss: 2.164 Vali Acc: 0.327 Test Loss: 2.164 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6426407
	speed: 0.0962s/iter; left time: 1264.5433s
Epoch: 15 cost time: 3.7319719791412354
Epoch: 15, Steps: 154 | Train Loss: 1.752 Vali Loss: 2.203 Vali Acc: 0.330 Test Loss: 2.203 Test Acc: 0.330
Validation loss decreased (-0.328851 --> -0.330067).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5110638
	speed: 0.0995s/iter; left time: 1292.4618s
Epoch: 16 cost time: 4.020816802978516
Epoch: 16, Steps: 154 | Train Loss: 1.723 Vali Loss: 2.187 Vali Acc: 0.330 Test Loss: 2.187 Test Acc: 0.330
Validation loss decreased (-0.330067 --> -0.330473).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.5251758
	speed: 0.1015s/iter; left time: 1302.7293s
Epoch: 17 cost time: 3.9537336826324463
Epoch: 17, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.195 Vali Acc: 0.330 Test Loss: 2.195 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.8699342
	speed: 0.1035s/iter; left time: 1312.5387s
Epoch: 18 cost time: 4.097232341766357
Epoch: 18, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.236 Vali Acc: 0.335 Test Loss: 2.236 Test Acc: 0.335
Validation loss decreased (-0.330473 --> -0.334528).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.7039754
	speed: 0.1109s/iter; left time: 1389.6303s
Epoch: 19 cost time: 4.33224630355835
Epoch: 19, Steps: 154 | Train Loss: 1.702 Vali Loss: 2.259 Vali Acc: 0.338 Test Loss: 2.259 Test Acc: 0.338
Validation loss decreased (-0.334528 --> -0.337771).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.6420485
	speed: 0.1043s/iter; left time: 1290.5919s
Epoch: 20 cost time: 4.068762540817261
Epoch: 20, Steps: 154 | Train Loss: 1.660 Vali Loss: 2.261 Vali Acc: 0.339 Test Loss: 2.261 Test Acc: 0.339
Validation loss decreased (-0.337771 --> -0.338582).  Saving model ...
	iters: 100, epoch: 21 | loss: 2.9801040
	speed: 0.1028s/iter; left time: 1256.8704s
Epoch: 21 cost time: 4.040844440460205
Epoch: 21, Steps: 154 | Train Loss: 1.713 Vali Loss: 2.271 Vali Acc: 0.339 Test Loss: 2.271 Test Acc: 0.339
Validation loss decreased (-0.338582 --> -0.339393).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.6090817
	speed: 0.1036s/iter; left time: 1250.3617s
Epoch: 22 cost time: 4.198821544647217
Epoch: 22, Steps: 154 | Train Loss: 1.715 Vali Loss: 2.322 Vali Acc: 0.342 Test Loss: 2.322 Test Acc: 0.342
Validation loss decreased (-0.339393 --> -0.341826).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.7091980
	speed: 0.1054s/iter; left time: 1255.5541s
Epoch: 23 cost time: 4.112646579742432
Epoch: 23, Steps: 154 | Train Loss: 1.625 Vali Loss: 2.260 Vali Acc: 0.342 Test Loss: 2.260 Test Acc: 0.342
Validation loss decreased (-0.341826 --> -0.341827).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.9410682
	speed: 0.1002s/iter; left time: 1178.5646s
Epoch: 24 cost time: 3.953692674636841
Epoch: 24, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.290 Vali Acc: 0.340 Test Loss: 2.290 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.6435177
	speed: 0.1014s/iter; left time: 1176.5471s
Epoch: 25 cost time: 4.074296712875366
Epoch: 25, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.257 Vali Acc: 0.343 Test Loss: 2.257 Test Acc: 0.343
Validation loss decreased (-0.341827 --> -0.342638).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.7059073
	speed: 0.1013s/iter; left time: 1160.1302s
Epoch: 26 cost time: 3.8388373851776123
Epoch: 26, Steps: 154 | Train Loss: 1.632 Vali Loss: 2.255 Vali Acc: 0.345 Test Loss: 2.255 Test Acc: 0.345
Validation loss decreased (-0.342638 --> -0.345071).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.7664231
	speed: 0.1015s/iter; left time: 1146.4359s
Epoch: 27 cost time: 3.918177604675293
Epoch: 27, Steps: 154 | Train Loss: 1.609 Vali Loss: 2.280 Vali Acc: 0.348 Test Loss: 2.280 Test Acc: 0.348
Validation loss decreased (-0.345071 --> -0.347504).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.8957524
	speed: 0.1046s/iter; left time: 1165.4622s
Epoch: 28 cost time: 4.2924864292144775
Epoch: 28, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.353 Vali Acc: 0.349 Test Loss: 2.353 Test Acc: 0.349
Validation loss decreased (-0.347504 --> -0.348719).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.4706043
	speed: 0.1044s/iter; left time: 1146.9171s
Epoch: 29 cost time: 3.993391990661621
Epoch: 29, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.332 Vali Acc: 0.348 Test Loss: 2.332 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.6246908
	speed: 0.0999s/iter; left time: 1082.0146s
Epoch: 30 cost time: 3.945018768310547
Epoch: 30, Steps: 154 | Train Loss: 1.564 Vali Loss: 2.357 Vali Acc: 0.347 Test Loss: 2.357 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.5405399
	speed: 0.1006s/iter; left time: 1074.5984s
Epoch: 31 cost time: 4.090512275695801
Epoch: 31, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.390 Vali Acc: 0.345 Test Loss: 2.390 Test Acc: 0.345
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.6570604
	speed: 0.1013s/iter; left time: 1066.7267s
Epoch: 32 cost time: 3.998279094696045
Epoch: 32, Steps: 154 | Train Loss: 1.581 Vali Loss: 2.330 Vali Acc: 0.353 Test Loss: 2.330 Test Acc: 0.353
Validation loss decreased (-0.348719 --> -0.352775).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.0644429
	speed: 0.0999s/iter; left time: 1036.0896s
Epoch: 33 cost time: 3.9692554473876953
Epoch: 33, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.349 Vali Acc: 0.350 Test Loss: 2.349 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 1.3356644
	speed: 0.1005s/iter; left time: 1026.5170s
Epoch: 34 cost time: 3.9137401580810547
Epoch: 34, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.342 Vali Acc: 0.353 Test Loss: 2.342 Test Acc: 0.353
Validation loss decreased (-0.352775 --> -0.353180).  Saving model ...
	iters: 100, epoch: 35 | loss: 1.4612682
	speed: 0.1024s/iter; left time: 1030.6871s
Epoch: 35 cost time: 4.099585771560669
Epoch: 35, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.373 Vali Acc: 0.360 Test Loss: 2.373 Test Acc: 0.360
Validation loss decreased (-0.353180 --> -0.360074).  Saving model ...
	iters: 100, epoch: 36 | loss: 1.4248192
	speed: 0.1100s/iter; left time: 1090.0419s
Epoch: 36 cost time: 3.943526029586792
Epoch: 36, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.466 Vali Acc: 0.354 Test Loss: 2.466 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 1.1339873
	speed: 0.1073s/iter; left time: 1046.8783s
Epoch: 37 cost time: 4.259397745132446
Epoch: 37, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.404 Vali Acc: 0.357 Test Loss: 2.404 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 1.8782696
	speed: 0.1088s/iter; left time: 1044.8900s
Epoch: 38 cost time: 3.9594309329986572
Epoch: 38, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.428 Vali Acc: 0.361 Test Loss: 2.428 Test Acc: 0.361
Validation loss decreased (-0.360074 --> -0.360884).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.9881977
	speed: 0.1036s/iter; left time: 978.5455s
Epoch: 39 cost time: 4.117491245269775
Epoch: 39, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.332 Vali Acc: 0.361 Test Loss: 2.332 Test Acc: 0.361
Validation loss decreased (-0.360884 --> -0.361291).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.2998048
	speed: 0.1045s/iter; left time: 971.1613s
Epoch: 40 cost time: 4.154236316680908
Epoch: 40, Steps: 154 | Train Loss: 1.458 Vali Loss: 2.419 Vali Acc: 0.361 Test Loss: 2.419 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 1.5983778
	speed: 0.1032s/iter; left time: 943.5637s
Epoch: 41 cost time: 4.107905149459839
Epoch: 41, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.377 Vali Acc: 0.371 Test Loss: 2.377 Test Acc: 0.371
Validation loss decreased (-0.361291 --> -0.371428).  Saving model ...
	iters: 100, epoch: 42 | loss: 1.8172051
	speed: 0.1030s/iter; left time: 926.0504s
Epoch: 42 cost time: 4.039501667022705
Epoch: 42, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.461 Vali Acc: 0.343 Test Loss: 2.461 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 1.3303157
	speed: 0.1004s/iter; left time: 887.0278s
Epoch: 43 cost time: 3.9434149265289307
Epoch: 43, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.649 Vali Acc: 0.373 Test Loss: 2.649 Test Acc: 0.373
Validation loss decreased (-0.371428 --> -0.373453).  Saving model ...
	iters: 100, epoch: 44 | loss: 1.3869905
	speed: 0.1019s/iter; left time: 884.7004s
Epoch: 44 cost time: 4.055579423904419
Epoch: 44, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.630 Vali Acc: 0.365 Test Loss: 2.630 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 1.0780121
	speed: 0.1056s/iter; left time: 900.0390s
Epoch: 45 cost time: 4.047385215759277
Epoch: 45, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.488 Vali Acc: 0.357 Test Loss: 2.488 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 1.2777251
	speed: 0.0991s/iter; left time: 829.7528s
Epoch: 46 cost time: 4.0005199909210205
Epoch: 46, Steps: 154 | Train Loss: 1.518 Vali Loss: 2.720 Vali Acc: 0.366 Test Loss: 2.720 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 47 | loss: 1.3046796
	speed: 0.1045s/iter; left time: 859.0725s
Epoch: 47 cost time: 4.038523197174072
Epoch: 47, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.627 Vali Acc: 0.369 Test Loss: 2.627 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 48 | loss: 0.8348260
	speed: 0.1023s/iter; left time: 824.8263s
Epoch: 48 cost time: 3.985980749130249
Epoch: 48, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.681 Vali Acc: 0.374 Test Loss: 2.681 Test Acc: 0.374
Validation loss decreased (-0.373453 --> -0.373858).  Saving model ...
	iters: 100, epoch: 49 | loss: 1.6340537
	speed: 0.1040s/iter; left time: 822.7649s
Epoch: 49 cost time: 4.046491384506226
Epoch: 49, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.675 Vali Acc: 0.362 Test Loss: 2.675 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 50 | loss: 1.6492668
	speed: 0.1005s/iter; left time: 779.5150s
Epoch: 50 cost time: 3.917854070663452
Epoch: 50, Steps: 154 | Train Loss: 1.462 Vali Loss: 2.826 Vali Acc: 0.371 Test Loss: 2.826 Test Acc: 0.371
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 51 | loss: 1.3621817
	speed: 0.1023s/iter; left time: 777.3335s
Epoch: 51 cost time: 3.9644479751586914
Epoch: 51, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.801 Vali Acc: 0.366 Test Loss: 2.801 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 52 | loss: 1.3963203
	speed: 0.1018s/iter; left time: 757.8189s
Epoch: 52 cost time: 4.056045055389404
Epoch: 52, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.518 Vali Acc: 0.383 Test Loss: 2.518 Test Acc: 0.383
Validation loss decreased (-0.373858 --> -0.382781).  Saving model ...
	iters: 100, epoch: 53 | loss: 1.5827636
	speed: 0.1048s/iter; left time: 764.1677s
Epoch: 53 cost time: 4.193583011627197
Epoch: 53, Steps: 154 | Train Loss: 1.397 Vali Loss: 2.794 Vali Acc: 0.368 Test Loss: 2.794 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 54 | loss: 1.0798950
	speed: 0.1077s/iter; left time: 769.0812s
Epoch: 54 cost time: 4.198042154312134
Epoch: 54, Steps: 154 | Train Loss: 1.443 Vali Loss: 2.560 Vali Acc: 0.381 Test Loss: 2.560 Test Acc: 0.381
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 55 | loss: 1.3563955
	speed: 0.1087s/iter; left time: 759.1548s
Epoch: 55 cost time: 4.2738707065582275
Epoch: 55, Steps: 154 | Train Loss: 1.401 Vali Loss: 2.644 Vali Acc: 0.373 Test Loss: 2.644 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 56 | loss: 1.5724661
	speed: 0.1088s/iter; left time: 742.9857s
Epoch: 56 cost time: 4.191037893295288
Epoch: 56, Steps: 154 | Train Loss: 1.317 Vali Loss: 2.628 Vali Acc: 0.357 Test Loss: 2.628 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 57 | loss: 1.6807292
	speed: 0.1019s/iter; left time: 680.5858s
Epoch: 57 cost time: 4.078449010848999
Epoch: 57, Steps: 154 | Train Loss: 1.368 Vali Loss: 2.821 Vali Acc: 0.378 Test Loss: 2.821 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 58 | loss: 0.8950973
	speed: 0.0958s/iter; left time: 624.8820s
Epoch: 58 cost time: 4.069628715515137
Epoch: 58, Steps: 154 | Train Loss: 1.344 Vali Loss: 2.840 Vali Acc: 0.377 Test Loss: 2.840 Test Acc: 0.377
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 59 | loss: 1.1107457
	speed: 0.1029s/iter; left time: 655.0659s
Epoch: 59 cost time: 4.050977945327759
Epoch: 59, Steps: 154 | Train Loss: 1.425 Vali Loss: 2.517 Vali Acc: 0.382 Test Loss: 2.517 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 60 | loss: 0.9788280
	speed: 0.1023s/iter; left time: 635.5300s
Epoch: 60 cost time: 4.1015825271606445
Epoch: 60, Steps: 154 | Train Loss: 1.282 Vali Loss: 2.584 Vali Acc: 0.205 Test Loss: 2.584 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 61 | loss: 1.3171482
	speed: 0.1017s/iter; left time: 616.3090s
Epoch: 61 cost time: 4.161594390869141
Epoch: 61, Steps: 154 | Train Loss: 1.328 Vali Loss: 2.744 Vali Acc: 0.294 Test Loss: 2.744 Test Acc: 0.294
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 62 | loss: 1.3538364
	speed: 0.1002s/iter; left time: 592.0428s
Epoch: 62 cost time: 4.053754091262817
Epoch: 62, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.710 Vali Acc: 0.243 Test Loss: 2.710 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38280616382806165
model parameter : 23670
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0168796
	speed: 0.0447s/iter; left time: 683.9801s
Epoch: 1 cost time: 5.829556941986084
Epoch: 1, Steps: 154 | Train Loss: 2.313 Vali Loss: 2.155 Vali Acc: 0.315 Test Loss: 2.155 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1554911
	speed: 0.1086s/iter; left time: 1645.3268s
Epoch: 2 cost time: 4.2651379108428955
Epoch: 2, Steps: 154 | Train Loss: 2.090 Vali Loss: 2.141 Vali Acc: 0.316 Test Loss: 2.141 Test Acc: 0.316
Validation loss decreased (-0.315064 --> -0.316280).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1513443
	speed: 0.1053s/iter; left time: 1578.8743s
Epoch: 3 cost time: 3.972193717956543
Epoch: 3, Steps: 154 | Train Loss: 2.050 Vali Loss: 2.156 Vali Acc: 0.318 Test Loss: 2.156 Test Acc: 0.318
Validation loss decreased (-0.316280 --> -0.318308).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1599047
	speed: 0.1029s/iter; left time: 1527.5399s
Epoch: 4 cost time: 4.077497720718384
Epoch: 4, Steps: 154 | Train Loss: 1.996 Vali Loss: 2.132 Vali Acc: 0.319 Test Loss: 2.132 Test Acc: 0.319
Validation loss decreased (-0.318308 --> -0.318713).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8919032
	speed: 0.0995s/iter; left time: 1460.5488s
Epoch: 5 cost time: 3.9113640785217285
Epoch: 5, Steps: 154 | Train Loss: 1.951 Vali Loss: 2.138 Vali Acc: 0.318 Test Loss: 2.138 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7596185
	speed: 0.1005s/iter; left time: 1461.0201s
Epoch: 6 cost time: 3.948019027709961
Epoch: 6, Steps: 154 | Train Loss: 1.931 Vali Loss: 2.144 Vali Acc: 0.322 Test Loss: 2.144 Test Acc: 0.322
Validation loss decreased (-0.318713 --> -0.321957).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7463526
	speed: 0.0977s/iter; left time: 1404.4268s
Epoch: 7 cost time: 4.047719717025757
Epoch: 7, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.136 Vali Acc: 0.322 Test Loss: 2.136 Test Acc: 0.322
Validation loss decreased (-0.321957 --> -0.322363).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6773536
	speed: 0.1007s/iter; left time: 1431.5585s
Epoch: 8 cost time: 3.971965789794922
Epoch: 8, Steps: 154 | Train Loss: 1.888 Vali Loss: 2.138 Vali Acc: 0.324 Test Loss: 2.138 Test Acc: 0.324
Validation loss decreased (-0.322363 --> -0.323580).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7757584
	speed: 0.1058s/iter; left time: 1488.8082s
Epoch: 9 cost time: 4.207258224487305
Epoch: 9, Steps: 154 | Train Loss: 1.878 Vali Loss: 2.133 Vali Acc: 0.325 Test Loss: 2.133 Test Acc: 0.325
Validation loss decreased (-0.323580 --> -0.324796).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5214779
	speed: 0.1043s/iter; left time: 1451.4466s
Epoch: 10 cost time: 4.024326801300049
Epoch: 10, Steps: 154 | Train Loss: 1.833 Vali Loss: 2.155 Vali Acc: 0.325 Test Loss: 2.155 Test Acc: 0.325
Validation loss decreased (-0.324796 --> -0.325201).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.8284743
	speed: 0.1061s/iter; left time: 1460.1635s
Epoch: 11 cost time: 4.059589862823486
Epoch: 11, Steps: 154 | Train Loss: 1.829 Vali Loss: 2.120 Vali Acc: 0.325 Test Loss: 2.120 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8905091
	speed: 0.1036s/iter; left time: 1409.1460s
Epoch: 12 cost time: 3.9612653255462646
Epoch: 12, Steps: 154 | Train Loss: 1.819 Vali Loss: 2.163 Vali Acc: 0.327 Test Loss: 2.163 Test Acc: 0.327
Validation loss decreased (-0.325201 --> -0.326823).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.0098283
	speed: 0.0998s/iter; left time: 1342.2483s
Epoch: 13 cost time: 4.105233192443848
Epoch: 13, Steps: 154 | Train Loss: 1.807 Vali Loss: 2.132 Vali Acc: 0.328 Test Loss: 2.132 Test Acc: 0.328
Validation loss decreased (-0.326823 --> -0.328040).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.1900587
	speed: 0.0997s/iter; left time: 1325.6417s
Epoch: 14 cost time: 3.882267475128174
Epoch: 14, Steps: 154 | Train Loss: 1.765 Vali Loss: 2.145 Vali Acc: 0.326 Test Loss: 2.145 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.5945206
	speed: 0.1005s/iter; left time: 1320.4555s
Epoch: 15 cost time: 4.008525848388672
Epoch: 15, Steps: 154 | Train Loss: 1.753 Vali Loss: 2.198 Vali Acc: 0.330 Test Loss: 2.198 Test Acc: 0.330
Validation loss decreased (-0.328040 --> -0.330473).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5004249
	speed: 0.1014s/iter; left time: 1316.8013s
Epoch: 16 cost time: 3.8943655490875244
Epoch: 16, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.187 Vali Acc: 0.329 Test Loss: 2.187 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.5098467
	speed: 0.0986s/iter; left time: 1266.2557s
Epoch: 17 cost time: 3.924215316772461
Epoch: 17, Steps: 154 | Train Loss: 1.755 Vali Loss: 2.189 Vali Acc: 0.333 Test Loss: 2.189 Test Acc: 0.333
Validation loss decreased (-0.330473 --> -0.333311).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.8928250
	speed: 0.1070s/iter; left time: 1356.6152s
Epoch: 18 cost time: 4.206576585769653
Epoch: 18, Steps: 154 | Train Loss: 1.702 Vali Loss: 2.199 Vali Acc: 0.337 Test Loss: 2.199 Test Acc: 0.337
Validation loss decreased (-0.333311 --> -0.336961).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.6886867
	speed: 0.1107s/iter; left time: 1386.4447s
Epoch: 19 cost time: 4.1165783405303955
Epoch: 19, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.200 Vali Acc: 0.340 Test Loss: 2.200 Test Acc: 0.340
Validation loss decreased (-0.336961 --> -0.340205).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.6144667
	speed: 0.1030s/iter; left time: 1275.1253s
Epoch: 20 cost time: 4.060798406600952
Epoch: 20, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.224 Vali Acc: 0.339 Test Loss: 2.224 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 5.3559670
	speed: 0.1043s/iter; left time: 1274.1321s
Epoch: 21 cost time: 4.125934839248657
Epoch: 21, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.199 Vali Acc: 0.339 Test Loss: 2.199 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.5507712
	speed: 0.0990s/iter; left time: 1194.7633s
Epoch: 22 cost time: 4.000470399856567
Epoch: 22, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.289 Vali Acc: 0.341 Test Loss: 2.289 Test Acc: 0.341
Validation loss decreased (-0.340205 --> -0.340610).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.7418206
	speed: 0.1009s/iter; left time: 1201.4447s
Epoch: 23 cost time: 4.073239088058472
Epoch: 23, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.178 Vali Acc: 0.347 Test Loss: 2.178 Test Acc: 0.347
Validation loss decreased (-0.340610 --> -0.347099).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.9034979
	speed: 0.0985s/iter; left time: 1157.9886s
Epoch: 24 cost time: 4.011000633239746
Epoch: 24, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.270 Vali Acc: 0.340 Test Loss: 2.270 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.5956607
	speed: 0.0996s/iter; left time: 1155.7349s
Epoch: 25 cost time: 4.032067060470581
Epoch: 25, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.217 Vali Acc: 0.347 Test Loss: 2.217 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.6717837
	speed: 0.0923s/iter; left time: 1057.1460s
Epoch: 26 cost time: 3.769822359085083
Epoch: 26, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.261 Vali Acc: 0.350 Test Loss: 2.261 Test Acc: 0.350
Validation loss decreased (-0.347099 --> -0.349531).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.7373672
	speed: 0.0995s/iter; left time: 1124.1863s
Epoch: 27 cost time: 4.2490458488464355
Epoch: 27, Steps: 154 | Train Loss: 1.668 Vali Loss: 2.340 Vali Acc: 0.352 Test Loss: 2.340 Test Acc: 0.352
Validation loss decreased (-0.349531 --> -0.351964).  Saving model ...
	iters: 100, epoch: 28 | loss: 2.0517676
	speed: 0.1065s/iter; left time: 1186.5642s
Epoch: 28 cost time: 4.1344685554504395
Epoch: 28, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.359 Vali Acc: 0.349 Test Loss: 2.359 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.6222043
	speed: 0.1074s/iter; left time: 1180.0380s
Epoch: 29 cost time: 4.2682647705078125
Epoch: 29, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.336 Vali Acc: 0.354 Test Loss: 2.336 Test Acc: 0.354
Validation loss decreased (-0.351964 --> -0.353991).  Saving model ...
	iters: 100, epoch: 30 | loss: 1.6479613
	speed: 0.1101s/iter; left time: 1192.6874s
Epoch: 30 cost time: 4.253328561782837
Epoch: 30, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.409 Vali Acc: 0.349 Test Loss: 2.409 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 1.4493961
	speed: 0.1075s/iter; left time: 1148.1715s
Epoch: 31 cost time: 4.008694887161255
Epoch: 31, Steps: 154 | Train Loss: 1.635 Vali Loss: 2.405 Vali Acc: 0.354 Test Loss: 2.405 Test Acc: 0.354
Validation loss decreased (-0.353991 --> -0.354396).  Saving model ...
	iters: 100, epoch: 32 | loss: 1.5914779
	speed: 0.1039s/iter; left time: 1093.8330s
Epoch: 32 cost time: 4.103627681732178
Epoch: 32, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.340 Vali Acc: 0.355 Test Loss: 2.340 Test Acc: 0.355
Validation loss decreased (-0.354396 --> -0.355208).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.0152460
	speed: 0.1012s/iter; left time: 1049.7693s
Epoch: 33 cost time: 4.070293188095093
Epoch: 33, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.281 Vali Acc: 0.357 Test Loss: 2.281 Test Acc: 0.357
Validation loss decreased (-0.355208 --> -0.356830).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.4044129
	speed: 0.1003s/iter; left time: 1024.8551s
Epoch: 34 cost time: 3.977738857269287
Epoch: 34, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.300 Vali Acc: 0.356 Test Loss: 2.300 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 1.4240907
	speed: 0.0978s/iter; left time: 984.3948s
Epoch: 35 cost time: 3.950186252593994
Epoch: 35, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.436 Vali Acc: 0.362 Test Loss: 2.436 Test Acc: 0.362
Validation loss decreased (-0.356830 --> -0.361695).  Saving model ...
	iters: 100, epoch: 36 | loss: 1.5273280
	speed: 0.0981s/iter; left time: 972.4967s
Epoch: 36 cost time: 3.848663806915283
Epoch: 36, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.418 Vali Acc: 0.358 Test Loss: 2.418 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 1.1442139
	speed: 0.1037s/iter; left time: 1012.2122s
Epoch: 37 cost time: 3.942085027694702
Epoch: 37, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.379 Vali Acc: 0.363 Test Loss: 2.379 Test Acc: 0.363
Validation loss decreased (-0.361695 --> -0.362507).  Saving model ...
	iters: 100, epoch: 38 | loss: 1.7689112
	speed: 0.1040s/iter; left time: 998.2802s
Epoch: 38 cost time: 3.988274574279785
Epoch: 38, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.516 Vali Acc: 0.367 Test Loss: 2.516 Test Acc: 0.367
Validation loss decreased (-0.362507 --> -0.367371).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.8776352
	speed: 0.1009s/iter; left time: 953.6838s
Epoch: 39 cost time: 4.128180265426636
Epoch: 39, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.415 Vali Acc: 0.365 Test Loss: 2.415 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 1.3351889
	speed: 0.1034s/iter; left time: 960.7339s
Epoch: 40 cost time: 4.0462706089019775
Epoch: 40, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.480 Vali Acc: 0.361 Test Loss: 2.480 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 1.4756622
	speed: 0.1005s/iter; left time: 919.0360s
Epoch: 41 cost time: 4.029531240463257
Epoch: 41, Steps: 154 | Train Loss: 1.411 Vali Loss: 2.490 Vali Acc: 0.367 Test Loss: 2.490 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 42 | loss: 1.7671586
	speed: 0.1014s/iter; left time: 911.0485s
Epoch: 42 cost time: 4.1164231300354
Epoch: 42, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.675 Vali Acc: 0.350 Test Loss: 2.675 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 43 | loss: 1.4079260
	speed: 0.1026s/iter; left time: 906.5821s
Epoch: 43 cost time: 4.106144905090332
Epoch: 43, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.654 Vali Acc: 0.375 Test Loss: 2.654 Test Acc: 0.375
Validation loss decreased (-0.367371 --> -0.375075).  Saving model ...
	iters: 100, epoch: 44 | loss: 1.4193745
	speed: 0.1043s/iter; left time: 904.7899s
Epoch: 44 cost time: 4.259368181228638
Epoch: 44, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.519 Vali Acc: 0.370 Test Loss: 2.519 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 1.0674757
	speed: 0.1021s/iter; left time: 870.4187s
Epoch: 45 cost time: 4.0900962352752686
Epoch: 45, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.497 Vali Acc: 0.365 Test Loss: 2.497 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 1.2680442
	speed: 0.1045s/iter; left time: 874.5975s
Epoch: 46 cost time: 4.140965461730957
Epoch: 46, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.630 Vali Acc: 0.371 Test Loss: 2.630 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 47 | loss: 1.3367246
	speed: 0.1075s/iter; left time: 883.1809s
Epoch: 47 cost time: 4.259472370147705
Epoch: 47, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.643 Vali Acc: 0.369 Test Loss: 2.643 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 48 | loss: 1.0577900
	speed: 0.1027s/iter; left time: 827.9208s
Epoch: 48 cost time: 3.9647088050842285
Epoch: 48, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.724 Vali Acc: 0.370 Test Loss: 2.724 Test Acc: 0.370
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 49 | loss: 1.6943097
	speed: 0.1040s/iter; left time: 822.3480s
Epoch: 49 cost time: 4.145798683166504
Epoch: 49, Steps: 154 | Train Loss: 1.405 Vali Loss: 2.821 Vali Acc: 0.368 Test Loss: 2.821 Test Acc: 0.368
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 50 | loss: 1.9416448
	speed: 0.1023s/iter; left time: 793.6661s
Epoch: 50 cost time: 4.642438650131226
Epoch: 50, Steps: 154 | Train Loss: 1.417 Vali Loss: 3.047 Vali Acc: 0.376 Test Loss: 3.047 Test Acc: 0.376
Validation loss decreased (-0.375075 --> -0.376287).  Saving model ...
	iters: 100, epoch: 51 | loss: 1.2645756
	speed: 0.1049s/iter; left time: 797.3197s
Epoch: 51 cost time: 3.433704376220703
Epoch: 51, Steps: 154 | Train Loss: 1.330 Vali Loss: 2.911 Vali Acc: 0.367 Test Loss: 2.911 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 52 | loss: 1.2962215
	speed: 0.0827s/iter; left time: 616.0601s
Epoch: 52 cost time: 3.3274757862091064
Epoch: 52, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.744 Vali Acc: 0.381 Test Loss: 2.744 Test Acc: 0.381
Validation loss decreased (-0.376287 --> -0.380751).  Saving model ...
	iters: 100, epoch: 53 | loss: 1.5067333
	speed: 0.0898s/iter; left time: 655.0039s
Epoch: 53 cost time: 4.040308475494385
Epoch: 53, Steps: 154 | Train Loss: 1.328 Vali Loss: 3.206 Vali Acc: 0.366 Test Loss: 3.206 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 54 | loss: 1.1513610
	speed: 0.0971s/iter; left time: 692.9814s
Epoch: 54 cost time: 3.8610873222351074
Epoch: 54, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.981 Vali Acc: 0.376 Test Loss: 2.981 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 55 | loss: 1.4511447
	speed: 0.0983s/iter; left time: 686.8783s
Epoch: 55 cost time: 4.056167125701904
Epoch: 55, Steps: 154 | Train Loss: 1.652 Vali Loss: 2.632 Vali Acc: 0.378 Test Loss: 2.632 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 56 | loss: 1.6679442
	speed: 0.1031s/iter; left time: 704.4766s
Epoch: 56 cost time: 4.048121690750122
Epoch: 56, Steps: 154 | Train Loss: 1.354 Vali Loss: 2.724 Vali Acc: 0.299 Test Loss: 2.724 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 57 | loss: 1.6787432
	speed: 0.1045s/iter; left time: 698.0345s
Epoch: 57 cost time: 4.0101776123046875
Epoch: 57, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.604 Vali Acc: 0.372 Test Loss: 2.604 Test Acc: 0.372
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 58 | loss: 0.8967538
	speed: 0.1006s/iter; left time: 656.0407s
Epoch: 58 cost time: 3.9254965782165527
Epoch: 58, Steps: 154 | Train Loss: 1.372 Vali Loss: 2.605 Vali Acc: 0.380 Test Loss: 2.605 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 59 | loss: 1.1127594
	speed: 0.1073s/iter; left time: 683.5339s
Epoch: 59 cost time: 4.1557958126068115
Epoch: 59, Steps: 154 | Train Loss: 1.372 Vali Loss: 2.714 Vali Acc: 0.378 Test Loss: 2.714 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 60 | loss: 1.0175370
	speed: 0.1071s/iter; left time: 665.6654s
Epoch: 60 cost time: 4.093957424163818
Epoch: 60, Steps: 154 | Train Loss: 1.412 Vali Loss: 2.647 Vali Acc: 0.208 Test Loss: 2.647 Test Acc: 0.208
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 61 | loss: 1.3981967
	speed: 0.1050s/iter; left time: 636.5705s
Epoch: 61 cost time: 4.139156341552734
Epoch: 61, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.868 Vali Acc: 0.375 Test Loss: 2.868 Test Acc: 0.375
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 62 | loss: 1.3701217
	speed: 0.1060s/iter; left time: 626.1015s
Epoch: 62 cost time: 3.9745020866394043
Epoch: 62, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.704 Vali Acc: 0.230 Test Loss: 2.704 Test Acc: 0.230
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38077858880778587
model parameter : 23670
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0203693
	speed: 0.0440s/iter; left time: 673.0383s
Epoch: 1 cost time: 5.753559112548828
Epoch: 1, Steps: 154 | Train Loss: 2.306 Vali Loss: 2.160 Vali Acc: 0.315 Test Loss: 2.160 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1563921
	speed: 0.1009s/iter; left time: 1529.0175s
Epoch: 2 cost time: 4.178402900695801
Epoch: 2, Steps: 154 | Train Loss: 2.090 Vali Loss: 2.143 Vali Acc: 0.316 Test Loss: 2.143 Test Acc: 0.316
Validation loss decreased (-0.315469 --> -0.315875).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1622379
	speed: 0.1014s/iter; left time: 1519.8479s
Epoch: 3 cost time: 3.9749948978424072
Epoch: 3, Steps: 154 | Train Loss: 2.052 Vali Loss: 2.154 Vali Acc: 0.318 Test Loss: 2.154 Test Acc: 0.318
Validation loss decreased (-0.315875 --> -0.317902).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1697333
	speed: 0.1006s/iter; left time: 1492.3753s
Epoch: 4 cost time: 4.0001068115234375
Epoch: 4, Steps: 154 | Train Loss: 1.999 Vali Loss: 2.130 Vali Acc: 0.318 Test Loss: 2.130 Test Acc: 0.318
Validation loss decreased (-0.317902 --> -0.317902).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9231142
	speed: 0.1071s/iter; left time: 1572.6083s
Epoch: 5 cost time: 4.1239166259765625
Epoch: 5, Steps: 154 | Train Loss: 1.957 Vali Loss: 2.132 Vali Acc: 0.318 Test Loss: 2.132 Test Acc: 0.318
Validation loss decreased (-0.317902 --> -0.318308).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7446498
	speed: 0.1082s/iter; left time: 1571.6000s
Epoch: 6 cost time: 4.270881175994873
Epoch: 6, Steps: 154 | Train Loss: 1.938 Vali Loss: 2.137 Vali Acc: 0.322 Test Loss: 2.137 Test Acc: 0.322
Validation loss decreased (-0.318308 --> -0.321958).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7567393
	speed: 0.1101s/iter; left time: 1583.3439s
Epoch: 7 cost time: 4.283534288406372
Epoch: 7, Steps: 154 | Train Loss: 1.902 Vali Loss: 2.132 Vali Acc: 0.321 Test Loss: 2.132 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8042508
	speed: 0.1085s/iter; left time: 1543.3416s
Epoch: 8 cost time: 4.4550230503082275
Epoch: 8, Steps: 154 | Train Loss: 1.887 Vali Loss: 2.120 Vali Acc: 0.323 Test Loss: 2.120 Test Acc: 0.323
Validation loss decreased (-0.321958 --> -0.322769).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8083833
	speed: 0.1056s/iter; left time: 1486.3777s
Epoch: 9 cost time: 4.193273305892944
Epoch: 9, Steps: 154 | Train Loss: 1.877 Vali Loss: 2.117 Vali Acc: 0.324 Test Loss: 2.117 Test Acc: 0.324
Validation loss decreased (-0.322769 --> -0.323985).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5659494
	speed: 0.1060s/iter; left time: 1474.6122s
Epoch: 10 cost time: 4.043320894241333
Epoch: 10, Steps: 154 | Train Loss: 1.837 Vali Loss: 2.128 Vali Acc: 0.323 Test Loss: 2.128 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 3.6508465
	speed: 0.1001s/iter; left time: 1377.7297s
Epoch: 11 cost time: 4.116664409637451
Epoch: 11, Steps: 154 | Train Loss: 1.817 Vali Loss: 2.114 Vali Acc: 0.326 Test Loss: 2.114 Test Acc: 0.326
Validation loss decreased (-0.323985 --> -0.326013).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8807646
	speed: 0.1014s/iter; left time: 1379.2758s
Epoch: 12 cost time: 3.9993486404418945
Epoch: 12, Steps: 154 | Train Loss: 1.802 Vali Loss: 2.163 Vali Acc: 0.327 Test Loss: 2.163 Test Acc: 0.327
Validation loss decreased (-0.326013 --> -0.326823).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.0271552
	speed: 0.1003s/iter; left time: 1348.7251s
Epoch: 13 cost time: 4.0770745277404785
Epoch: 13, Steps: 154 | Train Loss: 1.783 Vali Loss: 2.127 Vali Acc: 0.330 Test Loss: 2.127 Test Acc: 0.330
Validation loss decreased (-0.326823 --> -0.330068).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.1680777
	speed: 0.1026s/iter; left time: 1364.6422s
Epoch: 14 cost time: 4.495392560958862
Epoch: 14, Steps: 154 | Train Loss: 1.782 Vali Loss: 2.176 Vali Acc: 0.328 Test Loss: 2.176 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.5623120
	speed: 0.1136s/iter; left time: 1493.8481s
Epoch: 15 cost time: 4.329239368438721
Epoch: 15, Steps: 154 | Train Loss: 1.791 Vali Loss: 2.203 Vali Acc: 0.332 Test Loss: 2.203 Test Acc: 0.332
Validation loss decreased (-0.330068 --> -0.332095).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4907767
	speed: 0.1079s/iter; left time: 1401.5074s
Epoch: 16 cost time: 4.215572834014893
Epoch: 16, Steps: 154 | Train Loss: 1.718 Vali Loss: 2.204 Vali Acc: 0.330 Test Loss: 2.204 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.5344442
	speed: 0.1101s/iter; left time: 1413.4080s
Epoch: 17 cost time: 4.266648530960083
Epoch: 17, Steps: 154 | Train Loss: 1.730 Vali Loss: 2.171 Vali Acc: 0.337 Test Loss: 2.171 Test Acc: 0.337
Validation loss decreased (-0.332095 --> -0.336961).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.8882742
	speed: 0.1062s/iter; left time: 1346.5757s
Epoch: 18 cost time: 4.004437446594238
Epoch: 18, Steps: 154 | Train Loss: 1.717 Vali Loss: 2.193 Vali Acc: 0.337 Test Loss: 2.193 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.7043531
	speed: 0.1049s/iter; left time: 1313.9316s
Epoch: 19 cost time: 4.256568670272827
Epoch: 19, Steps: 154 | Train Loss: 1.686 Vali Loss: 2.191 Vali Acc: 0.339 Test Loss: 2.191 Test Acc: 0.339
Validation loss decreased (-0.336961 --> -0.338583).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.5410055
	speed: 0.1074s/iter; left time: 1328.8984s
Epoch: 20 cost time: 4.343724727630615
Epoch: 20, Steps: 154 | Train Loss: 1.696 Vali Loss: 2.224 Vali Acc: 0.343 Test Loss: 2.224 Test Acc: 0.343
Validation loss decreased (-0.338583 --> -0.343449).  Saving model ...
	iters: 100, epoch: 21 | loss: 8.6112776
	speed: 0.0990s/iter; left time: 1209.4265s
Epoch: 21 cost time: 3.8936173915863037
Epoch: 21, Steps: 154 | Train Loss: 1.688 Vali Loss: 2.213 Vali Acc: 0.344 Test Loss: 2.213 Test Acc: 0.344
Validation loss decreased (-0.343449 --> -0.344260).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.5462538
	speed: 0.1025s/iter; left time: 1236.6392s
Epoch: 22 cost time: 4.197509527206421
Epoch: 22, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.300 Vali Acc: 0.344 Test Loss: 2.300 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.6412346
	speed: 0.1022s/iter; left time: 1217.7829s
Epoch: 23 cost time: 4.374939203262329
Epoch: 23, Steps: 154 | Train Loss: 1.660 Vali Loss: 2.225 Vali Acc: 0.350 Test Loss: 2.225 Test Acc: 0.350
Validation loss decreased (-0.344260 --> -0.349937).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.9269558
	speed: 0.1101s/iter; left time: 1294.2818s
Epoch: 24 cost time: 4.278562068939209
Epoch: 24, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.393 Vali Acc: 0.344 Test Loss: 2.393 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.6592267
	speed: 0.1075s/iter; left time: 1247.1189s
Epoch: 25 cost time: 4.244577646255493
Epoch: 25, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.346 Vali Acc: 0.347 Test Loss: 2.346 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.7378746
	speed: 0.1090s/iter; left time: 1248.6833s
Epoch: 26 cost time: 4.330069065093994
Epoch: 26, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.333 Vali Acc: 0.347 Test Loss: 2.333 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.6967589
	speed: 0.1019s/iter; left time: 1150.9975s
Epoch: 27 cost time: 4.201939582824707
Epoch: 27, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.419 Vali Acc: 0.351 Test Loss: 2.419 Test Acc: 0.351
Validation loss decreased (-0.349937 --> -0.351152).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.9602764
	speed: 0.1028s/iter; left time: 1145.4936s
Epoch: 28 cost time: 3.9244980812072754
Epoch: 28, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.434 Vali Acc: 0.351 Test Loss: 2.434 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.9063931
	speed: 0.0976s/iter; left time: 1073.0565s
Epoch: 29 cost time: 4.285694360733032
Epoch: 29, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.429 Vali Acc: 0.351 Test Loss: 2.429 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 1.5581065
	speed: 0.1001s/iter; left time: 1084.0579s
Epoch: 30 cost time: 3.971804618835449
Epoch: 30, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.363 Vali Acc: 0.354 Test Loss: 2.363 Test Acc: 0.354
Validation loss decreased (-0.351152 --> -0.354396).  Saving model ...
	iters: 100, epoch: 31 | loss: 1.4115887
	speed: 0.0989s/iter; left time: 1055.8751s
Epoch: 31 cost time: 3.762603282928467
Epoch: 31, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.419 Vali Acc: 0.354 Test Loss: 2.419 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 1.4525284
	speed: 0.1060s/iter; left time: 1116.1063s
Epoch: 32 cost time: 4.321925640106201
Epoch: 32, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.316 Vali Acc: 0.358 Test Loss: 2.316 Test Acc: 0.358
Validation loss decreased (-0.354396 --> -0.358047).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.0873467
	speed: 0.1130s/iter; left time: 1172.0804s
Epoch: 33 cost time: 4.29768705368042
Epoch: 33, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.399 Vali Acc: 0.356 Test Loss: 2.399 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 1.4678037
	speed: 0.1128s/iter; left time: 1152.5686s
Epoch: 34 cost time: 4.544548273086548
Epoch: 34, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.328 Vali Acc: 0.357 Test Loss: 2.328 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 1.3583119
	speed: 0.1146s/iter; left time: 1153.4256s
Epoch: 35 cost time: 4.526586294174194
Epoch: 35, Steps: 154 | Train Loss: 1.417 Vali Loss: 2.623 Vali Acc: 0.361 Test Loss: 2.623 Test Acc: 0.361
Validation loss decreased (-0.358047 --> -0.361288).  Saving model ...
	iters: 100, epoch: 36 | loss: 1.5914611
	speed: 0.1064s/iter; left time: 1054.5059s
Epoch: 36 cost time: 4.329242944717407
Epoch: 36, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.443 Vali Acc: 0.360 Test Loss: 2.443 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 1.1534307
	speed: 0.1056s/iter; left time: 1030.7172s
Epoch: 37 cost time: 4.204439163208008
Epoch: 37, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.710 Vali Acc: 0.361 Test Loss: 2.710 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 1.8329785
	speed: 0.1043s/iter; left time: 1001.9079s
Epoch: 38 cost time: 4.247829437255859
Epoch: 38, Steps: 154 | Train Loss: 1.485 Vali Loss: 2.695 Vali Acc: 0.359 Test Loss: 2.695 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 1.6050361
	speed: 0.1030s/iter; left time: 972.9925s
Epoch: 39 cost time: 4.1109089851379395
Epoch: 39, Steps: 154 | Train Loss: 1.524 Vali Loss: 2.584 Vali Acc: 0.361 Test Loss: 2.584 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 1.2787803
	speed: 0.1043s/iter; left time: 969.0889s
Epoch: 40 cost time: 4.1215980052948
Epoch: 40, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.456 Vali Acc: 0.366 Test Loss: 2.456 Test Acc: 0.366
Validation loss decreased (-0.361288 --> -0.366155).  Saving model ...
	iters: 100, epoch: 41 | loss: 1.4196289
	speed: 0.1075s/iter; left time: 982.7243s
Epoch: 41 cost time: 4.259638547897339
Epoch: 41, Steps: 154 | Train Loss: 1.409 Vali Loss: 2.513 Vali Acc: 0.363 Test Loss: 2.513 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 1.7149758
	speed: 0.1074s/iter; left time: 965.4513s
Epoch: 42 cost time: 4.172961473464966
Epoch: 42, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.614 Vali Acc: 0.370 Test Loss: 2.614 Test Acc: 0.370
Validation loss decreased (-0.366155 --> -0.370209).  Saving model ...
	iters: 100, epoch: 43 | loss: 1.3384482
	speed: 0.1071s/iter; left time: 946.2063s
Epoch: 43 cost time: 4.363871097564697
Epoch: 43, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.578 Vali Acc: 0.375 Test Loss: 2.578 Test Acc: 0.375
Validation loss decreased (-0.370209 --> -0.374670).  Saving model ...
	iters: 100, epoch: 44 | loss: 1.3527797
	speed: 0.1134s/iter; left time: 984.0825s
Epoch: 44 cost time: 4.239152193069458
Epoch: 44, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.525 Vali Acc: 0.370 Test Loss: 2.525 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 1.4647028
	speed: 0.1062s/iter; left time: 905.0398s
Epoch: 45 cost time: 4.260835409164429
Epoch: 45, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.474 Vali Acc: 0.364 Test Loss: 2.474 Test Acc: 0.364
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 1.4903522
	speed: 0.1063s/iter; left time: 890.0754s
Epoch: 46 cost time: 4.200715780258179
Epoch: 46, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.566 Vali Acc: 0.368 Test Loss: 2.566 Test Acc: 0.368
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 47 | loss: 1.2431107
	speed: 0.1059s/iter; left time: 870.4027s
Epoch: 47 cost time: 4.205309867858887
Epoch: 47, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.573 Vali Acc: 0.367 Test Loss: 2.573 Test Acc: 0.367
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 48 | loss: 1.2083315
	speed: 0.1063s/iter; left time: 857.4035s
Epoch: 48 cost time: 4.265654802322388
Epoch: 48, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.702 Vali Acc: 0.368 Test Loss: 2.702 Test Acc: 0.368
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 49 | loss: 1.5137135
	speed: 0.1055s/iter; left time: 834.3678s
Epoch: 49 cost time: 4.273820161819458
Epoch: 49, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.514 Vali Acc: 0.367 Test Loss: 2.514 Test Acc: 0.367
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 50 | loss: 1.8360438
	speed: 0.1115s/iter; left time: 864.7090s
Epoch: 50 cost time: 4.278865098953247
Epoch: 50, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.663 Vali Acc: 0.368 Test Loss: 2.663 Test Acc: 0.368
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 51 | loss: 1.6393942
	speed: 0.1110s/iter; left time: 843.9613s
Epoch: 51 cost time: 4.34874153137207
Epoch: 51, Steps: 154 | Train Loss: 1.393 Vali Loss: 2.603 Vali Acc: 0.370 Test Loss: 2.603 Test Acc: 0.370
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 52 | loss: 1.0554993
	speed: 0.1118s/iter; left time: 832.7834s
Epoch: 52 cost time: 4.309394359588623
Epoch: 52, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.677 Vali Acc: 0.375 Test Loss: 2.677 Test Acc: 0.375
Validation loss decreased (-0.374670 --> -0.375075).  Saving model ...
	iters: 100, epoch: 53 | loss: 1.6184143
	speed: 0.1120s/iter; left time: 816.5835s
Epoch: 53 cost time: 4.158361434936523
Epoch: 53, Steps: 154 | Train Loss: 1.357 Vali Loss: 3.121 Vali Acc: 0.365 Test Loss: 3.121 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 54 | loss: 1.1780139
	speed: 0.1059s/iter; left time: 755.7292s
Epoch: 54 cost time: 4.50701904296875
Epoch: 54, Steps: 154 | Train Loss: 1.448 Vali Loss: 2.742 Vali Acc: 0.369 Test Loss: 2.742 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 55 | loss: 1.3104799
	speed: 0.1065s/iter; left time: 743.6118s
Epoch: 55 cost time: 4.22706413269043
Epoch: 55, Steps: 154 | Train Loss: 1.442 Vali Loss: 2.769 Vali Acc: 0.370 Test Loss: 2.769 Test Acc: 0.370
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 56 | loss: 1.5454793
	speed: 0.1055s/iter; left time: 720.5895s
Epoch: 56 cost time: 4.239498853683472
Epoch: 56, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.596 Vali Acc: 0.378 Test Loss: 2.596 Test Acc: 0.378
Validation loss decreased (-0.375075 --> -0.377509).  Saving model ...
	iters: 100, epoch: 57 | loss: 1.5169475
	speed: 0.1056s/iter; left time: 705.0020s
Epoch: 57 cost time: 4.241228818893433
Epoch: 57, Steps: 154 | Train Loss: 1.308 Vali Loss: 2.737 Vali Acc: 0.373 Test Loss: 2.737 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 58 | loss: 0.9409758
	speed: 0.1020s/iter; left time: 665.3765s
Epoch: 58 cost time: 4.19429612159729
Epoch: 58, Steps: 154 | Train Loss: 1.348 Vali Loss: 2.708 Vali Acc: 0.373 Test Loss: 2.708 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 59 | loss: 1.2948446
	speed: 0.1045s/iter; left time: 665.7212s
Epoch: 59 cost time: 4.044058084487915
Epoch: 59, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.941 Vali Acc: 0.376 Test Loss: 2.941 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 60 | loss: 1.1206236
	speed: 0.1083s/iter; left time: 672.9591s
Epoch: 60 cost time: 4.258469104766846
Epoch: 60, Steps: 154 | Train Loss: 1.473 Vali Loss: 2.963 Vali Acc: 0.224 Test Loss: 2.963 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 61 | loss: 1.1495214
	speed: 0.1078s/iter; left time: 653.5321s
Epoch: 61 cost time: 4.095588684082031
Epoch: 61, Steps: 154 | Train Loss: 1.388 Vali Loss: 2.718 Vali Acc: 0.380 Test Loss: 2.718 Test Acc: 0.380
Validation loss decreased (-0.377509 --> -0.379940).  Saving model ...
	iters: 100, epoch: 62 | loss: 1.3877790
	speed: 0.1020s/iter; left time: 602.2480s
Epoch: 62 cost time: 3.7514889240264893
Epoch: 62, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.663 Vali Acc: 0.384 Test Loss: 2.663 Test Acc: 0.384
Validation loss decreased (-0.379940 --> -0.384402).  Saving model ...
	iters: 100, epoch: 63 | loss: 0.7744451
	speed: 0.0998s/iter; left time: 573.8883s
Epoch: 63 cost time: 4.097652912139893
Epoch: 63, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.980 Vali Acc: 0.380 Test Loss: 2.980 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 64 | loss: 1.8001723
	speed: 0.0999s/iter; left time: 559.4995s
Epoch: 64 cost time: 3.869987726211548
Epoch: 64, Steps: 154 | Train Loss: 1.333 Vali Loss: 3.005 Vali Acc: 0.370 Test Loss: 3.005 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 65 | loss: 1.3521709
	speed: 0.0972s/iter; left time: 529.2112s
Epoch: 65 cost time: 3.9317526817321777
Epoch: 65, Steps: 154 | Train Loss: 1.320 Vali Loss: 2.901 Vali Acc: 0.389 Test Loss: 2.901 Test Acc: 0.389
Validation loss decreased (-0.384402 --> -0.388860).  Saving model ...
	iters: 100, epoch: 66 | loss: 1.5775546
	speed: 0.1012s/iter; left time: 535.4351s
Epoch: 66 cost time: 4.385113716125488
Epoch: 66, Steps: 154 | Train Loss: 1.347 Vali Loss: 2.608 Vali Acc: 0.378 Test Loss: 2.608 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 67 | loss: 0.9156366
	speed: 0.1056s/iter; left time: 542.6323s
Epoch: 67 cost time: 4.272979497909546
Epoch: 67, Steps: 154 | Train Loss: 1.245 Vali Loss: 3.157 Vali Acc: 0.381 Test Loss: 3.157 Test Acc: 0.381
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 68 | loss: 1.6572599
	speed: 0.1114s/iter; left time: 555.2252s
Epoch: 68 cost time: 4.475403785705566
Epoch: 68, Steps: 154 | Train Loss: 1.375 Vali Loss: 3.174 Vali Acc: 0.380 Test Loss: 3.174 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 69 | loss: 1.1542989
	speed: 0.1142s/iter; left time: 551.3563s
Epoch: 69 cost time: 4.209527015686035
Epoch: 69, Steps: 154 | Train Loss: 1.480 Vali Loss: 3.032 Vali Acc: 0.373 Test Loss: 3.032 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 70 | loss: 1.4971056
	speed: 0.1114s/iter; left time: 520.6790s
Epoch: 70 cost time: 4.408204078674316
Epoch: 70, Steps: 154 | Train Loss: 1.285 Vali Loss: 3.317 Vali Acc: 0.373 Test Loss: 3.317 Test Acc: 0.373
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 71 | loss: 1.2687440
	speed: 0.1092s/iter; left time: 493.7421s
Epoch: 71 cost time: 3.983976125717163
Epoch: 71, Steps: 154 | Train Loss: 1.357 Vali Loss: 2.870 Vali Acc: 0.374 Test Loss: 2.870 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 72 | loss: 0.7607838
	speed: 0.1030s/iter; left time: 449.9138s
Epoch: 72 cost time: 4.299870729446411
Epoch: 72, Steps: 154 | Train Loss: 1.369 Vali Loss: 3.142 Vali Acc: 0.378 Test Loss: 3.142 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 73 | loss: 0.9096291
	speed: 0.1060s/iter; left time: 446.5305s
Epoch: 73 cost time: 4.211294651031494
Epoch: 73, Steps: 154 | Train Loss: 1.226 Vali Loss: 3.107 Vali Acc: 0.318 Test Loss: 3.107 Test Acc: 0.318
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 74 | loss: 1.3857524
	speed: 0.1037s/iter; left time: 421.0334s
Epoch: 74 cost time: 4.083802938461304
Epoch: 74, Steps: 154 | Train Loss: 1.339 Vali Loss: 3.053 Vali Acc: 0.382 Test Loss: 3.053 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 75 | loss: 1.2975577
	speed: 0.1043s/iter; left time: 407.4619s
Epoch: 75 cost time: 4.06618070602417
Epoch: 75, Steps: 154 | Train Loss: 1.309 Vali Loss: 3.095 Vali Acc: 0.373 Test Loss: 3.095 Test Acc: 0.373
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3888888888888889
model parameter : 23670
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0210812
	speed: 0.0418s/iter; left time: 639.9542s
Epoch: 1 cost time: 5.506242513656616
Epoch: 1, Steps: 154 | Train Loss: 2.283 Vali Loss: 2.157 Vali Acc: 0.315 Test Loss: 2.157 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1589835
	speed: 0.1018s/iter; left time: 1542.1573s
Epoch: 2 cost time: 3.969353437423706
Epoch: 2, Steps: 154 | Train Loss: 2.086 Vali Loss: 2.140 Vali Acc: 0.315 Test Loss: 2.140 Test Acc: 0.315
Validation loss decreased (-0.315064 --> -0.315469).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1354711
	speed: 0.1009s/iter; left time: 1513.3544s
Epoch: 3 cost time: 3.9255905151367188
Epoch: 3, Steps: 154 | Train Loss: 2.058 Vali Loss: 2.153 Vali Acc: 0.316 Test Loss: 2.153 Test Acc: 0.316
Validation loss decreased (-0.315469 --> -0.315875).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2365880
	speed: 0.1016s/iter; left time: 1507.9352s
Epoch: 4 cost time: 3.8560073375701904
Epoch: 4, Steps: 154 | Train Loss: 2.017 Vali Loss: 2.132 Vali Acc: 0.318 Test Loss: 2.132 Test Acc: 0.318
Validation loss decreased (-0.315875 --> -0.317902).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9507506
	speed: 0.0982s/iter; left time: 1442.5066s
Epoch: 5 cost time: 3.8997128009796143
Epoch: 5, Steps: 154 | Train Loss: 1.977 Vali Loss: 2.126 Vali Acc: 0.318 Test Loss: 2.126 Test Acc: 0.318
Validation loss decreased (-0.317902 --> -0.318308).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7554007
	speed: 0.1004s/iter; left time: 1458.2169s
Epoch: 6 cost time: 3.810230255126953
Epoch: 6, Steps: 154 | Train Loss: 1.955 Vali Loss: 2.128 Vali Acc: 0.321 Test Loss: 2.128 Test Acc: 0.321
Validation loss decreased (-0.318308 --> -0.320741).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7877898
	speed: 0.0986s/iter; left time: 1418.2080s
Epoch: 7 cost time: 4.077026844024658
Epoch: 7, Steps: 154 | Train Loss: 1.917 Vali Loss: 2.123 Vali Acc: 0.321 Test Loss: 2.123 Test Acc: 0.321
Validation loss decreased (-0.320741 --> -0.321147).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6746688
	speed: 0.1018s/iter; left time: 1448.3627s
Epoch: 8 cost time: 4.0346784591674805
Epoch: 8, Steps: 154 | Train Loss: 1.899 Vali Loss: 2.115 Vali Acc: 0.323 Test Loss: 2.115 Test Acc: 0.323
Validation loss decreased (-0.321147 --> -0.322769).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8151600
	speed: 0.0981s/iter; left time: 1380.2128s
Epoch: 9 cost time: 3.8122639656066895
Epoch: 9, Steps: 154 | Train Loss: 1.884 Vali Loss: 2.109 Vali Acc: 0.324 Test Loss: 2.109 Test Acc: 0.324
Validation loss decreased (-0.322769 --> -0.323985).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5939485
	speed: 0.1062s/iter; left time: 1477.1121s
Epoch: 10 cost time: 4.094913005828857
Epoch: 10, Steps: 154 | Train Loss: 1.844 Vali Loss: 2.129 Vali Acc: 0.325 Test Loss: 2.129 Test Acc: 0.325
Validation loss decreased (-0.323985 --> -0.324796).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.5786481
	speed: 0.1021s/iter; left time: 1404.4941s
Epoch: 11 cost time: 3.938046932220459
Epoch: 11, Steps: 154 | Train Loss: 1.848 Vali Loss: 2.117 Vali Acc: 0.330 Test Loss: 2.117 Test Acc: 0.330
Validation loss decreased (-0.324796 --> -0.329663).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8639555
	speed: 0.1031s/iter; left time: 1402.5239s
Epoch: 12 cost time: 3.960247755050659
Epoch: 12, Steps: 154 | Train Loss: 1.789 Vali Loss: 2.169 Vali Acc: 0.327 Test Loss: 2.169 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.0400860
	speed: 0.1010s/iter; left time: 1358.9688s
Epoch: 13 cost time: 3.972010374069214
Epoch: 13, Steps: 154 | Train Loss: 1.774 Vali Loss: 2.124 Vali Acc: 0.333 Test Loss: 2.124 Test Acc: 0.333
Validation loss decreased (-0.329663 --> -0.332907).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.1795805
	speed: 0.0953s/iter; left time: 1267.7319s
Epoch: 14 cost time: 3.9328160285949707
Epoch: 14, Steps: 154 | Train Loss: 1.748 Vali Loss: 2.137 Vali Acc: 0.332 Test Loss: 2.137 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.5132059
	speed: 0.0967s/iter; left time: 1271.6839s
Epoch: 15 cost time: 3.860661029815674
Epoch: 15, Steps: 154 | Train Loss: 1.767 Vali Loss: 2.188 Vali Acc: 0.339 Test Loss: 2.188 Test Acc: 0.339
Validation loss decreased (-0.332907 --> -0.338583).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4746423
	speed: 0.0986s/iter; left time: 1280.4389s
Epoch: 16 cost time: 3.913377046585083
Epoch: 16, Steps: 154 | Train Loss: 1.731 Vali Loss: 2.225 Vali Acc: 0.338 Test Loss: 2.225 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.5220118
	speed: 0.0971s/iter; left time: 1246.7614s
Epoch: 17 cost time: 3.884037733078003
Epoch: 17, Steps: 154 | Train Loss: 1.717 Vali Loss: 2.249 Vali Acc: 0.338 Test Loss: 2.249 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.8498775
	speed: 0.0980s/iter; left time: 1243.5458s
Epoch: 18 cost time: 3.901339292526245
Epoch: 18, Steps: 154 | Train Loss: 1.700 Vali Loss: 2.234 Vali Acc: 0.341 Test Loss: 2.234 Test Acc: 0.341
Validation loss decreased (-0.338583 --> -0.341421).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.6164266
	speed: 0.0992s/iter; left time: 1242.3076s
Epoch: 19 cost time: 4.140312671661377
Epoch: 19, Steps: 154 | Train Loss: 1.685 Vali Loss: 2.289 Vali Acc: 0.342 Test Loss: 2.289 Test Acc: 0.342
Validation loss decreased (-0.341421 --> -0.341826).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.6261299
	speed: 0.1037s/iter; left time: 1283.7933s
Epoch: 20 cost time: 3.9996426105499268
Epoch: 20, Steps: 154 | Train Loss: 1.677 Vali Loss: 2.359 Vali Acc: 0.346 Test Loss: 2.359 Test Acc: 0.346
Validation loss decreased (-0.341826 --> -0.345881).  Saving model ...
	iters: 100, epoch: 21 | loss: 8.0747709
	speed: 0.1026s/iter; left time: 1253.9956s
Epoch: 21 cost time: 3.982114553451538
Epoch: 21, Steps: 154 | Train Loss: 1.688 Vali Loss: 2.351 Vali Acc: 0.347 Test Loss: 2.351 Test Acc: 0.347
Validation loss decreased (-0.345881 --> -0.347097).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.6477041
	speed: 0.1065s/iter; left time: 1285.0692s
Epoch: 22 cost time: 3.975507974624634
Epoch: 22, Steps: 154 | Train Loss: 1.610 Vali Loss: 2.395 Vali Acc: 0.346 Test Loss: 2.395 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.9007342
	speed: 0.1048s/iter; left time: 1248.0327s
Epoch: 23 cost time: 4.056690454483032
Epoch: 23, Steps: 154 | Train Loss: 1.654 Vali Loss: 2.346 Vali Acc: 0.351 Test Loss: 2.346 Test Acc: 0.351
Validation loss decreased (-0.347097 --> -0.350747).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.8426781
	speed: 0.0990s/iter; left time: 1164.0627s
Epoch: 24 cost time: 3.914057970046997
Epoch: 24, Steps: 154 | Train Loss: 1.619 Vali Loss: 2.429 Vali Acc: 0.348 Test Loss: 2.429 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.5742052
	speed: 0.0977s/iter; left time: 1134.2364s
Epoch: 25 cost time: 3.921107053756714
Epoch: 25, Steps: 154 | Train Loss: 1.624 Vali Loss: 2.346 Vali Acc: 0.353 Test Loss: 2.346 Test Acc: 0.353
Validation loss decreased (-0.350747 --> -0.352775).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.6231874
	speed: 0.0994s/iter; left time: 1137.8190s
Epoch: 26 cost time: 4.06046986579895
Epoch: 26, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.493 Vali Acc: 0.352 Test Loss: 2.493 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.7575157
	speed: 0.0984s/iter; left time: 1111.7645s
Epoch: 27 cost time: 4.001548767089844
Epoch: 27, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.430 Vali Acc: 0.354 Test Loss: 2.430 Test Acc: 0.354
Validation loss decreased (-0.352775 --> -0.354396).  Saving model ...
	iters: 100, epoch: 28 | loss: 1.7604675
	speed: 0.1002s/iter; left time: 1116.5050s
Epoch: 28 cost time: 4.084203481674194
Epoch: 28, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.420 Vali Acc: 0.355 Test Loss: 2.420 Test Acc: 0.355
Validation loss decreased (-0.354396 --> -0.354801).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.4776235
	speed: 0.1022s/iter; left time: 1123.4703s
Epoch: 29 cost time: 4.093447685241699
Epoch: 29, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.422 Vali Acc: 0.354 Test Loss: 2.422 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 1.4391167
	speed: 0.1032s/iter; left time: 1118.3714s
Epoch: 30 cost time: 4.039795637130737
Epoch: 30, Steps: 154 | Train Loss: 1.552 Vali Loss: 2.375 Vali Acc: 0.354 Test Loss: 2.375 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 1.3848395
	speed: 0.1042s/iter; left time: 1113.4665s
Epoch: 31 cost time: 4.017454624176025
Epoch: 31, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.478 Vali Acc: 0.352 Test Loss: 2.478 Test Acc: 0.352
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 1.4525107
	speed: 0.1071s/iter; left time: 1126.9555s
Epoch: 32 cost time: 4.031440019607544
Epoch: 32, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.461 Vali Acc: 0.360 Test Loss: 2.461 Test Acc: 0.360
Validation loss decreased (-0.354801 --> -0.360073).  Saving model ...
	iters: 100, epoch: 33 | loss: 1.3515086
	speed: 0.0981s/iter; left time: 1017.9668s
Epoch: 33 cost time: 3.9821174144744873
Epoch: 33, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.401 Vali Acc: 0.363 Test Loss: 2.401 Test Acc: 0.363
Validation loss decreased (-0.360073 --> -0.362506).  Saving model ...
	iters: 100, epoch: 34 | loss: 1.4120045
	speed: 0.1016s/iter; left time: 1038.4733s
Epoch: 34 cost time: 3.916943073272705
Epoch: 34, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.425 Vali Acc: 0.360 Test Loss: 2.425 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 1.5370663
	speed: 0.1006s/iter; left time: 1012.3970s
Epoch: 35 cost time: 3.9846889972686768
Epoch: 35, Steps: 154 | Train Loss: 1.518 Vali Loss: 2.574 Vali Acc: 0.363 Test Loss: 2.574 Test Acc: 0.363
Validation loss decreased (-0.362506 --> -0.362910).  Saving model ...
	iters: 100, epoch: 36 | loss: 1.7069159
	speed: 0.1011s/iter; left time: 1001.8551s
Epoch: 36 cost time: 3.856977939605713
Epoch: 36, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.538 Vali Acc: 0.358 Test Loss: 2.538 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.9930040
	speed: 0.0989s/iter; left time: 965.1083s
Epoch: 37 cost time: 3.9083943367004395
Epoch: 37, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.468 Vali Acc: 0.362 Test Loss: 2.468 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 1.5591701
	speed: 0.1015s/iter; left time: 974.4973s
Epoch: 38 cost time: 4.068228721618652
Epoch: 38, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.596 Vali Acc: 0.359 Test Loss: 2.596 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.9055215
	speed: 0.1045s/iter; left time: 987.5274s
Epoch: 39 cost time: 4.019768953323364
Epoch: 39, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.539 Vali Acc: 0.364 Test Loss: 2.539 Test Acc: 0.364
Validation loss decreased (-0.362910 --> -0.363722).  Saving model ...
	iters: 100, epoch: 40 | loss: 1.2573411
	speed: 0.1026s/iter; left time: 953.9381s
Epoch: 40 cost time: 3.823324203491211
Epoch: 40, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.838 Vali Acc: 0.364 Test Loss: 2.838 Test Acc: 0.364
Validation loss decreased (-0.363722 --> -0.364124).  Saving model ...
	iters: 100, epoch: 41 | loss: 1.5814016
	speed: 0.1042s/iter; left time: 952.8471s
Epoch: 41 cost time: 4.2572410106658936
Epoch: 41, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.591 Vali Acc: 0.362 Test Loss: 2.591 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 1.8180549
	speed: 0.1016s/iter; left time: 912.7482s
Epoch: 42 cost time: 3.8179030418395996
Epoch: 42, Steps: 154 | Train Loss: 1.427 Vali Loss: 2.610 Vali Acc: 0.366 Test Loss: 2.610 Test Acc: 0.366
Validation loss decreased (-0.364124 --> -0.366154).  Saving model ...
	iters: 100, epoch: 43 | loss: 1.2838460
	speed: 0.0983s/iter; left time: 867.8744s
Epoch: 43 cost time: 4.010810375213623
Epoch: 43, Steps: 154 | Train Loss: 1.411 Vali Loss: 2.602 Vali Acc: 0.365 Test Loss: 2.602 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 1.3886845
	speed: 0.0988s/iter; left time: 857.1019s
Epoch: 44 cost time: 4.053138971328735
Epoch: 44, Steps: 154 | Train Loss: 1.424 Vali Loss: 2.718 Vali Acc: 0.362 Test Loss: 2.718 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 0.9908538
	speed: 0.0958s/iter; left time: 816.5184s
Epoch: 45 cost time: 3.7854528427124023
Epoch: 45, Steps: 154 | Train Loss: 1.437 Vali Loss: 2.630 Vali Acc: 0.369 Test Loss: 2.630 Test Acc: 0.369
Validation loss decreased (-0.366154 --> -0.369398).  Saving model ...
	iters: 100, epoch: 46 | loss: 1.5667627
	speed: 0.0977s/iter; left time: 818.0690s
Epoch: 46 cost time: 4.1388866901397705
Epoch: 46, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.725 Vali Acc: 0.366 Test Loss: 2.725 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 47 | loss: 1.1961994
	speed: 0.0957s/iter; left time: 786.1996s
Epoch: 47 cost time: 3.883511543273926
Epoch: 47, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.728 Vali Acc: 0.363 Test Loss: 2.728 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 48 | loss: 0.8153627
	speed: 0.0958s/iter; left time: 772.7383s
Epoch: 48 cost time: 3.886655330657959
Epoch: 48, Steps: 154 | Train Loss: 1.443 Vali Loss: 2.780 Vali Acc: 0.365 Test Loss: 2.780 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 49 | loss: 1.4960827
	speed: 0.1060s/iter; left time: 838.4962s
Epoch: 49 cost time: 4.2099387645721436
Epoch: 49, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.718 Vali Acc: 0.365 Test Loss: 2.718 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 50 | loss: 1.3399295
	speed: 0.1029s/iter; left time: 797.8065s
Epoch: 50 cost time: 4.012830495834351
Epoch: 50, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.882 Vali Acc: 0.371 Test Loss: 2.882 Test Acc: 0.371
Validation loss decreased (-0.369398 --> -0.370612).  Saving model ...
	iters: 100, epoch: 51 | loss: 1.5342650
	speed: 0.1052s/iter; left time: 799.6085s
Epoch: 51 cost time: 4.0308942794799805
Epoch: 51, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.720 Vali Acc: 0.366 Test Loss: 2.720 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 52 | loss: 2.4416332
	speed: 0.1068s/iter; left time: 795.3514s
Epoch: 52 cost time: 4.07743239402771
Epoch: 52, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.602 Vali Acc: 0.370 Test Loss: 2.602 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 53 | loss: 1.5925381
	speed: 0.0993s/iter; left time: 724.3508s
Epoch: 53 cost time: 4.014595985412598
Epoch: 53, Steps: 154 | Train Loss: 1.314 Vali Loss: 2.788 Vali Acc: 0.366 Test Loss: 2.788 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 54 | loss: 1.0447233
	speed: 0.0986s/iter; left time: 704.0473s
Epoch: 54 cost time: 4.021483898162842
Epoch: 54, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.717 Vali Acc: 0.364 Test Loss: 2.717 Test Acc: 0.364
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 55 | loss: 1.2502737
	speed: 0.0970s/iter; left time: 677.5830s
Epoch: 55 cost time: 3.851282835006714
Epoch: 55, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.643 Vali Acc: 0.366 Test Loss: 2.643 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 56 | loss: 1.5117148
	speed: 0.0977s/iter; left time: 667.1870s
Epoch: 56 cost time: 3.8085575103759766
Epoch: 56, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.764 Vali Acc: 0.370 Test Loss: 2.764 Test Acc: 0.370
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 57 | loss: 1.6776824
	speed: 0.0963s/iter; left time: 642.8741s
Epoch: 57 cost time: 3.8963074684143066
Epoch: 57, Steps: 154 | Train Loss: 1.303 Vali Loss: 2.721 Vali Acc: 0.371 Test Loss: 2.721 Test Acc: 0.371
Validation loss decreased (-0.370612 --> -0.370613).  Saving model ...
	iters: 100, epoch: 58 | loss: 1.0451897
	speed: 0.0963s/iter; left time: 628.2650s
Epoch: 58 cost time: 3.9311282634735107
Epoch: 58, Steps: 154 | Train Loss: 1.300 Vali Loss: 2.779 Vali Acc: 0.371 Test Loss: 2.779 Test Acc: 0.371
Validation loss decreased (-0.370613 --> -0.371018).  Saving model ...
	iters: 100, epoch: 59 | loss: 1.1608713
	speed: 0.1039s/iter; left time: 661.5397s
Epoch: 59 cost time: 4.0226380825042725
Epoch: 59, Steps: 154 | Train Loss: 1.339 Vali Loss: 2.916 Vali Acc: 0.376 Test Loss: 2.916 Test Acc: 0.376
Validation loss decreased (-0.371018 --> -0.375883).  Saving model ...
	iters: 100, epoch: 60 | loss: 0.7021940
	speed: 0.1040s/iter; left time: 646.1621s
Epoch: 60 cost time: 3.825228691101074
Epoch: 60, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.903 Vali Acc: 0.244 Test Loss: 2.903 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 61 | loss: 1.2639793
	speed: 0.1082s/iter; left time: 655.9250s
Epoch: 61 cost time: 4.327895641326904
Epoch: 61, Steps: 154 | Train Loss: 1.460 Vali Loss: 3.004 Vali Acc: 0.373 Test Loss: 3.004 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 62 | loss: 1.5005661
	speed: 0.1094s/iter; left time: 646.4515s
Epoch: 62 cost time: 4.006134748458862
Epoch: 62, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.894 Vali Acc: 0.375 Test Loss: 2.894 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 63 | loss: 1.4556135
	speed: 0.0968s/iter; left time: 556.9369s
Epoch: 63 cost time: 3.8150994777679443
Epoch: 63, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.176 Vali Acc: 0.374 Test Loss: 3.176 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 64 | loss: 1.6976231
	speed: 0.0969s/iter; left time: 542.3052s
Epoch: 64 cost time: 4.081176996231079
Epoch: 64, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.791 Vali Acc: 0.374 Test Loss: 2.791 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 65 | loss: 1.5602915
	speed: 0.0992s/iter; left time: 540.2329s
Epoch: 65 cost time: 4.1444480419158936
Epoch: 65, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.988 Vali Acc: 0.383 Test Loss: 2.988 Test Acc: 0.383
Validation loss decreased (-0.375883 --> -0.382776).  Saving model ...
	iters: 100, epoch: 66 | loss: 1.8068038
	speed: 0.1002s/iter; left time: 530.0830s
Epoch: 66 cost time: 4.077341794967651
Epoch: 66, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.631 Vali Acc: 0.379 Test Loss: 2.631 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 67 | loss: 1.0273962
	speed: 0.0955s/iter; left time: 490.6010s
Epoch: 67 cost time: 3.9433162212371826
Epoch: 67, Steps: 154 | Train Loss: 1.282 Vali Loss: 2.754 Vali Acc: 0.374 Test Loss: 2.754 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 68 | loss: 1.6766286
	speed: 0.1014s/iter; left time: 505.3062s
Epoch: 68 cost time: 4.094360828399658
Epoch: 68, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.801 Vali Acc: 0.373 Test Loss: 2.801 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 69 | loss: 1.1399112
	speed: 0.1062s/iter; left time: 512.7413s
Epoch: 69 cost time: 4.129154682159424
Epoch: 69, Steps: 154 | Train Loss: 1.405 Vali Loss: 2.893 Vali Acc: 0.374 Test Loss: 2.893 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 70 | loss: 1.5786066
	speed: 0.1055s/iter; left time: 493.2842s
Epoch: 70 cost time: 4.067930221557617
Epoch: 70, Steps: 154 | Train Loss: 1.336 Vali Loss: 2.867 Vali Acc: 0.380 Test Loss: 2.867 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 71 | loss: 1.1754709
	speed: 0.1096s/iter; left time: 495.4868s
Epoch: 71 cost time: 4.1624836921691895
Epoch: 71, Steps: 154 | Train Loss: 1.284 Vali Loss: 2.897 Vali Acc: 0.379 Test Loss: 2.897 Test Acc: 0.379
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 72 | loss: 1.0562141
	speed: 0.1003s/iter; left time: 438.0066s
Epoch: 72 cost time: 3.6555182933807373
Epoch: 72, Steps: 154 | Train Loss: 1.321 Vali Loss: 2.895 Vali Acc: 0.377 Test Loss: 2.895 Test Acc: 0.377
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 73 | loss: 1.1180323
	speed: 0.0933s/iter; left time: 392.9808s
Epoch: 73 cost time: 3.8457183837890625
Epoch: 73, Steps: 154 | Train Loss: 1.349 Vali Loss: 2.881 Vali Acc: 0.378 Test Loss: 2.881 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 74 | loss: 1.1003129
	speed: 0.0905s/iter; left time: 367.4729s
Epoch: 74 cost time: 3.8895063400268555
Epoch: 74, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.847 Vali Acc: 0.386 Test Loss: 2.847 Test Acc: 0.386
Validation loss decreased (-0.382776 --> -0.385616).  Saving model ...
	iters: 100, epoch: 75 | loss: 1.0975777
	speed: 0.0996s/iter; left time: 388.7698s
Epoch: 75 cost time: 3.989497661590576
Epoch: 75, Steps: 154 | Train Loss: 1.273 Vali Loss: 3.025 Vali Acc: 0.369 Test Loss: 3.025 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 76 | loss: 0.7757161
	speed: 0.0958s/iter; left time: 359.4894s
Epoch: 76 cost time: 3.900101661682129
Epoch: 76, Steps: 154 | Train Loss: 1.203 Vali Loss: 2.953 Vali Acc: 0.382 Test Loss: 2.953 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 77 | loss: 3.3610556
	speed: 0.0984s/iter; left time: 353.9930s
Epoch: 77 cost time: 3.922330141067505
Epoch: 77, Steps: 154 | Train Loss: 1.297 Vali Loss: 2.868 Vali Acc: 0.374 Test Loss: 2.868 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 78 | loss: 2.2581024
	speed: 0.1056s/iter; left time: 363.6141s
Epoch: 78 cost time: 4.250288009643555
Epoch: 78, Steps: 154 | Train Loss: 1.311 Vali Loss: 3.035 Vali Acc: 0.376 Test Loss: 3.035 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 79 | loss: 1.5902034
	speed: 0.1076s/iter; left time: 354.0513s
Epoch: 79 cost time: 4.009957313537598
Epoch: 79, Steps: 154 | Train Loss: 1.188 Vali Loss: 2.807 Vali Acc: 0.378 Test Loss: 2.807 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 80 | loss: 1.6839089
	speed: 0.1051s/iter; left time: 329.4502s
Epoch: 80 cost time: 4.137491703033447
Epoch: 80, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.986 Vali Acc: 0.387 Test Loss: 2.986 Test Acc: 0.387
Validation loss decreased (-0.385616 --> -0.386831).  Saving model ...
	iters: 100, epoch: 81 | loss: 1.2993016
	speed: 0.1076s/iter; left time: 320.9021s
Epoch: 81 cost time: 4.122501373291016
Epoch: 81, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.945 Vali Acc: 0.371 Test Loss: 2.945 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 82 | loss: 1.0276165
	speed: 0.0995s/iter; left time: 281.3211s
Epoch: 82 cost time: 4.465036392211914
Epoch: 82, Steps: 154 | Train Loss: 1.183 Vali Loss: 2.940 Vali Acc: 0.376 Test Loss: 2.940 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 83 | loss: 0.7646240
	speed: 0.1125s/iter; left time: 300.6688s
Epoch: 83 cost time: 4.039073467254639
Epoch: 83, Steps: 154 | Train Loss: 1.236 Vali Loss: 2.881 Vali Acc: 0.376 Test Loss: 2.881 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 84 | loss: 0.6504530
	speed: 0.0775s/iter; left time: 195.3099s
Epoch: 84 cost time: 3.276442050933838
Epoch: 84, Steps: 154 | Train Loss: 1.232 Vali Loss: 3.059 Vali Acc: 0.373 Test Loss: 3.059 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 85 | loss: 0.8519501
	speed: 0.0827s/iter; left time: 195.5299s
Epoch: 85 cost time: 3.479198455810547
Epoch: 85, Steps: 154 | Train Loss: 1.271 Vali Loss: 2.846 Vali Acc: 0.380 Test Loss: 2.846 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 86 | loss: 1.3057015
	speed: 0.0935s/iter; left time: 206.6807s
Epoch: 86 cost time: 3.846436023712158
Epoch: 86, Steps: 154 | Train Loss: 1.210 Vali Loss: 2.984 Vali Acc: 0.374 Test Loss: 2.984 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 87 | loss: 1.1549731
	speed: 0.0945s/iter; left time: 194.4057s
Epoch: 87 cost time: 3.9024369716644287
Epoch: 87, Steps: 154 | Train Loss: 1.378 Vali Loss: 3.215 Vali Acc: 0.382 Test Loss: 3.215 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 88 | loss: 1.1154059
	speed: 0.0991s/iter; left time: 188.5294s
Epoch: 88 cost time: 4.006507396697998
Epoch: 88, Steps: 154 | Train Loss: 1.276 Vali Loss: 2.931 Vali Acc: 0.376 Test Loss: 2.931 Test Acc: 0.376
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 89 | loss: 0.8882302
	speed: 0.1024s/iter; left time: 179.1660s
Epoch: 89 cost time: 3.945131778717041
Epoch: 89, Steps: 154 | Train Loss: 1.169 Vali Loss: 2.942 Vali Acc: 0.379 Test Loss: 2.942 Test Acc: 0.379
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 90 | loss: 1.2212832
	speed: 0.0979s/iter; left time: 156.0844s
Epoch: 90 cost time: 3.928541898727417
Epoch: 90, Steps: 154 | Train Loss: 1.278 Vali Loss: 2.912 Vali Acc: 0.381 Test Loss: 2.912 Test Acc: 0.381
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_ETSformer_UEA_ftM_sl36_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38686131386861317
model parameter : 23670
model size : 0.71MB
