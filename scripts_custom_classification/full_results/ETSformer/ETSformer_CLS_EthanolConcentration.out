Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.256218433380127
Epoch: 1, Steps: 17 | Train Loss: 48.715 Vali Loss: 49.500 Vali Acc: 0.247 Test Loss: 49.500 Test Acc: 0.247
Validation loss decreased (inf --> -0.246653).  Saving model ...
Epoch: 2 cost time: 7.25998067855835
Epoch: 2, Steps: 17 | Train Loss: 66.937 Vali Loss: 49.880 Vali Acc: 0.209 Test Loss: 49.880 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.396153926849365
Epoch: 3, Steps: 17 | Train Loss: 82.216 Vali Loss: 162.826 Vali Acc: 0.255 Test Loss: 162.826 Test Acc: 0.255
Validation loss decreased (-0.246653 --> -0.253125).  Saving model ...
Epoch: 4 cost time: 7.257289171218872
Epoch: 4, Steps: 17 | Train Loss: 144.686 Vali Loss: 367.433 Vali Acc: 0.255 Test Loss: 367.433 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.642660140991211
Epoch: 5, Steps: 17 | Train Loss: 184.115 Vali Loss: 262.742 Vali Acc: 0.236 Test Loss: 262.742 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.64422607421875
Epoch: 6, Steps: 17 | Train Loss: 226.995 Vali Loss: 230.422 Vali Acc: 0.243 Test Loss: 230.422 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.264224290847778
Epoch: 7, Steps: 17 | Train Loss: 112.463 Vali Loss: 179.594 Vali Acc: 0.243 Test Loss: 179.594 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.377087593078613
Epoch: 8, Steps: 17 | Train Loss: 95.346 Vali Loss: 259.427 Vali Acc: 0.251 Test Loss: 259.427 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.132936000823975
Epoch: 9, Steps: 17 | Train Loss: 53.353 Vali Loss: 224.767 Vali Acc: 0.240 Test Loss: 224.767 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.272679328918457
Epoch: 10, Steps: 17 | Train Loss: 49.143 Vali Loss: 321.178 Vali Acc: 0.224 Test Loss: 321.178 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.250410556793213
Epoch: 11, Steps: 17 | Train Loss: 83.443 Vali Loss: 398.160 Vali Acc: 0.289 Test Loss: 398.160 Test Acc: 0.289
Validation loss decreased (-0.253125 --> -0.284992).  Saving model ...
Epoch: 12 cost time: 7.503471851348877
Epoch: 12, Steps: 17 | Train Loss: 63.852 Vali Loss: 457.621 Vali Acc: 0.259 Test Loss: 457.621 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.35821533203125
Epoch: 13, Steps: 17 | Train Loss: 55.431 Vali Loss: 645.224 Vali Acc: 0.289 Test Loss: 645.224 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.321224689483643
Epoch: 14, Steps: 17 | Train Loss: 60.010 Vali Loss: 617.960 Vali Acc: 0.259 Test Loss: 617.960 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.464169979095459
Epoch: 15, Steps: 17 | Train Loss: 56.072 Vali Loss: 824.936 Vali Acc: 0.236 Test Loss: 824.936 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.387234210968018
Epoch: 16, Steps: 17 | Train Loss: 88.267 Vali Loss: 840.282 Vali Acc: 0.247 Test Loss: 840.282 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.525747299194336
Epoch: 17, Steps: 17 | Train Loss: 59.284 Vali Loss: 1168.212 Vali Acc: 0.281 Test Loss: 1168.212 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.271705865859985
Epoch: 18, Steps: 17 | Train Loss: 62.399 Vali Loss: 1220.133 Vali Acc: 0.259 Test Loss: 1220.133 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.715802907943726
Epoch: 19, Steps: 17 | Train Loss: 35.931 Vali Loss: 1479.559 Vali Acc: 0.255 Test Loss: 1479.559 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.619963884353638
Epoch: 20, Steps: 17 | Train Loss: 48.498 Vali Loss: 1449.110 Vali Acc: 0.247 Test Loss: 1449.110 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.470557928085327
Epoch: 21, Steps: 17 | Train Loss: 53.088 Vali Loss: 1808.024 Vali Acc: 0.243 Test Loss: 1808.024 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 8849980
model size : 43.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.10296082496643
Epoch: 1, Steps: 17 | Train Loss: 53.689 Vali Loss: 85.338 Vali Acc: 0.259 Test Loss: 85.338 Test Acc: 0.259
Validation loss decreased (inf --> -0.257702).  Saving model ...
Epoch: 2 cost time: 6.649192810058594
Epoch: 2, Steps: 17 | Train Loss: 68.143 Vali Loss: 162.318 Vali Acc: 0.262 Test Loss: 162.318 Test Acc: 0.262
Validation loss decreased (-0.257702 --> -0.260734).  Saving model ...
Epoch: 3 cost time: 6.912144660949707
Epoch: 3, Steps: 17 | Train Loss: 113.095 Vali Loss: 95.884 Vali Acc: 0.232 Test Loss: 95.884 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.987486839294434
Epoch: 4, Steps: 17 | Train Loss: 148.706 Vali Loss: 224.293 Vali Acc: 0.251 Test Loss: 224.293 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.959110736846924
Epoch: 5, Steps: 17 | Train Loss: 117.833 Vali Loss: 165.509 Vali Acc: 0.259 Test Loss: 165.509 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.033862829208374
Epoch: 6, Steps: 17 | Train Loss: 108.195 Vali Loss: 360.036 Vali Acc: 0.236 Test Loss: 360.036 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.351935148239136
Epoch: 7, Steps: 17 | Train Loss: 188.923 Vali Loss: 342.537 Vali Acc: 0.251 Test Loss: 342.537 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.830740928649902
Epoch: 8, Steps: 17 | Train Loss: 114.503 Vali Loss: 210.897 Vali Acc: 0.278 Test Loss: 210.897 Test Acc: 0.278
Validation loss decreased (-0.260734 --> -0.275458).  Saving model ...
Epoch: 9 cost time: 6.987735033035278
Epoch: 9, Steps: 17 | Train Loss: 90.652 Vali Loss: 335.527 Vali Acc: 0.255 Test Loss: 335.527 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.064805746078491
Epoch: 10, Steps: 17 | Train Loss: 73.601 Vali Loss: 426.254 Vali Acc: 0.266 Test Loss: 426.254 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.898769855499268
Epoch: 11, Steps: 17 | Train Loss: 112.737 Vali Loss: 430.868 Vali Acc: 0.281 Test Loss: 430.868 Test Acc: 0.281
Validation loss decreased (-0.275458 --> -0.277060).  Saving model ...
Epoch: 12 cost time: 6.812986850738525
Epoch: 12, Steps: 17 | Train Loss: 51.266 Vali Loss: 470.596 Vali Acc: 0.236 Test Loss: 470.596 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.794773101806641
Epoch: 13, Steps: 17 | Train Loss: 52.486 Vali Loss: 775.419 Vali Acc: 0.270 Test Loss: 775.419 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.924977540969849
Epoch: 14, Steps: 17 | Train Loss: 96.611 Vali Loss: 891.089 Vali Acc: 0.262 Test Loss: 891.089 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.135364770889282
Epoch: 15, Steps: 17 | Train Loss: 78.271 Vali Loss: 989.334 Vali Acc: 0.224 Test Loss: 989.334 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.230236530303955
Epoch: 16, Steps: 17 | Train Loss: 55.996 Vali Loss: 968.295 Vali Acc: 0.281 Test Loss: 968.295 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.273688793182373
Epoch: 17, Steps: 17 | Train Loss: 59.952 Vali Loss: 1126.709 Vali Acc: 0.251 Test Loss: 1126.709 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.378077983856201
Epoch: 18, Steps: 17 | Train Loss: 42.298 Vali Loss: 1305.896 Vali Acc: 0.255 Test Loss: 1305.896 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.433581352233887
Epoch: 19, Steps: 17 | Train Loss: 49.888 Vali Loss: 1469.988 Vali Acc: 0.281 Test Loss: 1469.988 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.193264007568359
Epoch: 20, Steps: 17 | Train Loss: 40.934 Vali Loss: 1450.041 Vali Acc: 0.255 Test Loss: 1450.041 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.323769569396973
Epoch: 21, Steps: 17 | Train Loss: 17.963 Vali Loss: 1636.902 Vali Acc: 0.255 Test Loss: 1636.902 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 8849980
model size : 43.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.315386295318604
Epoch: 1, Steps: 17 | Train Loss: 40.803 Vali Loss: 49.972 Vali Acc: 0.232 Test Loss: 49.972 Test Acc: 0.232
Validation loss decreased (inf --> -0.231439).  Saving model ...
Epoch: 2 cost time: 6.192913770675659
Epoch: 2, Steps: 17 | Train Loss: 96.642 Vali Loss: 141.166 Vali Acc: 0.251 Test Loss: 141.166 Test Acc: 0.251
Validation loss decreased (-0.231439 --> -0.249539).  Saving model ...
Epoch: 3 cost time: 6.614353656768799
Epoch: 3, Steps: 17 | Train Loss: 118.096 Vali Loss: 135.171 Vali Acc: 0.266 Test Loss: 135.171 Test Acc: 0.266
Validation loss decreased (-0.249539 --> -0.264808).  Saving model ...
Epoch: 4 cost time: 6.446823835372925
Epoch: 4, Steps: 17 | Train Loss: 166.673 Vali Loss: 316.562 Vali Acc: 0.262 Test Loss: 316.562 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.714362144470215
Epoch: 5, Steps: 17 | Train Loss: 252.391 Vali Loss: 360.379 Vali Acc: 0.262 Test Loss: 360.379 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.882009983062744
Epoch: 6, Steps: 17 | Train Loss: 265.612 Vali Loss: 552.061 Vali Acc: 0.251 Test Loss: 552.061 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.993279695510864
Epoch: 7, Steps: 17 | Train Loss: 244.300 Vali Loss: 259.504 Vali Acc: 0.270 Test Loss: 259.504 Test Acc: 0.270
Validation loss decreased (-0.264808 --> -0.267367).  Saving model ...
Epoch: 8 cost time: 6.98873233795166
Epoch: 8, Steps: 17 | Train Loss: 58.575 Vali Loss: 324.272 Vali Acc: 0.266 Test Loss: 324.272 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.912123680114746
Epoch: 9, Steps: 17 | Train Loss: 118.209 Vali Loss: 412.497 Vali Acc: 0.255 Test Loss: 412.497 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.998103618621826
Epoch: 10, Steps: 17 | Train Loss: 82.404 Vali Loss: 552.332 Vali Acc: 0.278 Test Loss: 552.332 Test Acc: 0.278
Validation loss decreased (-0.267367 --> -0.272043).  Saving model ...
Epoch: 11 cost time: 6.812410116195679
Epoch: 11, Steps: 17 | Train Loss: 183.422 Vali Loss: 576.750 Vali Acc: 0.285 Test Loss: 576.750 Test Acc: 0.285
Validation loss decreased (-0.272043 --> -0.279404).  Saving model ...
Epoch: 12 cost time: 6.988723516464233
Epoch: 12, Steps: 17 | Train Loss: 54.481 Vali Loss: 610.604 Vali Acc: 0.266 Test Loss: 610.604 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.998247146606445
Epoch: 13, Steps: 17 | Train Loss: 51.418 Vali Loss: 633.872 Vali Acc: 0.228 Test Loss: 633.872 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.978834390640259
Epoch: 14, Steps: 17 | Train Loss: 84.206 Vali Loss: 847.484 Vali Acc: 0.259 Test Loss: 847.484 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.817289352416992
Epoch: 15, Steps: 17 | Train Loss: 39.426 Vali Loss: 994.556 Vali Acc: 0.259 Test Loss: 994.556 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.585119009017944
Epoch: 16, Steps: 17 | Train Loss: 44.352 Vali Loss: 1088.756 Vali Acc: 0.243 Test Loss: 1088.756 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.013216257095337
Epoch: 17, Steps: 17 | Train Loss: 59.500 Vali Loss: 1631.185 Vali Acc: 0.262 Test Loss: 1631.185 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.659651279449463
Epoch: 18, Steps: 17 | Train Loss: 47.048 Vali Loss: 1491.080 Vali Acc: 0.240 Test Loss: 1491.080 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.866931200027466
Epoch: 19, Steps: 17 | Train Loss: 39.810 Vali Loss: 1607.378 Vali Acc: 0.262 Test Loss: 1607.378 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.866967678070068
Epoch: 20, Steps: 17 | Train Loss: 63.724 Vali Loss: 1573.977 Vali Acc: 0.262 Test Loss: 1573.977 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.238163948059082
Epoch: 21, Steps: 17 | Train Loss: 69.725 Vali Loss: 1420.253 Vali Acc: 0.209 Test Loss: 1420.253 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 8849980
model size : 43.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.221752405166626
Epoch: 1, Steps: 17 | Train Loss: 41.195 Vali Loss: 97.312 Vali Acc: 0.251 Test Loss: 97.312 Test Acc: 0.251
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 5.62670636177063
Epoch: 2, Steps: 17 | Train Loss: 102.235 Vali Loss: 65.362 Vali Acc: 0.251 Test Loss: 65.362 Test Acc: 0.251
Validation loss decreased (-0.249977 --> -0.250297).  Saving model ...
Epoch: 3 cost time: 5.960782051086426
Epoch: 3, Steps: 17 | Train Loss: 105.196 Vali Loss: 60.581 Vali Acc: 0.236 Test Loss: 60.581 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.867717981338501
Epoch: 4, Steps: 17 | Train Loss: 74.556 Vali Loss: 114.500 Vali Acc: 0.236 Test Loss: 114.500 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.8356335163116455
Epoch: 5, Steps: 17 | Train Loss: 121.785 Vali Loss: 227.863 Vali Acc: 0.243 Test Loss: 227.863 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.933538436889648
Epoch: 6, Steps: 17 | Train Loss: 120.136 Vali Loss: 141.865 Vali Acc: 0.259 Test Loss: 141.865 Test Acc: 0.259
Validation loss decreased (-0.250297 --> -0.257136).  Saving model ...
Epoch: 7 cost time: 5.913185358047485
Epoch: 7, Steps: 17 | Train Loss: 96.978 Vali Loss: 283.248 Vali Acc: 0.232 Test Loss: 283.248 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.887278318405151
Epoch: 8, Steps: 17 | Train Loss: 117.723 Vali Loss: 321.778 Vali Acc: 0.243 Test Loss: 321.778 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.793741226196289
Epoch: 9, Steps: 17 | Train Loss: 59.885 Vali Loss: 256.044 Vali Acc: 0.266 Test Loss: 256.044 Test Acc: 0.266
Validation loss decreased (-0.257136 --> -0.263599).  Saving model ...
Epoch: 10 cost time: 5.77700400352478
Epoch: 10, Steps: 17 | Train Loss: 88.175 Vali Loss: 259.261 Vali Acc: 0.274 Test Loss: 259.261 Test Acc: 0.274
Validation loss decreased (-0.263599 --> -0.271172).  Saving model ...
Epoch: 11 cost time: 5.946263313293457
Epoch: 11, Steps: 17 | Train Loss: 71.070 Vali Loss: 346.713 Vali Acc: 0.281 Test Loss: 346.713 Test Acc: 0.281
Validation loss decreased (-0.271172 --> -0.277902).  Saving model ...
Epoch: 12 cost time: 5.695249557495117
Epoch: 12, Steps: 17 | Train Loss: 131.969 Vali Loss: 663.459 Vali Acc: 0.259 Test Loss: 663.459 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.012434720993042
Epoch: 13, Steps: 17 | Train Loss: 94.121 Vali Loss: 637.392 Vali Acc: 0.274 Test Loss: 637.392 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.971574306488037
Epoch: 14, Steps: 17 | Train Loss: 79.649 Vali Loss: 922.511 Vali Acc: 0.247 Test Loss: 922.511 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.960199594497681
Epoch: 15, Steps: 17 | Train Loss: 57.313 Vali Loss: 881.536 Vali Acc: 0.259 Test Loss: 881.536 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.91945219039917
Epoch: 16, Steps: 17 | Train Loss: 68.837 Vali Loss: 916.473 Vali Acc: 0.240 Test Loss: 916.473 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.96681547164917
Epoch: 17, Steps: 17 | Train Loss: 48.533 Vali Loss: 1020.585 Vali Acc: 0.247 Test Loss: 1020.585 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.317513704299927
Epoch: 18, Steps: 17 | Train Loss: 43.699 Vali Loss: 1179.353 Vali Acc: 0.270 Test Loss: 1179.353 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.2026708126068115
Epoch: 19, Steps: 17 | Train Loss: 62.184 Vali Loss: 1239.936 Vali Acc: 0.259 Test Loss: 1239.936 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.377405405044556
Epoch: 20, Steps: 17 | Train Loss: 40.037 Vali Loss: 1447.026 Vali Acc: 0.228 Test Loss: 1447.026 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.0343732833862305
Epoch: 21, Steps: 17 | Train Loss: 31.954 Vali Loss: 1751.384 Vali Acc: 0.236 Test Loss: 1751.384 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 8849980
model size : 43.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.030442714691162
Epoch: 1, Steps: 17 | Train Loss: 33.386 Vali Loss: 62.373 Vali Acc: 0.259 Test Loss: 62.373 Test Acc: 0.259
Validation loss decreased (inf --> -0.257931).  Saving model ...
Epoch: 2 cost time: 7.144088506698608
Epoch: 2, Steps: 17 | Train Loss: 84.575 Vali Loss: 52.808 Vali Acc: 0.247 Test Loss: 52.808 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.145121335983276
Epoch: 3, Steps: 17 | Train Loss: 117.263 Vali Loss: 271.990 Vali Acc: 0.247 Test Loss: 271.990 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.101744651794434
Epoch: 4, Steps: 17 | Train Loss: 182.275 Vali Loss: 376.996 Vali Acc: 0.255 Test Loss: 376.996 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.007614850997925
Epoch: 5, Steps: 17 | Train Loss: 311.305 Vali Loss: 186.854 Vali Acc: 0.266 Test Loss: 186.854 Test Acc: 0.266
Validation loss decreased (-0.257931 --> -0.264291).  Saving model ...
Epoch: 6 cost time: 7.033758640289307
Epoch: 6, Steps: 17 | Train Loss: 133.222 Vali Loss: 127.911 Vali Acc: 0.243 Test Loss: 127.911 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.3701698780059814
Epoch: 7, Steps: 17 | Train Loss: 111.971 Vali Loss: 358.377 Vali Acc: 0.262 Test Loss: 358.377 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.221543073654175
Epoch: 8, Steps: 17 | Train Loss: 234.423 Vali Loss: 595.439 Vali Acc: 0.262 Test Loss: 595.439 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.142245054244995
Epoch: 9, Steps: 17 | Train Loss: 117.344 Vali Loss: 542.263 Vali Acc: 0.243 Test Loss: 542.263 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.058785676956177
Epoch: 10, Steps: 17 | Train Loss: 151.476 Vali Loss: 453.029 Vali Acc: 0.259 Test Loss: 453.029 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.860575437545776
Epoch: 11, Steps: 17 | Train Loss: 80.264 Vali Loss: 599.381 Vali Acc: 0.266 Test Loss: 599.381 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.061466455459595
Epoch: 12, Steps: 17 | Train Loss: 89.493 Vali Loss: 543.876 Vali Acc: 0.255 Test Loss: 543.876 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.473272323608398
Epoch: 13, Steps: 17 | Train Loss: 60.011 Vali Loss: 737.581 Vali Acc: 0.262 Test Loss: 737.581 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.407003164291382
Epoch: 14, Steps: 17 | Train Loss: 133.455 Vali Loss: 779.064 Vali Acc: 0.247 Test Loss: 779.064 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.475813865661621
Epoch: 15, Steps: 17 | Train Loss: 56.843 Vali Loss: 856.580 Vali Acc: 0.255 Test Loss: 856.580 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 6752828
model size : 35.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.19118070602417
Epoch: 1, Steps: 17 | Train Loss: 33.817 Vali Loss: 74.956 Vali Acc: 0.240 Test Loss: 74.956 Test Acc: 0.240
Validation loss decreased (inf --> -0.238794).  Saving model ...
Epoch: 2 cost time: 6.20487642288208
Epoch: 2, Steps: 17 | Train Loss: 97.301 Vali Loss: 82.116 Vali Acc: 0.255 Test Loss: 82.116 Test Acc: 0.255
Validation loss decreased (-0.238794 --> -0.253932).  Saving model ...
Epoch: 3 cost time: 6.306978225708008
Epoch: 3, Steps: 17 | Train Loss: 168.242 Vali Loss: 247.171 Vali Acc: 0.247 Test Loss: 247.171 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.257116079330444
Epoch: 4, Steps: 17 | Train Loss: 160.292 Vali Loss: 180.824 Vali Acc: 0.266 Test Loss: 180.824 Test Acc: 0.266
Validation loss decreased (-0.253932 --> -0.264351).  Saving model ...
Epoch: 5 cost time: 6.4237380027771
Epoch: 5, Steps: 17 | Train Loss: 174.644 Vali Loss: 212.184 Vali Acc: 0.251 Test Loss: 212.184 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.473489046096802
Epoch: 6, Steps: 17 | Train Loss: 92.752 Vali Loss: 328.870 Vali Acc: 0.232 Test Loss: 328.870 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.8408637046813965
Epoch: 7, Steps: 17 | Train Loss: 139.406 Vali Loss: 224.100 Vali Acc: 0.255 Test Loss: 224.100 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.61307692527771
Epoch: 8, Steps: 17 | Train Loss: 52.801 Vali Loss: 176.870 Vali Acc: 0.259 Test Loss: 176.870 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.351272821426392
Epoch: 9, Steps: 17 | Train Loss: 109.078 Vali Loss: 410.485 Vali Acc: 0.281 Test Loss: 410.485 Test Acc: 0.281
Validation loss decreased (-0.264351 --> -0.277264).  Saving model ...
Epoch: 10 cost time: 6.432907819747925
Epoch: 10, Steps: 17 | Train Loss: 104.015 Vali Loss: 444.752 Vali Acc: 0.270 Test Loss: 444.752 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.264055013656616
Epoch: 11, Steps: 17 | Train Loss: 143.262 Vali Loss: 816.777 Vali Acc: 0.266 Test Loss: 816.777 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.523022174835205
Epoch: 12, Steps: 17 | Train Loss: 104.415 Vali Loss: 519.083 Vali Acc: 0.281 Test Loss: 519.083 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.486749887466431
Epoch: 13, Steps: 17 | Train Loss: 133.820 Vali Loss: 948.946 Vali Acc: 0.281 Test Loss: 948.946 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.521153450012207
Epoch: 14, Steps: 17 | Train Loss: 137.498 Vali Loss: 926.102 Vali Acc: 0.259 Test Loss: 926.102 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.461404800415039
Epoch: 15, Steps: 17 | Train Loss: 53.334 Vali Loss: 1017.215 Vali Acc: 0.259 Test Loss: 1017.215 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.551551342010498
Epoch: 16, Steps: 17 | Train Loss: 47.643 Vali Loss: 984.864 Vali Acc: 0.274 Test Loss: 984.864 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.591002702713013
Epoch: 17, Steps: 17 | Train Loss: 64.407 Vali Loss: 1050.081 Vali Acc: 0.259 Test Loss: 1050.081 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.498715162277222
Epoch: 18, Steps: 17 | Train Loss: 38.301 Vali Loss: 1276.331 Vali Acc: 0.255 Test Loss: 1276.331 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.21846866607666
Epoch: 19, Steps: 17 | Train Loss: 82.383 Vali Loss: 1193.151 Vali Acc: 0.243 Test Loss: 1193.151 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 6752828
model size : 35.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.842502117156982
Epoch: 1, Steps: 17 | Train Loss: 31.119 Vali Loss: 62.084 Vali Acc: 0.255 Test Loss: 62.084 Test Acc: 0.255
Validation loss decreased (inf --> -0.254132).  Saving model ...
Epoch: 2 cost time: 5.644899129867554
Epoch: 2, Steps: 17 | Train Loss: 102.300 Vali Loss: 243.818 Vali Acc: 0.247 Test Loss: 243.818 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.09564208984375
Epoch: 3, Steps: 17 | Train Loss: 148.035 Vali Loss: 225.285 Vali Acc: 0.259 Test Loss: 225.285 Test Acc: 0.259
Validation loss decreased (-0.254132 --> -0.256302).  Saving model ...
Epoch: 4 cost time: 5.8886213302612305
Epoch: 4, Steps: 17 | Train Loss: 196.828 Vali Loss: 217.150 Vali Acc: 0.259 Test Loss: 217.150 Test Acc: 0.259
Validation loss decreased (-0.256302 --> -0.256384).  Saving model ...
Epoch: 5 cost time: 5.664508104324341
Epoch: 5, Steps: 17 | Train Loss: 143.862 Vali Loss: 235.982 Vali Acc: 0.240 Test Loss: 235.982 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.937615156173706
Epoch: 6, Steps: 17 | Train Loss: 214.484 Vali Loss: 494.307 Vali Acc: 0.247 Test Loss: 494.307 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.902069091796875
Epoch: 7, Steps: 17 | Train Loss: 203.579 Vali Loss: 531.416 Vali Acc: 0.262 Test Loss: 531.416 Test Acc: 0.262
Validation loss decreased (-0.256384 --> -0.257043).  Saving model ...
Epoch: 8 cost time: 6.371970176696777
Epoch: 8, Steps: 17 | Train Loss: 126.845 Vali Loss: 248.807 Vali Acc: 0.236 Test Loss: 248.807 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.264070749282837
Epoch: 9, Steps: 17 | Train Loss: 158.775 Vali Loss: 451.980 Vali Acc: 0.255 Test Loss: 451.980 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.006728410720825
Epoch: 10, Steps: 17 | Train Loss: 94.069 Vali Loss: 404.672 Vali Acc: 0.259 Test Loss: 404.672 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.964399576187134
Epoch: 11, Steps: 17 | Train Loss: 35.470 Vali Loss: 519.764 Vali Acc: 0.278 Test Loss: 519.764 Test Acc: 0.278
Validation loss decreased (-0.257043 --> -0.272369).  Saving model ...
Epoch: 12 cost time: 6.074620008468628
Epoch: 12, Steps: 17 | Train Loss: 82.468 Vali Loss: 574.400 Vali Acc: 0.281 Test Loss: 574.400 Test Acc: 0.281
Validation loss decreased (-0.272369 --> -0.275625).  Saving model ...
Epoch: 13 cost time: 6.105672597885132
Epoch: 13, Steps: 17 | Train Loss: 81.055 Vali Loss: 868.404 Vali Acc: 0.274 Test Loss: 868.404 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.9708027839660645
Epoch: 14, Steps: 17 | Train Loss: 103.809 Vali Loss: 1003.308 Vali Acc: 0.262 Test Loss: 1003.308 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.324209928512573
Epoch: 15, Steps: 17 | Train Loss: 97.713 Vali Loss: 951.213 Vali Acc: 0.259 Test Loss: 951.213 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.30340838432312
Epoch: 16, Steps: 17 | Train Loss: 84.615 Vali Loss: 1086.749 Vali Acc: 0.255 Test Loss: 1086.749 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.360865354537964
Epoch: 17, Steps: 17 | Train Loss: 45.771 Vali Loss: 1430.640 Vali Acc: 0.262 Test Loss: 1430.640 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.0487961769104
Epoch: 18, Steps: 17 | Train Loss: 60.417 Vali Loss: 1333.827 Vali Acc: 0.281 Test Loss: 1333.827 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.404388904571533
Epoch: 19, Steps: 17 | Train Loss: 52.282 Vali Loss: 1514.705 Vali Acc: 0.247 Test Loss: 1514.705 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.211948871612549
Epoch: 20, Steps: 17 | Train Loss: 47.961 Vali Loss: 2087.939 Vali Acc: 0.262 Test Loss: 2087.939 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.320805549621582
Epoch: 21, Steps: 17 | Train Loss: 111.404 Vali Loss: 1887.113 Vali Acc: 0.270 Test Loss: 1887.113 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.4020349979400635
Epoch: 22, Steps: 17 | Train Loss: 47.227 Vali Loss: 1899.391 Vali Acc: 0.240 Test Loss: 1899.391 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 6752828
model size : 35.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.558732032775879
Epoch: 1, Steps: 17 | Train Loss: 41.636 Vali Loss: 140.108 Vali Acc: 0.251 Test Loss: 140.108 Test Acc: 0.251
Validation loss decreased (inf --> -0.249549).  Saving model ...
Epoch: 2 cost time: 5.086928844451904
Epoch: 2, Steps: 17 | Train Loss: 121.613 Vali Loss: 157.130 Vali Acc: 0.266 Test Loss: 157.130 Test Acc: 0.266
Validation loss decreased (-0.249549 --> -0.264588).  Saving model ...
Epoch: 3 cost time: 5.075574159622192
Epoch: 3, Steps: 17 | Train Loss: 125.081 Vali Loss: 150.235 Vali Acc: 0.247 Test Loss: 150.235 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.264619827270508
Epoch: 4, Steps: 17 | Train Loss: 193.132 Vali Loss: 122.636 Vali Acc: 0.255 Test Loss: 122.636 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.55022668838501
Epoch: 5, Steps: 17 | Train Loss: 121.571 Vali Loss: 157.717 Vali Acc: 0.255 Test Loss: 157.717 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.208146095275879
Epoch: 6, Steps: 17 | Train Loss: 130.681 Vali Loss: 327.847 Vali Acc: 0.240 Test Loss: 327.847 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.359532117843628
Epoch: 7, Steps: 17 | Train Loss: 147.388 Vali Loss: 270.638 Vali Acc: 0.255 Test Loss: 270.638 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.47787880897522
Epoch: 8, Steps: 17 | Train Loss: 64.162 Vali Loss: 219.435 Vali Acc: 0.262 Test Loss: 219.435 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.408642292022705
Epoch: 9, Steps: 17 | Train Loss: 93.028 Vali Loss: 405.171 Vali Acc: 0.262 Test Loss: 405.171 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.497331380844116
Epoch: 10, Steps: 17 | Train Loss: 121.849 Vali Loss: 498.517 Vali Acc: 0.255 Test Loss: 498.517 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.466139316558838
Epoch: 11, Steps: 17 | Train Loss: 161.722 Vali Loss: 598.878 Vali Acc: 0.236 Test Loss: 598.878 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.470155715942383
Epoch: 12, Steps: 17 | Train Loss: 114.507 Vali Loss: 909.475 Vali Acc: 0.270 Test Loss: 909.475 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 6752828
model size : 35.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.70740294456482
Epoch: 1, Steps: 17 | Train Loss: 68.704 Vali Loss: 190.566 Vali Acc: 0.236 Test Loss: 190.566 Test Acc: 0.236
Validation loss decreased (inf --> -0.233836).  Saving model ...
Epoch: 2 cost time: 6.302229881286621
Epoch: 2, Steps: 17 | Train Loss: 113.315 Vali Loss: 59.768 Vali Acc: 0.221 Test Loss: 59.768 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.467600584030151
Epoch: 3, Steps: 17 | Train Loss: 68.059 Vali Loss: 136.429 Vali Acc: 0.255 Test Loss: 136.429 Test Acc: 0.255
Validation loss decreased (-0.233836 --> -0.253389).  Saving model ...
Epoch: 4 cost time: 6.866897106170654
Epoch: 4, Steps: 17 | Train Loss: 132.195 Vali Loss: 146.670 Vali Acc: 0.255 Test Loss: 146.670 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.732407569885254
Epoch: 5, Steps: 17 | Train Loss: 135.637 Vali Loss: 403.645 Vali Acc: 0.247 Test Loss: 403.645 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.832542657852173
Epoch: 6, Steps: 17 | Train Loss: 136.229 Vali Loss: 265.023 Vali Acc: 0.251 Test Loss: 265.023 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.771666526794434
Epoch: 7, Steps: 17 | Train Loss: 113.995 Vali Loss: 180.730 Vali Acc: 0.255 Test Loss: 180.730 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.651566028594971
Epoch: 8, Steps: 17 | Train Loss: 98.411 Vali Loss: 289.101 Vali Acc: 0.259 Test Loss: 289.101 Test Acc: 0.259
Validation loss decreased (-0.253389 --> -0.255664).  Saving model ...
Epoch: 9 cost time: 7.0040740966796875
Epoch: 9, Steps: 17 | Train Loss: 114.077 Vali Loss: 278.956 Vali Acc: 0.259 Test Loss: 278.956 Test Acc: 0.259
Validation loss decreased (-0.255664 --> -0.255766).  Saving model ...
Epoch: 10 cost time: 6.789337396621704
Epoch: 10, Steps: 17 | Train Loss: 136.649 Vali Loss: 347.335 Vali Acc: 0.228 Test Loss: 347.335 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.986605644226074
Epoch: 11, Steps: 17 | Train Loss: 150.722 Vali Loss: 521.116 Vali Acc: 0.262 Test Loss: 521.116 Test Acc: 0.262
Validation loss decreased (-0.255766 --> -0.257146).  Saving model ...
Epoch: 12 cost time: 6.907916307449341
Epoch: 12, Steps: 17 | Train Loss: 92.903 Vali Loss: 504.748 Vali Acc: 0.240 Test Loss: 504.748 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.001971006393433
Epoch: 13, Steps: 17 | Train Loss: 54.245 Vali Loss: 623.093 Vali Acc: 0.236 Test Loss: 623.093 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.825853109359741
Epoch: 14, Steps: 17 | Train Loss: 49.844 Vali Loss: 738.775 Vali Acc: 0.255 Test Loss: 738.775 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.886575698852539
Epoch: 15, Steps: 17 | Train Loss: 57.068 Vali Loss: 931.572 Vali Acc: 0.259 Test Loss: 931.572 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.983574867248535
Epoch: 16, Steps: 17 | Train Loss: 55.799 Vali Loss: 893.428 Vali Acc: 0.232 Test Loss: 893.428 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.862234354019165
Epoch: 17, Steps: 17 | Train Loss: 28.779 Vali Loss: 1196.761 Vali Acc: 0.259 Test Loss: 1196.761 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.82004189491272
Epoch: 18, Steps: 17 | Train Loss: 82.710 Vali Loss: 1286.160 Vali Acc: 0.243 Test Loss: 1286.160 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.7885613441467285
Epoch: 19, Steps: 17 | Train Loss: 87.976 Vali Loss: 1688.448 Vali Acc: 0.270 Test Loss: 1688.448 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.030977725982666
Epoch: 20, Steps: 17 | Train Loss: 117.833 Vali Loss: 1859.429 Vali Acc: 0.247 Test Loss: 1859.429 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.064843416213989
Epoch: 21, Steps: 17 | Train Loss: 83.096 Vali Loss: 1989.129 Vali Acc: 0.251 Test Loss: 1989.129 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 5704252
model size : 31.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.513607978820801
Epoch: 1, Steps: 17 | Train Loss: 37.384 Vali Loss: 144.995 Vali Acc: 0.251 Test Loss: 144.995 Test Acc: 0.251
Validation loss decreased (inf --> -0.249501).  Saving model ...
Epoch: 2 cost time: 6.142688035964966
Epoch: 2, Steps: 17 | Train Loss: 159.754 Vali Loss: 134.748 Vali Acc: 0.247 Test Loss: 134.748 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.054210662841797
Epoch: 3, Steps: 17 | Train Loss: 111.018 Vali Loss: 236.202 Vali Acc: 0.247 Test Loss: 236.202 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.950496196746826
Epoch: 4, Steps: 17 | Train Loss: 137.605 Vali Loss: 196.521 Vali Acc: 0.255 Test Loss: 196.521 Test Acc: 0.255
Validation loss decreased (-0.249501 --> -0.252788).  Saving model ...
Epoch: 5 cost time: 6.188291072845459
Epoch: 5, Steps: 17 | Train Loss: 130.774 Vali Loss: 204.822 Vali Acc: 0.251 Test Loss: 204.822 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.1307337284088135
Epoch: 6, Steps: 17 | Train Loss: 99.738 Vali Loss: 185.060 Vali Acc: 0.240 Test Loss: 185.060 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.343737363815308
Epoch: 7, Steps: 17 | Train Loss: 95.167 Vali Loss: 123.984 Vali Acc: 0.240 Test Loss: 123.984 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.069030284881592
Epoch: 8, Steps: 17 | Train Loss: 95.223 Vali Loss: 291.203 Vali Acc: 0.281 Test Loss: 291.203 Test Acc: 0.281
Validation loss decreased (-0.252788 --> -0.278457).  Saving model ...
Epoch: 9 cost time: 6.138051748275757
Epoch: 9, Steps: 17 | Train Loss: 97.999 Vali Loss: 478.054 Vali Acc: 0.255 Test Loss: 478.054 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.233323812484741
Epoch: 10, Steps: 17 | Train Loss: 225.973 Vali Loss: 338.454 Vali Acc: 0.285 Test Loss: 338.454 Test Acc: 0.285
Validation loss decreased (-0.278457 --> -0.281787).  Saving model ...
Epoch: 11 cost time: 6.2074174880981445
Epoch: 11, Steps: 17 | Train Loss: 65.873 Vali Loss: 432.177 Vali Acc: 0.243 Test Loss: 432.177 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.068225145339966
Epoch: 12, Steps: 17 | Train Loss: 92.067 Vali Loss: 554.054 Vali Acc: 0.247 Test Loss: 554.054 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.173080921173096
Epoch: 13, Steps: 17 | Train Loss: 71.055 Vali Loss: 577.195 Vali Acc: 0.240 Test Loss: 577.195 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.206698894500732
Epoch: 14, Steps: 17 | Train Loss: 59.830 Vali Loss: 872.585 Vali Acc: 0.255 Test Loss: 872.585 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.245104551315308
Epoch: 15, Steps: 17 | Train Loss: 108.163 Vali Loss: 1261.816 Vali Acc: 0.270 Test Loss: 1261.816 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.238690376281738
Epoch: 16, Steps: 17 | Train Loss: 136.283 Vali Loss: 1291.910 Vali Acc: 0.316 Test Loss: 1291.910 Test Acc: 0.316
Validation loss decreased (-0.281787 --> -0.302670).  Saving model ...
Epoch: 17 cost time: 6.153346300125122
Epoch: 17, Steps: 17 | Train Loss: 62.286 Vali Loss: 1171.645 Vali Acc: 0.266 Test Loss: 1171.645 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.192861080169678
Epoch: 18, Steps: 17 | Train Loss: 103.820 Vali Loss: 1360.183 Vali Acc: 0.251 Test Loss: 1360.183 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.898744583129883
Epoch: 19, Steps: 17 | Train Loss: 60.654 Vali Loss: 1589.974 Vali Acc: 0.270 Test Loss: 1589.974 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.205796003341675
Epoch: 20, Steps: 17 | Train Loss: 108.899 Vali Loss: 1969.654 Vali Acc: 0.247 Test Loss: 1969.654 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.423734664916992
Epoch: 21, Steps: 17 | Train Loss: 39.571 Vali Loss: 1801.702 Vali Acc: 0.274 Test Loss: 1801.702 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.148656129837036
Epoch: 22, Steps: 17 | Train Loss: 30.170 Vali Loss: 2064.108 Vali Acc: 0.251 Test Loss: 2064.108 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.19970178604126
Epoch: 23, Steps: 17 | Train Loss: 100.218 Vali Loss: 2006.668 Vali Acc: 0.278 Test Loss: 2006.668 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.798741579055786
Epoch: 24, Steps: 17 | Train Loss: 19.281 Vali Loss: 2146.016 Vali Acc: 0.262 Test Loss: 2146.016 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.114354610443115
Epoch: 25, Steps: 17 | Train Loss: 25.394 Vali Loss: 2302.293 Vali Acc: 0.247 Test Loss: 2302.293 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.273499250411987
Epoch: 26, Steps: 17 | Train Loss: 44.589 Vali Loss: 2368.825 Vali Acc: 0.247 Test Loss: 2368.825 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 5704252
model size : 31.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.195303678512573
Epoch: 1, Steps: 17 | Train Loss: 34.473 Vali Loss: 121.993 Vali Acc: 0.247 Test Loss: 121.993 Test Acc: 0.247
Validation loss decreased (inf --> -0.245928).  Saving model ...
Epoch: 2 cost time: 5.647421360015869
Epoch: 2, Steps: 17 | Train Loss: 87.270 Vali Loss: 60.919 Vali Acc: 0.262 Test Loss: 60.919 Test Acc: 0.262
Validation loss decreased (-0.245928 --> -0.261748).  Saving model ...
Epoch: 3 cost time: 5.5493128299713135
Epoch: 3, Steps: 17 | Train Loss: 71.369 Vali Loss: 205.348 Vali Acc: 0.251 Test Loss: 205.348 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.719834089279175
Epoch: 4, Steps: 17 | Train Loss: 89.848 Vali Loss: 145.745 Vali Acc: 0.251 Test Loss: 145.745 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.760790109634399
Epoch: 5, Steps: 17 | Train Loss: 151.854 Vali Loss: 166.552 Vali Acc: 0.232 Test Loss: 166.552 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.994622707366943
Epoch: 6, Steps: 17 | Train Loss: 141.199 Vali Loss: 228.361 Vali Acc: 0.262 Test Loss: 228.361 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.784737825393677
Epoch: 7, Steps: 17 | Train Loss: 137.927 Vali Loss: 275.126 Vali Acc: 0.270 Test Loss: 275.126 Test Acc: 0.270
Validation loss decreased (-0.261748 --> -0.267211).  Saving model ...
Epoch: 8 cost time: 5.749448776245117
Epoch: 8, Steps: 17 | Train Loss: 181.406 Vali Loss: 481.730 Vali Acc: 0.270 Test Loss: 481.730 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.636286973953247
Epoch: 9, Steps: 17 | Train Loss: 115.839 Vali Loss: 382.288 Vali Acc: 0.251 Test Loss: 382.288 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.863645076751709
Epoch: 10, Steps: 17 | Train Loss: 75.904 Vali Loss: 304.763 Vali Acc: 0.262 Test Loss: 304.763 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.6799187660217285
Epoch: 11, Steps: 17 | Train Loss: 51.902 Vali Loss: 416.963 Vali Acc: 0.251 Test Loss: 416.963 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.05130934715271
Epoch: 12, Steps: 17 | Train Loss: 75.570 Vali Loss: 658.381 Vali Acc: 0.259 Test Loss: 658.381 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.721978187561035
Epoch: 13, Steps: 17 | Train Loss: 66.889 Vali Loss: 657.462 Vali Acc: 0.255 Test Loss: 657.462 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.701808214187622
Epoch: 14, Steps: 17 | Train Loss: 72.256 Vali Loss: 708.950 Vali Acc: 0.262 Test Loss: 708.950 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.631824493408203
Epoch: 15, Steps: 17 | Train Loss: 79.122 Vali Loss: 707.599 Vali Acc: 0.266 Test Loss: 707.599 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.714287996292114
Epoch: 16, Steps: 17 | Train Loss: 50.656 Vali Loss: 1040.565 Vali Acc: 0.255 Test Loss: 1040.565 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.667126417160034
Epoch: 17, Steps: 17 | Train Loss: 49.974 Vali Loss: 1272.729 Vali Acc: 0.243 Test Loss: 1272.729 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 5704252
model size : 31.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.05480170249939
Epoch: 1, Steps: 17 | Train Loss: 34.833 Vali Loss: 82.202 Vali Acc: 0.251 Test Loss: 82.202 Test Acc: 0.251
Validation loss decreased (inf --> -0.250129).  Saving model ...
Epoch: 2 cost time: 5.085708856582642
Epoch: 2, Steps: 17 | Train Loss: 135.329 Vali Loss: 79.999 Vali Acc: 0.259 Test Loss: 79.999 Test Acc: 0.259
Validation loss decreased (-0.250129 --> -0.257755).  Saving model ...
Epoch: 3 cost time: 5.156907796859741
Epoch: 3, Steps: 17 | Train Loss: 124.266 Vali Loss: 138.758 Vali Acc: 0.232 Test Loss: 138.758 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.279805421829224
Epoch: 4, Steps: 17 | Train Loss: 179.885 Vali Loss: 263.045 Vali Acc: 0.255 Test Loss: 263.045 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.240029573440552
Epoch: 5, Steps: 17 | Train Loss: 238.966 Vali Loss: 305.682 Vali Acc: 0.243 Test Loss: 305.682 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.317898273468018
Epoch: 6, Steps: 17 | Train Loss: 285.930 Vali Loss: 422.261 Vali Acc: 0.240 Test Loss: 422.261 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.032956838607788
Epoch: 7, Steps: 17 | Train Loss: 148.768 Vali Loss: 188.292 Vali Acc: 0.297 Test Loss: 188.292 Test Acc: 0.297
Validation loss decreased (-0.257755 --> -0.294695).  Saving model ...
Epoch: 8 cost time: 5.078863859176636
Epoch: 8, Steps: 17 | Train Loss: 66.505 Vali Loss: 194.432 Vali Acc: 0.262 Test Loss: 194.432 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.133373022079468
Epoch: 9, Steps: 17 | Train Loss: 84.151 Vali Loss: 303.244 Vali Acc: 0.262 Test Loss: 303.244 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.211065769195557
Epoch: 10, Steps: 17 | Train Loss: 82.158 Vali Loss: 344.581 Vali Acc: 0.240 Test Loss: 344.581 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.118123769760132
Epoch: 11, Steps: 17 | Train Loss: 57.995 Vali Loss: 481.934 Vali Acc: 0.243 Test Loss: 481.934 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.068931818008423
Epoch: 12, Steps: 17 | Train Loss: 110.223 Vali Loss: 750.005 Vali Acc: 0.289 Test Loss: 750.005 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.942046642303467
Epoch: 13, Steps: 17 | Train Loss: 109.748 Vali Loss: 789.981 Vali Acc: 0.270 Test Loss: 789.981 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.23406720161438
Epoch: 14, Steps: 17 | Train Loss: 97.117 Vali Loss: 931.265 Vali Acc: 0.281 Test Loss: 931.265 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.127181053161621
Epoch: 15, Steps: 17 | Train Loss: 89.317 Vali Loss: 895.942 Vali Acc: 0.240 Test Loss: 895.942 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.098495960235596
Epoch: 16, Steps: 17 | Train Loss: 54.559 Vali Loss: 948.370 Vali Acc: 0.236 Test Loss: 948.370 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.200250625610352
Epoch: 17, Steps: 17 | Train Loss: 79.328 Vali Loss: 1092.593 Vali Acc: 0.205 Test Loss: 1092.593 Test Acc: 0.205
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 5704252
model size : 31.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.488412380218506
Epoch: 1, Steps: 17 | Train Loss: 50.844 Vali Loss: 128.026 Vali Acc: 0.236 Test Loss: 128.026 Test Acc: 0.236
Validation loss decreased (inf --> -0.234461).  Saving model ...
Epoch: 2 cost time: 6.546489477157593
Epoch: 2, Steps: 17 | Train Loss: 93.142 Vali Loss: 129.868 Vali Acc: 0.251 Test Loss: 129.868 Test Acc: 0.251
Validation loss decreased (-0.234461 --> -0.249652).  Saving model ...
Epoch: 3 cost time: 6.154894828796387
Epoch: 3, Steps: 17 | Train Loss: 122.689 Vali Loss: 250.704 Vali Acc: 0.259 Test Loss: 250.704 Test Acc: 0.259
Validation loss decreased (-0.249652 --> -0.256048).  Saving model ...
Epoch: 4 cost time: 6.37664532661438
Epoch: 4, Steps: 17 | Train Loss: 141.548 Vali Loss: 119.947 Vali Acc: 0.266 Test Loss: 119.947 Test Acc: 0.266
Validation loss decreased (-0.256048 --> -0.264960).  Saving model ...
Epoch: 5 cost time: 6.441513538360596
Epoch: 5, Steps: 17 | Train Loss: 91.257 Vali Loss: 138.425 Vali Acc: 0.213 Test Loss: 138.425 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.457991123199463
Epoch: 6, Steps: 17 | Train Loss: 166.801 Vali Loss: 279.446 Vali Acc: 0.228 Test Loss: 279.446 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.141344785690308
Epoch: 7, Steps: 17 | Train Loss: 141.613 Vali Loss: 316.826 Vali Acc: 0.247 Test Loss: 316.826 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.460208415985107
Epoch: 8, Steps: 17 | Train Loss: 181.271 Vali Loss: 201.904 Vali Acc: 0.262 Test Loss: 201.904 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.181956052780151
Epoch: 9, Steps: 17 | Train Loss: 95.602 Vali Loss: 514.064 Vali Acc: 0.259 Test Loss: 514.064 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.238839864730835
Epoch: 10, Steps: 17 | Train Loss: 126.738 Vali Loss: 353.947 Vali Acc: 0.259 Test Loss: 353.947 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.177592754364014
Epoch: 11, Steps: 17 | Train Loss: 58.169 Vali Loss: 387.006 Vali Acc: 0.259 Test Loss: 387.006 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.2643797397613525
Epoch: 12, Steps: 17 | Train Loss: 41.574 Vali Loss: 475.097 Vali Acc: 0.270 Test Loss: 475.097 Test Acc: 0.270
Validation loss decreased (-0.264960 --> -0.265211).  Saving model ...
Epoch: 13 cost time: 6.340628385543823
Epoch: 13, Steps: 17 | Train Loss: 62.957 Vali Loss: 700.044 Vali Acc: 0.262 Test Loss: 700.044 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.373757362365723
Epoch: 14, Steps: 17 | Train Loss: 41.016 Vali Loss: 786.069 Vali Acc: 0.232 Test Loss: 786.069 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.534585237503052
Epoch: 15, Steps: 17 | Train Loss: 61.736 Vali Loss: 897.949 Vali Acc: 0.259 Test Loss: 897.949 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.619484186172485
Epoch: 16, Steps: 17 | Train Loss: 73.554 Vali Loss: 1036.312 Vali Acc: 0.259 Test Loss: 1036.312 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.6782636642456055
Epoch: 17, Steps: 17 | Train Loss: 37.189 Vali Loss: 1265.289 Vali Acc: 0.297 Test Loss: 1265.289 Test Acc: 0.297
Validation loss decreased (-0.265211 --> -0.283925).  Saving model ...
Epoch: 18 cost time: 6.57823371887207
Epoch: 18, Steps: 17 | Train Loss: 54.433 Vali Loss: 1148.815 Vali Acc: 0.251 Test Loss: 1148.815 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.875566482543945
Epoch: 19, Steps: 17 | Train Loss: 66.119 Vali Loss: 1247.759 Vali Acc: 0.236 Test Loss: 1247.759 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.661661863327026
Epoch: 20, Steps: 17 | Train Loss: 35.974 Vali Loss: 1467.462 Vali Acc: 0.243 Test Loss: 1467.462 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.768199682235718
Epoch: 21, Steps: 17 | Train Loss: 37.458 Vali Loss: 1572.469 Vali Acc: 0.232 Test Loss: 1572.469 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.633901834487915
Epoch: 22, Steps: 17 | Train Loss: 49.571 Vali Loss: 2072.621 Vali Acc: 0.240 Test Loss: 2072.621 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.622714996337891
Epoch: 23, Steps: 17 | Train Loss: 22.634 Vali Loss: 2234.097 Vali Acc: 0.213 Test Loss: 2234.097 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.785527944564819
Epoch: 24, Steps: 17 | Train Loss: 44.072 Vali Loss: 2358.406 Vali Acc: 0.224 Test Loss: 2358.406 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.503396034240723
Epoch: 25, Steps: 17 | Train Loss: 26.809 Vali Loss: 2667.821 Vali Acc: 0.259 Test Loss: 2667.821 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.671970844268799
Epoch: 26, Steps: 17 | Train Loss: 73.044 Vali Loss: 3358.434 Vali Acc: 0.213 Test Loss: 3358.434 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.734294891357422
Epoch: 27, Steps: 17 | Train Loss: 19.943 Vali Loss: 3551.554 Vali Acc: 0.232 Test Loss: 3551.554 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 5179964
model size : 29.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.80899977684021
Epoch: 1, Steps: 17 | Train Loss: 45.883 Vali Loss: 68.801 Vali Acc: 0.251 Test Loss: 68.801 Test Acc: 0.251
Validation loss decreased (inf --> -0.250263).  Saving model ...
Epoch: 2 cost time: 5.751512050628662
Epoch: 2, Steps: 17 | Train Loss: 70.008 Vali Loss: 161.792 Vali Acc: 0.251 Test Loss: 161.792 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.716141700744629
Epoch: 3, Steps: 17 | Train Loss: 165.642 Vali Loss: 298.145 Vali Acc: 0.240 Test Loss: 298.145 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.97986626625061
Epoch: 4, Steps: 17 | Train Loss: 206.520 Vali Loss: 204.154 Vali Acc: 0.236 Test Loss: 204.154 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.822597026824951
Epoch: 5, Steps: 17 | Train Loss: 182.209 Vali Loss: 276.073 Vali Acc: 0.262 Test Loss: 276.073 Test Acc: 0.262
Validation loss decreased (-0.250263 --> -0.259597).  Saving model ...
Epoch: 6 cost time: 5.857113599777222
Epoch: 6, Steps: 17 | Train Loss: 171.030 Vali Loss: 328.778 Vali Acc: 0.240 Test Loss: 328.778 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.872323751449585
Epoch: 7, Steps: 17 | Train Loss: 124.933 Vali Loss: 213.437 Vali Acc: 0.255 Test Loss: 213.437 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.765140533447266
Epoch: 8, Steps: 17 | Train Loss: 80.482 Vali Loss: 183.491 Vali Acc: 0.247 Test Loss: 183.491 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.833564758300781
Epoch: 9, Steps: 17 | Train Loss: 79.807 Vali Loss: 495.922 Vali Acc: 0.251 Test Loss: 495.922 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.036943674087524
Epoch: 10, Steps: 17 | Train Loss: 148.892 Vali Loss: 618.433 Vali Acc: 0.259 Test Loss: 618.433 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.884353399276733
Epoch: 11, Steps: 17 | Train Loss: 100.156 Vali Loss: 384.240 Vali Acc: 0.259 Test Loss: 384.240 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.813096523284912
Epoch: 12, Steps: 17 | Train Loss: 32.567 Vali Loss: 509.427 Vali Acc: 0.289 Test Loss: 509.427 Test Acc: 0.289
Validation loss decreased (-0.259597 --> -0.283879).  Saving model ...
Epoch: 13 cost time: 5.5885009765625
Epoch: 13, Steps: 17 | Train Loss: 62.696 Vali Loss: 665.677 Vali Acc: 0.251 Test Loss: 665.677 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.758976697921753
Epoch: 14, Steps: 17 | Train Loss: 84.412 Vali Loss: 709.123 Vali Acc: 0.266 Test Loss: 709.123 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.05484414100647
Epoch: 15, Steps: 17 | Train Loss: 67.238 Vali Loss: 836.058 Vali Acc: 0.293 Test Loss: 836.058 Test Acc: 0.293
Validation loss decreased (-0.283879 --> -0.284415).  Saving model ...
Epoch: 16 cost time: 6.030667543411255
Epoch: 16, Steps: 17 | Train Loss: 59.441 Vali Loss: 1077.517 Vali Acc: 0.293 Test Loss: 1077.517 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.330717086791992
Epoch: 17, Steps: 17 | Train Loss: 111.560 Vali Loss: 1169.019 Vali Acc: 0.262 Test Loss: 1169.019 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.381409645080566
Epoch: 18, Steps: 17 | Train Loss: 57.621 Vali Loss: 1951.003 Vali Acc: 0.251 Test Loss: 1951.003 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.41248893737793
Epoch: 19, Steps: 17 | Train Loss: 77.602 Vali Loss: 1806.492 Vali Acc: 0.278 Test Loss: 1806.492 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.369312286376953
Epoch: 20, Steps: 17 | Train Loss: 58.470 Vali Loss: 1961.427 Vali Acc: 0.289 Test Loss: 1961.427 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.586545467376709
Epoch: 21, Steps: 17 | Train Loss: 55.845 Vali Loss: 1911.448 Vali Acc: 0.247 Test Loss: 1911.448 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.48893666267395
Epoch: 22, Steps: 17 | Train Loss: 35.851 Vali Loss: 2466.978 Vali Acc: 0.266 Test Loss: 2466.978 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.40454626083374
Epoch: 23, Steps: 17 | Train Loss: 64.675 Vali Loss: 2298.657 Vali Acc: 0.274 Test Loss: 2298.657 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.230314016342163
Epoch: 24, Steps: 17 | Train Loss: 59.289 Vali Loss: 2463.549 Vali Acc: 0.251 Test Loss: 2463.549 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.366643905639648
Epoch: 25, Steps: 17 | Train Loss: 42.876 Vali Loss: 2518.921 Vali Acc: 0.262 Test Loss: 2518.921 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 5179964
model size : 29.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.2675700187683105
Epoch: 1, Steps: 17 | Train Loss: 71.507 Vali Loss: 70.499 Vali Acc: 0.259 Test Loss: 70.499 Test Acc: 0.259
Validation loss decreased (inf --> -0.257850).  Saving model ...
Epoch: 2 cost time: 5.232672929763794
Epoch: 2, Steps: 17 | Train Loss: 102.186 Vali Loss: 56.532 Vali Acc: 0.232 Test Loss: 56.532 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.3944642543792725
Epoch: 3, Steps: 17 | Train Loss: 131.877 Vali Loss: 117.278 Vali Acc: 0.262 Test Loss: 117.278 Test Acc: 0.262
Validation loss decreased (-0.257850 --> -0.261185).  Saving model ...
Epoch: 4 cost time: 5.39004111289978
Epoch: 4, Steps: 17 | Train Loss: 140.835 Vali Loss: 192.786 Vali Acc: 0.228 Test Loss: 192.786 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.425762414932251
Epoch: 5, Steps: 17 | Train Loss: 169.028 Vali Loss: 315.273 Vali Acc: 0.251 Test Loss: 315.273 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.7443835735321045
Epoch: 6, Steps: 17 | Train Loss: 153.223 Vali Loss: 151.650 Vali Acc: 0.262 Test Loss: 151.650 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.438847064971924
Epoch: 7, Steps: 17 | Train Loss: 124.378 Vali Loss: 181.678 Vali Acc: 0.278 Test Loss: 181.678 Test Acc: 0.278
Validation loss decreased (-0.261185 --> -0.275750).  Saving model ...
Epoch: 8 cost time: 5.534659385681152
Epoch: 8, Steps: 17 | Train Loss: 105.010 Vali Loss: 374.382 Vali Acc: 0.247 Test Loss: 374.382 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.809512138366699
Epoch: 9, Steps: 17 | Train Loss: 125.676 Vali Loss: 567.159 Vali Acc: 0.285 Test Loss: 567.159 Test Acc: 0.285
Validation loss decreased (-0.275750 --> -0.279500).  Saving model ...
Epoch: 10 cost time: 5.234845876693726
Epoch: 10, Steps: 17 | Train Loss: 92.419 Vali Loss: 343.030 Vali Acc: 0.259 Test Loss: 343.030 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.381906032562256
Epoch: 11, Steps: 17 | Train Loss: 58.732 Vali Loss: 334.572 Vali Acc: 0.259 Test Loss: 334.572 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.51379919052124
Epoch: 12, Steps: 17 | Train Loss: 77.819 Vali Loss: 582.508 Vali Acc: 0.236 Test Loss: 582.508 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.382527589797974
Epoch: 13, Steps: 17 | Train Loss: 44.473 Vali Loss: 629.201 Vali Acc: 0.251 Test Loss: 629.201 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.677594423294067
Epoch: 14, Steps: 17 | Train Loss: 72.730 Vali Loss: 692.372 Vali Acc: 0.278 Test Loss: 692.372 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.629014492034912
Epoch: 15, Steps: 17 | Train Loss: 56.683 Vali Loss: 906.342 Vali Acc: 0.289 Test Loss: 906.342 Test Acc: 0.289
Validation loss decreased (-0.279500 --> -0.279910).  Saving model ...
Epoch: 16 cost time: 5.304419040679932
Epoch: 16, Steps: 17 | Train Loss: 108.918 Vali Loss: 1097.829 Vali Acc: 0.236 Test Loss: 1097.829 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.555362224578857
Epoch: 17, Steps: 17 | Train Loss: 50.778 Vali Loss: 1129.736 Vali Acc: 0.259 Test Loss: 1129.736 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.3489601612091064
Epoch: 18, Steps: 17 | Train Loss: 96.302 Vali Loss: 1343.770 Vali Acc: 0.262 Test Loss: 1343.770 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.4154579639434814
Epoch: 19, Steps: 17 | Train Loss: 74.618 Vali Loss: 1766.285 Vali Acc: 0.262 Test Loss: 1766.285 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.598636627197266
Epoch: 20, Steps: 17 | Train Loss: 135.338 Vali Loss: 1863.053 Vali Acc: 0.266 Test Loss: 1863.053 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.31964373588562
Epoch: 21, Steps: 17 | Train Loss: 64.967 Vali Loss: 1906.687 Vali Acc: 0.255 Test Loss: 1906.687 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.437216520309448
Epoch: 22, Steps: 17 | Train Loss: 45.543 Vali Loss: 1952.600 Vali Acc: 0.247 Test Loss: 1952.600 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.551441192626953
Epoch: 23, Steps: 17 | Train Loss: 21.118 Vali Loss: 1967.203 Vali Acc: 0.262 Test Loss: 1967.203 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.405734062194824
Epoch: 24, Steps: 17 | Train Loss: 49.748 Vali Loss: 2164.510 Vali Acc: 0.274 Test Loss: 2164.510 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.6351025104522705
Epoch: 25, Steps: 17 | Train Loss: 59.164 Vali Loss: 2200.787 Vali Acc: 0.270 Test Loss: 2200.787 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 5179964
model size : 29.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.874374866485596
Epoch: 1, Steps: 17 | Train Loss: 30.809 Vali Loss: 87.114 Vali Acc: 0.251 Test Loss: 87.114 Test Acc: 0.251
Validation loss decreased (inf --> -0.250079).  Saving model ...
Epoch: 2 cost time: 4.8429343700408936
Epoch: 2, Steps: 17 | Train Loss: 133.939 Vali Loss: 144.601 Vali Acc: 0.259 Test Loss: 144.601 Test Acc: 0.259
Validation loss decreased (-0.250079 --> -0.257109).  Saving model ...
Epoch: 3 cost time: 5.210938453674316
Epoch: 3, Steps: 17 | Train Loss: 97.663 Vali Loss: 62.962 Vali Acc: 0.262 Test Loss: 62.962 Test Acc: 0.262
Validation loss decreased (-0.257109 --> -0.261728).  Saving model ...
Epoch: 4 cost time: 4.9106433391571045
Epoch: 4, Steps: 17 | Train Loss: 116.174 Vali Loss: 213.321 Vali Acc: 0.240 Test Loss: 213.321 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.1902899742126465
Epoch: 5, Steps: 17 | Train Loss: 185.629 Vali Loss: 217.887 Vali Acc: 0.259 Test Loss: 217.887 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.021980285644531
Epoch: 6, Steps: 17 | Train Loss: 141.803 Vali Loss: 165.351 Vali Acc: 0.266 Test Loss: 165.351 Test Acc: 0.266
Validation loss decreased (-0.261728 --> -0.264506).  Saving model ...
Epoch: 7 cost time: 4.938311815261841
Epoch: 7, Steps: 17 | Train Loss: 107.296 Vali Loss: 147.970 Vali Acc: 0.255 Test Loss: 147.970 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.248762130737305
Epoch: 8, Steps: 17 | Train Loss: 107.593 Vali Loss: 303.877 Vali Acc: 0.243 Test Loss: 303.877 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.934765815734863
Epoch: 9, Steps: 17 | Train Loss: 64.060 Vali Loss: 337.505 Vali Acc: 0.262 Test Loss: 337.505 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.057022571563721
Epoch: 10, Steps: 17 | Train Loss: 109.129 Vali Loss: 693.839 Vali Acc: 0.259 Test Loss: 693.839 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.115327835083008
Epoch: 11, Steps: 17 | Train Loss: 93.371 Vali Loss: 594.449 Vali Acc: 0.209 Test Loss: 594.449 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.997369289398193
Epoch: 12, Steps: 17 | Train Loss: 100.952 Vali Loss: 703.536 Vali Acc: 0.262 Test Loss: 703.536 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.113952159881592
Epoch: 13, Steps: 17 | Train Loss: 56.286 Vali Loss: 772.032 Vali Acc: 0.209 Test Loss: 772.032 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.173147439956665
Epoch: 14, Steps: 17 | Train Loss: 78.628 Vali Loss: 760.507 Vali Acc: 0.232 Test Loss: 760.507 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.914592266082764
Epoch: 15, Steps: 17 | Train Loss: 50.897 Vali Loss: 816.573 Vali Acc: 0.224 Test Loss: 816.573 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.158015489578247
Epoch: 16, Steps: 17 | Train Loss: 66.162 Vali Loss: 1319.111 Vali Acc: 0.232 Test Loss: 1319.111 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 5179964
model size : 29.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.11348032951355
Epoch: 1, Steps: 17 | Train Loss: 36.368 Vali Loss: 87.429 Vali Acc: 0.232 Test Loss: 87.429 Test Acc: 0.232
Validation loss decreased (inf --> -0.231065).  Saving model ...
Epoch: 2 cost time: 6.076744079589844
Epoch: 2, Steps: 17 | Train Loss: 108.107 Vali Loss: 214.612 Vali Acc: 0.251 Test Loss: 214.612 Test Acc: 0.251
Validation loss decreased (-0.231065 --> -0.248804).  Saving model ...
Epoch: 3 cost time: 6.374849081039429
Epoch: 3, Steps: 17 | Train Loss: 136.929 Vali Loss: 147.752 Vali Acc: 0.224 Test Loss: 147.752 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.361897945404053
Epoch: 4, Steps: 17 | Train Loss: 154.652 Vali Loss: 90.391 Vali Acc: 0.213 Test Loss: 90.391 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.568613767623901
Epoch: 5, Steps: 17 | Train Loss: 144.208 Vali Loss: 238.429 Vali Acc: 0.243 Test Loss: 238.429 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.490427255630493
Epoch: 6, Steps: 17 | Train Loss: 101.012 Vali Loss: 244.805 Vali Acc: 0.266 Test Loss: 244.805 Test Acc: 0.266
Validation loss decreased (-0.248804 --> -0.263712).  Saving model ...
Epoch: 7 cost time: 6.431007385253906
Epoch: 7, Steps: 17 | Train Loss: 108.983 Vali Loss: 165.621 Vali Acc: 0.270 Test Loss: 165.621 Test Acc: 0.270
Validation loss decreased (-0.263712 --> -0.268306).  Saving model ...
Epoch: 8 cost time: 6.286016225814819
Epoch: 8, Steps: 17 | Train Loss: 124.696 Vali Loss: 271.595 Vali Acc: 0.274 Test Loss: 271.595 Test Acc: 0.274
Validation loss decreased (-0.268306 --> -0.271048).  Saving model ...
Epoch: 9 cost time: 6.510374069213867
Epoch: 9, Steps: 17 | Train Loss: 103.108 Vali Loss: 354.576 Vali Acc: 0.243 Test Loss: 354.576 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.495687484741211
Epoch: 10, Steps: 17 | Train Loss: 95.949 Vali Loss: 375.752 Vali Acc: 0.213 Test Loss: 375.752 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.311027765274048
Epoch: 11, Steps: 17 | Train Loss: 43.407 Vali Loss: 440.460 Vali Acc: 0.255 Test Loss: 440.460 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.472954750061035
Epoch: 12, Steps: 17 | Train Loss: 93.972 Vali Loss: 626.658 Vali Acc: 0.289 Test Loss: 626.658 Test Acc: 0.289
Validation loss decreased (-0.271048 --> -0.282707).  Saving model ...
Epoch: 13 cost time: 6.4860851764678955
Epoch: 13, Steps: 17 | Train Loss: 105.104 Vali Loss: 704.178 Vali Acc: 0.259 Test Loss: 704.178 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.499293327331543
Epoch: 14, Steps: 17 | Train Loss: 79.134 Vali Loss: 810.899 Vali Acc: 0.232 Test Loss: 810.899 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.285646438598633
Epoch: 15, Steps: 17 | Train Loss: 33.985 Vali Loss: 1087.884 Vali Acc: 0.247 Test Loss: 1087.884 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.839222192764282
Epoch: 16, Steps: 17 | Train Loss: 80.859 Vali Loss: 1301.964 Vali Acc: 0.262 Test Loss: 1301.964 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.133821725845337
Epoch: 17, Steps: 17 | Train Loss: 62.003 Vali Loss: 1205.692 Vali Acc: 0.247 Test Loss: 1205.692 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.923409461975098
Epoch: 18, Steps: 17 | Train Loss: 36.348 Vali Loss: 1483.174 Vali Acc: 0.281 Test Loss: 1483.174 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.113946914672852
Epoch: 19, Steps: 17 | Train Loss: 59.636 Vali Loss: 1578.578 Vali Acc: 0.240 Test Loss: 1578.578 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.371600389480591
Epoch: 20, Steps: 17 | Train Loss: 55.638 Vali Loss: 1561.997 Vali Acc: 0.255 Test Loss: 1561.997 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.349740028381348
Epoch: 21, Steps: 17 | Train Loss: 17.374 Vali Loss: 1687.536 Vali Acc: 0.217 Test Loss: 1687.536 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.514413833618164
Epoch: 22, Steps: 17 | Train Loss: 43.438 Vali Loss: 1886.163 Vali Acc: 0.243 Test Loss: 1886.163 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 4917820
model size : 28.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.555718421936035
Epoch: 1, Steps: 17 | Train Loss: 52.227 Vali Loss: 67.982 Vali Acc: 0.247 Test Loss: 67.982 Test Acc: 0.247
Validation loss decreased (inf --> -0.246468).  Saving model ...
Epoch: 2 cost time: 5.5581324100494385
Epoch: 2, Steps: 17 | Train Loss: 129.509 Vali Loss: 246.530 Vali Acc: 0.243 Test Loss: 246.530 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.628229141235352
Epoch: 3, Steps: 17 | Train Loss: 125.431 Vali Loss: 134.010 Vali Acc: 0.243 Test Loss: 134.010 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.559390306472778
Epoch: 4, Steps: 17 | Train Loss: 186.728 Vali Loss: 160.241 Vali Acc: 0.251 Test Loss: 160.241 Test Acc: 0.251
Validation loss decreased (-0.246468 --> -0.249348).  Saving model ...
Epoch: 5 cost time: 5.834697008132935
Epoch: 5, Steps: 17 | Train Loss: 187.656 Vali Loss: 222.106 Vali Acc: 0.247 Test Loss: 222.106 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.671745300292969
Epoch: 6, Steps: 17 | Train Loss: 130.867 Vali Loss: 247.986 Vali Acc: 0.262 Test Loss: 247.986 Test Acc: 0.262
Validation loss decreased (-0.249348 --> -0.259878).  Saving model ...
Epoch: 7 cost time: 6.13605260848999
Epoch: 7, Steps: 17 | Train Loss: 104.077 Vali Loss: 201.113 Vali Acc: 0.224 Test Loss: 201.113 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.737233400344849
Epoch: 8, Steps: 17 | Train Loss: 86.979 Vali Loss: 281.715 Vali Acc: 0.255 Test Loss: 281.715 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.709578037261963
Epoch: 9, Steps: 17 | Train Loss: 101.683 Vali Loss: 456.075 Vali Acc: 0.236 Test Loss: 456.075 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.71251654624939
Epoch: 10, Steps: 17 | Train Loss: 119.461 Vali Loss: 369.362 Vali Acc: 0.259 Test Loss: 369.362 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.462096214294434
Epoch: 11, Steps: 17 | Train Loss: 113.547 Vali Loss: 472.896 Vali Acc: 0.270 Test Loss: 472.896 Test Acc: 0.270
Validation loss decreased (-0.259878 --> -0.265233).  Saving model ...
Epoch: 12 cost time: 5.36442756652832
Epoch: 12, Steps: 17 | Train Loss: 128.280 Vali Loss: 1056.181 Vali Acc: 0.274 Test Loss: 1056.181 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.9393556118011475
Epoch: 13, Steps: 17 | Train Loss: 206.498 Vali Loss: 750.935 Vali Acc: 0.259 Test Loss: 750.935 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.8828535079956055
Epoch: 14, Steps: 17 | Train Loss: 81.806 Vali Loss: 853.899 Vali Acc: 0.266 Test Loss: 853.899 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.725831031799316
Epoch: 15, Steps: 17 | Train Loss: 69.477 Vali Loss: 1001.855 Vali Acc: 0.240 Test Loss: 1001.855 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.964602708816528
Epoch: 16, Steps: 17 | Train Loss: 67.128 Vali Loss: 977.341 Vali Acc: 0.232 Test Loss: 977.341 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.770950794219971
Epoch: 17, Steps: 17 | Train Loss: 50.958 Vali Loss: 1140.375 Vali Acc: 0.247 Test Loss: 1140.375 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.778180837631226
Epoch: 18, Steps: 17 | Train Loss: 82.960 Vali Loss: 1390.568 Vali Acc: 0.255 Test Loss: 1390.568 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.018756628036499
Epoch: 19, Steps: 17 | Train Loss: 39.654 Vali Loss: 1694.817 Vali Acc: 0.289 Test Loss: 1694.817 Test Acc: 0.289
Validation loss decreased (-0.265233 --> -0.272025).  Saving model ...
Epoch: 20 cost time: 5.857941150665283
Epoch: 20, Steps: 17 | Train Loss: 46.490 Vali Loss: 1736.344 Vali Acc: 0.217 Test Loss: 1736.344 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.0396623611450195
Epoch: 21, Steps: 17 | Train Loss: 37.354 Vali Loss: 1831.333 Vali Acc: 0.251 Test Loss: 1831.333 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.507325649261475
Epoch: 22, Steps: 17 | Train Loss: 29.374 Vali Loss: 2035.937 Vali Acc: 0.240 Test Loss: 2035.937 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.321676254272461
Epoch: 23, Steps: 17 | Train Loss: 50.577 Vali Loss: 2170.956 Vali Acc: 0.236 Test Loss: 2170.956 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.133244276046753
Epoch: 24, Steps: 17 | Train Loss: 75.205 Vali Loss: 2174.192 Vali Acc: 0.232 Test Loss: 2174.192 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.934295892715454
Epoch: 25, Steps: 17 | Train Loss: 75.797 Vali Loss: 2661.841 Vali Acc: 0.213 Test Loss: 2661.841 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.819606304168701
Epoch: 26, Steps: 17 | Train Loss: 37.025 Vali Loss: 2994.736 Vali Acc: 0.243 Test Loss: 2994.736 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.942477464675903
Epoch: 27, Steps: 17 | Train Loss: 56.119 Vali Loss: 3242.660 Vali Acc: 0.205 Test Loss: 3242.660 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.846495628356934
Epoch: 28, Steps: 17 | Train Loss: 46.669 Vali Loss: 4112.843 Vali Acc: 0.259 Test Loss: 4112.843 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.112938404083252
Epoch: 29, Steps: 17 | Train Loss: 13.148 Vali Loss: 4309.049 Vali Acc: 0.259 Test Loss: 4309.049 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 4917820
model size : 28.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.211888074874878
Epoch: 1, Steps: 17 | Train Loss: 53.291 Vali Loss: 132.889 Vali Acc: 0.251 Test Loss: 132.889 Test Acc: 0.251
Validation loss decreased (inf --> -0.249622).  Saving model ...
Epoch: 2 cost time: 5.191166162490845
Epoch: 2, Steps: 17 | Train Loss: 130.708 Vali Loss: 187.224 Vali Acc: 0.243 Test Loss: 187.224 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.185642957687378
Epoch: 3, Steps: 17 | Train Loss: 135.152 Vali Loss: 128.078 Vali Acc: 0.240 Test Loss: 128.078 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.171664237976074
Epoch: 4, Steps: 17 | Train Loss: 108.676 Vali Loss: 206.337 Vali Acc: 0.247 Test Loss: 206.337 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.435353755950928
Epoch: 5, Steps: 17 | Train Loss: 187.972 Vali Loss: 261.184 Vali Acc: 0.240 Test Loss: 261.184 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.337407827377319
Epoch: 6, Steps: 17 | Train Loss: 125.918 Vali Loss: 420.709 Vali Acc: 0.251 Test Loss: 420.709 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.493148565292358
Epoch: 7, Steps: 17 | Train Loss: 164.605 Vali Loss: 199.478 Vali Acc: 0.236 Test Loss: 199.478 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.431727886199951
Epoch: 8, Steps: 17 | Train Loss: 108.784 Vali Loss: 286.357 Vali Acc: 0.251 Test Loss: 286.357 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.33906364440918
Epoch: 9, Steps: 17 | Train Loss: 140.125 Vali Loss: 453.337 Vali Acc: 0.247 Test Loss: 453.337 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.603283405303955
Epoch: 10, Steps: 17 | Train Loss: 76.729 Vali Loss: 405.099 Vali Acc: 0.266 Test Loss: 405.099 Test Acc: 0.266
Validation loss decreased (-0.249622 --> -0.262109).  Saving model ...
Epoch: 11 cost time: 5.199598789215088
Epoch: 11, Steps: 17 | Train Loss: 76.552 Vali Loss: 442.795 Vali Acc: 0.221 Test Loss: 442.795 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.242835760116577
Epoch: 12, Steps: 17 | Train Loss: 60.649 Vali Loss: 683.961 Vali Acc: 0.251 Test Loss: 683.961 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.350286245346069
Epoch: 13, Steps: 17 | Train Loss: 127.927 Vali Loss: 875.306 Vali Acc: 0.251 Test Loss: 875.306 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.3812785148620605
Epoch: 14, Steps: 17 | Train Loss: 92.617 Vali Loss: 1015.630 Vali Acc: 0.274 Test Loss: 1015.630 Test Acc: 0.274
Validation loss decreased (-0.262109 --> -0.263608).  Saving model ...
Epoch: 15 cost time: 5.45450496673584
Epoch: 15, Steps: 17 | Train Loss: 53.228 Vali Loss: 1001.196 Vali Acc: 0.247 Test Loss: 1001.196 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.264898300170898
Epoch: 16, Steps: 17 | Train Loss: 27.467 Vali Loss: 1094.591 Vali Acc: 0.274 Test Loss: 1094.591 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.252631902694702
Epoch: 17, Steps: 17 | Train Loss: 127.794 Vali Loss: 1459.357 Vali Acc: 0.281 Test Loss: 1459.357 Test Acc: 0.281
Validation loss decreased (-0.263608 --> -0.266775).  Saving model ...
Epoch: 18 cost time: 5.202316761016846
Epoch: 18, Steps: 17 | Train Loss: 36.619 Vali Loss: 1536.922 Vali Acc: 0.247 Test Loss: 1536.922 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.388497829437256
Epoch: 19, Steps: 17 | Train Loss: 68.923 Vali Loss: 2035.729 Vali Acc: 0.262 Test Loss: 2035.729 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.53085732460022
Epoch: 20, Steps: 17 | Train Loss: 189.717 Vali Loss: 2415.286 Vali Acc: 0.259 Test Loss: 2415.286 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.450681924819946
Epoch: 21, Steps: 17 | Train Loss: 43.528 Vali Loss: 2546.430 Vali Acc: 0.281 Test Loss: 2546.430 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.594743728637695
Epoch: 22, Steps: 17 | Train Loss: 72.195 Vali Loss: 2358.077 Vali Acc: 0.262 Test Loss: 2358.077 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.611937999725342
Epoch: 23, Steps: 17 | Train Loss: 26.850 Vali Loss: 2282.340 Vali Acc: 0.251 Test Loss: 2282.340 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.569652080535889
Epoch: 24, Steps: 17 | Train Loss: 29.367 Vali Loss: 2546.510 Vali Acc: 0.259 Test Loss: 2546.510 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.859027147293091
Epoch: 25, Steps: 17 | Train Loss: 70.041 Vali Loss: 3222.007 Vali Acc: 0.251 Test Loss: 3222.007 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.614160060882568
Epoch: 26, Steps: 17 | Train Loss: 104.444 Vali Loss: 3328.615 Vali Acc: 0.259 Test Loss: 3328.615 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.5592756271362305
Epoch: 27, Steps: 17 | Train Loss: 63.617 Vali Loss: 3239.397 Vali Acc: 0.251 Test Loss: 3239.397 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 4917820
model size : 28.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.223654508590698
Epoch: 1, Steps: 17 | Train Loss: 40.771 Vali Loss: 58.290 Vali Acc: 0.255 Test Loss: 58.290 Test Acc: 0.255
Validation loss decreased (inf --> -0.254170).  Saving model ...
Epoch: 2 cost time: 4.816778898239136
Epoch: 2, Steps: 17 | Train Loss: 114.563 Vali Loss: 124.958 Vali Acc: 0.247 Test Loss: 124.958 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.8894362449646
Epoch: 3, Steps: 17 | Train Loss: 89.302 Vali Loss: 59.999 Vali Acc: 0.236 Test Loss: 59.999 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.976084470748901
Epoch: 4, Steps: 17 | Train Loss: 121.227 Vali Loss: 255.555 Vali Acc: 0.251 Test Loss: 255.555 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.898977279663086
Epoch: 5, Steps: 17 | Train Loss: 211.242 Vali Loss: 180.391 Vali Acc: 0.251 Test Loss: 180.391 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.784918785095215
Epoch: 6, Steps: 17 | Train Loss: 98.572 Vali Loss: 171.237 Vali Acc: 0.255 Test Loss: 171.237 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.767917156219482
Epoch: 7, Steps: 17 | Train Loss: 70.214 Vali Loss: 191.092 Vali Acc: 0.262 Test Loss: 191.092 Test Acc: 0.262
Validation loss decreased (-0.254170 --> -0.260446).  Saving model ...
Epoch: 8 cost time: 4.898603200912476
Epoch: 8, Steps: 17 | Train Loss: 93.458 Vali Loss: 221.937 Vali Acc: 0.278 Test Loss: 221.937 Test Acc: 0.278
Validation loss decreased (-0.260446 --> -0.275347).  Saving model ...
Epoch: 9 cost time: 4.84128737449646
Epoch: 9, Steps: 17 | Train Loss: 108.622 Vali Loss: 326.537 Vali Acc: 0.274 Test Loss: 326.537 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.6241254806518555
Epoch: 10, Steps: 17 | Train Loss: 59.358 Vali Loss: 385.463 Vali Acc: 0.243 Test Loss: 385.463 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.839309215545654
Epoch: 11, Steps: 17 | Train Loss: 48.251 Vali Loss: 395.811 Vali Acc: 0.217 Test Loss: 395.811 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.019782304763794
Epoch: 12, Steps: 17 | Train Loss: 73.768 Vali Loss: 791.542 Vali Acc: 0.255 Test Loss: 791.542 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.88161826133728
Epoch: 13, Steps: 17 | Train Loss: 127.267 Vali Loss: 952.869 Vali Acc: 0.285 Test Loss: 952.869 Test Acc: 0.285
Validation loss decreased (-0.275347 --> -0.275642).  Saving model ...
Epoch: 14 cost time: 5.045504570007324
Epoch: 14, Steps: 17 | Train Loss: 106.872 Vali Loss: 933.645 Vali Acc: 0.240 Test Loss: 933.645 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.61332368850708
Epoch: 15, Steps: 17 | Train Loss: 96.193 Vali Loss: 1023.719 Vali Acc: 0.221 Test Loss: 1023.719 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.811959266662598
Epoch: 16, Steps: 17 | Train Loss: 50.708 Vali Loss: 1126.823 Vali Acc: 0.274 Test Loss: 1126.823 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.690633058547974
Epoch: 17, Steps: 17 | Train Loss: 37.937 Vali Loss: 1334.509 Vali Acc: 0.228 Test Loss: 1334.509 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.766704082489014
Epoch: 18, Steps: 17 | Train Loss: 47.029 Vali Loss: 1442.553 Vali Acc: 0.221 Test Loss: 1442.553 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.733388900756836
Epoch: 19, Steps: 17 | Train Loss: 40.966 Vali Loss: 1944.546 Vali Acc: 0.224 Test Loss: 1944.546 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.668733835220337
Epoch: 20, Steps: 17 | Train Loss: 104.389 Vali Loss: 2127.996 Vali Acc: 0.278 Test Loss: 2127.996 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.85232138633728
Epoch: 21, Steps: 17 | Train Loss: 69.672 Vali Loss: 2377.463 Vali Acc: 0.243 Test Loss: 2377.463 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.75719428062439
Epoch: 22, Steps: 17 | Train Loss: 22.202 Vali Loss: 2268.621 Vali Acc: 0.240 Test Loss: 2268.621 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.7788801193237305
Epoch: 23, Steps: 17 | Train Loss: 22.802 Vali Loss: 2785.105 Vali Acc: 0.243 Test Loss: 2785.105 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 4917820
model size : 28.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.9848792552948
Epoch: 1, Steps: 17 | Train Loss: 39.829 Vali Loss: 103.707 Vali Acc: 0.247 Test Loss: 103.707 Test Acc: 0.247
Validation loss decreased (inf --> -0.246111).  Saving model ...
Epoch: 2 cost time: 6.302985668182373
Epoch: 2, Steps: 17 | Train Loss: 92.399 Vali Loss: 205.950 Vali Acc: 0.255 Test Loss: 205.950 Test Acc: 0.255
Validation loss decreased (-0.246111 --> -0.252693).  Saving model ...
Epoch: 3 cost time: 6.280268430709839
Epoch: 3, Steps: 17 | Train Loss: 87.304 Vali Loss: 91.157 Vali Acc: 0.259 Test Loss: 91.157 Test Acc: 0.259
Validation loss decreased (-0.252693 --> -0.257644).  Saving model ...
Epoch: 4 cost time: 6.540695667266846
Epoch: 4, Steps: 17 | Train Loss: 127.620 Vali Loss: 360.832 Vali Acc: 0.251 Test Loss: 360.832 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.762738943099976
Epoch: 5, Steps: 17 | Train Loss: 158.054 Vali Loss: 176.333 Vali Acc: 0.278 Test Loss: 176.333 Test Acc: 0.278
Validation loss decreased (-0.257644 --> -0.275803).  Saving model ...
Epoch: 6 cost time: 6.861854314804077
Epoch: 6, Steps: 17 | Train Loss: 73.324 Vali Loss: 130.406 Vali Acc: 0.259 Test Loss: 130.406 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.697937726974487
Epoch: 7, Steps: 17 | Train Loss: 118.599 Vali Loss: 173.437 Vali Acc: 0.251 Test Loss: 173.437 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.843068838119507
Epoch: 8, Steps: 17 | Train Loss: 169.160 Vali Loss: 480.260 Vali Acc: 0.240 Test Loss: 480.260 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.765554904937744
Epoch: 9, Steps: 17 | Train Loss: 186.695 Vali Loss: 332.502 Vali Acc: 0.270 Test Loss: 332.502 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.645199775695801
Epoch: 10, Steps: 17 | Train Loss: 99.363 Vali Loss: 382.091 Vali Acc: 0.243 Test Loss: 382.091 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.590612411499023
Epoch: 11, Steps: 17 | Train Loss: 77.733 Vali Loss: 485.823 Vali Acc: 0.251 Test Loss: 485.823 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.769923448562622
Epoch: 12, Steps: 17 | Train Loss: 67.701 Vali Loss: 503.247 Vali Acc: 0.251 Test Loss: 503.247 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.48800253868103
Epoch: 13, Steps: 17 | Train Loss: 62.281 Vali Loss: 632.760 Vali Acc: 0.228 Test Loss: 632.760 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.8814191818237305
Epoch: 14, Steps: 17 | Train Loss: 80.855 Vali Loss: 861.967 Vali Acc: 0.293 Test Loss: 861.967 Test Acc: 0.293
Validation loss decreased (-0.275803 --> -0.284156).  Saving model ...
Epoch: 15 cost time: 6.826789855957031
Epoch: 15, Steps: 17 | Train Loss: 67.261 Vali Loss: 888.204 Vali Acc: 0.247 Test Loss: 888.204 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.895947694778442
Epoch: 16, Steps: 17 | Train Loss: 63.837 Vali Loss: 1151.665 Vali Acc: 0.274 Test Loss: 1151.665 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.6209938526153564
Epoch: 17, Steps: 17 | Train Loss: 52.427 Vali Loss: 1267.653 Vali Acc: 0.289 Test Loss: 1267.653 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.503242254257202
Epoch: 18, Steps: 17 | Train Loss: 39.903 Vali Loss: 1338.001 Vali Acc: 0.247 Test Loss: 1338.001 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.49251914024353
Epoch: 19, Steps: 17 | Train Loss: 28.780 Vali Loss: 1342.150 Vali Acc: 0.240 Test Loss: 1342.150 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.155687093734741
Epoch: 20, Steps: 17 | Train Loss: 20.154 Vali Loss: 1383.105 Vali Acc: 0.240 Test Loss: 1383.105 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.41301965713501
Epoch: 21, Steps: 17 | Train Loss: 26.290 Vali Loss: 1646.375 Vali Acc: 0.240 Test Loss: 1646.375 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.284232139587402
Epoch: 22, Steps: 17 | Train Loss: 56.241 Vali Loss: 1669.572 Vali Acc: 0.259 Test Loss: 1669.572 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.418114900588989
Epoch: 23, Steps: 17 | Train Loss: 78.744 Vali Loss: 1825.994 Vali Acc: 0.247 Test Loss: 1825.994 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.120603799819946
Epoch: 24, Steps: 17 | Train Loss: 55.345 Vali Loss: 2219.382 Vali Acc: 0.270 Test Loss: 2219.382 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 4786748
model size : 28.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.465074062347412
Epoch: 1, Steps: 17 | Train Loss: 34.434 Vali Loss: 73.080 Vali Acc: 0.255 Test Loss: 73.080 Test Acc: 0.255
Validation loss decreased (inf --> -0.254022).  Saving model ...
Epoch: 2 cost time: 5.249568700790405
Epoch: 2, Steps: 17 | Train Loss: 81.448 Vali Loss: 90.336 Vali Acc: 0.262 Test Loss: 90.336 Test Acc: 0.262
Validation loss decreased (-0.254022 --> -0.261454).  Saving model ...
Epoch: 3 cost time: 5.864673852920532
Epoch: 3, Steps: 17 | Train Loss: 126.136 Vali Loss: 127.556 Vali Acc: 0.243 Test Loss: 127.556 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.002184867858887
Epoch: 4, Steps: 17 | Train Loss: 166.904 Vali Loss: 167.174 Vali Acc: 0.259 Test Loss: 167.174 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.8994903564453125
Epoch: 5, Steps: 17 | Train Loss: 151.273 Vali Loss: 197.103 Vali Acc: 0.274 Test Loss: 197.103 Test Acc: 0.274
Validation loss decreased (-0.261454 --> -0.271793).  Saving model ...
Epoch: 6 cost time: 6.031504154205322
Epoch: 6, Steps: 17 | Train Loss: 157.634 Vali Loss: 135.257 Vali Acc: 0.247 Test Loss: 135.257 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.007529973983765
Epoch: 7, Steps: 17 | Train Loss: 93.257 Vali Loss: 124.624 Vali Acc: 0.278 Test Loss: 124.624 Test Acc: 0.278
Validation loss decreased (-0.271793 --> -0.276320).  Saving model ...
Epoch: 8 cost time: 5.765681505203247
Epoch: 8, Steps: 17 | Train Loss: 96.395 Vali Loss: 260.411 Vali Acc: 0.259 Test Loss: 260.411 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.062082052230835
Epoch: 9, Steps: 17 | Train Loss: 80.644 Vali Loss: 282.960 Vali Acc: 0.262 Test Loss: 282.960 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.033981084823608
Epoch: 10, Steps: 17 | Train Loss: 74.491 Vali Loss: 373.037 Vali Acc: 0.281 Test Loss: 373.037 Test Acc: 0.281
Validation loss decreased (-0.276320 --> -0.277638).  Saving model ...
Epoch: 11 cost time: 5.895518779754639
Epoch: 11, Steps: 17 | Train Loss: 58.916 Vali Loss: 490.006 Vali Acc: 0.281 Test Loss: 490.006 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.9599034786224365
Epoch: 12, Steps: 17 | Train Loss: 92.357 Vali Loss: 565.722 Vali Acc: 0.247 Test Loss: 565.722 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.213956832885742
Epoch: 13, Steps: 17 | Train Loss: 88.266 Vali Loss: 732.262 Vali Acc: 0.243 Test Loss: 732.262 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.148702144622803
Epoch: 14, Steps: 17 | Train Loss: 89.781 Vali Loss: 822.100 Vali Acc: 0.255 Test Loss: 822.100 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.035806179046631
Epoch: 15, Steps: 17 | Train Loss: 85.056 Vali Loss: 890.909 Vali Acc: 0.251 Test Loss: 890.909 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.8275322914123535
Epoch: 16, Steps: 17 | Train Loss: 70.331 Vali Loss: 919.613 Vali Acc: 0.217 Test Loss: 919.613 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.905538320541382
Epoch: 17, Steps: 17 | Train Loss: 47.084 Vali Loss: 1051.364 Vali Acc: 0.274 Test Loss: 1051.364 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.913838863372803
Epoch: 18, Steps: 17 | Train Loss: 68.556 Vali Loss: 1399.030 Vali Acc: 0.270 Test Loss: 1399.030 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.84691047668457
Epoch: 19, Steps: 17 | Train Loss: 41.792 Vali Loss: 1486.099 Vali Acc: 0.251 Test Loss: 1486.099 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.092700481414795
Epoch: 20, Steps: 17 | Train Loss: 19.137 Vali Loss: 1535.376 Vali Acc: 0.266 Test Loss: 1535.376 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 4786748
model size : 28.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.160122394561768
Epoch: 1, Steps: 17 | Train Loss: 27.889 Vali Loss: 85.860 Vali Acc: 0.251 Test Loss: 85.860 Test Acc: 0.251
Validation loss decreased (inf --> -0.250092).  Saving model ...
Epoch: 2 cost time: 5.4833924770355225
Epoch: 2, Steps: 17 | Train Loss: 89.284 Vali Loss: 222.529 Vali Acc: 0.247 Test Loss: 222.529 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.418973445892334
Epoch: 3, Steps: 17 | Train Loss: 118.515 Vali Loss: 150.649 Vali Acc: 0.251 Test Loss: 150.649 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.346350431442261
Epoch: 4, Steps: 17 | Train Loss: 156.906 Vali Loss: 141.191 Vali Acc: 0.251 Test Loss: 141.191 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.375068664550781
Epoch: 5, Steps: 17 | Train Loss: 156.467 Vali Loss: 409.388 Vali Acc: 0.240 Test Loss: 409.388 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.358217239379883
Epoch: 6, Steps: 17 | Train Loss: 186.042 Vali Loss: 174.281 Vali Acc: 0.255 Test Loss: 174.281 Test Acc: 0.255
Validation loss decreased (-0.250092 --> -0.253010).  Saving model ...
Epoch: 7 cost time: 5.445096015930176
Epoch: 7, Steps: 17 | Train Loss: 82.028 Vali Loss: 211.711 Vali Acc: 0.232 Test Loss: 211.711 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.6271913051605225
Epoch: 8, Steps: 17 | Train Loss: 109.395 Vali Loss: 397.127 Vali Acc: 0.232 Test Loss: 397.127 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.452753305435181
Epoch: 9, Steps: 17 | Train Loss: 110.840 Vali Loss: 388.659 Vali Acc: 0.266 Test Loss: 388.659 Test Acc: 0.266
Validation loss decreased (-0.253010 --> -0.262273).  Saving model ...
Epoch: 10 cost time: 5.488301038742065
Epoch: 10, Steps: 17 | Train Loss: 129.951 Vali Loss: 623.131 Vali Acc: 0.262 Test Loss: 623.131 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.333965063095093
Epoch: 11, Steps: 17 | Train Loss: 119.562 Vali Loss: 530.863 Vali Acc: 0.274 Test Loss: 530.863 Test Acc: 0.274
Validation loss decreased (-0.262273 --> -0.268456).  Saving model ...
Epoch: 12 cost time: 5.248776912689209
Epoch: 12, Steps: 17 | Train Loss: 112.097 Vali Loss: 617.913 Vali Acc: 0.232 Test Loss: 617.913 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.2065818309783936
Epoch: 13, Steps: 17 | Train Loss: 130.360 Vali Loss: 851.316 Vali Acc: 0.251 Test Loss: 851.316 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.243863105773926
Epoch: 14, Steps: 17 | Train Loss: 52.314 Vali Loss: 842.708 Vali Acc: 0.270 Test Loss: 842.708 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.4038355350494385
Epoch: 15, Steps: 17 | Train Loss: 81.886 Vali Loss: 985.343 Vali Acc: 0.266 Test Loss: 985.343 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.3367919921875
Epoch: 16, Steps: 17 | Train Loss: 60.657 Vali Loss: 1087.131 Vali Acc: 0.266 Test Loss: 1087.131 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.2073445320129395
Epoch: 17, Steps: 17 | Train Loss: 66.467 Vali Loss: 1229.621 Vali Acc: 0.262 Test Loss: 1229.621 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.296527624130249
Epoch: 18, Steps: 17 | Train Loss: 77.081 Vali Loss: 1405.785 Vali Acc: 0.232 Test Loss: 1405.785 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.283804416656494
Epoch: 19, Steps: 17 | Train Loss: 40.820 Vali Loss: 1542.276 Vali Acc: 0.274 Test Loss: 1542.276 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.3529510498046875
Epoch: 20, Steps: 17 | Train Loss: 41.127 Vali Loss: 2060.338 Vali Acc: 0.240 Test Loss: 2060.338 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.369660377502441
Epoch: 21, Steps: 17 | Train Loss: 132.952 Vali Loss: 2039.180 Vali Acc: 0.232 Test Loss: 2039.180 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 4786748
model size : 28.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.472099304199219
Epoch: 1, Steps: 17 | Train Loss: 32.271 Vali Loss: 77.983 Vali Acc: 0.247 Test Loss: 77.983 Test Acc: 0.247
Validation loss decreased (inf --> -0.246368).  Saving model ...
Epoch: 2 cost time: 4.759921550750732
Epoch: 2, Steps: 17 | Train Loss: 116.813 Vali Loss: 102.446 Vali Acc: 0.232 Test Loss: 102.446 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.0658488273620605
Epoch: 3, Steps: 17 | Train Loss: 187.557 Vali Loss: 157.228 Vali Acc: 0.255 Test Loss: 157.228 Test Acc: 0.255
Validation loss decreased (-0.246368 --> -0.253181).  Saving model ...
Epoch: 4 cost time: 5.216974258422852
Epoch: 4, Steps: 17 | Train Loss: 147.264 Vali Loss: 176.406 Vali Acc: 0.251 Test Loss: 176.406 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.196751117706299
Epoch: 5, Steps: 17 | Train Loss: 123.122 Vali Loss: 261.256 Vali Acc: 0.262 Test Loss: 261.256 Test Acc: 0.262
Validation loss decreased (-0.253181 --> -0.259745).  Saving model ...
Epoch: 6 cost time: 5.195747375488281
Epoch: 6, Steps: 17 | Train Loss: 215.350 Vali Loss: 292.793 Vali Acc: 0.243 Test Loss: 292.793 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.146445274353027
Epoch: 7, Steps: 17 | Train Loss: 93.770 Vali Loss: 231.081 Vali Acc: 0.251 Test Loss: 231.081 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.250385522842407
Epoch: 8, Steps: 17 | Train Loss: 67.010 Vali Loss: 302.317 Vali Acc: 0.266 Test Loss: 302.317 Test Acc: 0.266
Validation loss decreased (-0.259745 --> -0.263137).  Saving model ...
Epoch: 9 cost time: 5.120040416717529
Epoch: 9, Steps: 17 | Train Loss: 102.882 Vali Loss: 287.595 Vali Acc: 0.255 Test Loss: 287.595 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.186017274856567
Epoch: 10, Steps: 17 | Train Loss: 42.886 Vali Loss: 364.313 Vali Acc: 0.228 Test Loss: 364.313 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.083455324172974
Epoch: 11, Steps: 17 | Train Loss: 50.581 Vali Loss: 358.005 Vali Acc: 0.224 Test Loss: 358.005 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.220813274383545
Epoch: 12, Steps: 17 | Train Loss: 31.009 Vali Loss: 425.016 Vali Acc: 0.259 Test Loss: 425.016 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.262693643569946
Epoch: 13, Steps: 17 | Train Loss: 64.662 Vali Loss: 510.045 Vali Acc: 0.262 Test Loss: 510.045 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.210846424102783
Epoch: 14, Steps: 17 | Train Loss: 90.524 Vali Loss: 918.915 Vali Acc: 0.266 Test Loss: 918.915 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.083372354507446
Epoch: 15, Steps: 17 | Train Loss: 80.323 Vali Loss: 1044.938 Vali Acc: 0.266 Test Loss: 1044.938 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.18038010597229
Epoch: 16, Steps: 17 | Train Loss: 36.637 Vali Loss: 1027.562 Vali Acc: 0.274 Test Loss: 1027.562 Test Acc: 0.274
Validation loss decreased (-0.263137 --> -0.263489).  Saving model ...
Epoch: 17 cost time: 5.24373722076416
Epoch: 17, Steps: 17 | Train Loss: 46.688 Vali Loss: 1108.003 Vali Acc: 0.259 Test Loss: 1108.003 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.155303239822388
Epoch: 18, Steps: 17 | Train Loss: 36.953 Vali Loss: 1117.946 Vali Acc: 0.266 Test Loss: 1117.946 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.339373588562012
Epoch: 19, Steps: 17 | Train Loss: 28.295 Vali Loss: 1167.515 Vali Acc: 0.274 Test Loss: 1167.515 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.117489337921143
Epoch: 20, Steps: 17 | Train Loss: 98.575 Vali Loss: 1366.965 Vali Acc: 0.243 Test Loss: 1366.965 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.152100086212158
Epoch: 21, Steps: 17 | Train Loss: 51.550 Vali Loss: 1711.768 Vali Acc: 0.259 Test Loss: 1711.768 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.16491436958313
Epoch: 22, Steps: 17 | Train Loss: 59.304 Vali Loss: 1853.234 Vali Acc: 0.259 Test Loss: 1853.234 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.887732028961182
Epoch: 23, Steps: 17 | Train Loss: 18.608 Vali Loss: 1815.939 Vali Acc: 0.243 Test Loss: 1815.939 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.894596099853516
Epoch: 24, Steps: 17 | Train Loss: 29.758 Vali Loss: 2031.472 Vali Acc: 0.243 Test Loss: 2031.472 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.904049396514893
Epoch: 25, Steps: 17 | Train Loss: 20.438 Vali Loss: 2309.127 Vali Acc: 0.209 Test Loss: 2309.127 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.895719766616821
Epoch: 26, Steps: 17 | Train Loss: 17.447 Vali Loss: 2733.978 Vali Acc: 0.232 Test Loss: 2733.978 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 4786748
model size : 28.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.244110345840454
Epoch: 1, Steps: 17 | Train Loss: 29.414 Vali Loss: 43.680 Vali Acc: 0.221 Test Loss: 43.680 Test Acc: 0.221
Validation loss decreased (inf --> -0.220096).  Saving model ...
Epoch: 2 cost time: 4.407578468322754
Epoch: 2, Steps: 17 | Train Loss: 64.870 Vali Loss: 91.395 Vali Acc: 0.251 Test Loss: 91.395 Test Acc: 0.251
Validation loss decreased (-0.220096 --> -0.250037).  Saving model ...
Epoch: 3 cost time: 4.4909913539886475
Epoch: 3, Steps: 17 | Train Loss: 77.015 Vali Loss: 133.706 Vali Acc: 0.247 Test Loss: 133.706 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.547452688217163
Epoch: 4, Steps: 17 | Train Loss: 90.746 Vali Loss: 116.299 Vali Acc: 0.232 Test Loss: 116.299 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.516040086746216
Epoch: 5, Steps: 17 | Train Loss: 123.634 Vali Loss: 171.300 Vali Acc: 0.259 Test Loss: 171.300 Test Acc: 0.259
Validation loss decreased (-0.250037 --> -0.256842).  Saving model ...
Epoch: 6 cost time: 4.3976523876190186
Epoch: 6, Steps: 17 | Train Loss: 102.292 Vali Loss: 147.176 Vali Acc: 0.247 Test Loss: 147.176 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.33207368850708
Epoch: 7, Steps: 17 | Train Loss: 84.738 Vali Loss: 125.167 Vali Acc: 0.247 Test Loss: 125.167 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.696710109710693
Epoch: 8, Steps: 17 | Train Loss: 74.344 Vali Loss: 122.116 Vali Acc: 0.266 Test Loss: 122.116 Test Acc: 0.266
Validation loss decreased (-0.256842 --> -0.264939).  Saving model ...
Epoch: 9 cost time: 4.54811954498291
Epoch: 9, Steps: 17 | Train Loss: 102.433 Vali Loss: 182.183 Vali Acc: 0.274 Test Loss: 182.183 Test Acc: 0.274
Validation loss decreased (-0.264939 --> -0.271942).  Saving model ...
Epoch: 10 cost time: 4.478924751281738
Epoch: 10, Steps: 17 | Train Loss: 106.011 Vali Loss: 223.583 Vali Acc: 0.262 Test Loss: 223.583 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.633554935455322
Epoch: 11, Steps: 17 | Train Loss: 62.601 Vali Loss: 141.732 Vali Acc: 0.259 Test Loss: 141.732 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.731017827987671
Epoch: 12, Steps: 17 | Train Loss: 32.006 Vali Loss: 168.808 Vali Acc: 0.243 Test Loss: 168.808 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.482954978942871
Epoch: 13, Steps: 17 | Train Loss: 62.725 Vali Loss: 201.621 Vali Acc: 0.270 Test Loss: 201.621 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.558131456375122
Epoch: 14, Steps: 17 | Train Loss: 19.886 Vali Loss: 252.585 Vali Acc: 0.259 Test Loss: 252.585 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.545472621917725
Epoch: 15, Steps: 17 | Train Loss: 46.976 Vali Loss: 249.843 Vali Acc: 0.259 Test Loss: 249.843 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.620370388031006
Epoch: 16, Steps: 17 | Train Loss: 77.573 Vali Loss: 517.233 Vali Acc: 0.255 Test Loss: 517.233 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.577431678771973
Epoch: 17, Steps: 17 | Train Loss: 79.246 Vali Loss: 386.292 Vali Acc: 0.270 Test Loss: 386.292 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.406883478164673
Epoch: 18, Steps: 17 | Train Loss: 32.257 Vali Loss: 432.365 Vali Acc: 0.243 Test Loss: 432.365 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.502404451370239
Epoch: 19, Steps: 17 | Train Loss: 19.141 Vali Loss: 399.978 Vali Acc: 0.251 Test Loss: 399.978 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 4162876
model size : 20.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.000096321105957
Epoch: 1, Steps: 17 | Train Loss: 38.670 Vali Loss: 69.184 Vali Acc: 0.255 Test Loss: 69.184 Test Acc: 0.255
Validation loss decreased (inf --> -0.254061).  Saving model ...
Epoch: 2 cost time: 4.149318218231201
Epoch: 2, Steps: 17 | Train Loss: 84.890 Vali Loss: 103.907 Vali Acc: 0.247 Test Loss: 103.907 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.360358238220215
Epoch: 3, Steps: 17 | Train Loss: 79.006 Vali Loss: 95.467 Vali Acc: 0.209 Test Loss: 95.467 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.230919599533081
Epoch: 4, Steps: 17 | Train Loss: 87.465 Vali Loss: 136.665 Vali Acc: 0.266 Test Loss: 136.665 Test Acc: 0.266
Validation loss decreased (-0.254061 --> -0.264793).  Saving model ...
Epoch: 5 cost time: 4.250325679779053
Epoch: 5, Steps: 17 | Train Loss: 103.200 Vali Loss: 166.757 Vali Acc: 0.255 Test Loss: 166.757 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.425653696060181
Epoch: 6, Steps: 17 | Train Loss: 77.134 Vali Loss: 91.838 Vali Acc: 0.255 Test Loss: 91.838 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.381972789764404
Epoch: 7, Steps: 17 | Train Loss: 69.435 Vali Loss: 50.909 Vali Acc: 0.262 Test Loss: 50.909 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.320553779602051
Epoch: 8, Steps: 17 | Train Loss: 75.358 Vali Loss: 158.806 Vali Acc: 0.243 Test Loss: 158.806 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.297985315322876
Epoch: 9, Steps: 17 | Train Loss: 92.635 Vali Loss: 141.208 Vali Acc: 0.243 Test Loss: 141.208 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.312053442001343
Epoch: 10, Steps: 17 | Train Loss: 76.372 Vali Loss: 204.700 Vali Acc: 0.278 Test Loss: 204.700 Test Acc: 0.278
Validation loss decreased (-0.264793 --> -0.275520).  Saving model ...
Epoch: 11 cost time: 4.251922369003296
Epoch: 11, Steps: 17 | Train Loss: 73.428 Vali Loss: 302.419 Vali Acc: 0.266 Test Loss: 302.419 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.2544825077056885
Epoch: 12, Steps: 17 | Train Loss: 118.866 Vali Loss: 208.035 Vali Acc: 0.243 Test Loss: 208.035 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.253467321395874
Epoch: 13, Steps: 17 | Train Loss: 47.125 Vali Loss: 221.905 Vali Acc: 0.228 Test Loss: 221.905 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.145859718322754
Epoch: 14, Steps: 17 | Train Loss: 38.345 Vali Loss: 316.779 Vali Acc: 0.285 Test Loss: 316.779 Test Acc: 0.285
Validation loss decreased (-0.275520 --> -0.282003).  Saving model ...
Epoch: 15 cost time: 4.223853349685669
Epoch: 15, Steps: 17 | Train Loss: 53.324 Vali Loss: 383.465 Vali Acc: 0.255 Test Loss: 383.465 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.310753583908081
Epoch: 16, Steps: 17 | Train Loss: 61.512 Vali Loss: 441.025 Vali Acc: 0.255 Test Loss: 441.025 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.248327732086182
Epoch: 17, Steps: 17 | Train Loss: 72.063 Vali Loss: 497.489 Vali Acc: 0.236 Test Loss: 497.489 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.354308128356934
Epoch: 18, Steps: 17 | Train Loss: 56.918 Vali Loss: 604.406 Vali Acc: 0.300 Test Loss: 604.406 Test Acc: 0.300
Validation loss decreased (-0.282003 --> -0.294336).  Saving model ...
Epoch: 19 cost time: 4.320091724395752
Epoch: 19, Steps: 17 | Train Loss: 42.603 Vali Loss: 480.593 Vali Acc: 0.274 Test Loss: 480.593 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.396188497543335
Epoch: 20, Steps: 17 | Train Loss: 21.023 Vali Loss: 462.086 Vali Acc: 0.281 Test Loss: 462.086 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.365069150924683
Epoch: 21, Steps: 17 | Train Loss: 19.119 Vali Loss: 548.473 Vali Acc: 0.270 Test Loss: 548.473 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.3518242835998535
Epoch: 22, Steps: 17 | Train Loss: 24.135 Vali Loss: 640.786 Vali Acc: 0.259 Test Loss: 640.786 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.480895757675171
Epoch: 23, Steps: 17 | Train Loss: 10.644 Vali Loss: 690.890 Vali Acc: 0.259 Test Loss: 690.890 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.274079084396362
Epoch: 24, Steps: 17 | Train Loss: 11.307 Vali Loss: 744.839 Vali Acc: 0.262 Test Loss: 744.839 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.099859952926636
Epoch: 25, Steps: 17 | Train Loss: 16.161 Vali Loss: 844.609 Vali Acc: 0.240 Test Loss: 844.609 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.2514402866363525
Epoch: 26, Steps: 17 | Train Loss: 22.109 Vali Loss: 850.651 Vali Acc: 0.285 Test Loss: 850.651 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.302967071533203
Epoch: 27, Steps: 17 | Train Loss: 15.474 Vali Loss: 808.924 Vali Acc: 0.262 Test Loss: 808.924 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.480195760726929
Epoch: 28, Steps: 17 | Train Loss: 7.784 Vali Loss: 809.277 Vali Acc: 0.247 Test Loss: 809.277 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 4162876
model size : 20.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.646229028701782
Epoch: 1, Steps: 17 | Train Loss: 36.931 Vali Loss: 44.078 Vali Acc: 0.262 Test Loss: 44.078 Test Acc: 0.262
Validation loss decreased (inf --> -0.261917).  Saving model ...
Epoch: 2 cost time: 3.7942841053009033
Epoch: 2, Steps: 17 | Train Loss: 62.847 Vali Loss: 93.708 Vali Acc: 0.247 Test Loss: 93.708 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.756324291229248
Epoch: 3, Steps: 17 | Train Loss: 61.651 Vali Loss: 26.732 Vali Acc: 0.281 Test Loss: 26.732 Test Acc: 0.281
Validation loss decreased (-0.261917 --> -0.281101).  Saving model ...
Epoch: 4 cost time: 3.8360440731048584
Epoch: 4, Steps: 17 | Train Loss: 53.389 Vali Loss: 82.113 Vali Acc: 0.270 Test Loss: 82.113 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.824967384338379
Epoch: 5, Steps: 17 | Train Loss: 72.530 Vali Loss: 158.663 Vali Acc: 0.228 Test Loss: 158.663 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.8115320205688477
Epoch: 6, Steps: 17 | Train Loss: 147.503 Vali Loss: 154.186 Vali Acc: 0.236 Test Loss: 154.186 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.9082274436950684
Epoch: 7, Steps: 17 | Train Loss: 115.970 Vali Loss: 221.346 Vali Acc: 0.247 Test Loss: 221.346 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.7954676151275635
Epoch: 8, Steps: 17 | Train Loss: 164.811 Vali Loss: 247.658 Vali Acc: 0.255 Test Loss: 247.658 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.9189372062683105
Epoch: 9, Steps: 17 | Train Loss: 98.938 Vali Loss: 270.653 Vali Acc: 0.247 Test Loss: 270.653 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.883105516433716
Epoch: 10, Steps: 17 | Train Loss: 151.123 Vali Loss: 165.132 Vali Acc: 0.243 Test Loss: 165.132 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.033670663833618
Epoch: 11, Steps: 17 | Train Loss: 58.788 Vali Loss: 137.915 Vali Acc: 0.243 Test Loss: 137.915 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.862079620361328
Epoch: 12, Steps: 17 | Train Loss: 39.318 Vali Loss: 200.188 Vali Acc: 0.251 Test Loss: 200.188 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.044273138046265
Epoch: 13, Steps: 17 | Train Loss: 40.472 Vali Loss: 171.014 Vali Acc: 0.251 Test Loss: 171.014 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 4162876
model size : 20.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.637217998504639
Epoch: 1, Steps: 17 | Train Loss: 31.615 Vali Loss: 22.195 Vali Acc: 0.285 Test Loss: 22.195 Test Acc: 0.285
Validation loss decreased (inf --> -0.284949).  Saving model ...
Epoch: 2 cost time: 3.7006893157958984
Epoch: 2, Steps: 17 | Train Loss: 37.456 Vali Loss: 24.229 Vali Acc: 0.240 Test Loss: 24.229 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.477403163909912
Epoch: 3, Steps: 17 | Train Loss: 56.777 Vali Loss: 47.256 Vali Acc: 0.243 Test Loss: 47.256 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4455840587615967
Epoch: 4, Steps: 17 | Train Loss: 90.266 Vali Loss: 54.250 Vali Acc: 0.266 Test Loss: 54.250 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.510725259780884
Epoch: 5, Steps: 17 | Train Loss: 90.971 Vali Loss: 93.768 Vali Acc: 0.255 Test Loss: 93.768 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.5151078701019287
Epoch: 6, Steps: 17 | Train Loss: 132.734 Vali Loss: 68.601 Vali Acc: 0.251 Test Loss: 68.601 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.712111711502075
Epoch: 7, Steps: 17 | Train Loss: 89.594 Vali Loss: 120.398 Vali Acc: 0.247 Test Loss: 120.398 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.7179737091064453
Epoch: 8, Steps: 17 | Train Loss: 70.983 Vali Loss: 132.438 Vali Acc: 0.236 Test Loss: 132.438 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.77358341217041
Epoch: 9, Steps: 17 | Train Loss: 50.944 Vali Loss: 126.280 Vali Acc: 0.259 Test Loss: 126.280 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.594757080078125
Epoch: 10, Steps: 17 | Train Loss: 62.297 Vali Loss: 203.141 Vali Acc: 0.255 Test Loss: 203.141 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.743910074234009
Epoch: 11, Steps: 17 | Train Loss: 67.076 Vali Loss: 227.792 Vali Acc: 0.247 Test Loss: 227.792 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 4162876
model size : 20.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.342132568359375
Epoch: 1, Steps: 17 | Train Loss: 25.477 Vali Loss: 45.090 Vali Acc: 0.251 Test Loss: 45.090 Test Acc: 0.251
Validation loss decreased (inf --> -0.250500).  Saving model ...
Epoch: 2 cost time: 3.9976367950439453
Epoch: 2, Steps: 17 | Train Loss: 57.404 Vali Loss: 99.311 Vali Acc: 0.251 Test Loss: 99.311 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.303689956665039
Epoch: 3, Steps: 17 | Train Loss: 90.822 Vali Loss: 141.461 Vali Acc: 0.243 Test Loss: 141.461 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.307963609695435
Epoch: 4, Steps: 17 | Train Loss: 86.393 Vali Loss: 200.321 Vali Acc: 0.255 Test Loss: 200.321 Test Acc: 0.255
Validation loss decreased (-0.250500 --> -0.252750).  Saving model ...
Epoch: 5 cost time: 4.289228439331055
Epoch: 5, Steps: 17 | Train Loss: 115.770 Vali Loss: 239.697 Vali Acc: 0.251 Test Loss: 239.697 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.270234823226929
Epoch: 6, Steps: 17 | Train Loss: 155.244 Vali Loss: 163.207 Vali Acc: 0.247 Test Loss: 163.207 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.313793659210205
Epoch: 7, Steps: 17 | Train Loss: 82.084 Vali Loss: 214.253 Vali Acc: 0.232 Test Loss: 214.253 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.142503976821899
Epoch: 8, Steps: 17 | Train Loss: 89.986 Vali Loss: 122.865 Vali Acc: 0.251 Test Loss: 122.865 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.18162202835083
Epoch: 9, Steps: 17 | Train Loss: 115.778 Vali Loss: 177.135 Vali Acc: 0.247 Test Loss: 177.135 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.20987868309021
Epoch: 10, Steps: 17 | Train Loss: 95.058 Vali Loss: 164.774 Vali Acc: 0.281 Test Loss: 164.774 Test Acc: 0.281
Validation loss decreased (-0.252750 --> -0.279721).  Saving model ...
Epoch: 11 cost time: 4.291450023651123
Epoch: 11, Steps: 17 | Train Loss: 55.058 Vali Loss: 148.907 Vali Acc: 0.259 Test Loss: 148.907 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.284656763076782
Epoch: 12, Steps: 17 | Train Loss: 37.371 Vali Loss: 199.096 Vali Acc: 0.255 Test Loss: 199.096 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.264571666717529
Epoch: 13, Steps: 17 | Train Loss: 51.677 Vali Loss: 199.929 Vali Acc: 0.262 Test Loss: 199.929 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.307430744171143
Epoch: 14, Steps: 17 | Train Loss: 52.716 Vali Loss: 289.411 Vali Acc: 0.251 Test Loss: 289.411 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.125743865966797
Epoch: 15, Steps: 17 | Train Loss: 31.736 Vali Loss: 252.737 Vali Acc: 0.270 Test Loss: 252.737 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.129915475845337
Epoch: 16, Steps: 17 | Train Loss: 60.564 Vali Loss: 322.486 Vali Acc: 0.270 Test Loss: 322.486 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.083059072494507
Epoch: 17, Steps: 17 | Train Loss: 34.006 Vali Loss: 376.036 Vali Acc: 0.243 Test Loss: 376.036 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.9810919761657715
Epoch: 18, Steps: 17 | Train Loss: 85.721 Vali Loss: 417.162 Vali Acc: 0.262 Test Loss: 417.162 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.2556374073028564
Epoch: 19, Steps: 17 | Train Loss: 35.583 Vali Loss: 447.192 Vali Acc: 0.270 Test Loss: 447.192 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.315240859985352
Epoch: 20, Steps: 17 | Train Loss: 15.314 Vali Loss: 507.749 Vali Acc: 0.243 Test Loss: 507.749 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 3114300
model size : 16.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.074164390563965
Epoch: 1, Steps: 17 | Train Loss: 25.240 Vali Loss: 49.863 Vali Acc: 0.247 Test Loss: 49.863 Test Acc: 0.247
Validation loss decreased (inf --> -0.246650).  Saving model ...
Epoch: 2 cost time: 3.893106460571289
Epoch: 2, Steps: 17 | Train Loss: 54.850 Vali Loss: 60.217 Vali Acc: 0.236 Test Loss: 60.217 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8960916996002197
Epoch: 3, Steps: 17 | Train Loss: 62.200 Vali Loss: 62.160 Vali Acc: 0.240 Test Loss: 62.160 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9845778942108154
Epoch: 4, Steps: 17 | Train Loss: 64.988 Vali Loss: 112.648 Vali Acc: 0.251 Test Loss: 112.648 Test Acc: 0.251
Validation loss decreased (-0.246650 --> -0.249824).  Saving model ...
Epoch: 5 cost time: 3.853893995285034
Epoch: 5, Steps: 17 | Train Loss: 69.883 Vali Loss: 112.652 Vali Acc: 0.278 Test Loss: 112.652 Test Acc: 0.278
Validation loss decreased (-0.249824 --> -0.276440).  Saving model ...
Epoch: 6 cost time: 3.957901954650879
Epoch: 6, Steps: 17 | Train Loss: 84.415 Vali Loss: 84.487 Vali Acc: 0.285 Test Loss: 84.487 Test Acc: 0.285
Validation loss decreased (-0.276440 --> -0.284326).  Saving model ...
Epoch: 7 cost time: 3.9788382053375244
Epoch: 7, Steps: 17 | Train Loss: 114.995 Vali Loss: 254.620 Vali Acc: 0.259 Test Loss: 254.620 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9603776931762695
Epoch: 8, Steps: 17 | Train Loss: 157.705 Vali Loss: 121.370 Vali Acc: 0.240 Test Loss: 121.370 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.0561487674713135
Epoch: 9, Steps: 17 | Train Loss: 130.545 Vali Loss: 164.514 Vali Acc: 0.270 Test Loss: 164.514 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.816159963607788
Epoch: 10, Steps: 17 | Train Loss: 67.199 Vali Loss: 95.959 Vali Acc: 0.228 Test Loss: 95.959 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.035310983657837
Epoch: 11, Steps: 17 | Train Loss: 51.248 Vali Loss: 130.896 Vali Acc: 0.274 Test Loss: 130.896 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.900702714920044
Epoch: 12, Steps: 17 | Train Loss: 45.113 Vali Loss: 189.032 Vali Acc: 0.240 Test Loss: 189.032 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.050953149795532
Epoch: 13, Steps: 17 | Train Loss: 58.616 Vali Loss: 260.851 Vali Acc: 0.262 Test Loss: 260.851 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.883371353149414
Epoch: 14, Steps: 17 | Train Loss: 42.260 Vali Loss: 216.997 Vali Acc: 0.232 Test Loss: 216.997 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.8134937286376953
Epoch: 15, Steps: 17 | Train Loss: 41.340 Vali Loss: 324.015 Vali Acc: 0.240 Test Loss: 324.015 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.039217233657837
Epoch: 16, Steps: 17 | Train Loss: 43.841 Vali Loss: 383.290 Vali Acc: 0.247 Test Loss: 383.290 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3114300
model size : 16.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.910208463668823
Epoch: 1, Steps: 17 | Train Loss: 23.859 Vali Loss: 29.292 Vali Acc: 0.259 Test Loss: 29.292 Test Acc: 0.259
Validation loss decreased (inf --> -0.258262).  Saving model ...
Epoch: 2 cost time: 3.4297468662261963
Epoch: 2, Steps: 17 | Train Loss: 55.098 Vali Loss: 81.828 Vali Acc: 0.247 Test Loss: 81.828 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.474623203277588
Epoch: 3, Steps: 17 | Train Loss: 42.779 Vali Loss: 115.758 Vali Acc: 0.255 Test Loss: 115.758 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4359943866729736
Epoch: 4, Steps: 17 | Train Loss: 113.678 Vali Loss: 75.717 Vali Acc: 0.255 Test Loss: 75.717 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.677417516708374
Epoch: 5, Steps: 17 | Train Loss: 65.729 Vali Loss: 152.984 Vali Acc: 0.243 Test Loss: 152.984 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.570730686187744
Epoch: 6, Steps: 17 | Train Loss: 109.793 Vali Loss: 172.225 Vali Acc: 0.247 Test Loss: 172.225 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.602522373199463
Epoch: 7, Steps: 17 | Train Loss: 56.716 Vali Loss: 94.769 Vali Acc: 0.236 Test Loss: 94.769 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.5659892559051514
Epoch: 8, Steps: 17 | Train Loss: 67.820 Vali Loss: 148.683 Vali Acc: 0.270 Test Loss: 148.683 Test Acc: 0.270
Validation loss decreased (-0.258262 --> -0.268475).  Saving model ...
Epoch: 9 cost time: 3.4504737854003906
Epoch: 9, Steps: 17 | Train Loss: 73.409 Vali Loss: 217.603 Vali Acc: 0.262 Test Loss: 217.603 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.588750123977661
Epoch: 10, Steps: 17 | Train Loss: 121.491 Vali Loss: 202.519 Vali Acc: 0.266 Test Loss: 202.519 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.9273104667663574
Epoch: 11, Steps: 17 | Train Loss: 41.048 Vali Loss: 188.829 Vali Acc: 0.240 Test Loss: 188.829 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.898014545440674
Epoch: 12, Steps: 17 | Train Loss: 64.385 Vali Loss: 180.553 Vali Acc: 0.228 Test Loss: 180.553 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.9220945835113525
Epoch: 13, Steps: 17 | Train Loss: 28.440 Vali Loss: 277.622 Vali Acc: 0.262 Test Loss: 277.622 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.819072723388672
Epoch: 14, Steps: 17 | Train Loss: 53.358 Vali Loss: 299.247 Vali Acc: 0.232 Test Loss: 299.247 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.9037880897521973
Epoch: 15, Steps: 17 | Train Loss: 33.712 Vali Loss: 307.353 Vali Acc: 0.240 Test Loss: 307.353 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.033294439315796
Epoch: 16, Steps: 17 | Train Loss: 26.280 Vali Loss: 438.166 Vali Acc: 0.255 Test Loss: 438.166 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.9180092811584473
Epoch: 17, Steps: 17 | Train Loss: 60.431 Vali Loss: 443.376 Vali Acc: 0.255 Test Loss: 443.376 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.022247076034546
Epoch: 18, Steps: 17 | Train Loss: 47.532 Vali Loss: 509.451 Vali Acc: 0.209 Test Loss: 509.451 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 3114300
model size : 16.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.4648120403289795
Epoch: 1, Steps: 17 | Train Loss: 29.244 Vali Loss: 32.878 Vali Acc: 0.240 Test Loss: 32.878 Test Acc: 0.240
Validation loss decreased (inf --> -0.239215).  Saving model ...
Epoch: 2 cost time: 3.458803415298462
Epoch: 2, Steps: 17 | Train Loss: 67.742 Vali Loss: 52.196 Vali Acc: 0.270 Test Loss: 52.196 Test Acc: 0.270
Validation loss decreased (-0.239215 --> -0.269440).  Saving model ...
Epoch: 3 cost time: 3.248807430267334
Epoch: 3, Steps: 17 | Train Loss: 39.228 Vali Loss: 76.800 Vali Acc: 0.255 Test Loss: 76.800 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.62811279296875
Epoch: 4, Steps: 17 | Train Loss: 52.218 Vali Loss: 49.268 Vali Acc: 0.255 Test Loss: 49.268 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3703086376190186
Epoch: 5, Steps: 17 | Train Loss: 40.839 Vali Loss: 101.000 Vali Acc: 0.262 Test Loss: 101.000 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.4362056255340576
Epoch: 6, Steps: 17 | Train Loss: 90.947 Vali Loss: 67.191 Vali Acc: 0.270 Test Loss: 67.191 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.3616151809692383
Epoch: 7, Steps: 17 | Train Loss: 64.145 Vali Loss: 77.122 Vali Acc: 0.255 Test Loss: 77.122 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.3251101970672607
Epoch: 8, Steps: 17 | Train Loss: 57.574 Vali Loss: 124.642 Vali Acc: 0.262 Test Loss: 124.642 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.453237771987915
Epoch: 9, Steps: 17 | Train Loss: 86.691 Vali Loss: 101.145 Vali Acc: 0.281 Test Loss: 101.145 Test Acc: 0.281
Validation loss decreased (-0.269440 --> -0.280357).  Saving model ...
Epoch: 10 cost time: 3.5179474353790283
Epoch: 10, Steps: 17 | Train Loss: 70.761 Vali Loss: 128.180 Vali Acc: 0.243 Test Loss: 128.180 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.421276330947876
Epoch: 11, Steps: 17 | Train Loss: 46.872 Vali Loss: 237.421 Vali Acc: 0.255 Test Loss: 237.421 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5871806144714355
Epoch: 12, Steps: 17 | Train Loss: 72.308 Vali Loss: 338.831 Vali Acc: 0.262 Test Loss: 338.831 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.3979804515838623
Epoch: 13, Steps: 17 | Train Loss: 76.980 Vali Loss: 244.761 Vali Acc: 0.255 Test Loss: 244.761 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.5008928775787354
Epoch: 14, Steps: 17 | Train Loss: 38.588 Vali Loss: 289.024 Vali Acc: 0.262 Test Loss: 289.024 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.512744426727295
Epoch: 15, Steps: 17 | Train Loss: 52.903 Vali Loss: 387.493 Vali Acc: 0.293 Test Loss: 387.493 Test Acc: 0.293
Validation loss decreased (-0.280357 --> -0.288901).  Saving model ...
Epoch: 16 cost time: 3.628997325897217
Epoch: 16, Steps: 17 | Train Loss: 34.287 Vali Loss: 431.521 Vali Acc: 0.236 Test Loss: 431.521 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.589718818664551
Epoch: 17, Steps: 17 | Train Loss: 44.017 Vali Loss: 413.231 Vali Acc: 0.243 Test Loss: 413.231 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.5337584018707275
Epoch: 18, Steps: 17 | Train Loss: 22.354 Vali Loss: 458.574 Vali Acc: 0.224 Test Loss: 458.574 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.423433303833008
Epoch: 19, Steps: 17 | Train Loss: 27.744 Vali Loss: 489.636 Vali Acc: 0.240 Test Loss: 489.636 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.5502824783325195
Epoch: 20, Steps: 17 | Train Loss: 29.207 Vali Loss: 611.593 Vali Acc: 0.243 Test Loss: 611.593 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.6500256061553955
Epoch: 21, Steps: 17 | Train Loss: 43.192 Vali Loss: 532.101 Vali Acc: 0.236 Test Loss: 532.101 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.617382526397705
Epoch: 22, Steps: 17 | Train Loss: 11.634 Vali Loss: 565.279 Vali Acc: 0.209 Test Loss: 565.279 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.5242433547973633
Epoch: 23, Steps: 17 | Train Loss: 12.248 Vali Loss: 570.665 Vali Acc: 0.221 Test Loss: 570.665 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.5340397357940674
Epoch: 24, Steps: 17 | Train Loss: 8.309 Vali Loss: 616.227 Vali Acc: 0.228 Test Loss: 616.227 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.545095920562744
Epoch: 25, Steps: 17 | Train Loss: 13.616 Vali Loss: 671.620 Vali Acc: 0.213 Test Loss: 671.620 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 3114300
model size : 16.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.328904628753662
Epoch: 1, Steps: 17 | Train Loss: 27.715 Vali Loss: 109.786 Vali Acc: 0.247 Test Loss: 109.786 Test Acc: 0.247
Validation loss decreased (inf --> -0.246050).  Saving model ...
Epoch: 2 cost time: 4.17695164680481
Epoch: 2, Steps: 17 | Train Loss: 84.119 Vali Loss: 67.465 Vali Acc: 0.240 Test Loss: 67.465 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.518633604049683
Epoch: 3, Steps: 17 | Train Loss: 60.839 Vali Loss: 89.945 Vali Acc: 0.247 Test Loss: 89.945 Test Acc: 0.247
Validation loss decreased (-0.246050 --> -0.246249).  Saving model ...
Epoch: 4 cost time: 4.0864598751068115
Epoch: 4, Steps: 17 | Train Loss: 88.606 Vali Loss: 143.006 Vali Acc: 0.285 Test Loss: 143.006 Test Acc: 0.285
Validation loss decreased (-0.246249 --> -0.283741).  Saving model ...
Epoch: 5 cost time: 4.306053876876831
Epoch: 5, Steps: 17 | Train Loss: 94.711 Vali Loss: 187.223 Vali Acc: 0.270 Test Loss: 187.223 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.130457639694214
Epoch: 6, Steps: 17 | Train Loss: 181.720 Vali Loss: 182.876 Vali Acc: 0.255 Test Loss: 182.876 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.096777677536011
Epoch: 7, Steps: 17 | Train Loss: 106.975 Vali Loss: 175.647 Vali Acc: 0.228 Test Loss: 175.647 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.223331451416016
Epoch: 8, Steps: 17 | Train Loss: 117.154 Vali Loss: 213.058 Vali Acc: 0.255 Test Loss: 213.058 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.26562237739563
Epoch: 9, Steps: 17 | Train Loss: 88.576 Vali Loss: 77.136 Vali Acc: 0.243 Test Loss: 77.136 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.221592903137207
Epoch: 10, Steps: 17 | Train Loss: 82.612 Vali Loss: 138.256 Vali Acc: 0.262 Test Loss: 138.256 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.330512762069702
Epoch: 11, Steps: 17 | Train Loss: 102.880 Vali Loss: 157.607 Vali Acc: 0.259 Test Loss: 157.607 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.26153302192688
Epoch: 12, Steps: 17 | Train Loss: 56.865 Vali Loss: 155.050 Vali Acc: 0.274 Test Loss: 155.050 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.1439595222473145
Epoch: 13, Steps: 17 | Train Loss: 36.604 Vali Loss: 248.559 Vali Acc: 0.266 Test Loss: 248.559 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.236187219619751
Epoch: 14, Steps: 17 | Train Loss: 47.867 Vali Loss: 208.320 Vali Acc: 0.255 Test Loss: 208.320 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 2590012
model size : 14.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.799621343612671
Epoch: 1, Steps: 17 | Train Loss: 20.292 Vali Loss: 87.327 Vali Acc: 0.251 Test Loss: 87.327 Test Acc: 0.251
Validation loss decreased (inf --> -0.250077).  Saving model ...
Epoch: 2 cost time: 3.74615478515625
Epoch: 2, Steps: 17 | Train Loss: 82.289 Vali Loss: 115.866 Vali Acc: 0.251 Test Loss: 115.866 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7840747833251953
Epoch: 3, Steps: 17 | Train Loss: 68.068 Vali Loss: 94.643 Vali Acc: 0.243 Test Loss: 94.643 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8267815113067627
Epoch: 4, Steps: 17 | Train Loss: 97.184 Vali Loss: 272.966 Vali Acc: 0.247 Test Loss: 272.966 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.7343578338623047
Epoch: 5, Steps: 17 | Train Loss: 67.473 Vali Loss: 67.266 Vali Acc: 0.247 Test Loss: 67.266 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.786344528198242
Epoch: 6, Steps: 17 | Train Loss: 103.501 Vali Loss: 124.193 Vali Acc: 0.278 Test Loss: 124.193 Test Acc: 0.278
Validation loss decreased (-0.250077 --> -0.276325).  Saving model ...
Epoch: 7 cost time: 3.7280828952789307
Epoch: 7, Steps: 17 | Train Loss: 127.962 Vali Loss: 116.115 Vali Acc: 0.251 Test Loss: 116.115 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.670598268508911
Epoch: 8, Steps: 17 | Train Loss: 109.674 Vali Loss: 145.040 Vali Acc: 0.259 Test Loss: 145.040 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.711348533630371
Epoch: 9, Steps: 17 | Train Loss: 144.699 Vali Loss: 172.386 Vali Acc: 0.262 Test Loss: 172.386 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.774500608444214
Epoch: 10, Steps: 17 | Train Loss: 65.721 Vali Loss: 125.636 Vali Acc: 0.240 Test Loss: 125.636 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.843419313430786
Epoch: 11, Steps: 17 | Train Loss: 48.374 Vali Loss: 123.297 Vali Acc: 0.243 Test Loss: 123.297 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.7376341819763184
Epoch: 12, Steps: 17 | Train Loss: 40.912 Vali Loss: 161.293 Vali Acc: 0.243 Test Loss: 161.293 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.7396843433380127
Epoch: 13, Steps: 17 | Train Loss: 30.905 Vali Loss: 210.289 Vali Acc: 0.293 Test Loss: 210.289 Test Acc: 0.293
Validation loss decreased (-0.276325 --> -0.290673).  Saving model ...
Epoch: 14 cost time: 3.757410764694214
Epoch: 14, Steps: 17 | Train Loss: 32.162 Vali Loss: 230.497 Vali Acc: 0.270 Test Loss: 230.497 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8774311542510986
Epoch: 15, Steps: 17 | Train Loss: 32.957 Vali Loss: 345.696 Vali Acc: 0.243 Test Loss: 345.696 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.8076677322387695
Epoch: 16, Steps: 17 | Train Loss: 52.060 Vali Loss: 363.005 Vali Acc: 0.236 Test Loss: 363.005 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.6587154865264893
Epoch: 17, Steps: 17 | Train Loss: 28.712 Vali Loss: 430.762 Vali Acc: 0.232 Test Loss: 430.762 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.886277198791504
Epoch: 18, Steps: 17 | Train Loss: 36.590 Vali Loss: 499.331 Vali Acc: 0.255 Test Loss: 499.331 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.700697422027588
Epoch: 19, Steps: 17 | Train Loss: 39.698 Vali Loss: 472.356 Vali Acc: 0.202 Test Loss: 472.356 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.894373655319214
Epoch: 20, Steps: 17 | Train Loss: 92.342 Vali Loss: 608.616 Vali Acc: 0.224 Test Loss: 608.616 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.865969657897949
Epoch: 21, Steps: 17 | Train Loss: 37.072 Vali Loss: 659.018 Vali Acc: 0.255 Test Loss: 659.018 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.7072222232818604
Epoch: 22, Steps: 17 | Train Loss: 27.162 Vali Loss: 717.601 Vali Acc: 0.228 Test Loss: 717.601 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.78017520904541
Epoch: 23, Steps: 17 | Train Loss: 39.254 Vali Loss: 713.793 Vali Acc: 0.236 Test Loss: 713.793 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 2590012
model size : 14.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.243679046630859
Epoch: 1, Steps: 17 | Train Loss: 27.715 Vali Loss: 59.515 Vali Acc: 0.251 Test Loss: 59.515 Test Acc: 0.251
Validation loss decreased (inf --> -0.250355).  Saving model ...
Epoch: 2 cost time: 3.263479709625244
Epoch: 2, Steps: 17 | Train Loss: 70.656 Vali Loss: 60.679 Vali Acc: 0.266 Test Loss: 60.679 Test Acc: 0.266
Validation loss decreased (-0.250355 --> -0.265553).  Saving model ...
Epoch: 3 cost time: 3.405102014541626
Epoch: 3, Steps: 17 | Train Loss: 66.982 Vali Loss: 141.213 Vali Acc: 0.259 Test Loss: 141.213 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.282048225402832
Epoch: 4, Steps: 17 | Train Loss: 101.662 Vali Loss: 174.710 Vali Acc: 0.247 Test Loss: 174.710 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1840271949768066
Epoch: 5, Steps: 17 | Train Loss: 85.207 Vali Loss: 140.721 Vali Acc: 0.255 Test Loss: 140.721 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3263583183288574
Epoch: 6, Steps: 17 | Train Loss: 99.798 Vali Loss: 89.193 Vali Acc: 0.247 Test Loss: 89.193 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.533040761947632
Epoch: 7, Steps: 17 | Train Loss: 86.477 Vali Loss: 151.806 Vali Acc: 0.255 Test Loss: 151.806 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.622877836227417
Epoch: 8, Steps: 17 | Train Loss: 75.223 Vali Loss: 145.186 Vali Acc: 0.224 Test Loss: 145.186 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.669377565383911
Epoch: 9, Steps: 17 | Train Loss: 60.584 Vali Loss: 86.472 Vali Acc: 0.259 Test Loss: 86.472 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.677119255065918
Epoch: 10, Steps: 17 | Train Loss: 74.869 Vali Loss: 173.191 Vali Acc: 0.240 Test Loss: 173.191 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.730168581008911
Epoch: 11, Steps: 17 | Train Loss: 82.309 Vali Loss: 261.415 Vali Acc: 0.251 Test Loss: 261.415 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.7757411003112793
Epoch: 12, Steps: 17 | Train Loss: 63.403 Vali Loss: 182.056 Vali Acc: 0.255 Test Loss: 182.056 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 2590012
model size : 14.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.939840078353882
Epoch: 1, Steps: 17 | Train Loss: 22.102 Vali Loss: 56.294 Vali Acc: 0.266 Test Loss: 56.294 Test Acc: 0.266
Validation loss decreased (inf --> -0.265597).  Saving model ...
Epoch: 2 cost time: 3.0368409156799316
Epoch: 2, Steps: 17 | Train Loss: 63.661 Vali Loss: 86.103 Vali Acc: 0.251 Test Loss: 86.103 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0959253311157227
Epoch: 3, Steps: 17 | Train Loss: 60.326 Vali Loss: 119.147 Vali Acc: 0.255 Test Loss: 119.147 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1466214656829834
Epoch: 4, Steps: 17 | Train Loss: 112.402 Vali Loss: 117.216 Vali Acc: 0.240 Test Loss: 117.216 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.146127462387085
Epoch: 5, Steps: 17 | Train Loss: 145.938 Vali Loss: 197.361 Vali Acc: 0.270 Test Loss: 197.361 Test Acc: 0.270
Validation loss decreased (-0.265597 --> -0.267988).  Saving model ...
Epoch: 6 cost time: 2.985501527786255
Epoch: 6, Steps: 17 | Train Loss: 98.873 Vali Loss: 109.345 Vali Acc: 0.270 Test Loss: 109.345 Test Acc: 0.270
Validation loss decreased (-0.267988 --> -0.268869).  Saving model ...
Epoch: 7 cost time: 3.179837465286255
Epoch: 7, Steps: 17 | Train Loss: 88.997 Vali Loss: 137.988 Vali Acc: 0.255 Test Loss: 137.988 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1303088665008545
Epoch: 8, Steps: 17 | Train Loss: 81.741 Vali Loss: 96.035 Vali Acc: 0.266 Test Loss: 96.035 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1829755306243896
Epoch: 9, Steps: 17 | Train Loss: 58.924 Vali Loss: 109.985 Vali Acc: 0.270 Test Loss: 109.985 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0508363246917725
Epoch: 10, Steps: 17 | Train Loss: 34.741 Vali Loss: 123.988 Vali Acc: 0.255 Test Loss: 123.988 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.064291477203369
Epoch: 11, Steps: 17 | Train Loss: 42.477 Vali Loss: 101.344 Vali Acc: 0.289 Test Loss: 101.344 Test Acc: 0.289
Validation loss decreased (-0.268869 --> -0.287960).  Saving model ...
Epoch: 12 cost time: 3.0816917419433594
Epoch: 12, Steps: 17 | Train Loss: 46.495 Vali Loss: 162.309 Vali Acc: 0.274 Test Loss: 162.309 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2011663913726807
Epoch: 13, Steps: 17 | Train Loss: 41.529 Vali Loss: 223.523 Vali Acc: 0.255 Test Loss: 223.523 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.429786443710327
Epoch: 14, Steps: 17 | Train Loss: 38.093 Vali Loss: 410.901 Vali Acc: 0.255 Test Loss: 410.901 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2817108631134033
Epoch: 15, Steps: 17 | Train Loss: 63.784 Vali Loss: 384.701 Vali Acc: 0.251 Test Loss: 384.701 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.1822867393493652
Epoch: 16, Steps: 17 | Train Loss: 66.177 Vali Loss: 368.487 Vali Acc: 0.304 Test Loss: 368.487 Test Acc: 0.304
Validation loss decreased (-0.287960 --> -0.300498).  Saving model ...
Epoch: 17 cost time: 3.172020673751831
Epoch: 17, Steps: 17 | Train Loss: 40.724 Vali Loss: 521.216 Vali Acc: 0.262 Test Loss: 521.216 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.173402786254883
Epoch: 18, Steps: 17 | Train Loss: 33.838 Vali Loss: 450.392 Vali Acc: 0.232 Test Loss: 450.392 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0698580741882324
Epoch: 19, Steps: 17 | Train Loss: 50.297 Vali Loss: 588.284 Vali Acc: 0.255 Test Loss: 588.284 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.7918710708618164
Epoch: 20, Steps: 17 | Train Loss: 39.896 Vali Loss: 548.941 Vali Acc: 0.243 Test Loss: 548.941 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.035407781600952
Epoch: 21, Steps: 17 | Train Loss: 25.492 Vali Loss: 677.689 Vali Acc: 0.274 Test Loss: 677.689 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.9491984844207764
Epoch: 22, Steps: 17 | Train Loss: 36.649 Vali Loss: 739.381 Vali Acc: 0.247 Test Loss: 739.381 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.301440477371216
Epoch: 23, Steps: 17 | Train Loss: 21.575 Vali Loss: 738.104 Vali Acc: 0.262 Test Loss: 738.104 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.224833250045776
Epoch: 24, Steps: 17 | Train Loss: 7.701 Vali Loss: 774.075 Vali Acc: 0.255 Test Loss: 774.075 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.2984373569488525
Epoch: 25, Steps: 17 | Train Loss: 14.637 Vali Loss: 833.071 Vali Acc: 0.213 Test Loss: 833.071 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.433918714523315
Epoch: 26, Steps: 17 | Train Loss: 17.390 Vali Loss: 902.656 Vali Acc: 0.213 Test Loss: 902.656 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 2590012
model size : 14.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.056816577911377
Epoch: 1, Steps: 17 | Train Loss: 21.218 Vali Loss: 47.649 Vali Acc: 0.243 Test Loss: 47.649 Test Acc: 0.243
Validation loss decreased (inf --> -0.242870).  Saving model ...
Epoch: 2 cost time: 4.877969741821289
Epoch: 2, Steps: 17 | Train Loss: 46.748 Vali Loss: 62.999 Vali Acc: 0.262 Test Loss: 62.999 Test Acc: 0.262
Validation loss decreased (-0.242870 --> -0.261727).  Saving model ...
Epoch: 3 cost time: 5.124629735946655
Epoch: 3, Steps: 17 | Train Loss: 47.257 Vali Loss: 146.810 Vali Acc: 0.251 Test Loss: 146.810 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8459136486053467
Epoch: 4, Steps: 17 | Train Loss: 85.642 Vali Loss: 165.551 Vali Acc: 0.259 Test Loss: 165.551 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.242825269699097
Epoch: 5, Steps: 17 | Train Loss: 87.262 Vali Loss: 119.165 Vali Acc: 0.240 Test Loss: 119.165 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.692219972610474
Epoch: 6, Steps: 17 | Train Loss: 84.528 Vali Loss: 130.110 Vali Acc: 0.228 Test Loss: 130.110 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.199670791625977
Epoch: 7, Steps: 17 | Train Loss: 76.029 Vali Loss: 132.010 Vali Acc: 0.247 Test Loss: 132.010 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.199798345565796
Epoch: 8, Steps: 17 | Train Loss: 78.535 Vali Loss: 113.427 Vali Acc: 0.262 Test Loss: 113.427 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.813263177871704
Epoch: 9, Steps: 17 | Train Loss: 43.921 Vali Loss: 131.533 Vali Acc: 0.232 Test Loss: 131.533 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.417014122009277
Epoch: 10, Steps: 17 | Train Loss: 83.794 Vali Loss: 120.968 Vali Acc: 0.251 Test Loss: 120.968 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.47680926322937
Epoch: 11, Steps: 17 | Train Loss: 85.960 Vali Loss: 224.540 Vali Acc: 0.259 Test Loss: 224.540 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.435702085494995
Epoch: 12, Steps: 17 | Train Loss: 60.100 Vali Loss: 169.191 Vali Acc: 0.255 Test Loss: 169.191 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 2327868
model size : 13.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.595782279968262
Epoch: 1, Steps: 17 | Train Loss: 24.800 Vali Loss: 54.064 Vali Acc: 0.247 Test Loss: 54.064 Test Acc: 0.247
Validation loss decreased (inf --> -0.246608).  Saving model ...
Epoch: 2 cost time: 5.33365797996521
Epoch: 2, Steps: 17 | Train Loss: 67.278 Vali Loss: 129.702 Vali Acc: 0.247 Test Loss: 129.702 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.22601056098938
Epoch: 3, Steps: 17 | Train Loss: 59.433 Vali Loss: 129.315 Vali Acc: 0.247 Test Loss: 129.315 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.204840183258057
Epoch: 4, Steps: 17 | Train Loss: 92.010 Vali Loss: 57.195 Vali Acc: 0.262 Test Loss: 57.195 Test Acc: 0.262
Validation loss decreased (-0.246608 --> -0.261785).  Saving model ...
Epoch: 5 cost time: 5.1933581829071045
Epoch: 5, Steps: 17 | Train Loss: 58.410 Vali Loss: 40.214 Vali Acc: 0.255 Test Loss: 40.214 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.99731969833374
Epoch: 6, Steps: 17 | Train Loss: 93.766 Vali Loss: 124.070 Vali Acc: 0.251 Test Loss: 124.070 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.113874912261963
Epoch: 7, Steps: 17 | Train Loss: 99.240 Vali Loss: 123.601 Vali Acc: 0.240 Test Loss: 123.601 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.508772373199463
Epoch: 8, Steps: 17 | Train Loss: 54.191 Vali Loss: 164.134 Vali Acc: 0.266 Test Loss: 164.134 Test Acc: 0.266
Validation loss decreased (-0.261785 --> -0.264518).  Saving model ...
Epoch: 9 cost time: 3.4501898288726807
Epoch: 9, Steps: 17 | Train Loss: 78.171 Vali Loss: 178.436 Vali Acc: 0.278 Test Loss: 178.436 Test Acc: 0.278
Validation loss decreased (-0.264518 --> -0.275782).  Saving model ...
Epoch: 10 cost time: 3.974060535430908
Epoch: 10, Steps: 17 | Train Loss: 85.845 Vali Loss: 124.555 Vali Acc: 0.278 Test Loss: 124.555 Test Acc: 0.278
Validation loss decreased (-0.275782 --> -0.276321).  Saving model ...
Epoch: 11 cost time: 4.090312719345093
Epoch: 11, Steps: 17 | Train Loss: 114.613 Vali Loss: 209.117 Vali Acc: 0.259 Test Loss: 209.117 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.960374593734741
Epoch: 12, Steps: 17 | Train Loss: 70.102 Vali Loss: 205.591 Vali Acc: 0.259 Test Loss: 205.591 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.828639268875122
Epoch: 13, Steps: 17 | Train Loss: 47.261 Vali Loss: 371.437 Vali Acc: 0.266 Test Loss: 371.437 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.814541816711426
Epoch: 14, Steps: 17 | Train Loss: 62.153 Vali Loss: 229.490 Vali Acc: 0.270 Test Loss: 229.490 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.856009006500244
Epoch: 15, Steps: 17 | Train Loss: 26.715 Vali Loss: 237.282 Vali Acc: 0.251 Test Loss: 237.282 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.9560177326202393
Epoch: 16, Steps: 17 | Train Loss: 41.281 Vali Loss: 308.324 Vali Acc: 0.270 Test Loss: 308.324 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.012104272842407
Epoch: 17, Steps: 17 | Train Loss: 43.635 Vali Loss: 405.874 Vali Acc: 0.255 Test Loss: 405.874 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.9722821712493896
Epoch: 18, Steps: 17 | Train Loss: 47.653 Vali Loss: 370.199 Vali Acc: 0.243 Test Loss: 370.199 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.8766043186187744
Epoch: 19, Steps: 17 | Train Loss: 24.655 Vali Loss: 356.198 Vali Acc: 0.293 Test Loss: 356.198 Test Acc: 0.293
Validation loss decreased (-0.276321 --> -0.289214).  Saving model ...
Epoch: 20 cost time: 3.793452024459839
Epoch: 20, Steps: 17 | Train Loss: 27.180 Vali Loss: 448.449 Vali Acc: 0.266 Test Loss: 448.449 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.9860615730285645
Epoch: 21, Steps: 17 | Train Loss: 28.283 Vali Loss: 483.404 Vali Acc: 0.247 Test Loss: 483.404 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.9309442043304443
Epoch: 22, Steps: 17 | Train Loss: 21.394 Vali Loss: 566.446 Vali Acc: 0.262 Test Loss: 566.446 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.0248188972473145
Epoch: 23, Steps: 17 | Train Loss: 50.783 Vali Loss: 626.547 Vali Acc: 0.259 Test Loss: 626.547 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.777454137802124
Epoch: 24, Steps: 17 | Train Loss: 23.090 Vali Loss: 637.762 Vali Acc: 0.247 Test Loss: 637.762 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.7766335010528564
Epoch: 25, Steps: 17 | Train Loss: 18.583 Vali Loss: 689.580 Vali Acc: 0.278 Test Loss: 689.580 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.9823365211486816
Epoch: 26, Steps: 17 | Train Loss: 31.059 Vali Loss: 748.896 Vali Acc: 0.243 Test Loss: 748.896 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.894177198410034
Epoch: 27, Steps: 17 | Train Loss: 24.741 Vali Loss: 764.713 Vali Acc: 0.217 Test Loss: 764.713 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.9350805282592773
Epoch: 28, Steps: 17 | Train Loss: 26.249 Vali Loss: 811.509 Vali Acc: 0.243 Test Loss: 811.509 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.8913049697875977
Epoch: 29, Steps: 17 | Train Loss: 30.054 Vali Loss: 849.783 Vali Acc: 0.236 Test Loss: 849.783 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 2327868
model size : 13.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.61073899269104
Epoch: 1, Steps: 17 | Train Loss: 25.976 Vali Loss: 33.239 Vali Acc: 0.259 Test Loss: 33.239 Test Acc: 0.259
Validation loss decreased (inf --> -0.258223).  Saving model ...
Epoch: 2 cost time: 3.6196024417877197
Epoch: 2, Steps: 17 | Train Loss: 45.990 Vali Loss: 67.729 Vali Acc: 0.247 Test Loss: 67.729 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.422144651412964
Epoch: 3, Steps: 17 | Train Loss: 66.682 Vali Loss: 44.773 Vali Acc: 0.259 Test Loss: 44.773 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.536298990249634
Epoch: 4, Steps: 17 | Train Loss: 61.586 Vali Loss: 56.760 Vali Acc: 0.251 Test Loss: 56.760 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.529883623123169
Epoch: 5, Steps: 17 | Train Loss: 84.102 Vali Loss: 59.836 Vali Acc: 0.243 Test Loss: 59.836 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.7066810131073
Epoch: 6, Steps: 17 | Train Loss: 60.346 Vali Loss: 96.390 Vali Acc: 0.251 Test Loss: 96.390 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.6712687015533447
Epoch: 7, Steps: 17 | Train Loss: 76.088 Vali Loss: 97.398 Vali Acc: 0.285 Test Loss: 97.398 Test Acc: 0.285
Validation loss decreased (-0.258223 --> -0.284197).  Saving model ...
Epoch: 8 cost time: 3.6659040451049805
Epoch: 8, Steps: 17 | Train Loss: 54.478 Vali Loss: 94.789 Vali Acc: 0.255 Test Loss: 94.789 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5330798625946045
Epoch: 9, Steps: 17 | Train Loss: 61.392 Vali Loss: 289.546 Vali Acc: 0.236 Test Loss: 289.546 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.784863233566284
Epoch: 10, Steps: 17 | Train Loss: 107.422 Vali Loss: 101.509 Vali Acc: 0.243 Test Loss: 101.509 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7159461975097656
Epoch: 11, Steps: 17 | Train Loss: 50.630 Vali Loss: 262.057 Vali Acc: 0.243 Test Loss: 262.057 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.619799852371216
Epoch: 12, Steps: 17 | Train Loss: 66.649 Vali Loss: 137.187 Vali Acc: 0.262 Test Loss: 137.187 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.6912662982940674
Epoch: 13, Steps: 17 | Train Loss: 33.329 Vali Loss: 155.717 Vali Acc: 0.266 Test Loss: 155.717 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.629091262817383
Epoch: 14, Steps: 17 | Train Loss: 37.170 Vali Loss: 314.043 Vali Acc: 0.281 Test Loss: 314.043 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.588482141494751
Epoch: 15, Steps: 17 | Train Loss: 66.809 Vali Loss: 246.708 Vali Acc: 0.281 Test Loss: 246.708 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.469724178314209
Epoch: 16, Steps: 17 | Train Loss: 52.618 Vali Loss: 320.968 Vali Acc: 0.224 Test Loss: 320.968 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.6992290019989014
Epoch: 17, Steps: 17 | Train Loss: 25.879 Vali Loss: 395.229 Vali Acc: 0.232 Test Loss: 395.229 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 2327868
model size : 13.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.342623710632324
Epoch: 1, Steps: 17 | Train Loss: 19.808 Vali Loss: 48.145 Vali Acc: 0.247 Test Loss: 48.145 Test Acc: 0.247
Validation loss decreased (inf --> -0.246667).  Saving model ...
Epoch: 2 cost time: 3.2775065898895264
Epoch: 2, Steps: 17 | Train Loss: 51.026 Vali Loss: 81.503 Vali Acc: 0.251 Test Loss: 81.503 Test Acc: 0.251
Validation loss decreased (-0.246667 --> -0.250136).  Saving model ...
Epoch: 3 cost time: 3.3302125930786133
Epoch: 3, Steps: 17 | Train Loss: 51.656 Vali Loss: 52.352 Vali Acc: 0.262 Test Loss: 52.352 Test Acc: 0.262
Validation loss decreased (-0.250136 --> -0.261834).  Saving model ...
Epoch: 4 cost time: 3.208920478820801
Epoch: 4, Steps: 17 | Train Loss: 62.096 Vali Loss: 108.750 Vali Acc: 0.259 Test Loss: 108.750 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2926571369171143
Epoch: 5, Steps: 17 | Train Loss: 56.461 Vali Loss: 195.213 Vali Acc: 0.247 Test Loss: 195.213 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.3437116146087646
Epoch: 6, Steps: 17 | Train Loss: 160.887 Vali Loss: 193.515 Vali Acc: 0.251 Test Loss: 193.515 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.311487913131714
Epoch: 7, Steps: 17 | Train Loss: 146.575 Vali Loss: 114.033 Vali Acc: 0.266 Test Loss: 114.033 Test Acc: 0.266
Validation loss decreased (-0.261834 --> -0.265019).  Saving model ...
Epoch: 8 cost time: 3.1504714488983154
Epoch: 8, Steps: 17 | Train Loss: 75.173 Vali Loss: 156.828 Vali Acc: 0.251 Test Loss: 156.828 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.37413215637207
Epoch: 9, Steps: 17 | Train Loss: 57.552 Vali Loss: 174.370 Vali Acc: 0.278 Test Loss: 174.370 Test Acc: 0.278
Validation loss decreased (-0.265019 --> -0.275823).  Saving model ...
Epoch: 10 cost time: 4.434530735015869
Epoch: 10, Steps: 17 | Train Loss: 39.214 Vali Loss: 108.284 Vali Acc: 0.224 Test Loss: 108.284 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.604428768157959
Epoch: 11, Steps: 17 | Train Loss: 45.057 Vali Loss: 150.142 Vali Acc: 0.274 Test Loss: 150.142 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.027097225189209
Epoch: 12, Steps: 17 | Train Loss: 38.375 Vali Loss: 199.575 Vali Acc: 0.255 Test Loss: 199.575 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.588865041732788
Epoch: 13, Steps: 17 | Train Loss: 39.901 Vali Loss: 227.010 Vali Acc: 0.285 Test Loss: 227.010 Test Acc: 0.285
Validation loss decreased (-0.275823 --> -0.282901).  Saving model ...
Epoch: 14 cost time: 4.40414834022522
Epoch: 14, Steps: 17 | Train Loss: 49.603 Vali Loss: 249.902 Vali Acc: 0.262 Test Loss: 249.902 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.705279350280762
Epoch: 15, Steps: 17 | Train Loss: 28.674 Vali Loss: 306.200 Vali Acc: 0.224 Test Loss: 306.200 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.42725133895874
Epoch: 16, Steps: 17 | Train Loss: 56.233 Vali Loss: 436.746 Vali Acc: 0.274 Test Loss: 436.746 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.019106388092041
Epoch: 17, Steps: 17 | Train Loss: 49.746 Vali Loss: 540.608 Vali Acc: 0.255 Test Loss: 540.608 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.581242084503174
Epoch: 18, Steps: 17 | Train Loss: 24.675 Vali Loss: 501.263 Vali Acc: 0.243 Test Loss: 501.263 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.484371900558472
Epoch: 19, Steps: 17 | Train Loss: 32.775 Vali Loss: 533.773 Vali Acc: 0.236 Test Loss: 533.773 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.904495000839233
Epoch: 20, Steps: 17 | Train Loss: 14.494 Vali Loss: 564.520 Vali Acc: 0.251 Test Loss: 564.520 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.399278163909912
Epoch: 21, Steps: 17 | Train Loss: 17.330 Vali Loss: 641.663 Vali Acc: 0.255 Test Loss: 641.663 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.354724168777466
Epoch: 22, Steps: 17 | Train Loss: 31.232 Vali Loss: 639.647 Vali Acc: 0.255 Test Loss: 639.647 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.712260007858276
Epoch: 23, Steps: 17 | Train Loss: 28.627 Vali Loss: 739.902 Vali Acc: 0.247 Test Loss: 739.902 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 2327868
model size : 13.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.209518671035767
Epoch: 1, Steps: 17 | Train Loss: 27.433 Vali Loss: 50.843 Vali Acc: 0.236 Test Loss: 50.843 Test Acc: 0.236
Validation loss decreased (inf --> -0.235233).  Saving model ...
Epoch: 2 cost time: 5.519863128662109
Epoch: 2, Steps: 17 | Train Loss: 59.283 Vali Loss: 110.989 Vali Acc: 0.270 Test Loss: 110.989 Test Acc: 0.270
Validation loss decreased (-0.235233 --> -0.268852).  Saving model ...
Epoch: 3 cost time: 5.8473992347717285
Epoch: 3, Steps: 17 | Train Loss: 65.379 Vali Loss: 118.927 Vali Acc: 0.247 Test Loss: 118.927 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.579124450683594
Epoch: 4, Steps: 17 | Train Loss: 77.179 Vali Loss: 84.691 Vali Acc: 0.247 Test Loss: 84.691 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.103550910949707
Epoch: 5, Steps: 17 | Train Loss: 117.288 Vali Loss: 207.248 Vali Acc: 0.243 Test Loss: 207.248 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.850981712341309
Epoch: 6, Steps: 17 | Train Loss: 107.359 Vali Loss: 160.494 Vali Acc: 0.224 Test Loss: 160.494 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.386887073516846
Epoch: 7, Steps: 17 | Train Loss: 103.151 Vali Loss: 154.027 Vali Acc: 0.247 Test Loss: 154.027 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.464742422103882
Epoch: 8, Steps: 17 | Train Loss: 81.207 Vali Loss: 87.709 Vali Acc: 0.255 Test Loss: 87.709 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.229553699493408
Epoch: 9, Steps: 17 | Train Loss: 75.472 Vali Loss: 98.416 Vali Acc: 0.240 Test Loss: 98.416 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.497379779815674
Epoch: 10, Steps: 17 | Train Loss: 30.463 Vali Loss: 145.529 Vali Acc: 0.251 Test Loss: 145.529 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.440554618835449
Epoch: 11, Steps: 17 | Train Loss: 70.971 Vali Loss: 202.290 Vali Acc: 0.259 Test Loss: 202.290 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.042766571044922
Epoch: 12, Steps: 17 | Train Loss: 66.490 Vali Loss: 191.233 Vali Acc: 0.270 Test Loss: 191.233 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 2196796
model size : 13.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.988559246063232
Epoch: 1, Steps: 17 | Train Loss: 22.396 Vali Loss: 68.118 Vali Acc: 0.247 Test Loss: 68.118 Test Acc: 0.247
Validation loss decreased (inf --> -0.246467).  Saving model ...
Epoch: 2 cost time: 5.292581081390381
Epoch: 2, Steps: 17 | Train Loss: 49.651 Vali Loss: 75.321 Vali Acc: 0.243 Test Loss: 75.321 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.761880874633789
Epoch: 3, Steps: 17 | Train Loss: 72.515 Vali Loss: 42.709 Vali Acc: 0.251 Test Loss: 42.709 Test Acc: 0.251
Validation loss decreased (-0.246467 --> -0.250523).  Saving model ...
Epoch: 4 cost time: 5.024119853973389
Epoch: 4, Steps: 17 | Train Loss: 71.336 Vali Loss: 135.010 Vali Acc: 0.240 Test Loss: 135.010 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.825714826583862
Epoch: 5, Steps: 17 | Train Loss: 94.752 Vali Loss: 89.371 Vali Acc: 0.259 Test Loss: 89.371 Test Acc: 0.259
Validation loss decreased (-0.250523 --> -0.257661).  Saving model ...
Epoch: 6 cost time: 5.160978078842163
Epoch: 6, Steps: 17 | Train Loss: 77.325 Vali Loss: 224.536 Vali Acc: 0.247 Test Loss: 224.536 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.9286744594573975
Epoch: 7, Steps: 17 | Train Loss: 91.411 Vali Loss: 146.589 Vali Acc: 0.266 Test Loss: 146.589 Test Acc: 0.266
Validation loss decreased (-0.257661 --> -0.264694).  Saving model ...
Epoch: 8 cost time: 5.804389953613281
Epoch: 8, Steps: 17 | Train Loss: 98.141 Vali Loss: 162.321 Vali Acc: 0.236 Test Loss: 162.321 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.993555307388306
Epoch: 9, Steps: 17 | Train Loss: 92.720 Vali Loss: 118.537 Vali Acc: 0.259 Test Loss: 118.537 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.440013885498047
Epoch: 10, Steps: 17 | Train Loss: 110.281 Vali Loss: 151.838 Vali Acc: 0.240 Test Loss: 151.838 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.157893180847168
Epoch: 11, Steps: 17 | Train Loss: 52.870 Vali Loss: 244.888 Vali Acc: 0.255 Test Loss: 244.888 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.1834728717803955
Epoch: 12, Steps: 17 | Train Loss: 63.681 Vali Loss: 235.991 Vali Acc: 0.266 Test Loss: 235.991 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.929480314254761
Epoch: 13, Steps: 17 | Train Loss: 93.334 Vali Loss: 210.226 Vali Acc: 0.236 Test Loss: 210.226 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.9407570362091064
Epoch: 14, Steps: 17 | Train Loss: 45.096 Vali Loss: 356.610 Vali Acc: 0.259 Test Loss: 356.610 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.500419855117798
Epoch: 15, Steps: 17 | Train Loss: 45.453 Vali Loss: 329.540 Vali Acc: 0.251 Test Loss: 329.540 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.011617422103882
Epoch: 16, Steps: 17 | Train Loss: 31.758 Vali Loss: 350.069 Vali Acc: 0.243 Test Loss: 350.069 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.336339235305786
Epoch: 17, Steps: 17 | Train Loss: 34.243 Vali Loss: 367.254 Vali Acc: 0.243 Test Loss: 367.254 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 2196796
model size : 13.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.117335557937622
Epoch: 1, Steps: 17 | Train Loss: 32.199 Vali Loss: 55.459 Vali Acc: 0.247 Test Loss: 55.459 Test Acc: 0.247
Validation loss decreased (inf --> -0.246594).  Saving model ...
Epoch: 2 cost time: 4.898369073867798
Epoch: 2, Steps: 17 | Train Loss: 87.436 Vali Loss: 136.032 Vali Acc: 0.247 Test Loss: 136.032 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.9016029834747314
Epoch: 3, Steps: 17 | Train Loss: 97.056 Vali Loss: 130.989 Vali Acc: 0.270 Test Loss: 130.989 Test Acc: 0.270
Validation loss decreased (-0.246594 --> -0.268652).  Saving model ...
Epoch: 4 cost time: 4.780503511428833
Epoch: 4, Steps: 17 | Train Loss: 132.814 Vali Loss: 166.983 Vali Acc: 0.243 Test Loss: 166.983 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.466933012008667
Epoch: 5, Steps: 17 | Train Loss: 88.226 Vali Loss: 151.543 Vali Acc: 0.243 Test Loss: 151.543 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.877196788787842
Epoch: 6, Steps: 17 | Train Loss: 73.823 Vali Loss: 57.109 Vali Acc: 0.236 Test Loss: 57.109 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.962435483932495
Epoch: 7, Steps: 17 | Train Loss: 67.344 Vali Loss: 124.714 Vali Acc: 0.259 Test Loss: 124.714 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.085067510604858
Epoch: 8, Steps: 17 | Train Loss: 91.440 Vali Loss: 152.345 Vali Acc: 0.270 Test Loss: 152.345 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.815612316131592
Epoch: 9, Steps: 17 | Train Loss: 68.651 Vali Loss: 91.877 Vali Acc: 0.259 Test Loss: 91.877 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.9456562995910645
Epoch: 10, Steps: 17 | Train Loss: 71.780 Vali Loss: 115.305 Vali Acc: 0.270 Test Loss: 115.305 Test Acc: 0.270
Validation loss decreased (-0.268652 --> -0.268809).  Saving model ...
Epoch: 11 cost time: 4.641857147216797
Epoch: 11, Steps: 17 | Train Loss: 55.354 Vali Loss: 192.801 Vali Acc: 0.270 Test Loss: 192.801 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.427855730056763
Epoch: 12, Steps: 17 | Train Loss: 52.911 Vali Loss: 159.462 Vali Acc: 0.224 Test Loss: 159.462 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.981457948684692
Epoch: 13, Steps: 17 | Train Loss: 26.715 Vali Loss: 180.711 Vali Acc: 0.240 Test Loss: 180.711 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.227741956710815
Epoch: 14, Steps: 17 | Train Loss: 45.308 Vali Loss: 213.758 Vali Acc: 0.247 Test Loss: 213.758 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.692137241363525
Epoch: 15, Steps: 17 | Train Loss: 61.753 Vali Loss: 402.729 Vali Acc: 0.259 Test Loss: 402.729 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.594383478164673
Epoch: 16, Steps: 17 | Train Loss: 44.571 Vali Loss: 405.057 Vali Acc: 0.240 Test Loss: 405.057 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.645418882369995
Epoch: 17, Steps: 17 | Train Loss: 29.288 Vali Loss: 428.954 Vali Acc: 0.224 Test Loss: 428.954 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.695335149765015
Epoch: 18, Steps: 17 | Train Loss: 41.413 Vali Loss: 543.763 Vali Acc: 0.243 Test Loss: 543.763 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.3422605991363525
Epoch: 19, Steps: 17 | Train Loss: 35.074 Vali Loss: 526.949 Vali Acc: 0.228 Test Loss: 526.949 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.983691453933716
Epoch: 20, Steps: 17 | Train Loss: 34.955 Vali Loss: 651.032 Vali Acc: 0.255 Test Loss: 651.032 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 2196796
model size : 13.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.651682376861572
Epoch: 1, Steps: 17 | Train Loss: 22.598 Vali Loss: 51.308 Vali Acc: 0.247 Test Loss: 51.308 Test Acc: 0.247
Validation loss decreased (inf --> -0.246635).  Saving model ...
Epoch: 2 cost time: 3.7909505367279053
Epoch: 2, Steps: 17 | Train Loss: 55.634 Vali Loss: 63.320 Vali Acc: 0.255 Test Loss: 63.320 Test Acc: 0.255
Validation loss decreased (-0.246635 --> -0.254120).  Saving model ...
Epoch: 3 cost time: 3.908787488937378
Epoch: 3, Steps: 17 | Train Loss: 74.892 Vali Loss: 165.978 Vali Acc: 0.247 Test Loss: 165.978 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.433403730392456
Epoch: 4, Steps: 17 | Train Loss: 133.505 Vali Loss: 86.427 Vali Acc: 0.243 Test Loss: 86.427 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8200573921203613
Epoch: 5, Steps: 17 | Train Loss: 61.498 Vali Loss: 140.108 Vali Acc: 0.247 Test Loss: 140.108 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.41841721534729
Epoch: 6, Steps: 17 | Train Loss: 60.307 Vali Loss: 46.595 Vali Acc: 0.262 Test Loss: 46.595 Test Acc: 0.262
Validation loss decreased (-0.254120 --> -0.261891).  Saving model ...
Epoch: 7 cost time: 4.098706960678101
Epoch: 7, Steps: 17 | Train Loss: 89.986 Vali Loss: 85.695 Vali Acc: 0.278 Test Loss: 85.695 Test Acc: 0.278
Validation loss decreased (-0.261891 --> -0.276710).  Saving model ...
Epoch: 8 cost time: 4.093949556350708
Epoch: 8, Steps: 17 | Train Loss: 65.915 Vali Loss: 121.856 Vali Acc: 0.262 Test Loss: 121.856 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.025169610977173
Epoch: 9, Steps: 17 | Train Loss: 51.314 Vali Loss: 89.537 Vali Acc: 0.281 Test Loss: 89.537 Test Acc: 0.281
Validation loss decreased (-0.276710 --> -0.280473).  Saving model ...
Epoch: 10 cost time: 4.283580303192139
Epoch: 10, Steps: 17 | Train Loss: 29.684 Vali Loss: 171.563 Vali Acc: 0.278 Test Loss: 171.563 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.879610776901245
Epoch: 11, Steps: 17 | Train Loss: 94.634 Vali Loss: 174.638 Vali Acc: 0.270 Test Loss: 174.638 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.4992451667785645
Epoch: 12, Steps: 17 | Train Loss: 60.647 Vali Loss: 291.437 Vali Acc: 0.251 Test Loss: 291.437 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.354902982711792
Epoch: 13, Steps: 17 | Train Loss: 82.452 Vali Loss: 436.970 Vali Acc: 0.232 Test Loss: 436.970 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.201253652572632
Epoch: 14, Steps: 17 | Train Loss: 66.943 Vali Loss: 513.572 Vali Acc: 0.255 Test Loss: 513.572 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.9960694313049316
Epoch: 15, Steps: 17 | Train Loss: 60.922 Vali Loss: 375.741 Vali Acc: 0.232 Test Loss: 375.741 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.356259822845459
Epoch: 16, Steps: 17 | Train Loss: 24.009 Vali Loss: 376.050 Vali Acc: 0.251 Test Loss: 376.050 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.170387268066406
Epoch: 17, Steps: 17 | Train Loss: 33.840 Vali Loss: 366.239 Vali Acc: 0.274 Test Loss: 366.239 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.110952377319336
Epoch: 18, Steps: 17 | Train Loss: 29.062 Vali Loss: 412.872 Vali Acc: 0.289 Test Loss: 412.872 Test Acc: 0.289
Validation loss decreased (-0.280473 --> -0.284845).  Saving model ...
Epoch: 19 cost time: 6.09138560295105
Epoch: 19, Steps: 17 | Train Loss: 12.499 Vali Loss: 456.479 Vali Acc: 0.236 Test Loss: 456.479 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.53816032409668
Epoch: 20, Steps: 17 | Train Loss: 33.778 Vali Loss: 543.472 Vali Acc: 0.247 Test Loss: 543.472 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.270611763000488
Epoch: 21, Steps: 17 | Train Loss: 17.841 Vali Loss: 637.344 Vali Acc: 0.266 Test Loss: 637.344 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.073322534561157
Epoch: 22, Steps: 17 | Train Loss: 8.775 Vali Loss: 635.050 Vali Acc: 0.236 Test Loss: 635.050 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.192034482955933
Epoch: 23, Steps: 17 | Train Loss: 6.886 Vali Loss: 684.188 Vali Acc: 0.240 Test Loss: 684.188 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.240031003952026
Epoch: 24, Steps: 17 | Train Loss: 11.397 Vali Loss: 731.812 Vali Acc: 0.255 Test Loss: 731.812 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.708024501800537
Epoch: 25, Steps: 17 | Train Loss: 8.272 Vali Loss: 757.305 Vali Acc: 0.262 Test Loss: 757.305 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.631660461425781
Epoch: 26, Steps: 17 | Train Loss: 2.482 Vali Loss: 776.061 Vali Acc: 0.255 Test Loss: 776.061 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.586136817932129
Epoch: 27, Steps: 17 | Train Loss: 5.279 Vali Loss: 807.620 Vali Acc: 0.251 Test Loss: 807.620 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.226706266403198
Epoch: 28, Steps: 17 | Train Loss: 36.896 Vali Loss: 878.575 Vali Acc: 0.228 Test Loss: 878.575 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 2196796
model size : 13.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.223618030548096
Epoch: 1, Steps: 17 | Train Loss: 29.246 Vali Loss: 42.718 Vali Acc: 0.251 Test Loss: 42.718 Test Acc: 0.251
Validation loss decreased (inf --> -0.250523).  Saving model ...
Epoch: 2 cost time: 7.827287197113037
Epoch: 2, Steps: 17 | Train Loss: 39.210 Vali Loss: 37.934 Vali Acc: 0.255 Test Loss: 37.934 Test Acc: 0.255
Validation loss decreased (-0.250523 --> -0.254374).  Saving model ...
Epoch: 3 cost time: 7.087429523468018
Epoch: 3, Steps: 17 | Train Loss: 51.378 Vali Loss: 47.089 Vali Acc: 0.251 Test Loss: 47.089 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.369524717330933
Epoch: 4, Steps: 17 | Train Loss: 73.032 Vali Loss: 188.209 Vali Acc: 0.251 Test Loss: 188.209 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.143965721130371
Epoch: 5, Steps: 17 | Train Loss: 96.636 Vali Loss: 103.315 Vali Acc: 0.243 Test Loss: 103.315 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.496177434921265
Epoch: 6, Steps: 17 | Train Loss: 81.362 Vali Loss: 180.641 Vali Acc: 0.255 Test Loss: 180.641 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.390477418899536
Epoch: 7, Steps: 17 | Train Loss: 114.525 Vali Loss: 176.781 Vali Acc: 0.236 Test Loss: 176.781 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.6318769454956055
Epoch: 8, Steps: 17 | Train Loss: 127.873 Vali Loss: 103.135 Vali Acc: 0.228 Test Loss: 103.135 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.305768728256226
Epoch: 9, Steps: 17 | Train Loss: 62.687 Vali Loss: 115.307 Vali Acc: 0.259 Test Loss: 115.307 Test Acc: 0.259
Validation loss decreased (-0.254374 --> -0.257402).  Saving model ...
Epoch: 10 cost time: 7.378215312957764
Epoch: 10, Steps: 17 | Train Loss: 47.216 Vali Loss: 93.280 Vali Acc: 0.255 Test Loss: 93.280 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.664720773696899
Epoch: 11, Steps: 17 | Train Loss: 27.839 Vali Loss: 88.530 Vali Acc: 0.232 Test Loss: 88.530 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.767587900161743
Epoch: 12, Steps: 17 | Train Loss: 33.165 Vali Loss: 283.276 Vali Acc: 0.255 Test Loss: 283.276 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.291323900222778
Epoch: 13, Steps: 17 | Train Loss: 80.058 Vali Loss: 168.755 Vali Acc: 0.255 Test Loss: 168.755 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.787286996841431
Epoch: 14, Steps: 17 | Train Loss: 32.587 Vali Loss: 231.391 Vali Acc: 0.259 Test Loss: 231.391 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.500827789306641
Epoch: 15, Steps: 17 | Train Loss: 26.943 Vali Loss: 305.662 Vali Acc: 0.232 Test Loss: 305.662 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.748359441757202
Epoch: 16, Steps: 17 | Train Loss: 36.868 Vali Loss: 341.640 Vali Acc: 0.270 Test Loss: 341.640 Test Acc: 0.270
Validation loss decreased (-0.257402 --> -0.266546).  Saving model ...
Epoch: 17 cost time: 8.516396522521973
Epoch: 17, Steps: 17 | Train Loss: 52.839 Vali Loss: 356.101 Vali Acc: 0.281 Test Loss: 356.101 Test Acc: 0.281
Validation loss decreased (-0.266546 --> -0.277808).  Saving model ...
Epoch: 18 cost time: 7.4156494140625
Epoch: 18, Steps: 17 | Train Loss: 39.318 Vali Loss: 372.819 Vali Acc: 0.247 Test Loss: 372.819 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.78044319152832
Epoch: 19, Steps: 17 | Train Loss: 40.913 Vali Loss: 413.020 Vali Acc: 0.266 Test Loss: 413.020 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 8.101447343826294
Epoch: 20, Steps: 17 | Train Loss: 32.549 Vali Loss: 423.559 Vali Acc: 0.262 Test Loss: 423.559 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.9883317947387695
Epoch: 21, Steps: 17 | Train Loss: 34.043 Vali Loss: 600.868 Vali Acc: 0.228 Test Loss: 600.868 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.5454957485198975
Epoch: 22, Steps: 17 | Train Loss: 57.855 Vali Loss: 709.554 Vali Acc: 0.209 Test Loss: 709.554 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 7.73879075050354
Epoch: 23, Steps: 17 | Train Loss: 47.323 Vali Loss: 778.987 Vali Acc: 0.236 Test Loss: 778.987 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 7.165812969207764
Epoch: 24, Steps: 17 | Train Loss: 76.916 Vali Loss: 878.900 Vali Acc: 0.224 Test Loss: 878.900 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 7.977087736129761
Epoch: 25, Steps: 17 | Train Loss: 43.586 Vali Loss: 977.137 Vali Acc: 0.266 Test Loss: 977.137 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.393400430679321
Epoch: 26, Steps: 17 | Train Loss: 29.237 Vali Loss: 974.218 Vali Acc: 0.243 Test Loss: 974.218 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.838929891586304
Epoch: 27, Steps: 17 | Train Loss: 27.831 Vali Loss: 994.951 Vali Acc: 0.240 Test Loss: 994.951 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 2131260
model size : 13.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.121779441833496
Epoch: 1, Steps: 17 | Train Loss: 23.146 Vali Loss: 18.393 Vali Acc: 0.228 Test Loss: 18.393 Test Acc: 0.228
Validation loss decreased (inf --> -0.227953).  Saving model ...
Epoch: 2 cost time: 7.5910515785217285
Epoch: 2, Steps: 17 | Train Loss: 37.100 Vali Loss: 25.333 Vali Acc: 0.228 Test Loss: 25.333 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.96345067024231
Epoch: 3, Steps: 17 | Train Loss: 64.600 Vali Loss: 73.822 Vali Acc: 0.217 Test Loss: 73.822 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.808351039886475
Epoch: 4, Steps: 17 | Train Loss: 87.682 Vali Loss: 97.882 Vali Acc: 0.221 Test Loss: 97.882 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.786688327789307
Epoch: 5, Steps: 17 | Train Loss: 80.752 Vali Loss: 71.015 Vali Acc: 0.247 Test Loss: 71.015 Test Acc: 0.247
Validation loss decreased (-0.227953 --> -0.246438).  Saving model ...
Epoch: 6 cost time: 5.826996326446533
Epoch: 6, Steps: 17 | Train Loss: 66.797 Vali Loss: 141.831 Vali Acc: 0.217 Test Loss: 141.831 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.010319709777832
Epoch: 7, Steps: 17 | Train Loss: 47.875 Vali Loss: 88.303 Vali Acc: 0.274 Test Loss: 88.303 Test Acc: 0.274
Validation loss decreased (-0.246438 --> -0.272881).  Saving model ...
Epoch: 8 cost time: 6.242368936538696
Epoch: 8, Steps: 17 | Train Loss: 73.160 Vali Loss: 221.626 Vali Acc: 0.255 Test Loss: 221.626 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.611850738525391
Epoch: 9, Steps: 17 | Train Loss: 80.493 Vali Loss: 129.107 Vali Acc: 0.278 Test Loss: 129.107 Test Acc: 0.278
Validation loss decreased (-0.272881 --> -0.276275).  Saving model ...
Epoch: 10 cost time: 6.33409309387207
Epoch: 10, Steps: 17 | Train Loss: 90.914 Vali Loss: 190.742 Vali Acc: 0.285 Test Loss: 190.742 Test Acc: 0.285
Validation loss decreased (-0.276275 --> -0.283264).  Saving model ...
Epoch: 11 cost time: 5.2291224002838135
Epoch: 11, Steps: 17 | Train Loss: 83.589 Vali Loss: 145.387 Vali Acc: 0.224 Test Loss: 145.387 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.956566095352173
Epoch: 12, Steps: 17 | Train Loss: 36.072 Vali Loss: 206.067 Vali Acc: 0.266 Test Loss: 206.067 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.7298173904418945
Epoch: 13, Steps: 17 | Train Loss: 42.734 Vali Loss: 189.277 Vali Acc: 0.297 Test Loss: 189.277 Test Acc: 0.297
Validation loss decreased (-0.283264 --> -0.294685).  Saving model ...
Epoch: 14 cost time: 5.075704097747803
Epoch: 14, Steps: 17 | Train Loss: 34.378 Vali Loss: 267.658 Vali Acc: 0.247 Test Loss: 267.658 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.84968113899231
Epoch: 15, Steps: 17 | Train Loss: 30.799 Vali Loss: 373.116 Vali Acc: 0.247 Test Loss: 373.116 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.866620063781738
Epoch: 16, Steps: 17 | Train Loss: 64.083 Vali Loss: 364.343 Vali Acc: 0.259 Test Loss: 364.343 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.845182657241821
Epoch: 17, Steps: 17 | Train Loss: 55.703 Vali Loss: 351.612 Vali Acc: 0.308 Test Loss: 351.612 Test Acc: 0.308
Validation loss decreased (-0.294685 --> -0.304469).  Saving model ...
Epoch: 18 cost time: 5.85692572593689
Epoch: 18, Steps: 17 | Train Loss: 31.720 Vali Loss: 413.228 Vali Acc: 0.236 Test Loss: 413.228 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.6857240200042725
Epoch: 19, Steps: 17 | Train Loss: 18.893 Vali Loss: 411.482 Vali Acc: 0.251 Test Loss: 411.482 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.16714072227478
Epoch: 20, Steps: 17 | Train Loss: 36.024 Vali Loss: 542.697 Vali Acc: 0.281 Test Loss: 542.697 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.897736072540283
Epoch: 21, Steps: 17 | Train Loss: 38.634 Vali Loss: 525.901 Vali Acc: 0.236 Test Loss: 525.901 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.066454172134399
Epoch: 22, Steps: 17 | Train Loss: 20.594 Vali Loss: 661.738 Vali Acc: 0.240 Test Loss: 661.738 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.36267876625061
Epoch: 23, Steps: 17 | Train Loss: 44.518 Vali Loss: 673.604 Vali Acc: 0.255 Test Loss: 673.604 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.627209186553955
Epoch: 24, Steps: 17 | Train Loss: 19.542 Vali Loss: 784.465 Vali Acc: 0.293 Test Loss: 784.465 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.836446046829224
Epoch: 25, Steps: 17 | Train Loss: 33.174 Vali Loss: 811.189 Vali Acc: 0.262 Test Loss: 811.189 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.3436174392700195
Epoch: 26, Steps: 17 | Train Loss: 22.254 Vali Loss: 926.451 Vali Acc: 0.236 Test Loss: 926.451 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.008627891540527
Epoch: 27, Steps: 17 | Train Loss: 13.214 Vali Loss: 901.204 Vali Acc: 0.247 Test Loss: 901.204 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 2131260
model size : 13.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.694648504257202
Epoch: 1, Steps: 17 | Train Loss: 41.238 Vali Loss: 77.604 Vali Acc: 0.251 Test Loss: 77.604 Test Acc: 0.251
Validation loss decreased (inf --> -0.250175).  Saving model ...
Epoch: 2 cost time: 4.872299671173096
Epoch: 2, Steps: 17 | Train Loss: 59.996 Vali Loss: 47.949 Vali Acc: 0.255 Test Loss: 47.949 Test Acc: 0.255
Validation loss decreased (-0.250175 --> -0.254273).  Saving model ...
Epoch: 3 cost time: 4.933868408203125
Epoch: 3, Steps: 17 | Train Loss: 70.272 Vali Loss: 137.836 Vali Acc: 0.247 Test Loss: 137.836 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.784024953842163
Epoch: 4, Steps: 17 | Train Loss: 144.084 Vali Loss: 198.769 Vali Acc: 0.247 Test Loss: 198.769 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.255698204040527
Epoch: 5, Steps: 17 | Train Loss: 154.142 Vali Loss: 183.426 Vali Acc: 0.259 Test Loss: 183.426 Test Acc: 0.259
Validation loss decreased (-0.254273 --> -0.256721).  Saving model ...
Epoch: 6 cost time: 5.047155141830444
Epoch: 6, Steps: 17 | Train Loss: 165.373 Vali Loss: 123.671 Vali Acc: 0.240 Test Loss: 123.671 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.535809755325317
Epoch: 7, Steps: 17 | Train Loss: 117.668 Vali Loss: 131.780 Vali Acc: 0.266 Test Loss: 131.780 Test Acc: 0.266
Validation loss decreased (-0.256721 --> -0.264842).  Saving model ...
Epoch: 8 cost time: 4.5677878856658936
Epoch: 8, Steps: 17 | Train Loss: 63.577 Vali Loss: 193.693 Vali Acc: 0.259 Test Loss: 193.693 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.003159523010254
Epoch: 9, Steps: 17 | Train Loss: 95.248 Vali Loss: 121.030 Vali Acc: 0.232 Test Loss: 121.030 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.554791450500488
Epoch: 10, Steps: 17 | Train Loss: 67.670 Vali Loss: 103.958 Vali Acc: 0.281 Test Loss: 103.958 Test Acc: 0.281
Validation loss decreased (-0.264842 --> -0.280329).  Saving model ...
Epoch: 11 cost time: 4.607578992843628
Epoch: 11, Steps: 17 | Train Loss: 41.130 Vali Loss: 168.742 Vali Acc: 0.266 Test Loss: 168.742 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.278565406799316
Epoch: 12, Steps: 17 | Train Loss: 29.547 Vali Loss: 183.448 Vali Acc: 0.255 Test Loss: 183.448 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.663039207458496
Epoch: 13, Steps: 17 | Train Loss: 51.393 Vali Loss: 226.972 Vali Acc: 0.251 Test Loss: 226.972 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.6861677169799805
Epoch: 14, Steps: 17 | Train Loss: 47.062 Vali Loss: 213.252 Vali Acc: 0.251 Test Loss: 213.252 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.346071481704712
Epoch: 15, Steps: 17 | Train Loss: 30.321 Vali Loss: 279.887 Vali Acc: 0.259 Test Loss: 279.887 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.556629419326782
Epoch: 16, Steps: 17 | Train Loss: 36.157 Vali Loss: 291.714 Vali Acc: 0.236 Test Loss: 291.714 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.815719842910767
Epoch: 17, Steps: 17 | Train Loss: 20.790 Vali Loss: 344.660 Vali Acc: 0.278 Test Loss: 344.660 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.628744125366211
Epoch: 18, Steps: 17 | Train Loss: 17.720 Vali Loss: 400.604 Vali Acc: 0.259 Test Loss: 400.604 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.816939353942871
Epoch: 19, Steps: 17 | Train Loss: 32.514 Vali Loss: 422.254 Vali Acc: 0.236 Test Loss: 422.254 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.591728925704956
Epoch: 20, Steps: 17 | Train Loss: 43.056 Vali Loss: 518.100 Vali Acc: 0.278 Test Loss: 518.100 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 2131260
model size : 13.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.009601593017578
Epoch: 1, Steps: 17 | Train Loss: 27.361 Vali Loss: 28.353 Vali Acc: 0.243 Test Loss: 28.353 Test Acc: 0.243
Validation loss decreased (inf --> -0.243062).  Saving model ...
Epoch: 2 cost time: 4.136389493942261
Epoch: 2, Steps: 17 | Train Loss: 40.921 Vali Loss: 35.551 Vali Acc: 0.232 Test Loss: 35.551 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.174978733062744
Epoch: 3, Steps: 17 | Train Loss: 37.302 Vali Loss: 40.509 Vali Acc: 0.251 Test Loss: 40.509 Test Acc: 0.251
Validation loss decreased (-0.243062 --> -0.250545).  Saving model ...
Epoch: 4 cost time: 4.366656303405762
Epoch: 4, Steps: 17 | Train Loss: 62.104 Vali Loss: 114.113 Vali Acc: 0.259 Test Loss: 114.113 Test Acc: 0.259
Validation loss decreased (-0.250545 --> -0.257414).  Saving model ...
Epoch: 5 cost time: 4.611156702041626
Epoch: 5, Steps: 17 | Train Loss: 73.397 Vali Loss: 26.240 Vali Acc: 0.247 Test Loss: 26.240 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7219178676605225
Epoch: 6, Steps: 17 | Train Loss: 83.350 Vali Loss: 176.736 Vali Acc: 0.247 Test Loss: 176.736 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8733022212982178
Epoch: 7, Steps: 17 | Train Loss: 85.799 Vali Loss: 150.971 Vali Acc: 0.255 Test Loss: 150.971 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.090738296508789
Epoch: 8, Steps: 17 | Train Loss: 114.143 Vali Loss: 83.779 Vali Acc: 0.224 Test Loss: 83.779 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.9378488063812256
Epoch: 9, Steps: 17 | Train Loss: 44.693 Vali Loss: 165.100 Vali Acc: 0.247 Test Loss: 165.100 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.221934080123901
Epoch: 10, Steps: 17 | Train Loss: 80.066 Vali Loss: 226.122 Vali Acc: 0.255 Test Loss: 226.122 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.388450384140015
Epoch: 11, Steps: 17 | Train Loss: 35.329 Vali Loss: 217.351 Vali Acc: 0.251 Test Loss: 217.351 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.093763589859009
Epoch: 12, Steps: 17 | Train Loss: 46.137 Vali Loss: 157.505 Vali Acc: 0.281 Test Loss: 157.505 Test Acc: 0.281
Validation loss decreased (-0.257414 --> -0.279794).  Saving model ...
Epoch: 13 cost time: 4.404452800750732
Epoch: 13, Steps: 17 | Train Loss: 17.000 Vali Loss: 210.205 Vali Acc: 0.251 Test Loss: 210.205 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.80194354057312
Epoch: 14, Steps: 17 | Train Loss: 55.626 Vali Loss: 382.142 Vali Acc: 0.251 Test Loss: 382.142 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9161620140075684
Epoch: 15, Steps: 17 | Train Loss: 62.502 Vali Loss: 292.206 Vali Acc: 0.198 Test Loss: 292.206 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.212650537490845
Epoch: 16, Steps: 17 | Train Loss: 32.866 Vali Loss: 395.143 Vali Acc: 0.270 Test Loss: 395.143 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8023126125335693
Epoch: 17, Steps: 17 | Train Loss: 51.701 Vali Loss: 428.021 Vali Acc: 0.243 Test Loss: 428.021 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.955061435699463
Epoch: 18, Steps: 17 | Train Loss: 37.486 Vali Loss: 422.898 Vali Acc: 0.247 Test Loss: 422.898 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.845595598220825
Epoch: 19, Steps: 17 | Train Loss: 38.534 Vali Loss: 431.975 Vali Acc: 0.240 Test Loss: 431.975 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.416043996810913
Epoch: 20, Steps: 17 | Train Loss: 17.331 Vali Loss: 548.026 Vali Acc: 0.240 Test Loss: 548.026 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.7932212352752686
Epoch: 21, Steps: 17 | Train Loss: 14.659 Vali Loss: 562.696 Vali Acc: 0.251 Test Loss: 562.696 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.999732255935669
Epoch: 22, Steps: 17 | Train Loss: 11.155 Vali Loss: 589.277 Vali Acc: 0.221 Test Loss: 589.277 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 2131260
model size : 13.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.894335746765137
Epoch: 1, Steps: 17 | Train Loss: 17.008 Vali Loss: 27.329 Vali Acc: 0.251 Test Loss: 27.329 Test Acc: 0.251
Validation loss decreased (inf --> -0.250677).  Saving model ...
Epoch: 2 cost time: 4.208618640899658
Epoch: 2, Steps: 17 | Train Loss: 40.003 Vali Loss: 32.102 Vali Acc: 0.236 Test Loss: 32.102 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.288251876831055
Epoch: 3, Steps: 17 | Train Loss: 31.481 Vali Loss: 47.254 Vali Acc: 0.232 Test Loss: 47.254 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8299131393432617
Epoch: 4, Steps: 17 | Train Loss: 42.251 Vali Loss: 36.408 Vali Acc: 0.224 Test Loss: 36.408 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.58536434173584
Epoch: 5, Steps: 17 | Train Loss: 56.865 Vali Loss: 71.090 Vali Acc: 0.236 Test Loss: 71.090 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.258859395980835
Epoch: 6, Steps: 17 | Train Loss: 65.266 Vali Loss: 100.081 Vali Acc: 0.251 Test Loss: 100.081 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.292726516723633
Epoch: 7, Steps: 17 | Train Loss: 62.319 Vali Loss: 41.909 Vali Acc: 0.224 Test Loss: 41.909 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.135073661804199
Epoch: 8, Steps: 17 | Train Loss: 39.296 Vali Loss: 59.423 Vali Acc: 0.247 Test Loss: 59.423 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.8681042194366455
Epoch: 9, Steps: 17 | Train Loss: 62.901 Vali Loss: 44.952 Vali Acc: 0.232 Test Loss: 44.952 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.018096685409546
Epoch: 10, Steps: 17 | Train Loss: 33.140 Vali Loss: 62.212 Vali Acc: 0.251 Test Loss: 62.212 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.0366504192352295
Epoch: 11, Steps: 17 | Train Loss: 32.659 Vali Loss: 65.770 Vali Acc: 0.224 Test Loss: 65.770 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2509505703422053
model parameter : 2015932
model size : 10.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.936006307601929
Epoch: 1, Steps: 17 | Train Loss: 17.606 Vali Loss: 42.698 Vali Acc: 0.251 Test Loss: 42.698 Test Acc: 0.251
Validation loss decreased (inf --> -0.250524).  Saving model ...
Epoch: 2 cost time: 4.318031072616577
Epoch: 2, Steps: 17 | Train Loss: 24.076 Vali Loss: 16.390 Vali Acc: 0.232 Test Loss: 16.390 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.537005662918091
Epoch: 3, Steps: 17 | Train Loss: 23.205 Vali Loss: 58.089 Vali Acc: 0.247 Test Loss: 58.089 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.894552707672119
Epoch: 4, Steps: 17 | Train Loss: 38.136 Vali Loss: 32.575 Vali Acc: 0.251 Test Loss: 32.575 Test Acc: 0.251
Validation loss decreased (-0.250524 --> -0.250625).  Saving model ...
Epoch: 5 cost time: 4.117520570755005
Epoch: 5, Steps: 17 | Train Loss: 29.007 Vali Loss: 53.233 Vali Acc: 0.251 Test Loss: 53.233 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8235397338867188
Epoch: 6, Steps: 17 | Train Loss: 35.345 Vali Loss: 31.003 Vali Acc: 0.251 Test Loss: 31.003 Test Acc: 0.251
Validation loss decreased (-0.250625 --> -0.250641).  Saving model ...
Epoch: 7 cost time: 3.779714822769165
Epoch: 7, Steps: 17 | Train Loss: 39.317 Vali Loss: 72.968 Vali Acc: 0.232 Test Loss: 72.968 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8508481979370117
Epoch: 8, Steps: 17 | Train Loss: 36.051 Vali Loss: 41.919 Vali Acc: 0.259 Test Loss: 41.919 Test Acc: 0.259
Validation loss decreased (-0.250641 --> -0.258136).  Saving model ...
Epoch: 9 cost time: 2.741642475128174
Epoch: 9, Steps: 17 | Train Loss: 32.773 Vali Loss: 33.685 Vali Acc: 0.228 Test Loss: 33.685 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8859026432037354
Epoch: 10, Steps: 17 | Train Loss: 25.219 Vali Loss: 42.189 Vali Acc: 0.247 Test Loss: 42.189 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.8668196201324463
Epoch: 11, Steps: 17 | Train Loss: 60.223 Vali Loss: 143.194 Vali Acc: 0.255 Test Loss: 143.194 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.5763447284698486
Epoch: 12, Steps: 17 | Train Loss: 70.918 Vali Loss: 106.425 Vali Acc: 0.251 Test Loss: 106.425 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.755674362182617
Epoch: 13, Steps: 17 | Train Loss: 40.021 Vali Loss: 91.488 Vali Acc: 0.289 Test Loss: 91.488 Test Acc: 0.289
Validation loss decreased (-0.258136 --> -0.288059).  Saving model ...
Epoch: 14 cost time: 3.422740936279297
Epoch: 14, Steps: 17 | Train Loss: 33.111 Vali Loss: 131.516 Vali Acc: 0.247 Test Loss: 131.516 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7125158309936523
Epoch: 15, Steps: 17 | Train Loss: 46.010 Vali Loss: 160.995 Vali Acc: 0.262 Test Loss: 160.995 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.7398791313171387
Epoch: 16, Steps: 17 | Train Loss: 24.389 Vali Loss: 94.511 Vali Acc: 0.274 Test Loss: 94.511 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5113370418548584
Epoch: 17, Steps: 17 | Train Loss: 19.815 Vali Loss: 123.995 Vali Acc: 0.236 Test Loss: 123.995 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.642595052719116
Epoch: 18, Steps: 17 | Train Loss: 20.192 Vali Loss: 131.264 Vali Acc: 0.255 Test Loss: 131.264 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.7340505123138428
Epoch: 19, Steps: 17 | Train Loss: 20.450 Vali Loss: 184.978 Vali Acc: 0.247 Test Loss: 184.978 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.8777666091918945
Epoch: 20, Steps: 17 | Train Loss: 12.406 Vali Loss: 145.886 Vali Acc: 0.221 Test Loss: 145.886 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.6202151775360107
Epoch: 21, Steps: 17 | Train Loss: 9.133 Vali Loss: 150.776 Vali Acc: 0.228 Test Loss: 150.776 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.622511386871338
Epoch: 22, Steps: 17 | Train Loss: 16.657 Vali Loss: 156.764 Vali Acc: 0.259 Test Loss: 156.764 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.789638042449951
Epoch: 23, Steps: 17 | Train Loss: 14.788 Vali Loss: 228.071 Vali Acc: 0.240 Test Loss: 228.071 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 2015932
model size : 10.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.521334648132324
Epoch: 1, Steps: 17 | Train Loss: 17.078 Vali Loss: 42.419 Vali Acc: 0.251 Test Loss: 42.419 Test Acc: 0.251
Validation loss decreased (inf --> -0.250526).  Saving model ...
Epoch: 2 cost time: 3.680905818939209
Epoch: 2, Steps: 17 | Train Loss: 32.357 Vali Loss: 32.004 Vali Acc: 0.243 Test Loss: 32.004 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4219701290130615
Epoch: 3, Steps: 17 | Train Loss: 52.904 Vali Loss: 45.668 Vali Acc: 0.251 Test Loss: 45.668 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5784037113189697
Epoch: 4, Steps: 17 | Train Loss: 40.939 Vali Loss: 27.140 Vali Acc: 0.217 Test Loss: 27.140 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2133030891418457
Epoch: 5, Steps: 17 | Train Loss: 42.153 Vali Loss: 69.646 Vali Acc: 0.247 Test Loss: 69.646 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.245988130569458
Epoch: 6, Steps: 17 | Train Loss: 58.785 Vali Loss: 104.235 Vali Acc: 0.232 Test Loss: 104.235 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.0175440311431885
Epoch: 7, Steps: 17 | Train Loss: 57.451 Vali Loss: 65.143 Vali Acc: 0.259 Test Loss: 65.143 Test Acc: 0.259
Validation loss decreased (-0.250526 --> -0.257904).  Saving model ...
Epoch: 8 cost time: 3.1986310482025146
Epoch: 8, Steps: 17 | Train Loss: 72.653 Vali Loss: 62.310 Vali Acc: 0.236 Test Loss: 62.310 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8019793033599854
Epoch: 9, Steps: 17 | Train Loss: 55.859 Vali Loss: 63.360 Vali Acc: 0.240 Test Loss: 63.360 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.5866055488586426
Epoch: 10, Steps: 17 | Train Loss: 64.533 Vali Loss: 65.802 Vali Acc: 0.278 Test Loss: 65.802 Test Acc: 0.278
Validation loss decreased (-0.257904 --> -0.276909).  Saving model ...
Epoch: 11 cost time: 3.8283281326293945
Epoch: 11, Steps: 17 | Train Loss: 34.531 Vali Loss: 37.516 Vali Acc: 0.274 Test Loss: 37.516 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.791653633117676
Epoch: 12, Steps: 17 | Train Loss: 27.665 Vali Loss: 93.997 Vali Acc: 0.243 Test Loss: 93.997 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5296823978424072
Epoch: 13, Steps: 17 | Train Loss: 41.242 Vali Loss: 58.487 Vali Acc: 0.251 Test Loss: 58.487 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.620201587677002
Epoch: 14, Steps: 17 | Train Loss: 18.220 Vali Loss: 83.474 Vali Acc: 0.243 Test Loss: 83.474 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.6448957920074463
Epoch: 15, Steps: 17 | Train Loss: 20.699 Vali Loss: 78.245 Vali Acc: 0.251 Test Loss: 78.245 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.6517090797424316
Epoch: 16, Steps: 17 | Train Loss: 15.650 Vali Loss: 88.703 Vali Acc: 0.221 Test Loss: 88.703 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.228354215621948
Epoch: 17, Steps: 17 | Train Loss: 20.355 Vali Loss: 100.494 Vali Acc: 0.278 Test Loss: 100.494 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.711777687072754
Epoch: 18, Steps: 17 | Train Loss: 15.160 Vali Loss: 104.797 Vali Acc: 0.255 Test Loss: 104.797 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.5305747985839844
Epoch: 19, Steps: 17 | Train Loss: 13.312 Vali Loss: 103.783 Vali Acc: 0.251 Test Loss: 103.783 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.099856376647949
Epoch: 20, Steps: 17 | Train Loss: 10.988 Vali Loss: 117.846 Vali Acc: 0.255 Test Loss: 117.846 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 2015932
model size : 10.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.731175661087036
Epoch: 1, Steps: 17 | Train Loss: 11.559 Vali Loss: 5.974 Vali Acc: 0.266 Test Loss: 5.974 Test Acc: 0.266
Validation loss decreased (inf --> -0.266100).  Saving model ...
Epoch: 2 cost time: 3.2543017864227295
Epoch: 2, Steps: 17 | Train Loss: 23.997 Vali Loss: 38.302 Vali Acc: 0.251 Test Loss: 38.302 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6429243087768555
Epoch: 3, Steps: 17 | Train Loss: 38.900 Vali Loss: 35.933 Vali Acc: 0.262 Test Loss: 35.933 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.800056219100952
Epoch: 4, Steps: 17 | Train Loss: 24.795 Vali Loss: 53.062 Vali Acc: 0.251 Test Loss: 53.062 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.177473306655884
Epoch: 5, Steps: 17 | Train Loss: 35.564 Vali Loss: 50.690 Vali Acc: 0.270 Test Loss: 50.690 Test Acc: 0.270
Validation loss decreased (-0.266100 --> -0.269455).  Saving model ...
Epoch: 6 cost time: 3.2672152519226074
Epoch: 6, Steps: 17 | Train Loss: 49.110 Vali Loss: 64.220 Vali Acc: 0.251 Test Loss: 64.220 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.385002613067627
Epoch: 7, Steps: 17 | Train Loss: 39.014 Vali Loss: 22.633 Vali Acc: 0.251 Test Loss: 22.633 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2476284503936768
Epoch: 8, Steps: 17 | Train Loss: 64.650 Vali Loss: 101.058 Vali Acc: 0.255 Test Loss: 101.058 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.728198289871216
Epoch: 9, Steps: 17 | Train Loss: 56.872 Vali Loss: 70.203 Vali Acc: 0.251 Test Loss: 70.203 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.6347055435180664
Epoch: 10, Steps: 17 | Train Loss: 63.020 Vali Loss: 115.194 Vali Acc: 0.251 Test Loss: 115.194 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.5483760833740234
Epoch: 11, Steps: 17 | Train Loss: 33.610 Vali Loss: 137.677 Vali Acc: 0.247 Test Loss: 137.677 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.729574680328369
Epoch: 12, Steps: 17 | Train Loss: 49.622 Vali Loss: 54.329 Vali Acc: 0.232 Test Loss: 54.329 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.676152467727661
Epoch: 13, Steps: 17 | Train Loss: 39.150 Vali Loss: 90.211 Vali Acc: 0.243 Test Loss: 90.211 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.7102465629577637
Epoch: 14, Steps: 17 | Train Loss: 20.107 Vali Loss: 68.816 Vali Acc: 0.259 Test Loss: 68.816 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.6568820476531982
Epoch: 15, Steps: 17 | Train Loss: 40.912 Vali Loss: 127.592 Vali Acc: 0.281 Test Loss: 127.592 Test Acc: 0.281
Validation loss decreased (-0.269455 --> -0.280093).  Saving model ...
Epoch: 16 cost time: 3.32973051071167
Epoch: 16, Steps: 17 | Train Loss: 26.145 Vali Loss: 119.340 Vali Acc: 0.266 Test Loss: 119.340 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.311985731124878
Epoch: 17, Steps: 17 | Train Loss: 20.181 Vali Loss: 152.506 Vali Acc: 0.232 Test Loss: 152.506 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.6596031188964844
Epoch: 18, Steps: 17 | Train Loss: 23.025 Vali Loss: 154.919 Vali Acc: 0.297 Test Loss: 154.919 Test Acc: 0.297
Validation loss decreased (-0.280093 --> -0.295029).  Saving model ...
Epoch: 19 cost time: 3.219289779663086
Epoch: 19, Steps: 17 | Train Loss: 10.810 Vali Loss: 141.497 Vali Acc: 0.255 Test Loss: 141.497 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.126648426055908
Epoch: 20, Steps: 17 | Train Loss: 14.053 Vali Loss: 168.134 Vali Acc: 0.247 Test Loss: 168.134 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.3338816165924072
Epoch: 21, Steps: 17 | Train Loss: 29.228 Vali Loss: 207.674 Vali Acc: 0.266 Test Loss: 207.674 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2559123039245605
Epoch: 22, Steps: 17 | Train Loss: 17.197 Vali Loss: 198.145 Vali Acc: 0.243 Test Loss: 198.145 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.8716328144073486
Epoch: 23, Steps: 17 | Train Loss: 8.520 Vali Loss: 205.818 Vali Acc: 0.259 Test Loss: 205.818 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.481729030609131
Epoch: 24, Steps: 17 | Train Loss: 4.914 Vali Loss: 240.243 Vali Acc: 0.232 Test Loss: 240.243 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.0553667545318604
Epoch: 25, Steps: 17 | Train Loss: 12.371 Vali Loss: 285.221 Vali Acc: 0.232 Test Loss: 285.221 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7088680267333984
Epoch: 26, Steps: 17 | Train Loss: 6.280 Vali Loss: 271.261 Vali Acc: 0.274 Test Loss: 271.261 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.468574285507202
Epoch: 27, Steps: 17 | Train Loss: 4.675 Vali Loss: 291.051 Vali Acc: 0.251 Test Loss: 291.051 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.1298866271972656
Epoch: 28, Steps: 17 | Train Loss: 5.093 Vali Loss: 297.696 Vali Acc: 0.209 Test Loss: 297.696 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 2015932
model size : 10.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.05154275894165
Epoch: 1, Steps: 17 | Train Loss: 16.851 Vali Loss: 26.522 Vali Acc: 0.247 Test Loss: 26.522 Test Acc: 0.247
Validation loss decreased (inf --> -0.246883).  Saving model ...
Epoch: 2 cost time: 4.033700466156006
Epoch: 2, Steps: 17 | Train Loss: 27.864 Vali Loss: 40.336 Vali Acc: 0.251 Test Loss: 40.336 Test Acc: 0.251
Validation loss decreased (-0.246883 --> -0.250547).  Saving model ...
Epoch: 3 cost time: 3.939028024673462
Epoch: 3, Steps: 17 | Train Loss: 30.278 Vali Loss: 27.197 Vali Acc: 0.259 Test Loss: 27.197 Test Acc: 0.259
Validation loss decreased (-0.250547 --> -0.258283).  Saving model ...
Epoch: 4 cost time: 3.7277252674102783
Epoch: 4, Steps: 17 | Train Loss: 30.838 Vali Loss: 50.029 Vali Acc: 0.281 Test Loss: 50.029 Test Acc: 0.281
Validation loss decreased (-0.258283 --> -0.280869).  Saving model ...
Epoch: 5 cost time: 3.9691731929779053
Epoch: 5, Steps: 17 | Train Loss: 28.684 Vali Loss: 51.962 Vali Acc: 0.262 Test Loss: 51.962 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.031331539154053
Epoch: 6, Steps: 17 | Train Loss: 28.571 Vali Loss: 45.801 Vali Acc: 0.213 Test Loss: 45.801 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9432878494262695
Epoch: 7, Steps: 17 | Train Loss: 63.318 Vali Loss: 64.486 Vali Acc: 0.266 Test Loss: 64.486 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.220156669616699
Epoch: 8, Steps: 17 | Train Loss: 37.580 Vali Loss: 89.946 Vali Acc: 0.247 Test Loss: 89.946 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.0451438426971436
Epoch: 9, Steps: 17 | Train Loss: 65.937 Vali Loss: 54.099 Vali Acc: 0.236 Test Loss: 54.099 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.934105157852173
Epoch: 10, Steps: 17 | Train Loss: 44.682 Vali Loss: 43.821 Vali Acc: 0.236 Test Loss: 43.821 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.155578851699829
Epoch: 11, Steps: 17 | Train Loss: 45.558 Vali Loss: 85.048 Vali Acc: 0.259 Test Loss: 85.048 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.793342113494873
Epoch: 12, Steps: 17 | Train Loss: 46.370 Vali Loss: 104.130 Vali Acc: 0.262 Test Loss: 104.130 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.7156617641448975
Epoch: 13, Steps: 17 | Train Loss: 40.825 Vali Loss: 92.357 Vali Acc: 0.255 Test Loss: 92.357 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.351013898849487
Epoch: 14, Steps: 17 | Train Loss: 36.466 Vali Loss: 83.767 Vali Acc: 0.243 Test Loss: 83.767 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1491644
model size : 8.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.026106357574463
Epoch: 1, Steps: 17 | Train Loss: 18.254 Vali Loss: 18.265 Vali Acc: 0.266 Test Loss: 18.265 Test Acc: 0.266
Validation loss decreased (inf --> -0.265977).  Saving model ...
Epoch: 2 cost time: 3.374767541885376
Epoch: 2, Steps: 17 | Train Loss: 21.183 Vali Loss: 32.618 Vali Acc: 0.262 Test Loss: 32.618 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.924440622329712
Epoch: 3, Steps: 17 | Train Loss: 29.673 Vali Loss: 29.070 Vali Acc: 0.232 Test Loss: 29.070 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7732441425323486
Epoch: 4, Steps: 17 | Train Loss: 35.763 Vali Loss: 25.546 Vali Acc: 0.259 Test Loss: 25.546 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.6010189056396484
Epoch: 5, Steps: 17 | Train Loss: 22.415 Vali Loss: 42.238 Vali Acc: 0.251 Test Loss: 42.238 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.816094160079956
Epoch: 6, Steps: 17 | Train Loss: 51.802 Vali Loss: 99.843 Vali Acc: 0.247 Test Loss: 99.843 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.000041961669922
Epoch: 7, Steps: 17 | Train Loss: 64.735 Vali Loss: 59.740 Vali Acc: 0.236 Test Loss: 59.740 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.7909302711486816
Epoch: 8, Steps: 17 | Train Loss: 35.067 Vali Loss: 70.822 Vali Acc: 0.285 Test Loss: 70.822 Test Acc: 0.285
Validation loss decreased (-0.265977 --> -0.284463).  Saving model ...
Epoch: 9 cost time: 3.5154950618743896
Epoch: 9, Steps: 17 | Train Loss: 67.396 Vali Loss: 145.649 Vali Acc: 0.243 Test Loss: 145.649 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.396277904510498
Epoch: 10, Steps: 17 | Train Loss: 50.754 Vali Loss: 92.921 Vali Acc: 0.232 Test Loss: 92.921 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.9793334007263184
Epoch: 11, Steps: 17 | Train Loss: 44.208 Vali Loss: 88.005 Vali Acc: 0.251 Test Loss: 88.005 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9605510234832764
Epoch: 12, Steps: 17 | Train Loss: 43.148 Vali Loss: 59.280 Vali Acc: 0.270 Test Loss: 59.280 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.785560369491577
Epoch: 13, Steps: 17 | Train Loss: 25.171 Vali Loss: 91.476 Vali Acc: 0.255 Test Loss: 91.476 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.02872109413147
Epoch: 14, Steps: 17 | Train Loss: 26.759 Vali Loss: 96.418 Vali Acc: 0.266 Test Loss: 96.418 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.71405291557312
Epoch: 15, Steps: 17 | Train Loss: 27.605 Vali Loss: 84.600 Vali Acc: 0.243 Test Loss: 84.600 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.7290289402008057
Epoch: 16, Steps: 17 | Train Loss: 16.570 Vali Loss: 76.214 Vali Acc: 0.236 Test Loss: 76.214 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.816284656524658
Epoch: 17, Steps: 17 | Train Loss: 21.762 Vali Loss: 99.432 Vali Acc: 0.247 Test Loss: 99.432 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.8998279571533203
Epoch: 18, Steps: 17 | Train Loss: 19.700 Vali Loss: 133.574 Vali Acc: 0.285 Test Loss: 133.574 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1491644
model size : 8.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.1756250858306885
Epoch: 1, Steps: 17 | Train Loss: 16.011 Vali Loss: 10.288 Vali Acc: 0.259 Test Loss: 10.288 Test Acc: 0.259
Validation loss decreased (inf --> -0.258452).  Saving model ...
Epoch: 2 cost time: 3.6638519763946533
Epoch: 2, Steps: 17 | Train Loss: 18.623 Vali Loss: 34.521 Vali Acc: 0.228 Test Loss: 34.521 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.383058786392212
Epoch: 3, Steps: 17 | Train Loss: 33.983 Vali Loss: 18.698 Vali Acc: 0.247 Test Loss: 18.698 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.453864812850952
Epoch: 4, Steps: 17 | Train Loss: 32.271 Vali Loss: 39.064 Vali Acc: 0.278 Test Loss: 39.064 Test Acc: 0.278
Validation loss decreased (-0.258452 --> -0.277176).  Saving model ...
Epoch: 5 cost time: 3.528189182281494
Epoch: 5, Steps: 17 | Train Loss: 48.807 Vali Loss: 42.794 Vali Acc: 0.243 Test Loss: 42.794 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5316951274871826
Epoch: 6, Steps: 17 | Train Loss: 42.076 Vali Loss: 38.996 Vali Acc: 0.243 Test Loss: 38.996 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.7405545711517334
Epoch: 7, Steps: 17 | Train Loss: 45.234 Vali Loss: 40.394 Vali Acc: 0.236 Test Loss: 40.394 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.680601119995117
Epoch: 8, Steps: 17 | Train Loss: 55.491 Vali Loss: 98.804 Vali Acc: 0.243 Test Loss: 98.804 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.546304225921631
Epoch: 9, Steps: 17 | Train Loss: 54.665 Vali Loss: 97.815 Vali Acc: 0.255 Test Loss: 97.815 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.316282272338867
Epoch: 10, Steps: 17 | Train Loss: 34.605 Vali Loss: 73.808 Vali Acc: 0.262 Test Loss: 73.808 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.940340280532837
Epoch: 11, Steps: 17 | Train Loss: 62.745 Vali Loss: 50.681 Vali Acc: 0.251 Test Loss: 50.681 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.6133737564086914
Epoch: 12, Steps: 17 | Train Loss: 30.864 Vali Loss: 77.877 Vali Acc: 0.251 Test Loss: 77.877 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.462433099746704
Epoch: 13, Steps: 17 | Train Loss: 36.396 Vali Loss: 52.807 Vali Acc: 0.278 Test Loss: 52.807 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.6563451290130615
Epoch: 14, Steps: 17 | Train Loss: 27.170 Vali Loss: 124.355 Vali Acc: 0.259 Test Loss: 124.355 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 1491644
model size : 8.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.052621364593506
Epoch: 1, Steps: 17 | Train Loss: 16.364 Vali Loss: 48.300 Vali Acc: 0.255 Test Loss: 48.300 Test Acc: 0.255
Validation loss decreased (inf --> -0.254270).  Saving model ...
Epoch: 2 cost time: 2.8258490562438965
Epoch: 2, Steps: 17 | Train Loss: 42.850 Vali Loss: 51.612 Vali Acc: 0.255 Test Loss: 51.612 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9328911304473877
Epoch: 3, Steps: 17 | Train Loss: 34.866 Vali Loss: 23.634 Vali Acc: 0.251 Test Loss: 23.634 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.052222490310669
Epoch: 4, Steps: 17 | Train Loss: 27.503 Vali Loss: 15.559 Vali Acc: 0.259 Test Loss: 15.559 Test Acc: 0.259
Validation loss decreased (-0.254270 --> -0.258400).  Saving model ...
Epoch: 5 cost time: 2.927489757537842
Epoch: 5, Steps: 17 | Train Loss: 32.586 Vali Loss: 47.167 Vali Acc: 0.278 Test Loss: 47.167 Test Acc: 0.278
Validation loss decreased (-0.258400 --> -0.277095).  Saving model ...
Epoch: 6 cost time: 2.691305637359619
Epoch: 6, Steps: 17 | Train Loss: 32.656 Vali Loss: 76.914 Vali Acc: 0.247 Test Loss: 76.914 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8946592807769775
Epoch: 7, Steps: 17 | Train Loss: 57.267 Vali Loss: 69.067 Vali Acc: 0.243 Test Loss: 69.067 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.179659605026245
Epoch: 8, Steps: 17 | Train Loss: 41.389 Vali Loss: 75.639 Vali Acc: 0.243 Test Loss: 75.639 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7696478366851807
Epoch: 9, Steps: 17 | Train Loss: 55.270 Vali Loss: 40.143 Vali Acc: 0.278 Test Loss: 40.143 Test Acc: 0.278
Validation loss decreased (-0.277095 --> -0.277165).  Saving model ...
Epoch: 10 cost time: 3.0192599296569824
Epoch: 10, Steps: 17 | Train Loss: 25.207 Vali Loss: 51.858 Vali Acc: 0.232 Test Loss: 51.858 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.708634853363037
Epoch: 11, Steps: 17 | Train Loss: 33.853 Vali Loss: 71.012 Vali Acc: 0.266 Test Loss: 71.012 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9263648986816406
Epoch: 12, Steps: 17 | Train Loss: 26.085 Vali Loss: 90.882 Vali Acc: 0.228 Test Loss: 90.882 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.689789056777954
Epoch: 13, Steps: 17 | Train Loss: 39.888 Vali Loss: 91.533 Vali Acc: 0.262 Test Loss: 91.533 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.857156276702881
Epoch: 14, Steps: 17 | Train Loss: 34.906 Vali Loss: 126.081 Vali Acc: 0.259 Test Loss: 126.081 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.7794835567474365
Epoch: 15, Steps: 17 | Train Loss: 34.362 Vali Loss: 105.765 Vali Acc: 0.255 Test Loss: 105.765 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.9518637657165527
Epoch: 16, Steps: 17 | Train Loss: 22.928 Vali Loss: 99.842 Vali Acc: 0.224 Test Loss: 99.842 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.3079142570495605
Epoch: 17, Steps: 17 | Train Loss: 43.988 Vali Loss: 126.816 Vali Acc: 0.232 Test Loss: 126.816 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.438422679901123
Epoch: 18, Steps: 17 | Train Loss: 49.844 Vali Loss: 148.768 Vali Acc: 0.259 Test Loss: 148.768 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.568270683288574
Epoch: 19, Steps: 17 | Train Loss: 26.703 Vali Loss: 184.944 Vali Acc: 0.243 Test Loss: 184.944 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 1491644
model size : 8.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.1911633014678955
Epoch: 1, Steps: 17 | Train Loss: 15.896 Vali Loss: 22.413 Vali Acc: 0.236 Test Loss: 22.413 Test Acc: 0.236
Validation loss decreased (inf --> -0.235517).  Saving model ...
Epoch: 2 cost time: 3.1938729286193848
Epoch: 2, Steps: 17 | Train Loss: 21.161 Vali Loss: 16.059 Vali Acc: 0.255 Test Loss: 16.059 Test Acc: 0.255
Validation loss decreased (-0.235517 --> -0.254592).  Saving model ...
Epoch: 3 cost time: 3.3055379390716553
Epoch: 3, Steps: 17 | Train Loss: 19.665 Vali Loss: 40.489 Vali Acc: 0.224 Test Loss: 40.489 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.834439516067505
Epoch: 4, Steps: 17 | Train Loss: 29.706 Vali Loss: 51.030 Vali Acc: 0.251 Test Loss: 51.030 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.5196051597595215
Epoch: 5, Steps: 17 | Train Loss: 36.818 Vali Loss: 64.478 Vali Acc: 0.251 Test Loss: 64.478 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.455559730529785
Epoch: 6, Steps: 17 | Train Loss: 28.176 Vali Loss: 69.355 Vali Acc: 0.232 Test Loss: 69.355 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.7586348056793213
Epoch: 7, Steps: 17 | Train Loss: 87.833 Vali Loss: 145.523 Vali Acc: 0.259 Test Loss: 145.523 Test Acc: 0.259
Validation loss decreased (-0.254592 --> -0.257100).  Saving model ...
Epoch: 8 cost time: 3.3685429096221924
Epoch: 8, Steps: 17 | Train Loss: 75.445 Vali Loss: 52.179 Vali Acc: 0.266 Test Loss: 52.179 Test Acc: 0.266
Validation loss decreased (-0.257100 --> -0.265638).  Saving model ...
Epoch: 9 cost time: 3.345989465713501
Epoch: 9, Steps: 17 | Train Loss: 46.529 Vali Loss: 90.004 Vali Acc: 0.259 Test Loss: 90.004 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3911101818084717
Epoch: 10, Steps: 17 | Train Loss: 48.972 Vali Loss: 137.636 Vali Acc: 0.255 Test Loss: 137.636 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.825448751449585
Epoch: 11, Steps: 17 | Train Loss: 50.332 Vali Loss: 155.910 Vali Acc: 0.255 Test Loss: 155.910 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.9326114654541016
Epoch: 12, Steps: 17 | Train Loss: 65.426 Vali Loss: 145.081 Vali Acc: 0.255 Test Loss: 145.081 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.0965957641601562
Epoch: 13, Steps: 17 | Train Loss: 37.535 Vali Loss: 53.611 Vali Acc: 0.251 Test Loss: 53.611 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.920715570449829
Epoch: 14, Steps: 17 | Train Loss: 21.128 Vali Loss: 67.079 Vali Acc: 0.247 Test Loss: 67.079 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.364431381225586
Epoch: 15, Steps: 17 | Train Loss: 27.388 Vali Loss: 71.469 Vali Acc: 0.274 Test Loss: 71.469 Test Acc: 0.274
Validation loss decreased (-0.265638 --> -0.273050).  Saving model ...
Epoch: 16 cost time: 3.688577651977539
Epoch: 16, Steps: 17 | Train Loss: 32.837 Vali Loss: 86.184 Vali Acc: 0.236 Test Loss: 86.184 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.473552942276001
Epoch: 17, Steps: 17 | Train Loss: 17.683 Vali Loss: 131.186 Vali Acc: 0.247 Test Loss: 131.186 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2388014793395996
Epoch: 18, Steps: 17 | Train Loss: 25.650 Vali Loss: 154.924 Vali Acc: 0.251 Test Loss: 154.924 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.12498140335083
Epoch: 19, Steps: 17 | Train Loss: 33.849 Vali Loss: 173.502 Vali Acc: 0.232 Test Loss: 173.502 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.544600486755371
Epoch: 20, Steps: 17 | Train Loss: 19.608 Vali Loss: 154.548 Vali Acc: 0.281 Test Loss: 154.548 Test Acc: 0.281
Validation loss decreased (-0.273050 --> -0.279823).  Saving model ...
Epoch: 21 cost time: 3.151540994644165
Epoch: 21, Steps: 17 | Train Loss: 20.786 Vali Loss: 217.948 Vali Acc: 0.278 Test Loss: 217.948 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.551697015762329
Epoch: 22, Steps: 17 | Train Loss: 21.047 Vali Loss: 181.625 Vali Acc: 0.270 Test Loss: 181.625 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.7244210243225098
Epoch: 23, Steps: 17 | Train Loss: 16.293 Vali Loss: 243.778 Vali Acc: 0.255 Test Loss: 243.778 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.669079542160034
Epoch: 24, Steps: 17 | Train Loss: 18.961 Vali Loss: 234.698 Vali Acc: 0.243 Test Loss: 234.698 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.3624348640441895
Epoch: 25, Steps: 17 | Train Loss: 7.388 Vali Loss: 256.095 Vali Acc: 0.240 Test Loss: 256.095 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.3343279361724854
Epoch: 26, Steps: 17 | Train Loss: 5.649 Vali Loss: 265.155 Vali Acc: 0.243 Test Loss: 265.155 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.5218212604522705
Epoch: 27, Steps: 17 | Train Loss: 9.470 Vali Loss: 269.253 Vali Acc: 0.217 Test Loss: 269.253 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.137406587600708
Epoch: 28, Steps: 17 | Train Loss: 6.832 Vali Loss: 287.165 Vali Acc: 0.232 Test Loss: 287.165 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.1803650856018066
Epoch: 29, Steps: 17 | Train Loss: 9.931 Vali Loss: 282.060 Vali Acc: 0.251 Test Loss: 282.060 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.1752378940582275
Epoch: 30, Steps: 17 | Train Loss: 10.756 Vali Loss: 336.350 Vali Acc: 0.224 Test Loss: 336.350 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1229500
model size : 7.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.5891993045806885
Epoch: 1, Steps: 17 | Train Loss: 18.955 Vali Loss: 24.269 Vali Acc: 0.266 Test Loss: 24.269 Test Acc: 0.266
Validation loss decreased (inf --> -0.265917).  Saving model ...
Epoch: 2 cost time: 3.102778434753418
Epoch: 2, Steps: 17 | Train Loss: 18.550 Vali Loss: 16.568 Vali Acc: 0.247 Test Loss: 16.568 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1479780673980713
Epoch: 3, Steps: 17 | Train Loss: 24.253 Vali Loss: 28.798 Vali Acc: 0.247 Test Loss: 28.798 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.143190383911133
Epoch: 4, Steps: 17 | Train Loss: 29.129 Vali Loss: 41.985 Vali Acc: 0.255 Test Loss: 41.985 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.4110867977142334
Epoch: 5, Steps: 17 | Train Loss: 48.964 Vali Loss: 47.350 Vali Acc: 0.274 Test Loss: 47.350 Test Acc: 0.274
Validation loss decreased (-0.265917 --> -0.273291).  Saving model ...
Epoch: 6 cost time: 3.2307050228118896
Epoch: 6, Steps: 17 | Train Loss: 39.932 Vali Loss: 61.431 Vali Acc: 0.243 Test Loss: 61.431 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.961291790008545
Epoch: 7, Steps: 17 | Train Loss: 38.602 Vali Loss: 64.187 Vali Acc: 0.232 Test Loss: 64.187 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2396535873413086
Epoch: 8, Steps: 17 | Train Loss: 48.583 Vali Loss: 51.026 Vali Acc: 0.262 Test Loss: 51.026 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.3359477519989014
Epoch: 9, Steps: 17 | Train Loss: 39.186 Vali Loss: 93.095 Vali Acc: 0.262 Test Loss: 93.095 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.2904880046844482
Epoch: 10, Steps: 17 | Train Loss: 39.434 Vali Loss: 113.659 Vali Acc: 0.262 Test Loss: 113.659 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.648099660873413
Epoch: 11, Steps: 17 | Train Loss: 31.042 Vali Loss: 51.800 Vali Acc: 0.281 Test Loss: 51.800 Test Acc: 0.281
Validation loss decreased (-0.273291 --> -0.280851).  Saving model ...
Epoch: 12 cost time: 3.60087513923645
Epoch: 12, Steps: 17 | Train Loss: 32.110 Vali Loss: 66.637 Vali Acc: 0.247 Test Loss: 66.637 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7018277645111084
Epoch: 13, Steps: 17 | Train Loss: 38.747 Vali Loss: 78.216 Vali Acc: 0.266 Test Loss: 78.216 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7810041904449463
Epoch: 14, Steps: 17 | Train Loss: 52.858 Vali Loss: 126.644 Vali Acc: 0.247 Test Loss: 126.644 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3928205966949463
Epoch: 15, Steps: 17 | Train Loss: 26.207 Vali Loss: 95.230 Vali Acc: 0.232 Test Loss: 95.230 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2828056812286377
Epoch: 16, Steps: 17 | Train Loss: 25.416 Vali Loss: 113.777 Vali Acc: 0.262 Test Loss: 113.777 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.688319206237793
Epoch: 17, Steps: 17 | Train Loss: 15.555 Vali Loss: 129.423 Vali Acc: 0.262 Test Loss: 129.423 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.49043345451355
Epoch: 18, Steps: 17 | Train Loss: 38.523 Vali Loss: 162.737 Vali Acc: 0.236 Test Loss: 162.737 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.197244644165039
Epoch: 19, Steps: 17 | Train Loss: 28.894 Vali Loss: 179.640 Vali Acc: 0.278 Test Loss: 179.640 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.4964001178741455
Epoch: 20, Steps: 17 | Train Loss: 20.376 Vali Loss: 132.548 Vali Acc: 0.255 Test Loss: 132.548 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.024570941925049
Epoch: 21, Steps: 17 | Train Loss: 10.393 Vali Loss: 162.655 Vali Acc: 0.243 Test Loss: 162.655 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1229500
model size : 7.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.015989542007446
Epoch: 1, Steps: 17 | Train Loss: 13.231 Vali Loss: 23.053 Vali Acc: 0.251 Test Loss: 23.053 Test Acc: 0.251
Validation loss decreased (inf --> -0.250720).  Saving model ...
Epoch: 2 cost time: 2.993929386138916
Epoch: 2, Steps: 17 | Train Loss: 21.268 Vali Loss: 44.168 Vali Acc: 0.247 Test Loss: 44.168 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.250563621520996
Epoch: 3, Steps: 17 | Train Loss: 43.923 Vali Loss: 38.339 Vali Acc: 0.259 Test Loss: 38.339 Test Acc: 0.259
Validation loss decreased (-0.250720 --> -0.258172).  Saving model ...
Epoch: 4 cost time: 3.124596118927002
Epoch: 4, Steps: 17 | Train Loss: 48.344 Vali Loss: 52.741 Vali Acc: 0.281 Test Loss: 52.741 Test Acc: 0.281
Validation loss decreased (-0.258172 --> -0.280841).  Saving model ...
Epoch: 5 cost time: 2.833359956741333
Epoch: 5, Steps: 17 | Train Loss: 46.824 Vali Loss: 59.503 Vali Acc: 0.240 Test Loss: 59.503 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.990217685699463
Epoch: 6, Steps: 17 | Train Loss: 37.191 Vali Loss: 67.073 Vali Acc: 0.247 Test Loss: 67.073 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7468645572662354
Epoch: 7, Steps: 17 | Train Loss: 33.307 Vali Loss: 56.062 Vali Acc: 0.270 Test Loss: 56.062 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9859092235565186
Epoch: 8, Steps: 17 | Train Loss: 35.339 Vali Loss: 88.348 Vali Acc: 0.224 Test Loss: 88.348 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.4811718463897705
Epoch: 9, Steps: 17 | Train Loss: 68.145 Vali Loss: 72.082 Vali Acc: 0.266 Test Loss: 72.082 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.009934663772583
Epoch: 10, Steps: 17 | Train Loss: 31.273 Vali Loss: 55.117 Vali Acc: 0.255 Test Loss: 55.117 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.9427754878997803
Epoch: 11, Steps: 17 | Train Loss: 31.786 Vali Loss: 68.925 Vali Acc: 0.274 Test Loss: 68.925 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.8693137168884277
Epoch: 12, Steps: 17 | Train Loss: 37.310 Vali Loss: 120.179 Vali Acc: 0.228 Test Loss: 120.179 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.1650002002716064
Epoch: 13, Steps: 17 | Train Loss: 45.851 Vali Loss: 99.916 Vali Acc: 0.266 Test Loss: 99.916 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.9693925380706787
Epoch: 14, Steps: 17 | Train Loss: 34.504 Vali Loss: 161.756 Vali Acc: 0.270 Test Loss: 161.756 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1229500
model size : 7.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.567692756652832
Epoch: 1, Steps: 17 | Train Loss: 12.561 Vali Loss: 43.351 Vali Acc: 0.247 Test Loss: 43.351 Test Acc: 0.247
Validation loss decreased (inf --> -0.246715).  Saving model ...
Epoch: 2 cost time: 2.7756855487823486
Epoch: 2, Steps: 17 | Train Loss: 39.943 Vali Loss: 73.413 Vali Acc: 0.251 Test Loss: 73.413 Test Acc: 0.251
Validation loss decreased (-0.246715 --> -0.250216).  Saving model ...
Epoch: 3 cost time: 3.0917487144470215
Epoch: 3, Steps: 17 | Train Loss: 57.569 Vali Loss: 70.181 Vali Acc: 0.251 Test Loss: 70.181 Test Acc: 0.251
Validation loss decreased (-0.250216 --> -0.250249).  Saving model ...
Epoch: 4 cost time: 2.7760262489318848
Epoch: 4, Steps: 17 | Train Loss: 52.490 Vali Loss: 78.667 Vali Acc: 0.259 Test Loss: 78.667 Test Acc: 0.259
Validation loss decreased (-0.250249 --> -0.257768).  Saving model ...
Epoch: 5 cost time: 2.624436140060425
Epoch: 5, Steps: 17 | Train Loss: 62.052 Vali Loss: 70.408 Vali Acc: 0.255 Test Loss: 70.408 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7314462661743164
Epoch: 6, Steps: 17 | Train Loss: 65.154 Vali Loss: 60.708 Vali Acc: 0.251 Test Loss: 60.708 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.972811698913574
Epoch: 7, Steps: 17 | Train Loss: 41.976 Vali Loss: 47.772 Vali Acc: 0.270 Test Loss: 47.772 Test Acc: 0.270
Validation loss decreased (-0.257768 --> -0.269484).  Saving model ...
Epoch: 8 cost time: 2.6529693603515625
Epoch: 8, Steps: 17 | Train Loss: 44.453 Vali Loss: 91.940 Vali Acc: 0.251 Test Loss: 91.940 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5576751232147217
Epoch: 9, Steps: 17 | Train Loss: 63.103 Vali Loss: 68.485 Vali Acc: 0.297 Test Loss: 68.485 Test Acc: 0.297
Validation loss decreased (-0.269484 --> -0.295893).  Saving model ...
Epoch: 10 cost time: 2.8950624465942383
Epoch: 10, Steps: 17 | Train Loss: 32.576 Vali Loss: 44.666 Vali Acc: 0.255 Test Loss: 44.666 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.662919282913208
Epoch: 11, Steps: 17 | Train Loss: 33.668 Vali Loss: 66.960 Vali Acc: 0.251 Test Loss: 66.960 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.901015520095825
Epoch: 12, Steps: 17 | Train Loss: 38.777 Vali Loss: 73.215 Vali Acc: 0.255 Test Loss: 73.215 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6698498725891113
Epoch: 13, Steps: 17 | Train Loss: 46.881 Vali Loss: 120.384 Vali Acc: 0.255 Test Loss: 120.384 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.9154469966888428
Epoch: 14, Steps: 17 | Train Loss: 36.319 Vali Loss: 106.616 Vali Acc: 0.236 Test Loss: 106.616 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.776615619659424
Epoch: 15, Steps: 17 | Train Loss: 31.327 Vali Loss: 130.712 Vali Acc: 0.274 Test Loss: 130.712 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7629804611206055
Epoch: 16, Steps: 17 | Train Loss: 23.296 Vali Loss: 111.588 Vali Acc: 0.224 Test Loss: 111.588 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.6123859882354736
Epoch: 17, Steps: 17 | Train Loss: 10.698 Vali Loss: 125.707 Vali Acc: 0.240 Test Loss: 125.707 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.448908805847168
Epoch: 18, Steps: 17 | Train Loss: 20.107 Vali Loss: 153.980 Vali Acc: 0.232 Test Loss: 153.980 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2952487468719482
Epoch: 19, Steps: 17 | Train Loss: 21.619 Vali Loss: 148.315 Vali Acc: 0.262 Test Loss: 148.315 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 1229500
model size : 7.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.6185622215271
Epoch: 1, Steps: 17 | Train Loss: 27.334 Vali Loss: 40.217 Vali Acc: 0.247 Test Loss: 40.217 Test Acc: 0.247
Validation loss decreased (inf --> -0.246746).  Saving model ...
Epoch: 2 cost time: 3.7742786407470703
Epoch: 2, Steps: 17 | Train Loss: 35.073 Vali Loss: 37.519 Vali Acc: 0.259 Test Loss: 37.519 Test Acc: 0.259
Validation loss decreased (-0.246746 --> -0.258180).  Saving model ...
Epoch: 3 cost time: 3.453068733215332
Epoch: 3, Steps: 17 | Train Loss: 27.050 Vali Loss: 25.975 Vali Acc: 0.278 Test Loss: 25.975 Test Acc: 0.278
Validation loss decreased (-0.258180 --> -0.277307).  Saving model ...
Epoch: 4 cost time: 3.467487335205078
Epoch: 4, Steps: 17 | Train Loss: 26.484 Vali Loss: 61.687 Vali Acc: 0.251 Test Loss: 61.687 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8675343990325928
Epoch: 5, Steps: 17 | Train Loss: 39.130 Vali Loss: 102.068 Vali Acc: 0.251 Test Loss: 102.068 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.504887342453003
Epoch: 6, Steps: 17 | Train Loss: 62.622 Vali Loss: 46.701 Vali Acc: 0.232 Test Loss: 46.701 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.4533939361572266
Epoch: 7, Steps: 17 | Train Loss: 45.026 Vali Loss: 163.963 Vali Acc: 0.240 Test Loss: 163.963 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.773625373840332
Epoch: 8, Steps: 17 | Train Loss: 63.665 Vali Loss: 75.683 Vali Acc: 0.243 Test Loss: 75.683 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.8217546939849854
Epoch: 9, Steps: 17 | Train Loss: 53.638 Vali Loss: 61.386 Vali Acc: 0.262 Test Loss: 61.386 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.7581350803375244
Epoch: 10, Steps: 17 | Train Loss: 25.148 Vali Loss: 53.777 Vali Acc: 0.251 Test Loss: 53.777 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.8503494262695312
Epoch: 11, Steps: 17 | Train Loss: 36.347 Vali Loss: 90.822 Vali Acc: 0.262 Test Loss: 90.822 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.874063014984131
Epoch: 12, Steps: 17 | Train Loss: 62.672 Vali Loss: 70.840 Vali Acc: 0.228 Test Loss: 70.840 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.4456100463867188
Epoch: 13, Steps: 17 | Train Loss: 43.924 Vali Loss: 93.966 Vali Acc: 0.259 Test Loss: 93.966 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 1098428
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.730547904968262
Epoch: 1, Steps: 17 | Train Loss: 30.122 Vali Loss: 65.369 Vali Acc: 0.247 Test Loss: 65.369 Test Acc: 0.247
Validation loss decreased (inf --> -0.246495).  Saving model ...
Epoch: 2 cost time: 3.128612995147705
Epoch: 2, Steps: 17 | Train Loss: 48.125 Vali Loss: 47.378 Vali Acc: 0.251 Test Loss: 47.378 Test Acc: 0.251
Validation loss decreased (-0.246495 --> -0.250477).  Saving model ...
Epoch: 3 cost time: 3.324537515640259
Epoch: 3, Steps: 17 | Train Loss: 41.116 Vali Loss: 56.206 Vali Acc: 0.251 Test Loss: 56.206 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.363722801208496
Epoch: 4, Steps: 17 | Train Loss: 36.887 Vali Loss: 22.105 Vali Acc: 0.236 Test Loss: 22.105 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9195303916931152
Epoch: 5, Steps: 17 | Train Loss: 52.882 Vali Loss: 94.028 Vali Acc: 0.251 Test Loss: 94.028 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.2368545532226562
Epoch: 6, Steps: 17 | Train Loss: 43.811 Vali Loss: 43.061 Vali Acc: 0.243 Test Loss: 43.061 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.127514362335205
Epoch: 7, Steps: 17 | Train Loss: 28.094 Vali Loss: 71.325 Vali Acc: 0.240 Test Loss: 71.325 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.2406888008117676
Epoch: 8, Steps: 17 | Train Loss: 62.229 Vali Loss: 77.293 Vali Acc: 0.247 Test Loss: 77.293 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.5902116298675537
Epoch: 9, Steps: 17 | Train Loss: 50.171 Vali Loss: 40.697 Vali Acc: 0.251 Test Loss: 40.697 Test Acc: 0.251
Validation loss decreased (-0.250477 --> -0.250544).  Saving model ...
Epoch: 10 cost time: 3.7827866077423096
Epoch: 10, Steps: 17 | Train Loss: 48.266 Vali Loss: 112.494 Vali Acc: 0.247 Test Loss: 112.494 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3157765865325928
Epoch: 11, Steps: 17 | Train Loss: 57.085 Vali Loss: 75.932 Vali Acc: 0.251 Test Loss: 75.932 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4662058353424072
Epoch: 12, Steps: 17 | Train Loss: 29.312 Vali Loss: 71.868 Vali Acc: 0.262 Test Loss: 71.868 Test Acc: 0.262
Validation loss decreased (-0.250544 --> -0.261639).  Saving model ...
Epoch: 13 cost time: 3.487029552459717
Epoch: 13, Steps: 17 | Train Loss: 37.077 Vali Loss: 98.719 Vali Acc: 0.243 Test Loss: 98.719 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.259007692337036
Epoch: 14, Steps: 17 | Train Loss: 43.580 Vali Loss: 89.382 Vali Acc: 0.247 Test Loss: 89.382 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.218083620071411
Epoch: 15, Steps: 17 | Train Loss: 26.732 Vali Loss: 160.354 Vali Acc: 0.278 Test Loss: 160.354 Test Acc: 0.278
Validation loss decreased (-0.261639 --> -0.275963).  Saving model ...
Epoch: 16 cost time: 3.2941300868988037
Epoch: 16, Steps: 17 | Train Loss: 55.777 Vali Loss: 95.701 Vali Acc: 0.247 Test Loss: 95.701 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2690846920013428
Epoch: 17, Steps: 17 | Train Loss: 22.371 Vali Loss: 131.306 Vali Acc: 0.259 Test Loss: 131.306 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3204848766326904
Epoch: 18, Steps: 17 | Train Loss: 33.620 Vali Loss: 199.011 Vali Acc: 0.266 Test Loss: 199.011 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.6413025856018066
Epoch: 19, Steps: 17 | Train Loss: 40.057 Vali Loss: 210.585 Vali Acc: 0.228 Test Loss: 210.585 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.5470645427703857
Epoch: 20, Steps: 17 | Train Loss: 29.852 Vali Loss: 187.615 Vali Acc: 0.232 Test Loss: 187.615 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.4225292205810547
Epoch: 21, Steps: 17 | Train Loss: 17.238 Vali Loss: 170.836 Vali Acc: 0.251 Test Loss: 170.836 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.758544921875
Epoch: 22, Steps: 17 | Train Loss: 20.636 Vali Loss: 195.170 Vali Acc: 0.236 Test Loss: 195.170 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.220327854156494
Epoch: 23, Steps: 17 | Train Loss: 13.574 Vali Loss: 229.648 Vali Acc: 0.259 Test Loss: 229.648 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.1733145713806152
Epoch: 24, Steps: 17 | Train Loss: 40.040 Vali Loss: 254.293 Vali Acc: 0.251 Test Loss: 254.293 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.5075576305389404
Epoch: 25, Steps: 17 | Train Loss: 43.403 Vali Loss: 262.488 Vali Acc: 0.262 Test Loss: 262.488 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 1098428
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.3550965785980225
Epoch: 1, Steps: 17 | Train Loss: 19.080 Vali Loss: 17.977 Vali Acc: 0.259 Test Loss: 17.977 Test Acc: 0.259
Validation loss decreased (inf --> -0.258375).  Saving model ...
Epoch: 2 cost time: 2.8845109939575195
Epoch: 2, Steps: 17 | Train Loss: 21.312 Vali Loss: 27.350 Vali Acc: 0.236 Test Loss: 27.350 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.749354600906372
Epoch: 3, Steps: 17 | Train Loss: 31.034 Vali Loss: 28.791 Vali Acc: 0.278 Test Loss: 28.791 Test Acc: 0.278
Validation loss decreased (-0.258375 --> -0.277279).  Saving model ...
Epoch: 4 cost time: 2.8823904991149902
Epoch: 4, Steps: 17 | Train Loss: 40.763 Vali Loss: 85.889 Vali Acc: 0.251 Test Loss: 85.889 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1681911945343018
Epoch: 5, Steps: 17 | Train Loss: 35.713 Vali Loss: 39.590 Vali Acc: 0.266 Test Loss: 39.590 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.740370750427246
Epoch: 6, Steps: 17 | Train Loss: 60.423 Vali Loss: 68.508 Vali Acc: 0.243 Test Loss: 68.508 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8395884037017822
Epoch: 7, Steps: 17 | Train Loss: 56.340 Vali Loss: 79.137 Vali Acc: 0.251 Test Loss: 79.137 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.9121334552764893
Epoch: 8, Steps: 17 | Train Loss: 60.208 Vali Loss: 101.917 Vali Acc: 0.243 Test Loss: 101.917 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.1866343021392822
Epoch: 9, Steps: 17 | Train Loss: 63.760 Vali Loss: 58.428 Vali Acc: 0.251 Test Loss: 58.428 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.8780860900878906
Epoch: 10, Steps: 17 | Train Loss: 72.501 Vali Loss: 115.112 Vali Acc: 0.262 Test Loss: 115.112 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.040686845779419
Epoch: 11, Steps: 17 | Train Loss: 70.380 Vali Loss: 60.793 Vali Acc: 0.262 Test Loss: 60.793 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.2431347370147705
Epoch: 12, Steps: 17 | Train Loss: 36.653 Vali Loss: 64.553 Vali Acc: 0.236 Test Loss: 64.553 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.0924699306488037
Epoch: 13, Steps: 17 | Train Loss: 20.729 Vali Loss: 59.476 Vali Acc: 0.266 Test Loss: 59.476 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 1098428
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.260613203048706
Epoch: 1, Steps: 17 | Train Loss: 26.894 Vali Loss: 51.720 Vali Acc: 0.247 Test Loss: 51.720 Test Acc: 0.247
Validation loss decreased (inf --> -0.246631).  Saving model ...
Epoch: 2 cost time: 2.4281630516052246
Epoch: 2, Steps: 17 | Train Loss: 43.700 Vali Loss: 26.138 Vali Acc: 0.262 Test Loss: 26.138 Test Acc: 0.262
Validation loss decreased (-0.246631 --> -0.262096).  Saving model ...
Epoch: 3 cost time: 2.4539072513580322
Epoch: 3, Steps: 17 | Train Loss: 34.812 Vali Loss: 55.886 Vali Acc: 0.255 Test Loss: 55.886 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.118896484375
Epoch: 4, Steps: 17 | Train Loss: 35.303 Vali Loss: 51.952 Vali Acc: 0.251 Test Loss: 51.952 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.637502431869507
Epoch: 5, Steps: 17 | Train Loss: 35.110 Vali Loss: 46.775 Vali Acc: 0.243 Test Loss: 46.775 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7527546882629395
Epoch: 6, Steps: 17 | Train Loss: 39.735 Vali Loss: 43.843 Vali Acc: 0.236 Test Loss: 43.843 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.9866135120391846
Epoch: 7, Steps: 17 | Train Loss: 41.185 Vali Loss: 78.139 Vali Acc: 0.247 Test Loss: 78.139 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.668694496154785
Epoch: 8, Steps: 17 | Train Loss: 51.170 Vali Loss: 49.257 Vali Acc: 0.247 Test Loss: 49.257 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.383901834487915
Epoch: 9, Steps: 17 | Train Loss: 43.529 Vali Loss: 51.873 Vali Acc: 0.255 Test Loss: 51.873 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.4236788749694824
Epoch: 10, Steps: 17 | Train Loss: 29.216 Vali Loss: 80.186 Vali Acc: 0.259 Test Loss: 80.186 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.737703800201416
Epoch: 11, Steps: 17 | Train Loss: 22.620 Vali Loss: 74.392 Vali Acc: 0.247 Test Loss: 74.392 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.5581741333007812
Epoch: 12, Steps: 17 | Train Loss: 31.138 Vali Loss: 67.193 Vali Acc: 0.247 Test Loss: 67.193 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 1098428
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.724616765975952
Epoch: 1, Steps: 17 | Train Loss: 15.919 Vali Loss: 32.541 Vali Acc: 0.243 Test Loss: 32.541 Test Acc: 0.243
Validation loss decreased (inf --> -0.243021).  Saving model ...
Epoch: 2 cost time: 2.906388282775879
Epoch: 2, Steps: 17 | Train Loss: 22.376 Vali Loss: 27.855 Vali Acc: 0.255 Test Loss: 27.855 Test Acc: 0.255
Validation loss decreased (-0.243021 --> -0.254474).  Saving model ...
Epoch: 3 cost time: 3.586540699005127
Epoch: 3, Steps: 17 | Train Loss: 30.246 Vali Loss: 17.983 Vali Acc: 0.221 Test Loss: 17.983 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3190770149230957
Epoch: 4, Steps: 17 | Train Loss: 46.847 Vali Loss: 85.756 Vali Acc: 0.247 Test Loss: 85.756 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.5992929935455322
Epoch: 5, Steps: 17 | Train Loss: 79.816 Vali Loss: 122.371 Vali Acc: 0.247 Test Loss: 122.371 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.65490984916687
Epoch: 6, Steps: 17 | Train Loss: 69.831 Vali Loss: 49.568 Vali Acc: 0.266 Test Loss: 49.568 Test Acc: 0.266
Validation loss decreased (-0.254474 --> -0.265664).  Saving model ...
Epoch: 7 cost time: 3.4637138843536377
Epoch: 7, Steps: 17 | Train Loss: 55.645 Vali Loss: 54.799 Vali Acc: 0.259 Test Loss: 54.799 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9881889820098877
Epoch: 8, Steps: 17 | Train Loss: 46.621 Vali Loss: 77.894 Vali Acc: 0.255 Test Loss: 77.894 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.513763904571533
Epoch: 9, Steps: 17 | Train Loss: 51.432 Vali Loss: 77.042 Vali Acc: 0.243 Test Loss: 77.042 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.7106754779815674
Epoch: 10, Steps: 17 | Train Loss: 65.503 Vali Loss: 87.281 Vali Acc: 0.259 Test Loss: 87.281 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.2332069873809814
Epoch: 11, Steps: 17 | Train Loss: 55.802 Vali Loss: 57.922 Vali Acc: 0.243 Test Loss: 57.922 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.061795473098755
Epoch: 12, Steps: 17 | Train Loss: 38.282 Vali Loss: 79.019 Vali Acc: 0.232 Test Loss: 79.019 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.8674633502960205
Epoch: 13, Steps: 17 | Train Loss: 36.869 Vali Loss: 78.864 Vali Acc: 0.236 Test Loss: 78.864 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.891521692276001
Epoch: 14, Steps: 17 | Train Loss: 36.338 Vali Loss: 96.577 Vali Acc: 0.243 Test Loss: 96.577 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.736909866333008
Epoch: 15, Steps: 17 | Train Loss: 39.322 Vali Loss: 97.696 Vali Acc: 0.224 Test Loss: 97.696 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.8924224376678467
Epoch: 16, Steps: 17 | Train Loss: 22.846 Vali Loss: 85.573 Vali Acc: 0.259 Test Loss: 85.573 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 1032892
model size : 6.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.490827798843384
Epoch: 1, Steps: 17 | Train Loss: 15.844 Vali Loss: 39.398 Vali Acc: 0.251 Test Loss: 39.398 Test Acc: 0.251
Validation loss decreased (inf --> -0.250557).  Saving model ...
Epoch: 2 cost time: 3.171973705291748
Epoch: 2, Steps: 17 | Train Loss: 30.633 Vali Loss: 55.140 Vali Acc: 0.255 Test Loss: 55.140 Test Acc: 0.255
Validation loss decreased (-0.250557 --> -0.254201).  Saving model ...
Epoch: 3 cost time: 2.99859356880188
Epoch: 3, Steps: 17 | Train Loss: 48.482 Vali Loss: 33.298 Vali Acc: 0.266 Test Loss: 33.298 Test Acc: 0.266
Validation loss decreased (-0.254201 --> -0.265827).  Saving model ...
Epoch: 4 cost time: 3.2162935733795166
Epoch: 4, Steps: 17 | Train Loss: 46.732 Vali Loss: 44.138 Vali Acc: 0.243 Test Loss: 44.138 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.311232566833496
Epoch: 5, Steps: 17 | Train Loss: 28.032 Vali Loss: 49.254 Vali Acc: 0.255 Test Loss: 49.254 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.936924934387207
Epoch: 6, Steps: 17 | Train Loss: 40.003 Vali Loss: 75.645 Vali Acc: 0.243 Test Loss: 75.645 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.17155385017395
Epoch: 7, Steps: 17 | Train Loss: 52.526 Vali Loss: 71.179 Vali Acc: 0.255 Test Loss: 71.179 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.38981294631958
Epoch: 8, Steps: 17 | Train Loss: 52.692 Vali Loss: 111.570 Vali Acc: 0.243 Test Loss: 111.570 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.5571038722991943
Epoch: 9, Steps: 17 | Train Loss: 80.978 Vali Loss: 98.297 Vali Acc: 0.247 Test Loss: 98.297 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.7726902961730957
Epoch: 10, Steps: 17 | Train Loss: 47.805 Vali Loss: 77.321 Vali Acc: 0.255 Test Loss: 77.321 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.6796655654907227
Epoch: 11, Steps: 17 | Train Loss: 39.471 Vali Loss: 42.870 Vali Acc: 0.251 Test Loss: 42.870 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.485982894897461
Epoch: 12, Steps: 17 | Train Loss: 32.351 Vali Loss: 46.574 Vali Acc: 0.274 Test Loss: 46.574 Test Acc: 0.274
Validation loss decreased (-0.265827 --> -0.273299).  Saving model ...
Epoch: 13 cost time: 3.4001333713531494
Epoch: 13, Steps: 17 | Train Loss: 40.583 Vali Loss: 63.113 Vali Acc: 0.217 Test Loss: 63.113 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4210569858551025
Epoch: 14, Steps: 17 | Train Loss: 32.160 Vali Loss: 172.496 Vali Acc: 0.247 Test Loss: 172.496 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.897658348083496
Epoch: 15, Steps: 17 | Train Loss: 37.705 Vali Loss: 104.987 Vali Acc: 0.266 Test Loss: 104.987 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.914271116256714
Epoch: 16, Steps: 17 | Train Loss: 39.684 Vali Loss: 141.144 Vali Acc: 0.274 Test Loss: 141.144 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.7879953384399414
Epoch: 17, Steps: 17 | Train Loss: 46.289 Vali Loss: 143.897 Vali Acc: 0.232 Test Loss: 143.897 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.333338737487793
Epoch: 18, Steps: 17 | Train Loss: 20.120 Vali Loss: 136.586 Vali Acc: 0.278 Test Loss: 136.586 Test Acc: 0.278
Validation loss decreased (-0.273299 --> -0.276201).  Saving model ...
Epoch: 19 cost time: 3.395099639892578
Epoch: 19, Steps: 17 | Train Loss: 10.606 Vali Loss: 184.654 Vali Acc: 0.266 Test Loss: 184.654 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.772813081741333
Epoch: 20, Steps: 17 | Train Loss: 35.680 Vali Loss: 168.854 Vali Acc: 0.266 Test Loss: 168.854 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.279402732849121
Epoch: 21, Steps: 17 | Train Loss: 36.896 Vali Loss: 176.990 Vali Acc: 0.232 Test Loss: 176.990 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.415600538253784
Epoch: 22, Steps: 17 | Train Loss: 29.286 Vali Loss: 243.278 Vali Acc: 0.228 Test Loss: 243.278 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.358119249343872
Epoch: 23, Steps: 17 | Train Loss: 20.618 Vali Loss: 202.509 Vali Acc: 0.266 Test Loss: 202.509 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.2788517475128174
Epoch: 24, Steps: 17 | Train Loss: 12.316 Vali Loss: 239.141 Vali Acc: 0.232 Test Loss: 239.141 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.4989755153656006
Epoch: 25, Steps: 17 | Train Loss: 6.012 Vali Loss: 237.447 Vali Acc: 0.259 Test Loss: 237.447 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.488076686859131
Epoch: 26, Steps: 17 | Train Loss: 19.756 Vali Loss: 299.037 Vali Acc: 0.262 Test Loss: 299.037 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.590980291366577
Epoch: 27, Steps: 17 | Train Loss: 17.471 Vali Loss: 363.093 Vali Acc: 0.259 Test Loss: 363.093 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.670957565307617
Epoch: 28, Steps: 17 | Train Loss: 21.807 Vali Loss: 350.921 Vali Acc: 0.240 Test Loss: 350.921 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 1032892
model size : 6.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.679405927658081
Epoch: 1, Steps: 17 | Train Loss: 19.061 Vali Loss: 42.516 Vali Acc: 0.251 Test Loss: 42.516 Test Acc: 0.251
Validation loss decreased (inf --> -0.250525).  Saving model ...
Epoch: 2 cost time: 2.6388137340545654
Epoch: 2, Steps: 17 | Train Loss: 30.231 Vali Loss: 28.591 Vali Acc: 0.266 Test Loss: 28.591 Test Acc: 0.266
Validation loss decreased (-0.250525 --> -0.265874).  Saving model ...
Epoch: 3 cost time: 3.1430914402008057
Epoch: 3, Steps: 17 | Train Loss: 35.030 Vali Loss: 46.404 Vali Acc: 0.243 Test Loss: 46.404 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1430344581604004
Epoch: 4, Steps: 17 | Train Loss: 29.954 Vali Loss: 22.603 Vali Acc: 0.262 Test Loss: 22.603 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.8271970748901367
Epoch: 5, Steps: 17 | Train Loss: 29.056 Vali Loss: 75.092 Vali Acc: 0.251 Test Loss: 75.092 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6804544925689697
Epoch: 6, Steps: 17 | Train Loss: 46.533 Vali Loss: 76.216 Vali Acc: 0.251 Test Loss: 76.216 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.021401882171631
Epoch: 7, Steps: 17 | Train Loss: 51.230 Vali Loss: 93.558 Vali Acc: 0.243 Test Loss: 93.558 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.894150733947754
Epoch: 8, Steps: 17 | Train Loss: 45.102 Vali Loss: 75.556 Vali Acc: 0.251 Test Loss: 75.556 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.67620587348938
Epoch: 9, Steps: 17 | Train Loss: 79.600 Vali Loss: 54.573 Vali Acc: 0.243 Test Loss: 54.573 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.90739369392395
Epoch: 10, Steps: 17 | Train Loss: 48.232 Vali Loss: 61.781 Vali Acc: 0.243 Test Loss: 61.781 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8996994495391846
Epoch: 11, Steps: 17 | Train Loss: 34.241 Vali Loss: 58.685 Vali Acc: 0.243 Test Loss: 58.685 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.852277994155884
Epoch: 12, Steps: 17 | Train Loss: 23.956 Vali Loss: 43.473 Vali Acc: 0.243 Test Loss: 43.473 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 1032892
model size : 6.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.282585144042969
Epoch: 1, Steps: 17 | Train Loss: 13.006 Vali Loss: 23.726 Vali Acc: 0.243 Test Loss: 23.726 Test Acc: 0.243
Validation loss decreased (inf --> -0.243109).  Saving model ...
Epoch: 2 cost time: 2.3815383911132812
Epoch: 2, Steps: 17 | Train Loss: 14.654 Vali Loss: 40.566 Vali Acc: 0.247 Test Loss: 40.566 Test Acc: 0.247
Validation loss decreased (-0.243109 --> -0.246743).  Saving model ...
Epoch: 3 cost time: 2.746778726577759
Epoch: 3, Steps: 17 | Train Loss: 39.015 Vali Loss: 52.024 Vali Acc: 0.255 Test Loss: 52.024 Test Acc: 0.255
Validation loss decreased (-0.246743 --> -0.254233).  Saving model ...
Epoch: 4 cost time: 2.6148996353149414
Epoch: 4, Steps: 17 | Train Loss: 48.840 Vali Loss: 121.032 Vali Acc: 0.255 Test Loss: 121.032 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.335282802581787
Epoch: 5, Steps: 17 | Train Loss: 63.124 Vali Loss: 81.002 Vali Acc: 0.270 Test Loss: 81.002 Test Acc: 0.270
Validation loss decreased (-0.254233 --> -0.269152).  Saving model ...
Epoch: 6 cost time: 2.745081901550293
Epoch: 6, Steps: 17 | Train Loss: 72.131 Vali Loss: 45.381 Vali Acc: 0.247 Test Loss: 45.381 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9706993103027344
Epoch: 7, Steps: 17 | Train Loss: 67.813 Vali Loss: 40.905 Vali Acc: 0.293 Test Loss: 40.905 Test Acc: 0.293
Validation loss decreased (-0.269152 --> -0.292367).  Saving model ...
Epoch: 8 cost time: 2.6108386516571045
Epoch: 8, Steps: 17 | Train Loss: 33.848 Vali Loss: 66.343 Vali Acc: 0.243 Test Loss: 66.343 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.752596139907837
Epoch: 9, Steps: 17 | Train Loss: 51.813 Vali Loss: 41.479 Vali Acc: 0.262 Test Loss: 41.479 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.786883592605591
Epoch: 10, Steps: 17 | Train Loss: 39.176 Vali Loss: 86.142 Vali Acc: 0.255 Test Loss: 86.142 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.399991035461426
Epoch: 11, Steps: 17 | Train Loss: 35.888 Vali Loss: 52.376 Vali Acc: 0.251 Test Loss: 52.376 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5096933841705322
Epoch: 12, Steps: 17 | Train Loss: 12.854 Vali Loss: 56.219 Vali Acc: 0.259 Test Loss: 56.219 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7426884174346924
Epoch: 13, Steps: 17 | Train Loss: 21.229 Vali Loss: 75.208 Vali Acc: 0.262 Test Loss: 75.208 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.661578893661499
Epoch: 14, Steps: 17 | Train Loss: 33.702 Vali Loss: 57.927 Vali Acc: 0.274 Test Loss: 57.927 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.374943256378174
Epoch: 15, Steps: 17 | Train Loss: 15.353 Vali Loss: 106.952 Vali Acc: 0.304 Test Loss: 106.952 Test Acc: 0.304
Validation loss decreased (-0.292367 --> -0.303113).  Saving model ...
Epoch: 16 cost time: 2.497467279434204
Epoch: 16, Steps: 17 | Train Loss: 33.917 Vali Loss: 107.682 Vali Acc: 0.266 Test Loss: 107.682 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.761995315551758
Epoch: 17, Steps: 17 | Train Loss: 28.319 Vali Loss: 121.686 Vali Acc: 0.255 Test Loss: 121.686 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.397510290145874
Epoch: 18, Steps: 17 | Train Loss: 25.425 Vali Loss: 165.814 Vali Acc: 0.270 Test Loss: 165.814 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.446772336959839
Epoch: 19, Steps: 17 | Train Loss: 23.556 Vali Loss: 176.389 Vali Acc: 0.247 Test Loss: 176.389 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.4345881938934326
Epoch: 20, Steps: 17 | Train Loss: 10.625 Vali Loss: 171.435 Vali Acc: 0.243 Test Loss: 171.435 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.8272039890289307
Epoch: 21, Steps: 17 | Train Loss: 24.988 Vali Loss: 221.934 Vali Acc: 0.224 Test Loss: 221.934 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.597506523132324
Epoch: 22, Steps: 17 | Train Loss: 15.060 Vali Loss: 202.145 Vali Acc: 0.228 Test Loss: 202.145 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.549273729324341
Epoch: 23, Steps: 17 | Train Loss: 10.643 Vali Loss: 231.078 Vali Acc: 0.251 Test Loss: 231.078 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.5444588661193848
Epoch: 24, Steps: 17 | Train Loss: 6.622 Vali Loss: 244.313 Vali Acc: 0.213 Test Loss: 244.313 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.8071792125701904
Epoch: 25, Steps: 17 | Train Loss: 10.335 Vali Loss: 281.334 Vali Acc: 0.255 Test Loss: 281.334 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 1032892
model size : 6.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.192060470581055
Epoch: 1, Steps: 17 | Train Loss: 28.925 Vali Loss: 58.761 Vali Acc: 0.251 Test Loss: 58.761 Test Acc: 0.251
Validation loss decreased (inf --> -0.250363).  Saving model ...
Epoch: 2 cost time: 3.2407352924346924
Epoch: 2, Steps: 17 | Train Loss: 31.998 Vali Loss: 36.530 Vali Acc: 0.259 Test Loss: 36.530 Test Acc: 0.259
Validation loss decreased (-0.250363 --> -0.258190).  Saving model ...
Epoch: 3 cost time: 3.098963975906372
Epoch: 3, Steps: 17 | Train Loss: 25.727 Vali Loss: 49.373 Vali Acc: 0.251 Test Loss: 49.373 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.394491672515869
Epoch: 4, Steps: 17 | Train Loss: 32.832 Vali Loss: 46.541 Vali Acc: 0.240 Test Loss: 46.541 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1156463623046875
Epoch: 5, Steps: 17 | Train Loss: 29.415 Vali Loss: 72.583 Vali Acc: 0.259 Test Loss: 72.583 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.121041774749756
Epoch: 6, Steps: 17 | Train Loss: 67.354 Vali Loss: 96.959 Vali Acc: 0.251 Test Loss: 96.959 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.4802935123443604
Epoch: 7, Steps: 17 | Train Loss: 54.226 Vali Loss: 47.307 Vali Acc: 0.259 Test Loss: 47.307 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9935648441314697
Epoch: 8, Steps: 17 | Train Loss: 36.547 Vali Loss: 37.940 Vali Acc: 0.278 Test Loss: 37.940 Test Acc: 0.278
Validation loss decreased (-0.258190 --> -0.277187).  Saving model ...
Epoch: 9 cost time: 2.888343334197998
Epoch: 9, Steps: 17 | Train Loss: 29.540 Vali Loss: 44.650 Vali Acc: 0.240 Test Loss: 44.650 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.914585590362549
Epoch: 10, Steps: 17 | Train Loss: 42.614 Vali Loss: 99.551 Vali Acc: 0.255 Test Loss: 99.551 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.19726300239563
Epoch: 11, Steps: 17 | Train Loss: 35.368 Vali Loss: 76.264 Vali Acc: 0.247 Test Loss: 76.264 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8509247303009033
Epoch: 12, Steps: 17 | Train Loss: 35.052 Vali Loss: 78.144 Vali Acc: 0.266 Test Loss: 78.144 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.8993475437164307
Epoch: 13, Steps: 17 | Train Loss: 31.460 Vali Loss: 151.689 Vali Acc: 0.270 Test Loss: 151.689 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.6569361686706543
Epoch: 14, Steps: 17 | Train Loss: 47.222 Vali Loss: 138.676 Vali Acc: 0.259 Test Loss: 138.676 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.2745513916015625
Epoch: 15, Steps: 17 | Train Loss: 50.586 Vali Loss: 134.359 Vali Acc: 0.247 Test Loss: 134.359 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.2272701263427734
Epoch: 16, Steps: 17 | Train Loss: 28.645 Vali Loss: 111.057 Vali Acc: 0.266 Test Loss: 111.057 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.773526668548584
Epoch: 17, Steps: 17 | Train Loss: 15.806 Vali Loss: 99.769 Vali Acc: 0.297 Test Loss: 99.769 Test Acc: 0.297
Validation loss decreased (-0.277187 --> -0.295580).  Saving model ...
Epoch: 18 cost time: 3.290457010269165
Epoch: 18, Steps: 17 | Train Loss: 23.866 Vali Loss: 124.574 Vali Acc: 0.236 Test Loss: 124.574 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.124718189239502
Epoch: 19, Steps: 17 | Train Loss: 17.098 Vali Loss: 118.281 Vali Acc: 0.259 Test Loss: 118.281 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.4788756370544434
Epoch: 20, Steps: 17 | Train Loss: 18.840 Vali Loss: 136.353 Vali Acc: 0.278 Test Loss: 136.353 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.99819016456604
Epoch: 21, Steps: 17 | Train Loss: 25.191 Vali Loss: 147.873 Vali Acc: 0.255 Test Loss: 147.873 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.4240570068359375
Epoch: 22, Steps: 17 | Train Loss: 16.474 Vali Loss: 196.807 Vali Acc: 0.255 Test Loss: 196.807 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.6038007736206055
Epoch: 23, Steps: 17 | Train Loss: 18.431 Vali Loss: 212.287 Vali Acc: 0.224 Test Loss: 212.287 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.394071578979492
Epoch: 24, Steps: 17 | Train Loss: 9.691 Vali Loss: 202.876 Vali Acc: 0.228 Test Loss: 202.876 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.4705893993377686
Epoch: 25, Steps: 17 | Train Loss: 12.704 Vali Loss: 230.002 Vali Acc: 0.274 Test Loss: 230.002 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.42566180229187
Epoch: 26, Steps: 17 | Train Loss: 6.428 Vali Loss: 230.080 Vali Acc: 0.224 Test Loss: 230.080 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.0229201316833496
Epoch: 27, Steps: 17 | Train Loss: 9.097 Vali Loss: 252.971 Vali Acc: 0.240 Test Loss: 252.971 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 1000124
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.4644646644592285
Epoch: 1, Steps: 17 | Train Loss: 33.229 Vali Loss: 15.660 Vali Acc: 0.247 Test Loss: 15.660 Test Acc: 0.247
Validation loss decreased (inf --> -0.246992).  Saving model ...
Epoch: 2 cost time: 2.9214816093444824
Epoch: 2, Steps: 17 | Train Loss: 50.334 Vali Loss: 57.842 Vali Acc: 0.255 Test Loss: 57.842 Test Acc: 0.255
Validation loss decreased (-0.246992 --> -0.254174).  Saving model ...
Epoch: 3 cost time: 3.328014850616455
Epoch: 3, Steps: 17 | Train Loss: 38.624 Vali Loss: 30.092 Vali Acc: 0.247 Test Loss: 30.092 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1592047214508057
Epoch: 4, Steps: 17 | Train Loss: 35.804 Vali Loss: 48.886 Vali Acc: 0.259 Test Loss: 48.886 Test Acc: 0.259
Validation loss decreased (-0.254174 --> -0.258066).  Saving model ...
Epoch: 5 cost time: 2.961862564086914
Epoch: 5, Steps: 17 | Train Loss: 31.003 Vali Loss: 48.136 Vali Acc: 0.266 Test Loss: 48.136 Test Acc: 0.266
Validation loss decreased (-0.258066 --> -0.265678).  Saving model ...
Epoch: 6 cost time: 2.6654295921325684
Epoch: 6, Steps: 17 | Train Loss: 72.174 Vali Loss: 84.452 Vali Acc: 0.251 Test Loss: 84.452 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0576789379119873
Epoch: 7, Steps: 17 | Train Loss: 42.722 Vali Loss: 63.374 Vali Acc: 0.255 Test Loss: 63.374 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.464641571044922
Epoch: 8, Steps: 17 | Train Loss: 57.280 Vali Loss: 64.243 Vali Acc: 0.247 Test Loss: 64.243 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.1126749515533447
Epoch: 9, Steps: 17 | Train Loss: 39.142 Vali Loss: 82.047 Vali Acc: 0.255 Test Loss: 82.047 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.250830888748169
Epoch: 10, Steps: 17 | Train Loss: 53.558 Vali Loss: 34.721 Vali Acc: 0.228 Test Loss: 34.721 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.1357953548431396
Epoch: 11, Steps: 17 | Train Loss: 52.338 Vali Loss: 81.720 Vali Acc: 0.240 Test Loss: 81.720 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.9296841621398926
Epoch: 12, Steps: 17 | Train Loss: 38.591 Vali Loss: 94.313 Vali Acc: 0.240 Test Loss: 94.313 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.3690567016601562
Epoch: 13, Steps: 17 | Train Loss: 22.396 Vali Loss: 91.415 Vali Acc: 0.266 Test Loss: 91.415 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.2465028762817383
Epoch: 14, Steps: 17 | Train Loss: 34.665 Vali Loss: 77.279 Vali Acc: 0.247 Test Loss: 77.279 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.11958646774292
Epoch: 15, Steps: 17 | Train Loss: 21.681 Vali Loss: 106.947 Vali Acc: 0.266 Test Loss: 106.947 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 1000124
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.935842514038086
Epoch: 1, Steps: 17 | Train Loss: 28.861 Vali Loss: 63.455 Vali Acc: 0.247 Test Loss: 63.455 Test Acc: 0.247
Validation loss decreased (inf --> -0.246514).  Saving model ...
Epoch: 2 cost time: 2.660151958465576
Epoch: 2, Steps: 17 | Train Loss: 36.188 Vali Loss: 43.779 Vali Acc: 0.259 Test Loss: 43.779 Test Acc: 0.259
Validation loss decreased (-0.246514 --> -0.258117).  Saving model ...
Epoch: 3 cost time: 2.7461163997650146
Epoch: 3, Steps: 17 | Train Loss: 46.361 Vali Loss: 36.542 Vali Acc: 0.236 Test Loss: 36.542 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9159255027770996
Epoch: 4, Steps: 17 | Train Loss: 34.137 Vali Loss: 14.968 Vali Acc: 0.255 Test Loss: 14.968 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.898683786392212
Epoch: 5, Steps: 17 | Train Loss: 27.045 Vali Loss: 34.382 Vali Acc: 0.236 Test Loss: 34.382 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8942391872406006
Epoch: 6, Steps: 17 | Train Loss: 45.608 Vali Loss: 43.254 Vali Acc: 0.266 Test Loss: 43.254 Test Acc: 0.266
Validation loss decreased (-0.258117 --> -0.265727).  Saving model ...
Epoch: 7 cost time: 3.2231192588806152
Epoch: 7, Steps: 17 | Train Loss: 43.907 Vali Loss: 79.379 Vali Acc: 0.247 Test Loss: 79.379 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.128835439682007
Epoch: 8, Steps: 17 | Train Loss: 48.822 Vali Loss: 37.682 Vali Acc: 0.243 Test Loss: 37.682 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.76163387298584
Epoch: 9, Steps: 17 | Train Loss: 33.955 Vali Loss: 53.651 Vali Acc: 0.232 Test Loss: 53.651 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8691108226776123
Epoch: 10, Steps: 17 | Train Loss: 45.041 Vali Loss: 126.266 Vali Acc: 0.251 Test Loss: 126.266 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.785585880279541
Epoch: 11, Steps: 17 | Train Loss: 47.447 Vali Loss: 95.212 Vali Acc: 0.247 Test Loss: 95.212 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.217115879058838
Epoch: 12, Steps: 17 | Train Loss: 60.719 Vali Loss: 180.554 Vali Acc: 0.247 Test Loss: 180.554 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.12563157081604
Epoch: 13, Steps: 17 | Train Loss: 40.190 Vali Loss: 86.570 Vali Acc: 0.247 Test Loss: 86.570 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.039677381515503
Epoch: 14, Steps: 17 | Train Loss: 24.995 Vali Loss: 99.973 Vali Acc: 0.236 Test Loss: 99.973 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.274350166320801
Epoch: 15, Steps: 17 | Train Loss: 30.246 Vali Loss: 126.833 Vali Acc: 0.243 Test Loss: 126.833 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.0394482612609863
Epoch: 16, Steps: 17 | Train Loss: 31.943 Vali Loss: 102.855 Vali Acc: 0.236 Test Loss: 102.855 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 1000124
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.0557708740234375
Epoch: 1, Steps: 17 | Train Loss: 18.925 Vali Loss: 29.305 Vali Acc: 0.251 Test Loss: 29.305 Test Acc: 0.251
Validation loss decreased (inf --> -0.250658).  Saving model ...
Epoch: 2 cost time: 2.2506730556488037
Epoch: 2, Steps: 17 | Train Loss: 23.463 Vali Loss: 37.747 Vali Acc: 0.251 Test Loss: 37.747 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.773770809173584
Epoch: 3, Steps: 17 | Train Loss: 34.458 Vali Loss: 28.319 Vali Acc: 0.251 Test Loss: 28.319 Test Acc: 0.251
Validation loss decreased (-0.250658 --> -0.250667).  Saving model ...
Epoch: 4 cost time: 2.591501235961914
Epoch: 4, Steps: 17 | Train Loss: 38.152 Vali Loss: 51.883 Vali Acc: 0.243 Test Loss: 51.883 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9095723628997803
Epoch: 5, Steps: 17 | Train Loss: 59.262 Vali Loss: 46.848 Vali Acc: 0.259 Test Loss: 46.848 Test Acc: 0.259
Validation loss decreased (-0.250667 --> -0.258087).  Saving model ...
Epoch: 6 cost time: 2.885780096054077
Epoch: 6, Steps: 17 | Train Loss: 33.780 Vali Loss: 53.719 Vali Acc: 0.251 Test Loss: 53.719 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4780685901641846
Epoch: 7, Steps: 17 | Train Loss: 51.483 Vali Loss: 74.608 Vali Acc: 0.251 Test Loss: 74.608 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4828126430511475
Epoch: 8, Steps: 17 | Train Loss: 32.548 Vali Loss: 102.830 Vali Acc: 0.251 Test Loss: 102.830 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.791395902633667
Epoch: 9, Steps: 17 | Train Loss: 51.707 Vali Loss: 111.851 Vali Acc: 0.251 Test Loss: 111.851 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.722034215927124
Epoch: 10, Steps: 17 | Train Loss: 37.093 Vali Loss: 100.009 Vali Acc: 0.259 Test Loss: 100.009 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.449174642562866
Epoch: 11, Steps: 17 | Train Loss: 57.740 Vali Loss: 99.832 Vali Acc: 0.278 Test Loss: 99.832 Test Acc: 0.278
Validation loss decreased (-0.258087 --> -0.276568).  Saving model ...
Epoch: 12 cost time: 2.8009049892425537
Epoch: 12, Steps: 17 | Train Loss: 33.087 Vali Loss: 122.635 Vali Acc: 0.243 Test Loss: 122.635 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5912814140319824
Epoch: 13, Steps: 17 | Train Loss: 39.053 Vali Loss: 92.654 Vali Acc: 0.289 Test Loss: 92.654 Test Acc: 0.289
Validation loss decreased (-0.276568 --> -0.288047).  Saving model ...
Epoch: 14 cost time: 2.598792791366577
Epoch: 14, Steps: 17 | Train Loss: 18.882 Vali Loss: 77.357 Vali Acc: 0.251 Test Loss: 77.357 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.793855905532837
Epoch: 15, Steps: 17 | Train Loss: 35.382 Vali Loss: 105.271 Vali Acc: 0.266 Test Loss: 105.271 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.467514991760254
Epoch: 16, Steps: 17 | Train Loss: 21.621 Vali Loss: 97.965 Vali Acc: 0.266 Test Loss: 97.965 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.473414182662964
Epoch: 17, Steps: 17 | Train Loss: 7.799 Vali Loss: 91.549 Vali Acc: 0.259 Test Loss: 91.549 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.648146152496338
Epoch: 18, Steps: 17 | Train Loss: 21.085 Vali Loss: 170.862 Vali Acc: 0.274 Test Loss: 170.862 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.687864065170288
Epoch: 19, Steps: 17 | Train Loss: 33.756 Vali Loss: 144.267 Vali Acc: 0.266 Test Loss: 144.267 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.661992311477661
Epoch: 20, Steps: 17 | Train Loss: 11.097 Vali Loss: 151.678 Vali Acc: 0.240 Test Loss: 151.678 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.6943440437316895
Epoch: 21, Steps: 17 | Train Loss: 9.503 Vali Loss: 171.863 Vali Acc: 0.266 Test Loss: 171.863 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.8925673961639404
Epoch: 22, Steps: 17 | Train Loss: 15.360 Vali Loss: 177.926 Vali Acc: 0.240 Test Loss: 177.926 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.455249547958374
Epoch: 23, Steps: 17 | Train Loss: 11.105 Vali Loss: 241.625 Vali Acc: 0.281 Test Loss: 241.625 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1000124
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.674738168716431
Epoch: 1, Steps: 17 | Train Loss: 7.487 Vali Loss: 7.936 Vali Acc: 0.240 Test Loss: 7.936 Test Acc: 0.240
Validation loss decreased (inf --> -0.239464).  Saving model ...
Epoch: 2 cost time: 2.9663944244384766
Epoch: 2, Steps: 17 | Train Loss: 10.363 Vali Loss: 29.008 Vali Acc: 0.236 Test Loss: 29.008 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5775649547576904
Epoch: 3, Steps: 17 | Train Loss: 16.846 Vali Loss: 25.221 Vali Acc: 0.251 Test Loss: 25.221 Test Acc: 0.251
Validation loss decreased (-0.239464 --> -0.250698).  Saving model ...
Epoch: 4 cost time: 2.943925619125366
Epoch: 4, Steps: 17 | Train Loss: 18.006 Vali Loss: 18.902 Vali Acc: 0.251 Test Loss: 18.902 Test Acc: 0.251
Validation loss decreased (-0.250698 --> -0.250762).  Saving model ...
Epoch: 5 cost time: 3.0595691204071045
Epoch: 5, Steps: 17 | Train Loss: 21.747 Vali Loss: 39.808 Vali Acc: 0.251 Test Loss: 39.808 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7671902179718018
Epoch: 6, Steps: 17 | Train Loss: 26.504 Vali Loss: 35.035 Vali Acc: 0.251 Test Loss: 35.035 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8054792881011963
Epoch: 7, Steps: 17 | Train Loss: 39.050 Vali Loss: 32.756 Vali Acc: 0.266 Test Loss: 32.756 Test Acc: 0.266
Validation loss decreased (-0.250762 --> -0.265832).  Saving model ...
Epoch: 8 cost time: 2.8694348335266113
Epoch: 8, Steps: 17 | Train Loss: 17.948 Vali Loss: 27.177 Vali Acc: 0.240 Test Loss: 27.177 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.726968288421631
Epoch: 9, Steps: 17 | Train Loss: 20.922 Vali Loss: 21.709 Vali Acc: 0.266 Test Loss: 21.709 Test Acc: 0.266
Validation loss decreased (-0.265832 --> -0.265943).  Saving model ...
Epoch: 10 cost time: 2.812610626220703
Epoch: 10, Steps: 17 | Train Loss: 17.708 Vali Loss: 46.000 Vali Acc: 0.259 Test Loss: 46.000 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1045422554016113
Epoch: 11, Steps: 17 | Train Loss: 22.273 Vali Loss: 25.034 Vali Acc: 0.293 Test Loss: 25.034 Test Acc: 0.293
Validation loss decreased (-0.265943 --> -0.292525).  Saving model ...
Epoch: 12 cost time: 2.615614891052246
Epoch: 12, Steps: 17 | Train Loss: 24.750 Vali Loss: 42.279 Vali Acc: 0.228 Test Loss: 42.279 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2479159832000732
Epoch: 13, Steps: 17 | Train Loss: 20.313 Vali Loss: 33.292 Vali Acc: 0.255 Test Loss: 33.292 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.891042947769165
Epoch: 14, Steps: 17 | Train Loss: 16.912 Vali Loss: 29.276 Vali Acc: 0.304 Test Loss: 29.276 Test Acc: 0.304
Validation loss decreased (-0.292525 --> -0.303890).  Saving model ...
Epoch: 15 cost time: 2.7746074199676514
Epoch: 15, Steps: 17 | Train Loss: 16.770 Vali Loss: 25.309 Vali Acc: 0.266 Test Loss: 25.309 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.75593638420105
Epoch: 16, Steps: 17 | Train Loss: 15.107 Vali Loss: 40.335 Vali Acc: 0.236 Test Loss: 40.335 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9972708225250244
Epoch: 17, Steps: 17 | Train Loss: 20.974 Vali Loss: 51.958 Vali Acc: 0.251 Test Loss: 51.958 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8620924949645996
Epoch: 18, Steps: 17 | Train Loss: 28.982 Vali Loss: 53.154 Vali Acc: 0.274 Test Loss: 53.154 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.811662435531616
Epoch: 19, Steps: 17 | Train Loss: 7.024 Vali Loss: 55.914 Vali Acc: 0.270 Test Loss: 55.914 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.894129991531372
Epoch: 20, Steps: 17 | Train Loss: 19.343 Vali Loss: 51.200 Vali Acc: 0.297 Test Loss: 51.200 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.002678871154785
Epoch: 21, Steps: 17 | Train Loss: 9.335 Vali Loss: 49.245 Vali Acc: 0.251 Test Loss: 49.245 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.7245423793792725
Epoch: 22, Steps: 17 | Train Loss: 10.646 Vali Loss: 46.045 Vali Acc: 0.293 Test Loss: 46.045 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.9516983032226562
Epoch: 23, Steps: 17 | Train Loss: 8.886 Vali Loss: 46.374 Vali Acc: 0.232 Test Loss: 46.374 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.88175892829895
Epoch: 24, Steps: 17 | Train Loss: 5.297 Vali Loss: 67.721 Vali Acc: 0.247 Test Loss: 67.721 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 991612
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.258396148681641
Epoch: 1, Steps: 17 | Train Loss: 10.129 Vali Loss: 9.467 Vali Acc: 0.232 Test Loss: 9.467 Test Acc: 0.232
Validation loss decreased (inf --> -0.231844).  Saving model ...
Epoch: 2 cost time: 2.7133777141571045
Epoch: 2, Steps: 17 | Train Loss: 14.868 Vali Loss: 18.569 Vali Acc: 0.243 Test Loss: 18.569 Test Acc: 0.243
Validation loss decreased (-0.231844 --> -0.243160).  Saving model ...
Epoch: 3 cost time: 2.8642690181732178
Epoch: 3, Steps: 17 | Train Loss: 20.945 Vali Loss: 30.910 Vali Acc: 0.262 Test Loss: 30.910 Test Acc: 0.262
Validation loss decreased (-0.243160 --> -0.262048).  Saving model ...
Epoch: 4 cost time: 2.561394214630127
Epoch: 4, Steps: 17 | Train Loss: 24.995 Vali Loss: 25.235 Vali Acc: 0.255 Test Loss: 25.235 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7416653633117676
Epoch: 5, Steps: 17 | Train Loss: 16.857 Vali Loss: 16.043 Vali Acc: 0.259 Test Loss: 16.043 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.887097120285034
Epoch: 6, Steps: 17 | Train Loss: 27.165 Vali Loss: 22.467 Vali Acc: 0.270 Test Loss: 22.467 Test Acc: 0.270
Validation loss decreased (-0.262048 --> -0.269737).  Saving model ...
Epoch: 7 cost time: 2.604825735092163
Epoch: 7, Steps: 17 | Train Loss: 17.283 Vali Loss: 34.486 Vali Acc: 0.232 Test Loss: 34.486 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4762895107269287
Epoch: 8, Steps: 17 | Train Loss: 32.443 Vali Loss: 43.947 Vali Acc: 0.240 Test Loss: 43.947 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8746864795684814
Epoch: 9, Steps: 17 | Train Loss: 23.262 Vali Loss: 40.594 Vali Acc: 0.255 Test Loss: 40.594 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5846385955810547
Epoch: 10, Steps: 17 | Train Loss: 22.823 Vali Loss: 30.008 Vali Acc: 0.255 Test Loss: 30.008 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.755049228668213
Epoch: 11, Steps: 17 | Train Loss: 20.463 Vali Loss: 32.039 Vali Acc: 0.236 Test Loss: 32.039 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0022661685943604
Epoch: 12, Steps: 17 | Train Loss: 34.098 Vali Loss: 41.194 Vali Acc: 0.247 Test Loss: 41.194 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7380599975585938
Epoch: 13, Steps: 17 | Train Loss: 19.082 Vali Loss: 33.525 Vali Acc: 0.255 Test Loss: 33.525 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.6649584770202637
Epoch: 14, Steps: 17 | Train Loss: 20.365 Vali Loss: 24.191 Vali Acc: 0.247 Test Loss: 24.191 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.9741482734680176
Epoch: 15, Steps: 17 | Train Loss: 12.309 Vali Loss: 34.556 Vali Acc: 0.251 Test Loss: 34.556 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.8052897453308105
Epoch: 16, Steps: 17 | Train Loss: 13.952 Vali Loss: 45.183 Vali Acc: 0.255 Test Loss: 45.183 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 991612
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.012083292007446
Epoch: 1, Steps: 17 | Train Loss: 9.466 Vali Loss: 10.111 Vali Acc: 0.255 Test Loss: 10.111 Test Acc: 0.255
Validation loss decreased (inf --> -0.254652).  Saving model ...
Epoch: 2 cost time: 2.5475008487701416
Epoch: 2, Steps: 17 | Train Loss: 13.582 Vali Loss: 36.725 Vali Acc: 0.251 Test Loss: 36.725 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5981266498565674
Epoch: 3, Steps: 17 | Train Loss: 26.631 Vali Loss: 32.022 Vali Acc: 0.247 Test Loss: 32.022 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.609464168548584
Epoch: 4, Steps: 17 | Train Loss: 23.424 Vali Loss: 21.617 Vali Acc: 0.224 Test Loss: 21.617 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4627692699432373
Epoch: 5, Steps: 17 | Train Loss: 20.470 Vali Loss: 31.572 Vali Acc: 0.247 Test Loss: 31.572 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.379312515258789
Epoch: 6, Steps: 17 | Train Loss: 26.692 Vali Loss: 27.812 Vali Acc: 0.262 Test Loss: 27.812 Test Acc: 0.262
Validation loss decreased (-0.254652 --> -0.262079).  Saving model ...
Epoch: 7 cost time: 2.430426597595215
Epoch: 7, Steps: 17 | Train Loss: 20.244 Vali Loss: 16.429 Vali Acc: 0.224 Test Loss: 16.429 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.577148914337158
Epoch: 8, Steps: 17 | Train Loss: 16.405 Vali Loss: 52.693 Vali Acc: 0.251 Test Loss: 52.693 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7132444381713867
Epoch: 9, Steps: 17 | Train Loss: 25.114 Vali Loss: 33.600 Vali Acc: 0.243 Test Loss: 33.600 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.352508783340454
Epoch: 10, Steps: 17 | Train Loss: 18.784 Vali Loss: 37.972 Vali Acc: 0.247 Test Loss: 37.972 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6409881114959717
Epoch: 11, Steps: 17 | Train Loss: 18.105 Vali Loss: 25.674 Vali Acc: 0.240 Test Loss: 25.674 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.5993452072143555
Epoch: 12, Steps: 17 | Train Loss: 10.600 Vali Loss: 31.097 Vali Acc: 0.262 Test Loss: 31.097 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.527663469314575
Epoch: 13, Steps: 17 | Train Loss: 24.341 Vali Loss: 35.370 Vali Acc: 0.251 Test Loss: 35.370 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.783942461013794
Epoch: 14, Steps: 17 | Train Loss: 18.322 Vali Loss: 41.312 Vali Acc: 0.236 Test Loss: 41.312 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.3953816890716553
Epoch: 15, Steps: 17 | Train Loss: 19.209 Vali Loss: 38.143 Vali Acc: 0.232 Test Loss: 38.143 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5215258598327637
Epoch: 16, Steps: 17 | Train Loss: 13.811 Vali Loss: 39.243 Vali Acc: 0.262 Test Loss: 39.243 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 991612
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.466602087020874
Epoch: 1, Steps: 17 | Train Loss: 9.516 Vali Loss: 14.097 Vali Acc: 0.259 Test Loss: 14.097 Test Acc: 0.259
Validation loss decreased (inf --> -0.258414).  Saving model ...
Epoch: 2 cost time: 2.327322483062744
Epoch: 2, Steps: 17 | Train Loss: 18.024 Vali Loss: 17.368 Vali Acc: 0.247 Test Loss: 17.368 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7369325160980225
Epoch: 3, Steps: 17 | Train Loss: 13.794 Vali Loss: 11.259 Vali Acc: 0.251 Test Loss: 11.259 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5279057025909424
Epoch: 4, Steps: 17 | Train Loss: 14.762 Vali Loss: 22.741 Vali Acc: 0.247 Test Loss: 22.741 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5938613414764404
Epoch: 5, Steps: 17 | Train Loss: 16.999 Vali Loss: 16.665 Vali Acc: 0.285 Test Loss: 16.665 Test Acc: 0.285
Validation loss decreased (-0.258414 --> -0.285004).  Saving model ...
Epoch: 6 cost time: 2.728511333465576
Epoch: 6, Steps: 17 | Train Loss: 25.856 Vali Loss: 26.042 Vali Acc: 0.270 Test Loss: 26.042 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7914774417877197
Epoch: 7, Steps: 17 | Train Loss: 23.968 Vali Loss: 20.621 Vali Acc: 0.274 Test Loss: 20.621 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6760897636413574
Epoch: 8, Steps: 17 | Train Loss: 25.343 Vali Loss: 40.481 Vali Acc: 0.243 Test Loss: 40.481 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5808823108673096
Epoch: 9, Steps: 17 | Train Loss: 31.356 Vali Loss: 17.790 Vali Acc: 0.259 Test Loss: 17.790 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4689137935638428
Epoch: 10, Steps: 17 | Train Loss: 23.725 Vali Loss: 16.367 Vali Acc: 0.270 Test Loss: 16.367 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.46382737159729
Epoch: 11, Steps: 17 | Train Loss: 11.624 Vali Loss: 14.367 Vali Acc: 0.255 Test Loss: 14.367 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3652093410491943
Epoch: 12, Steps: 17 | Train Loss: 14.612 Vali Loss: 28.955 Vali Acc: 0.251 Test Loss: 28.955 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.6600594520568848
Epoch: 13, Steps: 17 | Train Loss: 15.411 Vali Loss: 15.929 Vali Acc: 0.255 Test Loss: 15.929 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.7379274368286133
Epoch: 14, Steps: 17 | Train Loss: 14.026 Vali Loss: 30.136 Vali Acc: 0.262 Test Loss: 30.136 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.5112123489379883
Epoch: 15, Steps: 17 | Train Loss: 13.471 Vali Loss: 46.068 Vali Acc: 0.266 Test Loss: 46.068 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 991612
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.055474042892456
Epoch: 1, Steps: 17 | Train Loss: 13.660 Vali Loss: 11.371 Vali Acc: 0.251 Test Loss: 11.371 Test Acc: 0.251
Validation loss decreased (inf --> -0.250837).  Saving model ...
Epoch: 2 cost time: 2.2195029258728027
Epoch: 2, Steps: 17 | Train Loss: 10.916 Vali Loss: 10.147 Vali Acc: 0.243 Test Loss: 10.147 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.817674398422241
Epoch: 3, Steps: 17 | Train Loss: 12.927 Vali Loss: 14.479 Vali Acc: 0.232 Test Loss: 14.479 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6111979484558105
Epoch: 4, Steps: 17 | Train Loss: 14.057 Vali Loss: 21.149 Vali Acc: 0.259 Test Loss: 21.149 Test Acc: 0.259
Validation loss decreased (-0.250837 --> -0.258344).  Saving model ...
Epoch: 5 cost time: 3.0982673168182373
Epoch: 5, Steps: 17 | Train Loss: 13.450 Vali Loss: 25.715 Vali Acc: 0.251 Test Loss: 25.715 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8949928283691406
Epoch: 6, Steps: 17 | Train Loss: 18.136 Vali Loss: 15.880 Vali Acc: 0.278 Test Loss: 15.880 Test Acc: 0.278
Validation loss decreased (-0.258344 --> -0.277408).  Saving model ...
Epoch: 7 cost time: 2.8748767375946045
Epoch: 7, Steps: 17 | Train Loss: 21.657 Vali Loss: 28.865 Vali Acc: 0.251 Test Loss: 28.865 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6255149841308594
Epoch: 8, Steps: 17 | Train Loss: 33.364 Vali Loss: 40.858 Vali Acc: 0.255 Test Loss: 40.858 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.968409538269043
Epoch: 9, Steps: 17 | Train Loss: 20.861 Vali Loss: 23.811 Vali Acc: 0.236 Test Loss: 23.811 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.813229560852051
Epoch: 10, Steps: 17 | Train Loss: 19.577 Vali Loss: 35.564 Vali Acc: 0.247 Test Loss: 35.564 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6592495441436768
Epoch: 11, Steps: 17 | Train Loss: 15.501 Vali Loss: 18.574 Vali Acc: 0.232 Test Loss: 18.574 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.673637866973877
Epoch: 12, Steps: 17 | Train Loss: 17.333 Vali Loss: 20.947 Vali Acc: 0.209 Test Loss: 20.947 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.221437692642212
Epoch: 13, Steps: 17 | Train Loss: 19.345 Vali Loss: 24.481 Vali Acc: 0.274 Test Loss: 24.481 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.183993101119995
Epoch: 14, Steps: 17 | Train Loss: 24.879 Vali Loss: 32.132 Vali Acc: 0.236 Test Loss: 32.132 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.1266393661499023
Epoch: 15, Steps: 17 | Train Loss: 23.075 Vali Loss: 67.428 Vali Acc: 0.247 Test Loss: 67.428 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.2786552906036377
Epoch: 16, Steps: 17 | Train Loss: 16.276 Vali Loss: 42.429 Vali Acc: 0.221 Test Loss: 42.429 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 729468
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.301768779754639
Epoch: 1, Steps: 17 | Train Loss: 9.397 Vali Loss: 8.940 Vali Acc: 0.232 Test Loss: 8.940 Test Acc: 0.232
Validation loss decreased (inf --> -0.231850).  Saving model ...
Epoch: 2 cost time: 2.354278326034546
Epoch: 2, Steps: 17 | Train Loss: 9.797 Vali Loss: 25.044 Vali Acc: 0.251 Test Loss: 25.044 Test Acc: 0.251
Validation loss decreased (-0.231850 --> -0.250700).  Saving model ...
Epoch: 3 cost time: 2.4153647422790527
Epoch: 3, Steps: 17 | Train Loss: 19.579 Vali Loss: 27.284 Vali Acc: 0.255 Test Loss: 27.284 Test Acc: 0.255
Validation loss decreased (-0.250700 --> -0.254480).  Saving model ...
Epoch: 4 cost time: 2.643523693084717
Epoch: 4, Steps: 17 | Train Loss: 26.358 Vali Loss: 29.055 Vali Acc: 0.236 Test Loss: 29.055 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.374511480331421
Epoch: 5, Steps: 17 | Train Loss: 24.084 Vali Loss: 31.489 Vali Acc: 0.285 Test Loss: 31.489 Test Acc: 0.285
Validation loss decreased (-0.254480 --> -0.284856).  Saving model ...
Epoch: 6 cost time: 2.438974380493164
Epoch: 6, Steps: 17 | Train Loss: 21.626 Vali Loss: 24.237 Vali Acc: 0.259 Test Loss: 24.237 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5672879219055176
Epoch: 7, Steps: 17 | Train Loss: 13.677 Vali Loss: 23.920 Vali Acc: 0.251 Test Loss: 23.920 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6468958854675293
Epoch: 8, Steps: 17 | Train Loss: 18.485 Vali Loss: 25.776 Vali Acc: 0.270 Test Loss: 25.776 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5865328311920166
Epoch: 9, Steps: 17 | Train Loss: 39.182 Vali Loss: 51.689 Vali Acc: 0.266 Test Loss: 51.689 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.552924394607544
Epoch: 10, Steps: 17 | Train Loss: 22.028 Vali Loss: 31.208 Vali Acc: 0.240 Test Loss: 31.208 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.6705081462860107
Epoch: 11, Steps: 17 | Train Loss: 29.132 Vali Loss: 48.468 Vali Acc: 0.232 Test Loss: 48.468 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4829869270324707
Epoch: 12, Steps: 17 | Train Loss: 34.889 Vali Loss: 36.783 Vali Acc: 0.278 Test Loss: 36.783 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.403649091720581
Epoch: 13, Steps: 17 | Train Loss: 18.038 Vali Loss: 33.155 Vali Acc: 0.289 Test Loss: 33.155 Test Acc: 0.289
Validation loss decreased (-0.284856 --> -0.288642).  Saving model ...
Epoch: 14 cost time: 2.5312464237213135
Epoch: 14, Steps: 17 | Train Loss: 22.298 Vali Loss: 24.755 Vali Acc: 0.289 Test Loss: 24.755 Test Acc: 0.289
Validation loss decreased (-0.288642 --> -0.288726).  Saving model ...
Epoch: 15 cost time: 2.678067207336426
Epoch: 15, Steps: 17 | Train Loss: 25.028 Vali Loss: 64.319 Vali Acc: 0.270 Test Loss: 64.319 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.382284164428711
Epoch: 16, Steps: 17 | Train Loss: 14.630 Vali Loss: 38.642 Vali Acc: 0.262 Test Loss: 38.642 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.47922420501709
Epoch: 17, Steps: 17 | Train Loss: 9.145 Vali Loss: 32.250 Vali Acc: 0.270 Test Loss: 32.250 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.643373489379883
Epoch: 18, Steps: 17 | Train Loss: 12.096 Vali Loss: 34.609 Vali Acc: 0.300 Test Loss: 34.609 Test Acc: 0.300
Validation loss decreased (-0.288726 --> -0.300034).  Saving model ...
Epoch: 19 cost time: 3.0094001293182373
Epoch: 19, Steps: 17 | Train Loss: 17.356 Vali Loss: 45.014 Vali Acc: 0.270 Test Loss: 45.014 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.6742310523986816
Epoch: 20, Steps: 17 | Train Loss: 9.230 Vali Loss: 55.350 Vali Acc: 0.247 Test Loss: 55.350 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.639679193496704
Epoch: 21, Steps: 17 | Train Loss: 9.866 Vali Loss: 50.969 Vali Acc: 0.262 Test Loss: 50.969 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.7392876148223877
Epoch: 22, Steps: 17 | Train Loss: 10.472 Vali Loss: 58.740 Vali Acc: 0.243 Test Loss: 58.740 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.6463844776153564
Epoch: 23, Steps: 17 | Train Loss: 5.753 Vali Loss: 69.454 Vali Acc: 0.270 Test Loss: 69.454 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.3702332973480225
Epoch: 24, Steps: 17 | Train Loss: 7.191 Vali Loss: 61.254 Vali Acc: 0.274 Test Loss: 61.254 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.3660833835601807
Epoch: 25, Steps: 17 | Train Loss: 4.979 Vali Loss: 79.673 Vali Acc: 0.266 Test Loss: 79.673 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.6239278316497803
Epoch: 26, Steps: 17 | Train Loss: 5.932 Vali Loss: 86.881 Vali Acc: 0.262 Test Loss: 86.881 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.6407601833343506
Epoch: 27, Steps: 17 | Train Loss: 5.698 Vali Loss: 80.087 Vali Acc: 0.270 Test Loss: 80.087 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.361923933029175
Epoch: 28, Steps: 17 | Train Loss: 7.771 Vali Loss: 94.498 Vali Acc: 0.259 Test Loss: 94.498 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 729468
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.6450560092926025
Epoch: 1, Steps: 17 | Train Loss: 10.499 Vali Loss: 6.777 Vali Acc: 0.255 Test Loss: 6.777 Test Acc: 0.255
Validation loss decreased (inf --> -0.254685).  Saving model ...
Epoch: 2 cost time: 2.2248148918151855
Epoch: 2, Steps: 17 | Train Loss: 10.922 Vali Loss: 15.136 Vali Acc: 0.255 Test Loss: 15.136 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.405033826828003
Epoch: 3, Steps: 17 | Train Loss: 12.896 Vali Loss: 29.555 Vali Acc: 0.259 Test Loss: 29.555 Test Acc: 0.259
Validation loss decreased (-0.254685 --> -0.258260).  Saving model ...
Epoch: 4 cost time: 2.22672700881958
Epoch: 4, Steps: 17 | Train Loss: 19.012 Vali Loss: 10.951 Vali Acc: 0.259 Test Loss: 10.951 Test Acc: 0.259
Validation loss decreased (-0.258260 --> -0.258446).  Saving model ...
Epoch: 5 cost time: 2.2672834396362305
Epoch: 5, Steps: 17 | Train Loss: 14.452 Vali Loss: 10.492 Vali Acc: 0.247 Test Loss: 10.492 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.25252103805542
Epoch: 6, Steps: 17 | Train Loss: 11.399 Vali Loss: 18.997 Vali Acc: 0.262 Test Loss: 18.997 Test Acc: 0.262
Validation loss decreased (-0.258446 --> -0.262167).  Saving model ...
Epoch: 7 cost time: 2.477513551712036
Epoch: 7, Steps: 17 | Train Loss: 13.371 Vali Loss: 33.797 Vali Acc: 0.247 Test Loss: 33.797 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.35345721244812
Epoch: 8, Steps: 17 | Train Loss: 17.920 Vali Loss: 21.405 Vali Acc: 0.259 Test Loss: 21.405 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.259359121322632
Epoch: 9, Steps: 17 | Train Loss: 30.352 Vali Loss: 46.386 Vali Acc: 0.251 Test Loss: 46.386 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3323702812194824
Epoch: 10, Steps: 17 | Train Loss: 34.116 Vali Loss: 21.740 Vali Acc: 0.247 Test Loss: 21.740 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1936378479003906
Epoch: 11, Steps: 17 | Train Loss: 24.345 Vali Loss: 17.401 Vali Acc: 0.274 Test Loss: 17.401 Test Acc: 0.274
Validation loss decreased (-0.262167 --> -0.273590).  Saving model ...
Epoch: 12 cost time: 1.9789669513702393
Epoch: 12, Steps: 17 | Train Loss: 15.392 Vali Loss: 28.359 Vali Acc: 0.259 Test Loss: 28.359 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.128955125808716
Epoch: 13, Steps: 17 | Train Loss: 13.709 Vali Loss: 52.967 Vali Acc: 0.262 Test Loss: 52.967 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.539074182510376
Epoch: 14, Steps: 17 | Train Loss: 32.281 Vali Loss: 26.054 Vali Acc: 0.255 Test Loss: 26.054 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2589340209960938
Epoch: 15, Steps: 17 | Train Loss: 10.794 Vali Loss: 36.145 Vali Acc: 0.228 Test Loss: 36.145 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2247817516326904
Epoch: 16, Steps: 17 | Train Loss: 24.098 Vali Loss: 41.862 Vali Acc: 0.262 Test Loss: 41.862 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.1875884532928467
Epoch: 17, Steps: 17 | Train Loss: 18.211 Vali Loss: 38.197 Vali Acc: 0.221 Test Loss: 38.197 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.676952600479126
Epoch: 18, Steps: 17 | Train Loss: 11.013 Vali Loss: 68.568 Vali Acc: 0.255 Test Loss: 68.568 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.6690781116485596
Epoch: 19, Steps: 17 | Train Loss: 17.927 Vali Loss: 54.132 Vali Acc: 0.228 Test Loss: 54.132 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3549177646636963
Epoch: 20, Steps: 17 | Train Loss: 11.194 Vali Loss: 59.669 Vali Acc: 0.262 Test Loss: 59.669 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.616925001144409
Epoch: 21, Steps: 17 | Train Loss: 16.864 Vali Loss: 82.120 Vali Acc: 0.240 Test Loss: 82.120 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 729468
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.458543062210083
Epoch: 1, Steps: 17 | Train Loss: 12.578 Vali Loss: 19.782 Vali Acc: 0.251 Test Loss: 19.782 Test Acc: 0.251
Validation loss decreased (inf --> -0.250753).  Saving model ...
Epoch: 2 cost time: 2.264148712158203
Epoch: 2, Steps: 17 | Train Loss: 12.073 Vali Loss: 21.296 Vali Acc: 0.240 Test Loss: 21.296 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0564608573913574
Epoch: 3, Steps: 17 | Train Loss: 17.497 Vali Loss: 10.729 Vali Acc: 0.270 Test Loss: 10.729 Test Acc: 0.270
Validation loss decreased (-0.250753 --> -0.269855).  Saving model ...
Epoch: 4 cost time: 2.0082075595855713
Epoch: 4, Steps: 17 | Train Loss: 14.545 Vali Loss: 12.307 Vali Acc: 0.255 Test Loss: 12.307 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2889339923858643
Epoch: 5, Steps: 17 | Train Loss: 14.444 Vali Loss: 19.668 Vali Acc: 0.255 Test Loss: 19.668 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.236534357070923
Epoch: 6, Steps: 17 | Train Loss: 15.788 Vali Loss: 21.513 Vali Acc: 0.236 Test Loss: 21.513 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.251436471939087
Epoch: 7, Steps: 17 | Train Loss: 21.512 Vali Loss: 35.052 Vali Acc: 0.236 Test Loss: 35.052 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.323794364929199
Epoch: 8, Steps: 17 | Train Loss: 22.239 Vali Loss: 36.451 Vali Acc: 0.262 Test Loss: 36.451 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2107253074645996
Epoch: 9, Steps: 17 | Train Loss: 29.330 Vali Loss: 29.862 Vali Acc: 0.236 Test Loss: 29.862 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.100980043411255
Epoch: 10, Steps: 17 | Train Loss: 17.773 Vali Loss: 29.488 Vali Acc: 0.247 Test Loss: 29.488 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.0353779792785645
Epoch: 11, Steps: 17 | Train Loss: 20.424 Vali Loss: 18.184 Vali Acc: 0.281 Test Loss: 18.184 Test Acc: 0.281
Validation loss decreased (-0.269855 --> -0.281187).  Saving model ...
Epoch: 12 cost time: 2.275137424468994
Epoch: 12, Steps: 17 | Train Loss: 21.882 Vali Loss: 16.189 Vali Acc: 0.251 Test Loss: 16.189 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3123788833618164
Epoch: 13, Steps: 17 | Train Loss: 9.644 Vali Loss: 22.304 Vali Acc: 0.259 Test Loss: 22.304 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.159749746322632
Epoch: 14, Steps: 17 | Train Loss: 16.038 Vali Loss: 47.263 Vali Acc: 0.251 Test Loss: 47.263 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.261425018310547
Epoch: 15, Steps: 17 | Train Loss: 16.378 Vali Loss: 37.131 Vali Acc: 0.259 Test Loss: 37.131 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0443050861358643
Epoch: 16, Steps: 17 | Train Loss: 11.828 Vali Loss: 26.836 Vali Acc: 0.293 Test Loss: 26.836 Test Acc: 0.293
Validation loss decreased (-0.281187 --> -0.292507).  Saving model ...
Epoch: 17 cost time: 2.4530603885650635
Epoch: 17, Steps: 17 | Train Loss: 11.760 Vali Loss: 74.070 Vali Acc: 0.255 Test Loss: 74.070 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1501009464263916
Epoch: 18, Steps: 17 | Train Loss: 17.045 Vali Loss: 45.030 Vali Acc: 0.255 Test Loss: 45.030 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2093312740325928
Epoch: 19, Steps: 17 | Train Loss: 12.708 Vali Loss: 55.197 Vali Acc: 0.259 Test Loss: 55.197 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2289316654205322
Epoch: 20, Steps: 17 | Train Loss: 6.620 Vali Loss: 66.233 Vali Acc: 0.266 Test Loss: 66.233 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.4162182807922363
Epoch: 21, Steps: 17 | Train Loss: 10.311 Vali Loss: 59.506 Vali Acc: 0.228 Test Loss: 59.506 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.0068016052246094
Epoch: 22, Steps: 17 | Train Loss: 9.253 Vali Loss: 68.564 Vali Acc: 0.270 Test Loss: 68.564 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9905860424041748
Epoch: 23, Steps: 17 | Train Loss: 10.423 Vali Loss: 70.641 Vali Acc: 0.259 Test Loss: 70.641 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.111281394958496
Epoch: 24, Steps: 17 | Train Loss: 8.252 Vali Loss: 75.844 Vali Acc: 0.270 Test Loss: 75.844 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.2893877029418945
Epoch: 25, Steps: 17 | Train Loss: 4.205 Vali Loss: 71.184 Vali Acc: 0.259 Test Loss: 71.184 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.916426658630371
Epoch: 26, Steps: 17 | Train Loss: 7.694 Vali Loss: 104.449 Vali Acc: 0.259 Test Loss: 104.449 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 729468
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.135239362716675
Epoch: 1, Steps: 17 | Train Loss: 12.239 Vali Loss: 20.388 Vali Acc: 0.240 Test Loss: 20.388 Test Acc: 0.240
Validation loss decreased (inf --> -0.239340).  Saving model ...
Epoch: 2 cost time: 2.3609964847564697
Epoch: 2, Steps: 17 | Train Loss: 19.147 Vali Loss: 20.671 Vali Acc: 0.255 Test Loss: 20.671 Test Acc: 0.255
Validation loss decreased (-0.239340 --> -0.254546).  Saving model ...
Epoch: 3 cost time: 2.622617721557617
Epoch: 3, Steps: 17 | Train Loss: 14.000 Vali Loss: 38.282 Vali Acc: 0.247 Test Loss: 38.282 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3039422035217285
Epoch: 4, Steps: 17 | Train Loss: 17.227 Vali Loss: 27.200 Vali Acc: 0.259 Test Loss: 27.200 Test Acc: 0.259
Validation loss decreased (-0.254546 --> -0.258283).  Saving model ...
Epoch: 5 cost time: 2.291069507598877
Epoch: 5, Steps: 17 | Train Loss: 20.830 Vali Loss: 25.056 Vali Acc: 0.262 Test Loss: 25.056 Test Acc: 0.262
Validation loss decreased (-0.258283 --> -0.262107).  Saving model ...
Epoch: 6 cost time: 2.3917572498321533
Epoch: 6, Steps: 17 | Train Loss: 17.343 Vali Loss: 31.261 Vali Acc: 0.247 Test Loss: 31.261 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.629117488861084
Epoch: 7, Steps: 17 | Train Loss: 23.322 Vali Loss: 50.251 Vali Acc: 0.255 Test Loss: 50.251 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.45919132232666
Epoch: 8, Steps: 17 | Train Loss: 34.070 Vali Loss: 25.862 Vali Acc: 0.240 Test Loss: 25.862 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.514817476272583
Epoch: 9, Steps: 17 | Train Loss: 21.589 Vali Loss: 24.895 Vali Acc: 0.255 Test Loss: 24.895 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2760202884674072
Epoch: 10, Steps: 17 | Train Loss: 12.905 Vali Loss: 29.926 Vali Acc: 0.243 Test Loss: 29.926 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.6940550804138184
Epoch: 11, Steps: 17 | Train Loss: 20.070 Vali Loss: 40.469 Vali Acc: 0.251 Test Loss: 40.469 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4130003452301025
Epoch: 12, Steps: 17 | Train Loss: 22.108 Vali Loss: 47.907 Vali Acc: 0.236 Test Loss: 47.907 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.398404359817505
Epoch: 13, Steps: 17 | Train Loss: 22.141 Vali Loss: 43.943 Vali Acc: 0.266 Test Loss: 43.943 Test Acc: 0.266
Validation loss decreased (-0.262107 --> -0.265720).  Saving model ...
Epoch: 14 cost time: 2.4242985248565674
Epoch: 14, Steps: 17 | Train Loss: 14.813 Vali Loss: 36.704 Vali Acc: 0.236 Test Loss: 36.704 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4395663738250732
Epoch: 15, Steps: 17 | Train Loss: 23.818 Vali Loss: 49.217 Vali Acc: 0.270 Test Loss: 49.217 Test Acc: 0.270
Validation loss decreased (-0.265720 --> -0.269470).  Saving model ...
Epoch: 16 cost time: 2.4800047874450684
Epoch: 16, Steps: 17 | Train Loss: 22.824 Vali Loss: 46.202 Vali Acc: 0.247 Test Loss: 46.202 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3688161373138428
Epoch: 17, Steps: 17 | Train Loss: 21.125 Vali Loss: 46.322 Vali Acc: 0.255 Test Loss: 46.322 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3974790573120117
Epoch: 18, Steps: 17 | Train Loss: 25.084 Vali Loss: 62.188 Vali Acc: 0.251 Test Loss: 62.188 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6072609424591064
Epoch: 19, Steps: 17 | Train Loss: 20.525 Vali Loss: 63.637 Vali Acc: 0.232 Test Loss: 63.637 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.5118932723999023
Epoch: 20, Steps: 17 | Train Loss: 14.190 Vali Loss: 47.936 Vali Acc: 0.247 Test Loss: 47.936 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.460763931274414
Epoch: 21, Steps: 17 | Train Loss: 10.236 Vali Loss: 48.718 Vali Acc: 0.255 Test Loss: 48.718 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.3463339805603027
Epoch: 22, Steps: 17 | Train Loss: 6.908 Vali Loss: 49.367 Vali Acc: 0.247 Test Loss: 49.367 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.786057710647583
Epoch: 23, Steps: 17 | Train Loss: 6.246 Vali Loss: 53.531 Vali Acc: 0.240 Test Loss: 53.531 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.388712167739868
Epoch: 24, Steps: 17 | Train Loss: 4.874 Vali Loss: 52.659 Vali Acc: 0.247 Test Loss: 52.659 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.409734010696411
Epoch: 25, Steps: 17 | Train Loss: 4.395 Vali Loss: 54.198 Vali Acc: 0.262 Test Loss: 54.198 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 598396
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.2071192264556885
Epoch: 1, Steps: 17 | Train Loss: 12.138 Vali Loss: 21.590 Vali Acc: 0.247 Test Loss: 21.590 Test Acc: 0.247
Validation loss decreased (inf --> -0.246932).  Saving model ...
Epoch: 2 cost time: 2.5868754386901855
Epoch: 2, Steps: 17 | Train Loss: 12.936 Vali Loss: 18.888 Vali Acc: 0.262 Test Loss: 18.888 Test Acc: 0.262
Validation loss decreased (-0.246932 --> -0.262169).  Saving model ...
Epoch: 3 cost time: 2.250178337097168
Epoch: 3, Steps: 17 | Train Loss: 15.116 Vali Loss: 23.991 Vali Acc: 0.266 Test Loss: 23.991 Test Acc: 0.266
Validation loss decreased (-0.262169 --> -0.265920).  Saving model ...
Epoch: 4 cost time: 2.1803150177001953
Epoch: 4, Steps: 17 | Train Loss: 19.934 Vali Loss: 16.739 Vali Acc: 0.209 Test Loss: 16.739 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.280575752258301
Epoch: 5, Steps: 17 | Train Loss: 17.755 Vali Loss: 27.620 Vali Acc: 0.251 Test Loss: 27.620 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5032312870025635
Epoch: 6, Steps: 17 | Train Loss: 19.395 Vali Loss: 40.278 Vali Acc: 0.251 Test Loss: 40.278 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.374532699584961
Epoch: 7, Steps: 17 | Train Loss: 30.991 Vali Loss: 24.365 Vali Acc: 0.232 Test Loss: 24.365 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3555619716644287
Epoch: 8, Steps: 17 | Train Loss: 24.742 Vali Loss: 38.859 Vali Acc: 0.243 Test Loss: 38.859 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2790467739105225
Epoch: 9, Steps: 17 | Train Loss: 19.491 Vali Loss: 33.422 Vali Acc: 0.247 Test Loss: 33.422 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.493673801422119
Epoch: 10, Steps: 17 | Train Loss: 20.339 Vali Loss: 20.871 Vali Acc: 0.247 Test Loss: 20.871 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.1331946849823
Epoch: 11, Steps: 17 | Train Loss: 34.925 Vali Loss: 30.847 Vali Acc: 0.266 Test Loss: 30.847 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.403984785079956
Epoch: 12, Steps: 17 | Train Loss: 21.913 Vali Loss: 43.737 Vali Acc: 0.255 Test Loss: 43.737 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.5463929176330566
Epoch: 13, Steps: 17 | Train Loss: 28.656 Vali Loss: 64.454 Vali Acc: 0.243 Test Loss: 64.454 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 598396
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.271933555603027
Epoch: 1, Steps: 17 | Train Loss: 11.799 Vali Loss: 18.994 Vali Acc: 0.247 Test Loss: 18.994 Test Acc: 0.247
Validation loss decreased (inf --> -0.246958).  Saving model ...
Epoch: 2 cost time: 2.1361584663391113
Epoch: 2, Steps: 17 | Train Loss: 16.738 Vali Loss: 14.891 Vali Acc: 0.270 Test Loss: 14.891 Test Acc: 0.270
Validation loss decreased (-0.246958 --> -0.269813).  Saving model ...
Epoch: 3 cost time: 2.1949462890625
Epoch: 3, Steps: 17 | Train Loss: 13.232 Vali Loss: 32.944 Vali Acc: 0.266 Test Loss: 32.944 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0817854404449463
Epoch: 4, Steps: 17 | Train Loss: 18.979 Vali Loss: 21.775 Vali Acc: 0.236 Test Loss: 21.775 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.923995018005371
Epoch: 5, Steps: 17 | Train Loss: 17.169 Vali Loss: 26.377 Vali Acc: 0.274 Test Loss: 26.377 Test Acc: 0.274
Validation loss decreased (-0.269813 --> -0.273500).  Saving model ...
Epoch: 6 cost time: 1.9296300411224365
Epoch: 6, Steps: 17 | Train Loss: 24.029 Vali Loss: 22.052 Vali Acc: 0.243 Test Loss: 22.052 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8558359146118164
Epoch: 7, Steps: 17 | Train Loss: 20.412 Vali Loss: 28.376 Vali Acc: 0.251 Test Loss: 28.376 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9532866477966309
Epoch: 8, Steps: 17 | Train Loss: 25.848 Vali Loss: 21.979 Vali Acc: 0.262 Test Loss: 21.979 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.438586950302124
Epoch: 9, Steps: 17 | Train Loss: 23.195 Vali Loss: 33.845 Vali Acc: 0.251 Test Loss: 33.845 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2143428325653076
Epoch: 10, Steps: 17 | Train Loss: 18.622 Vali Loss: 27.719 Vali Acc: 0.224 Test Loss: 27.719 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.2156858444213867
Epoch: 11, Steps: 17 | Train Loss: 18.833 Vali Loss: 34.772 Vali Acc: 0.251 Test Loss: 34.772 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.264338493347168
Epoch: 12, Steps: 17 | Train Loss: 15.739 Vali Loss: 28.181 Vali Acc: 0.251 Test Loss: 28.181 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.1411752700805664
Epoch: 13, Steps: 17 | Train Loss: 17.387 Vali Loss: 18.367 Vali Acc: 0.217 Test Loss: 18.367 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0561301708221436
Epoch: 14, Steps: 17 | Train Loss: 13.549 Vali Loss: 42.140 Vali Acc: 0.240 Test Loss: 42.140 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.014612913131714
Epoch: 15, Steps: 17 | Train Loss: 20.736 Vali Loss: 41.109 Vali Acc: 0.262 Test Loss: 41.109 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 598396
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.999221563339233
Epoch: 1, Steps: 17 | Train Loss: 10.603 Vali Loss: 16.029 Vali Acc: 0.251 Test Loss: 16.029 Test Acc: 0.251
Validation loss decreased (inf --> -0.250790).  Saving model ...
Epoch: 2 cost time: 2.698713779449463
Epoch: 2, Steps: 17 | Train Loss: 16.082 Vali Loss: 18.606 Vali Acc: 0.247 Test Loss: 18.606 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5103166103363037
Epoch: 3, Steps: 17 | Train Loss: 14.769 Vali Loss: 21.407 Vali Acc: 0.247 Test Loss: 21.407 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4924142360687256
Epoch: 4, Steps: 17 | Train Loss: 16.783 Vali Loss: 16.156 Vali Acc: 0.236 Test Loss: 16.156 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4565913677215576
Epoch: 5, Steps: 17 | Train Loss: 16.260 Vali Loss: 15.991 Vali Acc: 0.259 Test Loss: 15.991 Test Acc: 0.259
Validation loss decreased (-0.250790 --> -0.258395).  Saving model ...
Epoch: 6 cost time: 2.264338731765747
Epoch: 6, Steps: 17 | Train Loss: 17.512 Vali Loss: 35.684 Vali Acc: 0.251 Test Loss: 35.684 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2315945625305176
Epoch: 7, Steps: 17 | Train Loss: 31.907 Vali Loss: 39.128 Vali Acc: 0.259 Test Loss: 39.128 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0454578399658203
Epoch: 8, Steps: 17 | Train Loss: 25.106 Vali Loss: 9.121 Vali Acc: 0.281 Test Loss: 9.121 Test Acc: 0.281
Validation loss decreased (-0.258395 --> -0.281278).  Saving model ...
Epoch: 9 cost time: 2.8061649799346924
Epoch: 9, Steps: 17 | Train Loss: 18.458 Vali Loss: 19.462 Vali Acc: 0.232 Test Loss: 19.462 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.472667932510376
Epoch: 10, Steps: 17 | Train Loss: 23.875 Vali Loss: 29.593 Vali Acc: 0.278 Test Loss: 29.593 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4694721698760986
Epoch: 11, Steps: 17 | Train Loss: 29.218 Vali Loss: 44.519 Vali Acc: 0.262 Test Loss: 44.519 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2395431995391846
Epoch: 12, Steps: 17 | Train Loss: 19.308 Vali Loss: 36.088 Vali Acc: 0.232 Test Loss: 36.088 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.538348436355591
Epoch: 13, Steps: 17 | Train Loss: 12.590 Vali Loss: 11.397 Vali Acc: 0.251 Test Loss: 11.397 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3248443603515625
Epoch: 14, Steps: 17 | Train Loss: 8.557 Vali Loss: 39.286 Vali Acc: 0.251 Test Loss: 39.286 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.445006847381592
Epoch: 15, Steps: 17 | Train Loss: 19.133 Vali Loss: 31.231 Vali Acc: 0.266 Test Loss: 31.231 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.4028215408325195
Epoch: 16, Steps: 17 | Train Loss: 11.810 Vali Loss: 32.299 Vali Acc: 0.266 Test Loss: 32.299 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.2697107791900635
Epoch: 17, Steps: 17 | Train Loss: 9.350 Vali Loss: 23.571 Vali Acc: 0.266 Test Loss: 23.571 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.3106470108032227
Epoch: 18, Steps: 17 | Train Loss: 11.452 Vali Loss: 53.779 Vali Acc: 0.247 Test Loss: 53.779 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 598396
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.558126926422119
Epoch: 1, Steps: 17 | Train Loss: 9.926 Vali Loss: 17.687 Vali Acc: 0.255 Test Loss: 17.687 Test Acc: 0.255
Validation loss decreased (inf --> -0.254576).  Saving model ...
Epoch: 2 cost time: 2.565218925476074
Epoch: 2, Steps: 17 | Train Loss: 12.703 Vali Loss: 15.076 Vali Acc: 0.255 Test Loss: 15.076 Test Acc: 0.255
Validation loss decreased (-0.254576 --> -0.254602).  Saving model ...
Epoch: 3 cost time: 2.3445849418640137
Epoch: 3, Steps: 17 | Train Loss: 11.559 Vali Loss: 15.786 Vali Acc: 0.259 Test Loss: 15.786 Test Acc: 0.259
Validation loss decreased (-0.254602 --> -0.258397).  Saving model ...
Epoch: 4 cost time: 2.5266196727752686
Epoch: 4, Steps: 17 | Train Loss: 13.081 Vali Loss: 17.447 Vali Acc: 0.240 Test Loss: 17.447 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4705891609191895
Epoch: 5, Steps: 17 | Train Loss: 17.491 Vali Loss: 27.200 Vali Acc: 0.224 Test Loss: 27.200 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.500227689743042
Epoch: 6, Steps: 17 | Train Loss: 15.401 Vali Loss: 15.661 Vali Acc: 0.251 Test Loss: 15.661 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.278998613357544
Epoch: 7, Steps: 17 | Train Loss: 21.531 Vali Loss: 49.014 Vali Acc: 0.224 Test Loss: 49.014 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5289242267608643
Epoch: 8, Steps: 17 | Train Loss: 29.979 Vali Loss: 31.944 Vali Acc: 0.259 Test Loss: 31.944 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.694828987121582
Epoch: 9, Steps: 17 | Train Loss: 20.947 Vali Loss: 16.347 Vali Acc: 0.236 Test Loss: 16.347 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4976372718811035
Epoch: 10, Steps: 17 | Train Loss: 26.874 Vali Loss: 24.724 Vali Acc: 0.293 Test Loss: 24.724 Test Acc: 0.293
Validation loss decreased (-0.258397 --> -0.292528).  Saving model ...
Epoch: 11 cost time: 2.406533718109131
Epoch: 11, Steps: 17 | Train Loss: 23.641 Vali Loss: 33.577 Vali Acc: 0.240 Test Loss: 33.577 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.311041831970215
Epoch: 12, Steps: 17 | Train Loss: 14.106 Vali Loss: 31.714 Vali Acc: 0.270 Test Loss: 31.714 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.495349168777466
Epoch: 13, Steps: 17 | Train Loss: 18.220 Vali Loss: 37.928 Vali Acc: 0.243 Test Loss: 37.928 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1803228855133057
Epoch: 14, Steps: 17 | Train Loss: 15.950 Vali Loss: 45.150 Vali Acc: 0.262 Test Loss: 45.150 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2889769077301025
Epoch: 15, Steps: 17 | Train Loss: 26.376 Vali Loss: 56.804 Vali Acc: 0.251 Test Loss: 56.804 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6297409534454346
Epoch: 16, Steps: 17 | Train Loss: 19.404 Vali Loss: 39.050 Vali Acc: 0.247 Test Loss: 39.050 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.326528549194336
Epoch: 17, Steps: 17 | Train Loss: 15.131 Vali Loss: 41.274 Vali Acc: 0.270 Test Loss: 41.274 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.447591543197632
Epoch: 18, Steps: 17 | Train Loss: 16.058 Vali Loss: 57.966 Vali Acc: 0.251 Test Loss: 57.966 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.499183416366577
Epoch: 19, Steps: 17 | Train Loss: 14.717 Vali Loss: 39.362 Vali Acc: 0.228 Test Loss: 39.362 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.622725248336792
Epoch: 20, Steps: 17 | Train Loss: 12.234 Vali Loss: 58.017 Vali Acc: 0.270 Test Loss: 58.017 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 532860
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.447270154953003
Epoch: 1, Steps: 17 | Train Loss: 9.097 Vali Loss: 14.034 Vali Acc: 0.251 Test Loss: 14.034 Test Acc: 0.251
Validation loss decreased (inf --> -0.250810).  Saving model ...
Epoch: 2 cost time: 2.2981131076812744
Epoch: 2, Steps: 17 | Train Loss: 9.610 Vali Loss: 20.287 Vali Acc: 0.247 Test Loss: 20.287 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3572001457214355
Epoch: 3, Steps: 17 | Train Loss: 11.790 Vali Loss: 15.473 Vali Acc: 0.247 Test Loss: 15.473 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4991235733032227
Epoch: 4, Steps: 17 | Train Loss: 12.948 Vali Loss: 33.010 Vali Acc: 0.251 Test Loss: 33.010 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4125964641571045
Epoch: 5, Steps: 17 | Train Loss: 21.000 Vali Loss: 24.158 Vali Acc: 0.240 Test Loss: 24.158 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.287841796875
Epoch: 6, Steps: 17 | Train Loss: 14.441 Vali Loss: 21.355 Vali Acc: 0.247 Test Loss: 21.355 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5972869396209717
Epoch: 7, Steps: 17 | Train Loss: 23.585 Vali Loss: 23.229 Vali Acc: 0.259 Test Loss: 23.229 Test Acc: 0.259
Validation loss decreased (-0.250810 --> -0.258323).  Saving model ...
Epoch: 8 cost time: 2.692699670791626
Epoch: 8, Steps: 17 | Train Loss: 31.506 Vali Loss: 39.576 Vali Acc: 0.259 Test Loss: 39.576 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.295966863632202
Epoch: 9, Steps: 17 | Train Loss: 17.053 Vali Loss: 28.517 Vali Acc: 0.266 Test Loss: 28.517 Test Acc: 0.266
Validation loss decreased (-0.258323 --> -0.265875).  Saving model ...
Epoch: 10 cost time: 2.226651191711426
Epoch: 10, Steps: 17 | Train Loss: 28.873 Vali Loss: 32.376 Vali Acc: 0.255 Test Loss: 32.376 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.402195930480957
Epoch: 11, Steps: 17 | Train Loss: 23.433 Vali Loss: 45.838 Vali Acc: 0.266 Test Loss: 45.838 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6619181632995605
Epoch: 12, Steps: 17 | Train Loss: 35.791 Vali Loss: 58.411 Vali Acc: 0.247 Test Loss: 58.411 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.4221689701080322
Epoch: 13, Steps: 17 | Train Loss: 35.390 Vali Loss: 43.149 Vali Acc: 0.251 Test Loss: 43.149 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.381988763809204
Epoch: 14, Steps: 17 | Train Loss: 21.805 Vali Loss: 36.301 Vali Acc: 0.247 Test Loss: 36.301 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.47800612449646
Epoch: 15, Steps: 17 | Train Loss: 18.380 Vali Loss: 36.602 Vali Acc: 0.270 Test Loss: 36.602 Test Acc: 0.270
Validation loss decreased (-0.265875 --> -0.269596).  Saving model ...
Epoch: 16 cost time: 2.5448038578033447
Epoch: 16, Steps: 17 | Train Loss: 19.455 Vali Loss: 82.001 Vali Acc: 0.270 Test Loss: 82.001 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4483730792999268
Epoch: 17, Steps: 17 | Train Loss: 19.543 Vali Loss: 42.164 Vali Acc: 0.255 Test Loss: 42.164 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3880233764648438
Epoch: 18, Steps: 17 | Train Loss: 7.862 Vali Loss: 28.662 Vali Acc: 0.255 Test Loss: 28.662 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.399632215499878
Epoch: 19, Steps: 17 | Train Loss: 9.031 Vali Loss: 31.468 Vali Acc: 0.259 Test Loss: 31.468 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.187391519546509
Epoch: 20, Steps: 17 | Train Loss: 15.296 Vali Loss: 58.293 Vali Acc: 0.240 Test Loss: 58.293 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.181400775909424
Epoch: 21, Steps: 17 | Train Loss: 12.969 Vali Loss: 65.489 Vali Acc: 0.270 Test Loss: 65.489 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.1510560512542725
Epoch: 22, Steps: 17 | Train Loss: 16.676 Vali Loss: 50.869 Vali Acc: 0.270 Test Loss: 50.869 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.200509548187256
Epoch: 23, Steps: 17 | Train Loss: 8.178 Vali Loss: 60.442 Vali Acc: 0.259 Test Loss: 60.442 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.287243366241455
Epoch: 24, Steps: 17 | Train Loss: 6.063 Vali Loss: 71.337 Vali Acc: 0.240 Test Loss: 71.337 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.2635931968688965
Epoch: 25, Steps: 17 | Train Loss: 9.181 Vali Loss: 73.150 Vali Acc: 0.251 Test Loss: 73.150 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 532860
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.551194429397583
Epoch: 1, Steps: 17 | Train Loss: 8.826 Vali Loss: 9.928 Vali Acc: 0.236 Test Loss: 9.928 Test Acc: 0.236
Validation loss decreased (inf --> -0.235642).  Saving model ...
Epoch: 2 cost time: 2.1405580043792725
Epoch: 2, Steps: 17 | Train Loss: 10.223 Vali Loss: 13.816 Vali Acc: 0.240 Test Loss: 13.816 Test Acc: 0.240
Validation loss decreased (-0.235642 --> -0.239406).  Saving model ...
Epoch: 3 cost time: 2.2351973056793213
Epoch: 3, Steps: 17 | Train Loss: 16.637 Vali Loss: 19.215 Vali Acc: 0.255 Test Loss: 19.215 Test Acc: 0.255
Validation loss decreased (-0.239406 --> -0.254561).  Saving model ...
Epoch: 4 cost time: 1.985325813293457
Epoch: 4, Steps: 17 | Train Loss: 25.874 Vali Loss: 23.170 Vali Acc: 0.251 Test Loss: 23.170 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3645710945129395
Epoch: 5, Steps: 17 | Train Loss: 19.504 Vali Loss: 22.344 Vali Acc: 0.266 Test Loss: 22.344 Test Acc: 0.266
Validation loss decreased (-0.254561 --> -0.265936).  Saving model ...
Epoch: 6 cost time: 2.270636558532715
Epoch: 6, Steps: 17 | Train Loss: 15.451 Vali Loss: 30.340 Vali Acc: 0.247 Test Loss: 30.340 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.190974235534668
Epoch: 7, Steps: 17 | Train Loss: 23.015 Vali Loss: 22.608 Vali Acc: 0.251 Test Loss: 22.608 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.133476972579956
Epoch: 8, Steps: 17 | Train Loss: 25.572 Vali Loss: 39.515 Vali Acc: 0.270 Test Loss: 39.515 Test Acc: 0.270
Validation loss decreased (-0.265936 --> -0.269567).  Saving model ...
Epoch: 9 cost time: 2.0097427368164062
Epoch: 9, Steps: 17 | Train Loss: 29.213 Vali Loss: 27.057 Vali Acc: 0.243 Test Loss: 27.057 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.103937864303589
Epoch: 10, Steps: 17 | Train Loss: 30.125 Vali Loss: 26.054 Vali Acc: 0.259 Test Loss: 26.054 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3686139583587646
Epoch: 11, Steps: 17 | Train Loss: 29.123 Vali Loss: 35.179 Vali Acc: 0.224 Test Loss: 35.179 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.242588996887207
Epoch: 12, Steps: 17 | Train Loss: 23.808 Vali Loss: 29.802 Vali Acc: 0.236 Test Loss: 29.802 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4609732627868652
Epoch: 13, Steps: 17 | Train Loss: 18.636 Vali Loss: 45.868 Vali Acc: 0.251 Test Loss: 45.868 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.465280771255493
Epoch: 14, Steps: 17 | Train Loss: 23.449 Vali Loss: 45.960 Vali Acc: 0.259 Test Loss: 45.960 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.6556618213653564
Epoch: 15, Steps: 17 | Train Loss: 16.124 Vali Loss: 47.648 Vali Acc: 0.266 Test Loss: 47.648 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.74340558052063
Epoch: 16, Steps: 17 | Train Loss: 10.078 Vali Loss: 27.159 Vali Acc: 0.259 Test Loss: 27.159 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.8208529949188232
Epoch: 17, Steps: 17 | Train Loss: 10.625 Vali Loss: 34.788 Vali Acc: 0.243 Test Loss: 34.788 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.496001720428467
Epoch: 18, Steps: 17 | Train Loss: 20.441 Vali Loss: 40.479 Vali Acc: 0.221 Test Loss: 40.479 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 532860
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.946789503097534
Epoch: 1, Steps: 17 | Train Loss: 7.987 Vali Loss: 10.611 Vali Acc: 0.251 Test Loss: 10.611 Test Acc: 0.251
Validation loss decreased (inf --> -0.250844).  Saving model ...
Epoch: 2 cost time: 2.2039740085601807
Epoch: 2, Steps: 17 | Train Loss: 11.344 Vali Loss: 10.762 Vali Acc: 0.236 Test Loss: 10.762 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0789742469787598
Epoch: 3, Steps: 17 | Train Loss: 14.819 Vali Loss: 7.375 Vali Acc: 0.266 Test Loss: 7.375 Test Acc: 0.266
Validation loss decreased (-0.250844 --> -0.266086).  Saving model ...
Epoch: 4 cost time: 2.1322147846221924
Epoch: 4, Steps: 17 | Train Loss: 13.287 Vali Loss: 6.995 Vali Acc: 0.270 Test Loss: 6.995 Test Acc: 0.270
Validation loss decreased (-0.266086 --> -0.269892).  Saving model ...
Epoch: 5 cost time: 2.167253017425537
Epoch: 5, Steps: 17 | Train Loss: 16.737 Vali Loss: 32.040 Vali Acc: 0.251 Test Loss: 32.040 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9768171310424805
Epoch: 6, Steps: 17 | Train Loss: 14.961 Vali Loss: 14.977 Vali Acc: 0.289 Test Loss: 14.977 Test Acc: 0.289
Validation loss decreased (-0.269892 --> -0.288824).  Saving model ...
Epoch: 7 cost time: 1.950409173965454
Epoch: 7, Steps: 17 | Train Loss: 27.225 Vali Loss: 45.909 Vali Acc: 0.262 Test Loss: 45.909 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.055943012237549
Epoch: 8, Steps: 17 | Train Loss: 39.420 Vali Loss: 61.741 Vali Acc: 0.251 Test Loss: 61.741 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1024768352508545
Epoch: 9, Steps: 17 | Train Loss: 31.666 Vali Loss: 31.074 Vali Acc: 0.259 Test Loss: 31.074 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8802530765533447
Epoch: 10, Steps: 17 | Train Loss: 41.950 Vali Loss: 44.942 Vali Acc: 0.251 Test Loss: 44.942 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8896129131317139
Epoch: 11, Steps: 17 | Train Loss: 24.979 Vali Loss: 26.292 Vali Acc: 0.262 Test Loss: 26.292 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0164685249328613
Epoch: 12, Steps: 17 | Train Loss: 25.178 Vali Loss: 25.115 Vali Acc: 0.251 Test Loss: 25.115 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0139145851135254
Epoch: 13, Steps: 17 | Train Loss: 27.694 Vali Loss: 36.424 Vali Acc: 0.266 Test Loss: 36.424 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1842098236083984
Epoch: 14, Steps: 17 | Train Loss: 15.386 Vali Loss: 35.405 Vali Acc: 0.251 Test Loss: 35.405 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1306846141815186
Epoch: 15, Steps: 17 | Train Loss: 15.107 Vali Loss: 29.292 Vali Acc: 0.251 Test Loss: 29.292 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.30391526222229
Epoch: 16, Steps: 17 | Train Loss: 12.809 Vali Loss: 29.483 Vali Acc: 0.270 Test Loss: 29.483 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 532860
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.588075637817383
Epoch: 1, Steps: 17 | Train Loss: 8.918 Vali Loss: 12.546 Vali Acc: 0.243 Test Loss: 12.546 Test Acc: 0.243
Validation loss decreased (inf --> -0.243221).  Saving model ...
Epoch: 2 cost time: 2.8130738735198975
Epoch: 2, Steps: 17 | Train Loss: 9.180 Vali Loss: 13.365 Vali Acc: 0.240 Test Loss: 13.365 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7497992515563965
Epoch: 3, Steps: 17 | Train Loss: 19.691 Vali Loss: 13.044 Vali Acc: 0.259 Test Loss: 13.044 Test Acc: 0.259
Validation loss decreased (-0.243221 --> -0.258425).  Saving model ...
Epoch: 4 cost time: 2.8578805923461914
Epoch: 4, Steps: 17 | Train Loss: 22.418 Vali Loss: 53.048 Vali Acc: 0.262 Test Loss: 53.048 Test Acc: 0.262
Validation loss decreased (-0.258425 --> -0.261827).  Saving model ...
Epoch: 5 cost time: 3.0457708835601807
Epoch: 5, Steps: 17 | Train Loss: 34.137 Vali Loss: 29.431 Vali Acc: 0.262 Test Loss: 29.431 Test Acc: 0.262
Validation loss decreased (-0.261827 --> -0.262063).  Saving model ...
Epoch: 6 cost time: 2.5435986518859863
Epoch: 6, Steps: 17 | Train Loss: 17.784 Vali Loss: 28.826 Vali Acc: 0.251 Test Loss: 28.826 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8158886432647705
Epoch: 7, Steps: 17 | Train Loss: 18.068 Vali Loss: 46.836 Vali Acc: 0.247 Test Loss: 46.836 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9501771926879883
Epoch: 8, Steps: 17 | Train Loss: 27.483 Vali Loss: 45.544 Vali Acc: 0.266 Test Loss: 45.544 Test Acc: 0.266
Validation loss decreased (-0.262063 --> -0.265704).  Saving model ...
Epoch: 9 cost time: 2.8389830589294434
Epoch: 9, Steps: 17 | Train Loss: 21.216 Vali Loss: 48.345 Vali Acc: 0.247 Test Loss: 48.345 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.963947057723999
Epoch: 10, Steps: 17 | Train Loss: 29.332 Vali Loss: 39.041 Vali Acc: 0.266 Test Loss: 39.041 Test Acc: 0.266
Validation loss decreased (-0.265704 --> -0.265769).  Saving model ...
Epoch: 11 cost time: 2.708754539489746
Epoch: 11, Steps: 17 | Train Loss: 18.220 Vali Loss: 49.692 Vali Acc: 0.281 Test Loss: 49.692 Test Acc: 0.281
Validation loss decreased (-0.265769 --> -0.280872).  Saving model ...
Epoch: 12 cost time: 2.6365315914154053
Epoch: 12, Steps: 17 | Train Loss: 22.833 Vali Loss: 25.781 Vali Acc: 0.236 Test Loss: 25.781 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6407246589660645
Epoch: 13, Steps: 17 | Train Loss: 21.958 Vali Loss: 39.557 Vali Acc: 0.232 Test Loss: 39.557 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7917118072509766
Epoch: 14, Steps: 17 | Train Loss: 31.055 Vali Loss: 32.445 Vali Acc: 0.266 Test Loss: 32.445 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.622912883758545
Epoch: 15, Steps: 17 | Train Loss: 10.751 Vali Loss: 41.012 Vali Acc: 0.281 Test Loss: 41.012 Test Acc: 0.281
Validation loss decreased (-0.280872 --> -0.280959).  Saving model ...
Epoch: 16 cost time: 2.5435776710510254
Epoch: 16, Steps: 17 | Train Loss: 26.334 Vali Loss: 36.350 Vali Acc: 0.270 Test Loss: 36.350 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.708524465560913
Epoch: 17, Steps: 17 | Train Loss: 27.308 Vali Loss: 41.750 Vali Acc: 0.274 Test Loss: 41.750 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7178406715393066
Epoch: 18, Steps: 17 | Train Loss: 11.941 Vali Loss: 57.352 Vali Acc: 0.247 Test Loss: 57.352 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.798985004425049
Epoch: 19, Steps: 17 | Train Loss: 11.547 Vali Loss: 54.047 Vali Acc: 0.266 Test Loss: 54.047 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.7728488445281982
Epoch: 20, Steps: 17 | Train Loss: 11.490 Vali Loss: 52.186 Vali Acc: 0.259 Test Loss: 52.186 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.9859132766723633
Epoch: 21, Steps: 17 | Train Loss: 10.467 Vali Loss: 49.678 Vali Acc: 0.285 Test Loss: 49.678 Test Acc: 0.285
Validation loss decreased (-0.280959 --> -0.284674).  Saving model ...
Epoch: 22 cost time: 3.203838586807251
Epoch: 22, Steps: 17 | Train Loss: 7.664 Vali Loss: 58.144 Vali Acc: 0.266 Test Loss: 58.144 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8847742080688477
Epoch: 23, Steps: 17 | Train Loss: 10.663 Vali Loss: 58.336 Vali Acc: 0.251 Test Loss: 58.336 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.791605234146118
Epoch: 24, Steps: 17 | Train Loss: 7.374 Vali Loss: 85.059 Vali Acc: 0.278 Test Loss: 85.059 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.7311673164367676
Epoch: 25, Steps: 17 | Train Loss: 18.724 Vali Loss: 95.486 Vali Acc: 0.285 Test Loss: 95.486 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.1118359565734863
Epoch: 26, Steps: 17 | Train Loss: 16.946 Vali Loss: 125.467 Vali Acc: 0.259 Test Loss: 125.467 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.845324754714966
Epoch: 27, Steps: 17 | Train Loss: 15.822 Vali Loss: 107.188 Vali Acc: 0.240 Test Loss: 107.188 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.0972695350646973
Epoch: 28, Steps: 17 | Train Loss: 7.224 Vali Loss: 134.524 Vali Acc: 0.236 Test Loss: 134.524 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.7472314834594727
Epoch: 29, Steps: 17 | Train Loss: 11.421 Vali Loss: 128.525 Vali Acc: 0.255 Test Loss: 128.525 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.0649561882019043
Epoch: 30, Steps: 17 | Train Loss: 5.685 Vali Loss: 131.091 Vali Acc: 0.236 Test Loss: 131.091 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.8831326961517334
Epoch: 31, Steps: 17 | Train Loss: 5.111 Vali Loss: 136.340 Vali Acc: 0.232 Test Loss: 136.340 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 500092
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.068436622619629
Epoch: 1, Steps: 17 | Train Loss: 8.913 Vali Loss: 11.584 Vali Acc: 0.274 Test Loss: 11.584 Test Acc: 0.274
Validation loss decreased (inf --> -0.273648).  Saving model ...
Epoch: 2 cost time: 2.1675353050231934
Epoch: 2, Steps: 17 | Train Loss: 10.285 Vali Loss: 9.543 Vali Acc: 0.236 Test Loss: 9.543 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.275545597076416
Epoch: 3, Steps: 17 | Train Loss: 14.263 Vali Loss: 14.230 Vali Acc: 0.236 Test Loss: 14.230 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3472042083740234
Epoch: 4, Steps: 17 | Train Loss: 11.814 Vali Loss: 37.283 Vali Acc: 0.255 Test Loss: 37.283 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4153506755828857
Epoch: 5, Steps: 17 | Train Loss: 26.141 Vali Loss: 57.019 Vali Acc: 0.255 Test Loss: 57.019 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.372591972351074
Epoch: 6, Steps: 17 | Train Loss: 31.284 Vali Loss: 19.719 Vali Acc: 0.247 Test Loss: 19.719 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.3662521839141846
Epoch: 7, Steps: 17 | Train Loss: 37.260 Vali Loss: 62.108 Vali Acc: 0.243 Test Loss: 62.108 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.473205089569092
Epoch: 8, Steps: 17 | Train Loss: 33.766 Vali Loss: 44.284 Vali Acc: 0.228 Test Loss: 44.284 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.4481990337371826
Epoch: 9, Steps: 17 | Train Loss: 22.922 Vali Loss: 44.459 Vali Acc: 0.247 Test Loss: 44.459 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.266242265701294
Epoch: 10, Steps: 17 | Train Loss: 27.412 Vali Loss: 17.417 Vali Acc: 0.251 Test Loss: 17.417 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.428328037261963
Epoch: 11, Steps: 17 | Train Loss: 18.056 Vali Loss: 36.622 Vali Acc: 0.255 Test Loss: 36.622 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 500092
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.440173149108887
Epoch: 1, Steps: 17 | Train Loss: 10.652 Vali Loss: 12.362 Vali Acc: 0.247 Test Loss: 12.362 Test Acc: 0.247
Validation loss decreased (inf --> -0.247025).  Saving model ...
Epoch: 2 cost time: 2.2016587257385254
Epoch: 2, Steps: 17 | Train Loss: 20.783 Vali Loss: 27.832 Vali Acc: 0.232 Test Loss: 27.832 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3832781314849854
Epoch: 3, Steps: 17 | Train Loss: 19.252 Vali Loss: 23.952 Vali Acc: 0.240 Test Loss: 23.952 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8344776630401611
Epoch: 4, Steps: 17 | Train Loss: 27.581 Vali Loss: 59.944 Vali Acc: 0.236 Test Loss: 59.944 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.088057279586792
Epoch: 5, Steps: 17 | Train Loss: 50.374 Vali Loss: 25.029 Vali Acc: 0.262 Test Loss: 25.029 Test Acc: 0.262
Validation loss decreased (-0.247025 --> -0.262107).  Saving model ...
Epoch: 6 cost time: 2.064610242843628
Epoch: 6, Steps: 17 | Train Loss: 21.558 Vali Loss: 14.927 Vali Acc: 0.240 Test Loss: 14.927 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0587048530578613
Epoch: 7, Steps: 17 | Train Loss: 20.957 Vali Loss: 38.060 Vali Acc: 0.251 Test Loss: 38.060 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8358094692230225
Epoch: 8, Steps: 17 | Train Loss: 23.355 Vali Loss: 56.124 Vali Acc: 0.259 Test Loss: 56.124 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.96872878074646
Epoch: 9, Steps: 17 | Train Loss: 37.159 Vali Loss: 34.359 Vali Acc: 0.243 Test Loss: 34.359 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.295135974884033
Epoch: 10, Steps: 17 | Train Loss: 19.538 Vali Loss: 24.987 Vali Acc: 0.240 Test Loss: 24.987 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1456425189971924
Epoch: 11, Steps: 17 | Train Loss: 16.062 Vali Loss: 41.647 Vali Acc: 0.255 Test Loss: 41.647 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.218902826309204
Epoch: 12, Steps: 17 | Train Loss: 30.625 Vali Loss: 55.565 Vali Acc: 0.255 Test Loss: 55.565 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.086665153503418
Epoch: 13, Steps: 17 | Train Loss: 36.661 Vali Loss: 21.572 Vali Acc: 0.266 Test Loss: 21.572 Test Acc: 0.266
Validation loss decreased (-0.262107 --> -0.265944).  Saving model ...
Epoch: 14 cost time: 2.0772688388824463
Epoch: 14, Steps: 17 | Train Loss: 16.441 Vali Loss: 42.452 Vali Acc: 0.266 Test Loss: 42.452 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.108335018157959
Epoch: 15, Steps: 17 | Train Loss: 16.577 Vali Loss: 24.910 Vali Acc: 0.270 Test Loss: 24.910 Test Acc: 0.270
Validation loss decreased (-0.265944 --> -0.269713).  Saving model ...
Epoch: 16 cost time: 1.970855474472046
Epoch: 16, Steps: 17 | Train Loss: 8.566 Vali Loss: 35.706 Vali Acc: 0.232 Test Loss: 35.706 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9911410808563232
Epoch: 17, Steps: 17 | Train Loss: 14.157 Vali Loss: 44.689 Vali Acc: 0.251 Test Loss: 44.689 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.059666395187378
Epoch: 18, Steps: 17 | Train Loss: 15.643 Vali Loss: 48.885 Vali Acc: 0.240 Test Loss: 48.885 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.023207426071167
Epoch: 19, Steps: 17 | Train Loss: 14.033 Vali Loss: 49.494 Vali Acc: 0.255 Test Loss: 49.494 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0853774547576904
Epoch: 20, Steps: 17 | Train Loss: 12.388 Vali Loss: 73.087 Vali Acc: 0.247 Test Loss: 73.087 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.112539529800415
Epoch: 21, Steps: 17 | Train Loss: 23.624 Vali Loss: 46.173 Vali Acc: 0.262 Test Loss: 46.173 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.0610172748565674
Epoch: 22, Steps: 17 | Train Loss: 19.579 Vali Loss: 87.702 Vali Acc: 0.236 Test Loss: 87.702 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.154716730117798
Epoch: 23, Steps: 17 | Train Loss: 13.315 Vali Loss: 71.014 Vali Acc: 0.259 Test Loss: 71.014 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.1860694885253906
Epoch: 24, Steps: 17 | Train Loss: 11.722 Vali Loss: 66.540 Vali Acc: 0.228 Test Loss: 66.540 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.012442111968994
Epoch: 25, Steps: 17 | Train Loss: 9.373 Vali Loss: 84.506 Vali Acc: 0.251 Test Loss: 84.506 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 500092
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.650561571121216
Epoch: 1, Steps: 17 | Train Loss: 7.943 Vali Loss: 9.189 Vali Acc: 0.247 Test Loss: 9.189 Test Acc: 0.247
Validation loss decreased (inf --> -0.247056).  Saving model ...
Epoch: 2 cost time: 2.17315936088562
Epoch: 2, Steps: 17 | Train Loss: 11.067 Vali Loss: 16.222 Vali Acc: 0.251 Test Loss: 16.222 Test Acc: 0.251
Validation loss decreased (-0.247056 --> -0.250788).  Saving model ...
Epoch: 3 cost time: 2.246424913406372
Epoch: 3, Steps: 17 | Train Loss: 14.642 Vali Loss: 18.501 Vali Acc: 0.255 Test Loss: 18.501 Test Acc: 0.255
Validation loss decreased (-0.250788 --> -0.254568).  Saving model ...
Epoch: 4 cost time: 2.1313364505767822
Epoch: 4, Steps: 17 | Train Loss: 13.506 Vali Loss: 28.193 Vali Acc: 0.255 Test Loss: 28.193 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.505080223083496
Epoch: 5, Steps: 17 | Train Loss: 27.600 Vali Loss: 52.062 Vali Acc: 0.251 Test Loss: 52.062 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6381635665893555
Epoch: 6, Steps: 17 | Train Loss: 40.667 Vali Loss: 49.532 Vali Acc: 0.224 Test Loss: 49.532 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5719542503356934
Epoch: 7, Steps: 17 | Train Loss: 49.090 Vali Loss: 42.383 Vali Acc: 0.251 Test Loss: 42.383 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4625749588012695
Epoch: 8, Steps: 17 | Train Loss: 20.825 Vali Loss: 16.772 Vali Acc: 0.266 Test Loss: 16.772 Test Acc: 0.266
Validation loss decreased (-0.254568 --> -0.265992).  Saving model ...
Epoch: 9 cost time: 2.46372389793396
Epoch: 9, Steps: 17 | Train Loss: 21.276 Vali Loss: 44.461 Vali Acc: 0.274 Test Loss: 44.461 Test Acc: 0.274
Validation loss decreased (-0.265992 --> -0.273320).  Saving model ...
Epoch: 10 cost time: 2.5864994525909424
Epoch: 10, Steps: 17 | Train Loss: 34.621 Vali Loss: 48.957 Vali Acc: 0.259 Test Loss: 48.957 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.32916259765625
Epoch: 11, Steps: 17 | Train Loss: 32.891 Vali Loss: 49.262 Vali Acc: 0.293 Test Loss: 49.262 Test Acc: 0.293
Validation loss decreased (-0.273320 --> -0.292283).  Saving model ...
Epoch: 12 cost time: 2.3178305625915527
Epoch: 12, Steps: 17 | Train Loss: 32.027 Vali Loss: 37.811 Vali Acc: 0.247 Test Loss: 37.811 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4788975715637207
Epoch: 13, Steps: 17 | Train Loss: 27.346 Vali Loss: 36.693 Vali Acc: 0.247 Test Loss: 36.693 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6640424728393555
Epoch: 14, Steps: 17 | Train Loss: 23.777 Vali Loss: 20.703 Vali Acc: 0.300 Test Loss: 20.703 Test Acc: 0.300
Validation loss decreased (-0.292283 --> -0.300173).  Saving model ...
Epoch: 15 cost time: 2.2867941856384277
Epoch: 15, Steps: 17 | Train Loss: 7.697 Vali Loss: 34.608 Vali Acc: 0.270 Test Loss: 34.608 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4086852073669434
Epoch: 16, Steps: 17 | Train Loss: 12.713 Vali Loss: 41.601 Vali Acc: 0.251 Test Loss: 41.601 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.413863182067871
Epoch: 17, Steps: 17 | Train Loss: 12.697 Vali Loss: 41.187 Vali Acc: 0.262 Test Loss: 41.187 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.464495897293091
Epoch: 18, Steps: 17 | Train Loss: 8.729 Vali Loss: 31.262 Vali Acc: 0.247 Test Loss: 31.262 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4938623905181885
Epoch: 19, Steps: 17 | Train Loss: 6.285 Vali Loss: 50.249 Vali Acc: 0.255 Test Loss: 50.249 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.275151014328003
Epoch: 20, Steps: 17 | Train Loss: 7.526 Vali Loss: 58.108 Vali Acc: 0.259 Test Loss: 58.108 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.423279285430908
Epoch: 21, Steps: 17 | Train Loss: 11.708 Vali Loss: 48.875 Vali Acc: 0.228 Test Loss: 48.875 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.5299570560455322
Epoch: 22, Steps: 17 | Train Loss: 13.978 Vali Loss: 76.530 Vali Acc: 0.259 Test Loss: 76.530 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.2549824714660645
Epoch: 23, Steps: 17 | Train Loss: 15.431 Vali Loss: 66.478 Vali Acc: 0.243 Test Loss: 66.478 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.4936153888702393
Epoch: 24, Steps: 17 | Train Loss: 9.256 Vali Loss: 97.364 Vali Acc: 0.262 Test Loss: 97.364 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 500092
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.934362411499023
Epoch: 1, Steps: 17 | Train Loss: 11.375 Vali Loss: 11.382 Vali Acc: 0.259 Test Loss: 11.382 Test Acc: 0.259
Validation loss decreased (inf --> -0.258441).  Saving model ...
Epoch: 2 cost time: 2.7942681312561035
Epoch: 2, Steps: 17 | Train Loss: 15.526 Vali Loss: 16.256 Vali Acc: 0.247 Test Loss: 16.256 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.989734172821045
Epoch: 3, Steps: 17 | Train Loss: 18.902 Vali Loss: 30.490 Vali Acc: 0.247 Test Loss: 30.490 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.9168686866760254
Epoch: 4, Steps: 17 | Train Loss: 21.223 Vali Loss: 18.123 Vali Acc: 0.255 Test Loss: 18.123 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.937824249267578
Epoch: 5, Steps: 17 | Train Loss: 14.677 Vali Loss: 19.619 Vali Acc: 0.247 Test Loss: 19.619 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5498831272125244
Epoch: 6, Steps: 17 | Train Loss: 19.101 Vali Loss: 17.163 Vali Acc: 0.209 Test Loss: 17.163 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.531559467315674
Epoch: 7, Steps: 17 | Train Loss: 19.790 Vali Loss: 32.025 Vali Acc: 0.285 Test Loss: 32.025 Test Acc: 0.285
Validation loss decreased (-0.258441 --> -0.284851).  Saving model ...
Epoch: 8 cost time: 2.500807762145996
Epoch: 8, Steps: 17 | Train Loss: 23.228 Vali Loss: 34.964 Vali Acc: 0.259 Test Loss: 34.964 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4227161407470703
Epoch: 9, Steps: 17 | Train Loss: 27.452 Vali Loss: 48.620 Vali Acc: 0.247 Test Loss: 48.620 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.252254009246826
Epoch: 10, Steps: 17 | Train Loss: 36.759 Vali Loss: 35.322 Vali Acc: 0.259 Test Loss: 35.322 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.143293857574463
Epoch: 11, Steps: 17 | Train Loss: 16.459 Vali Loss: 18.664 Vali Acc: 0.251 Test Loss: 18.664 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6445395946502686
Epoch: 12, Steps: 17 | Train Loss: 13.405 Vali Loss: 18.355 Vali Acc: 0.285 Test Loss: 18.355 Test Acc: 0.285
Validation loss decreased (-0.284851 --> -0.284988).  Saving model ...
Epoch: 13 cost time: 2.8411500453948975
Epoch: 13, Steps: 17 | Train Loss: 24.500 Vali Loss: 38.355 Vali Acc: 0.266 Test Loss: 38.355 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.726473093032837
Epoch: 14, Steps: 17 | Train Loss: 21.498 Vali Loss: 28.013 Vali Acc: 0.198 Test Loss: 28.013 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.049304962158203
Epoch: 15, Steps: 17 | Train Loss: 16.481 Vali Loss: 50.276 Vali Acc: 0.255 Test Loss: 50.276 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.878467321395874
Epoch: 16, Steps: 17 | Train Loss: 20.122 Vali Loss: 47.002 Vali Acc: 0.232 Test Loss: 47.002 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.854165554046631
Epoch: 17, Steps: 17 | Train Loss: 12.752 Vali Loss: 40.856 Vali Acc: 0.217 Test Loss: 40.856 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.8818631172180176
Epoch: 18, Steps: 17 | Train Loss: 22.491 Vali Loss: 27.934 Vali Acc: 0.278 Test Loss: 27.934 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.797536611557007
Epoch: 19, Steps: 17 | Train Loss: 11.865 Vali Loss: 40.819 Vali Acc: 0.270 Test Loss: 40.819 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.745962381362915
Epoch: 20, Steps: 17 | Train Loss: 12.544 Vali Loss: 55.376 Vali Acc: 0.281 Test Loss: 55.376 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.952019453048706
Epoch: 21, Steps: 17 | Train Loss: 13.701 Vali Loss: 50.962 Vali Acc: 0.266 Test Loss: 50.962 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.8345234394073486
Epoch: 22, Steps: 17 | Train Loss: 9.362 Vali Loss: 79.646 Vali Acc: 0.266 Test Loss: 79.646 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 483708
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.393011569976807
Epoch: 1, Steps: 17 | Train Loss: 11.176 Vali Loss: 13.791 Vali Acc: 0.262 Test Loss: 13.791 Test Acc: 0.262
Validation loss decreased (inf --> -0.262220).  Saving model ...
Epoch: 2 cost time: 2.8538689613342285
Epoch: 2, Steps: 17 | Train Loss: 19.491 Vali Loss: 25.816 Vali Acc: 0.293 Test Loss: 25.816 Test Acc: 0.293
Validation loss decreased (-0.262220 --> -0.292518).  Saving model ...
Epoch: 3 cost time: 3.0285439491271973
Epoch: 3, Steps: 17 | Train Loss: 18.809 Vali Loss: 24.634 Vali Acc: 0.262 Test Loss: 24.634 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.806138038635254
Epoch: 4, Steps: 17 | Train Loss: 20.327 Vali Loss: 40.066 Vali Acc: 0.270 Test Loss: 40.066 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4864771366119385
Epoch: 5, Steps: 17 | Train Loss: 31.466 Vali Loss: 18.158 Vali Acc: 0.293 Test Loss: 18.158 Test Acc: 0.293
Validation loss decreased (-0.292518 --> -0.292594).  Saving model ...
Epoch: 6 cost time: 2.588329553604126
Epoch: 6, Steps: 17 | Train Loss: 28.676 Vali Loss: 32.216 Vali Acc: 0.259 Test Loss: 32.216 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0029735565185547
Epoch: 7, Steps: 17 | Train Loss: 26.661 Vali Loss: 45.777 Vali Acc: 0.236 Test Loss: 45.777 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7710587978363037
Epoch: 8, Steps: 17 | Train Loss: 26.793 Vali Loss: 19.174 Vali Acc: 0.274 Test Loss: 19.174 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.571890115737915
Epoch: 9, Steps: 17 | Train Loss: 20.908 Vali Loss: 29.759 Vali Acc: 0.243 Test Loss: 29.759 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.5342957973480225
Epoch: 10, Steps: 17 | Train Loss: 19.876 Vali Loss: 37.478 Vali Acc: 0.247 Test Loss: 37.478 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.7835676670074463
Epoch: 11, Steps: 17 | Train Loss: 20.168 Vali Loss: 20.401 Vali Acc: 0.270 Test Loss: 20.401 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.6179862022399902
Epoch: 12, Steps: 17 | Train Loss: 11.069 Vali Loss: 23.826 Vali Acc: 0.274 Test Loss: 23.826 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.486480712890625
Epoch: 13, Steps: 17 | Train Loss: 17.008 Vali Loss: 30.434 Vali Acc: 0.247 Test Loss: 30.434 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.7102315425872803
Epoch: 14, Steps: 17 | Train Loss: 23.515 Vali Loss: 42.120 Vali Acc: 0.270 Test Loss: 42.120 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.5939104557037354
Epoch: 15, Steps: 17 | Train Loss: 27.293 Vali Loss: 46.038 Vali Acc: 0.270 Test Loss: 46.038 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 483708
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.3309807777404785
Epoch: 1, Steps: 17 | Train Loss: 11.920 Vali Loss: 10.084 Vali Acc: 0.243 Test Loss: 10.084 Test Acc: 0.243
Validation loss decreased (inf --> -0.243245).  Saving model ...
Epoch: 2 cost time: 2.3709306716918945
Epoch: 2, Steps: 17 | Train Loss: 13.117 Vali Loss: 20.207 Vali Acc: 0.251 Test Loss: 20.207 Test Acc: 0.251
Validation loss decreased (-0.243245 --> -0.250749).  Saving model ...
Epoch: 3 cost time: 2.9379384517669678
Epoch: 3, Steps: 17 | Train Loss: 11.221 Vali Loss: 6.699 Vali Acc: 0.259 Test Loss: 6.699 Test Acc: 0.259
Validation loss decreased (-0.250749 --> -0.258488).  Saving model ...
Epoch: 4 cost time: 2.4705631732940674
Epoch: 4, Steps: 17 | Train Loss: 14.116 Vali Loss: 17.652 Vali Acc: 0.224 Test Loss: 17.652 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.223559617996216
Epoch: 5, Steps: 17 | Train Loss: 15.211 Vali Loss: 16.432 Vali Acc: 0.236 Test Loss: 16.432 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7049505710601807
Epoch: 6, Steps: 17 | Train Loss: 19.499 Vali Loss: 20.657 Vali Acc: 0.266 Test Loss: 20.657 Test Acc: 0.266
Validation loss decreased (-0.258488 --> -0.265953).  Saving model ...
Epoch: 7 cost time: 2.53710675239563
Epoch: 7, Steps: 17 | Train Loss: 20.196 Vali Loss: 18.711 Vali Acc: 0.240 Test Loss: 18.711 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5920889377593994
Epoch: 8, Steps: 17 | Train Loss: 16.933 Vali Loss: 18.283 Vali Acc: 0.240 Test Loss: 18.283 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5148873329162598
Epoch: 9, Steps: 17 | Train Loss: 15.650 Vali Loss: 14.020 Vali Acc: 0.251 Test Loss: 14.020 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5965991020202637
Epoch: 10, Steps: 17 | Train Loss: 17.614 Vali Loss: 19.750 Vali Acc: 0.228 Test Loss: 19.750 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.180931806564331
Epoch: 11, Steps: 17 | Train Loss: 14.423 Vali Loss: 23.153 Vali Acc: 0.262 Test Loss: 23.153 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0361006259918213
Epoch: 12, Steps: 17 | Train Loss: 22.148 Vali Loss: 37.065 Vali Acc: 0.285 Test Loss: 37.065 Test Acc: 0.285
Validation loss decreased (-0.265953 --> -0.284800).  Saving model ...
Epoch: 13 cost time: 2.5354580879211426
Epoch: 13, Steps: 17 | Train Loss: 25.493 Vali Loss: 37.629 Vali Acc: 0.255 Test Loss: 37.629 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.638259172439575
Epoch: 14, Steps: 17 | Train Loss: 24.944 Vali Loss: 44.196 Vali Acc: 0.247 Test Loss: 44.196 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.543095588684082
Epoch: 15, Steps: 17 | Train Loss: 18.961 Vali Loss: 49.776 Vali Acc: 0.274 Test Loss: 49.776 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.522529125213623
Epoch: 16, Steps: 17 | Train Loss: 21.382 Vali Loss: 44.339 Vali Acc: 0.293 Test Loss: 44.339 Test Acc: 0.293
Validation loss decreased (-0.284800 --> -0.292332).  Saving model ...
Epoch: 17 cost time: 2.6208672523498535
Epoch: 17, Steps: 17 | Train Loss: 23.439 Vali Loss: 54.575 Vali Acc: 0.289 Test Loss: 54.575 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.39082932472229
Epoch: 18, Steps: 17 | Train Loss: 10.579 Vali Loss: 46.441 Vali Acc: 0.232 Test Loss: 46.441 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8219339847564697
Epoch: 19, Steps: 17 | Train Loss: 20.322 Vali Loss: 59.670 Vali Acc: 0.205 Test Loss: 59.670 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.6103670597076416
Epoch: 20, Steps: 17 | Train Loss: 13.842 Vali Loss: 52.208 Vali Acc: 0.224 Test Loss: 52.208 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.5995118618011475
Epoch: 21, Steps: 17 | Train Loss: 22.409 Vali Loss: 87.973 Vali Acc: 0.251 Test Loss: 87.973 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.310137987136841
Epoch: 22, Steps: 17 | Train Loss: 13.931 Vali Loss: 63.476 Vali Acc: 0.240 Test Loss: 63.476 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9976646900177002
Epoch: 23, Steps: 17 | Train Loss: 8.472 Vali Loss: 67.946 Vali Acc: 0.228 Test Loss: 67.946 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0851705074310303
Epoch: 24, Steps: 17 | Train Loss: 5.264 Vali Loss: 78.150 Vali Acc: 0.221 Test Loss: 78.150 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.240072727203369
Epoch: 25, Steps: 17 | Train Loss: 4.566 Vali Loss: 74.263 Vali Acc: 0.251 Test Loss: 74.263 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.363809823989868
Epoch: 26, Steps: 17 | Train Loss: 5.745 Vali Loss: 93.298 Vali Acc: 0.194 Test Loss: 93.298 Test Acc: 0.194
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 483708
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8828442096710205
Epoch: 1, Steps: 17 | Train Loss: 8.036 Vali Loss: 9.968 Vali Acc: 0.251 Test Loss: 9.968 Test Acc: 0.251
Validation loss decreased (inf --> -0.250851).  Saving model ...
Epoch: 2 cost time: 2.246338129043579
Epoch: 2, Steps: 17 | Train Loss: 9.498 Vali Loss: 29.345 Vali Acc: 0.251 Test Loss: 29.345 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8343439102172852
Epoch: 3, Steps: 17 | Train Loss: 16.661 Vali Loss: 12.651 Vali Acc: 0.240 Test Loss: 12.651 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9187955856323242
Epoch: 4, Steps: 17 | Train Loss: 15.459 Vali Loss: 11.518 Vali Acc: 0.255 Test Loss: 11.518 Test Acc: 0.255
Validation loss decreased (-0.250851 --> -0.254638).  Saving model ...
Epoch: 5 cost time: 2.3051061630249023
Epoch: 5, Steps: 17 | Train Loss: 13.830 Vali Loss: 17.845 Vali Acc: 0.255 Test Loss: 17.845 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9277009963989258
Epoch: 6, Steps: 17 | Train Loss: 27.006 Vali Loss: 39.883 Vali Acc: 0.251 Test Loss: 39.883 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.90677809715271
Epoch: 7, Steps: 17 | Train Loss: 30.595 Vali Loss: 24.850 Vali Acc: 0.266 Test Loss: 24.850 Test Acc: 0.266
Validation loss decreased (-0.254638 --> -0.265911).  Saving model ...
Epoch: 8 cost time: 1.9371833801269531
Epoch: 8, Steps: 17 | Train Loss: 22.675 Vali Loss: 29.335 Vali Acc: 0.259 Test Loss: 29.335 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.263517141342163
Epoch: 9, Steps: 17 | Train Loss: 15.263 Vali Loss: 23.688 Vali Acc: 0.270 Test Loss: 23.688 Test Acc: 0.270
Validation loss decreased (-0.265911 --> -0.269725).  Saving model ...
Epoch: 10 cost time: 2.01599383354187
Epoch: 10, Steps: 17 | Train Loss: 25.329 Vali Loss: 36.482 Vali Acc: 0.266 Test Loss: 36.482 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0809173583984375
Epoch: 11, Steps: 17 | Train Loss: 22.307 Vali Loss: 19.690 Vali Acc: 0.266 Test Loss: 19.690 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1351020336151123
Epoch: 12, Steps: 17 | Train Loss: 20.110 Vali Loss: 38.113 Vali Acc: 0.274 Test Loss: 38.113 Test Acc: 0.274
Validation loss decreased (-0.269725 --> -0.273383).  Saving model ...
Epoch: 13 cost time: 2.1302883625030518
Epoch: 13, Steps: 17 | Train Loss: 16.716 Vali Loss: 35.219 Vali Acc: 0.251 Test Loss: 35.219 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3895695209503174
Epoch: 14, Steps: 17 | Train Loss: 18.829 Vali Loss: 24.182 Vali Acc: 0.255 Test Loss: 24.182 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.034245252609253
Epoch: 15, Steps: 17 | Train Loss: 8.727 Vali Loss: 17.982 Vali Acc: 0.255 Test Loss: 17.982 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3672144412994385
Epoch: 16, Steps: 17 | Train Loss: 7.362 Vali Loss: 35.526 Vali Acc: 0.278 Test Loss: 35.526 Test Acc: 0.278
Validation loss decreased (-0.273383 --> -0.277211).  Saving model ...
Epoch: 17 cost time: 2.321533679962158
Epoch: 17, Steps: 17 | Train Loss: 14.820 Vali Loss: 36.598 Vali Acc: 0.262 Test Loss: 36.598 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.942108392715454
Epoch: 18, Steps: 17 | Train Loss: 13.490 Vali Loss: 56.324 Vali Acc: 0.259 Test Loss: 56.324 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.062579870223999
Epoch: 19, Steps: 17 | Train Loss: 15.416 Vali Loss: 53.396 Vali Acc: 0.259 Test Loss: 53.396 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.227206230163574
Epoch: 20, Steps: 17 | Train Loss: 12.375 Vali Loss: 51.712 Vali Acc: 0.236 Test Loss: 51.712 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.964986801147461
Epoch: 21, Steps: 17 | Train Loss: 17.361 Vali Loss: 46.210 Vali Acc: 0.259 Test Loss: 46.210 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2373125553131104
Epoch: 22, Steps: 17 | Train Loss: 6.914 Vali Loss: 61.936 Vali Acc: 0.232 Test Loss: 61.936 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.017947196960449
Epoch: 23, Steps: 17 | Train Loss: 6.250 Vali Loss: 54.410 Vali Acc: 0.251 Test Loss: 54.410 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.3372859954833984
Epoch: 24, Steps: 17 | Train Loss: 4.710 Vali Loss: 66.352 Vali Acc: 0.240 Test Loss: 66.352 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.3256053924560547
Epoch: 25, Steps: 17 | Train Loss: 9.541 Vali Loss: 81.765 Vali Acc: 0.247 Test Loss: 81.765 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.443553924560547
Epoch: 26, Steps: 17 | Train Loss: 7.459 Vali Loss: 75.001 Vali Acc: 0.251 Test Loss: 75.001 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 483708
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.222703456878662
Epoch: 1, Steps: 17 | Train Loss: 7.894 Vali Loss: 7.005 Vali Acc: 0.266 Test Loss: 7.005 Test Acc: 0.266
Validation loss decreased (inf --> -0.266090).  Saving model ...
Epoch: 2 cost time: 1.7586026191711426
Epoch: 2, Steps: 17 | Train Loss: 5.990 Vali Loss: 9.564 Vali Acc: 0.270 Test Loss: 9.564 Test Acc: 0.270
Validation loss decreased (-0.266090 --> -0.269866).  Saving model ...
Epoch: 3 cost time: 1.9118525981903076
Epoch: 3, Steps: 17 | Train Loss: 8.319 Vali Loss: 7.393 Vali Acc: 0.224 Test Loss: 7.393 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.74428129196167
Epoch: 4, Steps: 17 | Train Loss: 7.167 Vali Loss: 7.284 Vali Acc: 0.236 Test Loss: 7.284 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0551135540008545
Epoch: 5, Steps: 17 | Train Loss: 14.919 Vali Loss: 17.758 Vali Acc: 0.243 Test Loss: 17.758 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4008710384368896
Epoch: 6, Steps: 17 | Train Loss: 14.817 Vali Loss: 14.781 Vali Acc: 0.255 Test Loss: 14.781 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1030049324035645
Epoch: 7, Steps: 17 | Train Loss: 8.971 Vali Loss: 13.669 Vali Acc: 0.251 Test Loss: 13.669 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9376225471496582
Epoch: 8, Steps: 17 | Train Loss: 15.244 Vali Loss: 13.110 Vali Acc: 0.243 Test Loss: 13.110 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.1359283924102783
Epoch: 9, Steps: 17 | Train Loss: 12.864 Vali Loss: 29.558 Vali Acc: 0.247 Test Loss: 29.558 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3642866611480713
Epoch: 10, Steps: 17 | Train Loss: 17.800 Vali Loss: 22.848 Vali Acc: 0.274 Test Loss: 22.848 Test Acc: 0.274
Validation loss decreased (-0.269866 --> -0.273536).  Saving model ...
Epoch: 11 cost time: 2.655040740966797
Epoch: 11, Steps: 17 | Train Loss: 10.722 Vali Loss: 11.150 Vali Acc: 0.243 Test Loss: 11.150 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2737619876861572
Epoch: 12, Steps: 17 | Train Loss: 9.939 Vali Loss: 19.092 Vali Acc: 0.255 Test Loss: 19.092 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5452680587768555
Epoch: 13, Steps: 17 | Train Loss: 15.504 Vali Loss: 25.145 Vali Acc: 0.262 Test Loss: 25.145 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.456354856491089
Epoch: 14, Steps: 17 | Train Loss: 8.749 Vali Loss: 10.332 Vali Acc: 0.221 Test Loss: 10.332 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5261070728302
Epoch: 15, Steps: 17 | Train Loss: 6.645 Vali Loss: 22.436 Vali Acc: 0.262 Test Loss: 22.436 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.2680625915527344
Epoch: 16, Steps: 17 | Train Loss: 9.747 Vali Loss: 11.216 Vali Acc: 0.240 Test Loss: 11.216 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.350253105163574
Epoch: 17, Steps: 17 | Train Loss: 10.002 Vali Loss: 18.715 Vali Acc: 0.255 Test Loss: 18.715 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0994222164154053
Epoch: 18, Steps: 17 | Train Loss: 10.976 Vali Loss: 18.714 Vali Acc: 0.190 Test Loss: 18.714 Test Acc: 0.190
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.299468517303467
Epoch: 19, Steps: 17 | Train Loss: 5.489 Vali Loss: 24.030 Vali Acc: 0.266 Test Loss: 24.030 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.0674421787261963
Epoch: 20, Steps: 17 | Train Loss: 8.928 Vali Loss: 16.665 Vali Acc: 0.251 Test Loss: 16.665 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 491740
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.371752500534058
Epoch: 1, Steps: 17 | Train Loss: 7.699 Vali Loss: 8.609 Vali Acc: 0.281 Test Loss: 8.609 Test Acc: 0.281
Validation loss decreased (inf --> -0.281283).  Saving model ...
Epoch: 2 cost time: 2.2441139221191406
Epoch: 2, Steps: 17 | Train Loss: 6.001 Vali Loss: 5.778 Vali Acc: 0.209 Test Loss: 5.778 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1743202209472656
Epoch: 3, Steps: 17 | Train Loss: 8.291 Vali Loss: 9.132 Vali Acc: 0.221 Test Loss: 9.132 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9797465801239014
Epoch: 4, Steps: 17 | Train Loss: 9.642 Vali Loss: 19.718 Vali Acc: 0.251 Test Loss: 19.718 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.168689012527466
Epoch: 5, Steps: 17 | Train Loss: 13.651 Vali Loss: 8.912 Vali Acc: 0.228 Test Loss: 8.912 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2567713260650635
Epoch: 6, Steps: 17 | Train Loss: 10.854 Vali Loss: 12.410 Vali Acc: 0.247 Test Loss: 12.410 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9811558723449707
Epoch: 7, Steps: 17 | Train Loss: 7.907 Vali Loss: 10.361 Vali Acc: 0.240 Test Loss: 10.361 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.2999162673950195
Epoch: 8, Steps: 17 | Train Loss: 10.566 Vali Loss: 22.755 Vali Acc: 0.262 Test Loss: 22.755 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.109010696411133
Epoch: 9, Steps: 17 | Train Loss: 16.893 Vali Loss: 29.667 Vali Acc: 0.259 Test Loss: 29.667 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.989480972290039
Epoch: 10, Steps: 17 | Train Loss: 21.692 Vali Loss: 22.898 Vali Acc: 0.266 Test Loss: 22.898 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8732874393463135
Epoch: 11, Steps: 17 | Train Loss: 8.200 Vali Loss: 13.236 Vali Acc: 0.243 Test Loss: 13.236 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 491740
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.216344356536865
Epoch: 1, Steps: 17 | Train Loss: 7.552 Vali Loss: 7.970 Vali Acc: 0.255 Test Loss: 7.970 Test Acc: 0.255
Validation loss decreased (inf --> -0.254673).  Saving model ...
Epoch: 2 cost time: 1.9137241840362549
Epoch: 2, Steps: 17 | Train Loss: 5.590 Vali Loss: 6.943 Vali Acc: 0.266 Test Loss: 6.943 Test Acc: 0.266
Validation loss decreased (-0.254673 --> -0.266090).  Saving model ...
Epoch: 3 cost time: 2.239431381225586
Epoch: 3, Steps: 17 | Train Loss: 7.255 Vali Loss: 7.364 Vali Acc: 0.205 Test Loss: 7.364 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1242146492004395
Epoch: 4, Steps: 17 | Train Loss: 7.652 Vali Loss: 9.933 Vali Acc: 0.243 Test Loss: 9.933 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0258841514587402
Epoch: 5, Steps: 17 | Train Loss: 6.738 Vali Loss: 9.484 Vali Acc: 0.255 Test Loss: 9.484 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.223163604736328
Epoch: 6, Steps: 17 | Train Loss: 8.503 Vali Loss: 15.206 Vali Acc: 0.240 Test Loss: 15.206 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.283074140548706
Epoch: 7, Steps: 17 | Train Loss: 11.373 Vali Loss: 12.158 Vali Acc: 0.205 Test Loss: 12.158 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4214365482330322
Epoch: 8, Steps: 17 | Train Loss: 7.361 Vali Loss: 14.939 Vali Acc: 0.255 Test Loss: 14.939 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.4775826930999756
Epoch: 9, Steps: 17 | Train Loss: 9.245 Vali Loss: 12.974 Vali Acc: 0.255 Test Loss: 12.974 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.13857364654541
Epoch: 10, Steps: 17 | Train Loss: 13.083 Vali Loss: 9.597 Vali Acc: 0.251 Test Loss: 9.597 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.923147201538086
Epoch: 11, Steps: 17 | Train Loss: 15.521 Vali Loss: 13.368 Vali Acc: 0.270 Test Loss: 13.368 Test Acc: 0.270
Validation loss decreased (-0.266090 --> -0.269828).  Saving model ...
Epoch: 12 cost time: 2.0926973819732666
Epoch: 12, Steps: 17 | Train Loss: 9.278 Vali Loss: 17.124 Vali Acc: 0.259 Test Loss: 17.124 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5628724098205566
Epoch: 13, Steps: 17 | Train Loss: 14.006 Vali Loss: 27.306 Vali Acc: 0.236 Test Loss: 27.306 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.154691696166992
Epoch: 14, Steps: 17 | Train Loss: 10.970 Vali Loss: 9.219 Vali Acc: 0.243 Test Loss: 9.219 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.058892011642456
Epoch: 15, Steps: 17 | Train Loss: 13.499 Vali Loss: 24.626 Vali Acc: 0.266 Test Loss: 24.626 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5514018535614014
Epoch: 16, Steps: 17 | Train Loss: 11.958 Vali Loss: 19.801 Vali Acc: 0.259 Test Loss: 19.801 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.2762179374694824
Epoch: 17, Steps: 17 | Train Loss: 12.893 Vali Loss: 18.706 Vali Acc: 0.274 Test Loss: 18.706 Test Acc: 0.274
Validation loss decreased (-0.269828 --> -0.273577).  Saving model ...
Epoch: 18 cost time: 2.2468299865722656
Epoch: 18, Steps: 17 | Train Loss: 8.227 Vali Loss: 19.379 Vali Acc: 0.217 Test Loss: 19.379 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2753727436065674
Epoch: 19, Steps: 17 | Train Loss: 5.423 Vali Loss: 16.748 Vali Acc: 0.232 Test Loss: 16.748 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1549878120422363
Epoch: 20, Steps: 17 | Train Loss: 7.578 Vali Loss: 22.011 Vali Acc: 0.281 Test Loss: 22.011 Test Acc: 0.281
Validation loss decreased (-0.273577 --> -0.281149).  Saving model ...
Epoch: 21 cost time: 2.354940891265869
Epoch: 21, Steps: 17 | Train Loss: 6.143 Vali Loss: 21.011 Vali Acc: 0.213 Test Loss: 21.011 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.291856288909912
Epoch: 22, Steps: 17 | Train Loss: 3.756 Vali Loss: 15.024 Vali Acc: 0.224 Test Loss: 15.024 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.389291524887085
Epoch: 23, Steps: 17 | Train Loss: 2.808 Vali Loss: 20.497 Vali Acc: 0.240 Test Loss: 20.497 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.141916275024414
Epoch: 24, Steps: 17 | Train Loss: 4.747 Vali Loss: 18.797 Vali Acc: 0.255 Test Loss: 18.797 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.3508951663970947
Epoch: 25, Steps: 17 | Train Loss: 3.563 Vali Loss: 20.155 Vali Acc: 0.278 Test Loss: 20.155 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.4078681468963623
Epoch: 26, Steps: 17 | Train Loss: 2.847 Vali Loss: 22.834 Vali Acc: 0.243 Test Loss: 22.834 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.0730090141296387
Epoch: 27, Steps: 17 | Train Loss: 2.388 Vali Loss: 23.295 Vali Acc: 0.270 Test Loss: 23.295 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.9405481815338135
Epoch: 28, Steps: 17 | Train Loss: 3.321 Vali Loss: 25.164 Vali Acc: 0.262 Test Loss: 25.164 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.196641683578491
Epoch: 29, Steps: 17 | Train Loss: 2.781 Vali Loss: 27.413 Vali Acc: 0.251 Test Loss: 27.413 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.161095380783081
Epoch: 30, Steps: 17 | Train Loss: 3.819 Vali Loss: 32.933 Vali Acc: 0.251 Test Loss: 32.933 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 491740
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.68707537651062
Epoch: 1, Steps: 17 | Train Loss: 6.959 Vali Loss: 9.596 Vali Acc: 0.251 Test Loss: 9.596 Test Acc: 0.251
Validation loss decreased (inf --> -0.250855).  Saving model ...
Epoch: 2 cost time: 2.2182528972625732
Epoch: 2, Steps: 17 | Train Loss: 7.895 Vali Loss: 6.308 Vali Acc: 0.243 Test Loss: 6.308 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1651313304901123
Epoch: 3, Steps: 17 | Train Loss: 7.429 Vali Loss: 7.338 Vali Acc: 0.270 Test Loss: 7.338 Test Acc: 0.270
Validation loss decreased (-0.250855 --> -0.269889).  Saving model ...
Epoch: 4 cost time: 2.1089601516723633
Epoch: 4, Steps: 17 | Train Loss: 6.805 Vali Loss: 7.446 Vali Acc: 0.243 Test Loss: 7.446 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2324278354644775
Epoch: 5, Steps: 17 | Train Loss: 7.481 Vali Loss: 13.454 Vali Acc: 0.259 Test Loss: 13.454 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.354142427444458
Epoch: 6, Steps: 17 | Train Loss: 11.151 Vali Loss: 19.277 Vali Acc: 0.266 Test Loss: 19.277 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.460024118423462
Epoch: 7, Steps: 17 | Train Loss: 13.705 Vali Loss: 19.785 Vali Acc: 0.251 Test Loss: 19.785 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.51289963722229
Epoch: 8, Steps: 17 | Train Loss: 11.808 Vali Loss: 19.397 Vali Acc: 0.236 Test Loss: 19.397 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.6022086143493652
Epoch: 9, Steps: 17 | Train Loss: 11.755 Vali Loss: 8.410 Vali Acc: 0.289 Test Loss: 8.410 Test Acc: 0.289
Validation loss decreased (-0.269889 --> -0.288889).  Saving model ...
Epoch: 10 cost time: 2.416776180267334
Epoch: 10, Steps: 17 | Train Loss: 10.725 Vali Loss: 20.861 Vali Acc: 0.255 Test Loss: 20.861 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4183270931243896
Epoch: 11, Steps: 17 | Train Loss: 10.736 Vali Loss: 13.886 Vali Acc: 0.243 Test Loss: 13.886 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.818495273590088
Epoch: 12, Steps: 17 | Train Loss: 7.975 Vali Loss: 9.025 Vali Acc: 0.266 Test Loss: 9.025 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7698755264282227
Epoch: 13, Steps: 17 | Train Loss: 10.601 Vali Loss: 10.922 Vali Acc: 0.255 Test Loss: 10.922 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.684802770614624
Epoch: 14, Steps: 17 | Train Loss: 7.320 Vali Loss: 9.654 Vali Acc: 0.278 Test Loss: 9.654 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.105602979660034
Epoch: 15, Steps: 17 | Train Loss: 6.642 Vali Loss: 18.635 Vali Acc: 0.251 Test Loss: 18.635 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.0592217445373535
Epoch: 16, Steps: 17 | Train Loss: 5.356 Vali Loss: 12.877 Vali Acc: 0.262 Test Loss: 12.877 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4301207065582275
Epoch: 17, Steps: 17 | Train Loss: 5.749 Vali Loss: 15.060 Vali Acc: 0.270 Test Loss: 15.060 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.6280508041381836
Epoch: 18, Steps: 17 | Train Loss: 3.865 Vali Loss: 7.820 Vali Acc: 0.247 Test Loss: 7.820 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1109561920166016
Epoch: 19, Steps: 17 | Train Loss: 3.804 Vali Loss: 8.385 Vali Acc: 0.255 Test Loss: 8.385 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 491740
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.531370401382446
Epoch: 1, Steps: 17 | Train Loss: 7.361 Vali Loss: 9.531 Vali Acc: 0.255 Test Loss: 9.531 Test Acc: 0.255
Validation loss decreased (inf --> -0.254658).  Saving model ...
Epoch: 2 cost time: 1.9583091735839844
Epoch: 2, Steps: 17 | Train Loss: 6.767 Vali Loss: 5.569 Vali Acc: 0.247 Test Loss: 5.569 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9804954528808594
Epoch: 3, Steps: 17 | Train Loss: 7.172 Vali Loss: 18.650 Vali Acc: 0.240 Test Loss: 18.650 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.104444980621338
Epoch: 4, Steps: 17 | Train Loss: 9.409 Vali Loss: 11.081 Vali Acc: 0.232 Test Loss: 11.081 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.989213466644287
Epoch: 5, Steps: 17 | Train Loss: 14.885 Vali Loss: 26.622 Vali Acc: 0.251 Test Loss: 26.622 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.903928518295288
Epoch: 6, Steps: 17 | Train Loss: 9.753 Vali Loss: 12.383 Vali Acc: 0.251 Test Loss: 12.383 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1730926036834717
Epoch: 7, Steps: 17 | Train Loss: 11.325 Vali Loss: 11.782 Vali Acc: 0.236 Test Loss: 11.782 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.983691930770874
Epoch: 8, Steps: 17 | Train Loss: 12.601 Vali Loss: 12.739 Vali Acc: 0.243 Test Loss: 12.739 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9258291721343994
Epoch: 9, Steps: 17 | Train Loss: 11.131 Vali Loss: 18.780 Vali Acc: 0.262 Test Loss: 18.780 Test Acc: 0.262
Validation loss decreased (-0.254658 --> -0.262170).  Saving model ...
Epoch: 10 cost time: 1.9990363121032715
Epoch: 10, Steps: 17 | Train Loss: 10.283 Vali Loss: 14.326 Vali Acc: 0.240 Test Loss: 14.326 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5950016975402832
Epoch: 11, Steps: 17 | Train Loss: 11.560 Vali Loss: 8.435 Vali Acc: 0.285 Test Loss: 8.435 Test Acc: 0.285
Validation loss decreased (-0.262170 --> -0.285087).  Saving model ...
Epoch: 12 cost time: 1.9949851036071777
Epoch: 12, Steps: 17 | Train Loss: 10.961 Vali Loss: 34.344 Vali Acc: 0.251 Test Loss: 34.344 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.148108959197998
Epoch: 13, Steps: 17 | Train Loss: 12.197 Vali Loss: 28.593 Vali Acc: 0.247 Test Loss: 28.593 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.305651903152466
Epoch: 14, Steps: 17 | Train Loss: 17.108 Vali Loss: 24.867 Vali Acc: 0.251 Test Loss: 24.867 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.928267002105713
Epoch: 15, Steps: 17 | Train Loss: 8.841 Vali Loss: 23.546 Vali Acc: 0.266 Test Loss: 23.546 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9867773056030273
Epoch: 16, Steps: 17 | Train Loss: 13.372 Vali Loss: 12.908 Vali Acc: 0.224 Test Loss: 12.908 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6992101669311523
Epoch: 17, Steps: 17 | Train Loss: 11.094 Vali Loss: 16.693 Vali Acc: 0.266 Test Loss: 16.693 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.2235007286071777
Epoch: 18, Steps: 17 | Train Loss: 6.258 Vali Loss: 14.551 Vali Acc: 0.255 Test Loss: 14.551 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.445556163787842
Epoch: 19, Steps: 17 | Train Loss: 5.929 Vali Loss: 21.276 Vali Acc: 0.270 Test Loss: 21.276 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0791726112365723
Epoch: 20, Steps: 17 | Train Loss: 10.582 Vali Loss: 19.881 Vali Acc: 0.228 Test Loss: 19.881 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9171171188354492
Epoch: 21, Steps: 17 | Train Loss: 8.020 Vali Loss: 13.852 Vali Acc: 0.243 Test Loss: 13.852 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 360668
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.542433977127075
Epoch: 1, Steps: 17 | Train Loss: 6.156 Vali Loss: 12.347 Vali Acc: 0.243 Test Loss: 12.347 Test Acc: 0.243
Validation loss decreased (inf --> -0.243223).  Saving model ...
Epoch: 2 cost time: 2.290411949157715
Epoch: 2, Steps: 17 | Train Loss: 10.158 Vali Loss: 7.149 Vali Acc: 0.259 Test Loss: 7.149 Test Acc: 0.259
Validation loss decreased (-0.243223 --> -0.258484).  Saving model ...
Epoch: 3 cost time: 2.4849815368652344
Epoch: 3, Steps: 17 | Train Loss: 7.125 Vali Loss: 13.322 Vali Acc: 0.236 Test Loss: 13.322 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.128863573074341
Epoch: 4, Steps: 17 | Train Loss: 10.052 Vali Loss: 11.124 Vali Acc: 0.243 Test Loss: 11.124 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6761524677276611
Epoch: 5, Steps: 17 | Train Loss: 12.691 Vali Loss: 14.729 Vali Acc: 0.255 Test Loss: 14.729 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2361056804656982
Epoch: 6, Steps: 17 | Train Loss: 10.129 Vali Loss: 9.744 Vali Acc: 0.251 Test Loss: 9.744 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.121025323867798
Epoch: 7, Steps: 17 | Train Loss: 7.916 Vali Loss: 5.897 Vali Acc: 0.217 Test Loss: 5.897 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1505885124206543
Epoch: 8, Steps: 17 | Train Loss: 11.491 Vali Loss: 18.120 Vali Acc: 0.232 Test Loss: 18.120 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.2318921089172363
Epoch: 9, Steps: 17 | Train Loss: 11.369 Vali Loss: 9.170 Vali Acc: 0.289 Test Loss: 9.170 Test Acc: 0.289
Validation loss decreased (-0.258484 --> -0.288882).  Saving model ...
Epoch: 10 cost time: 2.0291552543640137
Epoch: 10, Steps: 17 | Train Loss: 8.260 Vali Loss: 13.845 Vali Acc: 0.278 Test Loss: 13.845 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2565553188323975
Epoch: 11, Steps: 17 | Train Loss: 8.336 Vali Loss: 13.604 Vali Acc: 0.243 Test Loss: 13.604 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2026774883270264
Epoch: 12, Steps: 17 | Train Loss: 11.716 Vali Loss: 19.369 Vali Acc: 0.243 Test Loss: 19.369 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1456449031829834
Epoch: 13, Steps: 17 | Train Loss: 8.784 Vali Loss: 17.234 Vali Acc: 0.262 Test Loss: 17.234 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7204182147979736
Epoch: 14, Steps: 17 | Train Loss: 8.721 Vali Loss: 19.258 Vali Acc: 0.221 Test Loss: 19.258 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0081119537353516
Epoch: 15, Steps: 17 | Train Loss: 12.051 Vali Loss: 29.521 Vali Acc: 0.247 Test Loss: 29.521 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.347872257232666
Epoch: 16, Steps: 17 | Train Loss: 16.044 Vali Loss: 16.629 Vali Acc: 0.270 Test Loss: 16.629 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.25653076171875
Epoch: 17, Steps: 17 | Train Loss: 7.556 Vali Loss: 24.026 Vali Acc: 0.240 Test Loss: 24.026 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.223250389099121
Epoch: 18, Steps: 17 | Train Loss: 6.851 Vali Loss: 13.932 Vali Acc: 0.251 Test Loss: 13.932 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.37884259223938
Epoch: 19, Steps: 17 | Train Loss: 4.969 Vali Loss: 10.344 Vali Acc: 0.255 Test Loss: 10.344 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 360668
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.712628602981567
Epoch: 1, Steps: 17 | Train Loss: 5.525 Vali Loss: 5.635 Vali Acc: 0.262 Test Loss: 5.635 Test Acc: 0.262
Validation loss decreased (inf --> -0.262301).  Saving model ...
Epoch: 2 cost time: 2.0825586318969727
Epoch: 2, Steps: 17 | Train Loss: 5.724 Vali Loss: 4.328 Vali Acc: 0.278 Test Loss: 4.328 Test Acc: 0.278
Validation loss decreased (-0.262301 --> -0.277523).  Saving model ...
Epoch: 3 cost time: 1.9951529502868652
Epoch: 3, Steps: 17 | Train Loss: 10.411 Vali Loss: 13.716 Vali Acc: 0.247 Test Loss: 13.716 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.016289710998535
Epoch: 4, Steps: 17 | Train Loss: 9.715 Vali Loss: 11.938 Vali Acc: 0.251 Test Loss: 11.938 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1356961727142334
Epoch: 5, Steps: 17 | Train Loss: 9.705 Vali Loss: 8.906 Vali Acc: 0.266 Test Loss: 8.906 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0844931602478027
Epoch: 6, Steps: 17 | Train Loss: 12.315 Vali Loss: 11.588 Vali Acc: 0.251 Test Loss: 11.588 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.019939422607422
Epoch: 7, Steps: 17 | Train Loss: 11.263 Vali Loss: 8.929 Vali Acc: 0.247 Test Loss: 8.929 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1556928157806396
Epoch: 8, Steps: 17 | Train Loss: 6.247 Vali Loss: 9.789 Vali Acc: 0.262 Test Loss: 9.789 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.3016605377197266
Epoch: 9, Steps: 17 | Train Loss: 11.043 Vali Loss: 10.922 Vali Acc: 0.259 Test Loss: 10.922 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1043264865875244
Epoch: 10, Steps: 17 | Train Loss: 11.338 Vali Loss: 15.565 Vali Acc: 0.262 Test Loss: 15.565 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.1974525451660156
Epoch: 11, Steps: 17 | Train Loss: 14.274 Vali Loss: 11.749 Vali Acc: 0.240 Test Loss: 11.749 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.419116258621216
Epoch: 12, Steps: 17 | Train Loss: 10.440 Vali Loss: 14.119 Vali Acc: 0.247 Test Loss: 14.119 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 360668
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.688060760498047
Epoch: 1, Steps: 17 | Train Loss: 5.629 Vali Loss: 9.600 Vali Acc: 0.247 Test Loss: 9.600 Test Acc: 0.247
Validation loss decreased (inf --> -0.247052).  Saving model ...
Epoch: 2 cost time: 1.9624080657958984
Epoch: 2, Steps: 17 | Train Loss: 5.647 Vali Loss: 3.194 Vali Acc: 0.285 Test Loss: 3.194 Test Acc: 0.285
Validation loss decreased (-0.247052 --> -0.285139).  Saving model ...
Epoch: 3 cost time: 2.2087085247039795
Epoch: 3, Steps: 17 | Train Loss: 6.276 Vali Loss: 9.751 Vali Acc: 0.243 Test Loss: 9.751 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.156074047088623
Epoch: 4, Steps: 17 | Train Loss: 8.588 Vali Loss: 12.959 Vali Acc: 0.243 Test Loss: 12.959 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6503665447235107
Epoch: 5, Steps: 17 | Train Loss: 10.493 Vali Loss: 15.773 Vali Acc: 0.247 Test Loss: 15.773 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.920152187347412
Epoch: 6, Steps: 17 | Train Loss: 10.670 Vali Loss: 7.465 Vali Acc: 0.221 Test Loss: 7.465 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7950139045715332
Epoch: 7, Steps: 17 | Train Loss: 9.331 Vali Loss: 17.447 Vali Acc: 0.259 Test Loss: 17.447 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9913747310638428
Epoch: 8, Steps: 17 | Train Loss: 9.899 Vali Loss: 17.311 Vali Acc: 0.278 Test Loss: 17.311 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.906860589981079
Epoch: 9, Steps: 17 | Train Loss: 10.298 Vali Loss: 9.030 Vali Acc: 0.217 Test Loss: 9.030 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.896568775177002
Epoch: 10, Steps: 17 | Train Loss: 6.004 Vali Loss: 8.508 Vali Acc: 0.255 Test Loss: 8.508 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9601294994354248
Epoch: 11, Steps: 17 | Train Loss: 6.070 Vali Loss: 11.214 Vali Acc: 0.221 Test Loss: 11.214 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0495920181274414
Epoch: 12, Steps: 17 | Train Loss: 6.501 Vali Loss: 10.744 Vali Acc: 0.251 Test Loss: 10.744 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 360668
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.837235927581787
Epoch: 1, Steps: 17 | Train Loss: 7.528 Vali Loss: 9.183 Vali Acc: 0.262 Test Loss: 9.183 Test Acc: 0.262
Validation loss decreased (inf --> -0.262266).  Saving model ...
Epoch: 2 cost time: 2.1082799434661865
Epoch: 2, Steps: 17 | Train Loss: 7.616 Vali Loss: 4.631 Vali Acc: 0.255 Test Loss: 4.631 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9983012676239014
Epoch: 3, Steps: 17 | Train Loss: 6.594 Vali Loss: 13.483 Vali Acc: 0.251 Test Loss: 13.483 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.871809720993042
Epoch: 4, Steps: 17 | Train Loss: 12.329 Vali Loss: 14.894 Vali Acc: 0.240 Test Loss: 14.894 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8720617294311523
Epoch: 5, Steps: 17 | Train Loss: 8.746 Vali Loss: 8.133 Vali Acc: 0.270 Test Loss: 8.133 Test Acc: 0.270
Validation loss decreased (-0.262266 --> -0.269881).  Saving model ...
Epoch: 6 cost time: 1.881714105606079
Epoch: 6, Steps: 17 | Train Loss: 9.811 Vali Loss: 18.062 Vali Acc: 0.262 Test Loss: 18.062 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.470141887664795
Epoch: 7, Steps: 17 | Train Loss: 12.209 Vali Loss: 11.068 Vali Acc: 0.251 Test Loss: 11.068 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1288905143737793
Epoch: 8, Steps: 17 | Train Loss: 7.869 Vali Loss: 15.044 Vali Acc: 0.274 Test Loss: 15.044 Test Acc: 0.274
Validation loss decreased (-0.269881 --> -0.273614).  Saving model ...
Epoch: 9 cost time: 2.122943878173828
Epoch: 9, Steps: 17 | Train Loss: 12.465 Vali Loss: 25.588 Vali Acc: 0.240 Test Loss: 25.588 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9922959804534912
Epoch: 10, Steps: 17 | Train Loss: 11.664 Vali Loss: 15.280 Vali Acc: 0.266 Test Loss: 15.280 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2371697425842285
Epoch: 11, Steps: 17 | Train Loss: 12.898 Vali Loss: 18.958 Vali Acc: 0.251 Test Loss: 18.958 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9756999015808105
Epoch: 12, Steps: 17 | Train Loss: 8.253 Vali Loss: 19.392 Vali Acc: 0.240 Test Loss: 19.392 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1605122089385986
Epoch: 13, Steps: 17 | Train Loss: 12.804 Vali Loss: 13.183 Vali Acc: 0.221 Test Loss: 13.183 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.862436056137085
Epoch: 14, Steps: 17 | Train Loss: 8.003 Vali Loss: 12.080 Vali Acc: 0.240 Test Loss: 12.080 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0734047889709473
Epoch: 15, Steps: 17 | Train Loss: 8.358 Vali Loss: 8.611 Vali Acc: 0.228 Test Loss: 8.611 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.2787458896636963
Epoch: 16, Steps: 17 | Train Loss: 7.322 Vali Loss: 12.473 Vali Acc: 0.236 Test Loss: 12.473 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8703138828277588
Epoch: 17, Steps: 17 | Train Loss: 9.400 Vali Loss: 29.515 Vali Acc: 0.243 Test Loss: 29.515 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9381771087646484
Epoch: 18, Steps: 17 | Train Loss: 15.351 Vali Loss: 22.241 Vali Acc: 0.217 Test Loss: 22.241 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 295132
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.588683366775513
Epoch: 1, Steps: 17 | Train Loss: 7.530 Vali Loss: 11.915 Vali Acc: 0.251 Test Loss: 11.915 Test Acc: 0.251
Validation loss decreased (inf --> -0.250831).  Saving model ...
Epoch: 2 cost time: 2.100491523742676
Epoch: 2, Steps: 17 | Train Loss: 7.479 Vali Loss: 6.798 Vali Acc: 0.243 Test Loss: 6.798 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.036783456802368
Epoch: 3, Steps: 17 | Train Loss: 6.530 Vali Loss: 6.060 Vali Acc: 0.251 Test Loss: 6.060 Test Acc: 0.251
Validation loss decreased (-0.250831 --> -0.250890).  Saving model ...
Epoch: 4 cost time: 1.8912184238433838
Epoch: 4, Steps: 17 | Train Loss: 7.583 Vali Loss: 11.827 Vali Acc: 0.243 Test Loss: 11.827 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.371506929397583
Epoch: 5, Steps: 17 | Train Loss: 9.650 Vali Loss: 9.446 Vali Acc: 0.243 Test Loss: 9.446 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2313570976257324
Epoch: 6, Steps: 17 | Train Loss: 9.386 Vali Loss: 19.982 Vali Acc: 0.251 Test Loss: 19.982 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1559088230133057
Epoch: 7, Steps: 17 | Train Loss: 9.412 Vali Loss: 9.754 Vali Acc: 0.281 Test Loss: 9.754 Test Acc: 0.281
Validation loss decreased (-0.250890 --> -0.281271).  Saving model ...
Epoch: 8 cost time: 2.0433740615844727
Epoch: 8, Steps: 17 | Train Loss: 7.210 Vali Loss: 13.183 Vali Acc: 0.221 Test Loss: 13.183 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0840251445770264
Epoch: 9, Steps: 17 | Train Loss: 14.367 Vali Loss: 25.514 Vali Acc: 0.240 Test Loss: 25.514 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0725808143615723
Epoch: 10, Steps: 17 | Train Loss: 17.647 Vali Loss: 17.780 Vali Acc: 0.255 Test Loss: 17.780 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.285580635070801
Epoch: 11, Steps: 17 | Train Loss: 12.537 Vali Loss: 17.019 Vali Acc: 0.247 Test Loss: 17.019 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2627511024475098
Epoch: 12, Steps: 17 | Train Loss: 11.370 Vali Loss: 13.855 Vali Acc: 0.228 Test Loss: 13.855 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9500701427459717
Epoch: 13, Steps: 17 | Train Loss: 10.056 Vali Loss: 12.114 Vali Acc: 0.240 Test Loss: 12.114 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3699944019317627
Epoch: 14, Steps: 17 | Train Loss: 7.452 Vali Loss: 11.652 Vali Acc: 0.285 Test Loss: 11.652 Test Acc: 0.285
Validation loss decreased (-0.281271 --> -0.285055).  Saving model ...
Epoch: 15 cost time: 2.07609224319458
Epoch: 15, Steps: 17 | Train Loss: 10.730 Vali Loss: 14.897 Vali Acc: 0.243 Test Loss: 14.897 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.147244691848755
Epoch: 16, Steps: 17 | Train Loss: 10.262 Vali Loss: 10.653 Vali Acc: 0.266 Test Loss: 10.653 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.183873176574707
Epoch: 17, Steps: 17 | Train Loss: 5.838 Vali Loss: 15.805 Vali Acc: 0.236 Test Loss: 15.805 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.197805166244507
Epoch: 18, Steps: 17 | Train Loss: 5.720 Vali Loss: 12.161 Vali Acc: 0.251 Test Loss: 12.161 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.3244078159332275
Epoch: 19, Steps: 17 | Train Loss: 6.192 Vali Loss: 19.718 Vali Acc: 0.262 Test Loss: 19.718 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.2980852127075195
Epoch: 20, Steps: 17 | Train Loss: 6.211 Vali Loss: 17.699 Vali Acc: 0.266 Test Loss: 17.699 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.186917543411255
Epoch: 21, Steps: 17 | Train Loss: 4.714 Vali Loss: 21.570 Vali Acc: 0.259 Test Loss: 21.570 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.5130181312561035
Epoch: 22, Steps: 17 | Train Loss: 5.548 Vali Loss: 18.215 Vali Acc: 0.266 Test Loss: 18.215 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1498894691467285
Epoch: 23, Steps: 17 | Train Loss: 4.334 Vali Loss: 24.202 Vali Acc: 0.240 Test Loss: 24.202 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.3183603286743164
Epoch: 24, Steps: 17 | Train Loss: 5.468 Vali Loss: 23.574 Vali Acc: 0.236 Test Loss: 23.574 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 295132
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.5777482986450195
Epoch: 1, Steps: 17 | Train Loss: 6.979 Vali Loss: 9.986 Vali Acc: 0.259 Test Loss: 9.986 Test Acc: 0.259
Validation loss decreased (inf --> -0.258455).  Saving model ...
Epoch: 2 cost time: 2.1982295513153076
Epoch: 2, Steps: 17 | Train Loss: 7.084 Vali Loss: 4.925 Vali Acc: 0.274 Test Loss: 4.925 Test Acc: 0.274
Validation loss decreased (-0.258455 --> -0.273715).  Saving model ...
Epoch: 3 cost time: 2.1035919189453125
Epoch: 3, Steps: 17 | Train Loss: 5.261 Vali Loss: 6.294 Vali Acc: 0.243 Test Loss: 6.294 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0641162395477295
Epoch: 4, Steps: 17 | Train Loss: 8.576 Vali Loss: 21.278 Vali Acc: 0.255 Test Loss: 21.278 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0041117668151855
Epoch: 5, Steps: 17 | Train Loss: 13.933 Vali Loss: 17.028 Vali Acc: 0.224 Test Loss: 17.028 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8964073657989502
Epoch: 6, Steps: 17 | Train Loss: 14.952 Vali Loss: 18.438 Vali Acc: 0.251 Test Loss: 18.438 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.001500368118286
Epoch: 7, Steps: 17 | Train Loss: 13.614 Vali Loss: 8.782 Vali Acc: 0.240 Test Loss: 8.782 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8926830291748047
Epoch: 8, Steps: 17 | Train Loss: 14.135 Vali Loss: 14.299 Vali Acc: 0.247 Test Loss: 14.299 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.2361557483673096
Epoch: 9, Steps: 17 | Train Loss: 17.345 Vali Loss: 14.399 Vali Acc: 0.281 Test Loss: 14.399 Test Acc: 0.281
Validation loss decreased (-0.273715 --> -0.281225).  Saving model ...
Epoch: 10 cost time: 2.1809961795806885
Epoch: 10, Steps: 17 | Train Loss: 8.849 Vali Loss: 21.174 Vali Acc: 0.247 Test Loss: 21.174 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0431766510009766
Epoch: 11, Steps: 17 | Train Loss: 13.345 Vali Loss: 23.579 Vali Acc: 0.240 Test Loss: 23.579 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1338672637939453
Epoch: 12, Steps: 17 | Train Loss: 14.479 Vali Loss: 11.092 Vali Acc: 0.255 Test Loss: 11.092 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3426942825317383
Epoch: 13, Steps: 17 | Train Loss: 11.152 Vali Loss: 23.841 Vali Acc: 0.255 Test Loss: 23.841 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9287197589874268
Epoch: 14, Steps: 17 | Train Loss: 8.862 Vali Loss: 13.155 Vali Acc: 0.262 Test Loss: 13.155 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7451612949371338
Epoch: 15, Steps: 17 | Train Loss: 8.699 Vali Loss: 8.912 Vali Acc: 0.247 Test Loss: 8.912 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9280273914337158
Epoch: 16, Steps: 17 | Train Loss: 8.595 Vali Loss: 30.741 Vali Acc: 0.243 Test Loss: 30.741 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0351150035858154
Epoch: 17, Steps: 17 | Train Loss: 8.599 Vali Loss: 21.248 Vali Acc: 0.243 Test Loss: 21.248 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0923686027526855
Epoch: 18, Steps: 17 | Train Loss: 9.422 Vali Loss: 21.870 Vali Acc: 0.228 Test Loss: 21.870 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8398327827453613
Epoch: 19, Steps: 17 | Train Loss: 6.047 Vali Loss: 16.048 Vali Acc: 0.221 Test Loss: 16.048 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 295132
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.813563823699951
Epoch: 1, Steps: 17 | Train Loss: 5.904 Vali Loss: 5.256 Vali Acc: 0.251 Test Loss: 5.256 Test Acc: 0.251
Validation loss decreased (inf --> -0.250898).  Saving model ...
Epoch: 2 cost time: 1.797506332397461
Epoch: 2, Steps: 17 | Train Loss: 7.109 Vali Loss: 9.783 Vali Acc: 0.251 Test Loss: 9.783 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6825778484344482
Epoch: 3, Steps: 17 | Train Loss: 8.786 Vali Loss: 9.075 Vali Acc: 0.266 Test Loss: 9.075 Test Acc: 0.266
Validation loss decreased (-0.250898 --> -0.266069).  Saving model ...
Epoch: 4 cost time: 1.9980087280273438
Epoch: 4, Steps: 17 | Train Loss: 8.912 Vali Loss: 16.144 Vali Acc: 0.247 Test Loss: 16.144 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0965750217437744
Epoch: 5, Steps: 17 | Train Loss: 9.222 Vali Loss: 10.672 Vali Acc: 0.259 Test Loss: 10.672 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9503862857818604
Epoch: 6, Steps: 17 | Train Loss: 13.143 Vali Loss: 14.905 Vali Acc: 0.259 Test Loss: 14.905 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0328385829925537
Epoch: 7, Steps: 17 | Train Loss: 14.356 Vali Loss: 9.376 Vali Acc: 0.266 Test Loss: 9.376 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9289276599884033
Epoch: 8, Steps: 17 | Train Loss: 9.375 Vali Loss: 13.431 Vali Acc: 0.255 Test Loss: 13.431 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9339110851287842
Epoch: 9, Steps: 17 | Train Loss: 17.077 Vali Loss: 9.945 Vali Acc: 0.243 Test Loss: 9.945 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8763747215270996
Epoch: 10, Steps: 17 | Train Loss: 10.555 Vali Loss: 11.540 Vali Acc: 0.243 Test Loss: 11.540 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6222455501556396
Epoch: 11, Steps: 17 | Train Loss: 8.115 Vali Loss: 14.317 Vali Acc: 0.236 Test Loss: 14.317 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6655657291412354
Epoch: 12, Steps: 17 | Train Loss: 11.152 Vali Loss: 20.873 Vali Acc: 0.255 Test Loss: 20.873 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7757086753845215
Epoch: 13, Steps: 17 | Train Loss: 9.151 Vali Loss: 12.690 Vali Acc: 0.236 Test Loss: 12.690 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 295132
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.715531349182129
Epoch: 1, Steps: 17 | Train Loss: 6.002 Vali Loss: 6.581 Vali Acc: 0.262 Test Loss: 6.581 Test Acc: 0.262
Validation loss decreased (inf --> -0.262292).  Saving model ...
Epoch: 2 cost time: 1.9645075798034668
Epoch: 2, Steps: 17 | Train Loss: 6.133 Vali Loss: 15.686 Vali Acc: 0.240 Test Loss: 15.686 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.010096788406372
Epoch: 3, Steps: 17 | Train Loss: 8.875 Vali Loss: 7.573 Vali Acc: 0.259 Test Loss: 7.573 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0299925804138184
Epoch: 4, Steps: 17 | Train Loss: 7.339 Vali Loss: 7.669 Vali Acc: 0.247 Test Loss: 7.669 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9560956954956055
Epoch: 5, Steps: 17 | Train Loss: 11.630 Vali Loss: 10.961 Vali Acc: 0.259 Test Loss: 10.961 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1174962520599365
Epoch: 6, Steps: 17 | Train Loss: 8.628 Vali Loss: 12.534 Vali Acc: 0.243 Test Loss: 12.534 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.197202682495117
Epoch: 7, Steps: 17 | Train Loss: 12.420 Vali Loss: 14.771 Vali Acc: 0.251 Test Loss: 14.771 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.065770149230957
Epoch: 8, Steps: 17 | Train Loss: 14.564 Vali Loss: 21.366 Vali Acc: 0.243 Test Loss: 21.366 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.066129207611084
Epoch: 9, Steps: 17 | Train Loss: 8.660 Vali Loss: 12.656 Vali Acc: 0.236 Test Loss: 12.656 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.113579034805298
Epoch: 10, Steps: 17 | Train Loss: 10.250 Vali Loss: 20.485 Vali Acc: 0.243 Test Loss: 20.485 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8230595588684082
Epoch: 11, Steps: 17 | Train Loss: 16.916 Vali Loss: 11.062 Vali Acc: 0.266 Test Loss: 11.062 Test Acc: 0.266
Validation loss decreased (-0.262292 --> -0.266049).  Saving model ...
Epoch: 12 cost time: 2.14345121383667
Epoch: 12, Steps: 17 | Train Loss: 8.270 Vali Loss: 17.210 Vali Acc: 0.255 Test Loss: 17.210 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2037675380706787
Epoch: 13, Steps: 17 | Train Loss: 15.863 Vali Loss: 36.163 Vali Acc: 0.255 Test Loss: 36.163 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9767777919769287
Epoch: 14, Steps: 17 | Train Loss: 13.816 Vali Loss: 9.707 Vali Acc: 0.251 Test Loss: 9.707 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3897578716278076
Epoch: 15, Steps: 17 | Train Loss: 9.865 Vali Loss: 16.877 Vali Acc: 0.251 Test Loss: 16.877 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.1814017295837402
Epoch: 16, Steps: 17 | Train Loss: 8.573 Vali Loss: 17.148 Vali Acc: 0.266 Test Loss: 17.148 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5095157623291016
Epoch: 17, Steps: 17 | Train Loss: 9.357 Vali Loss: 19.047 Vali Acc: 0.243 Test Loss: 19.047 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8483526706695557
Epoch: 18, Steps: 17 | Train Loss: 5.800 Vali Loss: 13.470 Vali Acc: 0.289 Test Loss: 13.470 Test Acc: 0.289
Validation loss decreased (-0.266049 --> -0.288839).  Saving model ...
Epoch: 19 cost time: 1.9011473655700684
Epoch: 19, Steps: 17 | Train Loss: 5.546 Vali Loss: 17.206 Vali Acc: 0.247 Test Loss: 17.206 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9844613075256348
Epoch: 20, Steps: 17 | Train Loss: 6.214 Vali Loss: 15.592 Vali Acc: 0.224 Test Loss: 15.592 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.155702829360962
Epoch: 21, Steps: 17 | Train Loss: 5.600 Vali Loss: 20.549 Vali Acc: 0.255 Test Loss: 20.549 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.88167142868042
Epoch: 22, Steps: 17 | Train Loss: 6.150 Vali Loss: 16.981 Vali Acc: 0.255 Test Loss: 16.981 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.029520273208618
Epoch: 23, Steps: 17 | Train Loss: 5.181 Vali Loss: 21.549 Vali Acc: 0.270 Test Loss: 21.549 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.1096935272216797
Epoch: 24, Steps: 17 | Train Loss: 6.776 Vali Loss: 19.834 Vali Acc: 0.259 Test Loss: 19.834 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.011989116668701
Epoch: 25, Steps: 17 | Train Loss: 5.252 Vali Loss: 26.082 Vali Acc: 0.262 Test Loss: 26.082 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.2653658390045166
Epoch: 26, Steps: 17 | Train Loss: 3.802 Vali Loss: 23.842 Vali Acc: 0.270 Test Loss: 23.842 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.1073176860809326
Epoch: 27, Steps: 17 | Train Loss: 2.953 Vali Loss: 24.959 Vali Acc: 0.259 Test Loss: 24.959 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.3351523876190186
Epoch: 28, Steps: 17 | Train Loss: 5.289 Vali Loss: 23.698 Vali Acc: 0.285 Test Loss: 23.698 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 262364
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.831684350967407
Epoch: 1, Steps: 17 | Train Loss: 5.930 Vali Loss: 5.945 Vali Acc: 0.251 Test Loss: 5.945 Test Acc: 0.251
Validation loss decreased (inf --> -0.250891).  Saving model ...
Epoch: 2 cost time: 2.166964292526245
Epoch: 2, Steps: 17 | Train Loss: 5.964 Vali Loss: 14.064 Vali Acc: 0.255 Test Loss: 14.064 Test Acc: 0.255
Validation loss decreased (-0.250891 --> -0.254612).  Saving model ...
Epoch: 3 cost time: 2.3315086364746094
Epoch: 3, Steps: 17 | Train Loss: 8.673 Vali Loss: 21.328 Vali Acc: 0.247 Test Loss: 21.328 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8207969665527344
Epoch: 4, Steps: 17 | Train Loss: 11.120 Vali Loss: 23.393 Vali Acc: 0.247 Test Loss: 23.393 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9336202144622803
Epoch: 5, Steps: 17 | Train Loss: 13.530 Vali Loss: 21.073 Vali Acc: 0.247 Test Loss: 21.073 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1441662311553955
Epoch: 6, Steps: 17 | Train Loss: 13.342 Vali Loss: 17.547 Vali Acc: 0.243 Test Loss: 17.547 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.962573528289795
Epoch: 7, Steps: 17 | Train Loss: 13.787 Vali Loss: 21.421 Vali Acc: 0.262 Test Loss: 21.421 Test Acc: 0.262
Validation loss decreased (-0.254612 --> -0.262143).  Saving model ...
Epoch: 8 cost time: 1.8149757385253906
Epoch: 8, Steps: 17 | Train Loss: 14.919 Vali Loss: 16.790 Vali Acc: 0.255 Test Loss: 16.790 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9189012050628662
Epoch: 9, Steps: 17 | Train Loss: 15.507 Vali Loss: 12.102 Vali Acc: 0.247 Test Loss: 12.102 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.265653133392334
Epoch: 10, Steps: 17 | Train Loss: 14.212 Vali Loss: 11.590 Vali Acc: 0.266 Test Loss: 11.590 Test Acc: 0.266
Validation loss decreased (-0.262143 --> -0.266044).  Saving model ...
Epoch: 11 cost time: 2.345879554748535
Epoch: 11, Steps: 17 | Train Loss: 11.154 Vali Loss: 19.364 Vali Acc: 0.259 Test Loss: 19.364 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1041312217712402
Epoch: 12, Steps: 17 | Train Loss: 14.000 Vali Loss: 9.764 Vali Acc: 0.270 Test Loss: 9.764 Test Acc: 0.270
Validation loss decreased (-0.266044 --> -0.269864).  Saving model ...
Epoch: 13 cost time: 1.944756031036377
Epoch: 13, Steps: 17 | Train Loss: 8.024 Vali Loss: 8.618 Vali Acc: 0.255 Test Loss: 8.618 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1522655487060547
Epoch: 14, Steps: 17 | Train Loss: 5.151 Vali Loss: 17.649 Vali Acc: 0.281 Test Loss: 17.649 Test Acc: 0.281
Validation loss decreased (-0.269864 --> -0.281192).  Saving model ...
Epoch: 15 cost time: 1.6171536445617676
Epoch: 15, Steps: 17 | Train Loss: 10.635 Vali Loss: 27.690 Vali Acc: 0.255 Test Loss: 27.690 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5686466693878174
Epoch: 16, Steps: 17 | Train Loss: 14.679 Vali Loss: 10.856 Vali Acc: 0.259 Test Loss: 10.856 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7035915851593018
Epoch: 17, Steps: 17 | Train Loss: 7.523 Vali Loss: 13.590 Vali Acc: 0.228 Test Loss: 13.590 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6726768016815186
Epoch: 18, Steps: 17 | Train Loss: 7.556 Vali Loss: 14.431 Vali Acc: 0.285 Test Loss: 14.431 Test Acc: 0.285
Validation loss decreased (-0.281192 --> -0.285027).  Saving model ...
Epoch: 19 cost time: 2.1499807834625244
Epoch: 19, Steps: 17 | Train Loss: 6.341 Vali Loss: 23.340 Vali Acc: 0.266 Test Loss: 23.340 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.149237871170044
Epoch: 20, Steps: 17 | Train Loss: 5.734 Vali Loss: 14.008 Vali Acc: 0.243 Test Loss: 14.008 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0931344032287598
Epoch: 21, Steps: 17 | Train Loss: 5.719 Vali Loss: 30.119 Vali Acc: 0.240 Test Loss: 30.119 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.164499044418335
Epoch: 22, Steps: 17 | Train Loss: 6.808 Vali Loss: 13.749 Vali Acc: 0.266 Test Loss: 13.749 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.3334953784942627
Epoch: 23, Steps: 17 | Train Loss: 7.367 Vali Loss: 22.272 Vali Acc: 0.259 Test Loss: 22.272 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.1981146335601807
Epoch: 24, Steps: 17 | Train Loss: 4.940 Vali Loss: 20.239 Vali Acc: 0.255 Test Loss: 20.239 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.079604148864746
Epoch: 25, Steps: 17 | Train Loss: 3.334 Vali Loss: 21.467 Vali Acc: 0.293 Test Loss: 21.467 Test Acc: 0.293
Validation loss decreased (-0.285027 --> -0.292561).  Saving model ...
Epoch: 26 cost time: 1.6446797847747803
Epoch: 26, Steps: 17 | Train Loss: 6.081 Vali Loss: 20.400 Vali Acc: 0.281 Test Loss: 20.400 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8093838691711426
Epoch: 27, Steps: 17 | Train Loss: 2.576 Vali Loss: 22.058 Vali Acc: 0.278 Test Loss: 22.058 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7123229503631592
Epoch: 28, Steps: 17 | Train Loss: 3.849 Vali Loss: 22.167 Vali Acc: 0.285 Test Loss: 22.167 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6476778984069824
Epoch: 29, Steps: 17 | Train Loss: 3.080 Vali Loss: 23.637 Vali Acc: 0.297 Test Loss: 23.637 Test Acc: 0.297
Validation loss decreased (-0.292561 --> -0.296342).  Saving model ...
Epoch: 30 cost time: 1.7132785320281982
Epoch: 30, Steps: 17 | Train Loss: 2.875 Vali Loss: 28.400 Vali Acc: 0.274 Test Loss: 28.400 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.77180814743042
Epoch: 31, Steps: 17 | Train Loss: 4.708 Vali Loss: 33.104 Vali Acc: 0.262 Test Loss: 33.104 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.072754383087158
Epoch: 32, Steps: 17 | Train Loss: 2.171 Vali Loss: 37.454 Vali Acc: 0.262 Test Loss: 37.454 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.8829834461212158
Epoch: 33, Steps: 17 | Train Loss: 1.725 Vali Loss: 41.104 Vali Acc: 0.278 Test Loss: 41.104 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.377434492111206
Epoch: 34, Steps: 17 | Train Loss: 5.132 Vali Loss: 46.565 Vali Acc: 0.251 Test Loss: 46.565 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.499415874481201
Epoch: 35, Steps: 17 | Train Loss: 2.763 Vali Loss: 50.180 Vali Acc: 0.262 Test Loss: 50.180 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.1916086673736572
Epoch: 36, Steps: 17 | Train Loss: 1.612 Vali Loss: 49.616 Vali Acc: 0.262 Test Loss: 49.616 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.9953384399414062
Epoch: 37, Steps: 17 | Train Loss: 1.304 Vali Loss: 59.822 Vali Acc: 0.247 Test Loss: 59.822 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.1053507328033447
Epoch: 38, Steps: 17 | Train Loss: 3.238 Vali Loss: 68.198 Vali Acc: 0.278 Test Loss: 68.198 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.067152261734009
Epoch: 39, Steps: 17 | Train Loss: 0.994 Vali Loss: 65.902 Vali Acc: 0.255 Test Loss: 65.902 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 262364
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8626973628997803
Epoch: 1, Steps: 17 | Train Loss: 5.883 Vali Loss: 5.749 Vali Acc: 0.243 Test Loss: 5.749 Test Acc: 0.243
Validation loss decreased (inf --> -0.243289).  Saving model ...
Epoch: 2 cost time: 1.6692390441894531
Epoch: 2, Steps: 17 | Train Loss: 9.919 Vali Loss: 6.123 Vali Acc: 0.262 Test Loss: 6.123 Test Acc: 0.262
Validation loss decreased (-0.243289 --> -0.262296).  Saving model ...
Epoch: 3 cost time: 1.9627816677093506
Epoch: 3, Steps: 17 | Train Loss: 7.376 Vali Loss: 12.204 Vali Acc: 0.247 Test Loss: 12.204 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.083244562149048
Epoch: 4, Steps: 17 | Train Loss: 9.886 Vali Loss: 9.594 Vali Acc: 0.255 Test Loss: 9.594 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.184760570526123
Epoch: 5, Steps: 17 | Train Loss: 9.197 Vali Loss: 6.394 Vali Acc: 0.247 Test Loss: 6.394 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9849803447723389
Epoch: 6, Steps: 17 | Train Loss: 7.256 Vali Loss: 9.140 Vali Acc: 0.270 Test Loss: 9.140 Test Acc: 0.270
Validation loss decreased (-0.262296 --> -0.269871).  Saving model ...
Epoch: 7 cost time: 2.0682144165039062
Epoch: 7, Steps: 17 | Train Loss: 5.189 Vali Loss: 6.501 Vali Acc: 0.240 Test Loss: 6.501 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9282262325286865
Epoch: 8, Steps: 17 | Train Loss: 9.125 Vali Loss: 22.304 Vali Acc: 0.247 Test Loss: 22.304 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.007194757461548
Epoch: 9, Steps: 17 | Train Loss: 15.139 Vali Loss: 15.420 Vali Acc: 0.236 Test Loss: 15.420 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4321908950805664
Epoch: 10, Steps: 17 | Train Loss: 9.818 Vali Loss: 15.375 Vali Acc: 0.247 Test Loss: 15.375 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1160075664520264
Epoch: 11, Steps: 17 | Train Loss: 10.693 Vali Loss: 14.484 Vali Acc: 0.224 Test Loss: 14.484 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.3091325759887695
Epoch: 12, Steps: 17 | Train Loss: 13.637 Vali Loss: 15.409 Vali Acc: 0.240 Test Loss: 15.409 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.195457935333252
Epoch: 13, Steps: 17 | Train Loss: 13.614 Vali Loss: 10.962 Vali Acc: 0.251 Test Loss: 10.962 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2271201610565186
Epoch: 14, Steps: 17 | Train Loss: 7.567 Vali Loss: 13.434 Vali Acc: 0.293 Test Loss: 13.434 Test Acc: 0.293
Validation loss decreased (-0.269871 --> -0.292641).  Saving model ...
Epoch: 15 cost time: 2.1783499717712402
Epoch: 15, Steps: 17 | Train Loss: 9.355 Vali Loss: 12.715 Vali Acc: 0.232 Test Loss: 12.715 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2410566806793213
Epoch: 16, Steps: 17 | Train Loss: 7.661 Vali Loss: 12.043 Vali Acc: 0.221 Test Loss: 12.043 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.109523296356201
Epoch: 17, Steps: 17 | Train Loss: 7.504 Vali Loss: 13.608 Vali Acc: 0.224 Test Loss: 13.608 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.109037399291992
Epoch: 18, Steps: 17 | Train Loss: 5.742 Vali Loss: 16.371 Vali Acc: 0.247 Test Loss: 16.371 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.78802490234375
Epoch: 19, Steps: 17 | Train Loss: 5.893 Vali Loss: 14.565 Vali Acc: 0.266 Test Loss: 14.565 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0070111751556396
Epoch: 20, Steps: 17 | Train Loss: 5.366 Vali Loss: 19.184 Vali Acc: 0.243 Test Loss: 19.184 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.843163251876831
Epoch: 21, Steps: 17 | Train Loss: 4.092 Vali Loss: 14.081 Vali Acc: 0.274 Test Loss: 14.081 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5618791580200195
Epoch: 22, Steps: 17 | Train Loss: 4.188 Vali Loss: 13.001 Vali Acc: 0.232 Test Loss: 13.001 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9052999019622803
Epoch: 23, Steps: 17 | Train Loss: 3.133 Vali Loss: 25.258 Vali Acc: 0.251 Test Loss: 25.258 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4499311447143555
Epoch: 24, Steps: 17 | Train Loss: 5.773 Vali Loss: 23.466 Vali Acc: 0.270 Test Loss: 23.466 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 262364
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.078647136688232
Epoch: 1, Steps: 17 | Train Loss: 5.277 Vali Loss: 5.415 Vali Acc: 0.240 Test Loss: 5.415 Test Acc: 0.240
Validation loss decreased (inf --> -0.239490).  Saving model ...
Epoch: 2 cost time: 1.8302183151245117
Epoch: 2, Steps: 17 | Train Loss: 6.711 Vali Loss: 11.342 Vali Acc: 0.255 Test Loss: 11.342 Test Acc: 0.255
Validation loss decreased (-0.239490 --> -0.254639).  Saving model ...
Epoch: 3 cost time: 2.0432701110839844
Epoch: 3, Steps: 17 | Train Loss: 10.660 Vali Loss: 23.029 Vali Acc: 0.251 Test Loss: 23.029 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.96791672706604
Epoch: 4, Steps: 17 | Train Loss: 13.686 Vali Loss: 15.859 Vali Acc: 0.266 Test Loss: 15.859 Test Acc: 0.266
Validation loss decreased (-0.254639 --> -0.266001).  Saving model ...
Epoch: 5 cost time: 1.9756100177764893
Epoch: 5, Steps: 17 | Train Loss: 8.276 Vali Loss: 6.554 Vali Acc: 0.259 Test Loss: 6.554 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0040414333343506
Epoch: 6, Steps: 17 | Train Loss: 9.006 Vali Loss: 21.591 Vali Acc: 0.251 Test Loss: 21.591 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2916622161865234
Epoch: 7, Steps: 17 | Train Loss: 16.595 Vali Loss: 20.862 Vali Acc: 0.251 Test Loss: 20.862 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.359307050704956
Epoch: 8, Steps: 17 | Train Loss: 10.641 Vali Loss: 18.176 Vali Acc: 0.251 Test Loss: 18.176 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0081405639648438
Epoch: 9, Steps: 17 | Train Loss: 9.497 Vali Loss: 4.190 Vali Acc: 0.297 Test Loss: 4.190 Test Acc: 0.297
Validation loss decreased (-0.266001 --> -0.296536).  Saving model ...
Epoch: 10 cost time: 1.828096866607666
Epoch: 10, Steps: 17 | Train Loss: 9.354 Vali Loss: 9.739 Vali Acc: 0.262 Test Loss: 9.739 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0205090045928955
Epoch: 11, Steps: 17 | Train Loss: 8.508 Vali Loss: 5.148 Vali Acc: 0.236 Test Loss: 5.148 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0606658458709717
Epoch: 12, Steps: 17 | Train Loss: 10.648 Vali Loss: 27.994 Vali Acc: 0.255 Test Loss: 27.994 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0698959827423096
Epoch: 13, Steps: 17 | Train Loss: 19.634 Vali Loss: 26.339 Vali Acc: 0.262 Test Loss: 26.339 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5672578811645508
Epoch: 14, Steps: 17 | Train Loss: 18.847 Vali Loss: 15.488 Vali Acc: 0.270 Test Loss: 15.488 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0690367221832275
Epoch: 15, Steps: 17 | Train Loss: 12.491 Vali Loss: 15.667 Vali Acc: 0.274 Test Loss: 15.667 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9026141166687012
Epoch: 16, Steps: 17 | Train Loss: 9.986 Vali Loss: 18.202 Vali Acc: 0.236 Test Loss: 18.202 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9077045917510986
Epoch: 17, Steps: 17 | Train Loss: 7.416 Vali Loss: 14.832 Vali Acc: 0.224 Test Loss: 14.832 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.005237102508545
Epoch: 18, Steps: 17 | Train Loss: 5.227 Vali Loss: 10.745 Vali Acc: 0.240 Test Loss: 10.745 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.925037145614624
Epoch: 19, Steps: 17 | Train Loss: 3.498 Vali Loss: 12.501 Vali Acc: 0.247 Test Loss: 12.501 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 262364
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.541264533996582
Epoch: 1, Steps: 17 | Train Loss: 7.241 Vali Loss: 11.447 Vali Acc: 0.247 Test Loss: 11.447 Test Acc: 0.247
Validation loss decreased (inf --> -0.247034).  Saving model ...
Epoch: 2 cost time: 1.6274652481079102
Epoch: 2, Steps: 17 | Train Loss: 7.644 Vali Loss: 6.227 Vali Acc: 0.243 Test Loss: 6.227 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6758663654327393
Epoch: 3, Steps: 17 | Train Loss: 7.493 Vali Loss: 12.754 Vali Acc: 0.247 Test Loss: 12.754 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4335956573486328
Epoch: 4, Steps: 17 | Train Loss: 12.034 Vali Loss: 9.346 Vali Acc: 0.243 Test Loss: 9.346 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4249722957611084
Epoch: 5, Steps: 17 | Train Loss: 8.537 Vali Loss: 7.139 Vali Acc: 0.259 Test Loss: 7.139 Test Acc: 0.259
Validation loss decreased (-0.247034 --> -0.258484).  Saving model ...
Epoch: 6 cost time: 2.410492420196533
Epoch: 6, Steps: 17 | Train Loss: 7.797 Vali Loss: 8.824 Vali Acc: 0.259 Test Loss: 8.824 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0611155033111572
Epoch: 7, Steps: 17 | Train Loss: 7.061 Vali Loss: 14.614 Vali Acc: 0.259 Test Loss: 14.614 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1224634647369385
Epoch: 8, Steps: 17 | Train Loss: 9.412 Vali Loss: 9.921 Vali Acc: 0.243 Test Loss: 9.921 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.928727626800537
Epoch: 9, Steps: 17 | Train Loss: 7.658 Vali Loss: 14.097 Vali Acc: 0.274 Test Loss: 14.097 Test Acc: 0.274
Validation loss decreased (-0.258484 --> -0.273623).  Saving model ...
Epoch: 10 cost time: 1.9468328952789307
Epoch: 10, Steps: 17 | Train Loss: 19.183 Vali Loss: 32.845 Vali Acc: 0.259 Test Loss: 32.845 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9774703979492188
Epoch: 11, Steps: 17 | Train Loss: 20.013 Vali Loss: 24.290 Vali Acc: 0.266 Test Loss: 24.290 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7614054679870605
Epoch: 12, Steps: 17 | Train Loss: 13.082 Vali Loss: 18.665 Vali Acc: 0.289 Test Loss: 18.665 Test Acc: 0.289
Validation loss decreased (-0.273623 --> -0.288787).  Saving model ...
Epoch: 13 cost time: 1.894705057144165
Epoch: 13, Steps: 17 | Train Loss: 13.698 Vali Loss: 12.707 Vali Acc: 0.281 Test Loss: 12.707 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.110868215560913
Epoch: 14, Steps: 17 | Train Loss: 8.786 Vali Loss: 8.558 Vali Acc: 0.224 Test Loss: 8.558 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9011893272399902
Epoch: 15, Steps: 17 | Train Loss: 10.151 Vali Loss: 17.984 Vali Acc: 0.236 Test Loss: 17.984 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.679410457611084
Epoch: 16, Steps: 17 | Train Loss: 7.352 Vali Loss: 10.897 Vali Acc: 0.251 Test Loss: 10.897 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.110783100128174
Epoch: 17, Steps: 17 | Train Loss: 9.396 Vali Loss: 19.841 Vali Acc: 0.270 Test Loss: 19.841 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.940894603729248
Epoch: 18, Steps: 17 | Train Loss: 7.270 Vali Loss: 11.873 Vali Acc: 0.251 Test Loss: 11.873 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1331653594970703
Epoch: 19, Steps: 17 | Train Loss: 4.930 Vali Loss: 13.600 Vali Acc: 0.289 Test Loss: 13.600 Test Acc: 0.289
Validation loss decreased (-0.288787 --> -0.288837).  Saving model ...
Epoch: 20 cost time: 2.080432653427124
Epoch: 20, Steps: 17 | Train Loss: 5.725 Vali Loss: 13.503 Vali Acc: 0.285 Test Loss: 13.503 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9958341121673584
Epoch: 21, Steps: 17 | Train Loss: 4.886 Vali Loss: 11.331 Vali Acc: 0.274 Test Loss: 11.331 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1928224563598633
Epoch: 22, Steps: 17 | Train Loss: 3.485 Vali Loss: 15.298 Vali Acc: 0.259 Test Loss: 15.298 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.123359203338623
Epoch: 23, Steps: 17 | Train Loss: 3.891 Vali Loss: 17.860 Vali Acc: 0.289 Test Loss: 17.860 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9011683464050293
Epoch: 24, Steps: 17 | Train Loss: 5.603 Vali Loss: 25.245 Vali Acc: 0.232 Test Loss: 25.245 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.892143726348877
Epoch: 25, Steps: 17 | Train Loss: 5.603 Vali Loss: 22.413 Vali Acc: 0.266 Test Loss: 22.413 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.4388506412506104
Epoch: 26, Steps: 17 | Train Loss: 3.897 Vali Loss: 20.292 Vali Acc: 0.259 Test Loss: 20.292 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.1086249351501465
Epoch: 27, Steps: 17 | Train Loss: 3.057 Vali Loss: 21.717 Vali Acc: 0.259 Test Loss: 21.717 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.150395631790161
Epoch: 28, Steps: 17 | Train Loss: 1.868 Vali Loss: 26.416 Vali Acc: 0.224 Test Loss: 26.416 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.106825828552246
Epoch: 29, Steps: 17 | Train Loss: 3.694 Vali Loss: 32.780 Vali Acc: 0.266 Test Loss: 32.780 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 245980
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.9398632049560547
Epoch: 1, Steps: 17 | Train Loss: 6.869 Vali Loss: 7.182 Vali Acc: 0.259 Test Loss: 7.182 Test Acc: 0.259
Validation loss decreased (inf --> -0.258483).  Saving model ...
Epoch: 2 cost time: 2.2381131649017334
Epoch: 2, Steps: 17 | Train Loss: 6.233 Vali Loss: 10.806 Vali Acc: 0.270 Test Loss: 10.806 Test Acc: 0.270
Validation loss decreased (-0.258483 --> -0.269854).  Saving model ...
Epoch: 3 cost time: 2.100773811340332
Epoch: 3, Steps: 17 | Train Loss: 6.539 Vali Loss: 6.290 Vali Acc: 0.293 Test Loss: 6.290 Test Acc: 0.293
Validation loss decreased (-0.269854 --> -0.292713).  Saving model ...
Epoch: 4 cost time: 2.043109178543091
Epoch: 4, Steps: 17 | Train Loss: 7.361 Vali Loss: 13.798 Vali Acc: 0.281 Test Loss: 13.798 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5808329582214355
Epoch: 5, Steps: 17 | Train Loss: 10.674 Vali Loss: 19.068 Vali Acc: 0.255 Test Loss: 19.068 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9190094470977783
Epoch: 6, Steps: 17 | Train Loss: 11.109 Vali Loss: 11.126 Vali Acc: 0.274 Test Loss: 11.126 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.399885892868042
Epoch: 7, Steps: 17 | Train Loss: 8.385 Vali Loss: 10.679 Vali Acc: 0.255 Test Loss: 10.679 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9036774635314941
Epoch: 8, Steps: 17 | Train Loss: 10.315 Vali Loss: 14.084 Vali Acc: 0.266 Test Loss: 14.084 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2972943782806396
Epoch: 9, Steps: 17 | Train Loss: 13.258 Vali Loss: 21.764 Vali Acc: 0.259 Test Loss: 21.764 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.192758321762085
Epoch: 10, Steps: 17 | Train Loss: 8.880 Vali Loss: 10.038 Vali Acc: 0.251 Test Loss: 10.038 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.158205032348633
Epoch: 11, Steps: 17 | Train Loss: 7.905 Vali Loss: 15.399 Vali Acc: 0.255 Test Loss: 15.399 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9537773132324219
Epoch: 12, Steps: 17 | Train Loss: 7.519 Vali Loss: 14.582 Vali Acc: 0.251 Test Loss: 14.582 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6240875720977783
Epoch: 13, Steps: 17 | Train Loss: 8.884 Vali Loss: 12.005 Vali Acc: 0.262 Test Loss: 12.005 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 245980
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.9625635147094727
Epoch: 1, Steps: 17 | Train Loss: 6.992 Vali Loss: 9.895 Vali Acc: 0.255 Test Loss: 9.895 Test Acc: 0.255
Validation loss decreased (inf --> -0.254654).  Saving model ...
Epoch: 2 cost time: 1.6914525032043457
Epoch: 2, Steps: 17 | Train Loss: 7.102 Vali Loss: 6.736 Vali Acc: 0.259 Test Loss: 6.736 Test Acc: 0.259
Validation loss decreased (-0.254654 --> -0.258488).  Saving model ...
Epoch: 3 cost time: 1.9196968078613281
Epoch: 3, Steps: 17 | Train Loss: 6.809 Vali Loss: 8.347 Vali Acc: 0.255 Test Loss: 8.347 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3019959926605225
Epoch: 4, Steps: 17 | Train Loss: 10.485 Vali Loss: 11.361 Vali Acc: 0.240 Test Loss: 11.361 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.72536039352417
Epoch: 5, Steps: 17 | Train Loss: 10.078 Vali Loss: 18.377 Vali Acc: 0.270 Test Loss: 18.377 Test Acc: 0.270
Validation loss decreased (-0.258488 --> -0.269778).  Saving model ...
Epoch: 6 cost time: 1.9026830196380615
Epoch: 6, Steps: 17 | Train Loss: 9.799 Vali Loss: 6.253 Vali Acc: 0.270 Test Loss: 6.253 Test Acc: 0.270
Validation loss decreased (-0.269778 --> -0.269899).  Saving model ...
Epoch: 7 cost time: 1.9816572666168213
Epoch: 7, Steps: 17 | Train Loss: 8.123 Vali Loss: 20.142 Vali Acc: 0.240 Test Loss: 20.142 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7230210304260254
Epoch: 8, Steps: 17 | Train Loss: 14.344 Vali Loss: 21.253 Vali Acc: 0.259 Test Loss: 21.253 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8231966495513916
Epoch: 9, Steps: 17 | Train Loss: 14.796 Vali Loss: 25.726 Vali Acc: 0.243 Test Loss: 25.726 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9893105030059814
Epoch: 10, Steps: 17 | Train Loss: 15.516 Vali Loss: 27.148 Vali Acc: 0.240 Test Loss: 27.148 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.807246208190918
Epoch: 11, Steps: 17 | Train Loss: 13.030 Vali Loss: 15.138 Vali Acc: 0.259 Test Loss: 15.138 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5385267734527588
Epoch: 12, Steps: 17 | Train Loss: 7.733 Vali Loss: 8.356 Vali Acc: 0.266 Test Loss: 8.356 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0447771549224854
Epoch: 13, Steps: 17 | Train Loss: 10.462 Vali Loss: 18.647 Vali Acc: 0.251 Test Loss: 18.647 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.821333408355713
Epoch: 14, Steps: 17 | Train Loss: 10.434 Vali Loss: 11.051 Vali Acc: 0.251 Test Loss: 11.051 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9589147567749023
Epoch: 15, Steps: 17 | Train Loss: 7.490 Vali Loss: 9.914 Vali Acc: 0.224 Test Loss: 9.914 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6841890811920166
Epoch: 16, Steps: 17 | Train Loss: 4.667 Vali Loss: 7.965 Vali Acc: 0.262 Test Loss: 7.965 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 245980
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.493330240249634
Epoch: 1, Steps: 17 | Train Loss: 5.652 Vali Loss: 6.074 Vali Acc: 0.285 Test Loss: 6.074 Test Acc: 0.285
Validation loss decreased (inf --> -0.285110).  Saving model ...
Epoch: 2 cost time: 1.5488126277923584
Epoch: 2, Steps: 17 | Train Loss: 8.240 Vali Loss: 13.226 Vali Acc: 0.247 Test Loss: 13.226 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8460135459899902
Epoch: 3, Steps: 17 | Train Loss: 9.140 Vali Loss: 9.971 Vali Acc: 0.243 Test Loss: 9.971 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7794852256774902
Epoch: 4, Steps: 17 | Train Loss: 6.409 Vali Loss: 10.651 Vali Acc: 0.247 Test Loss: 10.651 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7655513286590576
Epoch: 5, Steps: 17 | Train Loss: 8.762 Vali Loss: 10.619 Vali Acc: 0.259 Test Loss: 10.619 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0699803829193115
Epoch: 6, Steps: 17 | Train Loss: 10.854 Vali Loss: 10.842 Vali Acc: 0.259 Test Loss: 10.842 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9797015190124512
Epoch: 7, Steps: 17 | Train Loss: 8.648 Vali Loss: 7.243 Vali Acc: 0.266 Test Loss: 7.243 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8863234519958496
Epoch: 8, Steps: 17 | Train Loss: 13.031 Vali Loss: 15.486 Vali Acc: 0.224 Test Loss: 15.486 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.893017053604126
Epoch: 9, Steps: 17 | Train Loss: 9.227 Vali Loss: 7.949 Vali Acc: 0.285 Test Loss: 7.949 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6561088562011719
Epoch: 10, Steps: 17 | Train Loss: 8.604 Vali Loss: 16.893 Vali Acc: 0.247 Test Loss: 16.893 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.588702917098999
Epoch: 11, Steps: 17 | Train Loss: 12.591 Vali Loss: 9.308 Vali Acc: 0.278 Test Loss: 9.308 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 245980
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.021728515625
Epoch: 1, Steps: 17 | Train Loss: 5.335 Vali Loss: 4.696 Vali Acc: 0.232 Test Loss: 4.696 Test Acc: 0.232
Validation loss decreased (inf --> -0.231892).  Saving model ...
Epoch: 2 cost time: 1.631639003753662
Epoch: 2, Steps: 17 | Train Loss: 6.715 Vali Loss: 7.873 Vali Acc: 0.266 Test Loss: 7.873 Test Acc: 0.266
Validation loss decreased (-0.231892 --> -0.266081).  Saving model ...
Epoch: 3 cost time: 2.000488519668579
Epoch: 3, Steps: 17 | Train Loss: 10.297 Vali Loss: 10.942 Vali Acc: 0.240 Test Loss: 10.942 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9678876399993896
Epoch: 4, Steps: 17 | Train Loss: 10.535 Vali Loss: 15.778 Vali Acc: 0.251 Test Loss: 15.778 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2457680702209473
Epoch: 5, Steps: 17 | Train Loss: 12.251 Vali Loss: 8.825 Vali Acc: 0.262 Test Loss: 8.825 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3564393520355225
Epoch: 6, Steps: 17 | Train Loss: 9.264 Vali Loss: 12.064 Vali Acc: 0.255 Test Loss: 12.064 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.639369010925293
Epoch: 7, Steps: 17 | Train Loss: 10.333 Vali Loss: 7.296 Vali Acc: 0.270 Test Loss: 7.296 Test Acc: 0.270
Validation loss decreased (-0.266081 --> -0.269889).  Saving model ...
Epoch: 8 cost time: 2.153210401535034
Epoch: 8, Steps: 17 | Train Loss: 12.097 Vali Loss: 26.213 Vali Acc: 0.240 Test Loss: 26.213 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8718349933624268
Epoch: 9, Steps: 17 | Train Loss: 13.848 Vali Loss: 10.363 Vali Acc: 0.224 Test Loss: 10.363 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3754336833953857
Epoch: 10, Steps: 17 | Train Loss: 8.527 Vali Loss: 15.669 Vali Acc: 0.274 Test Loss: 15.669 Test Acc: 0.274
Validation loss decreased (-0.269889 --> -0.273608).  Saving model ...
Epoch: 11 cost time: 2.1916325092315674
Epoch: 11, Steps: 17 | Train Loss: 13.903 Vali Loss: 10.024 Vali Acc: 0.228 Test Loss: 10.024 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7632853984832764
Epoch: 12, Steps: 17 | Train Loss: 14.119 Vali Loss: 13.413 Vali Acc: 0.240 Test Loss: 13.413 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7039473056793213
Epoch: 13, Steps: 17 | Train Loss: 8.547 Vali Loss: 10.213 Vali Acc: 0.259 Test Loss: 10.213 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5995910167694092
Epoch: 14, Steps: 17 | Train Loss: 5.801 Vali Loss: 13.141 Vali Acc: 0.236 Test Loss: 13.141 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6158368587493896
Epoch: 15, Steps: 17 | Train Loss: 7.675 Vali Loss: 13.646 Vali Acc: 0.251 Test Loss: 13.646 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1166083812713623
Epoch: 16, Steps: 17 | Train Loss: 10.425 Vali Loss: 20.706 Vali Acc: 0.251 Test Loss: 20.706 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.967545986175537
Epoch: 17, Steps: 17 | Train Loss: 9.803 Vali Loss: 12.890 Vali Acc: 0.247 Test Loss: 12.890 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.2478718757629395
Epoch: 18, Steps: 17 | Train Loss: 6.930 Vali Loss: 14.435 Vali Acc: 0.251 Test Loss: 14.435 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.292557716369629
Epoch: 19, Steps: 17 | Train Loss: 7.661 Vali Loss: 33.419 Vali Acc: 0.255 Test Loss: 33.419 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7601590156555176
Epoch: 20, Steps: 17 | Train Loss: 13.819 Vali Loss: 22.574 Vali Acc: 0.274 Test Loss: 22.574 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 237788
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.1393516063690186
Epoch: 1, Steps: 17 | Train Loss: 5.772 Vali Loss: 5.199 Vali Acc: 0.243 Test Loss: 5.199 Test Acc: 0.243
Validation loss decreased (inf --> -0.243294).  Saving model ...
Epoch: 2 cost time: 1.9292304515838623
Epoch: 2, Steps: 17 | Train Loss: 5.846 Vali Loss: 5.100 Vali Acc: 0.259 Test Loss: 5.100 Test Acc: 0.259
Validation loss decreased (-0.243294 --> -0.258504).  Saving model ...
Epoch: 3 cost time: 2.04152512550354
Epoch: 3, Steps: 17 | Train Loss: 6.372 Vali Loss: 6.843 Vali Acc: 0.247 Test Loss: 6.843 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8660452365875244
Epoch: 4, Steps: 17 | Train Loss: 6.748 Vali Loss: 12.445 Vali Acc: 0.240 Test Loss: 12.445 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9118413925170898
Epoch: 5, Steps: 17 | Train Loss: 10.514 Vali Loss: 7.387 Vali Acc: 0.236 Test Loss: 7.387 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7991690635681152
Epoch: 6, Steps: 17 | Train Loss: 10.627 Vali Loss: 14.025 Vali Acc: 0.262 Test Loss: 14.025 Test Acc: 0.262
Validation loss decreased (-0.258504 --> -0.262217).  Saving model ...
Epoch: 7 cost time: 1.8851525783538818
Epoch: 7, Steps: 17 | Train Loss: 15.060 Vali Loss: 32.316 Vali Acc: 0.247 Test Loss: 32.316 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9623243808746338
Epoch: 8, Steps: 17 | Train Loss: 18.167 Vali Loss: 10.919 Vali Acc: 0.262 Test Loss: 10.919 Test Acc: 0.262
Validation loss decreased (-0.262217 --> -0.262248).  Saving model ...
Epoch: 9 cost time: 2.0126729011535645
Epoch: 9, Steps: 17 | Train Loss: 11.442 Vali Loss: 12.449 Vali Acc: 0.247 Test Loss: 12.449 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9695029258728027
Epoch: 10, Steps: 17 | Train Loss: 10.934 Vali Loss: 23.734 Vali Acc: 0.255 Test Loss: 23.734 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1295204162597656
Epoch: 11, Steps: 17 | Train Loss: 14.145 Vali Loss: 13.802 Vali Acc: 0.243 Test Loss: 13.802 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8489737510681152
Epoch: 12, Steps: 17 | Train Loss: 9.814 Vali Loss: 19.285 Vali Acc: 0.259 Test Loss: 19.285 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7747032642364502
Epoch: 13, Steps: 17 | Train Loss: 12.109 Vali Loss: 14.987 Vali Acc: 0.262 Test Loss: 14.987 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7357728481292725
Epoch: 14, Steps: 17 | Train Loss: 9.182 Vali Loss: 12.334 Vali Acc: 0.243 Test Loss: 12.334 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9096546173095703
Epoch: 15, Steps: 17 | Train Loss: 10.500 Vali Loss: 21.132 Vali Acc: 0.243 Test Loss: 21.132 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8661019802093506
Epoch: 16, Steps: 17 | Train Loss: 12.789 Vali Loss: 14.925 Vali Acc: 0.262 Test Loss: 14.925 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.606327772140503
Epoch: 17, Steps: 17 | Train Loss: 7.226 Vali Loss: 9.175 Vali Acc: 0.236 Test Loss: 9.175 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8733360767364502
Epoch: 18, Steps: 17 | Train Loss: 6.738 Vali Loss: 15.334 Vali Acc: 0.262 Test Loss: 15.334 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 237788
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.094470977783203
Epoch: 1, Steps: 17 | Train Loss: 5.465 Vali Loss: 5.486 Vali Acc: 0.255 Test Loss: 5.486 Test Acc: 0.255
Validation loss decreased (inf --> -0.254698).  Saving model ...
Epoch: 2 cost time: 1.908189058303833
Epoch: 2, Steps: 17 | Train Loss: 6.313 Vali Loss: 9.609 Vali Acc: 0.251 Test Loss: 9.609 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9986331462860107
Epoch: 3, Steps: 17 | Train Loss: 6.941 Vali Loss: 7.215 Vali Acc: 0.274 Test Loss: 7.215 Test Acc: 0.274
Validation loss decreased (-0.254698 --> -0.273692).  Saving model ...
Epoch: 4 cost time: 2.055147409439087
Epoch: 4, Steps: 17 | Train Loss: 8.056 Vali Loss: 10.738 Vali Acc: 0.251 Test Loss: 10.738 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7753503322601318
Epoch: 5, Steps: 17 | Train Loss: 6.840 Vali Loss: 9.741 Vali Acc: 0.243 Test Loss: 9.741 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7049641609191895
Epoch: 6, Steps: 17 | Train Loss: 10.426 Vali Loss: 13.046 Vali Acc: 0.255 Test Loss: 13.046 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.434138298034668
Epoch: 7, Steps: 17 | Train Loss: 12.130 Vali Loss: 17.030 Vali Acc: 0.247 Test Loss: 17.030 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5761723518371582
Epoch: 8, Steps: 17 | Train Loss: 8.334 Vali Loss: 27.144 Vali Acc: 0.243 Test Loss: 27.144 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.474316120147705
Epoch: 9, Steps: 17 | Train Loss: 15.326 Vali Loss: 18.824 Vali Acc: 0.255 Test Loss: 18.824 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9137284755706787
Epoch: 10, Steps: 17 | Train Loss: 12.218 Vali Loss: 25.174 Vali Acc: 0.240 Test Loss: 25.174 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9913935661315918
Epoch: 11, Steps: 17 | Train Loss: 17.486 Vali Loss: 17.797 Vali Acc: 0.232 Test Loss: 17.797 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8946900367736816
Epoch: 12, Steps: 17 | Train Loss: 8.143 Vali Loss: 15.100 Vali Acc: 0.251 Test Loss: 15.100 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7028248310089111
Epoch: 13, Steps: 17 | Train Loss: 10.775 Vali Loss: 16.900 Vali Acc: 0.281 Test Loss: 16.900 Test Acc: 0.281
Validation loss decreased (-0.273692 --> -0.281200).  Saving model ...
Epoch: 14 cost time: 1.973572015762329
Epoch: 14, Steps: 17 | Train Loss: 9.420 Vali Loss: 14.519 Vali Acc: 0.236 Test Loss: 14.519 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9337167739868164
Epoch: 15, Steps: 17 | Train Loss: 5.755 Vali Loss: 19.820 Vali Acc: 0.240 Test Loss: 19.820 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8632001876831055
Epoch: 16, Steps: 17 | Train Loss: 6.428 Vali Loss: 8.372 Vali Acc: 0.259 Test Loss: 8.372 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4997515678405762
Epoch: 17, Steps: 17 | Train Loss: 7.095 Vali Loss: 20.137 Vali Acc: 0.236 Test Loss: 20.137 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8751420974731445
Epoch: 18, Steps: 17 | Train Loss: 3.756 Vali Loss: 19.043 Vali Acc: 0.278 Test Loss: 19.043 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6227352619171143
Epoch: 19, Steps: 17 | Train Loss: 9.393 Vali Loss: 16.783 Vali Acc: 0.243 Test Loss: 16.783 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8040378093719482
Epoch: 20, Steps: 17 | Train Loss: 4.886 Vali Loss: 12.568 Vali Acc: 0.243 Test Loss: 12.568 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7199604511260986
Epoch: 21, Steps: 17 | Train Loss: 4.394 Vali Loss: 19.834 Vali Acc: 0.270 Test Loss: 19.834 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7858781814575195
Epoch: 22, Steps: 17 | Train Loss: 5.601 Vali Loss: 19.485 Vali Acc: 0.243 Test Loss: 19.485 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3834843635559082
Epoch: 23, Steps: 17 | Train Loss: 4.722 Vali Loss: 15.228 Vali Acc: 0.224 Test Loss: 15.228 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 237788
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5834882259368896
Epoch: 1, Steps: 17 | Train Loss: 5.714 Vali Loss: 5.826 Vali Acc: 0.247 Test Loss: 5.826 Test Acc: 0.247
Validation loss decreased (inf --> -0.247090).  Saving model ...
Epoch: 2 cost time: 1.7806203365325928
Epoch: 2, Steps: 17 | Train Loss: 6.678 Vali Loss: 5.117 Vali Acc: 0.232 Test Loss: 5.117 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3750824928283691
Epoch: 3, Steps: 17 | Train Loss: 5.968 Vali Loss: 7.207 Vali Acc: 0.262 Test Loss: 7.207 Test Acc: 0.262
Validation loss decreased (-0.247090 --> -0.262285).  Saving model ...
Epoch: 4 cost time: 1.751878261566162
Epoch: 4, Steps: 17 | Train Loss: 6.986 Vali Loss: 13.443 Vali Acc: 0.251 Test Loss: 13.443 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6056768894195557
Epoch: 5, Steps: 17 | Train Loss: 7.713 Vali Loss: 5.800 Vali Acc: 0.228 Test Loss: 5.800 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8283863067626953
Epoch: 6, Steps: 17 | Train Loss: 10.596 Vali Loss: 5.134 Vali Acc: 0.236 Test Loss: 5.134 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7217929363250732
Epoch: 7, Steps: 17 | Train Loss: 13.887 Vali Loss: 23.296 Vali Acc: 0.247 Test Loss: 23.296 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8487095832824707
Epoch: 8, Steps: 17 | Train Loss: 13.115 Vali Loss: 11.880 Vali Acc: 0.266 Test Loss: 11.880 Test Acc: 0.266
Validation loss decreased (-0.262285 --> -0.266041).  Saving model ...
Epoch: 9 cost time: 1.7593109607696533
Epoch: 9, Steps: 17 | Train Loss: 11.254 Vali Loss: 21.991 Vali Acc: 0.247 Test Loss: 21.991 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.330667495727539
Epoch: 10, Steps: 17 | Train Loss: 10.013 Vali Loss: 5.689 Vali Acc: 0.247 Test Loss: 5.689 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7365381717681885
Epoch: 11, Steps: 17 | Train Loss: 13.091 Vali Loss: 10.569 Vali Acc: 0.240 Test Loss: 10.569 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8278145790100098
Epoch: 12, Steps: 17 | Train Loss: 11.156 Vali Loss: 10.474 Vali Acc: 0.240 Test Loss: 10.474 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.813758134841919
Epoch: 13, Steps: 17 | Train Loss: 8.285 Vali Loss: 16.746 Vali Acc: 0.251 Test Loss: 16.746 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7242305278778076
Epoch: 14, Steps: 17 | Train Loss: 8.133 Vali Loss: 10.261 Vali Acc: 0.247 Test Loss: 10.261 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3403630256652832
Epoch: 15, Steps: 17 | Train Loss: 10.754 Vali Loss: 16.506 Vali Acc: 0.236 Test Loss: 16.506 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.642225742340088
Epoch: 16, Steps: 17 | Train Loss: 8.693 Vali Loss: 16.298 Vali Acc: 0.259 Test Loss: 16.298 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7772555351257324
Epoch: 17, Steps: 17 | Train Loss: 9.146 Vali Loss: 22.324 Vali Acc: 0.236 Test Loss: 22.324 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7754089832305908
Epoch: 18, Steps: 17 | Train Loss: 6.104 Vali Loss: 11.465 Vali Acc: 0.293 Test Loss: 11.465 Test Acc: 0.293
Validation loss decreased (-0.266041 --> -0.292661).  Saving model ...
Epoch: 19 cost time: 1.877974271774292
Epoch: 19, Steps: 17 | Train Loss: 5.286 Vali Loss: 21.686 Vali Acc: 0.289 Test Loss: 21.686 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4933257102966309
Epoch: 20, Steps: 17 | Train Loss: 5.313 Vali Loss: 14.526 Vali Acc: 0.274 Test Loss: 14.526 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6040170192718506
Epoch: 21, Steps: 17 | Train Loss: 4.901 Vali Loss: 19.892 Vali Acc: 0.240 Test Loss: 19.892 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7083625793457031
Epoch: 22, Steps: 17 | Train Loss: 3.100 Vali Loss: 16.925 Vali Acc: 0.236 Test Loss: 16.925 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.740065574645996
Epoch: 23, Steps: 17 | Train Loss: 3.048 Vali Loss: 18.673 Vali Acc: 0.304 Test Loss: 18.673 Test Acc: 0.304
Validation loss decreased (-0.292661 --> -0.303996).  Saving model ...
Epoch: 24 cost time: 1.8140957355499268
Epoch: 24, Steps: 17 | Train Loss: 5.393 Vali Loss: 31.312 Vali Acc: 0.243 Test Loss: 31.312 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5116550922393799
Epoch: 25, Steps: 17 | Train Loss: 4.761 Vali Loss: 18.925 Vali Acc: 0.262 Test Loss: 18.925 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.798253059387207
Epoch: 26, Steps: 17 | Train Loss: 3.629 Vali Loss: 24.338 Vali Acc: 0.266 Test Loss: 24.338 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8407557010650635
Epoch: 27, Steps: 17 | Train Loss: 2.844 Vali Loss: 24.347 Vali Acc: 0.236 Test Loss: 24.347 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4915375709533691
Epoch: 28, Steps: 17 | Train Loss: 2.217 Vali Loss: 27.512 Vali Acc: 0.262 Test Loss: 27.512 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.1350412368774414
Epoch: 29, Steps: 17 | Train Loss: 4.309 Vali Loss: 35.242 Vali Acc: 0.251 Test Loss: 35.242 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.699951171875
Epoch: 30, Steps: 17 | Train Loss: 3.166 Vali Loss: 33.399 Vali Acc: 0.266 Test Loss: 33.399 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.669306755065918
Epoch: 31, Steps: 17 | Train Loss: 2.650 Vali Loss: 35.730 Vali Acc: 0.243 Test Loss: 35.730 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.9892516136169434
Epoch: 32, Steps: 17 | Train Loss: 2.783 Vali Loss: 43.052 Vali Acc: 0.266 Test Loss: 43.052 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.6060352325439453
Epoch: 33, Steps: 17 | Train Loss: 1.506 Vali Loss: 45.064 Vali Acc: 0.259 Test Loss: 45.064 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 237788
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.393211841583252
Epoch: 1, Steps: 17 | Train Loss: 35.375 Vali Loss: 58.230 Vali Acc: 0.247 Test Loss: 58.230 Test Acc: 0.247
Validation loss decreased (inf --> -0.246566).  Saving model ...
Epoch: 2 cost time: 4.817133903503418
Epoch: 2, Steps: 17 | Train Loss: 90.149 Vali Loss: 130.139 Vali Acc: 0.278 Test Loss: 130.139 Test Acc: 0.278
Validation loss decreased (-0.246566 --> -0.276265).  Saving model ...
Epoch: 3 cost time: 4.867104768753052
Epoch: 3, Steps: 17 | Train Loss: 79.287 Vali Loss: 104.183 Vali Acc: 0.243 Test Loss: 104.183 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.102631092071533
Epoch: 4, Steps: 17 | Train Loss: 126.273 Vali Loss: 282.500 Vali Acc: 0.243 Test Loss: 282.500 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.768681049346924
Epoch: 5, Steps: 17 | Train Loss: 146.333 Vali Loss: 176.076 Vali Acc: 0.232 Test Loss: 176.076 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.0390565395355225
Epoch: 6, Steps: 17 | Train Loss: 161.427 Vali Loss: 280.530 Vali Acc: 0.266 Test Loss: 280.530 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.66216516494751
Epoch: 7, Steps: 17 | Train Loss: 142.973 Vali Loss: 315.734 Vali Acc: 0.243 Test Loss: 315.734 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.0998594760894775
Epoch: 8, Steps: 17 | Train Loss: 170.836 Vali Loss: 255.006 Vali Acc: 0.266 Test Loss: 255.006 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.917811155319214
Epoch: 9, Steps: 17 | Train Loss: 136.068 Vali Loss: 325.626 Vali Acc: 0.247 Test Loss: 325.626 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.334161758422852
Epoch: 10, Steps: 17 | Train Loss: 111.192 Vali Loss: 484.013 Vali Acc: 0.285 Test Loss: 484.013 Test Acc: 0.285
Validation loss decreased (-0.276265 --> -0.280331).  Saving model ...
Epoch: 11 cost time: 4.854132652282715
Epoch: 11, Steps: 17 | Train Loss: 93.927 Vali Loss: 381.379 Vali Acc: 0.270 Test Loss: 381.379 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.548043251037598
Epoch: 12, Steps: 17 | Train Loss: 55.673 Vali Loss: 504.831 Vali Acc: 0.293 Test Loss: 504.831 Test Acc: 0.293
Validation loss decreased (-0.280331 --> -0.287727).  Saving model ...
Epoch: 13 cost time: 5.159941673278809
Epoch: 13, Steps: 17 | Train Loss: 63.878 Vali Loss: 523.167 Vali Acc: 0.259 Test Loss: 523.167 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.90739893913269
Epoch: 14, Steps: 17 | Train Loss: 93.993 Vali Loss: 778.651 Vali Acc: 0.270 Test Loss: 778.651 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.326448440551758
Epoch: 15, Steps: 17 | Train Loss: 44.943 Vali Loss: 819.067 Vali Acc: 0.228 Test Loss: 819.067 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.929322719573975
Epoch: 16, Steps: 17 | Train Loss: 27.068 Vali Loss: 896.638 Vali Acc: 0.240 Test Loss: 896.638 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.899249792098999
Epoch: 17, Steps: 17 | Train Loss: 36.357 Vali Loss: 1105.167 Vali Acc: 0.274 Test Loss: 1105.167 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.797023773193359
Epoch: 18, Steps: 17 | Train Loss: 81.825 Vali Loss: 1272.264 Vali Acc: 0.224 Test Loss: 1272.264 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.446436882019043
Epoch: 19, Steps: 17 | Train Loss: 116.780 Vali Loss: 1393.860 Vali Acc: 0.270 Test Loss: 1393.860 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.50614595413208
Epoch: 20, Steps: 17 | Train Loss: 57.002 Vali Loss: 1586.782 Vali Acc: 0.255 Test Loss: 1586.782 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.504736423492432
Epoch: 21, Steps: 17 | Train Loss: 53.752 Vali Loss: 1984.694 Vali Acc: 0.266 Test Loss: 1984.694 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.518751621246338
Epoch: 22, Steps: 17 | Train Loss: 122.990 Vali Loss: 2914.712 Vali Acc: 0.255 Test Loss: 2914.712 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 6221344
model size : 33.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.870720386505127
Epoch: 1, Steps: 17 | Train Loss: 35.863 Vali Loss: 116.577 Vali Acc: 0.251 Test Loss: 116.577 Test Acc: 0.251
Validation loss decreased (inf --> -0.249785).  Saving model ...
Epoch: 2 cost time: 4.164496660232544
Epoch: 2, Steps: 17 | Train Loss: 100.975 Vali Loss: 135.556 Vali Acc: 0.266 Test Loss: 135.556 Test Acc: 0.266
Validation loss decreased (-0.249785 --> -0.264804).  Saving model ...
Epoch: 3 cost time: 4.698916673660278
Epoch: 3, Steps: 17 | Train Loss: 255.273 Vali Loss: 465.696 Vali Acc: 0.251 Test Loss: 465.696 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.398246765136719
Epoch: 4, Steps: 17 | Train Loss: 206.700 Vali Loss: 215.243 Vali Acc: 0.259 Test Loss: 215.243 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.357929468154907
Epoch: 5, Steps: 17 | Train Loss: 219.730 Vali Loss: 319.113 Vali Acc: 0.270 Test Loss: 319.113 Test Acc: 0.270
Validation loss decreased (-0.264804 --> -0.266771).  Saving model ...
Epoch: 6 cost time: 4.092114686965942
Epoch: 6, Steps: 17 | Train Loss: 226.208 Vali Loss: 377.561 Vali Acc: 0.262 Test Loss: 377.561 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.547735691070557
Epoch: 7, Steps: 17 | Train Loss: 198.007 Vali Loss: 273.519 Vali Acc: 0.266 Test Loss: 273.519 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.310107707977295
Epoch: 8, Steps: 17 | Train Loss: 169.939 Vali Loss: 235.672 Vali Acc: 0.243 Test Loss: 235.672 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.666058778762817
Epoch: 9, Steps: 17 | Train Loss: 121.565 Vali Loss: 349.789 Vali Acc: 0.293 Test Loss: 349.789 Test Acc: 0.293
Validation loss decreased (-0.266771 --> -0.289278).  Saving model ...
Epoch: 10 cost time: 4.357950210571289
Epoch: 10, Steps: 17 | Train Loss: 84.584 Vali Loss: 452.205 Vali Acc: 0.262 Test Loss: 452.205 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.337628126144409
Epoch: 11, Steps: 17 | Train Loss: 167.551 Vali Loss: 656.662 Vali Acc: 0.266 Test Loss: 656.662 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.372270584106445
Epoch: 12, Steps: 17 | Train Loss: 94.303 Vali Loss: 502.690 Vali Acc: 0.289 Test Loss: 502.690 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.319293737411499
Epoch: 13, Steps: 17 | Train Loss: 45.891 Vali Loss: 637.367 Vali Acc: 0.266 Test Loss: 637.367 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.1880249977111816
Epoch: 14, Steps: 17 | Train Loss: 110.390 Vali Loss: 764.564 Vali Acc: 0.285 Test Loss: 764.564 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.1921913623809814
Epoch: 15, Steps: 17 | Train Loss: 84.993 Vali Loss: 857.201 Vali Acc: 0.262 Test Loss: 857.201 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.655893087387085
Epoch: 16, Steps: 17 | Train Loss: 85.590 Vali Loss: 888.332 Vali Acc: 0.285 Test Loss: 888.332 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.106133460998535
Epoch: 17, Steps: 17 | Train Loss: 89.994 Vali Loss: 1100.978 Vali Acc: 0.278 Test Loss: 1100.978 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.926922559738159
Epoch: 18, Steps: 17 | Train Loss: 40.618 Vali Loss: 1449.381 Vali Acc: 0.274 Test Loss: 1449.381 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.897987365722656
Epoch: 19, Steps: 17 | Train Loss: 117.245 Vali Loss: 1530.172 Vali Acc: 0.266 Test Loss: 1530.172 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 6221344
model size : 33.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.837488651275635
Epoch: 1, Steps: 17 | Train Loss: 35.591 Vali Loss: 65.907 Vali Acc: 0.251 Test Loss: 65.907 Test Acc: 0.251
Validation loss decreased (inf --> -0.250291).  Saving model ...
Epoch: 2 cost time: 4.305976629257202
Epoch: 2, Steps: 17 | Train Loss: 97.208 Vali Loss: 163.880 Vali Acc: 0.243 Test Loss: 163.880 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6769094467163086
Epoch: 3, Steps: 17 | Train Loss: 153.692 Vali Loss: 221.815 Vali Acc: 0.247 Test Loss: 221.815 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.580470323562622
Epoch: 4, Steps: 17 | Train Loss: 185.061 Vali Loss: 354.823 Vali Acc: 0.247 Test Loss: 354.823 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.3415045738220215
Epoch: 5, Steps: 17 | Train Loss: 160.397 Vali Loss: 171.668 Vali Acc: 0.270 Test Loss: 171.668 Test Acc: 0.270
Validation loss decreased (-0.250291 --> -0.268245).  Saving model ...
Epoch: 6 cost time: 4.122644424438477
Epoch: 6, Steps: 17 | Train Loss: 116.392 Vali Loss: 240.865 Vali Acc: 0.236 Test Loss: 240.865 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.339746475219727
Epoch: 7, Steps: 17 | Train Loss: 133.052 Vali Loss: 209.562 Vali Acc: 0.274 Test Loss: 209.562 Test Acc: 0.274
Validation loss decreased (-0.268245 --> -0.271669).  Saving model ...
Epoch: 8 cost time: 4.584223747253418
Epoch: 8, Steps: 17 | Train Loss: 106.936 Vali Loss: 198.903 Vali Acc: 0.255 Test Loss: 198.903 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.914608478546143
Epoch: 9, Steps: 17 | Train Loss: 47.980 Vali Loss: 305.907 Vali Acc: 0.240 Test Loss: 305.907 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.341160535812378
Epoch: 10, Steps: 17 | Train Loss: 88.491 Vali Loss: 526.475 Vali Acc: 0.251 Test Loss: 526.475 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.45734977722168
Epoch: 11, Steps: 17 | Train Loss: 101.951 Vali Loss: 671.993 Vali Acc: 0.247 Test Loss: 671.993 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.192391872406006
Epoch: 12, Steps: 17 | Train Loss: 39.711 Vali Loss: 665.980 Vali Acc: 0.293 Test Loss: 665.980 Test Acc: 0.293
Validation loss decreased (-0.271669 --> -0.286116).  Saving model ...
Epoch: 13 cost time: 4.208633184432983
Epoch: 13, Steps: 17 | Train Loss: 56.612 Vali Loss: 728.471 Vali Acc: 0.259 Test Loss: 728.471 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.51244044303894
Epoch: 14, Steps: 17 | Train Loss: 47.202 Vali Loss: 1061.833 Vali Acc: 0.281 Test Loss: 1061.833 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.4958765506744385
Epoch: 15, Steps: 17 | Train Loss: 72.999 Vali Loss: 980.714 Vali Acc: 0.243 Test Loss: 980.714 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.709217309951782
Epoch: 16, Steps: 17 | Train Loss: 110.039 Vali Loss: 1036.446 Vali Acc: 0.243 Test Loss: 1036.446 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.234459161758423
Epoch: 17, Steps: 17 | Train Loss: 54.274 Vali Loss: 1280.853 Vali Acc: 0.262 Test Loss: 1280.853 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.336338758468628
Epoch: 18, Steps: 17 | Train Loss: 29.646 Vali Loss: 1390.308 Vali Acc: 0.240 Test Loss: 1390.308 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.5436201095581055
Epoch: 19, Steps: 17 | Train Loss: 48.885 Vali Loss: 1556.483 Vali Acc: 0.243 Test Loss: 1556.483 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.151063680648804
Epoch: 20, Steps: 17 | Train Loss: 22.897 Vali Loss: 1787.707 Vali Acc: 0.236 Test Loss: 1787.707 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.268284320831299
Epoch: 21, Steps: 17 | Train Loss: 62.931 Vali Loss: 1912.496 Vali Acc: 0.243 Test Loss: 1912.496 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.3158862590789795
Epoch: 22, Steps: 17 | Train Loss: 52.204 Vali Loss: 2342.897 Vali Acc: 0.236 Test Loss: 2342.897 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 6221344
model size : 33.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.9724204540252686
Epoch: 1, Steps: 17 | Train Loss: 30.076 Vali Loss: 60.646 Vali Acc: 0.274 Test Loss: 60.646 Test Acc: 0.274
Validation loss decreased (inf --> -0.273158).  Saving model ...
Epoch: 2 cost time: 3.625638961791992
Epoch: 2, Steps: 17 | Train Loss: 73.999 Vali Loss: 127.383 Vali Acc: 0.266 Test Loss: 127.383 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.079957723617554
Epoch: 3, Steps: 17 | Train Loss: 112.940 Vali Loss: 192.821 Vali Acc: 0.259 Test Loss: 192.821 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.41217041015625
Epoch: 4, Steps: 17 | Train Loss: 192.040 Vali Loss: 365.909 Vali Acc: 0.251 Test Loss: 365.909 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.216561794281006
Epoch: 5, Steps: 17 | Train Loss: 263.576 Vali Loss: 216.314 Vali Acc: 0.251 Test Loss: 216.314 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.1723713874816895
Epoch: 6, Steps: 17 | Train Loss: 162.713 Vali Loss: 323.368 Vali Acc: 0.262 Test Loss: 323.368 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.157081127166748
Epoch: 7, Steps: 17 | Train Loss: 125.146 Vali Loss: 178.918 Vali Acc: 0.240 Test Loss: 178.918 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.018339157104492
Epoch: 8, Steps: 17 | Train Loss: 93.922 Vali Loss: 330.245 Vali Acc: 0.262 Test Loss: 330.245 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.321387767791748
Epoch: 9, Steps: 17 | Train Loss: 97.968 Vali Loss: 580.207 Vali Acc: 0.274 Test Loss: 580.207 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.886326551437378
Epoch: 10, Steps: 17 | Train Loss: 87.334 Vali Loss: 532.270 Vali Acc: 0.270 Test Loss: 532.270 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.171488285064697
Epoch: 11, Steps: 17 | Train Loss: 77.540 Vali Loss: 535.123 Vali Acc: 0.232 Test Loss: 535.123 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 6221344
model size : 33.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.47026252746582
Epoch: 1, Steps: 17 | Train Loss: 45.492 Vali Loss: 76.423 Vali Acc: 0.259 Test Loss: 76.423 Test Acc: 0.259
Validation loss decreased (inf --> -0.257791).  Saving model ...
Epoch: 2 cost time: 4.6147520542144775
Epoch: 2, Steps: 17 | Train Loss: 98.649 Vali Loss: 164.140 Vali Acc: 0.251 Test Loss: 164.140 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.995689868927002
Epoch: 3, Steps: 17 | Train Loss: 139.904 Vali Loss: 358.174 Vali Acc: 0.243 Test Loss: 358.174 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.802576541900635
Epoch: 4, Steps: 17 | Train Loss: 235.304 Vali Loss: 288.092 Vali Acc: 0.255 Test Loss: 288.092 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.885033130645752
Epoch: 5, Steps: 17 | Train Loss: 181.426 Vali Loss: 182.989 Vali Acc: 0.232 Test Loss: 182.989 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.9755160808563232
Epoch: 6, Steps: 17 | Train Loss: 141.590 Vali Loss: 172.396 Vali Acc: 0.240 Test Loss: 172.396 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.9594273567199707
Epoch: 7, Steps: 17 | Train Loss: 98.682 Vali Loss: 174.278 Vali Acc: 0.251 Test Loss: 174.278 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.0572545528411865
Epoch: 8, Steps: 17 | Train Loss: 58.404 Vali Loss: 266.663 Vali Acc: 0.270 Test Loss: 266.663 Test Acc: 0.270
Validation loss decreased (-0.257791 --> -0.267295).  Saving model ...
Epoch: 9 cost time: 4.58461594581604
Epoch: 9, Steps: 17 | Train Loss: 61.516 Vali Loss: 193.478 Vali Acc: 0.262 Test Loss: 193.478 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.331599473953247
Epoch: 10, Steps: 17 | Train Loss: 78.248 Vali Loss: 495.006 Vali Acc: 0.255 Test Loss: 495.006 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.76529598236084
Epoch: 11, Steps: 17 | Train Loss: 148.939 Vali Loss: 452.267 Vali Acc: 0.221 Test Loss: 452.267 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.16818642616272
Epoch: 12, Steps: 17 | Train Loss: 89.414 Vali Loss: 447.309 Vali Acc: 0.243 Test Loss: 447.309 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.913425922393799
Epoch: 13, Steps: 17 | Train Loss: 79.633 Vali Loss: 602.740 Vali Acc: 0.243 Test Loss: 602.740 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.7265095710754395
Epoch: 14, Steps: 17 | Train Loss: 98.006 Vali Loss: 736.095 Vali Acc: 0.243 Test Loss: 736.095 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.75844931602478
Epoch: 15, Steps: 17 | Train Loss: 78.084 Vali Loss: 945.817 Vali Acc: 0.293 Test Loss: 945.817 Test Acc: 0.293
Validation loss decreased (-0.267295 --> -0.283317).  Saving model ...
Epoch: 16 cost time: 4.72546124458313
Epoch: 16, Steps: 17 | Train Loss: 53.014 Vali Loss: 1018.173 Vali Acc: 0.217 Test Loss: 1018.173 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.35062050819397
Epoch: 17, Steps: 17 | Train Loss: 65.024 Vali Loss: 1100.558 Vali Acc: 0.259 Test Loss: 1100.558 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.644282579421997
Epoch: 18, Steps: 17 | Train Loss: 71.036 Vali Loss: 1399.564 Vali Acc: 0.221 Test Loss: 1399.564 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.5336103439331055
Epoch: 19, Steps: 17 | Train Loss: 51.647 Vali Loss: 1567.182 Vali Acc: 0.202 Test Loss: 1567.182 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.724589109420776
Epoch: 20, Steps: 17 | Train Loss: 46.652 Vali Loss: 1584.807 Vali Acc: 0.259 Test Loss: 1584.807 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.591241359710693
Epoch: 21, Steps: 17 | Train Loss: 66.144 Vali Loss: 1708.652 Vali Acc: 0.259 Test Loss: 1708.652 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.279900312423706
Epoch: 22, Steps: 17 | Train Loss: 44.444 Vali Loss: 2148.275 Vali Acc: 0.259 Test Loss: 2148.275 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.904340028762817
Epoch: 23, Steps: 17 | Train Loss: 59.382 Vali Loss: 2219.426 Vali Acc: 0.247 Test Loss: 2219.426 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.100564241409302
Epoch: 24, Steps: 17 | Train Loss: 57.107 Vali Loss: 2192.644 Vali Acc: 0.240 Test Loss: 2192.644 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.662805080413818
Epoch: 25, Steps: 17 | Train Loss: 24.222 Vali Loss: 2187.920 Vali Acc: 0.247 Test Loss: 2187.920 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 5172768
model size : 29.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.142649173736572
Epoch: 1, Steps: 17 | Train Loss: 53.757 Vali Loss: 168.107 Vali Acc: 0.262 Test Loss: 168.107 Test Acc: 0.262
Validation loss decreased (inf --> -0.260676).  Saving model ...
Epoch: 2 cost time: 4.1452250480651855
Epoch: 2, Steps: 17 | Train Loss: 98.760 Vali Loss: 118.141 Vali Acc: 0.266 Test Loss: 118.141 Test Acc: 0.266
Validation loss decreased (-0.260676 --> -0.264978).  Saving model ...
Epoch: 3 cost time: 4.525473356246948
Epoch: 3, Steps: 17 | Train Loss: 186.438 Vali Loss: 356.071 Vali Acc: 0.251 Test Loss: 356.071 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.299379825592041
Epoch: 4, Steps: 17 | Train Loss: 155.380 Vali Loss: 112.628 Vali Acc: 0.274 Test Loss: 112.628 Test Acc: 0.274
Validation loss decreased (-0.264978 --> -0.272638).  Saving model ...
Epoch: 5 cost time: 3.664700984954834
Epoch: 5, Steps: 17 | Train Loss: 94.931 Vali Loss: 149.245 Vali Acc: 0.240 Test Loss: 149.245 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5285446643829346
Epoch: 6, Steps: 17 | Train Loss: 140.557 Vali Loss: 193.975 Vali Acc: 0.259 Test Loss: 193.975 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2829911708831787
Epoch: 7, Steps: 17 | Train Loss: 168.332 Vali Loss: 164.297 Vali Acc: 0.251 Test Loss: 164.297 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.6383743286132812
Epoch: 8, Steps: 17 | Train Loss: 108.096 Vali Loss: 210.062 Vali Acc: 0.289 Test Loss: 210.062 Test Acc: 0.289
Validation loss decreased (-0.272638 --> -0.286873).  Saving model ...
Epoch: 9 cost time: 4.526647567749023
Epoch: 9, Steps: 17 | Train Loss: 61.893 Vali Loss: 221.597 Vali Acc: 0.278 Test Loss: 221.597 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.155364751815796
Epoch: 10, Steps: 17 | Train Loss: 116.010 Vali Loss: 464.115 Vali Acc: 0.266 Test Loss: 464.115 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.25081205368042
Epoch: 11, Steps: 17 | Train Loss: 129.721 Vali Loss: 469.556 Vali Acc: 0.281 Test Loss: 469.556 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.410398006439209
Epoch: 12, Steps: 17 | Train Loss: 96.579 Vali Loss: 508.751 Vali Acc: 0.312 Test Loss: 508.751 Test Acc: 0.312
Validation loss decreased (-0.286873 --> -0.306700).  Saving model ...
Epoch: 13 cost time: 3.794847249984741
Epoch: 13, Steps: 17 | Train Loss: 80.257 Vali Loss: 791.468 Vali Acc: 0.247 Test Loss: 791.468 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.487131357192993
Epoch: 14, Steps: 17 | Train Loss: 71.477 Vali Loss: 929.724 Vali Acc: 0.255 Test Loss: 929.724 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.2639546394348145
Epoch: 15, Steps: 17 | Train Loss: 177.360 Vali Loss: 1066.796 Vali Acc: 0.255 Test Loss: 1066.796 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.439192533493042
Epoch: 16, Steps: 17 | Train Loss: 87.440 Vali Loss: 1197.503 Vali Acc: 0.255 Test Loss: 1197.503 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.7853827476501465
Epoch: 17, Steps: 17 | Train Loss: 109.202 Vali Loss: 1338.779 Vali Acc: 0.243 Test Loss: 1338.779 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.2276177406311035
Epoch: 18, Steps: 17 | Train Loss: 120.518 Vali Loss: 1417.410 Vali Acc: 0.270 Test Loss: 1417.410 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.540398359298706
Epoch: 19, Steps: 17 | Train Loss: 69.398 Vali Loss: 1427.076 Vali Acc: 0.259 Test Loss: 1427.076 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.249059438705444
Epoch: 20, Steps: 17 | Train Loss: 30.542 Vali Loss: 1479.771 Vali Acc: 0.270 Test Loss: 1479.771 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.565022706985474
Epoch: 21, Steps: 17 | Train Loss: 45.652 Vali Loss: 1865.013 Vali Acc: 0.221 Test Loss: 1865.013 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.482012510299683
Epoch: 22, Steps: 17 | Train Loss: 61.670 Vali Loss: 2077.240 Vali Acc: 0.236 Test Loss: 2077.240 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 5172768
model size : 29.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.734471559524536
Epoch: 1, Steps: 17 | Train Loss: 55.180 Vali Loss: 79.996 Vali Acc: 0.255 Test Loss: 79.996 Test Acc: 0.255
Validation loss decreased (inf --> -0.253953).  Saving model ...
Epoch: 2 cost time: 3.8198354244232178
Epoch: 2, Steps: 17 | Train Loss: 96.365 Vali Loss: 61.589 Vali Acc: 0.243 Test Loss: 61.589 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.189074754714966
Epoch: 3, Steps: 17 | Train Loss: 101.168 Vali Loss: 119.290 Vali Acc: 0.236 Test Loss: 119.290 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8963425159454346
Epoch: 4, Steps: 17 | Train Loss: 110.406 Vali Loss: 115.067 Vali Acc: 0.255 Test Loss: 115.067 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.554615259170532
Epoch: 5, Steps: 17 | Train Loss: 134.077 Vali Loss: 173.161 Vali Acc: 0.251 Test Loss: 173.161 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.135556221008301
Epoch: 6, Steps: 17 | Train Loss: 175.666 Vali Loss: 282.385 Vali Acc: 0.224 Test Loss: 282.385 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.220571756362915
Epoch: 7, Steps: 17 | Train Loss: 215.693 Vali Loss: 190.923 Vali Acc: 0.236 Test Loss: 190.923 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.364511013031006
Epoch: 8, Steps: 17 | Train Loss: 77.147 Vali Loss: 255.582 Vali Acc: 0.236 Test Loss: 255.582 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.603381633758545
Epoch: 9, Steps: 17 | Train Loss: 117.538 Vali Loss: 432.914 Vali Acc: 0.270 Test Loss: 432.914 Test Acc: 0.270
Validation loss decreased (-0.253953 --> -0.265633).  Saving model ...
Epoch: 10 cost time: 4.543455123901367
Epoch: 10, Steps: 17 | Train Loss: 84.924 Vali Loss: 574.337 Vali Acc: 0.228 Test Loss: 574.337 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.143573999404907
Epoch: 11, Steps: 17 | Train Loss: 121.643 Vali Loss: 492.200 Vali Acc: 0.259 Test Loss: 492.200 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.529419660568237
Epoch: 12, Steps: 17 | Train Loss: 141.028 Vali Loss: 678.807 Vali Acc: 0.281 Test Loss: 678.807 Test Acc: 0.281
Validation loss decreased (-0.265633 --> -0.274581).  Saving model ...
Epoch: 13 cost time: 3.1641483306884766
Epoch: 13, Steps: 17 | Train Loss: 49.141 Vali Loss: 832.422 Vali Acc: 0.247 Test Loss: 832.422 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1909103393554688
Epoch: 14, Steps: 17 | Train Loss: 72.933 Vali Loss: 925.567 Vali Acc: 0.262 Test Loss: 925.567 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.017072677612305
Epoch: 15, Steps: 17 | Train Loss: 43.014 Vali Loss: 937.718 Vali Acc: 0.232 Test Loss: 937.718 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.15120005607605
Epoch: 16, Steps: 17 | Train Loss: 72.400 Vali Loss: 1070.077 Vali Acc: 0.259 Test Loss: 1070.077 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.7312300205230713
Epoch: 17, Steps: 17 | Train Loss: 38.880 Vali Loss: 1396.037 Vali Acc: 0.213 Test Loss: 1396.037 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.0862486362457275
Epoch: 18, Steps: 17 | Train Loss: 37.810 Vali Loss: 1545.353 Vali Acc: 0.232 Test Loss: 1545.353 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.9482522010803223
Epoch: 19, Steps: 17 | Train Loss: 35.135 Vali Loss: 1575.532 Vali Acc: 0.247 Test Loss: 1575.532 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.312640905380249
Epoch: 20, Steps: 17 | Train Loss: 45.707 Vali Loss: 1677.659 Vali Acc: 0.240 Test Loss: 1677.659 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.970168352127075
Epoch: 21, Steps: 17 | Train Loss: 31.631 Vali Loss: 1893.028 Vali Acc: 0.209 Test Loss: 1893.028 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.036081314086914
Epoch: 22, Steps: 17 | Train Loss: 28.399 Vali Loss: 2135.900 Vali Acc: 0.221 Test Loss: 2135.900 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 5172768
model size : 29.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.17971658706665
Epoch: 1, Steps: 17 | Train Loss: 71.654 Vali Loss: 130.402 Vali Acc: 0.262 Test Loss: 130.402 Test Acc: 0.262
Validation loss decreased (inf --> -0.261053).  Saving model ...
Epoch: 2 cost time: 3.5408949851989746
Epoch: 2, Steps: 17 | Train Loss: 129.616 Vali Loss: 89.550 Vali Acc: 0.224 Test Loss: 89.550 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2446353435516357
Epoch: 3, Steps: 17 | Train Loss: 112.796 Vali Loss: 61.486 Vali Acc: 0.266 Test Loss: 61.486 Test Acc: 0.266
Validation loss decreased (-0.261053 --> -0.265545).  Saving model ...
Epoch: 4 cost time: 3.605259656906128
Epoch: 4, Steps: 17 | Train Loss: 74.675 Vali Loss: 162.617 Vali Acc: 0.251 Test Loss: 162.617 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.877145290374756
Epoch: 5, Steps: 17 | Train Loss: 148.510 Vali Loss: 223.412 Vali Acc: 0.247 Test Loss: 223.412 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.3180418014526367
Epoch: 6, Steps: 17 | Train Loss: 102.369 Vali Loss: 125.998 Vali Acc: 0.281 Test Loss: 125.998 Test Acc: 0.281
Validation loss decreased (-0.265545 --> -0.280109).  Saving model ...
Epoch: 7 cost time: 3.2548091411590576
Epoch: 7, Steps: 17 | Train Loss: 73.776 Vali Loss: 315.314 Vali Acc: 0.270 Test Loss: 315.314 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.537891149520874
Epoch: 8, Steps: 17 | Train Loss: 149.649 Vali Loss: 304.062 Vali Acc: 0.232 Test Loss: 304.062 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.573272705078125
Epoch: 9, Steps: 17 | Train Loss: 89.228 Vali Loss: 305.955 Vali Acc: 0.240 Test Loss: 305.955 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.609490394592285
Epoch: 10, Steps: 17 | Train Loss: 121.435 Vali Loss: 459.485 Vali Acc: 0.262 Test Loss: 459.485 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.7109251022338867
Epoch: 11, Steps: 17 | Train Loss: 115.649 Vali Loss: 616.319 Vali Acc: 0.293 Test Loss: 616.319 Test Acc: 0.293
Validation loss decreased (-0.280109 --> -0.286612).  Saving model ...
Epoch: 12 cost time: 3.81978702545166
Epoch: 12, Steps: 17 | Train Loss: 55.827 Vali Loss: 628.384 Vali Acc: 0.285 Test Loss: 628.384 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5160179138183594
Epoch: 13, Steps: 17 | Train Loss: 76.630 Vali Loss: 882.002 Vali Acc: 0.278 Test Loss: 882.002 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.5302011966705322
Epoch: 14, Steps: 17 | Train Loss: 99.996 Vali Loss: 962.516 Vali Acc: 0.240 Test Loss: 962.516 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.572108745574951
Epoch: 15, Steps: 17 | Train Loss: 70.838 Vali Loss: 1038.622 Vali Acc: 0.281 Test Loss: 1038.622 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.334918975830078
Epoch: 16, Steps: 17 | Train Loss: 32.319 Vali Loss: 1020.054 Vali Acc: 0.240 Test Loss: 1020.054 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.062134265899658
Epoch: 17, Steps: 17 | Train Loss: 44.029 Vali Loss: 1243.140 Vali Acc: 0.243 Test Loss: 1243.140 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.2125022411346436
Epoch: 18, Steps: 17 | Train Loss: 20.496 Vali Loss: 1328.984 Vali Acc: 0.221 Test Loss: 1328.984 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.2959229946136475
Epoch: 19, Steps: 17 | Train Loss: 95.798 Vali Loss: 1775.554 Vali Acc: 0.255 Test Loss: 1775.554 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.383294105529785
Epoch: 20, Steps: 17 | Train Loss: 46.695 Vali Loss: 1559.222 Vali Acc: 0.243 Test Loss: 1559.222 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.5006730556488037
Epoch: 21, Steps: 17 | Train Loss: 114.112 Vali Loss: 1773.649 Vali Acc: 0.232 Test Loss: 1773.649 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 5172768
model size : 29.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.504726886749268
Epoch: 1, Steps: 17 | Train Loss: 48.886 Vali Loss: 57.638 Vali Acc: 0.236 Test Loss: 57.638 Test Acc: 0.236
Validation loss decreased (inf --> -0.235165).  Saving model ...
Epoch: 2 cost time: 3.368326425552368
Epoch: 2, Steps: 17 | Train Loss: 117.297 Vali Loss: 86.538 Vali Acc: 0.236 Test Loss: 86.538 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.2936835289001465
Epoch: 3, Steps: 17 | Train Loss: 106.986 Vali Loss: 159.800 Vali Acc: 0.236 Test Loss: 159.800 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8407039642333984
Epoch: 4, Steps: 17 | Train Loss: 94.168 Vali Loss: 84.943 Vali Acc: 0.259 Test Loss: 84.943 Test Acc: 0.259
Validation loss decreased (-0.235165 --> -0.257706).  Saving model ...
Epoch: 5 cost time: 3.772489309310913
Epoch: 5, Steps: 17 | Train Loss: 112.176 Vali Loss: 128.298 Vali Acc: 0.221 Test Loss: 128.298 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9866580963134766
Epoch: 6, Steps: 17 | Train Loss: 153.297 Vali Loss: 197.827 Vali Acc: 0.240 Test Loss: 197.827 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1696696281433105
Epoch: 7, Steps: 17 | Train Loss: 137.041 Vali Loss: 264.963 Vali Acc: 0.247 Test Loss: 264.963 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0858311653137207
Epoch: 8, Steps: 17 | Train Loss: 95.958 Vali Loss: 335.349 Vali Acc: 0.240 Test Loss: 335.349 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.8942532539367676
Epoch: 9, Steps: 17 | Train Loss: 110.656 Vali Loss: 601.778 Vali Acc: 0.251 Test Loss: 601.778 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.815972328186035
Epoch: 10, Steps: 17 | Train Loss: 121.448 Vali Loss: 532.674 Vali Acc: 0.251 Test Loss: 532.674 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.777369260787964
Epoch: 11, Steps: 17 | Train Loss: 122.269 Vali Loss: 608.238 Vali Acc: 0.247 Test Loss: 608.238 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.6995437145233154
Epoch: 12, Steps: 17 | Train Loss: 80.688 Vali Loss: 547.731 Vali Acc: 0.232 Test Loss: 547.731 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.167675256729126
Epoch: 13, Steps: 17 | Train Loss: 100.663 Vali Loss: 763.462 Vali Acc: 0.281 Test Loss: 763.462 Test Acc: 0.281
Validation loss decreased (-0.257706 --> -0.273734).  Saving model ...
Epoch: 14 cost time: 4.5592451095581055
Epoch: 14, Steps: 17 | Train Loss: 59.045 Vali Loss: 707.574 Vali Acc: 0.270 Test Loss: 707.574 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.3004724979400635
Epoch: 15, Steps: 17 | Train Loss: 38.450 Vali Loss: 722.521 Vali Acc: 0.270 Test Loss: 722.521 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.455477237701416
Epoch: 16, Steps: 17 | Train Loss: 61.951 Vali Loss: 842.225 Vali Acc: 0.270 Test Loss: 842.225 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.7542078495025635
Epoch: 17, Steps: 17 | Train Loss: 25.851 Vali Loss: 952.575 Vali Acc: 0.247 Test Loss: 952.575 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.7021284103393555
Epoch: 18, Steps: 17 | Train Loss: 41.827 Vali Loss: 1167.283 Vali Acc: 0.213 Test Loss: 1167.283 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.035727262496948
Epoch: 19, Steps: 17 | Train Loss: 96.092 Vali Loss: 1415.689 Vali Acc: 0.236 Test Loss: 1415.689 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.366023540496826
Epoch: 20, Steps: 17 | Train Loss: 24.979 Vali Loss: 1497.506 Vali Acc: 0.247 Test Loss: 1497.506 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.733437776565552
Epoch: 21, Steps: 17 | Train Loss: 86.098 Vali Loss: 1739.632 Vali Acc: 0.247 Test Loss: 1739.632 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.582559823989868
Epoch: 22, Steps: 17 | Train Loss: 73.437 Vali Loss: 1856.368 Vali Acc: 0.221 Test Loss: 1856.368 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.7183616161346436
Epoch: 23, Steps: 17 | Train Loss: 40.497 Vali Loss: 1946.388 Vali Acc: 0.270 Test Loss: 1946.388 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 4648480
model size : 27.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.716154336929321
Epoch: 1, Steps: 17 | Train Loss: 76.195 Vali Loss: 124.481 Vali Acc: 0.251 Test Loss: 124.481 Test Acc: 0.251
Validation loss decreased (inf --> -0.249706).  Saving model ...
Epoch: 2 cost time: 3.871112585067749
Epoch: 2, Steps: 17 | Train Loss: 101.289 Vali Loss: 117.103 Vali Acc: 0.240 Test Loss: 117.103 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.069085359573364
Epoch: 3, Steps: 17 | Train Loss: 129.156 Vali Loss: 185.157 Vali Acc: 0.266 Test Loss: 185.157 Test Acc: 0.266
Validation loss decreased (-0.249706 --> -0.264308).  Saving model ...
Epoch: 4 cost time: 4.317876100540161
Epoch: 4, Steps: 17 | Train Loss: 221.774 Vali Loss: 225.026 Vali Acc: 0.251 Test Loss: 225.026 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.391979455947876
Epoch: 5, Steps: 17 | Train Loss: 151.780 Vali Loss: 203.619 Vali Acc: 0.240 Test Loss: 203.619 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.693085193634033
Epoch: 6, Steps: 17 | Train Loss: 157.016 Vali Loss: 161.535 Vali Acc: 0.266 Test Loss: 161.535 Test Acc: 0.266
Validation loss decreased (-0.264308 --> -0.264544).  Saving model ...
Epoch: 7 cost time: 4.46541428565979
Epoch: 7, Steps: 17 | Train Loss: 96.581 Vali Loss: 253.735 Vali Acc: 0.262 Test Loss: 253.735 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.322979927062988
Epoch: 8, Steps: 17 | Train Loss: 102.249 Vali Loss: 301.920 Vali Acc: 0.278 Test Loss: 301.920 Test Acc: 0.278
Validation loss decreased (-0.264544 --> -0.274547).  Saving model ...
Epoch: 9 cost time: 4.112696647644043
Epoch: 9, Steps: 17 | Train Loss: 72.411 Vali Loss: 284.188 Vali Acc: 0.281 Test Loss: 284.188 Test Acc: 0.281
Validation loss decreased (-0.274547 --> -0.278527).  Saving model ...
Epoch: 10 cost time: 4.0490429401397705
Epoch: 10, Steps: 17 | Train Loss: 85.276 Vali Loss: 386.313 Vali Acc: 0.278 Test Loss: 386.313 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.641936540603638
Epoch: 11, Steps: 17 | Train Loss: 70.247 Vali Loss: 532.067 Vali Acc: 0.255 Test Loss: 532.067 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.203205347061157
Epoch: 12, Steps: 17 | Train Loss: 87.043 Vali Loss: 669.571 Vali Acc: 0.262 Test Loss: 669.571 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.169068336486816
Epoch: 13, Steps: 17 | Train Loss: 109.459 Vali Loss: 998.884 Vali Acc: 0.247 Test Loss: 998.884 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.036636114120483
Epoch: 14, Steps: 17 | Train Loss: 108.679 Vali Loss: 767.368 Vali Acc: 0.251 Test Loss: 767.368 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.085796356201172
Epoch: 15, Steps: 17 | Train Loss: 102.514 Vali Loss: 886.358 Vali Acc: 0.247 Test Loss: 886.358 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.527217626571655
Epoch: 16, Steps: 17 | Train Loss: 65.009 Vali Loss: 975.441 Vali Acc: 0.255 Test Loss: 975.441 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.219451189041138
Epoch: 17, Steps: 17 | Train Loss: 62.765 Vali Loss: 1116.312 Vali Acc: 0.243 Test Loss: 1116.312 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.287081718444824
Epoch: 18, Steps: 17 | Train Loss: 39.476 Vali Loss: 1337.067 Vali Acc: 0.240 Test Loss: 1337.067 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.433432340621948
Epoch: 19, Steps: 17 | Train Loss: 43.612 Vali Loss: 1712.473 Vali Acc: 0.270 Test Loss: 1712.473 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 4648480
model size : 27.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.823501348495483
Epoch: 1, Steps: 17 | Train Loss: 68.964 Vali Loss: 218.073 Vali Acc: 0.247 Test Loss: 218.073 Test Acc: 0.247
Validation loss decreased (inf --> -0.244968).  Saving model ...
Epoch: 2 cost time: 4.116663694381714
Epoch: 2, Steps: 17 | Train Loss: 172.914 Vali Loss: 214.371 Vali Acc: 0.236 Test Loss: 214.371 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.150160789489746
Epoch: 3, Steps: 17 | Train Loss: 109.165 Vali Loss: 93.367 Vali Acc: 0.285 Test Loss: 93.367 Test Acc: 0.285
Validation loss decreased (-0.244968 --> -0.284237).  Saving model ...
Epoch: 4 cost time: 4.262772798538208
Epoch: 4, Steps: 17 | Train Loss: 99.228 Vali Loss: 207.635 Vali Acc: 0.259 Test Loss: 207.635 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9443552494049072
Epoch: 5, Steps: 17 | Train Loss: 173.280 Vali Loss: 261.908 Vali Acc: 0.259 Test Loss: 261.908 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9858598709106445
Epoch: 6, Steps: 17 | Train Loss: 269.880 Vali Loss: 253.915 Vali Acc: 0.236 Test Loss: 253.915 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.9884026050567627
Epoch: 7, Steps: 17 | Train Loss: 121.078 Vali Loss: 247.404 Vali Acc: 0.262 Test Loss: 247.404 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.160525321960449
Epoch: 8, Steps: 17 | Train Loss: 124.483 Vali Loss: 410.251 Vali Acc: 0.281 Test Loss: 410.251 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.5845208168029785
Epoch: 9, Steps: 17 | Train Loss: 171.622 Vali Loss: 426.981 Vali Acc: 0.278 Test Loss: 426.981 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.7587661743164062
Epoch: 10, Steps: 17 | Train Loss: 106.000 Vali Loss: 627.033 Vali Acc: 0.262 Test Loss: 627.033 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.245483875274658
Epoch: 11, Steps: 17 | Train Loss: 98.714 Vali Loss: 785.122 Vali Acc: 0.285 Test Loss: 785.122 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.8118338584899902
Epoch: 12, Steps: 17 | Train Loss: 189.805 Vali Loss: 1116.495 Vali Acc: 0.266 Test Loss: 1116.495 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.139888048171997
Epoch: 13, Steps: 17 | Train Loss: 95.474 Vali Loss: 910.917 Vali Acc: 0.319 Test Loss: 910.917 Test Acc: 0.319
Validation loss decreased (-0.284237 --> -0.310282).  Saving model ...
Epoch: 14 cost time: 3.5879688262939453
Epoch: 14, Steps: 17 | Train Loss: 52.107 Vali Loss: 908.732 Vali Acc: 0.278 Test Loss: 908.732 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.063641786575317
Epoch: 15, Steps: 17 | Train Loss: 56.852 Vali Loss: 1082.681 Vali Acc: 0.259 Test Loss: 1082.681 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.91060471534729
Epoch: 16, Steps: 17 | Train Loss: 75.713 Vali Loss: 1272.906 Vali Acc: 0.274 Test Loss: 1272.906 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.9937968254089355
Epoch: 17, Steps: 17 | Train Loss: 81.522 Vali Loss: 1323.692 Vali Acc: 0.259 Test Loss: 1323.692 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.4929018020629883
Epoch: 18, Steps: 17 | Train Loss: 35.117 Vali Loss: 1532.944 Vali Acc: 0.247 Test Loss: 1532.944 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.798182249069214
Epoch: 19, Steps: 17 | Train Loss: 26.187 Vali Loss: 1660.853 Vali Acc: 0.259 Test Loss: 1660.853 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.6365416049957275
Epoch: 20, Steps: 17 | Train Loss: 32.453 Vali Loss: 1785.127 Vali Acc: 0.228 Test Loss: 1785.127 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.701587200164795
Epoch: 21, Steps: 17 | Train Loss: 79.725 Vali Loss: 1959.440 Vali Acc: 0.232 Test Loss: 1959.440 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.984807252883911
Epoch: 22, Steps: 17 | Train Loss: 115.842 Vali Loss: 2267.792 Vali Acc: 0.259 Test Loss: 2267.792 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.5429210662841797
Epoch: 23, Steps: 17 | Train Loss: 29.942 Vali Loss: 2555.708 Vali Acc: 0.266 Test Loss: 2555.708 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3193916349809886
model parameter : 4648480
model size : 27.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.113211393356323
Epoch: 1, Steps: 17 | Train Loss: 60.101 Vali Loss: 77.853 Vali Acc: 0.255 Test Loss: 77.853 Test Acc: 0.255
Validation loss decreased (inf --> -0.253974).  Saving model ...
Epoch: 2 cost time: 3.2935614585876465
Epoch: 2, Steps: 17 | Train Loss: 87.228 Vali Loss: 140.452 Vali Acc: 0.243 Test Loss: 140.452 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.668581247329712
Epoch: 3, Steps: 17 | Train Loss: 122.703 Vali Loss: 185.849 Vali Acc: 0.240 Test Loss: 185.849 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4196267127990723
Epoch: 4, Steps: 17 | Train Loss: 182.685 Vali Loss: 170.005 Vali Acc: 0.255 Test Loss: 170.005 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.3735079765319824
Epoch: 5, Steps: 17 | Train Loss: 126.065 Vali Loss: 182.771 Vali Acc: 0.259 Test Loss: 182.771 Test Acc: 0.259
Validation loss decreased (-0.253974 --> -0.256727).  Saving model ...
Epoch: 6 cost time: 3.3253018856048584
Epoch: 6, Steps: 17 | Train Loss: 118.982 Vali Loss: 447.041 Vali Acc: 0.251 Test Loss: 447.041 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.777165651321411
Epoch: 7, Steps: 17 | Train Loss: 146.533 Vali Loss: 262.425 Vali Acc: 0.243 Test Loss: 262.425 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3780856132507324
Epoch: 8, Steps: 17 | Train Loss: 62.758 Vali Loss: 415.631 Vali Acc: 0.232 Test Loss: 415.631 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.52472186088562
Epoch: 9, Steps: 17 | Train Loss: 123.598 Vali Loss: 416.070 Vali Acc: 0.236 Test Loss: 416.070 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.5115606784820557
Epoch: 10, Steps: 17 | Train Loss: 68.275 Vali Loss: 587.568 Vali Acc: 0.251 Test Loss: 587.568 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.545257329940796
Epoch: 11, Steps: 17 | Train Loss: 63.081 Vali Loss: 654.021 Vali Acc: 0.240 Test Loss: 654.021 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.3026225566864014
Epoch: 12, Steps: 17 | Train Loss: 75.775 Vali Loss: 664.419 Vali Acc: 0.240 Test Loss: 664.419 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.3236076831817627
Epoch: 13, Steps: 17 | Train Loss: 88.396 Vali Loss: 1016.337 Vali Acc: 0.247 Test Loss: 1016.337 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.3090121746063232
Epoch: 14, Steps: 17 | Train Loss: 36.056 Vali Loss: 935.672 Vali Acc: 0.255 Test Loss: 935.672 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.0972437858581543
Epoch: 15, Steps: 17 | Train Loss: 149.991 Vali Loss: 1321.021 Vali Acc: 0.243 Test Loss: 1321.021 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 4648480
model size : 27.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.086828708648682
Epoch: 1, Steps: 17 | Train Loss: 46.941 Vali Loss: 57.010 Vali Acc: 0.259 Test Loss: 57.010 Test Acc: 0.259
Validation loss decreased (inf --> -0.257985).  Saving model ...
Epoch: 2 cost time: 3.8702261447906494
Epoch: 2, Steps: 17 | Train Loss: 87.344 Vali Loss: 123.846 Vali Acc: 0.285 Test Loss: 123.846 Test Acc: 0.285
Validation loss decreased (-0.257985 --> -0.283933).  Saving model ...
Epoch: 3 cost time: 3.7877047061920166
Epoch: 3, Steps: 17 | Train Loss: 128.677 Vali Loss: 226.867 Vali Acc: 0.251 Test Loss: 226.867 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.189987897872925
Epoch: 4, Steps: 17 | Train Loss: 140.971 Vali Loss: 130.127 Vali Acc: 0.259 Test Loss: 130.127 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.292767286300659
Epoch: 5, Steps: 17 | Train Loss: 153.386 Vali Loss: 261.648 Vali Acc: 0.240 Test Loss: 261.648 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.9811344146728516
Epoch: 6, Steps: 17 | Train Loss: 309.344 Vali Loss: 576.292 Vali Acc: 0.259 Test Loss: 576.292 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.493821620941162
Epoch: 7, Steps: 17 | Train Loss: 162.882 Vali Loss: 272.582 Vali Acc: 0.240 Test Loss: 272.582 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.232985019683838
Epoch: 8, Steps: 17 | Train Loss: 126.350 Vali Loss: 409.252 Vali Acc: 0.259 Test Loss: 409.252 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.255457878112793
Epoch: 9, Steps: 17 | Train Loss: 152.264 Vali Loss: 526.434 Vali Acc: 0.281 Test Loss: 526.434 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.570629835128784
Epoch: 10, Steps: 17 | Train Loss: 141.267 Vali Loss: 592.422 Vali Acc: 0.232 Test Loss: 592.422 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.974870204925537
Epoch: 11, Steps: 17 | Train Loss: 129.595 Vali Loss: 662.754 Vali Acc: 0.274 Test Loss: 662.754 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.397430419921875
Epoch: 12, Steps: 17 | Train Loss: 134.573 Vali Loss: 846.868 Vali Acc: 0.266 Test Loss: 846.868 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 4386336
model size : 26.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.657502174377441
Epoch: 1, Steps: 17 | Train Loss: 37.223 Vali Loss: 107.457 Vali Acc: 0.247 Test Loss: 107.457 Test Acc: 0.247
Validation loss decreased (inf --> -0.246074).  Saving model ...
Epoch: 2 cost time: 4.259010076522827
Epoch: 2, Steps: 17 | Train Loss: 71.592 Vali Loss: 85.054 Vali Acc: 0.243 Test Loss: 85.054 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.162634611129761
Epoch: 3, Steps: 17 | Train Loss: 85.108 Vali Loss: 123.447 Vali Acc: 0.262 Test Loss: 123.447 Test Acc: 0.262
Validation loss decreased (-0.246074 --> -0.261123).  Saving model ...
Epoch: 4 cost time: 4.1829514503479
Epoch: 4, Steps: 17 | Train Loss: 131.691 Vali Loss: 174.625 Vali Acc: 0.243 Test Loss: 174.625 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.5120978355407715
Epoch: 5, Steps: 17 | Train Loss: 119.559 Vali Loss: 85.404 Vali Acc: 0.251 Test Loss: 85.404 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.13528037071228
Epoch: 6, Steps: 17 | Train Loss: 99.929 Vali Loss: 299.526 Vali Acc: 0.247 Test Loss: 299.526 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.051330089569092
Epoch: 7, Steps: 17 | Train Loss: 137.985 Vali Loss: 130.783 Vali Acc: 0.262 Test Loss: 130.783 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.8721818923950195
Epoch: 8, Steps: 17 | Train Loss: 107.938 Vali Loss: 580.737 Vali Acc: 0.255 Test Loss: 580.737 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.539493799209595
Epoch: 9, Steps: 17 | Train Loss: 122.452 Vali Loss: 541.922 Vali Acc: 0.243 Test Loss: 541.922 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.2956836223602295
Epoch: 10, Steps: 17 | Train Loss: 263.904 Vali Loss: 608.878 Vali Acc: 0.251 Test Loss: 608.878 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.210718631744385
Epoch: 11, Steps: 17 | Train Loss: 89.665 Vali Loss: 585.124 Vali Acc: 0.300 Test Loss: 585.124 Test Acc: 0.300
Validation loss decreased (-0.261123 --> -0.294529).  Saving model ...
Epoch: 12 cost time: 3.826639413833618
Epoch: 12, Steps: 17 | Train Loss: 60.373 Vali Loss: 593.757 Vali Acc: 0.331 Test Loss: 593.757 Test Acc: 0.331
Validation loss decreased (-0.294529 --> -0.324861).  Saving model ...
Epoch: 13 cost time: 4.015077590942383
Epoch: 13, Steps: 17 | Train Loss: 59.621 Vali Loss: 648.401 Vali Acc: 0.289 Test Loss: 648.401 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.195836782455444
Epoch: 14, Steps: 17 | Train Loss: 42.281 Vali Loss: 703.180 Vali Acc: 0.259 Test Loss: 703.180 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.211501836776733
Epoch: 15, Steps: 17 | Train Loss: 21.542 Vali Loss: 795.102 Vali Acc: 0.247 Test Loss: 795.102 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.1216630935668945
Epoch: 16, Steps: 17 | Train Loss: 40.331 Vali Loss: 1087.144 Vali Acc: 0.259 Test Loss: 1087.144 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.040400981903076
Epoch: 17, Steps: 17 | Train Loss: 30.539 Vali Loss: 1221.691 Vali Acc: 0.259 Test Loss: 1221.691 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.2413575649261475
Epoch: 18, Steps: 17 | Train Loss: 30.388 Vali Loss: 1235.404 Vali Acc: 0.217 Test Loss: 1235.404 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.339423418045044
Epoch: 19, Steps: 17 | Train Loss: 35.041 Vali Loss: 1368.674 Vali Acc: 0.236 Test Loss: 1368.674 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.191553354263306
Epoch: 20, Steps: 17 | Train Loss: 38.879 Vali Loss: 1641.604 Vali Acc: 0.251 Test Loss: 1641.604 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.261735916137695
Epoch: 21, Steps: 17 | Train Loss: 35.569 Vali Loss: 1726.568 Vali Acc: 0.255 Test Loss: 1726.568 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.292043447494507
Epoch: 22, Steps: 17 | Train Loss: 140.769 Vali Loss: 2025.127 Vali Acc: 0.243 Test Loss: 2025.127 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33079847908745247
model parameter : 4386336
model size : 26.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.7000744342803955
Epoch: 1, Steps: 17 | Train Loss: 56.522 Vali Loss: 124.813 Vali Acc: 0.251 Test Loss: 124.813 Test Acc: 0.251
Validation loss decreased (inf --> -0.249702).  Saving model ...
Epoch: 2 cost time: 3.934335947036743
Epoch: 2, Steps: 17 | Train Loss: 130.982 Vali Loss: 252.015 Vali Acc: 0.251 Test Loss: 252.015 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.565915584564209
Epoch: 3, Steps: 17 | Train Loss: 190.289 Vali Loss: 209.272 Vali Acc: 0.236 Test Loss: 209.272 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8422582149505615
Epoch: 4, Steps: 17 | Train Loss: 105.207 Vali Loss: 86.823 Vali Acc: 0.278 Test Loss: 86.823 Test Acc: 0.278
Validation loss decreased (-0.249702 --> -0.276698).  Saving model ...
Epoch: 5 cost time: 4.522799730300903
Epoch: 5, Steps: 17 | Train Loss: 157.683 Vali Loss: 104.603 Vali Acc: 0.259 Test Loss: 104.603 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.418557167053223
Epoch: 6, Steps: 17 | Train Loss: 130.864 Vali Loss: 170.382 Vali Acc: 0.251 Test Loss: 170.382 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.302266359329224
Epoch: 7, Steps: 17 | Train Loss: 100.935 Vali Loss: 291.873 Vali Acc: 0.281 Test Loss: 291.873 Test Acc: 0.281
Validation loss decreased (-0.276698 --> -0.278450).  Saving model ...
Epoch: 8 cost time: 4.258599758148193
Epoch: 8, Steps: 17 | Train Loss: 164.105 Vali Loss: 346.140 Vali Acc: 0.224 Test Loss: 346.140 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.4706504344940186
Epoch: 9, Steps: 17 | Train Loss: 125.598 Vali Loss: 416.002 Vali Acc: 0.251 Test Loss: 416.002 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7587950229644775
Epoch: 10, Steps: 17 | Train Loss: 85.575 Vali Loss: 408.084 Vali Acc: 0.236 Test Loss: 408.084 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.267492055892944
Epoch: 11, Steps: 17 | Train Loss: 51.546 Vali Loss: 508.216 Vali Acc: 0.281 Test Loss: 508.216 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.463591575622559
Epoch: 12, Steps: 17 | Train Loss: 42.572 Vali Loss: 607.695 Vali Acc: 0.247 Test Loss: 607.695 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.778500556945801
Epoch: 13, Steps: 17 | Train Loss: 144.363 Vali Loss: 773.526 Vali Acc: 0.240 Test Loss: 773.526 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.522512435913086
Epoch: 14, Steps: 17 | Train Loss: 36.919 Vali Loss: 766.791 Vali Acc: 0.224 Test Loss: 766.791 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.129545211791992
Epoch: 15, Steps: 17 | Train Loss: 54.017 Vali Loss: 1015.204 Vali Acc: 0.243 Test Loss: 1015.204 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.202438592910767
Epoch: 16, Steps: 17 | Train Loss: 35.564 Vali Loss: 1050.917 Vali Acc: 0.217 Test Loss: 1050.917 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.662780284881592
Epoch: 17, Steps: 17 | Train Loss: 63.096 Vali Loss: 1249.282 Vali Acc: 0.255 Test Loss: 1249.282 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 4386336
model size : 26.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.190810680389404
Epoch: 1, Steps: 17 | Train Loss: 45.132 Vali Loss: 82.603 Vali Acc: 0.251 Test Loss: 82.603 Test Acc: 0.251
Validation loss decreased (inf --> -0.250125).  Saving model ...
Epoch: 2 cost time: 3.3820157051086426
Epoch: 2, Steps: 17 | Train Loss: 77.075 Vali Loss: 69.438 Vali Acc: 0.251 Test Loss: 69.438 Test Acc: 0.251
Validation loss decreased (-0.250125 --> -0.250256).  Saving model ...
Epoch: 3 cost time: 3.6336569786071777
Epoch: 3, Steps: 17 | Train Loss: 92.582 Vali Loss: 125.752 Vali Acc: 0.247 Test Loss: 125.752 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3566577434539795
Epoch: 4, Steps: 17 | Train Loss: 158.358 Vali Loss: 188.791 Vali Acc: 0.259 Test Loss: 188.791 Test Acc: 0.259
Validation loss decreased (-0.250256 --> -0.256667).  Saving model ...
Epoch: 5 cost time: 3.6619505882263184
Epoch: 5, Steps: 17 | Train Loss: 288.636 Vali Loss: 224.191 Vali Acc: 0.266 Test Loss: 224.191 Test Acc: 0.266
Validation loss decreased (-0.256667 --> -0.263918).  Saving model ...
Epoch: 6 cost time: 3.530052900314331
Epoch: 6, Steps: 17 | Train Loss: 153.995 Vali Loss: 282.161 Vali Acc: 0.247 Test Loss: 282.161 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.453131914138794
Epoch: 7, Steps: 17 | Train Loss: 123.031 Vali Loss: 314.822 Vali Acc: 0.266 Test Loss: 314.822 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.573172092437744
Epoch: 8, Steps: 17 | Train Loss: 86.417 Vali Loss: 258.001 Vali Acc: 0.266 Test Loss: 258.001 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.2749340534210205
Epoch: 9, Steps: 17 | Train Loss: 54.435 Vali Loss: 484.436 Vali Acc: 0.251 Test Loss: 484.436 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.167759656906128
Epoch: 10, Steps: 17 | Train Loss: 43.808 Vali Loss: 450.057 Vali Acc: 0.270 Test Loss: 450.057 Test Acc: 0.270
Validation loss decreased (-0.263918 --> -0.265461).  Saving model ...
Epoch: 11 cost time: 3.205766201019287
Epoch: 11, Steps: 17 | Train Loss: 67.384 Vali Loss: 473.032 Vali Acc: 0.228 Test Loss: 473.032 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4714653491973877
Epoch: 12, Steps: 17 | Train Loss: 50.894 Vali Loss: 482.851 Vali Acc: 0.251 Test Loss: 482.851 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.661358118057251
Epoch: 13, Steps: 17 | Train Loss: 59.753 Vali Loss: 616.445 Vali Acc: 0.259 Test Loss: 616.445 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.8537840843200684
Epoch: 14, Steps: 17 | Train Loss: 60.097 Vali Loss: 655.170 Vali Acc: 0.262 Test Loss: 655.170 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.7594761848449707
Epoch: 15, Steps: 17 | Train Loss: 46.248 Vali Loss: 843.444 Vali Acc: 0.213 Test Loss: 843.444 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.2502379417419434
Epoch: 16, Steps: 17 | Train Loss: 71.756 Vali Loss: 945.561 Vali Acc: 0.247 Test Loss: 945.561 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.589691162109375
Epoch: 17, Steps: 17 | Train Loss: 74.559 Vali Loss: 1277.405 Vali Acc: 0.270 Test Loss: 1277.405 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.478863477706909
Epoch: 18, Steps: 17 | Train Loss: 48.554 Vali Loss: 1350.247 Vali Acc: 0.266 Test Loss: 1350.247 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.430105447769165
Epoch: 19, Steps: 17 | Train Loss: 119.320 Vali Loss: 1608.774 Vali Acc: 0.247 Test Loss: 1608.774 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.57952880859375
Epoch: 20, Steps: 17 | Train Loss: 52.519 Vali Loss: 1665.705 Vali Acc: 0.240 Test Loss: 1665.705 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 4386336
model size : 26.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.109360694885254
Epoch: 1, Steps: 17 | Train Loss: 47.866 Vali Loss: 83.586 Vali Acc: 0.262 Test Loss: 83.586 Test Acc: 0.262
Validation loss decreased (inf --> -0.261522).  Saving model ...
Epoch: 2 cost time: 4.1942338943481445
Epoch: 2, Steps: 17 | Train Loss: 102.257 Vali Loss: 246.382 Vali Acc: 0.255 Test Loss: 246.382 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.093812942504883
Epoch: 3, Steps: 17 | Train Loss: 113.300 Vali Loss: 115.393 Vali Acc: 0.259 Test Loss: 115.393 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.334032297134399
Epoch: 4, Steps: 17 | Train Loss: 96.907 Vali Loss: 263.382 Vali Acc: 0.251 Test Loss: 263.382 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.136341094970703
Epoch: 5, Steps: 17 | Train Loss: 161.814 Vali Loss: 188.747 Vali Acc: 0.240 Test Loss: 188.747 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.051845550537109
Epoch: 6, Steps: 17 | Train Loss: 215.097 Vali Loss: 174.697 Vali Acc: 0.240 Test Loss: 174.697 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.930475473403931
Epoch: 7, Steps: 17 | Train Loss: 160.556 Vali Loss: 343.181 Vali Acc: 0.247 Test Loss: 343.181 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.0644190311431885
Epoch: 8, Steps: 17 | Train Loss: 119.970 Vali Loss: 367.695 Vali Acc: 0.293 Test Loss: 367.695 Test Acc: 0.293
Validation loss decreased (-0.261522 --> -0.289099).  Saving model ...
Epoch: 9 cost time: 5.001242160797119
Epoch: 9, Steps: 17 | Train Loss: 94.886 Vali Loss: 380.106 Vali Acc: 0.251 Test Loss: 380.106 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.8349010944366455
Epoch: 10, Steps: 17 | Train Loss: 86.713 Vali Loss: 486.008 Vali Acc: 0.247 Test Loss: 486.008 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.95437479019165
Epoch: 11, Steps: 17 | Train Loss: 84.767 Vali Loss: 662.248 Vali Acc: 0.255 Test Loss: 662.248 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.8131773471832275
Epoch: 12, Steps: 17 | Train Loss: 71.650 Vali Loss: 723.234 Vali Acc: 0.262 Test Loss: 723.234 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.8764402866363525
Epoch: 13, Steps: 17 | Train Loss: 75.921 Vali Loss: 714.065 Vali Acc: 0.262 Test Loss: 714.065 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.016614675521851
Epoch: 14, Steps: 17 | Train Loss: 81.515 Vali Loss: 810.813 Vali Acc: 0.251 Test Loss: 810.813 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.852802753448486
Epoch: 15, Steps: 17 | Train Loss: 42.075 Vali Loss: 1070.278 Vali Acc: 0.259 Test Loss: 1070.278 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.359405040740967
Epoch: 16, Steps: 17 | Train Loss: 100.728 Vali Loss: 1319.533 Vali Acc: 0.232 Test Loss: 1319.533 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.995723247528076
Epoch: 17, Steps: 17 | Train Loss: 112.907 Vali Loss: 1342.049 Vali Acc: 0.232 Test Loss: 1342.049 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.599117994308472
Epoch: 18, Steps: 17 | Train Loss: 46.816 Vali Loss: 1300.522 Vali Acc: 0.255 Test Loss: 1300.522 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 4255264
model size : 26.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.864092826843262
Epoch: 1, Steps: 17 | Train Loss: 36.096 Vali Loss: 105.196 Vali Acc: 0.251 Test Loss: 105.196 Test Acc: 0.251
Validation loss decreased (inf --> -0.249899).  Saving model ...
Epoch: 2 cost time: 4.194393634796143
Epoch: 2, Steps: 17 | Train Loss: 85.404 Vali Loss: 133.747 Vali Acc: 0.232 Test Loss: 133.747 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.141427755355835
Epoch: 3, Steps: 17 | Train Loss: 132.696 Vali Loss: 223.351 Vali Acc: 0.247 Test Loss: 223.351 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.266144752502441
Epoch: 4, Steps: 17 | Train Loss: 156.502 Vali Loss: 230.586 Vali Acc: 0.247 Test Loss: 230.586 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.916412115097046
Epoch: 5, Steps: 17 | Train Loss: 170.746 Vali Loss: 358.408 Vali Acc: 0.251 Test Loss: 358.408 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.9172463417053223
Epoch: 6, Steps: 17 | Train Loss: 188.204 Vali Loss: 163.874 Vali Acc: 0.274 Test Loss: 163.874 Test Acc: 0.274
Validation loss decreased (-0.249899 --> -0.272126).  Saving model ...
Epoch: 7 cost time: 4.1629064083099365
Epoch: 7, Steps: 17 | Train Loss: 103.631 Vali Loss: 554.367 Vali Acc: 0.262 Test Loss: 554.367 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.082536935806274
Epoch: 8, Steps: 17 | Train Loss: 180.913 Vali Loss: 517.221 Vali Acc: 0.247 Test Loss: 517.221 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.407330513000488
Epoch: 9, Steps: 17 | Train Loss: 222.913 Vali Loss: 395.099 Vali Acc: 0.266 Test Loss: 395.099 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.167808532714844
Epoch: 10, Steps: 17 | Train Loss: 101.368 Vali Loss: 541.249 Vali Acc: 0.247 Test Loss: 541.249 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.099536657333374
Epoch: 11, Steps: 17 | Train Loss: 89.432 Vali Loss: 517.935 Vali Acc: 0.213 Test Loss: 517.935 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.082722425460815
Epoch: 12, Steps: 17 | Train Loss: 48.394 Vali Loss: 575.815 Vali Acc: 0.228 Test Loss: 575.815 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.018112659454346
Epoch: 13, Steps: 17 | Train Loss: 81.411 Vali Loss: 809.728 Vali Acc: 0.243 Test Loss: 809.728 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.697664499282837
Epoch: 14, Steps: 17 | Train Loss: 117.012 Vali Loss: 1090.032 Vali Acc: 0.266 Test Loss: 1090.032 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.7519710063934326
Epoch: 15, Steps: 17 | Train Loss: 76.266 Vali Loss: 1006.931 Vali Acc: 0.266 Test Loss: 1006.931 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.8825857639312744
Epoch: 16, Steps: 17 | Train Loss: 66.856 Vali Loss: 1141.509 Vali Acc: 0.274 Test Loss: 1141.509 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 4255264
model size : 26.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.189449787139893
Epoch: 1, Steps: 17 | Train Loss: 47.176 Vali Loss: 120.797 Vali Acc: 0.243 Test Loss: 120.797 Test Acc: 0.243
Validation loss decreased (inf --> -0.242138).  Saving model ...
Epoch: 2 cost time: 3.496030569076538
Epoch: 2, Steps: 17 | Train Loss: 109.532 Vali Loss: 177.794 Vali Acc: 0.251 Test Loss: 177.794 Test Acc: 0.251
Validation loss decreased (-0.242138 --> -0.249173).  Saving model ...
Epoch: 3 cost time: 3.672860622406006
Epoch: 3, Steps: 17 | Train Loss: 128.668 Vali Loss: 114.933 Vali Acc: 0.255 Test Loss: 114.933 Test Acc: 0.255
Validation loss decreased (-0.249173 --> -0.253604).  Saving model ...
Epoch: 4 cost time: 3.635132074356079
Epoch: 4, Steps: 17 | Train Loss: 141.629 Vali Loss: 120.610 Vali Acc: 0.270 Test Loss: 120.610 Test Acc: 0.270
Validation loss decreased (-0.253604 --> -0.268756).  Saving model ...
Epoch: 5 cost time: 3.6154887676239014
Epoch: 5, Steps: 17 | Train Loss: 108.783 Vali Loss: 122.148 Vali Acc: 0.243 Test Loss: 122.148 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.521301031112671
Epoch: 6, Steps: 17 | Train Loss: 140.334 Vali Loss: 214.428 Vali Acc: 0.281 Test Loss: 214.428 Test Acc: 0.281
Validation loss decreased (-0.268756 --> -0.279225).  Saving model ...
Epoch: 7 cost time: 3.721565008163452
Epoch: 7, Steps: 17 | Train Loss: 103.843 Vali Loss: 297.650 Vali Acc: 0.259 Test Loss: 297.650 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.030188798904419
Epoch: 8, Steps: 17 | Train Loss: 185.312 Vali Loss: 341.556 Vali Acc: 0.278 Test Loss: 341.556 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8295140266418457
Epoch: 9, Steps: 17 | Train Loss: 93.380 Vali Loss: 242.776 Vali Acc: 0.255 Test Loss: 242.776 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.5043625831604004
Epoch: 10, Steps: 17 | Train Loss: 49.093 Vali Loss: 531.797 Vali Acc: 0.262 Test Loss: 531.797 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.910388231277466
Epoch: 11, Steps: 17 | Train Loss: 136.873 Vali Loss: 671.789 Vali Acc: 0.255 Test Loss: 671.789 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.6063826084136963
Epoch: 12, Steps: 17 | Train Loss: 167.078 Vali Loss: 925.830 Vali Acc: 0.281 Test Loss: 925.830 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.579425573348999
Epoch: 13, Steps: 17 | Train Loss: 196.716 Vali Loss: 1013.496 Vali Acc: 0.259 Test Loss: 1013.496 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.5384950637817383
Epoch: 14, Steps: 17 | Train Loss: 129.173 Vali Loss: 994.265 Vali Acc: 0.308 Test Loss: 994.265 Test Acc: 0.308
Validation loss decreased (-0.279225 --> -0.298042).  Saving model ...
Epoch: 15 cost time: 3.5273144245147705
Epoch: 15, Steps: 17 | Train Loss: 65.300 Vali Loss: 1392.244 Vali Acc: 0.274 Test Loss: 1392.244 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8912534713745117
Epoch: 16, Steps: 17 | Train Loss: 243.524 Vali Loss: 1273.879 Vali Acc: 0.281 Test Loss: 1273.879 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.462630271911621
Epoch: 17, Steps: 17 | Train Loss: 77.460 Vali Loss: 1303.572 Vali Acc: 0.247 Test Loss: 1303.572 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6655282974243164
Epoch: 18, Steps: 17 | Train Loss: 58.228 Vali Loss: 1402.207 Vali Acc: 0.255 Test Loss: 1402.207 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.543412685394287
Epoch: 19, Steps: 17 | Train Loss: 102.150 Vali Loss: 1428.126 Vali Acc: 0.251 Test Loss: 1428.126 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.721372604370117
Epoch: 20, Steps: 17 | Train Loss: 22.902 Vali Loss: 1607.234 Vali Acc: 0.240 Test Loss: 1607.234 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.3905413150787354
Epoch: 21, Steps: 17 | Train Loss: 49.113 Vali Loss: 1830.540 Vali Acc: 0.247 Test Loss: 1830.540 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.609365940093994
Epoch: 22, Steps: 17 | Train Loss: 29.202 Vali Loss: 1929.716 Vali Acc: 0.259 Test Loss: 1929.716 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.2782554626464844
Epoch: 23, Steps: 17 | Train Loss: 25.894 Vali Loss: 1981.484 Vali Acc: 0.262 Test Loss: 1981.484 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.7186484336853027
Epoch: 24, Steps: 17 | Train Loss: 20.288 Vali Loss: 2043.083 Vali Acc: 0.243 Test Loss: 2043.083 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 4255264
model size : 26.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.543787240982056
Epoch: 1, Steps: 17 | Train Loss: 45.480 Vali Loss: 108.431 Vali Acc: 0.243 Test Loss: 108.431 Test Acc: 0.243
Validation loss decreased (inf --> -0.242262).  Saving model ...
Epoch: 2 cost time: 2.6895341873168945
Epoch: 2, Steps: 17 | Train Loss: 88.400 Vali Loss: 81.673 Vali Acc: 0.259 Test Loss: 81.673 Test Acc: 0.259
Validation loss decreased (-0.242262 --> -0.257738).  Saving model ...
Epoch: 3 cost time: 3.485907793045044
Epoch: 3, Steps: 17 | Train Loss: 132.961 Vali Loss: 189.695 Vali Acc: 0.247 Test Loss: 189.695 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1195614337921143
Epoch: 4, Steps: 17 | Train Loss: 158.194 Vali Loss: 155.641 Vali Acc: 0.289 Test Loss: 155.641 Test Acc: 0.289
Validation loss decreased (-0.257738 --> -0.287417).  Saving model ...
Epoch: 5 cost time: 2.4969377517700195
Epoch: 5, Steps: 17 | Train Loss: 118.863 Vali Loss: 131.041 Vali Acc: 0.259 Test Loss: 131.041 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3679957389831543
Epoch: 6, Steps: 17 | Train Loss: 104.416 Vali Loss: 169.797 Vali Acc: 0.278 Test Loss: 169.797 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.757699728012085
Epoch: 7, Steps: 17 | Train Loss: 118.844 Vali Loss: 456.851 Vali Acc: 0.251 Test Loss: 456.851 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.991713523864746
Epoch: 8, Steps: 17 | Train Loss: 150.979 Vali Loss: 491.480 Vali Acc: 0.251 Test Loss: 491.480 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8660531044006348
Epoch: 9, Steps: 17 | Train Loss: 140.683 Vali Loss: 297.607 Vali Acc: 0.243 Test Loss: 297.607 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.97999906539917
Epoch: 10, Steps: 17 | Train Loss: 43.654 Vali Loss: 399.354 Vali Acc: 0.243 Test Loss: 399.354 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.491105556488037
Epoch: 11, Steps: 17 | Train Loss: 101.285 Vali Loss: 477.880 Vali Acc: 0.240 Test Loss: 477.880 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.519937038421631
Epoch: 12, Steps: 17 | Train Loss: 37.422 Vali Loss: 590.407 Vali Acc: 0.259 Test Loss: 590.407 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.6060104370117188
Epoch: 13, Steps: 17 | Train Loss: 52.413 Vali Loss: 875.045 Vali Acc: 0.243 Test Loss: 875.045 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.8869504928588867
Epoch: 14, Steps: 17 | Train Loss: 32.793 Vali Loss: 871.603 Vali Acc: 0.228 Test Loss: 871.603 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 4255264
model size : 26.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.871389627456665
Epoch: 1, Steps: 17 | Train Loss: 43.836 Vali Loss: 105.805 Vali Acc: 0.259 Test Loss: 105.805 Test Acc: 0.259
Validation loss decreased (inf --> -0.257497).  Saving model ...
Epoch: 2 cost time: 4.385481595993042
Epoch: 2, Steps: 17 | Train Loss: 101.301 Vali Loss: 161.494 Vali Acc: 0.262 Test Loss: 161.494 Test Acc: 0.262
Validation loss decreased (-0.257497 --> -0.260742).  Saving model ...
Epoch: 3 cost time: 4.211333751678467
Epoch: 3, Steps: 17 | Train Loss: 119.418 Vali Loss: 66.410 Vali Acc: 0.262 Test Loss: 66.410 Test Acc: 0.262
Validation loss decreased (-0.260742 --> -0.261693).  Saving model ...
Epoch: 4 cost time: 4.383622169494629
Epoch: 4, Steps: 17 | Train Loss: 116.751 Vali Loss: 212.712 Vali Acc: 0.262 Test Loss: 212.712 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.09501051902771
Epoch: 5, Steps: 17 | Train Loss: 129.145 Vali Loss: 135.648 Vali Acc: 0.266 Test Loss: 135.648 Test Acc: 0.266
Validation loss decreased (-0.261693 --> -0.264803).  Saving model ...
Epoch: 6 cost time: 4.092978000640869
Epoch: 6, Steps: 17 | Train Loss: 96.671 Vali Loss: 283.048 Vali Acc: 0.255 Test Loss: 283.048 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.417102575302124
Epoch: 7, Steps: 17 | Train Loss: 114.005 Vali Loss: 200.642 Vali Acc: 0.221 Test Loss: 200.642 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.476079225540161
Epoch: 8, Steps: 17 | Train Loss: 133.231 Vali Loss: 349.215 Vali Acc: 0.247 Test Loss: 349.215 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.385607481002808
Epoch: 9, Steps: 17 | Train Loss: 77.827 Vali Loss: 202.384 Vali Acc: 0.240 Test Loss: 202.384 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.1124982833862305
Epoch: 10, Steps: 17 | Train Loss: 83.855 Vali Loss: 231.374 Vali Acc: 0.236 Test Loss: 231.374 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.641171216964722
Epoch: 11, Steps: 17 | Train Loss: 56.296 Vali Loss: 349.276 Vali Acc: 0.285 Test Loss: 349.276 Test Acc: 0.285
Validation loss decreased (-0.264803 --> -0.281678).  Saving model ...
Epoch: 12 cost time: 4.365713119506836
Epoch: 12, Steps: 17 | Train Loss: 113.667 Vali Loss: 619.500 Vali Acc: 0.266 Test Loss: 619.500 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.369760036468506
Epoch: 13, Steps: 17 | Train Loss: 63.019 Vali Loss: 705.925 Vali Acc: 0.236 Test Loss: 705.925 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.51046895980835
Epoch: 14, Steps: 17 | Train Loss: 91.268 Vali Loss: 665.188 Vali Acc: 0.217 Test Loss: 665.188 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.718331575393677
Epoch: 15, Steps: 17 | Train Loss: 59.963 Vali Loss: 790.363 Vali Acc: 0.255 Test Loss: 790.363 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.785833358764648
Epoch: 16, Steps: 17 | Train Loss: 48.025 Vali Loss: 960.199 Vali Acc: 0.240 Test Loss: 960.199 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.469509601593018
Epoch: 17, Steps: 17 | Train Loss: 68.216 Vali Loss: 1035.583 Vali Acc: 0.221 Test Loss: 1035.583 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.572947263717651
Epoch: 18, Steps: 17 | Train Loss: 79.095 Vali Loss: 1229.422 Vali Acc: 0.255 Test Loss: 1229.422 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.2762205600738525
Epoch: 19, Steps: 17 | Train Loss: 100.171 Vali Loss: 1313.109 Vali Acc: 0.285 Test Loss: 1313.109 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.568601846694946
Epoch: 20, Steps: 17 | Train Loss: 105.970 Vali Loss: 1637.363 Vali Acc: 0.247 Test Loss: 1637.363 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.757245063781738
Epoch: 21, Steps: 17 | Train Loss: 138.464 Vali Loss: 1708.619 Vali Acc: 0.228 Test Loss: 1708.619 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 4189728
model size : 25.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.808771848678589
Epoch: 1, Steps: 17 | Train Loss: 37.947 Vali Loss: 107.795 Vali Acc: 0.251 Test Loss: 107.795 Test Acc: 0.251
Validation loss decreased (inf --> -0.249873).  Saving model ...
Epoch: 2 cost time: 3.9611520767211914
Epoch: 2, Steps: 17 | Train Loss: 119.214 Vali Loss: 223.390 Vali Acc: 0.247 Test Loss: 223.390 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.0436530113220215
Epoch: 3, Steps: 17 | Train Loss: 197.032 Vali Loss: 251.952 Vali Acc: 0.247 Test Loss: 251.952 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.36312198638916
Epoch: 4, Steps: 17 | Train Loss: 139.024 Vali Loss: 183.843 Vali Acc: 0.251 Test Loss: 183.843 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.29998517036438
Epoch: 5, Steps: 17 | Train Loss: 173.964 Vali Loss: 188.955 Vali Acc: 0.224 Test Loss: 188.955 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.100853204727173
Epoch: 6, Steps: 17 | Train Loss: 134.202 Vali Loss: 213.171 Vali Acc: 0.232 Test Loss: 213.171 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.5228238105773926
Epoch: 7, Steps: 17 | Train Loss: 118.047 Vali Loss: 205.913 Vali Acc: 0.247 Test Loss: 205.913 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.4662299156188965
Epoch: 8, Steps: 17 | Train Loss: 125.979 Vali Loss: 360.402 Vali Acc: 0.262 Test Loss: 360.402 Test Acc: 0.262
Validation loss decreased (-0.249873 --> -0.258753).  Saving model ...
Epoch: 9 cost time: 4.282064914703369
Epoch: 9, Steps: 17 | Train Loss: 98.162 Vali Loss: 296.293 Vali Acc: 0.278 Test Loss: 296.293 Test Acc: 0.278
Validation loss decreased (-0.258753 --> -0.274604).  Saving model ...
Epoch: 10 cost time: 4.413411855697632
Epoch: 10, Steps: 17 | Train Loss: 52.976 Vali Loss: 410.531 Vali Acc: 0.236 Test Loss: 410.531 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.4563634395599365
Epoch: 11, Steps: 17 | Train Loss: 99.496 Vali Loss: 365.200 Vali Acc: 0.262 Test Loss: 365.200 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.417435646057129
Epoch: 12, Steps: 17 | Train Loss: 64.303 Vali Loss: 742.651 Vali Acc: 0.270 Test Loss: 742.651 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.9634833335876465
Epoch: 13, Steps: 17 | Train Loss: 101.328 Vali Loss: 733.690 Vali Acc: 0.270 Test Loss: 733.690 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.51585054397583
Epoch: 14, Steps: 17 | Train Loss: 82.844 Vali Loss: 708.445 Vali Acc: 0.266 Test Loss: 708.445 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.149196624755859
Epoch: 15, Steps: 17 | Train Loss: 44.202 Vali Loss: 783.130 Vali Acc: 0.247 Test Loss: 783.130 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.046390533447266
Epoch: 16, Steps: 17 | Train Loss: 104.427 Vali Loss: 733.550 Vali Acc: 0.255 Test Loss: 733.550 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.390451431274414
Epoch: 17, Steps: 17 | Train Loss: 37.731 Vali Loss: 904.883 Vali Acc: 0.270 Test Loss: 904.883 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.346977233886719
Epoch: 18, Steps: 17 | Train Loss: 55.105 Vali Loss: 1008.429 Vali Acc: 0.293 Test Loss: 1008.429 Test Acc: 0.293
Validation loss decreased (-0.274604 --> -0.282691).  Saving model ...
Epoch: 19 cost time: 4.321343421936035
Epoch: 19, Steps: 17 | Train Loss: 55.824 Vali Loss: 1156.843 Vali Acc: 0.266 Test Loss: 1156.843 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.181273698806763
Epoch: 20, Steps: 17 | Train Loss: 11.296 Vali Loss: 1273.925 Vali Acc: 0.262 Test Loss: 1273.925 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.480025291442871
Epoch: 21, Steps: 17 | Train Loss: 40.818 Vali Loss: 1391.709 Vali Acc: 0.247 Test Loss: 1391.709 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.166520595550537
Epoch: 22, Steps: 17 | Train Loss: 12.721 Vali Loss: 1928.875 Vali Acc: 0.270 Test Loss: 1928.875 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.201801776885986
Epoch: 23, Steps: 17 | Train Loss: 57.179 Vali Loss: 2058.247 Vali Acc: 0.262 Test Loss: 2058.247 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.332803010940552
Epoch: 24, Steps: 17 | Train Loss: 47.901 Vali Loss: 2044.571 Vali Acc: 0.270 Test Loss: 2044.571 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.2564451694488525
Epoch: 25, Steps: 17 | Train Loss: 59.420 Vali Loss: 2232.580 Vali Acc: 0.274 Test Loss: 2232.580 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.107069492340088
Epoch: 26, Steps: 17 | Train Loss: 81.427 Vali Loss: 2697.227 Vali Acc: 0.278 Test Loss: 2697.227 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.056241512298584
Epoch: 27, Steps: 17 | Train Loss: 74.890 Vali Loss: 2392.746 Vali Acc: 0.266 Test Loss: 2392.746 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.104458808898926
Epoch: 28, Steps: 17 | Train Loss: 55.173 Vali Loss: 2490.602 Vali Acc: 0.278 Test Loss: 2490.602 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 4189728
model size : 25.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.952994346618652
Epoch: 1, Steps: 17 | Train Loss: 45.360 Vali Loss: 48.474 Vali Acc: 0.270 Test Loss: 48.474 Test Acc: 0.270
Validation loss decreased (inf --> -0.269477).  Saving model ...
Epoch: 2 cost time: 3.8549928665161133
Epoch: 2, Steps: 17 | Train Loss: 96.776 Vali Loss: 188.802 Vali Acc: 0.262 Test Loss: 188.802 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.185255527496338
Epoch: 3, Steps: 17 | Train Loss: 115.808 Vali Loss: 159.925 Vali Acc: 0.228 Test Loss: 159.925 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7039434909820557
Epoch: 4, Steps: 17 | Train Loss: 135.530 Vali Loss: 279.352 Vali Acc: 0.247 Test Loss: 279.352 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.7383220195770264
Epoch: 5, Steps: 17 | Train Loss: 127.836 Vali Loss: 265.184 Vali Acc: 0.247 Test Loss: 265.184 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.9523377418518066
Epoch: 6, Steps: 17 | Train Loss: 178.172 Vali Loss: 370.720 Vali Acc: 0.243 Test Loss: 370.720 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.119792699813843
Epoch: 7, Steps: 17 | Train Loss: 131.539 Vali Loss: 212.185 Vali Acc: 0.259 Test Loss: 212.185 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.202777147293091
Epoch: 8, Steps: 17 | Train Loss: 76.674 Vali Loss: 218.496 Vali Acc: 0.262 Test Loss: 218.496 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.894444704055786
Epoch: 9, Steps: 17 | Train Loss: 107.920 Vali Loss: 267.354 Vali Acc: 0.285 Test Loss: 267.354 Test Acc: 0.285
Validation loss decreased (-0.269477 --> -0.282498).  Saving model ...
Epoch: 10 cost time: 3.706223249435425
Epoch: 10, Steps: 17 | Train Loss: 76.029 Vali Loss: 305.140 Vali Acc: 0.270 Test Loss: 305.140 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.978907585144043
Epoch: 11, Steps: 17 | Train Loss: 58.981 Vali Loss: 347.898 Vali Acc: 0.251 Test Loss: 347.898 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.8722684383392334
Epoch: 12, Steps: 17 | Train Loss: 81.165 Vali Loss: 428.732 Vali Acc: 0.300 Test Loss: 428.732 Test Acc: 0.300
Validation loss decreased (-0.282498 --> -0.296093).  Saving model ...
Epoch: 13 cost time: 3.993281602859497
Epoch: 13, Steps: 17 | Train Loss: 56.285 Vali Loss: 703.244 Vali Acc: 0.285 Test Loss: 703.244 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.020251989364624
Epoch: 14, Steps: 17 | Train Loss: 85.393 Vali Loss: 632.337 Vali Acc: 0.251 Test Loss: 632.337 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9438037872314453
Epoch: 15, Steps: 17 | Train Loss: 145.508 Vali Loss: 810.369 Vali Acc: 0.259 Test Loss: 810.369 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.9196295738220215
Epoch: 16, Steps: 17 | Train Loss: 48.649 Vali Loss: 957.653 Vali Acc: 0.251 Test Loss: 957.653 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8479137420654297
Epoch: 17, Steps: 17 | Train Loss: 50.786 Vali Loss: 1212.218 Vali Acc: 0.293 Test Loss: 1212.218 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.9240219593048096
Epoch: 18, Steps: 17 | Train Loss: 30.514 Vali Loss: 1097.269 Vali Acc: 0.228 Test Loss: 1097.269 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.124225378036499
Epoch: 19, Steps: 17 | Train Loss: 41.369 Vali Loss: 1674.287 Vali Acc: 0.316 Test Loss: 1674.287 Test Acc: 0.316
Validation loss decreased (-0.296093 --> -0.298846).  Saving model ...
Epoch: 20 cost time: 3.9265568256378174
Epoch: 20, Steps: 17 | Train Loss: 108.028 Vali Loss: 1639.711 Vali Acc: 0.300 Test Loss: 1639.711 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.140381813049316
Epoch: 21, Steps: 17 | Train Loss: 25.369 Vali Loss: 1819.002 Vali Acc: 0.209 Test Loss: 1819.002 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.7299838066101074
Epoch: 22, Steps: 17 | Train Loss: 60.442 Vali Loss: 2285.876 Vali Acc: 0.232 Test Loss: 2285.876 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.5740890502929688
Epoch: 23, Steps: 17 | Train Loss: 64.901 Vali Loss: 2546.697 Vali Acc: 0.266 Test Loss: 2546.697 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.934600591659546
Epoch: 24, Steps: 17 | Train Loss: 14.240 Vali Loss: 2730.409 Vali Acc: 0.281 Test Loss: 2730.409 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.7290332317352295
Epoch: 25, Steps: 17 | Train Loss: 30.117 Vali Loss: 2701.948 Vali Acc: 0.228 Test Loss: 2701.948 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.111551284790039
Epoch: 26, Steps: 17 | Train Loss: 17.998 Vali Loss: 2619.854 Vali Acc: 0.232 Test Loss: 2619.854 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.7555437088012695
Epoch: 27, Steps: 17 | Train Loss: 34.363 Vali Loss: 2558.662 Vali Acc: 0.270 Test Loss: 2558.662 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.965343952178955
Epoch: 28, Steps: 17 | Train Loss: 35.449 Vali Loss: 2642.240 Vali Acc: 0.270 Test Loss: 2642.240 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.3652656078338623
Epoch: 29, Steps: 17 | Train Loss: 81.155 Vali Loss: 2825.882 Vali Acc: 0.221 Test Loss: 2825.882 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 4189728
model size : 25.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.294247627258301
Epoch: 1, Steps: 17 | Train Loss: 36.365 Vali Loss: 66.664 Vali Acc: 0.251 Test Loss: 66.664 Test Acc: 0.251
Validation loss decreased (inf --> -0.250284).  Saving model ...
Epoch: 2 cost time: 3.2375755310058594
Epoch: 2, Steps: 17 | Train Loss: 71.058 Vali Loss: 108.082 Vali Acc: 0.217 Test Loss: 108.082 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.288376808166504
Epoch: 3, Steps: 17 | Train Loss: 111.364 Vali Loss: 142.168 Vali Acc: 0.266 Test Loss: 142.168 Test Acc: 0.266
Validation loss decreased (-0.250284 --> -0.264738).  Saving model ...
Epoch: 4 cost time: 3.7197346687316895
Epoch: 4, Steps: 17 | Train Loss: 172.826 Vali Loss: 160.650 Vali Acc: 0.251 Test Loss: 160.650 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3731462955474854
Epoch: 5, Steps: 17 | Train Loss: 140.263 Vali Loss: 145.539 Vali Acc: 0.270 Test Loss: 145.539 Test Acc: 0.270
Validation loss decreased (-0.264738 --> -0.268507).  Saving model ...
Epoch: 6 cost time: 3.6447908878326416
Epoch: 6, Steps: 17 | Train Loss: 65.235 Vali Loss: 193.028 Vali Acc: 0.251 Test Loss: 193.028 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.573127031326294
Epoch: 7, Steps: 17 | Train Loss: 95.204 Vali Loss: 170.521 Vali Acc: 0.236 Test Loss: 170.521 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5154292583465576
Epoch: 8, Steps: 17 | Train Loss: 77.054 Vali Loss: 244.499 Vali Acc: 0.255 Test Loss: 244.499 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.5586209297180176
Epoch: 9, Steps: 17 | Train Loss: 100.022 Vali Loss: 267.037 Vali Acc: 0.270 Test Loss: 267.037 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.7146222591400146
Epoch: 10, Steps: 17 | Train Loss: 94.675 Vali Loss: 380.865 Vali Acc: 0.281 Test Loss: 380.865 Test Acc: 0.281
Validation loss decreased (-0.268507 --> -0.277560).  Saving model ...
Epoch: 11 cost time: 3.3358869552612305
Epoch: 11, Steps: 17 | Train Loss: 66.343 Vali Loss: 453.316 Vali Acc: 0.247 Test Loss: 453.316 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4541449546813965
Epoch: 12, Steps: 17 | Train Loss: 81.025 Vali Loss: 492.646 Vali Acc: 0.259 Test Loss: 492.646 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.2859609127044678
Epoch: 13, Steps: 17 | Train Loss: 93.131 Vali Loss: 962.560 Vali Acc: 0.236 Test Loss: 962.560 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.4925296306610107
Epoch: 14, Steps: 17 | Train Loss: 140.447 Vali Loss: 967.415 Vali Acc: 0.247 Test Loss: 967.415 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.568347215652466
Epoch: 15, Steps: 17 | Train Loss: 117.973 Vali Loss: 1200.847 Vali Acc: 0.243 Test Loss: 1200.847 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.248539924621582
Epoch: 16, Steps: 17 | Train Loss: 101.311 Vali Loss: 1053.226 Vali Acc: 0.221 Test Loss: 1053.226 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.5813510417938232
Epoch: 17, Steps: 17 | Train Loss: 75.400 Vali Loss: 1307.698 Vali Acc: 0.247 Test Loss: 1307.698 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.4875869750976562
Epoch: 18, Steps: 17 | Train Loss: 42.460 Vali Loss: 1324.065 Vali Acc: 0.240 Test Loss: 1324.065 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.396888494491577
Epoch: 19, Steps: 17 | Train Loss: 24.044 Vali Loss: 1377.919 Vali Acc: 0.198 Test Loss: 1377.919 Test Acc: 0.198
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.4734010696411133
Epoch: 20, Steps: 17 | Train Loss: 66.487 Vali Loss: 1344.761 Vali Acc: 0.209 Test Loss: 1344.761 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 4189728
model size : 25.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.221490144729614
Epoch: 1, Steps: 17 | Train Loss: 36.002 Vali Loss: 72.840 Vali Acc: 0.251 Test Loss: 72.840 Test Acc: 0.251
Validation loss decreased (inf --> -0.250222).  Saving model ...
Epoch: 2 cost time: 3.0946788787841797
Epoch: 2, Steps: 17 | Train Loss: 46.672 Vali Loss: 62.383 Vali Acc: 0.236 Test Loss: 62.383 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.887099266052246
Epoch: 3, Steps: 17 | Train Loss: 72.645 Vali Loss: 47.004 Vali Acc: 0.224 Test Loss: 47.004 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.930236339569092
Epoch: 4, Steps: 17 | Train Loss: 49.003 Vali Loss: 46.121 Vali Acc: 0.270 Test Loss: 46.121 Test Acc: 0.270
Validation loss decreased (-0.250222 --> -0.269501).  Saving model ...
Epoch: 5 cost time: 2.8985400199890137
Epoch: 5, Steps: 17 | Train Loss: 63.097 Vali Loss: 105.853 Vali Acc: 0.243 Test Loss: 105.853 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2240829467773438
Epoch: 6, Steps: 17 | Train Loss: 100.934 Vali Loss: 87.179 Vali Acc: 0.243 Test Loss: 87.179 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0283689498901367
Epoch: 7, Steps: 17 | Train Loss: 79.022 Vali Loss: 127.908 Vali Acc: 0.243 Test Loss: 127.908 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0160605907440186
Epoch: 8, Steps: 17 | Train Loss: 85.862 Vali Loss: 124.523 Vali Acc: 0.255 Test Loss: 124.523 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.269899845123291
Epoch: 9, Steps: 17 | Train Loss: 106.295 Vali Loss: 164.829 Vali Acc: 0.270 Test Loss: 164.829 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.111827850341797
Epoch: 10, Steps: 17 | Train Loss: 78.904 Vali Loss: 307.710 Vali Acc: 0.247 Test Loss: 307.710 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.047191858291626
Epoch: 11, Steps: 17 | Train Loss: 97.197 Vali Loss: 177.917 Vali Acc: 0.266 Test Loss: 177.917 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.198524236679077
Epoch: 12, Steps: 17 | Train Loss: 71.739 Vali Loss: 188.794 Vali Acc: 0.236 Test Loss: 188.794 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.1729185581207275
Epoch: 13, Steps: 17 | Train Loss: 60.568 Vali Loss: 254.323 Vali Acc: 0.289 Test Loss: 254.323 Test Acc: 0.289
Validation loss decreased (-0.269501 --> -0.286430).  Saving model ...
Epoch: 14 cost time: 3.0051374435424805
Epoch: 14, Steps: 17 | Train Loss: 60.303 Vali Loss: 280.946 Vali Acc: 0.274 Test Loss: 280.946 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.166043996810913
Epoch: 15, Steps: 17 | Train Loss: 44.227 Vali Loss: 339.357 Vali Acc: 0.240 Test Loss: 339.357 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8841230869293213
Epoch: 16, Steps: 17 | Train Loss: 56.957 Vali Loss: 443.060 Vali Acc: 0.247 Test Loss: 443.060 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.9613094329833984
Epoch: 17, Steps: 17 | Train Loss: 86.173 Vali Loss: 431.381 Vali Acc: 0.247 Test Loss: 431.381 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.208843469619751
Epoch: 18, Steps: 17 | Train Loss: 39.643 Vali Loss: 433.303 Vali Acc: 0.281 Test Loss: 433.303 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.17659068107605
Epoch: 19, Steps: 17 | Train Loss: 44.047 Vali Loss: 437.505 Vali Acc: 0.240 Test Loss: 437.505 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.3393473625183105
Epoch: 20, Steps: 17 | Train Loss: 32.370 Vali Loss: 472.168 Vali Acc: 0.266 Test Loss: 472.168 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.0494158267974854
Epoch: 21, Steps: 17 | Train Loss: 16.205 Vali Loss: 542.842 Vali Acc: 0.266 Test Loss: 542.842 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.6812009811401367
Epoch: 22, Steps: 17 | Train Loss: 16.328 Vali Loss: 509.345 Vali Acc: 0.255 Test Loss: 509.345 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.0773329734802246
Epoch: 23, Steps: 17 | Train Loss: 29.092 Vali Loss: 633.931 Vali Acc: 0.217 Test Loss: 633.931 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 2979616
model size : 16.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.46193265914917
Epoch: 1, Steps: 17 | Train Loss: 27.794 Vali Loss: 38.983 Vali Acc: 0.270 Test Loss: 38.983 Test Acc: 0.270
Validation loss decreased (inf --> -0.269572).  Saving model ...
Epoch: 2 cost time: 2.443742513656616
Epoch: 2, Steps: 17 | Train Loss: 31.189 Vali Loss: 70.983 Vali Acc: 0.251 Test Loss: 70.983 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5613863468170166
Epoch: 3, Steps: 17 | Train Loss: 55.549 Vali Loss: 79.287 Vali Acc: 0.262 Test Loss: 79.287 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.722425937652588
Epoch: 4, Steps: 17 | Train Loss: 75.378 Vali Loss: 86.749 Vali Acc: 0.262 Test Loss: 86.749 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.1172876358032227
Epoch: 5, Steps: 17 | Train Loss: 52.536 Vali Loss: 91.523 Vali Acc: 0.255 Test Loss: 91.523 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.9756858348846436
Epoch: 6, Steps: 17 | Train Loss: 75.836 Vali Loss: 145.406 Vali Acc: 0.240 Test Loss: 145.406 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.107084274291992
Epoch: 7, Steps: 17 | Train Loss: 91.551 Vali Loss: 85.822 Vali Acc: 0.270 Test Loss: 85.822 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.871088981628418
Epoch: 8, Steps: 17 | Train Loss: 91.519 Vali Loss: 157.855 Vali Acc: 0.243 Test Loss: 157.855 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.992793560028076
Epoch: 9, Steps: 17 | Train Loss: 152.594 Vali Loss: 171.908 Vali Acc: 0.289 Test Loss: 171.908 Test Acc: 0.289
Validation loss decreased (-0.269572 --> -0.287254).  Saving model ...
Epoch: 10 cost time: 3.0025720596313477
Epoch: 10, Steps: 17 | Train Loss: 69.534 Vali Loss: 203.437 Vali Acc: 0.270 Test Loss: 203.437 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2426681518554688
Epoch: 11, Steps: 17 | Train Loss: 90.351 Vali Loss: 166.758 Vali Acc: 0.255 Test Loss: 166.758 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0301618576049805
Epoch: 12, Steps: 17 | Train Loss: 57.166 Vali Loss: 175.751 Vali Acc: 0.281 Test Loss: 175.751 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.2419726848602295
Epoch: 13, Steps: 17 | Train Loss: 51.840 Vali Loss: 310.014 Vali Acc: 0.274 Test Loss: 310.014 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.884929895401001
Epoch: 14, Steps: 17 | Train Loss: 62.983 Vali Loss: 361.391 Vali Acc: 0.251 Test Loss: 361.391 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.1039135456085205
Epoch: 15, Steps: 17 | Train Loss: 78.239 Vali Loss: 300.828 Vali Acc: 0.243 Test Loss: 300.828 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.1257755756378174
Epoch: 16, Steps: 17 | Train Loss: 42.534 Vali Loss: 420.839 Vali Acc: 0.274 Test Loss: 420.839 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.2024483680725098
Epoch: 17, Steps: 17 | Train Loss: 69.378 Vali Loss: 445.471 Vali Acc: 0.274 Test Loss: 445.471 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.061776638031006
Epoch: 18, Steps: 17 | Train Loss: 29.344 Vali Loss: 415.789 Vali Acc: 0.255 Test Loss: 415.789 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.375067710876465
Epoch: 19, Steps: 17 | Train Loss: 19.414 Vali Loss: 389.509 Vali Acc: 0.224 Test Loss: 389.509 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 2979616
model size : 16.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.29666543006897
Epoch: 1, Steps: 17 | Train Loss: 30.868 Vali Loss: 60.304 Vali Acc: 0.262 Test Loss: 60.304 Test Acc: 0.262
Validation loss decreased (inf --> -0.261754).  Saving model ...
Epoch: 2 cost time: 2.839237689971924
Epoch: 2, Steps: 17 | Train Loss: 59.719 Vali Loss: 28.409 Vali Acc: 0.262 Test Loss: 28.409 Test Acc: 0.262
Validation loss decreased (-0.261754 --> -0.262073).  Saving model ...
Epoch: 3 cost time: 2.613469362258911
Epoch: 3, Steps: 17 | Train Loss: 55.537 Vali Loss: 100.465 Vali Acc: 0.255 Test Loss: 100.465 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7794747352600098
Epoch: 4, Steps: 17 | Train Loss: 71.456 Vali Loss: 37.166 Vali Acc: 0.251 Test Loss: 37.166 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.870351552963257
Epoch: 5, Steps: 17 | Train Loss: 55.923 Vali Loss: 141.119 Vali Acc: 0.243 Test Loss: 141.119 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5825812816619873
Epoch: 6, Steps: 17 | Train Loss: 73.192 Vali Loss: 81.211 Vali Acc: 0.247 Test Loss: 81.211 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6311497688293457
Epoch: 7, Steps: 17 | Train Loss: 81.933 Vali Loss: 69.674 Vali Acc: 0.251 Test Loss: 69.674 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.7070744037628174
Epoch: 8, Steps: 17 | Train Loss: 102.686 Vali Loss: 76.177 Vali Acc: 0.281 Test Loss: 76.177 Test Acc: 0.281
Validation loss decreased (-0.262073 --> -0.280607).  Saving model ...
Epoch: 9 cost time: 2.6850528717041016
Epoch: 9, Steps: 17 | Train Loss: 57.739 Vali Loss: 151.058 Vali Acc: 0.255 Test Loss: 151.058 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.974017858505249
Epoch: 10, Steps: 17 | Train Loss: 79.542 Vali Loss: 150.927 Vali Acc: 0.266 Test Loss: 150.927 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7751095294952393
Epoch: 11, Steps: 17 | Train Loss: 83.382 Vali Loss: 266.503 Vali Acc: 0.255 Test Loss: 266.503 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.451704978942871
Epoch: 12, Steps: 17 | Train Loss: 62.431 Vali Loss: 191.033 Vali Acc: 0.232 Test Loss: 191.033 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.600633144378662
Epoch: 13, Steps: 17 | Train Loss: 27.449 Vali Loss: 234.175 Vali Acc: 0.228 Test Loss: 234.175 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.259321451187134
Epoch: 14, Steps: 17 | Train Loss: 46.181 Vali Loss: 266.564 Vali Acc: 0.270 Test Loss: 266.564 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.8182311058044434
Epoch: 15, Steps: 17 | Train Loss: 41.276 Vali Loss: 270.194 Vali Acc: 0.243 Test Loss: 270.194 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.8338098526000977
Epoch: 16, Steps: 17 | Train Loss: 17.733 Vali Loss: 329.091 Vali Acc: 0.262 Test Loss: 329.091 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.8715624809265137
Epoch: 17, Steps: 17 | Train Loss: 27.864 Vali Loss: 320.024 Vali Acc: 0.240 Test Loss: 320.024 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.7859151363372803
Epoch: 18, Steps: 17 | Train Loss: 21.278 Vali Loss: 356.461 Vali Acc: 0.228 Test Loss: 356.461 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 2979616
model size : 16.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8449063301086426
Epoch: 1, Steps: 17 | Train Loss: 29.765 Vali Loss: 46.527 Vali Acc: 0.255 Test Loss: 46.527 Test Acc: 0.255
Validation loss decreased (inf --> -0.254288).  Saving model ...
Epoch: 2 cost time: 2.1217293739318848
Epoch: 2, Steps: 17 | Train Loss: 66.401 Vali Loss: 104.089 Vali Acc: 0.247 Test Loss: 104.089 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3106672763824463
Epoch: 3, Steps: 17 | Train Loss: 90.293 Vali Loss: 68.984 Vali Acc: 0.270 Test Loss: 68.984 Test Acc: 0.270
Validation loss decreased (-0.254288 --> -0.269272).  Saving model ...
Epoch: 4 cost time: 2.4061484336853027
Epoch: 4, Steps: 17 | Train Loss: 57.291 Vali Loss: 126.169 Vali Acc: 0.255 Test Loss: 126.169 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.264960765838623
Epoch: 5, Steps: 17 | Train Loss: 59.077 Vali Loss: 45.370 Vali Acc: 0.259 Test Loss: 45.370 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4349963665008545
Epoch: 6, Steps: 17 | Train Loss: 84.067 Vali Loss: 186.962 Vali Acc: 0.240 Test Loss: 186.962 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4201741218566895
Epoch: 7, Steps: 17 | Train Loss: 133.174 Vali Loss: 105.323 Vali Acc: 0.266 Test Loss: 105.323 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3990728855133057
Epoch: 8, Steps: 17 | Train Loss: 69.877 Vali Loss: 107.252 Vali Acc: 0.259 Test Loss: 107.252 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.1366443634033203
Epoch: 9, Steps: 17 | Train Loss: 71.264 Vali Loss: 172.309 Vali Acc: 0.278 Test Loss: 172.309 Test Acc: 0.278
Validation loss decreased (-0.269272 --> -0.275843).  Saving model ...
Epoch: 10 cost time: 2.2885565757751465
Epoch: 10, Steps: 17 | Train Loss: 52.382 Vali Loss: 122.438 Vali Acc: 0.274 Test Loss: 122.438 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3988938331604004
Epoch: 11, Steps: 17 | Train Loss: 37.585 Vali Loss: 158.989 Vali Acc: 0.270 Test Loss: 158.989 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4277491569519043
Epoch: 12, Steps: 17 | Train Loss: 34.558 Vali Loss: 154.118 Vali Acc: 0.266 Test Loss: 154.118 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.367239236831665
Epoch: 13, Steps: 17 | Train Loss: 20.412 Vali Loss: 237.039 Vali Acc: 0.259 Test Loss: 237.039 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.41670823097229
Epoch: 14, Steps: 17 | Train Loss: 30.782 Vali Loss: 272.901 Vali Acc: 0.274 Test Loss: 272.901 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.471564769744873
Epoch: 15, Steps: 17 | Train Loss: 26.817 Vali Loss: 285.672 Vali Acc: 0.221 Test Loss: 285.672 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.3481152057647705
Epoch: 16, Steps: 17 | Train Loss: 48.246 Vali Loss: 417.197 Vali Acc: 0.236 Test Loss: 417.197 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.354480028152466
Epoch: 17, Steps: 17 | Train Loss: 51.812 Vali Loss: 377.460 Vali Acc: 0.255 Test Loss: 377.460 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.4458820819854736
Epoch: 18, Steps: 17 | Train Loss: 51.036 Vali Loss: 420.841 Vali Acc: 0.221 Test Loss: 420.841 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1592233180999756
Epoch: 19, Steps: 17 | Train Loss: 31.467 Vali Loss: 544.250 Vali Acc: 0.236 Test Loss: 544.250 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 2979616
model size : 16.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.147464990615845
Epoch: 1, Steps: 17 | Train Loss: 26.816 Vali Loss: 64.643 Vali Acc: 0.232 Test Loss: 64.643 Test Acc: 0.232
Validation loss decreased (inf --> -0.231293).  Saving model ...
Epoch: 2 cost time: 2.924872636795044
Epoch: 2, Steps: 17 | Train Loss: 83.757 Vali Loss: 139.565 Vali Acc: 0.243 Test Loss: 139.565 Test Acc: 0.243
Validation loss decreased (-0.231293 --> -0.241950).  Saving model ...
Epoch: 3 cost time: 2.8714325428009033
Epoch: 3, Steps: 17 | Train Loss: 86.046 Vali Loss: 148.677 Vali Acc: 0.247 Test Loss: 148.677 Test Acc: 0.247
Validation loss decreased (-0.241950 --> -0.245662).  Saving model ...
Epoch: 4 cost time: 2.9732820987701416
Epoch: 4, Steps: 17 | Train Loss: 74.061 Vali Loss: 70.474 Vali Acc: 0.262 Test Loss: 70.474 Test Acc: 0.262
Validation loss decreased (-0.245662 --> -0.261653).  Saving model ...
Epoch: 5 cost time: 3.137694835662842
Epoch: 5, Steps: 17 | Train Loss: 106.527 Vali Loss: 64.124 Vali Acc: 0.247 Test Loss: 64.124 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9105937480926514
Epoch: 6, Steps: 17 | Train Loss: 75.710 Vali Loss: 74.074 Vali Acc: 0.281 Test Loss: 74.074 Test Acc: 0.281
Validation loss decreased (-0.261653 --> -0.280628).  Saving model ...
Epoch: 7 cost time: 2.8129935264587402
Epoch: 7, Steps: 17 | Train Loss: 130.799 Vali Loss: 125.503 Vali Acc: 0.274 Test Loss: 125.503 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9161295890808105
Epoch: 8, Steps: 17 | Train Loss: 113.040 Vali Loss: 165.743 Vali Acc: 0.221 Test Loss: 165.743 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.776637554168701
Epoch: 9, Steps: 17 | Train Loss: 104.640 Vali Loss: 281.817 Vali Acc: 0.243 Test Loss: 281.817 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.796602725982666
Epoch: 10, Steps: 17 | Train Loss: 73.768 Vali Loss: 175.407 Vali Acc: 0.251 Test Loss: 175.407 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8424155712127686
Epoch: 11, Steps: 17 | Train Loss: 100.571 Vali Loss: 222.097 Vali Acc: 0.240 Test Loss: 222.097 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0466980934143066
Epoch: 12, Steps: 17 | Train Loss: 146.291 Vali Loss: 265.407 Vali Acc: 0.236 Test Loss: 265.407 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.84484601020813
Epoch: 13, Steps: 17 | Train Loss: 81.268 Vali Loss: 199.749 Vali Acc: 0.259 Test Loss: 199.749 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8629918098449707
Epoch: 14, Steps: 17 | Train Loss: 39.765 Vali Loss: 226.569 Vali Acc: 0.281 Test Loss: 226.569 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.8345015048980713
Epoch: 15, Steps: 17 | Train Loss: 44.726 Vali Loss: 227.202 Vali Acc: 0.270 Test Loss: 227.202 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.8819918632507324
Epoch: 16, Steps: 17 | Train Loss: 62.368 Vali Loss: 439.068 Vali Acc: 0.236 Test Loss: 439.068 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 2455328
model size : 14.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.567187070846558
Epoch: 1, Steps: 17 | Train Loss: 28.423 Vali Loss: 62.024 Vali Acc: 0.240 Test Loss: 62.024 Test Acc: 0.240
Validation loss decreased (inf --> -0.238923).  Saving model ...
Epoch: 2 cost time: 2.4646217823028564
Epoch: 2, Steps: 17 | Train Loss: 71.636 Vali Loss: 56.552 Vali Acc: 0.251 Test Loss: 56.552 Test Acc: 0.251
Validation loss decreased (-0.238923 --> -0.250385).  Saving model ...
Epoch: 3 cost time: 2.8176803588867188
Epoch: 3, Steps: 17 | Train Loss: 65.528 Vali Loss: 88.894 Vali Acc: 0.247 Test Loss: 88.894 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6972458362579346
Epoch: 4, Steps: 17 | Train Loss: 62.938 Vali Loss: 111.301 Vali Acc: 0.259 Test Loss: 111.301 Test Acc: 0.259
Validation loss decreased (-0.250385 --> -0.257442).  Saving model ...
Epoch: 5 cost time: 2.782790184020996
Epoch: 5, Steps: 17 | Train Loss: 72.489 Vali Loss: 143.452 Vali Acc: 0.243 Test Loss: 143.452 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.519160270690918
Epoch: 6, Steps: 17 | Train Loss: 93.373 Vali Loss: 107.521 Vali Acc: 0.251 Test Loss: 107.521 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.162095546722412
Epoch: 7, Steps: 17 | Train Loss: 64.742 Vali Loss: 151.172 Vali Acc: 0.247 Test Loss: 151.172 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.97080659866333
Epoch: 8, Steps: 17 | Train Loss: 89.551 Vali Loss: 64.515 Vali Acc: 0.247 Test Loss: 64.515 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.932929754257202
Epoch: 9, Steps: 17 | Train Loss: 75.817 Vali Loss: 224.864 Vali Acc: 0.247 Test Loss: 224.864 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.2004048824310303
Epoch: 10, Steps: 17 | Train Loss: 82.745 Vali Loss: 206.118 Vali Acc: 0.281 Test Loss: 206.118 Test Acc: 0.281
Validation loss decreased (-0.257442 --> -0.279308).  Saving model ...
Epoch: 11 cost time: 3.280487060546875
Epoch: 11, Steps: 17 | Train Loss: 54.334 Vali Loss: 181.135 Vali Acc: 0.278 Test Loss: 181.135 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.668855905532837
Epoch: 12, Steps: 17 | Train Loss: 57.656 Vali Loss: 199.680 Vali Acc: 0.262 Test Loss: 199.680 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6758577823638916
Epoch: 13, Steps: 17 | Train Loss: 74.378 Vali Loss: 303.082 Vali Acc: 0.285 Test Loss: 303.082 Test Acc: 0.285
Validation loss decreased (-0.279308 --> -0.282140).  Saving model ...
Epoch: 14 cost time: 3.72460675239563
Epoch: 14, Steps: 17 | Train Loss: 69.551 Vali Loss: 343.762 Vali Acc: 0.281 Test Loss: 343.762 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.648660659790039
Epoch: 15, Steps: 17 | Train Loss: 66.685 Vali Loss: 258.205 Vali Acc: 0.304 Test Loss: 258.205 Test Acc: 0.304
Validation loss decreased (-0.282140 --> -0.301600).  Saving model ...
Epoch: 16 cost time: 3.2674312591552734
Epoch: 16, Steps: 17 | Train Loss: 51.916 Vali Loss: 273.348 Vali Acc: 0.285 Test Loss: 273.348 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0739526748657227
Epoch: 17, Steps: 17 | Train Loss: 33.129 Vali Loss: 338.651 Vali Acc: 0.255 Test Loss: 338.651 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2383837699890137
Epoch: 18, Steps: 17 | Train Loss: 22.125 Vali Loss: 502.180 Vali Acc: 0.278 Test Loss: 502.180 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.5743489265441895
Epoch: 19, Steps: 17 | Train Loss: 44.497 Vali Loss: 416.742 Vali Acc: 0.236 Test Loss: 416.742 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.83077335357666
Epoch: 20, Steps: 17 | Train Loss: 13.556 Vali Loss: 433.817 Vali Acc: 0.247 Test Loss: 433.817 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.498379707336426
Epoch: 21, Steps: 17 | Train Loss: 20.938 Vali Loss: 466.359 Vali Acc: 0.228 Test Loss: 466.359 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.7041895389556885
Epoch: 22, Steps: 17 | Train Loss: 10.338 Vali Loss: 568.156 Vali Acc: 0.255 Test Loss: 568.156 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.6070444583892822
Epoch: 23, Steps: 17 | Train Loss: 13.766 Vali Loss: 545.911 Vali Acc: 0.217 Test Loss: 545.911 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.503469944000244
Epoch: 24, Steps: 17 | Train Loss: 26.751 Vali Loss: 653.265 Vali Acc: 0.240 Test Loss: 653.265 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.260915517807007
Epoch: 25, Steps: 17 | Train Loss: 14.902 Vali Loss: 702.681 Vali Acc: 0.262 Test Loss: 702.681 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 2455328
model size : 14.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.370401620864868
Epoch: 1, Steps: 17 | Train Loss: 18.718 Vali Loss: 54.913 Vali Acc: 0.255 Test Loss: 54.913 Test Acc: 0.255
Validation loss decreased (inf --> -0.254204).  Saving model ...
Epoch: 2 cost time: 3.4023375511169434
Epoch: 2, Steps: 17 | Train Loss: 85.124 Vali Loss: 62.702 Vali Acc: 0.247 Test Loss: 62.702 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5220606327056885
Epoch: 3, Steps: 17 | Train Loss: 78.210 Vali Loss: 165.759 Vali Acc: 0.255 Test Loss: 165.759 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2184925079345703
Epoch: 4, Steps: 17 | Train Loss: 77.408 Vali Loss: 94.014 Vali Acc: 0.259 Test Loss: 94.014 Test Acc: 0.259
Validation loss decreased (-0.254204 --> -0.257615).  Saving model ...
Epoch: 5 cost time: 3.4457085132598877
Epoch: 5, Steps: 17 | Train Loss: 117.438 Vali Loss: 134.442 Vali Acc: 0.251 Test Loss: 134.442 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0306777954101562
Epoch: 6, Steps: 17 | Train Loss: 78.141 Vali Loss: 68.671 Vali Acc: 0.259 Test Loss: 68.671 Test Acc: 0.259
Validation loss decreased (-0.257615 --> -0.257868).  Saving model ...
Epoch: 7 cost time: 2.5390467643737793
Epoch: 7, Steps: 17 | Train Loss: 105.918 Vali Loss: 71.018 Vali Acc: 0.266 Test Loss: 71.018 Test Acc: 0.266
Validation loss decreased (-0.257868 --> -0.265450).  Saving model ...
Epoch: 8 cost time: 2.7733957767486572
Epoch: 8, Steps: 17 | Train Loss: 46.118 Vali Loss: 109.079 Vali Acc: 0.240 Test Loss: 109.079 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.572669267654419
Epoch: 9, Steps: 17 | Train Loss: 54.941 Vali Loss: 91.371 Vali Acc: 0.266 Test Loss: 91.371 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.228597402572632
Epoch: 10, Steps: 17 | Train Loss: 40.823 Vali Loss: 158.544 Vali Acc: 0.217 Test Loss: 158.544 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.542184829711914
Epoch: 11, Steps: 17 | Train Loss: 51.798 Vali Loss: 242.883 Vali Acc: 0.251 Test Loss: 242.883 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.768415689468384
Epoch: 12, Steps: 17 | Train Loss: 129.078 Vali Loss: 304.296 Vali Acc: 0.236 Test Loss: 304.296 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5981602668762207
Epoch: 13, Steps: 17 | Train Loss: 58.231 Vali Loss: 219.478 Vali Acc: 0.240 Test Loss: 219.478 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.729611396789551
Epoch: 14, Steps: 17 | Train Loss: 33.262 Vali Loss: 272.197 Vali Acc: 0.251 Test Loss: 272.197 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.5767335891723633
Epoch: 15, Steps: 17 | Train Loss: 30.710 Vali Loss: 293.442 Vali Acc: 0.243 Test Loss: 293.442 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.8880114555358887
Epoch: 16, Steps: 17 | Train Loss: 72.565 Vali Loss: 311.103 Vali Acc: 0.251 Test Loss: 311.103 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.84842586517334
Epoch: 17, Steps: 17 | Train Loss: 63.317 Vali Loss: 380.717 Vali Acc: 0.304 Test Loss: 380.717 Test Acc: 0.304
Validation loss decreased (-0.265450 --> -0.300375).  Saving model ...
Epoch: 18 cost time: 2.663268804550171
Epoch: 18, Steps: 17 | Train Loss: 25.737 Vali Loss: 415.418 Vali Acc: 0.240 Test Loss: 415.418 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6346540451049805
Epoch: 19, Steps: 17 | Train Loss: 37.440 Vali Loss: 437.251 Vali Acc: 0.255 Test Loss: 437.251 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.497896671295166
Epoch: 20, Steps: 17 | Train Loss: 19.921 Vali Loss: 457.030 Vali Acc: 0.255 Test Loss: 457.030 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.7111966609954834
Epoch: 21, Steps: 17 | Train Loss: 18.635 Vali Loss: 518.487 Vali Acc: 0.236 Test Loss: 518.487 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.4185969829559326
Epoch: 22, Steps: 17 | Train Loss: 28.941 Vali Loss: 583.235 Vali Acc: 0.255 Test Loss: 583.235 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.582221269607544
Epoch: 23, Steps: 17 | Train Loss: 22.548 Vali Loss: 510.685 Vali Acc: 0.232 Test Loss: 510.685 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.419039249420166
Epoch: 24, Steps: 17 | Train Loss: 28.491 Vali Loss: 564.078 Vali Acc: 0.266 Test Loss: 564.078 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.5410003662109375
Epoch: 25, Steps: 17 | Train Loss: 8.823 Vali Loss: 658.036 Vali Acc: 0.236 Test Loss: 658.036 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.7350480556488037
Epoch: 26, Steps: 17 | Train Loss: 7.493 Vali Loss: 734.752 Vali Acc: 0.262 Test Loss: 734.752 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.597588539123535
Epoch: 27, Steps: 17 | Train Loss: 74.012 Vali Loss: 718.200 Vali Acc: 0.274 Test Loss: 718.200 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 2455328
model size : 14.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.651573896408081
Epoch: 1, Steps: 17 | Train Loss: 25.710 Vali Loss: 80.961 Vali Acc: 0.251 Test Loss: 80.961 Test Acc: 0.251
Validation loss decreased (inf --> -0.250141).  Saving model ...
Epoch: 2 cost time: 2.4585330486297607
Epoch: 2, Steps: 17 | Train Loss: 49.032 Vali Loss: 55.270 Vali Acc: 0.259 Test Loss: 55.270 Test Acc: 0.259
Validation loss decreased (-0.250141 --> -0.258002).  Saving model ...
Epoch: 3 cost time: 2.473640203475952
Epoch: 3, Steps: 17 | Train Loss: 74.673 Vali Loss: 119.493 Vali Acc: 0.262 Test Loss: 119.493 Test Acc: 0.262
Validation loss decreased (-0.258002 --> -0.261162).  Saving model ...
Epoch: 4 cost time: 2.6601269245147705
Epoch: 4, Steps: 17 | Train Loss: 68.132 Vali Loss: 82.944 Vali Acc: 0.247 Test Loss: 82.944 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4397480487823486
Epoch: 5, Steps: 17 | Train Loss: 103.662 Vali Loss: 102.493 Vali Acc: 0.251 Test Loss: 102.493 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3047070503234863
Epoch: 6, Steps: 17 | Train Loss: 67.212 Vali Loss: 109.763 Vali Acc: 0.270 Test Loss: 109.763 Test Acc: 0.270
Validation loss decreased (-0.261162 --> -0.268864).  Saving model ...
Epoch: 7 cost time: 2.550963878631592
Epoch: 7, Steps: 17 | Train Loss: 104.682 Vali Loss: 179.161 Vali Acc: 0.251 Test Loss: 179.161 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3618721961975098
Epoch: 8, Steps: 17 | Train Loss: 114.856 Vali Loss: 162.173 Vali Acc: 0.259 Test Loss: 162.173 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.46195387840271
Epoch: 9, Steps: 17 | Train Loss: 85.638 Vali Loss: 132.148 Vali Acc: 0.278 Test Loss: 132.148 Test Acc: 0.278
Validation loss decreased (-0.268864 --> -0.276245).  Saving model ...
Epoch: 10 cost time: 2.4341108798980713
Epoch: 10, Steps: 17 | Train Loss: 34.136 Vali Loss: 81.559 Vali Acc: 0.251 Test Loss: 81.559 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5651237964630127
Epoch: 11, Steps: 17 | Train Loss: 42.042 Vali Loss: 176.393 Vali Acc: 0.236 Test Loss: 176.393 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.703571319580078
Epoch: 12, Steps: 17 | Train Loss: 29.243 Vali Loss: 164.618 Vali Acc: 0.255 Test Loss: 164.618 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.809983491897583
Epoch: 13, Steps: 17 | Train Loss: 51.801 Vali Loss: 242.262 Vali Acc: 0.251 Test Loss: 242.262 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.571337938308716
Epoch: 14, Steps: 17 | Train Loss: 38.575 Vali Loss: 252.386 Vali Acc: 0.232 Test Loss: 252.386 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.5688555240631104
Epoch: 15, Steps: 17 | Train Loss: 40.222 Vali Loss: 376.562 Vali Acc: 0.308 Test Loss: 376.562 Test Acc: 0.308
Validation loss decreased (-0.276245 --> -0.304219).  Saving model ...
Epoch: 16 cost time: 2.4506216049194336
Epoch: 16, Steps: 17 | Train Loss: 47.988 Vali Loss: 407.714 Vali Acc: 0.274 Test Loss: 407.714 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7167954444885254
Epoch: 17, Steps: 17 | Train Loss: 28.294 Vali Loss: 418.816 Vali Acc: 0.228 Test Loss: 418.816 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.662374496459961
Epoch: 18, Steps: 17 | Train Loss: 60.251 Vali Loss: 623.823 Vali Acc: 0.262 Test Loss: 623.823 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.669093132019043
Epoch: 19, Steps: 17 | Train Loss: 40.162 Vali Loss: 562.542 Vali Acc: 0.266 Test Loss: 562.542 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.6200506687164307
Epoch: 20, Steps: 17 | Train Loss: 38.062 Vali Loss: 609.824 Vali Acc: 0.232 Test Loss: 609.824 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.4943654537200928
Epoch: 21, Steps: 17 | Train Loss: 50.699 Vali Loss: 650.887 Vali Acc: 0.232 Test Loss: 650.887 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.418865919113159
Epoch: 22, Steps: 17 | Train Loss: 22.823 Vali Loss: 841.065 Vali Acc: 0.300 Test Loss: 841.065 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.651285171508789
Epoch: 23, Steps: 17 | Train Loss: 31.785 Vali Loss: 782.216 Vali Acc: 0.285 Test Loss: 782.216 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.7640910148620605
Epoch: 24, Steps: 17 | Train Loss: 19.091 Vali Loss: 939.407 Vali Acc: 0.308 Test Loss: 939.407 Test Acc: 0.308
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.6727683544158936
Epoch: 25, Steps: 17 | Train Loss: 19.150 Vali Loss: 918.610 Vali Acc: 0.262 Test Loss: 918.610 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 2455328
model size : 14.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.504682540893555
Epoch: 1, Steps: 17 | Train Loss: 36.493 Vali Loss: 74.887 Vali Acc: 0.255 Test Loss: 74.887 Test Acc: 0.255
Validation loss decreased (inf --> -0.254004).  Saving model ...
Epoch: 2 cost time: 2.8777318000793457
Epoch: 2, Steps: 17 | Train Loss: 60.647 Vali Loss: 156.678 Vali Acc: 0.247 Test Loss: 156.678 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.002847909927368
Epoch: 3, Steps: 17 | Train Loss: 115.355 Vali Loss: 117.150 Vali Acc: 0.251 Test Loss: 117.150 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8839032649993896
Epoch: 4, Steps: 17 | Train Loss: 97.278 Vali Loss: 117.853 Vali Acc: 0.251 Test Loss: 117.853 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0343821048736572
Epoch: 5, Steps: 17 | Train Loss: 102.793 Vali Loss: 109.514 Vali Acc: 0.251 Test Loss: 109.514 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.0435891151428223
Epoch: 6, Steps: 17 | Train Loss: 85.028 Vali Loss: 170.608 Vali Acc: 0.251 Test Loss: 170.608 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.138841152191162
Epoch: 7, Steps: 17 | Train Loss: 101.083 Vali Loss: 145.169 Vali Acc: 0.243 Test Loss: 145.169 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0469539165496826
Epoch: 8, Steps: 17 | Train Loss: 120.055 Vali Loss: 114.641 Vali Acc: 0.259 Test Loss: 114.641 Test Acc: 0.259
Validation loss decreased (-0.254004 --> -0.257409).  Saving model ...
Epoch: 9 cost time: 3.2702860832214355
Epoch: 9, Steps: 17 | Train Loss: 97.896 Vali Loss: 154.128 Vali Acc: 0.266 Test Loss: 154.128 Test Acc: 0.266
Validation loss decreased (-0.257409 --> -0.264618).  Saving model ...
Epoch: 10 cost time: 2.982266426086426
Epoch: 10, Steps: 17 | Train Loss: 81.219 Vali Loss: 170.021 Vali Acc: 0.262 Test Loss: 170.021 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.78436541557312
Epoch: 11, Steps: 17 | Train Loss: 81.509 Vali Loss: 177.551 Vali Acc: 0.266 Test Loss: 177.551 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.188723564147949
Epoch: 12, Steps: 17 | Train Loss: 40.691 Vali Loss: 162.461 Vali Acc: 0.259 Test Loss: 162.461 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0966551303863525
Epoch: 13, Steps: 17 | Train Loss: 68.118 Vali Loss: 268.784 Vali Acc: 0.281 Test Loss: 268.784 Test Acc: 0.281
Validation loss decreased (-0.264618 --> -0.278681).  Saving model ...
Epoch: 14 cost time: 2.945202112197876
Epoch: 14, Steps: 17 | Train Loss: 56.192 Vali Loss: 261.802 Vali Acc: 0.259 Test Loss: 261.802 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2446820735931396
Epoch: 15, Steps: 17 | Train Loss: 48.683 Vali Loss: 349.429 Vali Acc: 0.243 Test Loss: 349.429 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.0241105556488037
Epoch: 16, Steps: 17 | Train Loss: 48.304 Vali Loss: 280.470 Vali Acc: 0.224 Test Loss: 280.470 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.056511402130127
Epoch: 17, Steps: 17 | Train Loss: 33.721 Vali Loss: 292.212 Vali Acc: 0.240 Test Loss: 292.212 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.291271924972534
Epoch: 18, Steps: 17 | Train Loss: 53.332 Vali Loss: 441.404 Vali Acc: 0.297 Test Loss: 441.404 Test Acc: 0.297
Validation loss decreased (-0.278681 --> -0.292164).  Saving model ...
Epoch: 19 cost time: 3.0584073066711426
Epoch: 19, Steps: 17 | Train Loss: 41.739 Vali Loss: 474.172 Vali Acc: 0.243 Test Loss: 474.172 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.442244529724121
Epoch: 20, Steps: 17 | Train Loss: 26.089 Vali Loss: 487.240 Vali Acc: 0.281 Test Loss: 487.240 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.312487840652466
Epoch: 21, Steps: 17 | Train Loss: 31.664 Vali Loss: 605.592 Vali Acc: 0.266 Test Loss: 605.592 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2844977378845215
Epoch: 22, Steps: 17 | Train Loss: 35.721 Vali Loss: 515.673 Vali Acc: 0.262 Test Loss: 515.673 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.4875307083129883
Epoch: 23, Steps: 17 | Train Loss: 29.800 Vali Loss: 603.671 Vali Acc: 0.262 Test Loss: 603.671 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.2407784461975098
Epoch: 24, Steps: 17 | Train Loss: 65.633 Vali Loss: 958.445 Vali Acc: 0.255 Test Loss: 958.445 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.338144540786743
Epoch: 25, Steps: 17 | Train Loss: 65.761 Vali Loss: 902.099 Vali Acc: 0.259 Test Loss: 902.099 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.049474000930786
Epoch: 26, Steps: 17 | Train Loss: 26.943 Vali Loss: 899.974 Vali Acc: 0.259 Test Loss: 899.974 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.2748653888702393
Epoch: 27, Steps: 17 | Train Loss: 32.002 Vali Loss: 867.477 Vali Acc: 0.221 Test Loss: 867.477 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.94604754447937
Epoch: 28, Steps: 17 | Train Loss: 17.343 Vali Loss: 945.670 Vali Acc: 0.224 Test Loss: 945.670 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 2193184
model size : 13.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.973128795623779
Epoch: 1, Steps: 17 | Train Loss: 43.200 Vali Loss: 36.383 Vali Acc: 0.240 Test Loss: 36.383 Test Acc: 0.240
Validation loss decreased (inf --> -0.239180).  Saving model ...
Epoch: 2 cost time: 2.601134777069092
Epoch: 2, Steps: 17 | Train Loss: 52.691 Vali Loss: 36.832 Vali Acc: 0.243 Test Loss: 36.832 Test Acc: 0.243
Validation loss decreased (-0.239180 --> -0.242978).  Saving model ...
Epoch: 3 cost time: 2.832690477371216
Epoch: 3, Steps: 17 | Train Loss: 56.045 Vali Loss: 144.221 Vali Acc: 0.251 Test Loss: 144.221 Test Acc: 0.251
Validation loss decreased (-0.242978 --> -0.249508).  Saving model ...
Epoch: 4 cost time: 2.7022106647491455
Epoch: 4, Steps: 17 | Train Loss: 73.806 Vali Loss: 69.056 Vali Acc: 0.247 Test Loss: 69.056 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8284592628479004
Epoch: 5, Steps: 17 | Train Loss: 82.059 Vali Loss: 157.365 Vali Acc: 0.262 Test Loss: 157.365 Test Acc: 0.262
Validation loss decreased (-0.249508 --> -0.260784).  Saving model ...
Epoch: 6 cost time: 2.652989625930786
Epoch: 6, Steps: 17 | Train Loss: 112.448 Vali Loss: 95.663 Vali Acc: 0.259 Test Loss: 95.663 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5911386013031006
Epoch: 7, Steps: 17 | Train Loss: 75.998 Vali Loss: 55.518 Vali Acc: 0.274 Test Loss: 55.518 Test Acc: 0.274
Validation loss decreased (-0.260784 --> -0.273209).  Saving model ...
Epoch: 8 cost time: 2.5836119651794434
Epoch: 8, Steps: 17 | Train Loss: 44.639 Vali Loss: 143.196 Vali Acc: 0.247 Test Loss: 143.196 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.572187662124634
Epoch: 9, Steps: 17 | Train Loss: 79.328 Vali Loss: 150.202 Vali Acc: 0.270 Test Loss: 150.202 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6274116039276123
Epoch: 10, Steps: 17 | Train Loss: 110.880 Vali Loss: 233.999 Vali Acc: 0.266 Test Loss: 233.999 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5893714427948
Epoch: 11, Steps: 17 | Train Loss: 64.107 Vali Loss: 166.540 Vali Acc: 0.243 Test Loss: 166.540 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.710888385772705
Epoch: 12, Steps: 17 | Train Loss: 28.227 Vali Loss: 179.574 Vali Acc: 0.240 Test Loss: 179.574 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.071467638015747
Epoch: 13, Steps: 17 | Train Loss: 51.378 Vali Loss: 191.213 Vali Acc: 0.262 Test Loss: 191.213 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.898940324783325
Epoch: 14, Steps: 17 | Train Loss: 38.821 Vali Loss: 218.470 Vali Acc: 0.247 Test Loss: 218.470 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.8850176334381104
Epoch: 15, Steps: 17 | Train Loss: 25.707 Vali Loss: 254.915 Vali Acc: 0.255 Test Loss: 254.915 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.90800404548645
Epoch: 16, Steps: 17 | Train Loss: 30.873 Vali Loss: 261.404 Vali Acc: 0.236 Test Loss: 261.404 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.757291316986084
Epoch: 17, Steps: 17 | Train Loss: 84.684 Vali Loss: 450.890 Vali Acc: 0.232 Test Loss: 450.890 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 2193184
model size : 13.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.95188045501709
Epoch: 1, Steps: 17 | Train Loss: 38.087 Vali Loss: 65.084 Vali Acc: 0.247 Test Loss: 65.084 Test Acc: 0.247
Validation loss decreased (inf --> -0.246497).  Saving model ...
Epoch: 2 cost time: 3.0231473445892334
Epoch: 2, Steps: 17 | Train Loss: 44.816 Vali Loss: 45.114 Vali Acc: 0.262 Test Loss: 45.114 Test Acc: 0.262
Validation loss decreased (-0.246497 --> -0.261906).  Saving model ...
Epoch: 3 cost time: 2.6810829639434814
Epoch: 3, Steps: 17 | Train Loss: 58.508 Vali Loss: 93.068 Vali Acc: 0.251 Test Loss: 93.068 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7506749629974365
Epoch: 4, Steps: 17 | Train Loss: 78.999 Vali Loss: 155.905 Vali Acc: 0.251 Test Loss: 155.905 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.682516574859619
Epoch: 5, Steps: 17 | Train Loss: 93.827 Vali Loss: 172.996 Vali Acc: 0.278 Test Loss: 172.996 Test Acc: 0.278
Validation loss decreased (-0.261906 --> -0.275837).  Saving model ...
Epoch: 6 cost time: 2.7175655364990234
Epoch: 6, Steps: 17 | Train Loss: 94.757 Vali Loss: 56.951 Vali Acc: 0.262 Test Loss: 56.951 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4500484466552734
Epoch: 7, Steps: 17 | Train Loss: 103.187 Vali Loss: 247.100 Vali Acc: 0.251 Test Loss: 247.100 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.774580955505371
Epoch: 8, Steps: 17 | Train Loss: 127.790 Vali Loss: 113.032 Vali Acc: 0.262 Test Loss: 113.032 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7707138061523438
Epoch: 9, Steps: 17 | Train Loss: 73.022 Vali Loss: 182.737 Vali Acc: 0.240 Test Loss: 182.737 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.11501407623291
Epoch: 10, Steps: 17 | Train Loss: 73.951 Vali Loss: 191.303 Vali Acc: 0.281 Test Loss: 191.303 Test Acc: 0.281
Validation loss decreased (-0.275837 --> -0.279456).  Saving model ...
Epoch: 11 cost time: 3.0936644077301025
Epoch: 11, Steps: 17 | Train Loss: 98.186 Vali Loss: 229.133 Vali Acc: 0.262 Test Loss: 229.133 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9146673679351807
Epoch: 12, Steps: 17 | Train Loss: 34.128 Vali Loss: 226.490 Vali Acc: 0.232 Test Loss: 226.490 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9246902465820312
Epoch: 13, Steps: 17 | Train Loss: 52.515 Vali Loss: 295.114 Vali Acc: 0.247 Test Loss: 295.114 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.186903238296509
Epoch: 14, Steps: 17 | Train Loss: 56.322 Vali Loss: 331.318 Vali Acc: 0.247 Test Loss: 331.318 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.91800594329834
Epoch: 15, Steps: 17 | Train Loss: 36.161 Vali Loss: 269.969 Vali Acc: 0.255 Test Loss: 269.969 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.741760015487671
Epoch: 16, Steps: 17 | Train Loss: 35.267 Vali Loss: 399.407 Vali Acc: 0.236 Test Loss: 399.407 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.137815475463867
Epoch: 17, Steps: 17 | Train Loss: 37.617 Vali Loss: 367.163 Vali Acc: 0.209 Test Loss: 367.163 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.567028522491455
Epoch: 18, Steps: 17 | Train Loss: 24.637 Vali Loss: 359.198 Vali Acc: 0.236 Test Loss: 359.198 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.750347375869751
Epoch: 19, Steps: 17 | Train Loss: 25.342 Vali Loss: 427.884 Vali Acc: 0.228 Test Loss: 427.884 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.8186771869659424
Epoch: 20, Steps: 17 | Train Loss: 27.560 Vali Loss: 501.754 Vali Acc: 0.198 Test Loss: 501.754 Test Acc: 0.198
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 2193184
model size : 13.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.46909761428833
Epoch: 1, Steps: 17 | Train Loss: 30.980 Vali Loss: 43.282 Vali Acc: 0.251 Test Loss: 43.282 Test Acc: 0.251
Validation loss decreased (inf --> -0.250518).  Saving model ...
Epoch: 2 cost time: 2.4879753589630127
Epoch: 2, Steps: 17 | Train Loss: 36.533 Vali Loss: 52.695 Vali Acc: 0.251 Test Loss: 52.695 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3357017040252686
Epoch: 3, Steps: 17 | Train Loss: 62.728 Vali Loss: 38.831 Vali Acc: 0.247 Test Loss: 38.831 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3361082077026367
Epoch: 4, Steps: 17 | Train Loss: 73.036 Vali Loss: 125.083 Vali Acc: 0.270 Test Loss: 125.083 Test Acc: 0.270
Validation loss decreased (-0.250518 --> -0.268711).  Saving model ...
Epoch: 5 cost time: 2.5068492889404297
Epoch: 5, Steps: 17 | Train Loss: 98.949 Vali Loss: 183.880 Vali Acc: 0.255 Test Loss: 183.880 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4107680320739746
Epoch: 6, Steps: 17 | Train Loss: 134.319 Vali Loss: 64.917 Vali Acc: 0.289 Test Loss: 64.917 Test Acc: 0.289
Validation loss decreased (-0.268711 --> -0.288324).  Saving model ...
Epoch: 7 cost time: 2.1131887435913086
Epoch: 7, Steps: 17 | Train Loss: 81.949 Vali Loss: 95.158 Vali Acc: 0.270 Test Loss: 95.158 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2302520275115967
Epoch: 8, Steps: 17 | Train Loss: 59.344 Vali Loss: 100.614 Vali Acc: 0.274 Test Loss: 100.614 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3966517448425293
Epoch: 9, Steps: 17 | Train Loss: 67.789 Vali Loss: 153.055 Vali Acc: 0.266 Test Loss: 153.055 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.42975115776062
Epoch: 10, Steps: 17 | Train Loss: 84.722 Vali Loss: 199.899 Vali Acc: 0.266 Test Loss: 199.899 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.425236463546753
Epoch: 11, Steps: 17 | Train Loss: 82.204 Vali Loss: 322.961 Vali Acc: 0.278 Test Loss: 322.961 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.733168840408325
Epoch: 12, Steps: 17 | Train Loss: 97.539 Vali Loss: 220.655 Vali Acc: 0.240 Test Loss: 220.655 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.3607425689697266
Epoch: 13, Steps: 17 | Train Loss: 35.092 Vali Loss: 288.509 Vali Acc: 0.255 Test Loss: 288.509 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3732457160949707
Epoch: 14, Steps: 17 | Train Loss: 65.235 Vali Loss: 304.671 Vali Acc: 0.243 Test Loss: 304.671 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4636881351470947
Epoch: 15, Steps: 17 | Train Loss: 55.891 Vali Loss: 361.544 Vali Acc: 0.262 Test Loss: 361.544 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.4850516319274902
Epoch: 16, Steps: 17 | Train Loss: 28.184 Vali Loss: 366.539 Vali Acc: 0.224 Test Loss: 366.539 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 2193184
model size : 13.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.026211261749268
Epoch: 1, Steps: 17 | Train Loss: 19.820 Vali Loss: 55.675 Vali Acc: 0.259 Test Loss: 55.675 Test Acc: 0.259
Validation loss decreased (inf --> -0.257998).  Saving model ...
Epoch: 2 cost time: 2.961071014404297
Epoch: 2, Steps: 17 | Train Loss: 32.418 Vali Loss: 51.566 Vali Acc: 0.243 Test Loss: 51.566 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.300042152404785
Epoch: 3, Steps: 17 | Train Loss: 44.153 Vali Loss: 78.221 Vali Acc: 0.266 Test Loss: 78.221 Test Acc: 0.266
Validation loss decreased (-0.257998 --> -0.265377).  Saving model ...
Epoch: 4 cost time: 3.3121023178100586
Epoch: 4, Steps: 17 | Train Loss: 69.167 Vali Loss: 104.483 Vali Acc: 0.251 Test Loss: 104.483 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.132528781890869
Epoch: 5, Steps: 17 | Train Loss: 113.600 Vali Loss: 147.618 Vali Acc: 0.247 Test Loss: 147.618 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4954726696014404
Epoch: 6, Steps: 17 | Train Loss: 111.244 Vali Loss: 157.749 Vali Acc: 0.266 Test Loss: 157.749 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2178664207458496
Epoch: 7, Steps: 17 | Train Loss: 117.474 Vali Loss: 103.977 Vali Acc: 0.236 Test Loss: 103.977 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.4341607093811035
Epoch: 8, Steps: 17 | Train Loss: 108.081 Vali Loss: 159.781 Vali Acc: 0.213 Test Loss: 159.781 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.4458212852478027
Epoch: 9, Steps: 17 | Train Loss: 50.804 Vali Loss: 140.376 Vali Acc: 0.243 Test Loss: 140.376 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.2830393314361572
Epoch: 10, Steps: 17 | Train Loss: 66.972 Vali Loss: 209.674 Vali Acc: 0.259 Test Loss: 209.674 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9389443397521973
Epoch: 11, Steps: 17 | Train Loss: 97.387 Vali Loss: 203.511 Vali Acc: 0.243 Test Loss: 203.511 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.0803139209747314
Epoch: 12, Steps: 17 | Train Loss: 67.369 Vali Loss: 229.597 Vali Acc: 0.278 Test Loss: 229.597 Test Acc: 0.278
Validation loss decreased (-0.265377 --> -0.275271).  Saving model ...
Epoch: 13 cost time: 3.0214147567749023
Epoch: 13, Steps: 17 | Train Loss: 60.653 Vali Loss: 242.648 Vali Acc: 0.247 Test Loss: 242.648 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4193601608276367
Epoch: 14, Steps: 17 | Train Loss: 52.625 Vali Loss: 262.689 Vali Acc: 0.259 Test Loss: 262.689 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4294593334198
Epoch: 15, Steps: 17 | Train Loss: 23.456 Vali Loss: 256.320 Vali Acc: 0.247 Test Loss: 256.320 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.3994312286376953
Epoch: 16, Steps: 17 | Train Loss: 41.956 Vali Loss: 286.979 Vali Acc: 0.262 Test Loss: 286.979 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.5533673763275146
Epoch: 17, Steps: 17 | Train Loss: 24.514 Vali Loss: 332.808 Vali Acc: 0.259 Test Loss: 332.808 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.298030376434326
Epoch: 18, Steps: 17 | Train Loss: 30.608 Vali Loss: 385.428 Vali Acc: 0.270 Test Loss: 385.428 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.250655174255371
Epoch: 19, Steps: 17 | Train Loss: 31.124 Vali Loss: 365.578 Vali Acc: 0.259 Test Loss: 365.578 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.2187998294830322
Epoch: 20, Steps: 17 | Train Loss: 24.921 Vali Loss: 412.556 Vali Acc: 0.228 Test Loss: 412.556 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.3533756732940674
Epoch: 21, Steps: 17 | Train Loss: 21.506 Vali Loss: 449.897 Vali Acc: 0.278 Test Loss: 449.897 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.358961582183838
Epoch: 22, Steps: 17 | Train Loss: 41.760 Vali Loss: 614.423 Vali Acc: 0.274 Test Loss: 614.423 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 2062112
model size : 12.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.180319786071777
Epoch: 1, Steps: 17 | Train Loss: 19.994 Vali Loss: 23.495 Vali Acc: 0.255 Test Loss: 23.495 Test Acc: 0.255
Validation loss decreased (inf --> -0.254518).  Saving model ...
Epoch: 2 cost time: 2.543476104736328
Epoch: 2, Steps: 17 | Train Loss: 34.158 Vali Loss: 76.795 Vali Acc: 0.247 Test Loss: 76.795 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5509562492370605
Epoch: 3, Steps: 17 | Train Loss: 65.079 Vali Loss: 94.663 Vali Acc: 0.236 Test Loss: 94.663 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5592310428619385
Epoch: 4, Steps: 17 | Train Loss: 62.765 Vali Loss: 138.415 Vali Acc: 0.262 Test Loss: 138.415 Test Acc: 0.262
Validation loss decreased (-0.254518 --> -0.260973).  Saving model ...
Epoch: 5 cost time: 2.522432327270508
Epoch: 5, Steps: 17 | Train Loss: 81.044 Vali Loss: 228.196 Vali Acc: 0.243 Test Loss: 228.196 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4564924240112305
Epoch: 6, Steps: 17 | Train Loss: 95.431 Vali Loss: 87.233 Vali Acc: 0.274 Test Loss: 87.233 Test Acc: 0.274
Validation loss decreased (-0.260973 --> -0.272892).  Saving model ...
Epoch: 7 cost time: 2.542781352996826
Epoch: 7, Steps: 17 | Train Loss: 58.185 Vali Loss: 125.242 Vali Acc: 0.259 Test Loss: 125.242 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7243854999542236
Epoch: 8, Steps: 17 | Train Loss: 84.308 Vali Loss: 109.087 Vali Acc: 0.255 Test Loss: 109.087 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8140125274658203
Epoch: 9, Steps: 17 | Train Loss: 77.304 Vali Loss: 129.062 Vali Acc: 0.281 Test Loss: 129.062 Test Acc: 0.281
Validation loss decreased (-0.272892 --> -0.280078).  Saving model ...
Epoch: 10 cost time: 2.6808323860168457
Epoch: 10, Steps: 17 | Train Loss: 59.940 Vali Loss: 96.614 Vali Acc: 0.259 Test Loss: 96.614 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8214173316955566
Epoch: 11, Steps: 17 | Train Loss: 36.180 Vali Loss: 110.925 Vali Acc: 0.281 Test Loss: 110.925 Test Acc: 0.281
Validation loss decreased (-0.280078 --> -0.280260).  Saving model ...
Epoch: 12 cost time: 2.940000534057617
Epoch: 12, Steps: 17 | Train Loss: 38.370 Vali Loss: 116.239 Vali Acc: 0.281 Test Loss: 116.239 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6758453845977783
Epoch: 13, Steps: 17 | Train Loss: 53.632 Vali Loss: 164.661 Vali Acc: 0.243 Test Loss: 164.661 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.643239974975586
Epoch: 14, Steps: 17 | Train Loss: 50.206 Vali Loss: 228.424 Vali Acc: 0.251 Test Loss: 228.424 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.8518848419189453
Epoch: 15, Steps: 17 | Train Loss: 44.798 Vali Loss: 291.326 Vali Acc: 0.278 Test Loss: 291.326 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5332319736480713
Epoch: 16, Steps: 17 | Train Loss: 41.899 Vali Loss: 265.849 Vali Acc: 0.243 Test Loss: 265.849 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.612705945968628
Epoch: 17, Steps: 17 | Train Loss: 32.013 Vali Loss: 326.279 Vali Acc: 0.255 Test Loss: 326.279 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.535085916519165
Epoch: 18, Steps: 17 | Train Loss: 35.336 Vali Loss: 341.764 Vali Acc: 0.213 Test Loss: 341.764 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.605058193206787
Epoch: 19, Steps: 17 | Train Loss: 17.718 Vali Loss: 353.159 Vali Acc: 0.255 Test Loss: 353.159 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.733720064163208
Epoch: 20, Steps: 17 | Train Loss: 15.942 Vali Loss: 401.551 Vali Acc: 0.232 Test Loss: 401.551 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.783633232116699
Epoch: 21, Steps: 17 | Train Loss: 20.764 Vali Loss: 430.185 Vali Acc: 0.251 Test Loss: 430.185 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 2062112
model size : 12.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.269765138626099
Epoch: 1, Steps: 17 | Train Loss: 23.222 Vali Loss: 57.051 Vali Acc: 0.251 Test Loss: 57.051 Test Acc: 0.251
Validation loss decreased (inf --> -0.250380).  Saving model ...
Epoch: 2 cost time: 2.2130374908447266
Epoch: 2, Steps: 17 | Train Loss: 40.959 Vali Loss: 61.863 Vali Acc: 0.251 Test Loss: 61.863 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.304455280303955
Epoch: 3, Steps: 17 | Train Loss: 76.259 Vali Loss: 135.387 Vali Acc: 0.247 Test Loss: 135.387 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4340314865112305
Epoch: 4, Steps: 17 | Train Loss: 72.496 Vali Loss: 93.162 Vali Acc: 0.274 Test Loss: 93.162 Test Acc: 0.274
Validation loss decreased (-0.250380 --> -0.272833).  Saving model ...
Epoch: 5 cost time: 2.4476633071899414
Epoch: 5, Steps: 17 | Train Loss: 61.420 Vali Loss: 135.008 Vali Acc: 0.243 Test Loss: 135.008 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3723039627075195
Epoch: 6, Steps: 17 | Train Loss: 96.362 Vali Loss: 67.808 Vali Acc: 0.259 Test Loss: 67.808 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4555275440216064
Epoch: 7, Steps: 17 | Train Loss: 49.212 Vali Loss: 125.220 Vali Acc: 0.259 Test Loss: 125.220 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3196465969085693
Epoch: 8, Steps: 17 | Train Loss: 75.891 Vali Loss: 144.841 Vali Acc: 0.247 Test Loss: 144.841 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.242751121520996
Epoch: 9, Steps: 17 | Train Loss: 44.530 Vali Loss: 128.304 Vali Acc: 0.251 Test Loss: 128.304 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3410308361053467
Epoch: 10, Steps: 17 | Train Loss: 53.469 Vali Loss: 208.744 Vali Acc: 0.262 Test Loss: 208.744 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.3338980674743652
Epoch: 11, Steps: 17 | Train Loss: 67.936 Vali Loss: 182.259 Vali Acc: 0.251 Test Loss: 182.259 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.293921709060669
Epoch: 12, Steps: 17 | Train Loss: 49.082 Vali Loss: 201.718 Vali Acc: 0.247 Test Loss: 201.718 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.264148712158203
Epoch: 13, Steps: 17 | Train Loss: 37.128 Vali Loss: 280.221 Vali Acc: 0.247 Test Loss: 280.221 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.516981840133667
Epoch: 14, Steps: 17 | Train Loss: 40.974 Vali Loss: 275.489 Vali Acc: 0.232 Test Loss: 275.489 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 2062112
model size : 12.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.191735744476318
Epoch: 1, Steps: 17 | Train Loss: 18.083 Vali Loss: 49.124 Vali Acc: 0.262 Test Loss: 49.124 Test Acc: 0.262
Validation loss decreased (inf --> -0.261866).  Saving model ...
Epoch: 2 cost time: 2.2183594703674316
Epoch: 2, Steps: 17 | Train Loss: 31.070 Vali Loss: 37.610 Vali Acc: 0.255 Test Loss: 37.610 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.828392505645752
Epoch: 3, Steps: 17 | Train Loss: 34.944 Vali Loss: 51.841 Vali Acc: 0.236 Test Loss: 51.841 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2836272716522217
Epoch: 4, Steps: 17 | Train Loss: 54.401 Vali Loss: 68.983 Vali Acc: 0.251 Test Loss: 68.983 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.256772518157959
Epoch: 5, Steps: 17 | Train Loss: 53.198 Vali Loss: 124.070 Vali Acc: 0.251 Test Loss: 124.070 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.195679187774658
Epoch: 6, Steps: 17 | Train Loss: 106.276 Vali Loss: 120.479 Vali Acc: 0.266 Test Loss: 120.479 Test Acc: 0.266
Validation loss decreased (-0.261866 --> -0.264955).  Saving model ...
Epoch: 7 cost time: 2.4792068004608154
Epoch: 7, Steps: 17 | Train Loss: 91.533 Vali Loss: 69.529 Vali Acc: 0.266 Test Loss: 69.529 Test Acc: 0.266
Validation loss decreased (-0.264955 --> -0.265464).  Saving model ...
Epoch: 8 cost time: 2.3063693046569824
Epoch: 8, Steps: 17 | Train Loss: 48.640 Vali Loss: 209.374 Vali Acc: 0.251 Test Loss: 209.374 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.461996078491211
Epoch: 9, Steps: 17 | Train Loss: 94.424 Vali Loss: 115.762 Vali Acc: 0.240 Test Loss: 115.762 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.268401622772217
Epoch: 10, Steps: 17 | Train Loss: 53.556 Vali Loss: 151.138 Vali Acc: 0.262 Test Loss: 151.138 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2650415897369385
Epoch: 11, Steps: 17 | Train Loss: 42.022 Vali Loss: 193.460 Vali Acc: 0.251 Test Loss: 193.460 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2436115741729736
Epoch: 12, Steps: 17 | Train Loss: 37.238 Vali Loss: 168.339 Vali Acc: 0.255 Test Loss: 168.339 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5516326427459717
Epoch: 13, Steps: 17 | Train Loss: 29.619 Vali Loss: 227.065 Vali Acc: 0.236 Test Loss: 227.065 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.47029447555542
Epoch: 14, Steps: 17 | Train Loss: 35.650 Vali Loss: 246.414 Vali Acc: 0.262 Test Loss: 246.414 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3323545455932617
Epoch: 15, Steps: 17 | Train Loss: 55.346 Vali Loss: 269.561 Vali Acc: 0.255 Test Loss: 269.561 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.236475706100464
Epoch: 16, Steps: 17 | Train Loss: 33.540 Vali Loss: 309.440 Vali Acc: 0.255 Test Loss: 309.440 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9130864143371582
Epoch: 17, Steps: 17 | Train Loss: 18.816 Vali Loss: 337.975 Vali Acc: 0.247 Test Loss: 337.975 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 2062112
model size : 12.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.072639226913452
Epoch: 1, Steps: 17 | Train Loss: 48.503 Vali Loss: 90.090 Vali Acc: 0.247 Test Loss: 90.090 Test Acc: 0.247
Validation loss decreased (inf --> -0.246247).  Saving model ...
Epoch: 2 cost time: 2.446824550628662
Epoch: 2, Steps: 17 | Train Loss: 95.779 Vali Loss: 158.547 Vali Acc: 0.247 Test Loss: 158.547 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.42232346534729
Epoch: 3, Steps: 17 | Train Loss: 73.813 Vali Loss: 125.936 Vali Acc: 0.232 Test Loss: 125.936 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.425017833709717
Epoch: 4, Steps: 17 | Train Loss: 93.922 Vali Loss: 73.951 Vali Acc: 0.221 Test Loss: 73.951 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.790846347808838
Epoch: 5, Steps: 17 | Train Loss: 60.134 Vali Loss: 122.317 Vali Acc: 0.266 Test Loss: 122.317 Test Acc: 0.266
Validation loss decreased (-0.246247 --> -0.264937).  Saving model ...
Epoch: 6 cost time: 2.686065196990967
Epoch: 6, Steps: 17 | Train Loss: 98.630 Vali Loss: 119.027 Vali Acc: 0.255 Test Loss: 119.027 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5948903560638428
Epoch: 7, Steps: 17 | Train Loss: 132.133 Vali Loss: 133.910 Vali Acc: 0.259 Test Loss: 133.910 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8453304767608643
Epoch: 8, Steps: 17 | Train Loss: 77.156 Vali Loss: 113.503 Vali Acc: 0.251 Test Loss: 113.503 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.556056499481201
Epoch: 9, Steps: 17 | Train Loss: 92.203 Vali Loss: 169.409 Vali Acc: 0.270 Test Loss: 169.409 Test Acc: 0.270
Validation loss decreased (-0.264937 --> -0.268268).  Saving model ...
Epoch: 10 cost time: 2.5410420894622803
Epoch: 10, Steps: 17 | Train Loss: 73.410 Vali Loss: 196.250 Vali Acc: 0.232 Test Loss: 196.250 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5843701362609863
Epoch: 11, Steps: 17 | Train Loss: 96.741 Vali Loss: 151.782 Vali Acc: 0.278 Test Loss: 151.782 Test Acc: 0.278
Validation loss decreased (-0.268268 --> -0.276049).  Saving model ...
Epoch: 12 cost time: 2.644822835922241
Epoch: 12, Steps: 17 | Train Loss: 43.509 Vali Loss: 130.350 Vali Acc: 0.262 Test Loss: 130.350 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5600368976593018
Epoch: 13, Steps: 17 | Train Loss: 38.913 Vali Loss: 176.921 Vali Acc: 0.259 Test Loss: 176.921 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.802319049835205
Epoch: 14, Steps: 17 | Train Loss: 33.826 Vali Loss: 202.509 Vali Acc: 0.289 Test Loss: 202.509 Test Acc: 0.289
Validation loss decreased (-0.276049 --> -0.286948).  Saving model ...
Epoch: 15 cost time: 2.462181806564331
Epoch: 15, Steps: 17 | Train Loss: 89.508 Vali Loss: 280.601 Vali Acc: 0.228 Test Loss: 280.601 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.880354166030884
Epoch: 16, Steps: 17 | Train Loss: 24.935 Vali Loss: 307.516 Vali Acc: 0.243 Test Loss: 307.516 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9271199703216553
Epoch: 17, Steps: 17 | Train Loss: 30.578 Vali Loss: 301.185 Vali Acc: 0.274 Test Loss: 301.185 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8206756114959717
Epoch: 18, Steps: 17 | Train Loss: 31.149 Vali Loss: 363.982 Vali Acc: 0.266 Test Loss: 363.982 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.6798782348632812
Epoch: 19, Steps: 17 | Train Loss: 17.041 Vali Loss: 425.617 Vali Acc: 0.251 Test Loss: 425.617 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.8695902824401855
Epoch: 20, Steps: 17 | Train Loss: 56.837 Vali Loss: 510.094 Vali Acc: 0.240 Test Loss: 510.094 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.766792058944702
Epoch: 21, Steps: 17 | Train Loss: 27.751 Vali Loss: 544.040 Vali Acc: 0.259 Test Loss: 544.040 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.6266467571258545
Epoch: 22, Steps: 17 | Train Loss: 15.082 Vali Loss: 596.722 Vali Acc: 0.262 Test Loss: 596.722 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.6775968074798584
Epoch: 23, Steps: 17 | Train Loss: 35.002 Vali Loss: 663.146 Vali Acc: 0.255 Test Loss: 663.146 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.9805097579956055
Epoch: 24, Steps: 17 | Train Loss: 25.735 Vali Loss: 660.928 Vali Acc: 0.247 Test Loss: 660.928 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1996576
model size : 12.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.352308034896851
Epoch: 1, Steps: 17 | Train Loss: 44.343 Vali Loss: 69.994 Vali Acc: 0.243 Test Loss: 69.994 Test Acc: 0.243
Validation loss decreased (inf --> -0.242646).  Saving model ...
Epoch: 2 cost time: 2.464606285095215
Epoch: 2, Steps: 17 | Train Loss: 103.749 Vali Loss: 135.382 Vali Acc: 0.247 Test Loss: 135.382 Test Acc: 0.247
Validation loss decreased (-0.242646 --> -0.245794).  Saving model ...
Epoch: 3 cost time: 2.510967969894409
Epoch: 3, Steps: 17 | Train Loss: 58.292 Vali Loss: 56.605 Vali Acc: 0.236 Test Loss: 56.605 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.497079610824585
Epoch: 4, Steps: 17 | Train Loss: 71.582 Vali Loss: 57.832 Vali Acc: 0.232 Test Loss: 57.832 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3234775066375732
Epoch: 5, Steps: 17 | Train Loss: 62.631 Vali Loss: 67.216 Vali Acc: 0.270 Test Loss: 67.216 Test Acc: 0.270
Validation loss decreased (-0.245794 --> -0.269290).  Saving model ...
Epoch: 6 cost time: 2.356454372406006
Epoch: 6, Steps: 17 | Train Loss: 89.535 Vali Loss: 106.041 Vali Acc: 0.289 Test Loss: 106.041 Test Acc: 0.289
Validation loss decreased (-0.269290 --> -0.287913).  Saving model ...
Epoch: 7 cost time: 2.613849639892578
Epoch: 7, Steps: 17 | Train Loss: 104.967 Vali Loss: 77.395 Vali Acc: 0.259 Test Loss: 77.395 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6598856449127197
Epoch: 8, Steps: 17 | Train Loss: 52.157 Vali Loss: 77.405 Vali Acc: 0.285 Test Loss: 77.405 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6280486583709717
Epoch: 9, Steps: 17 | Train Loss: 49.339 Vali Loss: 126.642 Vali Acc: 0.278 Test Loss: 126.642 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8532490730285645
Epoch: 10, Steps: 17 | Train Loss: 82.048 Vali Loss: 185.299 Vali Acc: 0.266 Test Loss: 185.299 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.564680337905884
Epoch: 11, Steps: 17 | Train Loss: 61.108 Vali Loss: 264.877 Vali Acc: 0.278 Test Loss: 264.877 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6447601318359375
Epoch: 12, Steps: 17 | Train Loss: 36.892 Vali Loss: 189.637 Vali Acc: 0.274 Test Loss: 189.637 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.703826665878296
Epoch: 13, Steps: 17 | Train Loss: 42.047 Vali Loss: 253.726 Vali Acc: 0.259 Test Loss: 253.726 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.4331471920013428
Epoch: 14, Steps: 17 | Train Loss: 43.603 Vali Loss: 306.507 Vali Acc: 0.262 Test Loss: 306.507 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.616605043411255
Epoch: 15, Steps: 17 | Train Loss: 58.526 Vali Loss: 283.114 Vali Acc: 0.240 Test Loss: 283.114 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.698789119720459
Epoch: 16, Steps: 17 | Train Loss: 30.913 Vali Loss: 275.275 Vali Acc: 0.255 Test Loss: 275.275 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1996576
model size : 12.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.331141710281372
Epoch: 1, Steps: 17 | Train Loss: 33.559 Vali Loss: 84.144 Vali Acc: 0.251 Test Loss: 84.144 Test Acc: 0.251
Validation loss decreased (inf --> -0.250109).  Saving model ...
Epoch: 2 cost time: 2.115299940109253
Epoch: 2, Steps: 17 | Train Loss: 56.108 Vali Loss: 67.030 Vali Acc: 0.247 Test Loss: 67.030 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2555840015411377
Epoch: 3, Steps: 17 | Train Loss: 66.412 Vali Loss: 123.481 Vali Acc: 0.251 Test Loss: 123.481 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5175600051879883
Epoch: 4, Steps: 17 | Train Loss: 83.767 Vali Loss: 126.965 Vali Acc: 0.243 Test Loss: 126.965 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3189151287078857
Epoch: 5, Steps: 17 | Train Loss: 67.376 Vali Loss: 89.386 Vali Acc: 0.236 Test Loss: 89.386 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3119983673095703
Epoch: 6, Steps: 17 | Train Loss: 60.681 Vali Loss: 81.633 Vali Acc: 0.228 Test Loss: 81.633 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.324882984161377
Epoch: 7, Steps: 17 | Train Loss: 97.873 Vali Loss: 242.461 Vali Acc: 0.255 Test Loss: 242.461 Test Acc: 0.255
Validation loss decreased (-0.250109 --> -0.252328).  Saving model ...
Epoch: 8 cost time: 2.4554641246795654
Epoch: 8, Steps: 17 | Train Loss: 102.412 Vali Loss: 182.457 Vali Acc: 0.240 Test Loss: 182.457 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.543617010116577
Epoch: 9, Steps: 17 | Train Loss: 76.395 Vali Loss: 101.977 Vali Acc: 0.247 Test Loss: 101.977 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3990602493286133
Epoch: 10, Steps: 17 | Train Loss: 53.686 Vali Loss: 115.640 Vali Acc: 0.266 Test Loss: 115.640 Test Acc: 0.266
Validation loss decreased (-0.252328 --> -0.265003).  Saving model ...
Epoch: 11 cost time: 2.56969952583313
Epoch: 11, Steps: 17 | Train Loss: 28.892 Vali Loss: 218.508 Vali Acc: 0.270 Test Loss: 218.508 Test Acc: 0.270
Validation loss decreased (-0.265003 --> -0.267777).  Saving model ...
Epoch: 12 cost time: 2.3145220279693604
Epoch: 12, Steps: 17 | Train Loss: 32.076 Vali Loss: 159.649 Vali Acc: 0.278 Test Loss: 159.649 Test Acc: 0.278
Validation loss decreased (-0.267777 --> -0.275970).  Saving model ...
Epoch: 13 cost time: 2.207418441772461
Epoch: 13, Steps: 17 | Train Loss: 29.406 Vali Loss: 193.770 Vali Acc: 0.232 Test Loss: 193.770 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3758556842803955
Epoch: 14, Steps: 17 | Train Loss: 51.024 Vali Loss: 344.011 Vali Acc: 0.243 Test Loss: 344.011 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4286906719207764
Epoch: 15, Steps: 17 | Train Loss: 62.434 Vali Loss: 329.738 Vali Acc: 0.228 Test Loss: 329.738 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.562819004058838
Epoch: 16, Steps: 17 | Train Loss: 32.767 Vali Loss: 365.030 Vali Acc: 0.228 Test Loss: 365.030 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2847800254821777
Epoch: 17, Steps: 17 | Train Loss: 40.859 Vali Loss: 406.679 Vali Acc: 0.243 Test Loss: 406.679 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.581674098968506
Epoch: 18, Steps: 17 | Train Loss: 26.450 Vali Loss: 377.956 Vali Acc: 0.228 Test Loss: 377.956 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.692464590072632
Epoch: 19, Steps: 17 | Train Loss: 20.308 Vali Loss: 474.512 Vali Acc: 0.240 Test Loss: 474.512 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.5872256755828857
Epoch: 20, Steps: 17 | Train Loss: 23.312 Vali Loss: 452.784 Vali Acc: 0.240 Test Loss: 452.784 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3245062828063965
Epoch: 21, Steps: 17 | Train Loss: 18.219 Vali Loss: 541.331 Vali Acc: 0.255 Test Loss: 541.331 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.5091564655303955
Epoch: 22, Steps: 17 | Train Loss: 24.349 Vali Loss: 555.338 Vali Acc: 0.240 Test Loss: 555.338 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 1996576
model size : 12.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.045725345611572
Epoch: 1, Steps: 17 | Train Loss: 21.689 Vali Loss: 69.635 Vali Acc: 0.251 Test Loss: 69.635 Test Acc: 0.251
Validation loss decreased (inf --> -0.250254).  Saving model ...
Epoch: 2 cost time: 2.1206271648406982
Epoch: 2, Steps: 17 | Train Loss: 74.708 Vali Loss: 111.048 Vali Acc: 0.247 Test Loss: 111.048 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0493359565734863
Epoch: 3, Steps: 17 | Train Loss: 89.155 Vali Loss: 85.551 Vali Acc: 0.266 Test Loss: 85.551 Test Acc: 0.266
Validation loss decreased (-0.250254 --> -0.265304).  Saving model ...
Epoch: 4 cost time: 2.048009157180786
Epoch: 4, Steps: 17 | Train Loss: 92.718 Vali Loss: 58.749 Vali Acc: 0.240 Test Loss: 58.749 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.204603672027588
Epoch: 5, Steps: 17 | Train Loss: 74.041 Vali Loss: 126.395 Vali Acc: 0.243 Test Loss: 126.395 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.263388156890869
Epoch: 6, Steps: 17 | Train Loss: 97.268 Vali Loss: 85.604 Vali Acc: 0.240 Test Loss: 85.604 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1910879611968994
Epoch: 7, Steps: 17 | Train Loss: 92.484 Vali Loss: 201.905 Vali Acc: 0.247 Test Loss: 201.905 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0652568340301514
Epoch: 8, Steps: 17 | Train Loss: 119.572 Vali Loss: 167.352 Vali Acc: 0.262 Test Loss: 167.352 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.327573537826538
Epoch: 9, Steps: 17 | Train Loss: 114.948 Vali Loss: 153.472 Vali Acc: 0.285 Test Loss: 153.472 Test Acc: 0.285
Validation loss decreased (-0.265304 --> -0.283636).  Saving model ...
Epoch: 10 cost time: 2.0170717239379883
Epoch: 10, Steps: 17 | Train Loss: 64.261 Vali Loss: 230.876 Vali Acc: 0.255 Test Loss: 230.876 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.152120351791382
Epoch: 11, Steps: 17 | Train Loss: 47.255 Vali Loss: 161.567 Vali Acc: 0.228 Test Loss: 161.567 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.197453737258911
Epoch: 12, Steps: 17 | Train Loss: 78.621 Vali Loss: 285.461 Vali Acc: 0.270 Test Loss: 285.461 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.158935070037842
Epoch: 13, Steps: 17 | Train Loss: 69.681 Vali Loss: 249.502 Vali Acc: 0.270 Test Loss: 249.502 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.106172800064087
Epoch: 14, Steps: 17 | Train Loss: 29.185 Vali Loss: 310.415 Vali Acc: 0.251 Test Loss: 310.415 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0436294078826904
Epoch: 15, Steps: 17 | Train Loss: 41.724 Vali Loss: 278.448 Vali Acc: 0.251 Test Loss: 278.448 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.22967529296875
Epoch: 16, Steps: 17 | Train Loss: 25.448 Vali Loss: 347.226 Vali Acc: 0.243 Test Loss: 347.226 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.2341549396514893
Epoch: 17, Steps: 17 | Train Loss: 17.103 Vali Loss: 366.369 Vali Acc: 0.217 Test Loss: 366.369 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.108487129211426
Epoch: 18, Steps: 17 | Train Loss: 19.346 Vali Loss: 404.229 Vali Acc: 0.243 Test Loss: 404.229 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0100104808807373
Epoch: 19, Steps: 17 | Train Loss: 23.731 Vali Loss: 474.549 Vali Acc: 0.217 Test Loss: 474.549 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1996576
model size : 12.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.630807399749756
Epoch: 1, Steps: 17 | Train Loss: 31.273 Vali Loss: 118.225 Vali Acc: 0.247 Test Loss: 118.225 Test Acc: 0.247
Validation loss decreased (inf --> -0.245966).  Saving model ...
Epoch: 2 cost time: 2.8229119777679443
Epoch: 2, Steps: 17 | Train Loss: 70.255 Vali Loss: 44.450 Vali Acc: 0.209 Test Loss: 44.450 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.804141044616699
Epoch: 3, Steps: 17 | Train Loss: 42.928 Vali Loss: 87.657 Vali Acc: 0.255 Test Loss: 87.657 Test Acc: 0.255
Validation loss decreased (-0.245966 --> -0.253876).  Saving model ...
Epoch: 4 cost time: 2.725517988204956
Epoch: 4, Steps: 17 | Train Loss: 80.475 Vali Loss: 127.926 Vali Acc: 0.228 Test Loss: 127.926 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8368210792541504
Epoch: 5, Steps: 17 | Train Loss: 106.694 Vali Loss: 80.926 Vali Acc: 0.247 Test Loss: 80.926 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0504446029663086
Epoch: 6, Steps: 17 | Train Loss: 74.170 Vali Loss: 100.632 Vali Acc: 0.247 Test Loss: 100.632 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.836348056793213
Epoch: 7, Steps: 17 | Train Loss: 71.769 Vali Loss: 107.117 Vali Acc: 0.228 Test Loss: 107.117 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.170161247253418
Epoch: 8, Steps: 17 | Train Loss: 98.717 Vali Loss: 342.833 Vali Acc: 0.251 Test Loss: 342.833 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.58620285987854
Epoch: 9, Steps: 17 | Train Loss: 131.237 Vali Loss: 134.442 Vali Acc: 0.251 Test Loss: 134.442 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.981537103652954
Epoch: 10, Steps: 17 | Train Loss: 102.476 Vali Loss: 168.034 Vali Acc: 0.281 Test Loss: 168.034 Test Acc: 0.281
Validation loss decreased (-0.253876 --> -0.279688).  Saving model ...
Epoch: 11 cost time: 2.871331214904785
Epoch: 11, Steps: 17 | Train Loss: 75.761 Vali Loss: 221.259 Vali Acc: 0.240 Test Loss: 221.259 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.965759515762329
Epoch: 12, Steps: 17 | Train Loss: 56.410 Vali Loss: 142.453 Vali Acc: 0.278 Test Loss: 142.453 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1502327919006348
Epoch: 13, Steps: 17 | Train Loss: 24.453 Vali Loss: 276.785 Vali Acc: 0.251 Test Loss: 276.785 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9715723991394043
Epoch: 14, Steps: 17 | Train Loss: 64.078 Vali Loss: 213.433 Vali Acc: 0.300 Test Loss: 213.433 Test Acc: 0.300
Validation loss decreased (-0.279688 --> -0.298246).  Saving model ...
Epoch: 15 cost time: 2.958865165710449
Epoch: 15, Steps: 17 | Train Loss: 30.158 Vali Loss: 225.386 Vali Acc: 0.259 Test Loss: 225.386 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.12021803855896
Epoch: 16, Steps: 17 | Train Loss: 76.166 Vali Loss: 382.635 Vali Acc: 0.270 Test Loss: 382.635 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.094660997390747
Epoch: 17, Steps: 17 | Train Loss: 34.966 Vali Loss: 396.889 Vali Acc: 0.270 Test Loss: 396.889 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.027980327606201
Epoch: 18, Steps: 17 | Train Loss: 70.352 Vali Loss: 438.113 Vali Acc: 0.236 Test Loss: 438.113 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.8675894737243652
Epoch: 19, Steps: 17 | Train Loss: 30.740 Vali Loss: 441.561 Vali Acc: 0.266 Test Loss: 441.561 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.094254970550537
Epoch: 20, Steps: 17 | Train Loss: 36.912 Vali Loss: 447.593 Vali Acc: 0.247 Test Loss: 447.593 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.0026488304138184
Epoch: 21, Steps: 17 | Train Loss: 42.185 Vali Loss: 506.484 Vali Acc: 0.243 Test Loss: 506.484 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.0739822387695312
Epoch: 22, Steps: 17 | Train Loss: 18.755 Vali Loss: 521.347 Vali Acc: 0.236 Test Loss: 521.347 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.15279221534729
Epoch: 23, Steps: 17 | Train Loss: 35.285 Vali Loss: 735.039 Vali Acc: 0.251 Test Loss: 735.039 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.0005831718444824
Epoch: 24, Steps: 17 | Train Loss: 33.049 Vali Loss: 661.817 Vali Acc: 0.232 Test Loss: 661.817 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 1963808
model size : 12.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.494019985198975
Epoch: 1, Steps: 17 | Train Loss: 27.540 Vali Loss: 63.077 Vali Acc: 0.247 Test Loss: 63.077 Test Acc: 0.247
Validation loss decreased (inf --> -0.246518).  Saving model ...
Epoch: 2 cost time: 2.4745733737945557
Epoch: 2, Steps: 17 | Train Loss: 48.483 Vali Loss: 45.738 Vali Acc: 0.243 Test Loss: 45.738 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5565333366394043
Epoch: 3, Steps: 17 | Train Loss: 98.644 Vali Loss: 75.971 Vali Acc: 0.262 Test Loss: 75.971 Test Acc: 0.262
Validation loss decreased (-0.246518 --> -0.261598).  Saving model ...
Epoch: 4 cost time: 2.6365549564361572
Epoch: 4, Steps: 17 | Train Loss: 99.594 Vali Loss: 121.564 Vali Acc: 0.251 Test Loss: 121.564 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5037269592285156
Epoch: 5, Steps: 17 | Train Loss: 97.345 Vali Loss: 202.665 Vali Acc: 0.236 Test Loss: 202.665 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.393589973449707
Epoch: 6, Steps: 17 | Train Loss: 87.489 Vali Loss: 71.252 Vali Acc: 0.224 Test Loss: 71.252 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5623128414154053
Epoch: 7, Steps: 17 | Train Loss: 98.538 Vali Loss: 67.305 Vali Acc: 0.274 Test Loss: 67.305 Test Acc: 0.274
Validation loss decreased (-0.261598 --> -0.273091).  Saving model ...
Epoch: 8 cost time: 2.4792733192443848
Epoch: 8, Steps: 17 | Train Loss: 56.298 Vali Loss: 86.281 Vali Acc: 0.236 Test Loss: 86.281 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4634625911712646
Epoch: 9, Steps: 17 | Train Loss: 50.401 Vali Loss: 111.587 Vali Acc: 0.281 Test Loss: 111.587 Test Acc: 0.281
Validation loss decreased (-0.273091 --> -0.280253).  Saving model ...
Epoch: 10 cost time: 2.556739568710327
Epoch: 10, Steps: 17 | Train Loss: 65.394 Vali Loss: 195.896 Vali Acc: 0.236 Test Loss: 195.896 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.401175022125244
Epoch: 11, Steps: 17 | Train Loss: 66.898 Vali Loss: 251.977 Vali Acc: 0.270 Test Loss: 251.977 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.487293004989624
Epoch: 12, Steps: 17 | Train Loss: 55.074 Vali Loss: 177.232 Vali Acc: 0.255 Test Loss: 177.232 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.666567325592041
Epoch: 13, Steps: 17 | Train Loss: 47.734 Vali Loss: 177.699 Vali Acc: 0.247 Test Loss: 177.699 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5563647747039795
Epoch: 14, Steps: 17 | Train Loss: 27.866 Vali Loss: 255.256 Vali Acc: 0.240 Test Loss: 255.256 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.466671943664551
Epoch: 15, Steps: 17 | Train Loss: 31.239 Vali Loss: 207.743 Vali Acc: 0.255 Test Loss: 207.743 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.546682834625244
Epoch: 16, Steps: 17 | Train Loss: 29.146 Vali Loss: 321.067 Vali Acc: 0.228 Test Loss: 321.067 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.470686435699463
Epoch: 17, Steps: 17 | Train Loss: 47.779 Vali Loss: 346.998 Vali Acc: 0.270 Test Loss: 346.998 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.409472703933716
Epoch: 18, Steps: 17 | Train Loss: 34.189 Vali Loss: 386.466 Vali Acc: 0.270 Test Loss: 386.466 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.5358316898345947
Epoch: 19, Steps: 17 | Train Loss: 25.658 Vali Loss: 377.392 Vali Acc: 0.247 Test Loss: 377.392 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1963808
model size : 12.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.9728381633758545
Epoch: 1, Steps: 17 | Train Loss: 26.330 Vali Loss: 52.181 Vali Acc: 0.259 Test Loss: 52.181 Test Acc: 0.259
Validation loss decreased (inf --> -0.258033).  Saving model ...
Epoch: 2 cost time: 1.9258537292480469
Epoch: 2, Steps: 17 | Train Loss: 38.592 Vali Loss: 51.564 Vali Acc: 0.293 Test Loss: 51.564 Test Acc: 0.293
Validation loss decreased (-0.258033 --> -0.292260).  Saving model ...
Epoch: 3 cost time: 2.135718584060669
Epoch: 3, Steps: 17 | Train Loss: 48.524 Vali Loss: 44.351 Vali Acc: 0.274 Test Loss: 44.351 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1901824474334717
Epoch: 4, Steps: 17 | Train Loss: 85.145 Vali Loss: 96.671 Vali Acc: 0.259 Test Loss: 96.671 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0903422832489014
Epoch: 5, Steps: 17 | Train Loss: 97.195 Vali Loss: 151.766 Vali Acc: 0.247 Test Loss: 151.766 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1410751342773438
Epoch: 6, Steps: 17 | Train Loss: 94.875 Vali Loss: 71.297 Vali Acc: 0.243 Test Loss: 71.297 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3565847873687744
Epoch: 7, Steps: 17 | Train Loss: 87.213 Vali Loss: 113.322 Vali Acc: 0.240 Test Loss: 113.322 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.2439537048339844
Epoch: 8, Steps: 17 | Train Loss: 66.041 Vali Loss: 117.088 Vali Acc: 0.243 Test Loss: 117.088 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.311689615249634
Epoch: 9, Steps: 17 | Train Loss: 70.788 Vali Loss: 151.797 Vali Acc: 0.262 Test Loss: 151.797 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.295325994491577
Epoch: 10, Steps: 17 | Train Loss: 60.990 Vali Loss: 135.060 Vali Acc: 0.243 Test Loss: 135.060 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.3343441486358643
Epoch: 11, Steps: 17 | Train Loss: 59.677 Vali Loss: 149.367 Vali Acc: 0.243 Test Loss: 149.367 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.2525930404663086
Epoch: 12, Steps: 17 | Train Loss: 58.776 Vali Loss: 184.212 Vali Acc: 0.224 Test Loss: 184.212 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 1963808
model size : 12.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.236538648605347
Epoch: 1, Steps: 17 | Train Loss: 19.080 Vali Loss: 75.462 Vali Acc: 0.251 Test Loss: 75.462 Test Acc: 0.251
Validation loss decreased (inf --> -0.250196).  Saving model ...
Epoch: 2 cost time: 1.8476650714874268
Epoch: 2, Steps: 17 | Train Loss: 71.865 Vali Loss: 95.519 Vali Acc: 0.259 Test Loss: 95.519 Test Acc: 0.259
Validation loss decreased (-0.250196 --> -0.257600).  Saving model ...
Epoch: 3 cost time: 2.3298258781433105
Epoch: 3, Steps: 17 | Train Loss: 65.777 Vali Loss: 101.222 Vali Acc: 0.259 Test Loss: 101.222 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.060868501663208
Epoch: 4, Steps: 17 | Train Loss: 73.523 Vali Loss: 73.318 Vali Acc: 0.270 Test Loss: 73.318 Test Acc: 0.270
Validation loss decreased (-0.257600 --> -0.269229).  Saving model ...
Epoch: 5 cost time: 2.008674383163452
Epoch: 5, Steps: 17 | Train Loss: 77.517 Vali Loss: 105.829 Vali Acc: 0.255 Test Loss: 105.829 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.133114814758301
Epoch: 6, Steps: 17 | Train Loss: 76.417 Vali Loss: 87.036 Vali Acc: 0.243 Test Loss: 87.036 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1065051555633545
Epoch: 7, Steps: 17 | Train Loss: 87.934 Vali Loss: 83.708 Vali Acc: 0.259 Test Loss: 83.708 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9605944156646729
Epoch: 8, Steps: 17 | Train Loss: 72.171 Vali Loss: 104.305 Vali Acc: 0.262 Test Loss: 104.305 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2151055335998535
Epoch: 9, Steps: 17 | Train Loss: 87.031 Vali Loss: 133.971 Vali Acc: 0.251 Test Loss: 133.971 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0028600692749023
Epoch: 10, Steps: 17 | Train Loss: 80.212 Vali Loss: 258.656 Vali Acc: 0.274 Test Loss: 258.656 Test Acc: 0.274
Validation loss decreased (-0.269229 --> -0.271178).  Saving model ...
Epoch: 11 cost time: 2.0231189727783203
Epoch: 11, Steps: 17 | Train Loss: 61.675 Vali Loss: 136.325 Vali Acc: 0.259 Test Loss: 136.325 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.078956127166748
Epoch: 12, Steps: 17 | Train Loss: 33.708 Vali Loss: 152.840 Vali Acc: 0.289 Test Loss: 152.840 Test Acc: 0.289
Validation loss decreased (-0.271178 --> -0.287445).  Saving model ...
Epoch: 13 cost time: 2.2083263397216797
Epoch: 13, Steps: 17 | Train Loss: 34.744 Vali Loss: 304.425 Vali Acc: 0.262 Test Loss: 304.425 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.091851234436035
Epoch: 14, Steps: 17 | Train Loss: 58.111 Vali Loss: 298.287 Vali Acc: 0.259 Test Loss: 298.287 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9478931427001953
Epoch: 15, Steps: 17 | Train Loss: 30.643 Vali Loss: 292.041 Vali Acc: 0.228 Test Loss: 292.041 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.23813796043396
Epoch: 16, Steps: 17 | Train Loss: 67.164 Vali Loss: 393.233 Vali Acc: 0.243 Test Loss: 393.233 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9696576595306396
Epoch: 17, Steps: 17 | Train Loss: 17.347 Vali Loss: 375.929 Vali Acc: 0.255 Test Loss: 375.929 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.0932164192199707
Epoch: 18, Steps: 17 | Train Loss: 28.613 Vali Loss: 512.145 Vali Acc: 0.251 Test Loss: 512.145 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9447920322418213
Epoch: 19, Steps: 17 | Train Loss: 29.087 Vali Loss: 542.370 Vali Acc: 0.270 Test Loss: 542.370 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.07783579826355
Epoch: 20, Steps: 17 | Train Loss: 8.958 Vali Loss: 506.420 Vali Acc: 0.247 Test Loss: 506.420 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.0505032539367676
Epoch: 21, Steps: 17 | Train Loss: 17.169 Vali Loss: 496.500 Vali Acc: 0.243 Test Loss: 496.500 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.170358419418335
Epoch: 22, Steps: 17 | Train Loss: 13.692 Vali Loss: 589.811 Vali Acc: 0.259 Test Loss: 589.811 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1963808
model size : 12.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.558584690093994
Epoch: 1, Steps: 17 | Train Loss: 19.100 Vali Loss: 21.086 Vali Acc: 0.259 Test Loss: 21.086 Test Acc: 0.259
Validation loss decreased (inf --> -0.258344).  Saving model ...
Epoch: 2 cost time: 2.1575005054473877
Epoch: 2, Steps: 17 | Train Loss: 16.803 Vali Loss: 45.013 Vali Acc: 0.247 Test Loss: 45.013 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0146422386169434
Epoch: 3, Steps: 17 | Train Loss: 36.357 Vali Loss: 54.396 Vali Acc: 0.243 Test Loss: 54.396 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2983152866363525
Epoch: 4, Steps: 17 | Train Loss: 38.557 Vali Loss: 69.777 Vali Acc: 0.259 Test Loss: 69.777 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1372501850128174
Epoch: 5, Steps: 17 | Train Loss: 31.662 Vali Loss: 59.348 Vali Acc: 0.217 Test Loss: 59.348 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.092039108276367
Epoch: 6, Steps: 17 | Train Loss: 38.796 Vali Loss: 55.015 Vali Acc: 0.259 Test Loss: 55.015 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0518009662628174
Epoch: 7, Steps: 17 | Train Loss: 39.344 Vali Loss: 109.209 Vali Acc: 0.255 Test Loss: 109.209 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.1558456420898438
Epoch: 8, Steps: 17 | Train Loss: 64.865 Vali Loss: 66.722 Vali Acc: 0.251 Test Loss: 66.722 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1477766036987305
Epoch: 9, Steps: 17 | Train Loss: 61.278 Vali Loss: 99.887 Vali Acc: 0.247 Test Loss: 99.887 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8298468589782715
Epoch: 10, Steps: 17 | Train Loss: 45.453 Vali Loss: 107.601 Vali Acc: 0.262 Test Loss: 107.601 Test Acc: 0.262
Validation loss decreased (-0.258344 --> -0.261281).  Saving model ...
Epoch: 11 cost time: 2.1462016105651855
Epoch: 11, Steps: 17 | Train Loss: 45.559 Vali Loss: 106.782 Vali Acc: 0.255 Test Loss: 106.782 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1470909118652344
Epoch: 12, Steps: 17 | Train Loss: 49.846 Vali Loss: 103.253 Vali Acc: 0.240 Test Loss: 103.253 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.039764404296875
Epoch: 13, Steps: 17 | Train Loss: 45.408 Vali Loss: 92.008 Vali Acc: 0.262 Test Loss: 92.008 Test Acc: 0.262
Validation loss decreased (-0.261281 --> -0.261437).  Saving model ...
Epoch: 14 cost time: 2.311568260192871
Epoch: 14, Steps: 17 | Train Loss: 31.603 Vali Loss: 105.251 Vali Acc: 0.278 Test Loss: 105.251 Test Acc: 0.278
Validation loss decreased (-0.261437 --> -0.276514).  Saving model ...
Epoch: 15 cost time: 2.1355273723602295
Epoch: 15, Steps: 17 | Train Loss: 36.755 Vali Loss: 86.278 Vali Acc: 0.243 Test Loss: 86.278 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1616640090942383
Epoch: 16, Steps: 17 | Train Loss: 20.093 Vali Loss: 114.151 Vali Acc: 0.243 Test Loss: 114.151 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.163656711578369
Epoch: 17, Steps: 17 | Train Loss: 24.073 Vali Loss: 109.022 Vali Acc: 0.266 Test Loss: 109.022 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9967679977416992
Epoch: 18, Steps: 17 | Train Loss: 22.756 Vali Loss: 108.809 Vali Acc: 0.259 Test Loss: 108.809 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0093166828155518
Epoch: 19, Steps: 17 | Train Loss: 13.551 Vali Loss: 103.012 Vali Acc: 0.297 Test Loss: 103.012 Test Acc: 0.297
Validation loss decreased (-0.276514 --> -0.295548).  Saving model ...
Epoch: 20 cost time: 2.0606961250305176
Epoch: 20, Steps: 17 | Train Loss: 26.378 Vali Loss: 225.903 Vali Acc: 0.266 Test Loss: 225.903 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1451940536499023
Epoch: 21, Steps: 17 | Train Loss: 35.485 Vali Loss: 177.439 Vali Acc: 0.262 Test Loss: 177.439 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.155818223953247
Epoch: 22, Steps: 17 | Train Loss: 14.681 Vali Loss: 186.449 Vali Acc: 0.236 Test Loss: 186.449 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.1453614234924316
Epoch: 23, Steps: 17 | Train Loss: 14.054 Vali Loss: 183.178 Vali Acc: 0.285 Test Loss: 183.178 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2514777183532715
Epoch: 24, Steps: 17 | Train Loss: 10.988 Vali Loss: 172.733 Vali Acc: 0.259 Test Loss: 172.733 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.058973550796509
Epoch: 25, Steps: 17 | Train Loss: 11.672 Vali Loss: 222.177 Vali Acc: 0.240 Test Loss: 222.177 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.1631925106048584
Epoch: 26, Steps: 17 | Train Loss: 16.294 Vali Loss: 246.626 Vali Acc: 0.232 Test Loss: 246.626 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.206514596939087
Epoch: 27, Steps: 17 | Train Loss: 7.945 Vali Loss: 224.612 Vali Acc: 0.247 Test Loss: 224.612 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.9978463649749756
Epoch: 28, Steps: 17 | Train Loss: 2.496 Vali Loss: 233.133 Vali Acc: 0.274 Test Loss: 233.133 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.0467963218688965
Epoch: 29, Steps: 17 | Train Loss: 7.788 Vali Loss: 279.534 Vali Acc: 0.247 Test Loss: 279.534 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 1457056
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.9299421310424805
Epoch: 1, Steps: 17 | Train Loss: 18.572 Vali Loss: 22.718 Vali Acc: 0.240 Test Loss: 22.718 Test Acc: 0.240
Validation loss decreased (inf --> -0.239317).  Saving model ...
Epoch: 2 cost time: 1.6691997051239014
Epoch: 2, Steps: 17 | Train Loss: 26.269 Vali Loss: 19.847 Vali Acc: 0.262 Test Loss: 19.847 Test Acc: 0.262
Validation loss decreased (-0.239317 --> -0.262159).  Saving model ...
Epoch: 3 cost time: 1.7780957221984863
Epoch: 3, Steps: 17 | Train Loss: 29.946 Vali Loss: 34.318 Vali Acc: 0.259 Test Loss: 34.318 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8145129680633545
Epoch: 4, Steps: 17 | Train Loss: 41.201 Vali Loss: 63.171 Vali Acc: 0.243 Test Loss: 63.171 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.893338918685913
Epoch: 5, Steps: 17 | Train Loss: 40.277 Vali Loss: 65.031 Vali Acc: 0.251 Test Loss: 65.031 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7809758186340332
Epoch: 6, Steps: 17 | Train Loss: 46.326 Vali Loss: 69.289 Vali Acc: 0.262 Test Loss: 69.289 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.788015604019165
Epoch: 7, Steps: 17 | Train Loss: 50.044 Vali Loss: 72.410 Vali Acc: 0.259 Test Loss: 72.410 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9299652576446533
Epoch: 8, Steps: 17 | Train Loss: 48.455 Vali Loss: 74.651 Vali Acc: 0.236 Test Loss: 74.651 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9259192943572998
Epoch: 9, Steps: 17 | Train Loss: 43.014 Vali Loss: 133.277 Vali Acc: 0.247 Test Loss: 133.277 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9249255657196045
Epoch: 10, Steps: 17 | Train Loss: 53.119 Vali Loss: 41.902 Vali Acc: 0.247 Test Loss: 41.902 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8637590408325195
Epoch: 11, Steps: 17 | Train Loss: 29.839 Vali Loss: 100.284 Vali Acc: 0.224 Test Loss: 100.284 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9884061813354492
Epoch: 12, Steps: 17 | Train Loss: 61.327 Vali Loss: 69.820 Vali Acc: 0.278 Test Loss: 69.820 Test Acc: 0.278
Validation loss decreased (-0.262159 --> -0.276868).  Saving model ...
Epoch: 13 cost time: 1.8396925926208496
Epoch: 13, Steps: 17 | Train Loss: 45.454 Vali Loss: 133.296 Vali Acc: 0.262 Test Loss: 133.296 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7620203495025635
Epoch: 14, Steps: 17 | Train Loss: 28.282 Vali Loss: 83.040 Vali Acc: 0.266 Test Loss: 83.040 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8588941097259521
Epoch: 15, Steps: 17 | Train Loss: 31.558 Vali Loss: 85.731 Vali Acc: 0.293 Test Loss: 85.731 Test Acc: 0.293
Validation loss decreased (-0.276868 --> -0.291918).  Saving model ...
Epoch: 16 cost time: 1.8512325286865234
Epoch: 16, Steps: 17 | Train Loss: 30.952 Vali Loss: 115.101 Vali Acc: 0.293 Test Loss: 115.101 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8832483291625977
Epoch: 17, Steps: 17 | Train Loss: 24.853 Vali Loss: 88.346 Vali Acc: 0.293 Test Loss: 88.346 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.980553388595581
Epoch: 18, Steps: 17 | Train Loss: 21.780 Vali Loss: 109.609 Vali Acc: 0.308 Test Loss: 109.609 Test Acc: 0.308
Validation loss decreased (-0.291918 --> -0.306889).  Saving model ...
Epoch: 19 cost time: 1.740694522857666
Epoch: 19, Steps: 17 | Train Loss: 23.677 Vali Loss: 123.094 Vali Acc: 0.243 Test Loss: 123.094 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8640263080596924
Epoch: 20, Steps: 17 | Train Loss: 23.508 Vali Loss: 143.315 Vali Acc: 0.266 Test Loss: 143.315 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7738113403320312
Epoch: 21, Steps: 17 | Train Loss: 10.679 Vali Loss: 127.752 Vali Acc: 0.255 Test Loss: 127.752 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6991393566131592
Epoch: 22, Steps: 17 | Train Loss: 7.847 Vali Loss: 142.700 Vali Acc: 0.278 Test Loss: 142.700 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8535432815551758
Epoch: 23, Steps: 17 | Train Loss: 8.970 Vali Loss: 176.224 Vali Acc: 0.278 Test Loss: 176.224 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7651660442352295
Epoch: 24, Steps: 17 | Train Loss: 23.818 Vali Loss: 248.636 Vali Acc: 0.228 Test Loss: 248.636 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8938453197479248
Epoch: 25, Steps: 17 | Train Loss: 30.713 Vali Loss: 221.848 Vali Acc: 0.274 Test Loss: 221.848 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.0236711502075195
Epoch: 26, Steps: 17 | Train Loss: 12.442 Vali Loss: 239.182 Vali Acc: 0.259 Test Loss: 239.182 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.9392962455749512
Epoch: 27, Steps: 17 | Train Loss: 17.648 Vali Loss: 301.335 Vali Acc: 0.300 Test Loss: 301.335 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8495748043060303
Epoch: 28, Steps: 17 | Train Loss: 19.132 Vali Loss: 305.795 Vali Acc: 0.243 Test Loss: 305.795 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 1457056
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3488101959228516
Epoch: 1, Steps: 17 | Train Loss: 14.608 Vali Loss: 16.237 Vali Acc: 0.270 Test Loss: 16.237 Test Acc: 0.270
Validation loss decreased (inf --> -0.269800).  Saving model ...
Epoch: 2 cost time: 1.7294495105743408
Epoch: 2, Steps: 17 | Train Loss: 25.889 Vali Loss: 32.344 Vali Acc: 0.262 Test Loss: 32.344 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8263952732086182
Epoch: 3, Steps: 17 | Train Loss: 23.892 Vali Loss: 22.049 Vali Acc: 0.270 Test Loss: 22.049 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.055894374847412
Epoch: 4, Steps: 17 | Train Loss: 27.807 Vali Loss: 37.492 Vali Acc: 0.259 Test Loss: 37.492 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7945258617401123
Epoch: 5, Steps: 17 | Train Loss: 45.571 Vali Loss: 76.128 Vali Acc: 0.259 Test Loss: 76.128 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6786530017852783
Epoch: 6, Steps: 17 | Train Loss: 41.341 Vali Loss: 58.885 Vali Acc: 0.247 Test Loss: 58.885 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9601976871490479
Epoch: 7, Steps: 17 | Train Loss: 39.008 Vali Loss: 47.134 Vali Acc: 0.243 Test Loss: 47.134 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7534794807434082
Epoch: 8, Steps: 17 | Train Loss: 31.548 Vali Loss: 35.691 Vali Acc: 0.240 Test Loss: 35.691 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.847714900970459
Epoch: 9, Steps: 17 | Train Loss: 43.403 Vali Loss: 87.990 Vali Acc: 0.262 Test Loss: 87.990 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9249136447906494
Epoch: 10, Steps: 17 | Train Loss: 41.300 Vali Loss: 47.405 Vali Acc: 0.259 Test Loss: 47.405 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8137433528900146
Epoch: 11, Steps: 17 | Train Loss: 23.323 Vali Loss: 76.835 Vali Acc: 0.240 Test Loss: 76.835 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 1457056
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.763155937194824
Epoch: 1, Steps: 17 | Train Loss: 13.049 Vali Loss: 14.012 Vali Acc: 0.266 Test Loss: 14.012 Test Acc: 0.266
Validation loss decreased (inf --> -0.266020).  Saving model ...
Epoch: 2 cost time: 1.7680232524871826
Epoch: 2, Steps: 17 | Train Loss: 19.431 Vali Loss: 58.286 Vali Acc: 0.251 Test Loss: 58.286 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7986559867858887
Epoch: 3, Steps: 17 | Train Loss: 48.015 Vali Loss: 26.841 Vali Acc: 0.266 Test Loss: 26.841 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6645798683166504
Epoch: 4, Steps: 17 | Train Loss: 32.052 Vali Loss: 24.488 Vali Acc: 0.251 Test Loss: 24.488 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6781182289123535
Epoch: 5, Steps: 17 | Train Loss: 31.429 Vali Loss: 38.280 Vali Acc: 0.247 Test Loss: 38.280 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.755225419998169
Epoch: 6, Steps: 17 | Train Loss: 54.000 Vali Loss: 94.835 Vali Acc: 0.251 Test Loss: 94.835 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8151798248291016
Epoch: 7, Steps: 17 | Train Loss: 52.247 Vali Loss: 73.709 Vali Acc: 0.262 Test Loss: 73.709 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.73276686668396
Epoch: 8, Steps: 17 | Train Loss: 52.886 Vali Loss: 45.179 Vali Acc: 0.240 Test Loss: 45.179 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6992743015289307
Epoch: 9, Steps: 17 | Train Loss: 43.494 Vali Loss: 62.778 Vali Acc: 0.259 Test Loss: 62.778 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7598631381988525
Epoch: 10, Steps: 17 | Train Loss: 40.941 Vali Loss: 29.995 Vali Acc: 0.278 Test Loss: 29.995 Test Acc: 0.278
Validation loss decreased (-0.266020 --> -0.277267).  Saving model ...
Epoch: 11 cost time: 1.739469051361084
Epoch: 11, Steps: 17 | Train Loss: 18.747 Vali Loss: 27.469 Vali Acc: 0.247 Test Loss: 27.469 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4857068061828613
Epoch: 12, Steps: 17 | Train Loss: 29.144 Vali Loss: 60.364 Vali Acc: 0.266 Test Loss: 60.364 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5135502815246582
Epoch: 13, Steps: 17 | Train Loss: 39.450 Vali Loss: 124.844 Vali Acc: 0.259 Test Loss: 124.844 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7119333744049072
Epoch: 14, Steps: 17 | Train Loss: 29.211 Vali Loss: 70.900 Vali Acc: 0.270 Test Loss: 70.900 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.638974905014038
Epoch: 15, Steps: 17 | Train Loss: 28.112 Vali Loss: 73.173 Vali Acc: 0.240 Test Loss: 73.173 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.688403844833374
Epoch: 16, Steps: 17 | Train Loss: 24.789 Vali Loss: 106.192 Vali Acc: 0.259 Test Loss: 106.192 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6240346431732178
Epoch: 17, Steps: 17 | Train Loss: 25.960 Vali Loss: 125.015 Vali Acc: 0.266 Test Loss: 125.015 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6938321590423584
Epoch: 18, Steps: 17 | Train Loss: 25.574 Vali Loss: 119.923 Vali Acc: 0.293 Test Loss: 119.923 Test Acc: 0.293
Validation loss decreased (-0.277267 --> -0.291576).  Saving model ...
Epoch: 19 cost time: 1.6627860069274902
Epoch: 19, Steps: 17 | Train Loss: 17.895 Vali Loss: 150.683 Vali Acc: 0.270 Test Loss: 150.683 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6444664001464844
Epoch: 20, Steps: 17 | Train Loss: 10.248 Vali Loss: 139.077 Vali Acc: 0.281 Test Loss: 139.077 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5745654106140137
Epoch: 21, Steps: 17 | Train Loss: 9.476 Vali Loss: 152.164 Vali Acc: 0.312 Test Loss: 152.164 Test Acc: 0.312
Validation loss decreased (-0.291576 --> -0.310265).  Saving model ...
Epoch: 22 cost time: 1.696009635925293
Epoch: 22, Steps: 17 | Train Loss: 8.831 Vali Loss: 167.679 Vali Acc: 0.255 Test Loss: 167.679 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7233526706695557
Epoch: 23, Steps: 17 | Train Loss: 15.149 Vali Loss: 166.993 Vali Acc: 0.266 Test Loss: 166.993 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7224524021148682
Epoch: 24, Steps: 17 | Train Loss: 4.631 Vali Loss: 213.780 Vali Acc: 0.289 Test Loss: 213.780 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7237658500671387
Epoch: 25, Steps: 17 | Train Loss: 8.941 Vali Loss: 200.417 Vali Acc: 0.247 Test Loss: 200.417 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6371045112609863
Epoch: 26, Steps: 17 | Train Loss: 6.953 Vali Loss: 244.518 Vali Acc: 0.293 Test Loss: 244.518 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7108368873596191
Epoch: 27, Steps: 17 | Train Loss: 9.105 Vali Loss: 240.389 Vali Acc: 0.259 Test Loss: 240.389 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.706024408340454
Epoch: 28, Steps: 17 | Train Loss: 35.720 Vali Loss: 269.942 Vali Acc: 0.259 Test Loss: 269.942 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7326276302337646
Epoch: 29, Steps: 17 | Train Loss: 11.276 Vali Loss: 285.127 Vali Acc: 0.285 Test Loss: 285.127 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6743569374084473
Epoch: 30, Steps: 17 | Train Loss: 14.204 Vali Loss: 303.069 Vali Acc: 0.255 Test Loss: 303.069 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.8249952793121338
Epoch: 31, Steps: 17 | Train Loss: 8.489 Vali Loss: 402.058 Vali Acc: 0.259 Test Loss: 402.058 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 1457056
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.9154369831085205
Epoch: 1, Steps: 17 | Train Loss: 19.561 Vali Loss: 17.006 Vali Acc: 0.251 Test Loss: 17.006 Test Acc: 0.251
Validation loss decreased (inf --> -0.250781).  Saving model ...
Epoch: 2 cost time: 1.820594072341919
Epoch: 2, Steps: 17 | Train Loss: 23.088 Vali Loss: 38.240 Vali Acc: 0.251 Test Loss: 38.240 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.739840030670166
Epoch: 3, Steps: 17 | Train Loss: 43.577 Vali Loss: 27.229 Vali Acc: 0.255 Test Loss: 27.229 Test Acc: 0.255
Validation loss decreased (-0.250781 --> -0.254481).  Saving model ...
Epoch: 4 cost time: 1.7418158054351807
Epoch: 4, Steps: 17 | Train Loss: 36.488 Vali Loss: 27.850 Vali Acc: 0.251 Test Loss: 27.850 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9911127090454102
Epoch: 5, Steps: 17 | Train Loss: 38.172 Vali Loss: 24.576 Vali Acc: 0.266 Test Loss: 24.576 Test Acc: 0.266
Validation loss decreased (-0.254481 --> -0.265914).  Saving model ...
Epoch: 6 cost time: 1.8285396099090576
Epoch: 6, Steps: 17 | Train Loss: 42.228 Vali Loss: 73.060 Vali Acc: 0.251 Test Loss: 73.060 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8366234302520752
Epoch: 7, Steps: 17 | Train Loss: 59.025 Vali Loss: 80.225 Vali Acc: 0.228 Test Loss: 80.225 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9597182273864746
Epoch: 8, Steps: 17 | Train Loss: 37.592 Vali Loss: 48.015 Vali Acc: 0.243 Test Loss: 48.015 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8971765041351318
Epoch: 9, Steps: 17 | Train Loss: 58.934 Vali Loss: 66.301 Vali Acc: 0.255 Test Loss: 66.301 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9629356861114502
Epoch: 10, Steps: 17 | Train Loss: 59.739 Vali Loss: 77.834 Vali Acc: 0.251 Test Loss: 77.834 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.842179775238037
Epoch: 11, Steps: 17 | Train Loss: 65.726 Vali Loss: 152.685 Vali Acc: 0.251 Test Loss: 152.685 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0035512447357178
Epoch: 12, Steps: 17 | Train Loss: 42.711 Vali Loss: 88.763 Vali Acc: 0.255 Test Loss: 88.763 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8917131423950195
Epoch: 13, Steps: 17 | Train Loss: 23.938 Vali Loss: 52.464 Vali Acc: 0.255 Test Loss: 52.464 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7925148010253906
Epoch: 14, Steps: 17 | Train Loss: 19.131 Vali Loss: 132.637 Vali Acc: 0.255 Test Loss: 132.637 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9608361721038818
Epoch: 15, Steps: 17 | Train Loss: 39.610 Vali Loss: 207.899 Vali Acc: 0.251 Test Loss: 207.899 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 1194912
model size : 7.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6782052516937256
Epoch: 1, Steps: 17 | Train Loss: 13.720 Vali Loss: 11.352 Vali Acc: 0.262 Test Loss: 11.352 Test Acc: 0.262
Validation loss decreased (inf --> -0.262244).  Saving model ...
Epoch: 2 cost time: 1.7371962070465088
Epoch: 2, Steps: 17 | Train Loss: 24.274 Vali Loss: 35.690 Vali Acc: 0.243 Test Loss: 35.690 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5512514114379883
Epoch: 3, Steps: 17 | Train Loss: 61.637 Vali Loss: 72.095 Vali Acc: 0.255 Test Loss: 72.095 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7420527935028076
Epoch: 4, Steps: 17 | Train Loss: 54.071 Vali Loss: 43.660 Vali Acc: 0.262 Test Loss: 43.660 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6801965236663818
Epoch: 5, Steps: 17 | Train Loss: 45.819 Vali Loss: 44.410 Vali Acc: 0.274 Test Loss: 44.410 Test Acc: 0.274
Validation loss decreased (-0.262244 --> -0.273320).  Saving model ...
Epoch: 6 cost time: 1.8392987251281738
Epoch: 6, Steps: 17 | Train Loss: 44.376 Vali Loss: 49.710 Vali Acc: 0.232 Test Loss: 49.710 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5774750709533691
Epoch: 7, Steps: 17 | Train Loss: 48.516 Vali Loss: 50.859 Vali Acc: 0.262 Test Loss: 50.859 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7222285270690918
Epoch: 8, Steps: 17 | Train Loss: 36.448 Vali Loss: 84.966 Vali Acc: 0.259 Test Loss: 84.966 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7080762386322021
Epoch: 9, Steps: 17 | Train Loss: 39.763 Vali Loss: 41.694 Vali Acc: 0.251 Test Loss: 41.694 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6936986446380615
Epoch: 10, Steps: 17 | Train Loss: 37.176 Vali Loss: 41.707 Vali Acc: 0.240 Test Loss: 41.707 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6455879211425781
Epoch: 11, Steps: 17 | Train Loss: 38.243 Vali Loss: 69.870 Vali Acc: 0.259 Test Loss: 69.870 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6708741188049316
Epoch: 12, Steps: 17 | Train Loss: 59.355 Vali Loss: 47.826 Vali Acc: 0.255 Test Loss: 47.826 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7567265033721924
Epoch: 13, Steps: 17 | Train Loss: 53.532 Vali Loss: 58.367 Vali Acc: 0.251 Test Loss: 58.367 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8311188220977783
Epoch: 14, Steps: 17 | Train Loss: 32.239 Vali Loss: 81.018 Vali Acc: 0.274 Test Loss: 81.018 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8209383487701416
Epoch: 15, Steps: 17 | Train Loss: 20.434 Vali Loss: 82.967 Vali Acc: 0.270 Test Loss: 82.967 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 1194912
model size : 7.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7890896797180176
Epoch: 1, Steps: 17 | Train Loss: 14.007 Vali Loss: 23.119 Vali Acc: 0.270 Test Loss: 23.119 Test Acc: 0.270
Validation loss decreased (inf --> -0.269731).  Saving model ...
Epoch: 2 cost time: 1.572666883468628
Epoch: 2, Steps: 17 | Train Loss: 30.946 Vali Loss: 60.675 Vali Acc: 0.251 Test Loss: 60.675 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6413023471832275
Epoch: 3, Steps: 17 | Train Loss: 57.193 Vali Loss: 44.644 Vali Acc: 0.274 Test Loss: 44.644 Test Acc: 0.274
Validation loss decreased (-0.269731 --> -0.273318).  Saving model ...
Epoch: 4 cost time: 1.8512840270996094
Epoch: 4, Steps: 17 | Train Loss: 55.484 Vali Loss: 80.078 Vali Acc: 0.262 Test Loss: 80.078 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8736960887908936
Epoch: 5, Steps: 17 | Train Loss: 56.579 Vali Loss: 73.378 Vali Acc: 0.255 Test Loss: 73.378 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6323521137237549
Epoch: 6, Steps: 17 | Train Loss: 59.488 Vali Loss: 43.367 Vali Acc: 0.247 Test Loss: 43.367 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6569478511810303
Epoch: 7, Steps: 17 | Train Loss: 65.578 Vali Loss: 145.105 Vali Acc: 0.247 Test Loss: 145.105 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.703094720840454
Epoch: 8, Steps: 17 | Train Loss: 75.228 Vali Loss: 42.332 Vali Acc: 0.262 Test Loss: 42.332 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5035452842712402
Epoch: 9, Steps: 17 | Train Loss: 29.670 Vali Loss: 53.779 Vali Acc: 0.251 Test Loss: 53.779 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5672283172607422
Epoch: 10, Steps: 17 | Train Loss: 43.610 Vali Loss: 58.123 Vali Acc: 0.198 Test Loss: 58.123 Test Acc: 0.198
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.602626085281372
Epoch: 11, Steps: 17 | Train Loss: 43.966 Vali Loss: 110.030 Vali Acc: 0.243 Test Loss: 110.030 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6650817394256592
Epoch: 12, Steps: 17 | Train Loss: 67.752 Vali Loss: 77.883 Vali Acc: 0.255 Test Loss: 77.883 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6617872714996338
Epoch: 13, Steps: 17 | Train Loss: 41.803 Vali Loss: 86.264 Vali Acc: 0.243 Test Loss: 86.264 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 1194912
model size : 7.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3117971420288086
Epoch: 1, Steps: 17 | Train Loss: 10.567 Vali Loss: 10.199 Vali Acc: 0.259 Test Loss: 10.199 Test Acc: 0.259
Validation loss decreased (inf --> -0.258453).  Saving model ...
Epoch: 2 cost time: 1.554187536239624
Epoch: 2, Steps: 17 | Train Loss: 24.904 Vali Loss: 44.722 Vali Acc: 0.259 Test Loss: 44.722 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.506230354309082
Epoch: 3, Steps: 17 | Train Loss: 44.460 Vali Loss: 71.561 Vali Acc: 0.251 Test Loss: 71.561 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.679732322692871
Epoch: 4, Steps: 17 | Train Loss: 62.875 Vali Loss: 47.017 Vali Acc: 0.240 Test Loss: 47.017 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6845779418945312
Epoch: 5, Steps: 17 | Train Loss: 66.221 Vali Loss: 60.156 Vali Acc: 0.259 Test Loss: 60.156 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.557610273361206
Epoch: 6, Steps: 17 | Train Loss: 55.759 Vali Loss: 33.073 Vali Acc: 0.255 Test Loss: 33.073 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.628885269165039
Epoch: 7, Steps: 17 | Train Loss: 46.058 Vali Loss: 24.383 Vali Acc: 0.243 Test Loss: 24.383 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4418387413024902
Epoch: 8, Steps: 17 | Train Loss: 40.710 Vali Loss: 15.163 Vali Acc: 0.255 Test Loss: 15.163 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5266106128692627
Epoch: 9, Steps: 17 | Train Loss: 39.932 Vali Loss: 33.648 Vali Acc: 0.262 Test Loss: 33.648 Test Acc: 0.262
Validation loss decreased (-0.258453 --> -0.262021).  Saving model ...
Epoch: 10 cost time: 1.5682077407836914
Epoch: 10, Steps: 17 | Train Loss: 37.661 Vali Loss: 101.593 Vali Acc: 0.262 Test Loss: 101.593 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6695194244384766
Epoch: 11, Steps: 17 | Train Loss: 53.990 Vali Loss: 59.184 Vali Acc: 0.262 Test Loss: 59.184 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5820343494415283
Epoch: 12, Steps: 17 | Train Loss: 22.912 Vali Loss: 84.529 Vali Acc: 0.259 Test Loss: 84.529 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.520664930343628
Epoch: 13, Steps: 17 | Train Loss: 32.183 Vali Loss: 99.104 Vali Acc: 0.255 Test Loss: 99.104 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5017132759094238
Epoch: 14, Steps: 17 | Train Loss: 26.600 Vali Loss: 51.121 Vali Acc: 0.255 Test Loss: 51.121 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5507853031158447
Epoch: 15, Steps: 17 | Train Loss: 12.885 Vali Loss: 79.894 Vali Acc: 0.278 Test Loss: 79.894 Test Acc: 0.278
Validation loss decreased (-0.262021 --> -0.276768).  Saving model ...
Epoch: 16 cost time: 1.5373873710632324
Epoch: 16, Steps: 17 | Train Loss: 16.585 Vali Loss: 118.298 Vali Acc: 0.251 Test Loss: 118.298 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4676337242126465
Epoch: 17, Steps: 17 | Train Loss: 29.861 Vali Loss: 85.979 Vali Acc: 0.251 Test Loss: 85.979 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5624005794525146
Epoch: 18, Steps: 17 | Train Loss: 18.226 Vali Loss: 108.450 Vali Acc: 0.259 Test Loss: 108.450 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.625303030014038
Epoch: 19, Steps: 17 | Train Loss: 8.761 Vali Loss: 135.135 Vali Acc: 0.289 Test Loss: 135.135 Test Acc: 0.289
Validation loss decreased (-0.276768 --> -0.287622).  Saving model ...
Epoch: 20 cost time: 1.5628046989440918
Epoch: 20, Steps: 17 | Train Loss: 9.515 Vali Loss: 181.462 Vali Acc: 0.221 Test Loss: 181.462 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.47452712059021
Epoch: 21, Steps: 17 | Train Loss: 36.346 Vali Loss: 160.407 Vali Acc: 0.232 Test Loss: 160.407 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5406620502471924
Epoch: 22, Steps: 17 | Train Loss: 30.194 Vali Loss: 145.962 Vali Acc: 0.251 Test Loss: 145.962 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5836129188537598
Epoch: 23, Steps: 17 | Train Loss: 6.330 Vali Loss: 158.891 Vali Acc: 0.297 Test Loss: 158.891 Test Acc: 0.297
Validation loss decreased (-0.287622 --> -0.294989).  Saving model ...
Epoch: 24 cost time: 1.618577241897583
Epoch: 24, Steps: 17 | Train Loss: 18.499 Vali Loss: 191.527 Vali Acc: 0.236 Test Loss: 191.527 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7670812606811523
Epoch: 25, Steps: 17 | Train Loss: 5.976 Vali Loss: 214.292 Vali Acc: 0.259 Test Loss: 214.292 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8164010047912598
Epoch: 26, Steps: 17 | Train Loss: 11.847 Vali Loss: 245.333 Vali Acc: 0.247 Test Loss: 245.333 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.72837495803833
Epoch: 27, Steps: 17 | Train Loss: 11.786 Vali Loss: 247.044 Vali Acc: 0.243 Test Loss: 247.044 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7145774364471436
Epoch: 28, Steps: 17 | Train Loss: 11.716 Vali Loss: 280.191 Vali Acc: 0.255 Test Loss: 280.191 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7189173698425293
Epoch: 29, Steps: 17 | Train Loss: 19.522 Vali Loss: 318.418 Vali Acc: 0.232 Test Loss: 318.418 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6984376907348633
Epoch: 30, Steps: 17 | Train Loss: 8.475 Vali Loss: 414.646 Vali Acc: 0.247 Test Loss: 414.646 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.7699661254882812
Epoch: 31, Steps: 17 | Train Loss: 12.252 Vali Loss: 370.093 Vali Acc: 0.243 Test Loss: 370.093 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.7589914798736572
Epoch: 32, Steps: 17 | Train Loss: 6.211 Vali Loss: 396.155 Vali Acc: 0.243 Test Loss: 396.155 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7592077255249023
Epoch: 33, Steps: 17 | Train Loss: 8.913 Vali Loss: 371.238 Vali Acc: 0.232 Test Loss: 371.238 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 1194912
model size : 7.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.992676019668579
Epoch: 1, Steps: 17 | Train Loss: 12.231 Vali Loss: 17.272 Vali Acc: 0.255 Test Loss: 17.272 Test Acc: 0.255
Validation loss decreased (inf --> -0.254580).  Saving model ...
Epoch: 2 cost time: 2.1309800148010254
Epoch: 2, Steps: 17 | Train Loss: 24.088 Vali Loss: 49.634 Vali Acc: 0.243 Test Loss: 49.634 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8902246952056885
Epoch: 3, Steps: 17 | Train Loss: 43.719 Vali Loss: 62.059 Vali Acc: 0.236 Test Loss: 62.059 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6435775756835938
Epoch: 4, Steps: 17 | Train Loss: 50.658 Vali Loss: 56.730 Vali Acc: 0.232 Test Loss: 56.730 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.758800745010376
Epoch: 5, Steps: 17 | Train Loss: 43.559 Vali Loss: 115.230 Vali Acc: 0.240 Test Loss: 115.230 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9445290565490723
Epoch: 6, Steps: 17 | Train Loss: 102.506 Vali Loss: 43.108 Vali Acc: 0.262 Test Loss: 43.108 Test Acc: 0.262
Validation loss decreased (-0.254580 --> -0.261926).  Saving model ...
Epoch: 7 cost time: 1.9406280517578125
Epoch: 7, Steps: 17 | Train Loss: 53.607 Vali Loss: 46.561 Vali Acc: 0.266 Test Loss: 46.561 Test Acc: 0.266
Validation loss decreased (-0.261926 --> -0.265694).  Saving model ...
Epoch: 8 cost time: 1.9126994609832764
Epoch: 8, Steps: 17 | Train Loss: 56.802 Vali Loss: 84.990 Vali Acc: 0.236 Test Loss: 84.990 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.023036241531372
Epoch: 9, Steps: 17 | Train Loss: 37.973 Vali Loss: 48.257 Vali Acc: 0.228 Test Loss: 48.257 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7908954620361328
Epoch: 10, Steps: 17 | Train Loss: 20.181 Vali Loss: 84.717 Vali Acc: 0.251 Test Loss: 84.717 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.000953197479248
Epoch: 11, Steps: 17 | Train Loss: 38.718 Vali Loss: 59.942 Vali Acc: 0.255 Test Loss: 59.942 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.073975086212158
Epoch: 12, Steps: 17 | Train Loss: 32.732 Vali Loss: 96.059 Vali Acc: 0.259 Test Loss: 96.059 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0259549617767334
Epoch: 13, Steps: 17 | Train Loss: 40.056 Vali Loss: 59.359 Vali Acc: 0.262 Test Loss: 59.359 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6467113494873047
Epoch: 14, Steps: 17 | Train Loss: 25.613 Vali Loss: 107.393 Vali Acc: 0.243 Test Loss: 107.393 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6441519260406494
Epoch: 15, Steps: 17 | Train Loss: 28.252 Vali Loss: 83.114 Vali Acc: 0.251 Test Loss: 83.114 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6780776977539062
Epoch: 16, Steps: 17 | Train Loss: 19.620 Vali Loss: 77.782 Vali Acc: 0.221 Test Loss: 77.782 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.0251736640930176
Epoch: 17, Steps: 17 | Train Loss: 16.008 Vali Loss: 68.978 Vali Acc: 0.262 Test Loss: 68.978 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 1063840
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.806903600692749
Epoch: 1, Steps: 17 | Train Loss: 13.476 Vali Loss: 23.651 Vali Acc: 0.255 Test Loss: 23.651 Test Acc: 0.255
Validation loss decreased (inf --> -0.254516).  Saving model ...
Epoch: 2 cost time: 1.8476893901824951
Epoch: 2, Steps: 17 | Train Loss: 25.353 Vali Loss: 10.931 Vali Acc: 0.262 Test Loss: 10.931 Test Acc: 0.262
Validation loss decreased (-0.254516 --> -0.262248).  Saving model ...
Epoch: 3 cost time: 1.7794907093048096
Epoch: 3, Steps: 17 | Train Loss: 44.770 Vali Loss: 55.137 Vali Acc: 0.232 Test Loss: 55.137 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8282227516174316
Epoch: 4, Steps: 17 | Train Loss: 45.829 Vali Loss: 55.501 Vali Acc: 0.274 Test Loss: 55.501 Test Acc: 0.274
Validation loss decreased (-0.262248 --> -0.273209).  Saving model ...
Epoch: 5 cost time: 1.8246314525604248
Epoch: 5, Steps: 17 | Train Loss: 71.578 Vali Loss: 38.596 Vali Acc: 0.255 Test Loss: 38.596 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5920250415802002
Epoch: 6, Steps: 17 | Train Loss: 47.141 Vali Loss: 71.606 Vali Acc: 0.251 Test Loss: 71.606 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.768113136291504
Epoch: 7, Steps: 17 | Train Loss: 43.153 Vali Loss: 39.434 Vali Acc: 0.247 Test Loss: 39.434 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7893073558807373
Epoch: 8, Steps: 17 | Train Loss: 54.376 Vali Loss: 39.743 Vali Acc: 0.247 Test Loss: 39.743 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7454783916473389
Epoch: 9, Steps: 17 | Train Loss: 30.062 Vali Loss: 109.217 Vali Acc: 0.247 Test Loss: 109.217 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7602274417877197
Epoch: 10, Steps: 17 | Train Loss: 50.325 Vali Loss: 44.683 Vali Acc: 0.251 Test Loss: 44.683 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7224395275115967
Epoch: 11, Steps: 17 | Train Loss: 56.270 Vali Loss: 103.871 Vali Acc: 0.243 Test Loss: 103.871 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8852360248565674
Epoch: 12, Steps: 17 | Train Loss: 42.804 Vali Loss: 70.096 Vali Acc: 0.259 Test Loss: 70.096 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8415334224700928
Epoch: 13, Steps: 17 | Train Loss: 26.615 Vali Loss: 61.102 Vali Acc: 0.243 Test Loss: 61.102 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7866017818450928
Epoch: 14, Steps: 17 | Train Loss: 37.780 Vali Loss: 71.036 Vali Acc: 0.243 Test Loss: 71.036 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 1063840
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.998983383178711
Epoch: 1, Steps: 17 | Train Loss: 14.034 Vali Loss: 10.133 Vali Acc: 0.232 Test Loss: 10.133 Test Acc: 0.232
Validation loss decreased (inf --> -0.231838).  Saving model ...
Epoch: 2 cost time: 1.5615544319152832
Epoch: 2, Steps: 17 | Train Loss: 28.498 Vali Loss: 28.696 Vali Acc: 0.243 Test Loss: 28.696 Test Acc: 0.243
Validation loss decreased (-0.231838 --> -0.243059).  Saving model ...
Epoch: 3 cost time: 1.5853188037872314
Epoch: 3, Steps: 17 | Train Loss: 37.061 Vali Loss: 52.422 Vali Acc: 0.255 Test Loss: 52.422 Test Acc: 0.255
Validation loss decreased (-0.243059 --> -0.254229).  Saving model ...
Epoch: 4 cost time: 1.6360723972320557
Epoch: 4, Steps: 17 | Train Loss: 46.487 Vali Loss: 96.418 Vali Acc: 0.255 Test Loss: 96.418 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8072383403778076
Epoch: 5, Steps: 17 | Train Loss: 60.385 Vali Loss: 38.237 Vali Acc: 0.236 Test Loss: 38.237 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.617340326309204
Epoch: 6, Steps: 17 | Train Loss: 67.354 Vali Loss: 81.013 Vali Acc: 0.240 Test Loss: 81.013 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6327948570251465
Epoch: 7, Steps: 17 | Train Loss: 49.186 Vali Loss: 104.662 Vali Acc: 0.247 Test Loss: 104.662 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8680140972137451
Epoch: 8, Steps: 17 | Train Loss: 33.790 Vali Loss: 41.131 Vali Acc: 0.266 Test Loss: 41.131 Test Acc: 0.266
Validation loss decreased (-0.254229 --> -0.265748).  Saving model ...
Epoch: 9 cost time: 1.6200850009918213
Epoch: 9, Steps: 17 | Train Loss: 41.355 Vali Loss: 79.385 Vali Acc: 0.262 Test Loss: 79.385 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6281402111053467
Epoch: 10, Steps: 17 | Train Loss: 53.985 Vali Loss: 63.357 Vali Acc: 0.243 Test Loss: 63.357 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5945396423339844
Epoch: 11, Steps: 17 | Train Loss: 55.386 Vali Loss: 116.176 Vali Acc: 0.259 Test Loss: 116.176 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8784153461456299
Epoch: 12, Steps: 17 | Train Loss: 34.415 Vali Loss: 62.206 Vali Acc: 0.266 Test Loss: 62.206 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6806678771972656
Epoch: 13, Steps: 17 | Train Loss: 26.837 Vali Loss: 90.994 Vali Acc: 0.243 Test Loss: 90.994 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6331591606140137
Epoch: 14, Steps: 17 | Train Loss: 20.671 Vali Loss: 93.822 Vali Acc: 0.259 Test Loss: 93.822 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5846688747406006
Epoch: 15, Steps: 17 | Train Loss: 32.895 Vali Loss: 94.304 Vali Acc: 0.266 Test Loss: 94.304 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6563715934753418
Epoch: 16, Steps: 17 | Train Loss: 34.966 Vali Loss: 91.088 Vali Acc: 0.259 Test Loss: 91.088 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6437041759490967
Epoch: 17, Steps: 17 | Train Loss: 34.839 Vali Loss: 105.237 Vali Acc: 0.274 Test Loss: 105.237 Test Acc: 0.274
Validation loss decreased (-0.265748 --> -0.272712).  Saving model ...
Epoch: 18 cost time: 1.6393253803253174
Epoch: 18, Steps: 17 | Train Loss: 15.501 Vali Loss: 131.471 Vali Acc: 0.262 Test Loss: 131.471 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.601778507232666
Epoch: 19, Steps: 17 | Train Loss: 27.487 Vali Loss: 166.095 Vali Acc: 0.262 Test Loss: 166.095 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.619384765625
Epoch: 20, Steps: 17 | Train Loss: 15.153 Vali Loss: 184.800 Vali Acc: 0.228 Test Loss: 184.800 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7436985969543457
Epoch: 21, Steps: 17 | Train Loss: 19.507 Vali Loss: 142.876 Vali Acc: 0.259 Test Loss: 142.876 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7217440605163574
Epoch: 22, Steps: 17 | Train Loss: 15.393 Vali Loss: 159.717 Vali Acc: 0.232 Test Loss: 159.717 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.655167818069458
Epoch: 23, Steps: 17 | Train Loss: 13.960 Vali Loss: 197.699 Vali Acc: 0.240 Test Loss: 197.699 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6150493621826172
Epoch: 24, Steps: 17 | Train Loss: 12.193 Vali Loss: 186.417 Vali Acc: 0.247 Test Loss: 186.417 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.681792974472046
Epoch: 25, Steps: 17 | Train Loss: 7.317 Vali Loss: 231.523 Vali Acc: 0.270 Test Loss: 231.523 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5688023567199707
Epoch: 26, Steps: 17 | Train Loss: 10.190 Vali Loss: 267.093 Vali Acc: 0.247 Test Loss: 267.093 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6204440593719482
Epoch: 27, Steps: 17 | Train Loss: 12.872 Vali Loss: 251.589 Vali Acc: 0.251 Test Loss: 251.589 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 1063840
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.1083457469940186
Epoch: 1, Steps: 17 | Train Loss: 12.555 Vali Loss: 18.235 Vali Acc: 0.240 Test Loss: 18.235 Test Acc: 0.240
Validation loss decreased (inf --> -0.239361).  Saving model ...
Epoch: 2 cost time: 1.5661382675170898
Epoch: 2, Steps: 17 | Train Loss: 25.060 Vali Loss: 26.728 Vali Acc: 0.247 Test Loss: 26.728 Test Acc: 0.247
Validation loss decreased (-0.239361 --> -0.246881).  Saving model ...
Epoch: 3 cost time: 1.4797749519348145
Epoch: 3, Steps: 17 | Train Loss: 37.971 Vali Loss: 42.442 Vali Acc: 0.247 Test Loss: 42.442 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.385615348815918
Epoch: 4, Steps: 17 | Train Loss: 28.897 Vali Loss: 32.835 Vali Acc: 0.247 Test Loss: 32.835 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5532262325286865
Epoch: 5, Steps: 17 | Train Loss: 38.984 Vali Loss: 84.007 Vali Acc: 0.243 Test Loss: 84.007 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6385259628295898
Epoch: 6, Steps: 17 | Train Loss: 74.625 Vali Loss: 57.614 Vali Acc: 0.228 Test Loss: 57.614 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5258514881134033
Epoch: 7, Steps: 17 | Train Loss: 38.041 Vali Loss: 52.152 Vali Acc: 0.247 Test Loss: 52.152 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.633561611175537
Epoch: 8, Steps: 17 | Train Loss: 25.575 Vali Loss: 44.578 Vali Acc: 0.251 Test Loss: 44.578 Test Acc: 0.251
Validation loss decreased (-0.246881 --> -0.250505).  Saving model ...
Epoch: 9 cost time: 1.6254973411560059
Epoch: 9, Steps: 17 | Train Loss: 42.524 Vali Loss: 79.744 Vali Acc: 0.247 Test Loss: 79.744 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6103785037994385
Epoch: 10, Steps: 17 | Train Loss: 49.511 Vali Loss: 64.457 Vali Acc: 0.270 Test Loss: 64.457 Test Acc: 0.270
Validation loss decreased (-0.250505 --> -0.269317).  Saving model ...
Epoch: 11 cost time: 1.4809670448303223
Epoch: 11, Steps: 17 | Train Loss: 47.281 Vali Loss: 63.643 Vali Acc: 0.247 Test Loss: 63.643 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.537952184677124
Epoch: 12, Steps: 17 | Train Loss: 27.594 Vali Loss: 52.618 Vali Acc: 0.266 Test Loss: 52.618 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.535414218902588
Epoch: 13, Steps: 17 | Train Loss: 29.979 Vali Loss: 87.214 Vali Acc: 0.240 Test Loss: 87.214 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4262018203735352
Epoch: 14, Steps: 17 | Train Loss: 41.638 Vali Loss: 66.593 Vali Acc: 0.262 Test Loss: 66.593 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5460617542266846
Epoch: 15, Steps: 17 | Train Loss: 29.066 Vali Loss: 88.770 Vali Acc: 0.274 Test Loss: 88.770 Test Acc: 0.274
Validation loss decreased (-0.269317 --> -0.272877).  Saving model ...
Epoch: 16 cost time: 1.4865896701812744
Epoch: 16, Steps: 17 | Train Loss: 16.998 Vali Loss: 110.764 Vali Acc: 0.255 Test Loss: 110.764 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5882847309112549
Epoch: 17, Steps: 17 | Train Loss: 38.214 Vali Loss: 107.484 Vali Acc: 0.304 Test Loss: 107.484 Test Acc: 0.304
Validation loss decreased (-0.272877 --> -0.303108).  Saving model ...
Epoch: 18 cost time: 1.5269193649291992
Epoch: 18, Steps: 17 | Train Loss: 28.300 Vali Loss: 226.111 Vali Acc: 0.266 Test Loss: 226.111 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6008100509643555
Epoch: 19, Steps: 17 | Train Loss: 17.312 Vali Loss: 155.033 Vali Acc: 0.266 Test Loss: 155.033 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4739279747009277
Epoch: 20, Steps: 17 | Train Loss: 13.570 Vali Loss: 237.485 Vali Acc: 0.251 Test Loss: 237.485 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6129133701324463
Epoch: 21, Steps: 17 | Train Loss: 24.434 Vali Loss: 250.007 Vali Acc: 0.281 Test Loss: 250.007 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5879452228546143
Epoch: 22, Steps: 17 | Train Loss: 18.139 Vali Loss: 221.429 Vali Acc: 0.266 Test Loss: 221.429 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5834312438964844
Epoch: 23, Steps: 17 | Train Loss: 6.773 Vali Loss: 215.958 Vali Acc: 0.266 Test Loss: 215.958 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5656688213348389
Epoch: 24, Steps: 17 | Train Loss: 6.264 Vali Loss: 232.907 Vali Acc: 0.285 Test Loss: 232.907 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.654341459274292
Epoch: 25, Steps: 17 | Train Loss: 8.630 Vali Loss: 270.417 Vali Acc: 0.266 Test Loss: 270.417 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.586198091506958
Epoch: 26, Steps: 17 | Train Loss: 11.333 Vali Loss: 325.362 Vali Acc: 0.262 Test Loss: 325.362 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5766847133636475
Epoch: 27, Steps: 17 | Train Loss: 12.604 Vali Loss: 355.364 Vali Acc: 0.278 Test Loss: 355.364 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 1063840
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4810168743133545
Epoch: 1, Steps: 17 | Train Loss: 15.000 Vali Loss: 16.628 Vali Acc: 0.274 Test Loss: 16.628 Test Acc: 0.274
Validation loss decreased (inf --> -0.273598).  Saving model ...
Epoch: 2 cost time: 1.7078914642333984
Epoch: 2, Steps: 17 | Train Loss: 21.463 Vali Loss: 39.976 Vali Acc: 0.217 Test Loss: 39.976 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7726926803588867
Epoch: 3, Steps: 17 | Train Loss: 36.457 Vali Loss: 26.453 Vali Acc: 0.221 Test Loss: 26.453 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8041589260101318
Epoch: 4, Steps: 17 | Train Loss: 31.253 Vali Loss: 37.785 Vali Acc: 0.209 Test Loss: 37.785 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8910722732543945
Epoch: 5, Steps: 17 | Train Loss: 40.509 Vali Loss: 32.507 Vali Acc: 0.266 Test Loss: 32.507 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.714787244796753
Epoch: 6, Steps: 17 | Train Loss: 37.374 Vali Loss: 28.524 Vali Acc: 0.243 Test Loss: 28.524 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8046743869781494
Epoch: 7, Steps: 17 | Train Loss: 41.989 Vali Loss: 52.479 Vali Acc: 0.266 Test Loss: 52.479 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8242180347442627
Epoch: 8, Steps: 17 | Train Loss: 65.749 Vali Loss: 60.230 Vali Acc: 0.236 Test Loss: 60.230 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8045647144317627
Epoch: 9, Steps: 17 | Train Loss: 79.136 Vali Loss: 91.550 Vali Acc: 0.266 Test Loss: 91.550 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9899358749389648
Epoch: 10, Steps: 17 | Train Loss: 73.577 Vali Loss: 142.154 Vali Acc: 0.247 Test Loss: 142.154 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8064038753509521
Epoch: 11, Steps: 17 | Train Loss: 34.917 Vali Loss: 104.240 Vali Acc: 0.259 Test Loss: 104.240 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 998304
model size : 6.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.916832685470581
Epoch: 1, Steps: 17 | Train Loss: 15.236 Vali Loss: 20.477 Vali Acc: 0.259 Test Loss: 20.477 Test Acc: 0.259
Validation loss decreased (inf --> -0.258350).  Saving model ...
Epoch: 2 cost time: 1.8177056312561035
Epoch: 2, Steps: 17 | Train Loss: 26.024 Vali Loss: 31.948 Vali Acc: 0.251 Test Loss: 31.948 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6310710906982422
Epoch: 3, Steps: 17 | Train Loss: 36.371 Vali Loss: 51.080 Vali Acc: 0.255 Test Loss: 51.080 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7243783473968506
Epoch: 4, Steps: 17 | Train Loss: 49.344 Vali Loss: 49.705 Vali Acc: 0.251 Test Loss: 49.705 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8070404529571533
Epoch: 5, Steps: 17 | Train Loss: 39.431 Vali Loss: 34.834 Vali Acc: 0.251 Test Loss: 34.834 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.694525957107544
Epoch: 6, Steps: 17 | Train Loss: 36.011 Vali Loss: 95.516 Vali Acc: 0.247 Test Loss: 95.516 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.672440767288208
Epoch: 7, Steps: 17 | Train Loss: 63.228 Vali Loss: 104.629 Vali Acc: 0.259 Test Loss: 104.629 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7281670570373535
Epoch: 8, Steps: 17 | Train Loss: 67.560 Vali Loss: 64.573 Vali Acc: 0.224 Test Loss: 64.573 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.832007884979248
Epoch: 9, Steps: 17 | Train Loss: 45.114 Vali Loss: 58.835 Vali Acc: 0.243 Test Loss: 58.835 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7143058776855469
Epoch: 10, Steps: 17 | Train Loss: 33.343 Vali Loss: 56.175 Vali Acc: 0.228 Test Loss: 56.175 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.641585111618042
Epoch: 11, Steps: 17 | Train Loss: 45.571 Vali Loss: 82.425 Vali Acc: 0.243 Test Loss: 82.425 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 998304
model size : 6.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4511191844940186
Epoch: 1, Steps: 17 | Train Loss: 13.247 Vali Loss: 33.460 Vali Acc: 0.243 Test Loss: 33.460 Test Acc: 0.243
Validation loss decreased (inf --> -0.243011).  Saving model ...
Epoch: 2 cost time: 1.519467830657959
Epoch: 2, Steps: 17 | Train Loss: 26.342 Vali Loss: 31.272 Vali Acc: 0.255 Test Loss: 31.272 Test Acc: 0.255
Validation loss decreased (-0.243011 --> -0.254440).  Saving model ...
Epoch: 3 cost time: 1.6537957191467285
Epoch: 3, Steps: 17 | Train Loss: 27.581 Vali Loss: 37.250 Vali Acc: 0.236 Test Loss: 37.250 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5576171875
Epoch: 4, Steps: 17 | Train Loss: 24.735 Vali Loss: 35.837 Vali Acc: 0.259 Test Loss: 35.837 Test Acc: 0.259
Validation loss decreased (-0.254440 --> -0.258197).  Saving model ...
Epoch: 5 cost time: 1.6720776557922363
Epoch: 5, Steps: 17 | Train Loss: 26.725 Vali Loss: 48.764 Vali Acc: 0.262 Test Loss: 48.764 Test Acc: 0.262
Validation loss decreased (-0.258197 --> -0.261870).  Saving model ...
Epoch: 6 cost time: 1.5332658290863037
Epoch: 6, Steps: 17 | Train Loss: 43.052 Vali Loss: 99.984 Vali Acc: 0.251 Test Loss: 99.984 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5153584480285645
Epoch: 7, Steps: 17 | Train Loss: 58.493 Vali Loss: 35.178 Vali Acc: 0.236 Test Loss: 35.178 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4886143207550049
Epoch: 8, Steps: 17 | Train Loss: 28.905 Vali Loss: 37.511 Vali Acc: 0.262 Test Loss: 37.511 Test Acc: 0.262
Validation loss decreased (-0.261870 --> -0.261982).  Saving model ...
Epoch: 9 cost time: 1.6716339588165283
Epoch: 9, Steps: 17 | Train Loss: 49.540 Vali Loss: 88.924 Vali Acc: 0.251 Test Loss: 88.924 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7087945938110352
Epoch: 10, Steps: 17 | Train Loss: 58.176 Vali Loss: 96.494 Vali Acc: 0.247 Test Loss: 96.494 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6880066394805908
Epoch: 11, Steps: 17 | Train Loss: 80.432 Vali Loss: 92.108 Vali Acc: 0.251 Test Loss: 92.108 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6534721851348877
Epoch: 12, Steps: 17 | Train Loss: 45.658 Vali Loss: 48.302 Vali Acc: 0.247 Test Loss: 48.302 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5325427055358887
Epoch: 13, Steps: 17 | Train Loss: 21.261 Vali Loss: 123.100 Vali Acc: 0.262 Test Loss: 123.100 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8529725074768066
Epoch: 14, Steps: 17 | Train Loss: 23.175 Vali Loss: 75.532 Vali Acc: 0.259 Test Loss: 75.532 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6548469066619873
Epoch: 15, Steps: 17 | Train Loss: 15.506 Vali Loss: 156.736 Vali Acc: 0.262 Test Loss: 156.736 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6278491020202637
Epoch: 16, Steps: 17 | Train Loss: 32.302 Vali Loss: 93.575 Vali Acc: 0.232 Test Loss: 93.575 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.62156343460083
Epoch: 17, Steps: 17 | Train Loss: 19.013 Vali Loss: 129.528 Vali Acc: 0.259 Test Loss: 129.528 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7204480171203613
Epoch: 18, Steps: 17 | Train Loss: 13.920 Vali Loss: 102.996 Vali Acc: 0.274 Test Loss: 102.996 Test Acc: 0.274
Validation loss decreased (-0.261982 --> -0.272734).  Saving model ...
Epoch: 19 cost time: 1.463381290435791
Epoch: 19, Steps: 17 | Train Loss: 22.382 Vali Loss: 137.928 Vali Acc: 0.236 Test Loss: 137.928 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.697770118713379
Epoch: 20, Steps: 17 | Train Loss: 22.363 Vali Loss: 139.549 Vali Acc: 0.228 Test Loss: 139.549 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.683365821838379
Epoch: 21, Steps: 17 | Train Loss: 14.541 Vali Loss: 151.306 Vali Acc: 0.232 Test Loss: 151.306 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.791064739227295
Epoch: 22, Steps: 17 | Train Loss: 31.449 Vali Loss: 218.284 Vali Acc: 0.240 Test Loss: 218.284 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6682603359222412
Epoch: 23, Steps: 17 | Train Loss: 22.075 Vali Loss: 258.027 Vali Acc: 0.266 Test Loss: 258.027 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5971484184265137
Epoch: 24, Steps: 17 | Train Loss: 12.989 Vali Loss: 209.412 Vali Acc: 0.243 Test Loss: 209.412 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5001602172851562
Epoch: 25, Steps: 17 | Train Loss: 6.850 Vali Loss: 239.373 Vali Acc: 0.262 Test Loss: 239.373 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6697568893432617
Epoch: 26, Steps: 17 | Train Loss: 14.251 Vali Loss: 243.733 Vali Acc: 0.251 Test Loss: 243.733 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.485522747039795
Epoch: 27, Steps: 17 | Train Loss: 20.666 Vali Loss: 264.082 Vali Acc: 0.262 Test Loss: 264.082 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3497259616851807
Epoch: 28, Steps: 17 | Train Loss: 10.215 Vali Loss: 301.784 Vali Acc: 0.251 Test Loss: 301.784 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 998304
model size : 6.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.57712984085083
Epoch: 1, Steps: 17 | Train Loss: 14.815 Vali Loss: 43.310 Vali Acc: 0.251 Test Loss: 43.310 Test Acc: 0.251
Validation loss decreased (inf --> -0.250517).  Saving model ...
Epoch: 2 cost time: 1.1507244110107422
Epoch: 2, Steps: 17 | Train Loss: 33.341 Vali Loss: 30.476 Vali Acc: 0.278 Test Loss: 30.476 Test Acc: 0.278
Validation loss decreased (-0.250517 --> -0.277262).  Saving model ...
Epoch: 3 cost time: 1.0022661685943604
Epoch: 3, Steps: 17 | Train Loss: 22.906 Vali Loss: 22.363 Vali Acc: 0.228 Test Loss: 22.363 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2214484214782715
Epoch: 4, Steps: 17 | Train Loss: 16.471 Vali Loss: 33.079 Vali Acc: 0.255 Test Loss: 33.079 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2042922973632812
Epoch: 5, Steps: 17 | Train Loss: 38.803 Vali Loss: 66.376 Vali Acc: 0.228 Test Loss: 66.376 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2552227973937988
Epoch: 6, Steps: 17 | Train Loss: 40.403 Vali Loss: 76.116 Vali Acc: 0.247 Test Loss: 76.116 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.088212013244629
Epoch: 7, Steps: 17 | Train Loss: 75.703 Vali Loss: 67.407 Vali Acc: 0.240 Test Loss: 67.407 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.226926565170288
Epoch: 8, Steps: 17 | Train Loss: 81.152 Vali Loss: 110.213 Vali Acc: 0.270 Test Loss: 110.213 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4228060245513916
Epoch: 9, Steps: 17 | Train Loss: 78.386 Vali Loss: 74.979 Vali Acc: 0.259 Test Loss: 74.979 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3881220817565918
Epoch: 10, Steps: 17 | Train Loss: 36.099 Vali Loss: 33.164 Vali Acc: 0.274 Test Loss: 33.164 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6897337436676025
Epoch: 11, Steps: 17 | Train Loss: 16.081 Vali Loss: 37.738 Vali Acc: 0.247 Test Loss: 37.738 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6735546588897705
Epoch: 12, Steps: 17 | Train Loss: 22.077 Vali Loss: 52.036 Vali Acc: 0.255 Test Loss: 52.036 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 998304
model size : 6.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.114952325820923
Epoch: 1, Steps: 17 | Train Loss: 16.435 Vali Loss: 30.511 Vali Acc: 0.255 Test Loss: 30.511 Test Acc: 0.255
Validation loss decreased (inf --> -0.254448).  Saving model ...
Epoch: 2 cost time: 1.850921630859375
Epoch: 2, Steps: 17 | Train Loss: 30.070 Vali Loss: 20.793 Vali Acc: 0.228 Test Loss: 20.793 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0509285926818848
Epoch: 3, Steps: 17 | Train Loss: 33.014 Vali Loss: 16.266 Vali Acc: 0.255 Test Loss: 16.266 Test Acc: 0.255
Validation loss decreased (-0.254448 --> -0.254590).  Saving model ...
Epoch: 4 cost time: 2.0858848094940186
Epoch: 4, Steps: 17 | Train Loss: 29.001 Vali Loss: 39.468 Vali Acc: 0.240 Test Loss: 39.468 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9241657257080078
Epoch: 5, Steps: 17 | Train Loss: 32.824 Vali Loss: 58.000 Vali Acc: 0.240 Test Loss: 58.000 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.050347089767456
Epoch: 6, Steps: 17 | Train Loss: 30.739 Vali Loss: 23.507 Vali Acc: 0.251 Test Loss: 23.507 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9545512199401855
Epoch: 7, Steps: 17 | Train Loss: 56.062 Vali Loss: 70.090 Vali Acc: 0.236 Test Loss: 70.090 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9576332569122314
Epoch: 8, Steps: 17 | Train Loss: 48.360 Vali Loss: 62.012 Vali Acc: 0.266 Test Loss: 62.012 Test Acc: 0.266
Validation loss decreased (-0.254590 --> -0.265540).  Saving model ...
Epoch: 9 cost time: 1.7961344718933105
Epoch: 9, Steps: 17 | Train Loss: 38.513 Vali Loss: 92.603 Vali Acc: 0.243 Test Loss: 92.603 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.828859567642212
Epoch: 10, Steps: 17 | Train Loss: 49.910 Vali Loss: 59.470 Vali Acc: 0.247 Test Loss: 59.470 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.719733476638794
Epoch: 11, Steps: 17 | Train Loss: 43.159 Vali Loss: 51.047 Vali Acc: 0.221 Test Loss: 51.047 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7185380458831787
Epoch: 12, Steps: 17 | Train Loss: 28.357 Vali Loss: 129.491 Vali Acc: 0.251 Test Loss: 129.491 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9522879123687744
Epoch: 13, Steps: 17 | Train Loss: 53.515 Vali Loss: 113.916 Vali Acc: 0.243 Test Loss: 113.916 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.093339443206787
Epoch: 14, Steps: 17 | Train Loss: 34.894 Vali Loss: 72.137 Vali Acc: 0.281 Test Loss: 72.137 Test Acc: 0.281
Validation loss decreased (-0.265540 --> -0.280647).  Saving model ...
Epoch: 15 cost time: 1.8497817516326904
Epoch: 15, Steps: 17 | Train Loss: 33.308 Vali Loss: 121.194 Vali Acc: 0.274 Test Loss: 121.194 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9027941226959229
Epoch: 16, Steps: 17 | Train Loss: 29.461 Vali Loss: 161.743 Vali Acc: 0.255 Test Loss: 161.743 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8054249286651611
Epoch: 17, Steps: 17 | Train Loss: 29.732 Vali Loss: 145.041 Vali Acc: 0.270 Test Loss: 145.041 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.1254732608795166
Epoch: 18, Steps: 17 | Train Loss: 26.189 Vali Loss: 135.785 Vali Acc: 0.232 Test Loss: 135.785 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8507716655731201
Epoch: 19, Steps: 17 | Train Loss: 19.793 Vali Loss: 156.368 Vali Acc: 0.255 Test Loss: 156.368 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.786881446838379
Epoch: 20, Steps: 17 | Train Loss: 15.903 Vali Loss: 202.640 Vali Acc: 0.289 Test Loss: 202.640 Test Acc: 0.289
Validation loss decreased (-0.280647 --> -0.286947).  Saving model ...
Epoch: 21 cost time: 1.8738112449645996
Epoch: 21, Steps: 17 | Train Loss: 31.501 Vali Loss: 143.868 Vali Acc: 0.259 Test Loss: 143.868 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9007759094238281
Epoch: 22, Steps: 17 | Train Loss: 21.367 Vali Loss: 174.904 Vali Acc: 0.278 Test Loss: 174.904 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9222943782806396
Epoch: 23, Steps: 17 | Train Loss: 33.747 Vali Loss: 226.476 Vali Acc: 0.259 Test Loss: 226.476 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8885157108306885
Epoch: 24, Steps: 17 | Train Loss: 18.076 Vali Loss: 188.343 Vali Acc: 0.289 Test Loss: 188.343 Test Acc: 0.289
Validation loss decreased (-0.286947 --> -0.287090).  Saving model ...
Epoch: 25 cost time: 1.9460608959197998
Epoch: 25, Steps: 17 | Train Loss: 29.660 Vali Loss: 232.571 Vali Acc: 0.255 Test Loss: 232.571 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9720160961151123
Epoch: 26, Steps: 17 | Train Loss: 14.935 Vali Loss: 281.698 Vali Acc: 0.266 Test Loss: 281.698 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8281869888305664
Epoch: 27, Steps: 17 | Train Loss: 14.662 Vali Loss: 324.381 Vali Acc: 0.270 Test Loss: 324.381 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6430573463439941
Epoch: 28, Steps: 17 | Train Loss: 22.072 Vali Loss: 317.261 Vali Acc: 0.297 Test Loss: 317.261 Test Acc: 0.297
Validation loss decreased (-0.287090 --> -0.293405).  Saving model ...
Epoch: 29 cost time: 2.011784553527832
Epoch: 29, Steps: 17 | Train Loss: 9.571 Vali Loss: 340.958 Vali Acc: 0.281 Test Loss: 340.958 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8546874523162842
Epoch: 30, Steps: 17 | Train Loss: 7.172 Vali Loss: 377.448 Vali Acc: 0.240 Test Loss: 377.448 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.8157250881195068
Epoch: 31, Steps: 17 | Train Loss: 4.471 Vali Loss: 414.615 Vali Acc: 0.262 Test Loss: 414.615 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7991814613342285
Epoch: 32, Steps: 17 | Train Loss: 6.813 Vali Loss: 458.770 Vali Acc: 0.274 Test Loss: 458.770 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.8969435691833496
Epoch: 33, Steps: 17 | Train Loss: 42.803 Vali Loss: 658.574 Vali Acc: 0.274 Test Loss: 658.574 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.7621128559112549
Epoch: 34, Steps: 17 | Train Loss: 7.531 Vali Loss: 547.695 Vali Acc: 0.255 Test Loss: 547.695 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.7999787330627441
Epoch: 35, Steps: 17 | Train Loss: 5.430 Vali Loss: 513.945 Vali Acc: 0.247 Test Loss: 513.945 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.8747634887695312
Epoch: 36, Steps: 17 | Train Loss: 2.118 Vali Loss: 532.691 Vali Acc: 0.266 Test Loss: 532.691 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.0586624145507812
Epoch: 37, Steps: 17 | Train Loss: 10.691 Vali Loss: 569.789 Vali Acc: 0.259 Test Loss: 569.789 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.900726556777954
Epoch: 38, Steps: 17 | Train Loss: 7.988 Vali Loss: 614.795 Vali Acc: 0.251 Test Loss: 614.795 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 965536
model size : 6.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5851590633392334
Epoch: 1, Steps: 17 | Train Loss: 16.917 Vali Loss: 17.525 Vali Acc: 0.228 Test Loss: 17.525 Test Acc: 0.228
Validation loss decreased (inf --> -0.227962).  Saving model ...
Epoch: 2 cost time: 1.8036439418792725
Epoch: 2, Steps: 17 | Train Loss: 23.093 Vali Loss: 28.146 Vali Acc: 0.243 Test Loss: 28.146 Test Acc: 0.243
Validation loss decreased (-0.227962 --> -0.243065).  Saving model ...
Epoch: 3 cost time: 1.7143261432647705
Epoch: 3, Steps: 17 | Train Loss: 25.756 Vali Loss: 32.408 Vali Acc: 0.247 Test Loss: 32.408 Test Acc: 0.247
Validation loss decreased (-0.243065 --> -0.246824).  Saving model ...
Epoch: 4 cost time: 1.6779286861419678
Epoch: 4, Steps: 17 | Train Loss: 47.530 Vali Loss: 63.335 Vali Acc: 0.232 Test Loss: 63.335 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8383700847625732
Epoch: 5, Steps: 17 | Train Loss: 75.121 Vali Loss: 36.686 Vali Acc: 0.232 Test Loss: 36.686 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9396560192108154
Epoch: 6, Steps: 17 | Train Loss: 40.696 Vali Loss: 54.466 Vali Acc: 0.228 Test Loss: 54.466 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9148290157318115
Epoch: 7, Steps: 17 | Train Loss: 35.884 Vali Loss: 32.699 Vali Acc: 0.270 Test Loss: 32.699 Test Acc: 0.270
Validation loss decreased (-0.246824 --> -0.269635).  Saving model ...
Epoch: 8 cost time: 1.779662847518921
Epoch: 8, Steps: 17 | Train Loss: 41.762 Vali Loss: 54.893 Vali Acc: 0.240 Test Loss: 54.893 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8913788795471191
Epoch: 9, Steps: 17 | Train Loss: 59.228 Vali Loss: 111.802 Vali Acc: 0.243 Test Loss: 111.802 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7575352191925049
Epoch: 10, Steps: 17 | Train Loss: 30.011 Vali Loss: 42.842 Vali Acc: 0.217 Test Loss: 42.842 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.968064546585083
Epoch: 11, Steps: 17 | Train Loss: 40.975 Vali Loss: 33.214 Vali Acc: 0.266 Test Loss: 33.214 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9948859214782715
Epoch: 12, Steps: 17 | Train Loss: 19.385 Vali Loss: 40.350 Vali Acc: 0.243 Test Loss: 40.350 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8980603218078613
Epoch: 13, Steps: 17 | Train Loss: 19.107 Vali Loss: 75.959 Vali Acc: 0.259 Test Loss: 75.959 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6336157321929932
Epoch: 14, Steps: 17 | Train Loss: 38.917 Vali Loss: 95.625 Vali Acc: 0.228 Test Loss: 95.625 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.047139883041382
Epoch: 15, Steps: 17 | Train Loss: 21.800 Vali Loss: 111.657 Vali Acc: 0.266 Test Loss: 111.657 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.045954465866089
Epoch: 16, Steps: 17 | Train Loss: 28.639 Vali Loss: 76.008 Vali Acc: 0.262 Test Loss: 76.008 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.902193307876587
Epoch: 17, Steps: 17 | Train Loss: 20.338 Vali Loss: 108.689 Vali Acc: 0.228 Test Loss: 108.689 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 965536
model size : 6.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.043281078338623
Epoch: 1, Steps: 17 | Train Loss: 15.987 Vali Loss: 13.331 Vali Acc: 0.289 Test Loss: 13.331 Test Acc: 0.289
Validation loss decreased (inf --> -0.288840).  Saving model ...
Epoch: 2 cost time: 1.7853565216064453
Epoch: 2, Steps: 17 | Train Loss: 22.446 Vali Loss: 22.663 Vali Acc: 0.243 Test Loss: 22.663 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8643012046813965
Epoch: 3, Steps: 17 | Train Loss: 33.880 Vali Loss: 36.682 Vali Acc: 0.232 Test Loss: 36.682 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9410669803619385
Epoch: 4, Steps: 17 | Train Loss: 32.704 Vali Loss: 23.218 Vali Acc: 0.251 Test Loss: 23.218 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8518438339233398
Epoch: 5, Steps: 17 | Train Loss: 36.438 Vali Loss: 49.226 Vali Acc: 0.266 Test Loss: 49.226 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9094626903533936
Epoch: 6, Steps: 17 | Train Loss: 36.542 Vali Loss: 25.374 Vali Acc: 0.224 Test Loss: 25.374 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.958162546157837
Epoch: 7, Steps: 17 | Train Loss: 61.867 Vali Loss: 67.657 Vali Acc: 0.247 Test Loss: 67.657 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8919193744659424
Epoch: 8, Steps: 17 | Train Loss: 44.009 Vali Loss: 43.731 Vali Acc: 0.243 Test Loss: 43.731 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.828866958618164
Epoch: 9, Steps: 17 | Train Loss: 29.455 Vali Loss: 42.519 Vali Acc: 0.266 Test Loss: 42.519 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.786496639251709
Epoch: 10, Steps: 17 | Train Loss: 42.860 Vali Loss: 70.488 Vali Acc: 0.251 Test Loss: 70.488 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7271902561187744
Epoch: 11, Steps: 17 | Train Loss: 67.333 Vali Loss: 107.872 Vali Acc: 0.293 Test Loss: 107.872 Test Acc: 0.293
Validation loss decreased (-0.288840 --> -0.291697).  Saving model ...
Epoch: 12 cost time: 1.7508118152618408
Epoch: 12, Steps: 17 | Train Loss: 37.130 Vali Loss: 36.433 Vali Acc: 0.255 Test Loss: 36.433 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6701173782348633
Epoch: 13, Steps: 17 | Train Loss: 26.994 Vali Loss: 68.526 Vali Acc: 0.251 Test Loss: 68.526 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8136467933654785
Epoch: 14, Steps: 17 | Train Loss: 39.607 Vali Loss: 72.047 Vali Acc: 0.243 Test Loss: 72.047 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.796454906463623
Epoch: 15, Steps: 17 | Train Loss: 21.027 Vali Loss: 88.841 Vali Acc: 0.259 Test Loss: 88.841 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8827733993530273
Epoch: 16, Steps: 17 | Train Loss: 11.750 Vali Loss: 115.117 Vali Acc: 0.221 Test Loss: 115.117 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.708841323852539
Epoch: 17, Steps: 17 | Train Loss: 22.395 Vali Loss: 108.265 Vali Acc: 0.278 Test Loss: 108.265 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7753841876983643
Epoch: 18, Steps: 17 | Train Loss: 19.936 Vali Loss: 118.101 Vali Acc: 0.262 Test Loss: 118.101 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5900728702545166
Epoch: 19, Steps: 17 | Train Loss: 11.773 Vali Loss: 113.180 Vali Acc: 0.240 Test Loss: 113.180 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.710709810256958
Epoch: 20, Steps: 17 | Train Loss: 10.137 Vali Loss: 195.096 Vali Acc: 0.289 Test Loss: 195.096 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.936063289642334
Epoch: 21, Steps: 17 | Train Loss: 20.053 Vali Loss: 214.238 Vali Acc: 0.251 Test Loss: 214.238 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 965536
model size : 6.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5091848373413086
Epoch: 1, Steps: 17 | Train Loss: 14.343 Vali Loss: 12.731 Vali Acc: 0.255 Test Loss: 12.731 Test Acc: 0.255
Validation loss decreased (inf --> -0.254626).  Saving model ...
Epoch: 2 cost time: 1.5751166343688965
Epoch: 2, Steps: 17 | Train Loss: 13.426 Vali Loss: 47.485 Vali Acc: 0.259 Test Loss: 47.485 Test Acc: 0.259
Validation loss decreased (-0.254626 --> -0.258080).  Saving model ...
Epoch: 3 cost time: 1.4928631782531738
Epoch: 3, Steps: 17 | Train Loss: 27.889 Vali Loss: 39.556 Vali Acc: 0.255 Test Loss: 39.556 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6960341930389404
Epoch: 4, Steps: 17 | Train Loss: 19.148 Vali Loss: 18.372 Vali Acc: 0.274 Test Loss: 18.372 Test Acc: 0.274
Validation loss decreased (-0.258080 --> -0.273581).  Saving model ...
Epoch: 5 cost time: 1.6744580268859863
Epoch: 5, Steps: 17 | Train Loss: 20.836 Vali Loss: 35.470 Vali Acc: 0.255 Test Loss: 35.470 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6137726306915283
Epoch: 6, Steps: 17 | Train Loss: 43.861 Vali Loss: 85.892 Vali Acc: 0.251 Test Loss: 85.892 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.673858404159546
Epoch: 7, Steps: 17 | Train Loss: 80.065 Vali Loss: 45.993 Vali Acc: 0.247 Test Loss: 45.993 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5843722820281982
Epoch: 8, Steps: 17 | Train Loss: 52.722 Vali Loss: 69.938 Vali Acc: 0.240 Test Loss: 69.938 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3033900260925293
Epoch: 9, Steps: 17 | Train Loss: 37.338 Vali Loss: 71.010 Vali Acc: 0.259 Test Loss: 71.010 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.61844801902771
Epoch: 10, Steps: 17 | Train Loss: 49.932 Vali Loss: 43.837 Vali Acc: 0.251 Test Loss: 43.837 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6078269481658936
Epoch: 11, Steps: 17 | Train Loss: 47.691 Vali Loss: 74.839 Vali Acc: 0.259 Test Loss: 74.839 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7711613178253174
Epoch: 12, Steps: 17 | Train Loss: 43.067 Vali Loss: 70.634 Vali Acc: 0.236 Test Loss: 70.634 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.654618501663208
Epoch: 13, Steps: 17 | Train Loss: 30.097 Vali Loss: 64.508 Vali Acc: 0.255 Test Loss: 64.508 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5482559204101562
Epoch: 14, Steps: 17 | Train Loss: 23.499 Vali Loss: 112.881 Vali Acc: 0.247 Test Loss: 112.881 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 965536
model size : 6.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.247967004776001
Epoch: 1, Steps: 17 | Train Loss: 16.782 Vali Loss: 30.821 Vali Acc: 0.251 Test Loss: 30.821 Test Acc: 0.251
Validation loss decreased (inf --> -0.250642).  Saving model ...
Epoch: 2 cost time: 1.886181354522705
Epoch: 2, Steps: 17 | Train Loss: 30.127 Vali Loss: 30.670 Vali Acc: 0.281 Test Loss: 30.670 Test Acc: 0.281
Validation loss decreased (-0.250642 --> -0.281062).  Saving model ...
Epoch: 3 cost time: 1.9153261184692383
Epoch: 3, Steps: 17 | Train Loss: 19.861 Vali Loss: 20.463 Vali Acc: 0.251 Test Loss: 20.463 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9377145767211914
Epoch: 4, Steps: 17 | Train Loss: 40.299 Vali Loss: 26.448 Vali Acc: 0.221 Test Loss: 26.448 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9037654399871826
Epoch: 5, Steps: 17 | Train Loss: 30.440 Vali Loss: 25.692 Vali Acc: 0.236 Test Loss: 25.692 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8991737365722656
Epoch: 6, Steps: 17 | Train Loss: 28.415 Vali Loss: 30.991 Vali Acc: 0.270 Test Loss: 30.991 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8549885749816895
Epoch: 7, Steps: 17 | Train Loss: 62.184 Vali Loss: 181.621 Vali Acc: 0.251 Test Loss: 181.621 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.876579999923706
Epoch: 8, Steps: 17 | Train Loss: 80.975 Vali Loss: 94.422 Vali Acc: 0.247 Test Loss: 94.422 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0942564010620117
Epoch: 9, Steps: 17 | Train Loss: 79.942 Vali Loss: 86.548 Vali Acc: 0.247 Test Loss: 86.548 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9206156730651855
Epoch: 10, Steps: 17 | Train Loss: 50.118 Vali Loss: 82.695 Vali Acc: 0.243 Test Loss: 82.695 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8970389366149902
Epoch: 11, Steps: 17 | Train Loss: 32.684 Vali Loss: 54.643 Vali Acc: 0.221 Test Loss: 54.643 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.909703254699707
Epoch: 12, Steps: 17 | Train Loss: 35.191 Vali Loss: 40.790 Vali Acc: 0.262 Test Loss: 40.790 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 949152
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6816723346710205
Epoch: 1, Steps: 17 | Train Loss: 16.626 Vali Loss: 15.229 Vali Acc: 0.259 Test Loss: 15.229 Test Acc: 0.259
Validation loss decreased (inf --> -0.258403).  Saving model ...
Epoch: 2 cost time: 1.72843337059021
Epoch: 2, Steps: 17 | Train Loss: 27.614 Vali Loss: 36.039 Vali Acc: 0.247 Test Loss: 36.039 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6507418155670166
Epoch: 3, Steps: 17 | Train Loss: 30.715 Vali Loss: 27.633 Vali Acc: 0.221 Test Loss: 27.633 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7242276668548584
Epoch: 4, Steps: 17 | Train Loss: 49.101 Vali Loss: 73.019 Vali Acc: 0.255 Test Loss: 73.019 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8825578689575195
Epoch: 5, Steps: 17 | Train Loss: 46.747 Vali Loss: 50.344 Vali Acc: 0.259 Test Loss: 50.344 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6656765937805176
Epoch: 6, Steps: 17 | Train Loss: 39.808 Vali Loss: 104.749 Vali Acc: 0.266 Test Loss: 104.749 Test Acc: 0.266
Validation loss decreased (-0.258403 --> -0.265112).  Saving model ...
Epoch: 7 cost time: 1.749406099319458
Epoch: 7, Steps: 17 | Train Loss: 63.731 Vali Loss: 110.190 Vali Acc: 0.247 Test Loss: 110.190 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7815122604370117
Epoch: 8, Steps: 17 | Train Loss: 55.677 Vali Loss: 97.038 Vali Acc: 0.243 Test Loss: 97.038 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7569313049316406
Epoch: 9, Steps: 17 | Train Loss: 84.030 Vali Loss: 99.690 Vali Acc: 0.255 Test Loss: 99.690 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7983832359313965
Epoch: 10, Steps: 17 | Train Loss: 35.564 Vali Loss: 39.006 Vali Acc: 0.251 Test Loss: 39.006 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.76253080368042
Epoch: 11, Steps: 17 | Train Loss: 39.702 Vali Loss: 94.460 Vali Acc: 0.259 Test Loss: 94.460 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8246843814849854
Epoch: 12, Steps: 17 | Train Loss: 37.812 Vali Loss: 100.352 Vali Acc: 0.274 Test Loss: 100.352 Test Acc: 0.274
Validation loss decreased (-0.265112 --> -0.272761).  Saving model ...
Epoch: 13 cost time: 1.6577377319335938
Epoch: 13, Steps: 17 | Train Loss: 35.265 Vali Loss: 86.001 Vali Acc: 0.228 Test Loss: 86.001 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7200424671173096
Epoch: 14, Steps: 17 | Train Loss: 30.471 Vali Loss: 113.285 Vali Acc: 0.266 Test Loss: 113.285 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8181376457214355
Epoch: 15, Steps: 17 | Train Loss: 26.336 Vali Loss: 87.681 Vali Acc: 0.285 Test Loss: 87.681 Test Acc: 0.285
Validation loss decreased (-0.272761 --> -0.284294).  Saving model ...
Epoch: 16 cost time: 1.9410407543182373
Epoch: 16, Steps: 17 | Train Loss: 23.397 Vali Loss: 70.482 Vali Acc: 0.262 Test Loss: 70.482 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6908774375915527
Epoch: 17, Steps: 17 | Train Loss: 22.222 Vali Loss: 122.473 Vali Acc: 0.270 Test Loss: 122.473 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5962495803833008
Epoch: 18, Steps: 17 | Train Loss: 38.644 Vali Loss: 118.505 Vali Acc: 0.270 Test Loss: 118.505 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6100170612335205
Epoch: 19, Steps: 17 | Train Loss: 20.665 Vali Loss: 158.694 Vali Acc: 0.278 Test Loss: 158.694 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6567356586456299
Epoch: 20, Steps: 17 | Train Loss: 18.220 Vali Loss: 125.750 Vali Acc: 0.247 Test Loss: 125.750 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6023247241973877
Epoch: 21, Steps: 17 | Train Loss: 16.975 Vali Loss: 158.044 Vali Acc: 0.259 Test Loss: 158.044 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6435861587524414
Epoch: 22, Steps: 17 | Train Loss: 11.345 Vali Loss: 149.831 Vali Acc: 0.278 Test Loss: 149.831 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7763128280639648
Epoch: 23, Steps: 17 | Train Loss: 13.371 Vali Loss: 200.277 Vali Acc: 0.240 Test Loss: 200.277 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7474052906036377
Epoch: 24, Steps: 17 | Train Loss: 9.665 Vali Loss: 209.277 Vali Acc: 0.236 Test Loss: 209.277 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.704411506652832
Epoch: 25, Steps: 17 | Train Loss: 7.855 Vali Loss: 230.841 Vali Acc: 0.243 Test Loss: 230.841 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 949152
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5345261096954346
Epoch: 1, Steps: 17 | Train Loss: 12.971 Vali Loss: 29.350 Vali Acc: 0.247 Test Loss: 29.350 Test Acc: 0.247
Validation loss decreased (inf --> -0.246855).  Saving model ...
Epoch: 2 cost time: 1.6213884353637695
Epoch: 2, Steps: 17 | Train Loss: 19.975 Vali Loss: 13.073 Vali Acc: 0.251 Test Loss: 13.073 Test Acc: 0.251
Validation loss decreased (-0.246855 --> -0.250820).  Saving model ...
Epoch: 3 cost time: 1.227715015411377
Epoch: 3, Steps: 17 | Train Loss: 22.343 Vali Loss: 46.308 Vali Acc: 0.251 Test Loss: 46.308 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4035091400146484
Epoch: 4, Steps: 17 | Train Loss: 28.532 Vali Loss: 16.862 Vali Acc: 0.251 Test Loss: 16.862 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4729297161102295
Epoch: 5, Steps: 17 | Train Loss: 34.946 Vali Loss: 67.142 Vali Acc: 0.243 Test Loss: 67.142 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4878261089324951
Epoch: 6, Steps: 17 | Train Loss: 36.701 Vali Loss: 48.820 Vali Acc: 0.243 Test Loss: 48.820 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5278804302215576
Epoch: 7, Steps: 17 | Train Loss: 50.360 Vali Loss: 52.321 Vali Acc: 0.236 Test Loss: 52.321 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5479633808135986
Epoch: 8, Steps: 17 | Train Loss: 59.517 Vali Loss: 44.942 Vali Acc: 0.221 Test Loss: 44.942 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6450023651123047
Epoch: 9, Steps: 17 | Train Loss: 49.118 Vali Loss: 37.610 Vali Acc: 0.202 Test Loss: 37.610 Test Acc: 0.202
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6302316188812256
Epoch: 10, Steps: 17 | Train Loss: 28.525 Vali Loss: 57.187 Vali Acc: 0.243 Test Loss: 57.187 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.722071886062622
Epoch: 11, Steps: 17 | Train Loss: 39.292 Vali Loss: 33.887 Vali Acc: 0.251 Test Loss: 33.887 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6195707321166992
Epoch: 12, Steps: 17 | Train Loss: 34.770 Vali Loss: 58.284 Vali Acc: 0.240 Test Loss: 58.284 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2509505703422053
model parameter : 949152
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5543289184570312
Epoch: 1, Steps: 17 | Train Loss: 11.575 Vali Loss: 19.167 Vali Acc: 0.247 Test Loss: 19.167 Test Acc: 0.247
Validation loss decreased (inf --> -0.246957).  Saving model ...
Epoch: 2 cost time: 1.503504753112793
Epoch: 2, Steps: 17 | Train Loss: 28.374 Vali Loss: 26.997 Vali Acc: 0.262 Test Loss: 26.997 Test Acc: 0.262
Validation loss decreased (-0.246957 --> -0.262087).  Saving model ...
Epoch: 3 cost time: 1.5130293369293213
Epoch: 3, Steps: 17 | Train Loss: 31.071 Vali Loss: 25.545 Vali Acc: 0.247 Test Loss: 25.545 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5317187309265137
Epoch: 4, Steps: 17 | Train Loss: 35.748 Vali Loss: 44.582 Vali Acc: 0.251 Test Loss: 44.582 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6112587451934814
Epoch: 5, Steps: 17 | Train Loss: 39.868 Vali Loss: 34.051 Vali Acc: 0.247 Test Loss: 34.051 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.596937656402588
Epoch: 6, Steps: 17 | Train Loss: 36.989 Vali Loss: 53.506 Vali Acc: 0.255 Test Loss: 53.506 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.508174180984497
Epoch: 7, Steps: 17 | Train Loss: 42.020 Vali Loss: 89.698 Vali Acc: 0.251 Test Loss: 89.698 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.66098952293396
Epoch: 8, Steps: 17 | Train Loss: 64.311 Vali Loss: 101.280 Vali Acc: 0.251 Test Loss: 101.280 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5570855140686035
Epoch: 9, Steps: 17 | Train Loss: 76.667 Vali Loss: 89.473 Vali Acc: 0.255 Test Loss: 89.473 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5735726356506348
Epoch: 10, Steps: 17 | Train Loss: 31.622 Vali Loss: 44.207 Vali Acc: 0.259 Test Loss: 44.207 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5531411170959473
Epoch: 11, Steps: 17 | Train Loss: 40.522 Vali Loss: 85.584 Vali Acc: 0.262 Test Loss: 85.584 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.631728172302246
Epoch: 12, Steps: 17 | Train Loss: 34.393 Vali Loss: 69.936 Vali Acc: 0.274 Test Loss: 69.936 Test Acc: 0.274
Validation loss decreased (-0.262087 --> -0.273065).  Saving model ...
Epoch: 13 cost time: 1.437422513961792
Epoch: 13, Steps: 17 | Train Loss: 24.259 Vali Loss: 82.576 Vali Acc: 0.270 Test Loss: 82.576 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7329120635986328
Epoch: 14, Steps: 17 | Train Loss: 26.858 Vali Loss: 73.052 Vali Acc: 0.262 Test Loss: 73.052 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6835858821868896
Epoch: 15, Steps: 17 | Train Loss: 18.781 Vali Loss: 81.662 Vali Acc: 0.255 Test Loss: 81.662 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5251142978668213
Epoch: 16, Steps: 17 | Train Loss: 16.170 Vali Loss: 65.992 Vali Acc: 0.266 Test Loss: 65.992 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.46266770362854
Epoch: 17, Steps: 17 | Train Loss: 9.108 Vali Loss: 87.567 Vali Acc: 0.243 Test Loss: 87.567 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4084184169769287
Epoch: 18, Steps: 17 | Train Loss: 16.171 Vali Loss: 125.226 Vali Acc: 0.240 Test Loss: 125.226 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5570790767669678
Epoch: 19, Steps: 17 | Train Loss: 18.065 Vali Loss: 128.451 Vali Acc: 0.232 Test Loss: 128.451 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5955302715301514
Epoch: 20, Steps: 17 | Train Loss: 15.915 Vali Loss: 136.260 Vali Acc: 0.255 Test Loss: 136.260 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6539630889892578
Epoch: 21, Steps: 17 | Train Loss: 32.745 Vali Loss: 148.712 Vali Acc: 0.293 Test Loss: 148.712 Test Acc: 0.293
Validation loss decreased (-0.273065 --> -0.291289).  Saving model ...
Epoch: 22 cost time: 1.5275404453277588
Epoch: 22, Steps: 17 | Train Loss: 14.320 Vali Loss: 204.762 Vali Acc: 0.266 Test Loss: 204.762 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5676548480987549
Epoch: 23, Steps: 17 | Train Loss: 7.205 Vali Loss: 200.540 Vali Acc: 0.240 Test Loss: 200.540 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4646577835083008
Epoch: 24, Steps: 17 | Train Loss: 21.482 Vali Loss: 255.993 Vali Acc: 0.236 Test Loss: 255.993 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4475934505462646
Epoch: 25, Steps: 17 | Train Loss: 9.337 Vali Loss: 264.765 Vali Acc: 0.270 Test Loss: 264.765 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6241066455841064
Epoch: 26, Steps: 17 | Train Loss: 17.024 Vali Loss: 278.217 Vali Acc: 0.266 Test Loss: 278.217 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.438776969909668
Epoch: 27, Steps: 17 | Train Loss: 15.465 Vali Loss: 317.963 Vali Acc: 0.255 Test Loss: 317.963 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6021654605865479
Epoch: 28, Steps: 17 | Train Loss: 11.204 Vali Loss: 337.499 Vali Acc: 0.224 Test Loss: 337.499 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6264023780822754
Epoch: 29, Steps: 17 | Train Loss: 12.489 Vali Loss: 425.284 Vali Acc: 0.243 Test Loss: 425.284 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5410661697387695
Epoch: 30, Steps: 17 | Train Loss: 23.573 Vali Loss: 358.428 Vali Acc: 0.255 Test Loss: 358.428 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.484715461730957
Epoch: 31, Steps: 17 | Train Loss: 6.274 Vali Loss: 351.101 Vali Acc: 0.251 Test Loss: 351.101 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 949152
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6733245849609375
Epoch: 1, Steps: 17 | Train Loss: 7.734 Vali Loss: 14.504 Vali Acc: 0.259 Test Loss: 14.504 Test Acc: 0.259
Validation loss decreased (inf --> -0.258410).  Saving model ...
Epoch: 2 cost time: 1.4508435726165771
Epoch: 2, Steps: 17 | Train Loss: 9.961 Vali Loss: 8.504 Vali Acc: 0.247 Test Loss: 8.504 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.335683822631836
Epoch: 3, Steps: 17 | Train Loss: 11.156 Vali Loss: 19.972 Vali Acc: 0.259 Test Loss: 19.972 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4156455993652344
Epoch: 4, Steps: 17 | Train Loss: 19.982 Vali Loss: 16.455 Vali Acc: 0.240 Test Loss: 16.455 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4871783256530762
Epoch: 5, Steps: 17 | Train Loss: 21.211 Vali Loss: 13.702 Vali Acc: 0.240 Test Loss: 13.702 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5951783657073975
Epoch: 6, Steps: 17 | Train Loss: 18.519 Vali Loss: 54.256 Vali Acc: 0.251 Test Loss: 54.256 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4687573909759521
Epoch: 7, Steps: 17 | Train Loss: 24.069 Vali Loss: 31.244 Vali Acc: 0.270 Test Loss: 31.244 Test Acc: 0.270
Validation loss decreased (-0.258410 --> -0.269650).  Saving model ...
Epoch: 8 cost time: 1.7318992614746094
Epoch: 8, Steps: 17 | Train Loss: 22.541 Vali Loss: 27.595 Vali Acc: 0.262 Test Loss: 27.595 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9099462032318115
Epoch: 9, Steps: 17 | Train Loss: 24.793 Vali Loss: 30.076 Vali Acc: 0.205 Test Loss: 30.076 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7436347007751465
Epoch: 10, Steps: 17 | Train Loss: 21.135 Vali Loss: 42.175 Vali Acc: 0.255 Test Loss: 42.175 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8680408000946045
Epoch: 11, Steps: 17 | Train Loss: 35.731 Vali Loss: 53.818 Vali Acc: 0.274 Test Loss: 53.818 Test Acc: 0.274
Validation loss decreased (-0.269650 --> -0.273226).  Saving model ...
Epoch: 12 cost time: 1.7619564533233643
Epoch: 12, Steps: 17 | Train Loss: 29.738 Vali Loss: 68.216 Vali Acc: 0.266 Test Loss: 68.216 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.730482816696167
Epoch: 13, Steps: 17 | Train Loss: 27.323 Vali Loss: 36.451 Vali Acc: 0.255 Test Loss: 36.451 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8615710735321045
Epoch: 14, Steps: 17 | Train Loss: 25.464 Vali Loss: 43.290 Vali Acc: 0.247 Test Loss: 43.290 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9057910442352295
Epoch: 15, Steps: 17 | Train Loss: 27.317 Vali Loss: 39.101 Vali Acc: 0.274 Test Loss: 39.101 Test Acc: 0.274
Validation loss decreased (-0.273226 --> -0.273373).  Saving model ...
Epoch: 16 cost time: 1.8191146850585938
Epoch: 16, Steps: 17 | Train Loss: 25.800 Vali Loss: 37.178 Vali Acc: 0.228 Test Loss: 37.178 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9265236854553223
Epoch: 17, Steps: 17 | Train Loss: 11.518 Vali Loss: 29.565 Vali Acc: 0.236 Test Loss: 29.565 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.866765022277832
Epoch: 18, Steps: 17 | Train Loss: 12.675 Vali Loss: 58.415 Vali Acc: 0.255 Test Loss: 58.415 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.992882490158081
Epoch: 19, Steps: 17 | Train Loss: 15.379 Vali Loss: 45.003 Vali Acc: 0.240 Test Loss: 45.003 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6607913970947266
Epoch: 20, Steps: 17 | Train Loss: 11.527 Vali Loss: 56.292 Vali Acc: 0.243 Test Loss: 56.292 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5248832702636719
Epoch: 21, Steps: 17 | Train Loss: 12.266 Vali Loss: 72.266 Vali Acc: 0.255 Test Loss: 72.266 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.802049160003662
Epoch: 22, Steps: 17 | Train Loss: 18.353 Vali Loss: 63.528 Vali Acc: 0.240 Test Loss: 63.528 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6953916549682617
Epoch: 23, Steps: 17 | Train Loss: 8.596 Vali Loss: 63.786 Vali Acc: 0.251 Test Loss: 63.786 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.593299150466919
Epoch: 24, Steps: 17 | Train Loss: 6.474 Vali Loss: 68.599 Vali Acc: 0.251 Test Loss: 68.599 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6242129802703857
Epoch: 25, Steps: 17 | Train Loss: 8.954 Vali Loss: 68.685 Vali Acc: 0.285 Test Loss: 68.685 Test Acc: 0.285
Validation loss decreased (-0.273373 --> -0.284484).  Saving model ...
Epoch: 26 cost time: 1.62925124168396
Epoch: 26, Steps: 17 | Train Loss: 17.414 Vali Loss: 91.784 Vali Acc: 0.270 Test Loss: 91.784 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6305334568023682
Epoch: 27, Steps: 17 | Train Loss: 9.172 Vali Loss: 89.865 Vali Acc: 0.270 Test Loss: 89.865 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5956404209136963
Epoch: 28, Steps: 17 | Train Loss: 6.495 Vali Loss: 84.005 Vali Acc: 0.281 Test Loss: 84.005 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.574758529663086
Epoch: 29, Steps: 17 | Train Loss: 7.159 Vali Loss: 119.300 Vali Acc: 0.278 Test Loss: 119.300 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.613762617111206
Epoch: 30, Steps: 17 | Train Loss: 13.847 Vali Loss: 129.360 Vali Acc: 0.285 Test Loss: 129.360 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.6302390098571777
Epoch: 31, Steps: 17 | Train Loss: 7.224 Vali Loss: 119.137 Vali Acc: 0.259 Test Loss: 119.137 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.6407523155212402
Epoch: 32, Steps: 17 | Train Loss: 8.009 Vali Loss: 118.654 Vali Acc: 0.251 Test Loss: 118.654 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.710054874420166
Epoch: 33, Steps: 17 | Train Loss: 2.498 Vali Loss: 132.827 Vali Acc: 0.255 Test Loss: 132.827 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.7093653678894043
Epoch: 34, Steps: 17 | Train Loss: 4.622 Vali Loss: 146.739 Vali Acc: 0.243 Test Loss: 146.739 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.5549848079681396
Epoch: 35, Steps: 17 | Train Loss: 2.335 Vali Loss: 148.778 Vali Acc: 0.228 Test Loss: 148.778 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 720352
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.629671335220337
Epoch: 1, Steps: 17 | Train Loss: 7.005 Vali Loss: 13.410 Vali Acc: 0.243 Test Loss: 13.410 Test Acc: 0.243
Validation loss decreased (inf --> -0.243212).  Saving model ...
Epoch: 2 cost time: 1.6381781101226807
Epoch: 2, Steps: 17 | Train Loss: 15.141 Vali Loss: 24.175 Vali Acc: 0.251 Test Loss: 24.175 Test Acc: 0.251
Validation loss decreased (-0.243212 --> -0.250709).  Saving model ...
Epoch: 3 cost time: 1.6131665706634521
Epoch: 3, Steps: 17 | Train Loss: 17.606 Vali Loss: 24.306 Vali Acc: 0.255 Test Loss: 24.306 Test Acc: 0.255
Validation loss decreased (-0.250709 --> -0.254510).  Saving model ...
Epoch: 4 cost time: 1.646756649017334
Epoch: 4, Steps: 17 | Train Loss: 18.613 Vali Loss: 19.440 Vali Acc: 0.251 Test Loss: 19.440 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5449066162109375
Epoch: 5, Steps: 17 | Train Loss: 22.113 Vali Loss: 11.236 Vali Acc: 0.289 Test Loss: 11.236 Test Acc: 0.289
Validation loss decreased (-0.254510 --> -0.288861).  Saving model ...
Epoch: 6 cost time: 1.6040945053100586
Epoch: 6, Steps: 17 | Train Loss: 28.019 Vali Loss: 44.169 Vali Acc: 0.251 Test Loss: 44.169 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7263612747192383
Epoch: 7, Steps: 17 | Train Loss: 19.910 Vali Loss: 37.639 Vali Acc: 0.266 Test Loss: 37.639 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6851775646209717
Epoch: 8, Steps: 17 | Train Loss: 21.497 Vali Loss: 32.515 Vali Acc: 0.266 Test Loss: 32.515 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5769987106323242
Epoch: 9, Steps: 17 | Train Loss: 32.881 Vali Loss: 41.836 Vali Acc: 0.255 Test Loss: 41.836 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6182851791381836
Epoch: 10, Steps: 17 | Train Loss: 21.886 Vali Loss: 48.646 Vali Acc: 0.251 Test Loss: 48.646 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.714768409729004
Epoch: 11, Steps: 17 | Train Loss: 29.315 Vali Loss: 51.240 Vali Acc: 0.285 Test Loss: 51.240 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6178810596466064
Epoch: 12, Steps: 17 | Train Loss: 25.108 Vali Loss: 46.894 Vali Acc: 0.259 Test Loss: 46.894 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5248148441314697
Epoch: 13, Steps: 17 | Train Loss: 18.520 Vali Loss: 30.400 Vali Acc: 0.251 Test Loss: 30.400 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4002041816711426
Epoch: 14, Steps: 17 | Train Loss: 10.213 Vali Loss: 35.744 Vali Acc: 0.262 Test Loss: 35.744 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.437922477722168
Epoch: 15, Steps: 17 | Train Loss: 19.694 Vali Loss: 59.987 Vali Acc: 0.247 Test Loss: 59.987 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 720352
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5400431156158447
Epoch: 1, Steps: 17 | Train Loss: 9.431 Vali Loss: 15.744 Vali Acc: 0.243 Test Loss: 15.744 Test Acc: 0.243
Validation loss decreased (inf --> -0.243189).  Saving model ...
Epoch: 2 cost time: 1.4364991188049316
Epoch: 2, Steps: 17 | Train Loss: 13.171 Vali Loss: 20.099 Vali Acc: 0.266 Test Loss: 20.099 Test Acc: 0.266
Validation loss decreased (-0.243189 --> -0.265959).  Saving model ...
Epoch: 3 cost time: 1.4188194274902344
Epoch: 3, Steps: 17 | Train Loss: 19.329 Vali Loss: 21.524 Vali Acc: 0.278 Test Loss: 21.524 Test Acc: 0.278
Validation loss decreased (-0.265959 --> -0.277351).  Saving model ...
Epoch: 4 cost time: 1.4188361167907715
Epoch: 4, Steps: 17 | Train Loss: 18.762 Vali Loss: 43.618 Vali Acc: 0.243 Test Loss: 43.618 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4996824264526367
Epoch: 5, Steps: 17 | Train Loss: 32.709 Vali Loss: 26.979 Vali Acc: 0.243 Test Loss: 26.979 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.438896894454956
Epoch: 6, Steps: 17 | Train Loss: 25.166 Vali Loss: 23.153 Vali Acc: 0.259 Test Loss: 23.153 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3320815563201904
Epoch: 7, Steps: 17 | Train Loss: 30.781 Vali Loss: 42.835 Vali Acc: 0.228 Test Loss: 42.835 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.436056137084961
Epoch: 8, Steps: 17 | Train Loss: 33.785 Vali Loss: 17.105 Vali Acc: 0.221 Test Loss: 17.105 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4248480796813965
Epoch: 9, Steps: 17 | Train Loss: 37.592 Vali Loss: 23.643 Vali Acc: 0.266 Test Loss: 23.643 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4845445156097412
Epoch: 10, Steps: 17 | Train Loss: 13.449 Vali Loss: 30.231 Vali Acc: 0.240 Test Loss: 30.231 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.444716215133667
Epoch: 11, Steps: 17 | Train Loss: 16.676 Vali Loss: 51.711 Vali Acc: 0.255 Test Loss: 51.711 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4323928356170654
Epoch: 12, Steps: 17 | Train Loss: 24.605 Vali Loss: 42.935 Vali Acc: 0.255 Test Loss: 42.935 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4305229187011719
Epoch: 13, Steps: 17 | Train Loss: 19.322 Vali Loss: 48.299 Vali Acc: 0.270 Test Loss: 48.299 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 720352
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.1163575649261475
Epoch: 1, Steps: 17 | Train Loss: 8.494 Vali Loss: 10.517 Vali Acc: 0.247 Test Loss: 10.517 Test Acc: 0.247
Validation loss decreased (inf --> -0.247043).  Saving model ...
Epoch: 2 cost time: 1.3046274185180664
Epoch: 2, Steps: 17 | Train Loss: 19.307 Vali Loss: 15.212 Vali Acc: 0.243 Test Loss: 15.212 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2730050086975098
Epoch: 3, Steps: 17 | Train Loss: 13.639 Vali Loss: 15.689 Vali Acc: 0.262 Test Loss: 15.689 Test Acc: 0.262
Validation loss decreased (-0.247043 --> -0.262201).  Saving model ...
Epoch: 4 cost time: 1.281806468963623
Epoch: 4, Steps: 17 | Train Loss: 13.955 Vali Loss: 15.685 Vali Acc: 0.278 Test Loss: 15.685 Test Acc: 0.278
Validation loss decreased (-0.262201 --> -0.277410).  Saving model ...
Epoch: 5 cost time: 1.224388599395752
Epoch: 5, Steps: 17 | Train Loss: 15.743 Vali Loss: 11.561 Vali Acc: 0.285 Test Loss: 11.561 Test Acc: 0.285
Validation loss decreased (-0.277410 --> -0.285055).  Saving model ...
Epoch: 6 cost time: 1.2131590843200684
Epoch: 6, Steps: 17 | Train Loss: 12.804 Vali Loss: 27.796 Vali Acc: 0.240 Test Loss: 27.796 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2716107368469238
Epoch: 7, Steps: 17 | Train Loss: 39.684 Vali Loss: 41.537 Vali Acc: 0.243 Test Loss: 41.537 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2721664905548096
Epoch: 8, Steps: 17 | Train Loss: 48.535 Vali Loss: 59.502 Vali Acc: 0.251 Test Loss: 59.502 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4422814846038818
Epoch: 9, Steps: 17 | Train Loss: 26.837 Vali Loss: 36.283 Vali Acc: 0.251 Test Loss: 36.283 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3338556289672852
Epoch: 10, Steps: 17 | Train Loss: 21.662 Vali Loss: 30.940 Vali Acc: 0.262 Test Loss: 30.940 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3685548305511475
Epoch: 11, Steps: 17 | Train Loss: 12.837 Vali Loss: 24.233 Vali Acc: 0.274 Test Loss: 24.233 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4120893478393555
Epoch: 12, Steps: 17 | Train Loss: 21.494 Vali Loss: 17.147 Vali Acc: 0.281 Test Loss: 17.147 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3889477252960205
Epoch: 13, Steps: 17 | Train Loss: 17.375 Vali Loss: 61.051 Vali Acc: 0.266 Test Loss: 61.051 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.349336862564087
Epoch: 14, Steps: 17 | Train Loss: 23.354 Vali Loss: 39.845 Vali Acc: 0.274 Test Loss: 39.845 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4242603778839111
Epoch: 15, Steps: 17 | Train Loss: 14.631 Vali Loss: 47.111 Vali Acc: 0.259 Test Loss: 47.111 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 720352
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0507144927978516
Epoch: 1, Steps: 17 | Train Loss: 7.537 Vali Loss: 17.622 Vali Acc: 0.251 Test Loss: 17.622 Test Acc: 0.251
Validation loss decreased (inf --> -0.250774).  Saving model ...
Epoch: 2 cost time: 1.4536800384521484
Epoch: 2, Steps: 17 | Train Loss: 15.363 Vali Loss: 15.187 Vali Acc: 0.255 Test Loss: 15.187 Test Acc: 0.255
Validation loss decreased (-0.250774 --> -0.254601).  Saving model ...
Epoch: 3 cost time: 1.3860714435577393
Epoch: 3, Steps: 17 | Train Loss: 17.162 Vali Loss: 16.122 Vali Acc: 0.221 Test Loss: 16.122 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5107803344726562
Epoch: 4, Steps: 17 | Train Loss: 28.943 Vali Loss: 45.855 Vali Acc: 0.251 Test Loss: 45.855 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3890247344970703
Epoch: 5, Steps: 17 | Train Loss: 42.745 Vali Loss: 46.526 Vali Acc: 0.255 Test Loss: 46.526 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4108009338378906
Epoch: 6, Steps: 17 | Train Loss: 33.856 Vali Loss: 45.023 Vali Acc: 0.266 Test Loss: 45.023 Test Acc: 0.266
Validation loss decreased (-0.254601 --> -0.265709).  Saving model ...
Epoch: 7 cost time: 1.4686944484710693
Epoch: 7, Steps: 17 | Train Loss: 27.030 Vali Loss: 22.905 Vali Acc: 0.243 Test Loss: 22.905 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6393373012542725
Epoch: 8, Steps: 17 | Train Loss: 18.344 Vali Loss: 50.952 Vali Acc: 0.247 Test Loss: 50.952 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5024502277374268
Epoch: 9, Steps: 17 | Train Loss: 32.376 Vali Loss: 43.786 Vali Acc: 0.251 Test Loss: 43.786 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4924864768981934
Epoch: 10, Steps: 17 | Train Loss: 34.516 Vali Loss: 40.725 Vali Acc: 0.266 Test Loss: 40.725 Test Acc: 0.266
Validation loss decreased (-0.265709 --> -0.265752).  Saving model ...
Epoch: 11 cost time: 1.3247766494750977
Epoch: 11, Steps: 17 | Train Loss: 26.918 Vali Loss: 24.851 Vali Acc: 0.186 Test Loss: 24.851 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.426152229309082
Epoch: 12, Steps: 17 | Train Loss: 17.896 Vali Loss: 30.444 Vali Acc: 0.243 Test Loss: 30.444 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3839499950408936
Epoch: 13, Steps: 17 | Train Loss: 15.705 Vali Loss: 24.362 Vali Acc: 0.251 Test Loss: 24.362 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4893290996551514
Epoch: 14, Steps: 17 | Train Loss: 12.418 Vali Loss: 31.029 Vali Acc: 0.240 Test Loss: 31.029 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4082212448120117
Epoch: 15, Steps: 17 | Train Loss: 19.416 Vali Loss: 57.081 Vali Acc: 0.240 Test Loss: 57.081 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4939613342285156
Epoch: 16, Steps: 17 | Train Loss: 17.339 Vali Loss: 57.239 Vali Acc: 0.251 Test Loss: 57.239 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.752549171447754
Epoch: 17, Steps: 17 | Train Loss: 16.602 Vali Loss: 53.888 Vali Acc: 0.247 Test Loss: 53.888 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5853245258331299
Epoch: 18, Steps: 17 | Train Loss: 14.561 Vali Loss: 58.524 Vali Acc: 0.262 Test Loss: 58.524 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5806801319122314
Epoch: 19, Steps: 17 | Train Loss: 10.362 Vali Loss: 38.536 Vali Acc: 0.236 Test Loss: 38.536 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5289597511291504
Epoch: 20, Steps: 17 | Train Loss: 9.384 Vali Loss: 71.455 Vali Acc: 0.259 Test Loss: 71.455 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 589280
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5978081226348877
Epoch: 1, Steps: 17 | Train Loss: 8.171 Vali Loss: 16.266 Vali Acc: 0.255 Test Loss: 16.266 Test Acc: 0.255
Validation loss decreased (inf --> -0.254590).  Saving model ...
Epoch: 2 cost time: 1.3989667892456055
Epoch: 2, Steps: 17 | Train Loss: 16.330 Vali Loss: 13.949 Vali Acc: 0.232 Test Loss: 13.949 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3760168552398682
Epoch: 3, Steps: 17 | Train Loss: 15.403 Vali Loss: 9.219 Vali Acc: 0.251 Test Loss: 9.219 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4343481063842773
Epoch: 4, Steps: 17 | Train Loss: 23.180 Vali Loss: 40.924 Vali Acc: 0.251 Test Loss: 40.924 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.326340675354004
Epoch: 5, Steps: 17 | Train Loss: 22.319 Vali Loss: 27.042 Vali Acc: 0.240 Test Loss: 27.042 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4972796440124512
Epoch: 6, Steps: 17 | Train Loss: 21.785 Vali Loss: 23.652 Vali Acc: 0.236 Test Loss: 23.652 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3825647830963135
Epoch: 7, Steps: 17 | Train Loss: 23.771 Vali Loss: 53.325 Vali Acc: 0.251 Test Loss: 53.325 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.500417709350586
Epoch: 8, Steps: 17 | Train Loss: 47.478 Vali Loss: 63.458 Vali Acc: 0.262 Test Loss: 63.458 Test Acc: 0.262
Validation loss decreased (-0.254590 --> -0.261723).  Saving model ...
Epoch: 9 cost time: 1.3244366645812988
Epoch: 9, Steps: 17 | Train Loss: 39.803 Vali Loss: 30.747 Vali Acc: 0.247 Test Loss: 30.747 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3996164798736572
Epoch: 10, Steps: 17 | Train Loss: 29.330 Vali Loss: 61.549 Vali Acc: 0.240 Test Loss: 61.549 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.469438076019287
Epoch: 11, Steps: 17 | Train Loss: 33.193 Vali Loss: 28.244 Vali Acc: 0.266 Test Loss: 28.244 Test Acc: 0.266
Validation loss decreased (-0.261723 --> -0.265877).  Saving model ...
Epoch: 12 cost time: 1.4149489402770996
Epoch: 12, Steps: 17 | Train Loss: 18.043 Vali Loss: 36.623 Vali Acc: 0.236 Test Loss: 36.623 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3778386116027832
Epoch: 13, Steps: 17 | Train Loss: 16.371 Vali Loss: 40.533 Vali Acc: 0.251 Test Loss: 40.533 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3052613735198975
Epoch: 14, Steps: 17 | Train Loss: 12.044 Vali Loss: 21.979 Vali Acc: 0.274 Test Loss: 21.979 Test Acc: 0.274
Validation loss decreased (-0.265877 --> -0.273544).  Saving model ...
Epoch: 15 cost time: 1.3492188453674316
Epoch: 15, Steps: 17 | Train Loss: 11.360 Vali Loss: 37.583 Vali Acc: 0.236 Test Loss: 37.583 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4540653228759766
Epoch: 16, Steps: 17 | Train Loss: 17.087 Vali Loss: 36.059 Vali Acc: 0.270 Test Loss: 36.059 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3209617137908936
Epoch: 17, Steps: 17 | Train Loss: 12.664 Vali Loss: 38.396 Vali Acc: 0.274 Test Loss: 38.396 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3696935176849365
Epoch: 18, Steps: 17 | Train Loss: 12.958 Vali Loss: 32.542 Vali Acc: 0.247 Test Loss: 32.542 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3174114227294922
Epoch: 19, Steps: 17 | Train Loss: 18.371 Vali Loss: 39.668 Vali Acc: 0.262 Test Loss: 39.668 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3213388919830322
Epoch: 20, Steps: 17 | Train Loss: 8.122 Vali Loss: 51.866 Vali Acc: 0.221 Test Loss: 51.866 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3973140716552734
Epoch: 21, Steps: 17 | Train Loss: 13.807 Vali Loss: 68.762 Vali Acc: 0.266 Test Loss: 68.762 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4348461627960205
Epoch: 22, Steps: 17 | Train Loss: 13.867 Vali Loss: 61.166 Vali Acc: 0.266 Test Loss: 61.166 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1557590961456299
Epoch: 23, Steps: 17 | Train Loss: 8.193 Vali Loss: 55.230 Vali Acc: 0.240 Test Loss: 55.230 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.463571310043335
Epoch: 24, Steps: 17 | Train Loss: 6.478 Vali Loss: 67.189 Vali Acc: 0.255 Test Loss: 67.189 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 589280
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2888553142547607
Epoch: 1, Steps: 17 | Train Loss: 7.438 Vali Loss: 10.740 Vali Acc: 0.259 Test Loss: 10.740 Test Acc: 0.259
Validation loss decreased (inf --> -0.258448).  Saving model ...
Epoch: 2 cost time: 1.3165099620819092
Epoch: 2, Steps: 17 | Train Loss: 11.889 Vali Loss: 21.090 Vali Acc: 0.251 Test Loss: 21.090 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3075714111328125
Epoch: 3, Steps: 17 | Train Loss: 19.305 Vali Loss: 28.665 Vali Acc: 0.247 Test Loss: 28.665 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3503122329711914
Epoch: 4, Steps: 17 | Train Loss: 25.914 Vali Loss: 14.428 Vali Acc: 0.251 Test Loss: 14.428 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4319727420806885
Epoch: 5, Steps: 17 | Train Loss: 19.451 Vali Loss: 30.303 Vali Acc: 0.266 Test Loss: 30.303 Test Acc: 0.266
Validation loss decreased (-0.258448 --> -0.265857).  Saving model ...
Epoch: 6 cost time: 1.3332953453063965
Epoch: 6, Steps: 17 | Train Loss: 26.101 Vali Loss: 25.209 Vali Acc: 0.255 Test Loss: 25.209 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.501847267150879
Epoch: 7, Steps: 17 | Train Loss: 24.527 Vali Loss: 46.308 Vali Acc: 0.251 Test Loss: 46.308 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4077363014221191
Epoch: 8, Steps: 17 | Train Loss: 33.171 Vali Loss: 47.506 Vali Acc: 0.259 Test Loss: 47.506 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5575034618377686
Epoch: 9, Steps: 17 | Train Loss: 33.332 Vali Loss: 36.097 Vali Acc: 0.251 Test Loss: 36.097 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.534184217453003
Epoch: 10, Steps: 17 | Train Loss: 39.138 Vali Loss: 82.969 Vali Acc: 0.259 Test Loss: 82.969 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3695755004882812
Epoch: 11, Steps: 17 | Train Loss: 43.886 Vali Loss: 21.829 Vali Acc: 0.224 Test Loss: 21.829 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4346587657928467
Epoch: 12, Steps: 17 | Train Loss: 25.445 Vali Loss: 51.444 Vali Acc: 0.224 Test Loss: 51.444 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5425000190734863
Epoch: 13, Steps: 17 | Train Loss: 25.358 Vali Loss: 42.974 Vali Acc: 0.243 Test Loss: 42.974 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5837290287017822
Epoch: 14, Steps: 17 | Train Loss: 25.505 Vali Loss: 32.967 Vali Acc: 0.240 Test Loss: 32.967 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2284448146820068
Epoch: 15, Steps: 17 | Train Loss: 17.279 Vali Loss: 40.246 Vali Acc: 0.240 Test Loss: 40.246 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 589280
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3311705589294434
Epoch: 1, Steps: 17 | Train Loss: 8.415 Vali Loss: 12.323 Vali Acc: 0.251 Test Loss: 12.323 Test Acc: 0.251
Validation loss decreased (inf --> -0.250827).  Saving model ...
Epoch: 2 cost time: 1.4581294059753418
Epoch: 2, Steps: 17 | Train Loss: 15.422 Vali Loss: 11.534 Vali Acc: 0.251 Test Loss: 11.534 Test Acc: 0.251
Validation loss decreased (-0.250827 --> -0.250835).  Saving model ...
Epoch: 3 cost time: 1.1528944969177246
Epoch: 3, Steps: 17 | Train Loss: 16.553 Vali Loss: 22.168 Vali Acc: 0.240 Test Loss: 22.168 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.428218126296997
Epoch: 4, Steps: 17 | Train Loss: 17.290 Vali Loss: 13.472 Vali Acc: 0.262 Test Loss: 13.472 Test Acc: 0.262
Validation loss decreased (-0.250835 --> -0.262223).  Saving model ...
Epoch: 5 cost time: 1.287240982055664
Epoch: 5, Steps: 17 | Train Loss: 14.389 Vali Loss: 14.274 Vali Acc: 0.224 Test Loss: 14.274 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2276787757873535
Epoch: 6, Steps: 17 | Train Loss: 18.515 Vali Loss: 18.072 Vali Acc: 0.247 Test Loss: 18.072 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.281658411026001
Epoch: 7, Steps: 17 | Train Loss: 17.205 Vali Loss: 23.251 Vali Acc: 0.270 Test Loss: 23.251 Test Acc: 0.270
Validation loss decreased (-0.262223 --> -0.269729).  Saving model ...
Epoch: 8 cost time: 1.2988276481628418
Epoch: 8, Steps: 17 | Train Loss: 20.022 Vali Loss: 42.382 Vali Acc: 0.240 Test Loss: 42.382 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4915087223052979
Epoch: 9, Steps: 17 | Train Loss: 22.493 Vali Loss: 19.933 Vali Acc: 0.270 Test Loss: 19.933 Test Acc: 0.270
Validation loss decreased (-0.269729 --> -0.269763).  Saving model ...
Epoch: 10 cost time: 1.359961986541748
Epoch: 10, Steps: 17 | Train Loss: 13.974 Vali Loss: 17.674 Vali Acc: 0.266 Test Loss: 17.674 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4173555374145508
Epoch: 11, Steps: 17 | Train Loss: 16.863 Vali Loss: 23.740 Vali Acc: 0.259 Test Loss: 23.740 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3995659351348877
Epoch: 12, Steps: 17 | Train Loss: 15.518 Vali Loss: 48.679 Vali Acc: 0.255 Test Loss: 48.679 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3893539905548096
Epoch: 13, Steps: 17 | Train Loss: 21.758 Vali Loss: 45.642 Vali Acc: 0.266 Test Loss: 45.642 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.409909725189209
Epoch: 14, Steps: 17 | Train Loss: 28.490 Vali Loss: 41.038 Vali Acc: 0.221 Test Loss: 41.038 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4571945667266846
Epoch: 15, Steps: 17 | Train Loss: 25.310 Vali Loss: 46.479 Vali Acc: 0.251 Test Loss: 46.479 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5058352947235107
Epoch: 16, Steps: 17 | Train Loss: 10.930 Vali Loss: 34.642 Vali Acc: 0.198 Test Loss: 34.642 Test Acc: 0.198
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4185359477996826
Epoch: 17, Steps: 17 | Train Loss: 11.706 Vali Loss: 41.066 Vali Acc: 0.240 Test Loss: 41.066 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6058807373046875
Epoch: 18, Steps: 17 | Train Loss: 12.351 Vali Loss: 43.793 Vali Acc: 0.224 Test Loss: 43.793 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7213468551635742
Epoch: 19, Steps: 17 | Train Loss: 8.069 Vali Loss: 40.099 Vali Acc: 0.232 Test Loss: 40.099 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 589280
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.194102048873901
Epoch: 1, Steps: 17 | Train Loss: 6.856 Vali Loss: 15.297 Vali Acc: 0.240 Test Loss: 15.297 Test Acc: 0.240
Validation loss decreased (inf --> -0.239391).  Saving model ...
Epoch: 2 cost time: 1.7076656818389893
Epoch: 2, Steps: 17 | Train Loss: 16.588 Vali Loss: 11.542 Vali Acc: 0.228 Test Loss: 11.542 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.709078311920166
Epoch: 3, Steps: 17 | Train Loss: 14.748 Vali Loss: 21.573 Vali Acc: 0.262 Test Loss: 21.573 Test Acc: 0.262
Validation loss decreased (-0.239391 --> -0.262142).  Saving model ...
Epoch: 4 cost time: 1.6317012310028076
Epoch: 4, Steps: 17 | Train Loss: 22.192 Vali Loss: 34.725 Vali Acc: 0.251 Test Loss: 34.725 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6784627437591553
Epoch: 5, Steps: 17 | Train Loss: 22.739 Vali Loss: 28.072 Vali Acc: 0.255 Test Loss: 28.072 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.548276662826538
Epoch: 6, Steps: 17 | Train Loss: 21.425 Vali Loss: 28.769 Vali Acc: 0.236 Test Loss: 28.769 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5334043502807617
Epoch: 7, Steps: 17 | Train Loss: 23.471 Vali Loss: 32.555 Vali Acc: 0.247 Test Loss: 32.555 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5630395412445068
Epoch: 8, Steps: 17 | Train Loss: 21.647 Vali Loss: 31.764 Vali Acc: 0.278 Test Loss: 31.764 Test Acc: 0.278
Validation loss decreased (-0.262142 --> -0.277249).  Saving model ...
Epoch: 9 cost time: 1.525827407836914
Epoch: 9, Steps: 17 | Train Loss: 21.800 Vali Loss: 21.243 Vali Acc: 0.274 Test Loss: 21.243 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3182156085968018
Epoch: 10, Steps: 17 | Train Loss: 22.518 Vali Loss: 65.347 Vali Acc: 0.251 Test Loss: 65.347 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7134513854980469
Epoch: 11, Steps: 17 | Train Loss: 33.596 Vali Loss: 49.256 Vali Acc: 0.266 Test Loss: 49.256 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.664468765258789
Epoch: 12, Steps: 17 | Train Loss: 34.347 Vali Loss: 53.317 Vali Acc: 0.228 Test Loss: 53.317 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.760338306427002
Epoch: 13, Steps: 17 | Train Loss: 24.788 Vali Loss: 21.333 Vali Acc: 0.278 Test Loss: 21.333 Test Acc: 0.278
Validation loss decreased (-0.277249 --> -0.277353).  Saving model ...
Epoch: 14 cost time: 1.6879611015319824
Epoch: 14, Steps: 17 | Train Loss: 11.873 Vali Loss: 25.032 Vali Acc: 0.281 Test Loss: 25.032 Test Acc: 0.281
Validation loss decreased (-0.277353 --> -0.281118).  Saving model ...
Epoch: 15 cost time: 1.6263422966003418
Epoch: 15, Steps: 17 | Train Loss: 12.723 Vali Loss: 27.843 Vali Acc: 0.281 Test Loss: 27.843 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.595958948135376
Epoch: 16, Steps: 17 | Train Loss: 14.391 Vali Loss: 24.313 Vali Acc: 0.274 Test Loss: 24.313 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6117684841156006
Epoch: 17, Steps: 17 | Train Loss: 7.769 Vali Loss: 30.989 Vali Acc: 0.243 Test Loss: 30.989 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7290174961090088
Epoch: 18, Steps: 17 | Train Loss: 10.449 Vali Loss: 48.378 Vali Acc: 0.281 Test Loss: 48.378 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6615386009216309
Epoch: 19, Steps: 17 | Train Loss: 15.866 Vali Loss: 52.047 Vali Acc: 0.289 Test Loss: 52.047 Test Acc: 0.289
Validation loss decreased (-0.281118 --> -0.288453).  Saving model ...
Epoch: 20 cost time: 1.4183244705200195
Epoch: 20, Steps: 17 | Train Loss: 12.132 Vali Loss: 67.292 Vali Acc: 0.266 Test Loss: 67.292 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5116782188415527
Epoch: 21, Steps: 17 | Train Loss: 11.299 Vali Loss: 49.694 Vali Acc: 0.293 Test Loss: 49.694 Test Acc: 0.293
Validation loss decreased (-0.288453 --> -0.292279).  Saving model ...
Epoch: 22 cost time: 1.5492267608642578
Epoch: 22, Steps: 17 | Train Loss: 6.193 Vali Loss: 43.647 Vali Acc: 0.289 Test Loss: 43.647 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4117844104766846
Epoch: 23, Steps: 17 | Train Loss: 10.410 Vali Loss: 55.198 Vali Acc: 0.285 Test Loss: 55.198 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4955661296844482
Epoch: 24, Steps: 17 | Train Loss: 20.699 Vali Loss: 61.753 Vali Acc: 0.243 Test Loss: 61.753 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5124790668487549
Epoch: 25, Steps: 17 | Train Loss: 9.086 Vali Loss: 54.622 Vali Acc: 0.236 Test Loss: 54.622 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4599957466125488
Epoch: 26, Steps: 17 | Train Loss: 6.345 Vali Loss: 71.417 Vali Acc: 0.259 Test Loss: 71.417 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6084184646606445
Epoch: 27, Steps: 17 | Train Loss: 5.046 Vali Loss: 72.633 Vali Acc: 0.221 Test Loss: 72.633 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7095844745635986
Epoch: 28, Steps: 17 | Train Loss: 12.186 Vali Loss: 103.087 Vali Acc: 0.270 Test Loss: 103.087 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6151995658874512
Epoch: 29, Steps: 17 | Train Loss: 11.592 Vali Loss: 96.196 Vali Acc: 0.243 Test Loss: 96.196 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6052014827728271
Epoch: 30, Steps: 17 | Train Loss: 6.914 Vali Loss: 105.050 Vali Acc: 0.259 Test Loss: 105.050 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4969608783721924
Epoch: 31, Steps: 17 | Train Loss: 10.771 Vali Loss: 103.107 Vali Acc: 0.236 Test Loss: 103.107 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 523744
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.514066219329834
Epoch: 1, Steps: 17 | Train Loss: 6.829 Vali Loss: 8.818 Vali Acc: 0.247 Test Loss: 8.818 Test Acc: 0.247
Validation loss decreased (inf --> -0.247060).  Saving model ...
Epoch: 2 cost time: 1.3972902297973633
Epoch: 2, Steps: 17 | Train Loss: 10.390 Vali Loss: 11.856 Vali Acc: 0.251 Test Loss: 11.856 Test Acc: 0.251
Validation loss decreased (-0.247060 --> -0.250832).  Saving model ...
Epoch: 3 cost time: 1.3366169929504395
Epoch: 3, Steps: 17 | Train Loss: 17.371 Vali Loss: 34.401 Vali Acc: 0.266 Test Loss: 34.401 Test Acc: 0.266
Validation loss decreased (-0.250832 --> -0.265816).  Saving model ...
Epoch: 4 cost time: 1.4091675281524658
Epoch: 4, Steps: 17 | Train Loss: 27.247 Vali Loss: 28.081 Vali Acc: 0.270 Test Loss: 28.081 Test Acc: 0.270
Validation loss decreased (-0.265816 --> -0.269681).  Saving model ...
Epoch: 5 cost time: 1.437507152557373
Epoch: 5, Steps: 17 | Train Loss: 15.602 Vali Loss: 14.054 Vali Acc: 0.262 Test Loss: 14.054 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3557064533233643
Epoch: 6, Steps: 17 | Train Loss: 13.109 Vali Loss: 14.189 Vali Acc: 0.236 Test Loss: 14.189 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3358190059661865
Epoch: 7, Steps: 17 | Train Loss: 21.440 Vali Loss: 28.401 Vali Acc: 0.243 Test Loss: 28.401 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4163312911987305
Epoch: 8, Steps: 17 | Train Loss: 20.063 Vali Loss: 25.056 Vali Acc: 0.259 Test Loss: 25.056 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.377382755279541
Epoch: 9, Steps: 17 | Train Loss: 31.282 Vali Loss: 23.792 Vali Acc: 0.224 Test Loss: 23.792 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4582240581512451
Epoch: 10, Steps: 17 | Train Loss: 33.754 Vali Loss: 26.129 Vali Acc: 0.281 Test Loss: 26.129 Test Acc: 0.281
Validation loss decreased (-0.269681 --> -0.281108).  Saving model ...
Epoch: 11 cost time: 1.441403865814209
Epoch: 11, Steps: 17 | Train Loss: 22.573 Vali Loss: 36.656 Vali Acc: 0.247 Test Loss: 36.656 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4138498306274414
Epoch: 12, Steps: 17 | Train Loss: 28.127 Vali Loss: 31.623 Vali Acc: 0.274 Test Loss: 31.623 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3853745460510254
Epoch: 13, Steps: 17 | Train Loss: 17.962 Vali Loss: 32.955 Vali Acc: 0.247 Test Loss: 32.955 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2962169647216797
Epoch: 14, Steps: 17 | Train Loss: 17.945 Vali Loss: 45.135 Vali Acc: 0.255 Test Loss: 45.135 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3328731060028076
Epoch: 15, Steps: 17 | Train Loss: 24.436 Vali Loss: 64.912 Vali Acc: 0.278 Test Loss: 64.912 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3763890266418457
Epoch: 16, Steps: 17 | Train Loss: 24.742 Vali Loss: 40.252 Vali Acc: 0.270 Test Loss: 40.252 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.353346586227417
Epoch: 17, Steps: 17 | Train Loss: 14.632 Vali Loss: 56.163 Vali Acc: 0.289 Test Loss: 56.163 Test Acc: 0.289
Validation loss decreased (-0.281108 --> -0.288412).  Saving model ...
Epoch: 18 cost time: 1.403153657913208
Epoch: 18, Steps: 17 | Train Loss: 34.421 Vali Loss: 67.213 Vali Acc: 0.255 Test Loss: 67.213 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3977434635162354
Epoch: 19, Steps: 17 | Train Loss: 26.059 Vali Loss: 52.424 Vali Acc: 0.259 Test Loss: 52.424 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3932123184204102
Epoch: 20, Steps: 17 | Train Loss: 21.340 Vali Loss: 78.764 Vali Acc: 0.240 Test Loss: 78.764 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5873072147369385
Epoch: 21, Steps: 17 | Train Loss: 13.242 Vali Loss: 59.669 Vali Acc: 0.255 Test Loss: 59.669 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4523768424987793
Epoch: 22, Steps: 17 | Train Loss: 7.795 Vali Loss: 49.898 Vali Acc: 0.236 Test Loss: 49.898 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3617784976959229
Epoch: 23, Steps: 17 | Train Loss: 6.790 Vali Loss: 51.593 Vali Acc: 0.232 Test Loss: 51.593 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4422447681427002
Epoch: 24, Steps: 17 | Train Loss: 10.802 Vali Loss: 58.740 Vali Acc: 0.251 Test Loss: 58.740 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5283348560333252
Epoch: 25, Steps: 17 | Train Loss: 6.374 Vali Loss: 76.535 Vali Acc: 0.270 Test Loss: 76.535 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5103445053100586
Epoch: 26, Steps: 17 | Train Loss: 6.667 Vali Loss: 72.623 Vali Acc: 0.243 Test Loss: 72.623 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2765331268310547
Epoch: 27, Steps: 17 | Train Loss: 3.644 Vali Loss: 74.621 Vali Acc: 0.232 Test Loss: 74.621 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 523744
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0218658447265625
Epoch: 1, Steps: 17 | Train Loss: 7.587 Vali Loss: 16.239 Vali Acc: 0.262 Test Loss: 16.239 Test Acc: 0.262
Validation loss decreased (inf --> -0.262195).  Saving model ...
Epoch: 2 cost time: 1.2529988288879395
Epoch: 2, Steps: 17 | Train Loss: 13.092 Vali Loss: 16.598 Vali Acc: 0.266 Test Loss: 16.598 Test Acc: 0.266
Validation loss decreased (-0.262195 --> -0.265994).  Saving model ...
Epoch: 3 cost time: 1.3790206909179688
Epoch: 3, Steps: 17 | Train Loss: 15.220 Vali Loss: 16.872 Vali Acc: 0.274 Test Loss: 16.872 Test Acc: 0.274
Validation loss decreased (-0.265994 --> -0.273596).  Saving model ...
Epoch: 4 cost time: 1.490929126739502
Epoch: 4, Steps: 17 | Train Loss: 12.982 Vali Loss: 26.569 Vali Acc: 0.259 Test Loss: 26.569 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4708003997802734
Epoch: 5, Steps: 17 | Train Loss: 23.818 Vali Loss: 28.813 Vali Acc: 0.270 Test Loss: 28.813 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3425557613372803
Epoch: 6, Steps: 17 | Train Loss: 21.351 Vali Loss: 13.443 Vali Acc: 0.243 Test Loss: 13.443 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3597559928894043
Epoch: 7, Steps: 17 | Train Loss: 23.945 Vali Loss: 19.756 Vali Acc: 0.240 Test Loss: 19.756 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.319009780883789
Epoch: 8, Steps: 17 | Train Loss: 17.518 Vali Loss: 27.977 Vali Acc: 0.266 Test Loss: 27.977 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.14243483543396
Epoch: 9, Steps: 17 | Train Loss: 15.021 Vali Loss: 14.862 Vali Acc: 0.262 Test Loss: 14.862 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0388290882110596
Epoch: 10, Steps: 17 | Train Loss: 19.865 Vali Loss: 27.109 Vali Acc: 0.240 Test Loss: 27.109 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2064175605773926
Epoch: 11, Steps: 17 | Train Loss: 14.444 Vali Loss: 49.089 Vali Acc: 0.251 Test Loss: 49.089 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4407322406768799
Epoch: 12, Steps: 17 | Train Loss: 29.719 Vali Loss: 35.634 Vali Acc: 0.270 Test Loss: 35.634 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.332421064376831
Epoch: 13, Steps: 17 | Train Loss: 38.044 Vali Loss: 44.714 Vali Acc: 0.232 Test Loss: 44.714 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 523744
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.216371774673462
Epoch: 1, Steps: 17 | Train Loss: 5.974 Vali Loss: 4.846 Vali Acc: 0.232 Test Loss: 4.846 Test Acc: 0.232
Validation loss decreased (inf --> -0.231891).  Saving model ...
Epoch: 2 cost time: 1.4077727794647217
Epoch: 2, Steps: 17 | Train Loss: 15.019 Vali Loss: 10.981 Vali Acc: 0.274 Test Loss: 10.981 Test Acc: 0.274
Validation loss decreased (-0.231891 --> -0.273654).  Saving model ...
Epoch: 3 cost time: 1.3722739219665527
Epoch: 3, Steps: 17 | Train Loss: 18.087 Vali Loss: 16.238 Vali Acc: 0.240 Test Loss: 16.238 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2938752174377441
Epoch: 4, Steps: 17 | Train Loss: 14.138 Vali Loss: 24.486 Vali Acc: 0.259 Test Loss: 24.486 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3870301246643066
Epoch: 5, Steps: 17 | Train Loss: 33.802 Vali Loss: 59.708 Vali Acc: 0.255 Test Loss: 59.708 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.29292631149292
Epoch: 6, Steps: 17 | Train Loss: 32.211 Vali Loss: 27.745 Vali Acc: 0.251 Test Loss: 27.745 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.298553705215454
Epoch: 7, Steps: 17 | Train Loss: 29.896 Vali Loss: 47.202 Vali Acc: 0.251 Test Loss: 47.202 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3085832595825195
Epoch: 8, Steps: 17 | Train Loss: 30.134 Vali Loss: 32.451 Vali Acc: 0.243 Test Loss: 32.451 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.273280382156372
Epoch: 9, Steps: 17 | Train Loss: 21.463 Vali Loss: 38.210 Vali Acc: 0.236 Test Loss: 38.210 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3740863800048828
Epoch: 10, Steps: 17 | Train Loss: 26.350 Vali Loss: 32.130 Vali Acc: 0.262 Test Loss: 32.130 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4534800052642822
Epoch: 11, Steps: 17 | Train Loss: 16.902 Vali Loss: 22.465 Vali Acc: 0.270 Test Loss: 22.465 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4061214923858643
Epoch: 12, Steps: 17 | Train Loss: 14.679 Vali Loss: 35.887 Vali Acc: 0.255 Test Loss: 35.887 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 523744
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.296408653259277
Epoch: 1, Steps: 17 | Train Loss: 11.664 Vali Loss: 22.126 Vali Acc: 0.247 Test Loss: 22.126 Test Acc: 0.247
Validation loss decreased (inf --> -0.246927).  Saving model ...
Epoch: 2 cost time: 1.7666749954223633
Epoch: 2, Steps: 17 | Train Loss: 18.220 Vali Loss: 15.486 Vali Acc: 0.198 Test Loss: 15.486 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8642237186431885
Epoch: 3, Steps: 17 | Train Loss: 13.112 Vali Loss: 23.919 Vali Acc: 0.251 Test Loss: 23.919 Test Acc: 0.251
Validation loss decreased (-0.246927 --> -0.250711).  Saving model ...
Epoch: 4 cost time: 1.7124989032745361
Epoch: 4, Steps: 17 | Train Loss: 18.427 Vali Loss: 22.513 Vali Acc: 0.259 Test Loss: 22.513 Test Acc: 0.259
Validation loss decreased (-0.250711 --> -0.258330).  Saving model ...
Epoch: 5 cost time: 1.825286626815796
Epoch: 5, Steps: 17 | Train Loss: 25.441 Vali Loss: 24.369 Vali Acc: 0.266 Test Loss: 24.369 Test Acc: 0.266
Validation loss decreased (-0.258330 --> -0.265916).  Saving model ...
Epoch: 6 cost time: 1.4717750549316406
Epoch: 6, Steps: 17 | Train Loss: 18.856 Vali Loss: 13.825 Vali Acc: 0.255 Test Loss: 13.825 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.627256155014038
Epoch: 7, Steps: 17 | Train Loss: 15.634 Vali Loss: 11.031 Vali Acc: 0.240 Test Loss: 11.031 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5287983417510986
Epoch: 8, Steps: 17 | Train Loss: 13.663 Vali Loss: 29.961 Vali Acc: 0.262 Test Loss: 29.961 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.625683307647705
Epoch: 9, Steps: 17 | Train Loss: 16.526 Vali Loss: 43.807 Vali Acc: 0.247 Test Loss: 43.807 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.611419916152954
Epoch: 10, Steps: 17 | Train Loss: 20.881 Vali Loss: 49.531 Vali Acc: 0.259 Test Loss: 49.531 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6492702960968018
Epoch: 11, Steps: 17 | Train Loss: 31.162 Vali Loss: 29.848 Vali Acc: 0.247 Test Loss: 29.848 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7069480419158936
Epoch: 12, Steps: 17 | Train Loss: 30.769 Vali Loss: 38.402 Vali Acc: 0.278 Test Loss: 38.402 Test Acc: 0.278
Validation loss decreased (-0.265916 --> -0.277183).  Saving model ...
Epoch: 13 cost time: 1.4805033206939697
Epoch: 13, Steps: 17 | Train Loss: 23.301 Vali Loss: 40.447 Vali Acc: 0.266 Test Loss: 40.447 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5856575965881348
Epoch: 14, Steps: 17 | Train Loss: 23.091 Vali Loss: 32.465 Vali Acc: 0.221 Test Loss: 32.465 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.48909592628479
Epoch: 15, Steps: 17 | Train Loss: 10.512 Vali Loss: 37.106 Vali Acc: 0.270 Test Loss: 37.106 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.645923137664795
Epoch: 16, Steps: 17 | Train Loss: 15.806 Vali Loss: 51.347 Vali Acc: 0.251 Test Loss: 51.347 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8026022911071777
Epoch: 17, Steps: 17 | Train Loss: 29.314 Vali Loss: 36.748 Vali Acc: 0.262 Test Loss: 36.748 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.775346279144287
Epoch: 18, Steps: 17 | Train Loss: 16.203 Vali Loss: 41.107 Vali Acc: 0.259 Test Loss: 41.107 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6052792072296143
Epoch: 19, Steps: 17 | Train Loss: 12.762 Vali Loss: 52.515 Vali Acc: 0.262 Test Loss: 52.515 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.688688039779663
Epoch: 20, Steps: 17 | Train Loss: 16.200 Vali Loss: 76.038 Vali Acc: 0.259 Test Loss: 76.038 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7449805736541748
Epoch: 21, Steps: 17 | Train Loss: 29.057 Vali Loss: 75.066 Vali Acc: 0.274 Test Loss: 75.066 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4440839290618896
Epoch: 22, Steps: 17 | Train Loss: 19.204 Vali Loss: 61.913 Vali Acc: 0.266 Test Loss: 61.913 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 490976
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.685925006866455
Epoch: 1, Steps: 17 | Train Loss: 10.629 Vali Loss: 12.618 Vali Acc: 0.251 Test Loss: 12.618 Test Acc: 0.251
Validation loss decreased (inf --> -0.250824).  Saving model ...
Epoch: 2 cost time: 1.537898063659668
Epoch: 2, Steps: 17 | Train Loss: 14.025 Vali Loss: 10.107 Vali Acc: 0.262 Test Loss: 10.107 Test Acc: 0.262
Validation loss decreased (-0.250824 --> -0.262256).  Saving model ...
Epoch: 3 cost time: 1.5630149841308594
Epoch: 3, Steps: 17 | Train Loss: 15.253 Vali Loss: 16.278 Vali Acc: 0.243 Test Loss: 16.278 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8041942119598389
Epoch: 4, Steps: 17 | Train Loss: 13.759 Vali Loss: 37.110 Vali Acc: 0.255 Test Loss: 37.110 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5352909564971924
Epoch: 5, Steps: 17 | Train Loss: 21.524 Vali Loss: 37.826 Vali Acc: 0.240 Test Loss: 37.826 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5213994979858398
Epoch: 6, Steps: 17 | Train Loss: 22.756 Vali Loss: 19.913 Vali Acc: 0.243 Test Loss: 19.913 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6905341148376465
Epoch: 7, Steps: 17 | Train Loss: 22.707 Vali Loss: 39.009 Vali Acc: 0.255 Test Loss: 39.009 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7001080513000488
Epoch: 8, Steps: 17 | Train Loss: 26.484 Vali Loss: 30.983 Vali Acc: 0.243 Test Loss: 30.983 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5131404399871826
Epoch: 9, Steps: 17 | Train Loss: 21.681 Vali Loss: 18.927 Vali Acc: 0.251 Test Loss: 18.927 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4459474086761475
Epoch: 10, Steps: 17 | Train Loss: 18.969 Vali Loss: 33.371 Vali Acc: 0.255 Test Loss: 33.371 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4673559665679932
Epoch: 11, Steps: 17 | Train Loss: 28.199 Vali Loss: 31.667 Vali Acc: 0.255 Test Loss: 31.667 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.537304162979126
Epoch: 12, Steps: 17 | Train Loss: 14.752 Vali Loss: 29.983 Vali Acc: 0.255 Test Loss: 29.983 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 490976
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.1343297958374023
Epoch: 1, Steps: 17 | Train Loss: 9.970 Vali Loss: 18.726 Vali Acc: 0.255 Test Loss: 18.726 Test Acc: 0.255
Validation loss decreased (inf --> -0.254566).  Saving model ...
Epoch: 2 cost time: 1.4198024272918701
Epoch: 2, Steps: 17 | Train Loss: 13.437 Vali Loss: 10.837 Vali Acc: 0.243 Test Loss: 10.837 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3569135665893555
Epoch: 3, Steps: 17 | Train Loss: 17.118 Vali Loss: 25.611 Vali Acc: 0.262 Test Loss: 25.611 Test Acc: 0.262
Validation loss decreased (-0.254566 --> -0.262101).  Saving model ...
Epoch: 4 cost time: 1.3100337982177734
Epoch: 4, Steps: 17 | Train Loss: 24.899 Vali Loss: 33.633 Vali Acc: 0.259 Test Loss: 33.633 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3973455429077148
Epoch: 5, Steps: 17 | Train Loss: 38.216 Vali Loss: 56.282 Vali Acc: 0.243 Test Loss: 56.282 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3768310546875
Epoch: 6, Steps: 17 | Train Loss: 36.530 Vali Loss: 64.243 Vali Acc: 0.251 Test Loss: 64.243 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6054062843322754
Epoch: 7, Steps: 17 | Train Loss: 30.860 Vali Loss: 36.322 Vali Acc: 0.259 Test Loss: 36.322 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4239342212677002
Epoch: 8, Steps: 17 | Train Loss: 28.264 Vali Loss: 42.300 Vali Acc: 0.255 Test Loss: 42.300 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4165871143341064
Epoch: 9, Steps: 17 | Train Loss: 28.739 Vali Loss: 26.170 Vali Acc: 0.270 Test Loss: 26.170 Test Acc: 0.270
Validation loss decreased (-0.262101 --> -0.269700).  Saving model ...
Epoch: 10 cost time: 1.2174010276794434
Epoch: 10, Steps: 17 | Train Loss: 26.933 Vali Loss: 58.728 Vali Acc: 0.255 Test Loss: 58.728 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2671575546264648
Epoch: 11, Steps: 17 | Train Loss: 34.417 Vali Loss: 35.685 Vali Acc: 0.228 Test Loss: 35.685 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4277007579803467
Epoch: 12, Steps: 17 | Train Loss: 22.694 Vali Loss: 55.511 Vali Acc: 0.259 Test Loss: 55.511 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4686095714569092
Epoch: 13, Steps: 17 | Train Loss: 21.667 Vali Loss: 33.679 Vali Acc: 0.243 Test Loss: 33.679 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4371929168701172
Epoch: 14, Steps: 17 | Train Loss: 20.696 Vali Loss: 51.698 Vali Acc: 0.266 Test Loss: 51.698 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3768742084503174
Epoch: 15, Steps: 17 | Train Loss: 11.736 Vali Loss: 26.254 Vali Acc: 0.236 Test Loss: 26.254 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1408581733703613
Epoch: 16, Steps: 17 | Train Loss: 12.364 Vali Loss: 42.131 Vali Acc: 0.251 Test Loss: 42.131 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3820078372955322
Epoch: 17, Steps: 17 | Train Loss: 20.514 Vali Loss: 37.965 Vali Acc: 0.240 Test Loss: 37.965 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.182413101196289
Epoch: 18, Steps: 17 | Train Loss: 15.017 Vali Loss: 54.750 Vali Acc: 0.228 Test Loss: 54.750 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4139981269836426
Epoch: 19, Steps: 17 | Train Loss: 13.674 Vali Loss: 32.111 Vali Acc: 0.240 Test Loss: 32.111 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 490976
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9881503582000732
Epoch: 1, Steps: 17 | Train Loss: 10.513 Vali Loss: 12.820 Vali Acc: 0.266 Test Loss: 12.820 Test Acc: 0.266
Validation loss decreased (inf --> -0.266032).  Saving model ...
Epoch: 2 cost time: 1.3446271419525146
Epoch: 2, Steps: 17 | Train Loss: 12.048 Vali Loss: 8.167 Vali Acc: 0.255 Test Loss: 8.167 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.204160451889038
Epoch: 3, Steps: 17 | Train Loss: 14.260 Vali Loss: 16.115 Vali Acc: 0.232 Test Loss: 16.115 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.219712257385254
Epoch: 4, Steps: 17 | Train Loss: 12.051 Vali Loss: 13.140 Vali Acc: 0.251 Test Loss: 13.140 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1880474090576172
Epoch: 5, Steps: 17 | Train Loss: 15.566 Vali Loss: 17.485 Vali Acc: 0.251 Test Loss: 17.485 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3125810623168945
Epoch: 6, Steps: 17 | Train Loss: 28.845 Vali Loss: 19.703 Vali Acc: 0.243 Test Loss: 19.703 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1933059692382812
Epoch: 7, Steps: 17 | Train Loss: 11.045 Vali Loss: 13.854 Vali Acc: 0.285 Test Loss: 13.854 Test Acc: 0.285
Validation loss decreased (-0.266032 --> -0.285033).  Saving model ...
Epoch: 8 cost time: 1.2560627460479736
Epoch: 8, Steps: 17 | Train Loss: 18.365 Vali Loss: 36.966 Vali Acc: 0.247 Test Loss: 36.966 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1245043277740479
Epoch: 9, Steps: 17 | Train Loss: 26.244 Vali Loss: 33.558 Vali Acc: 0.289 Test Loss: 33.558 Test Acc: 0.289
Validation loss decreased (-0.285033 --> -0.288638).  Saving model ...
Epoch: 10 cost time: 1.167463779449463
Epoch: 10, Steps: 17 | Train Loss: 22.524 Vali Loss: 16.690 Vali Acc: 0.289 Test Loss: 16.690 Test Acc: 0.289
Validation loss decreased (-0.288638 --> -0.288806).  Saving model ...
Epoch: 11 cost time: 1.1997179985046387
Epoch: 11, Steps: 17 | Train Loss: 35.181 Vali Loss: 22.183 Vali Acc: 0.262 Test Loss: 22.183 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3890998363494873
Epoch: 12, Steps: 17 | Train Loss: 24.491 Vali Loss: 26.633 Vali Acc: 0.266 Test Loss: 26.633 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3538694381713867
Epoch: 13, Steps: 17 | Train Loss: 15.007 Vali Loss: 25.352 Vali Acc: 0.259 Test Loss: 25.352 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3270599842071533
Epoch: 14, Steps: 17 | Train Loss: 25.132 Vali Loss: 57.813 Vali Acc: 0.274 Test Loss: 57.813 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2308073043823242
Epoch: 15, Steps: 17 | Train Loss: 27.693 Vali Loss: 38.728 Vali Acc: 0.266 Test Loss: 38.728 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1887726783752441
Epoch: 16, Steps: 17 | Train Loss: 11.508 Vali Loss: 34.489 Vali Acc: 0.251 Test Loss: 34.489 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2286593914031982
Epoch: 17, Steps: 17 | Train Loss: 20.038 Vali Loss: 39.277 Vali Acc: 0.266 Test Loss: 39.277 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.323953628540039
Epoch: 18, Steps: 17 | Train Loss: 11.301 Vali Loss: 40.764 Vali Acc: 0.262 Test Loss: 40.764 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2473397254943848
Epoch: 19, Steps: 17 | Train Loss: 11.052 Vali Loss: 50.028 Vali Acc: 0.217 Test Loss: 50.028 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2927148342132568
Epoch: 20, Steps: 17 | Train Loss: 9.549 Vali Loss: 79.881 Vali Acc: 0.255 Test Loss: 79.881 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 490976
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8071837425231934
Epoch: 1, Steps: 17 | Train Loss: 10.015 Vali Loss: 8.853 Vali Acc: 0.247 Test Loss: 8.853 Test Acc: 0.247
Validation loss decreased (inf --> -0.247060).  Saving model ...
Epoch: 2 cost time: 1.6545648574829102
Epoch: 2, Steps: 17 | Train Loss: 11.729 Vali Loss: 14.902 Vali Acc: 0.255 Test Loss: 14.902 Test Acc: 0.255
Validation loss decreased (-0.247060 --> -0.254604).  Saving model ...
Epoch: 3 cost time: 1.4198648929595947
Epoch: 3, Steps: 17 | Train Loss: 11.773 Vali Loss: 19.673 Vali Acc: 0.266 Test Loss: 19.673 Test Acc: 0.266
Validation loss decreased (-0.254604 --> -0.265963).  Saving model ...
Epoch: 4 cost time: 1.5783464908599854
Epoch: 4, Steps: 17 | Train Loss: 14.834 Vali Loss: 21.520 Vali Acc: 0.243 Test Loss: 21.520 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5515685081481934
Epoch: 5, Steps: 17 | Train Loss: 11.540 Vali Loss: 34.108 Vali Acc: 0.266 Test Loss: 34.108 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5558011531829834
Epoch: 6, Steps: 17 | Train Loss: 23.265 Vali Loss: 20.963 Vali Acc: 0.270 Test Loss: 20.963 Test Acc: 0.270
Validation loss decreased (-0.265963 --> -0.269752).  Saving model ...
Epoch: 7 cost time: 1.4509401321411133
Epoch: 7, Steps: 17 | Train Loss: 17.724 Vali Loss: 19.257 Vali Acc: 0.259 Test Loss: 19.257 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4990508556365967
Epoch: 8, Steps: 17 | Train Loss: 21.769 Vali Loss: 54.024 Vali Acc: 0.247 Test Loss: 54.024 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.367051601409912
Epoch: 9, Steps: 17 | Train Loss: 33.546 Vali Loss: 33.664 Vali Acc: 0.217 Test Loss: 33.664 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5659725666046143
Epoch: 10, Steps: 17 | Train Loss: 28.539 Vali Loss: 26.241 Vali Acc: 0.270 Test Loss: 26.241 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6294901371002197
Epoch: 11, Steps: 17 | Train Loss: 38.225 Vali Loss: 65.468 Vali Acc: 0.251 Test Loss: 65.468 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6404657363891602
Epoch: 12, Steps: 17 | Train Loss: 30.711 Vali Loss: 36.580 Vali Acc: 0.289 Test Loss: 36.580 Test Acc: 0.289
Validation loss decreased (-0.269752 --> -0.288608).  Saving model ...
Epoch: 13 cost time: 1.6142878532409668
Epoch: 13, Steps: 17 | Train Loss: 24.880 Vali Loss: 44.619 Vali Acc: 0.266 Test Loss: 44.619 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5586395263671875
Epoch: 14, Steps: 17 | Train Loss: 16.680 Vali Loss: 22.811 Vali Acc: 0.217 Test Loss: 22.811 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6686780452728271
Epoch: 15, Steps: 17 | Train Loss: 15.629 Vali Loss: 29.696 Vali Acc: 0.247 Test Loss: 29.696 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6440906524658203
Epoch: 16, Steps: 17 | Train Loss: 14.949 Vali Loss: 32.656 Vali Acc: 0.251 Test Loss: 32.656 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6401383876800537
Epoch: 17, Steps: 17 | Train Loss: 21.215 Vali Loss: 57.643 Vali Acc: 0.232 Test Loss: 57.643 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6379399299621582
Epoch: 18, Steps: 17 | Train Loss: 20.280 Vali Loss: 50.428 Vali Acc: 0.251 Test Loss: 50.428 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7643406391143799
Epoch: 19, Steps: 17 | Train Loss: 21.425 Vali Loss: 45.620 Vali Acc: 0.259 Test Loss: 45.620 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5643348693847656
Epoch: 20, Steps: 17 | Train Loss: 14.608 Vali Loss: 78.518 Vali Acc: 0.262 Test Loss: 78.518 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.745971441268921
Epoch: 21, Steps: 17 | Train Loss: 9.801 Vali Loss: 58.663 Vali Acc: 0.255 Test Loss: 58.663 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8055078983306885
Epoch: 22, Steps: 17 | Train Loss: 9.627 Vali Loss: 46.481 Vali Acc: 0.255 Test Loss: 46.481 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 474592
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.373028516769409
Epoch: 1, Steps: 17 | Train Loss: 9.312 Vali Loss: 12.608 Vali Acc: 0.247 Test Loss: 12.608 Test Acc: 0.247
Validation loss decreased (inf --> -0.247022).  Saving model ...
Epoch: 2 cost time: 1.4174220561981201
Epoch: 2, Steps: 17 | Train Loss: 12.394 Vali Loss: 6.167 Vali Acc: 0.270 Test Loss: 6.167 Test Acc: 0.270
Validation loss decreased (-0.247022 --> -0.269900).  Saving model ...
Epoch: 3 cost time: 1.4191570281982422
Epoch: 3, Steps: 17 | Train Loss: 12.541 Vali Loss: 14.328 Vali Acc: 0.262 Test Loss: 14.328 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3327064514160156
Epoch: 4, Steps: 17 | Train Loss: 11.751 Vali Loss: 12.444 Vali Acc: 0.247 Test Loss: 12.444 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.361236333847046
Epoch: 5, Steps: 17 | Train Loss: 18.104 Vali Loss: 25.897 Vali Acc: 0.285 Test Loss: 25.897 Test Acc: 0.285
Validation loss decreased (-0.269900 --> -0.284912).  Saving model ...
Epoch: 6 cost time: 1.4586172103881836
Epoch: 6, Steps: 17 | Train Loss: 19.765 Vali Loss: 14.035 Vali Acc: 0.251 Test Loss: 14.035 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5434086322784424
Epoch: 7, Steps: 17 | Train Loss: 14.555 Vali Loss: 26.984 Vali Acc: 0.213 Test Loss: 26.984 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4104161262512207
Epoch: 8, Steps: 17 | Train Loss: 13.545 Vali Loss: 24.194 Vali Acc: 0.278 Test Loss: 24.194 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.368602991104126
Epoch: 9, Steps: 17 | Train Loss: 18.466 Vali Loss: 21.869 Vali Acc: 0.251 Test Loss: 21.869 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.466179609298706
Epoch: 10, Steps: 17 | Train Loss: 20.864 Vali Loss: 34.859 Vali Acc: 0.259 Test Loss: 34.859 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5010242462158203
Epoch: 11, Steps: 17 | Train Loss: 19.805 Vali Loss: 52.538 Vali Acc: 0.262 Test Loss: 52.538 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4089844226837158
Epoch: 12, Steps: 17 | Train Loss: 24.393 Vali Loss: 41.495 Vali Acc: 0.266 Test Loss: 41.495 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4251909255981445
Epoch: 13, Steps: 17 | Train Loss: 17.008 Vali Loss: 43.786 Vali Acc: 0.221 Test Loss: 43.786 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4294943809509277
Epoch: 14, Steps: 17 | Train Loss: 17.923 Vali Loss: 43.964 Vali Acc: 0.255 Test Loss: 43.964 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.331164836883545
Epoch: 15, Steps: 17 | Train Loss: 15.840 Vali Loss: 26.418 Vali Acc: 0.266 Test Loss: 26.418 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 474592
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.441530227661133
Epoch: 1, Steps: 17 | Train Loss: 7.485 Vali Loss: 8.446 Vali Acc: 0.255 Test Loss: 8.446 Test Acc: 0.255
Validation loss decreased (inf --> -0.254668).  Saving model ...
Epoch: 2 cost time: 1.2705442905426025
Epoch: 2, Steps: 17 | Train Loss: 9.626 Vali Loss: 13.696 Vali Acc: 0.247 Test Loss: 13.696 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2291507720947266
Epoch: 3, Steps: 17 | Train Loss: 11.791 Vali Loss: 17.417 Vali Acc: 0.247 Test Loss: 17.417 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.32210111618042
Epoch: 4, Steps: 17 | Train Loss: 15.579 Vali Loss: 16.242 Vali Acc: 0.255 Test Loss: 16.242 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3440907001495361
Epoch: 5, Steps: 17 | Train Loss: 12.712 Vali Loss: 14.101 Vali Acc: 0.251 Test Loss: 14.101 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2379295825958252
Epoch: 6, Steps: 17 | Train Loss: 14.394 Vali Loss: 28.569 Vali Acc: 0.247 Test Loss: 28.569 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.140136480331421
Epoch: 7, Steps: 17 | Train Loss: 16.079 Vali Loss: 17.992 Vali Acc: 0.255 Test Loss: 17.992 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.358705759048462
Epoch: 8, Steps: 17 | Train Loss: 23.424 Vali Loss: 36.911 Vali Acc: 0.255 Test Loss: 36.911 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.538771390914917
Epoch: 9, Steps: 17 | Train Loss: 26.790 Vali Loss: 43.191 Vali Acc: 0.236 Test Loss: 43.191 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4601161479949951
Epoch: 10, Steps: 17 | Train Loss: 28.282 Vali Loss: 34.203 Vali Acc: 0.247 Test Loss: 34.203 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2934455871582031
Epoch: 11, Steps: 17 | Train Loss: 20.893 Vali Loss: 46.088 Vali Acc: 0.289 Test Loss: 46.088 Test Acc: 0.289
Validation loss decreased (-0.254668 --> -0.288513).  Saving model ...
Epoch: 12 cost time: 1.363584041595459
Epoch: 12, Steps: 17 | Train Loss: 22.564 Vali Loss: 24.594 Vali Acc: 0.251 Test Loss: 24.594 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.459779977798462
Epoch: 13, Steps: 17 | Train Loss: 10.925 Vali Loss: 33.603 Vali Acc: 0.266 Test Loss: 33.603 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4561994075775146
Epoch: 14, Steps: 17 | Train Loss: 29.029 Vali Loss: 38.692 Vali Acc: 0.285 Test Loss: 38.692 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3770954608917236
Epoch: 15, Steps: 17 | Train Loss: 24.140 Vali Loss: 23.046 Vali Acc: 0.194 Test Loss: 23.046 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.447005271911621
Epoch: 16, Steps: 17 | Train Loss: 16.113 Vali Loss: 26.496 Vali Acc: 0.224 Test Loss: 26.496 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1835839748382568
Epoch: 17, Steps: 17 | Train Loss: 15.262 Vali Loss: 54.137 Vali Acc: 0.247 Test Loss: 54.137 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2285912036895752
Epoch: 18, Steps: 17 | Train Loss: 20.937 Vali Loss: 65.597 Vali Acc: 0.262 Test Loss: 65.597 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3581430912017822
Epoch: 19, Steps: 17 | Train Loss: 21.698 Vali Loss: 47.907 Vali Acc: 0.243 Test Loss: 47.907 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1909716129302979
Epoch: 20, Steps: 17 | Train Loss: 6.295 Vali Loss: 42.782 Vali Acc: 0.262 Test Loss: 42.782 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3401272296905518
Epoch: 21, Steps: 17 | Train Loss: 5.691 Vali Loss: 51.925 Vali Acc: 0.247 Test Loss: 51.925 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 474592
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.384448289871216
Epoch: 1, Steps: 17 | Train Loss: 8.521 Vali Loss: 4.428 Vali Acc: 0.251 Test Loss: 4.428 Test Acc: 0.251
Validation loss decreased (inf --> -0.250906).  Saving model ...
Epoch: 2 cost time: 1.1897661685943604
Epoch: 2, Steps: 17 | Train Loss: 9.003 Vali Loss: 10.203 Vali Acc: 0.259 Test Loss: 10.203 Test Acc: 0.259
Validation loss decreased (-0.250906 --> -0.258453).  Saving model ...
Epoch: 3 cost time: 1.2026808261871338
Epoch: 3, Steps: 17 | Train Loss: 10.403 Vali Loss: 20.746 Vali Acc: 0.266 Test Loss: 20.746 Test Acc: 0.266
Validation loss decreased (-0.258453 --> -0.265952).  Saving model ...
Epoch: 4 cost time: 1.2870290279388428
Epoch: 4, Steps: 17 | Train Loss: 11.382 Vali Loss: 12.945 Vali Acc: 0.240 Test Loss: 12.945 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.309631586074829
Epoch: 5, Steps: 17 | Train Loss: 17.355 Vali Loss: 10.625 Vali Acc: 0.278 Test Loss: 10.625 Test Acc: 0.278
Validation loss decreased (-0.265952 --> -0.277460).  Saving model ...
Epoch: 6 cost time: 1.2796821594238281
Epoch: 6, Steps: 17 | Train Loss: 15.357 Vali Loss: 28.759 Vali Acc: 0.266 Test Loss: 28.759 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.190777063369751
Epoch: 7, Steps: 17 | Train Loss: 15.124 Vali Loss: 13.756 Vali Acc: 0.251 Test Loss: 13.756 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.168092966079712
Epoch: 8, Steps: 17 | Train Loss: 11.524 Vali Loss: 18.724 Vali Acc: 0.278 Test Loss: 18.724 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2745819091796875
Epoch: 9, Steps: 17 | Train Loss: 16.767 Vali Loss: 29.576 Vali Acc: 0.262 Test Loss: 29.576 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.103029727935791
Epoch: 10, Steps: 17 | Train Loss: 19.277 Vali Loss: 24.316 Vali Acc: 0.236 Test Loss: 24.316 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3624026775360107
Epoch: 11, Steps: 17 | Train Loss: 12.007 Vali Loss: 17.712 Vali Acc: 0.278 Test Loss: 17.712 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.295685052871704
Epoch: 12, Steps: 17 | Train Loss: 18.317 Vali Loss: 13.513 Vali Acc: 0.289 Test Loss: 13.513 Test Acc: 0.289
Validation loss decreased (-0.277460 --> -0.288838).  Saving model ...
Epoch: 13 cost time: 1.3410396575927734
Epoch: 13, Steps: 17 | Train Loss: 17.708 Vali Loss: 37.496 Vali Acc: 0.270 Test Loss: 37.496 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3382611274719238
Epoch: 14, Steps: 17 | Train Loss: 27.085 Vali Loss: 17.253 Vali Acc: 0.247 Test Loss: 17.253 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.31597900390625
Epoch: 15, Steps: 17 | Train Loss: 13.404 Vali Loss: 35.630 Vali Acc: 0.285 Test Loss: 35.630 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2981171607971191
Epoch: 16, Steps: 17 | Train Loss: 10.288 Vali Loss: 19.030 Vali Acc: 0.278 Test Loss: 19.030 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3279685974121094
Epoch: 17, Steps: 17 | Train Loss: 9.056 Vali Loss: 36.974 Vali Acc: 0.255 Test Loss: 36.974 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.37544846534729
Epoch: 18, Steps: 17 | Train Loss: 15.239 Vali Loss: 46.713 Vali Acc: 0.266 Test Loss: 46.713 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3140554428100586
Epoch: 19, Steps: 17 | Train Loss: 15.587 Vali Loss: 55.266 Vali Acc: 0.266 Test Loss: 55.266 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3329973220825195
Epoch: 20, Steps: 17 | Train Loss: 14.644 Vali Loss: 47.656 Vali Acc: 0.293 Test Loss: 47.656 Test Acc: 0.293
Validation loss decreased (-0.288838 --> -0.292299).  Saving model ...
Epoch: 21 cost time: 1.2364680767059326
Epoch: 21, Steps: 17 | Train Loss: 7.726 Vali Loss: 50.270 Vali Acc: 0.270 Test Loss: 50.270 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2865524291992188
Epoch: 22, Steps: 17 | Train Loss: 9.996 Vali Loss: 56.752 Vali Acc: 0.232 Test Loss: 56.752 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1537096500396729
Epoch: 23, Steps: 17 | Train Loss: 7.586 Vali Loss: 55.089 Vali Acc: 0.266 Test Loss: 55.089 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4012501239776611
Epoch: 24, Steps: 17 | Train Loss: 6.197 Vali Loss: 62.891 Vali Acc: 0.285 Test Loss: 62.891 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2643041610717773
Epoch: 25, Steps: 17 | Train Loss: 6.337 Vali Loss: 68.021 Vali Acc: 0.232 Test Loss: 68.021 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3499047756195068
Epoch: 26, Steps: 17 | Train Loss: 12.028 Vali Loss: 89.067 Vali Acc: 0.243 Test Loss: 89.067 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3890035152435303
Epoch: 27, Steps: 17 | Train Loss: 10.888 Vali Loss: 91.983 Vali Acc: 0.255 Test Loss: 91.983 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.265850305557251
Epoch: 28, Steps: 17 | Train Loss: 13.422 Vali Loss: 125.356 Vali Acc: 0.255 Test Loss: 125.356 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2525513172149658
Epoch: 29, Steps: 17 | Train Loss: 7.747 Vali Loss: 103.244 Vali Acc: 0.224 Test Loss: 103.244 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2661387920379639
Epoch: 30, Steps: 17 | Train Loss: 4.417 Vali Loss: 125.910 Vali Acc: 0.217 Test Loss: 125.910 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 474592
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.734096050262451
Epoch: 1, Steps: 17 | Train Loss: 8.918 Vali Loss: 19.187 Vali Acc: 0.259 Test Loss: 19.187 Test Acc: 0.259
Validation loss decreased (inf --> -0.258363).  Saving model ...
Epoch: 2 cost time: 1.5262491703033447
Epoch: 2, Steps: 17 | Train Loss: 15.970 Vali Loss: 24.945 Vali Acc: 0.247 Test Loss: 24.945 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4870085716247559
Epoch: 3, Steps: 17 | Train Loss: 16.479 Vali Loss: 23.669 Vali Acc: 0.240 Test Loss: 23.669 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.572005271911621
Epoch: 4, Steps: 17 | Train Loss: 23.543 Vali Loss: 48.274 Vali Acc: 0.251 Test Loss: 48.274 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6887094974517822
Epoch: 5, Steps: 17 | Train Loss: 33.858 Vali Loss: 56.560 Vali Acc: 0.247 Test Loss: 56.560 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5470404624938965
Epoch: 6, Steps: 17 | Train Loss: 31.668 Vali Loss: 27.322 Vali Acc: 0.255 Test Loss: 27.322 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5049538612365723
Epoch: 7, Steps: 17 | Train Loss: 36.504 Vali Loss: 65.887 Vali Acc: 0.270 Test Loss: 65.887 Test Acc: 0.270
Validation loss decreased (-0.258363 --> -0.269303).  Saving model ...
Epoch: 8 cost time: 1.378598690032959
Epoch: 8, Steps: 17 | Train Loss: 44.729 Vali Loss: 41.858 Vali Acc: 0.213 Test Loss: 41.858 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.445084571838379
Epoch: 9, Steps: 17 | Train Loss: 29.974 Vali Loss: 37.200 Vali Acc: 0.262 Test Loss: 37.200 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.450195550918579
Epoch: 10, Steps: 17 | Train Loss: 21.693 Vali Loss: 20.264 Vali Acc: 0.266 Test Loss: 20.264 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5733227729797363
Epoch: 11, Steps: 17 | Train Loss: 14.383 Vali Loss: 18.308 Vali Acc: 0.262 Test Loss: 18.308 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.636962890625
Epoch: 12, Steps: 17 | Train Loss: 14.738 Vali Loss: 26.562 Vali Acc: 0.274 Test Loss: 26.562 Test Acc: 0.274
Validation loss decreased (-0.269303 --> -0.273499).  Saving model ...
Epoch: 13 cost time: 1.6659157276153564
Epoch: 13, Steps: 17 | Train Loss: 13.952 Vali Loss: 26.493 Vali Acc: 0.243 Test Loss: 26.493 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6762607097625732
Epoch: 14, Steps: 17 | Train Loss: 15.028 Vali Loss: 46.651 Vali Acc: 0.255 Test Loss: 46.651 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4664218425750732
Epoch: 15, Steps: 17 | Train Loss: 16.426 Vali Loss: 55.654 Vali Acc: 0.232 Test Loss: 55.654 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6697254180908203
Epoch: 16, Steps: 17 | Train Loss: 21.041 Vali Loss: 31.958 Vali Acc: 0.251 Test Loss: 31.958 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5734896659851074
Epoch: 17, Steps: 17 | Train Loss: 9.289 Vali Loss: 38.510 Vali Acc: 0.255 Test Loss: 38.510 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5767347812652588
Epoch: 18, Steps: 17 | Train Loss: 22.580 Vali Loss: 51.170 Vali Acc: 0.293 Test Loss: 51.170 Test Acc: 0.293
Validation loss decreased (-0.273499 --> -0.292264).  Saving model ...
Epoch: 19 cost time: 1.5807783603668213
Epoch: 19, Steps: 17 | Train Loss: 16.730 Vali Loss: 56.005 Vali Acc: 0.247 Test Loss: 56.005 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6490418910980225
Epoch: 20, Steps: 17 | Train Loss: 16.897 Vali Loss: 41.061 Vali Acc: 0.278 Test Loss: 41.061 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5212485790252686
Epoch: 21, Steps: 17 | Train Loss: 18.321 Vali Loss: 105.860 Vali Acc: 0.262 Test Loss: 105.860 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4110100269317627
Epoch: 22, Steps: 17 | Train Loss: 19.281 Vali Loss: 53.803 Vali Acc: 0.270 Test Loss: 53.803 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6202497482299805
Epoch: 23, Steps: 17 | Train Loss: 15.411 Vali Loss: 56.977 Vali Acc: 0.293 Test Loss: 56.977 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5065553188323975
Epoch: 24, Steps: 17 | Train Loss: 15.144 Vali Loss: 62.776 Vali Acc: 0.281 Test Loss: 62.776 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6013741493225098
Epoch: 25, Steps: 17 | Train Loss: 10.850 Vali Loss: 84.481 Vali Acc: 0.274 Test Loss: 84.481 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5233278274536133
Epoch: 26, Steps: 17 | Train Loss: 5.824 Vali Loss: 76.356 Vali Acc: 0.259 Test Loss: 76.356 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5299885272979736
Epoch: 27, Steps: 17 | Train Loss: 5.483 Vali Loss: 91.439 Vali Acc: 0.266 Test Loss: 91.439 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4807686805725098
Epoch: 28, Steps: 17 | Train Loss: 5.866 Vali Loss: 94.059 Vali Acc: 0.232 Test Loss: 94.059 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 466400
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.626356363296509
Epoch: 1, Steps: 17 | Train Loss: 7.370 Vali Loss: 13.004 Vali Acc: 0.240 Test Loss: 13.004 Test Acc: 0.240
Validation loss decreased (inf --> -0.239414).  Saving model ...
Epoch: 2 cost time: 1.561262607574463
Epoch: 2, Steps: 17 | Train Loss: 10.562 Vali Loss: 16.085 Vali Acc: 0.236 Test Loss: 16.085 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4858925342559814
Epoch: 3, Steps: 17 | Train Loss: 20.774 Vali Loss: 26.131 Vali Acc: 0.240 Test Loss: 26.131 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6007232666015625
Epoch: 4, Steps: 17 | Train Loss: 15.353 Vali Loss: 30.753 Vali Acc: 0.262 Test Loss: 30.753 Test Acc: 0.262
Validation loss decreased (-0.239414 --> -0.262050).  Saving model ...
Epoch: 5 cost time: 1.5188159942626953
Epoch: 5, Steps: 17 | Train Loss: 23.397 Vali Loss: 38.906 Vali Acc: 0.251 Test Loss: 38.906 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5501203536987305
Epoch: 6, Steps: 17 | Train Loss: 29.419 Vali Loss: 29.166 Vali Acc: 0.213 Test Loss: 29.166 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6381850242614746
Epoch: 7, Steps: 17 | Train Loss: 32.963 Vali Loss: 47.980 Vali Acc: 0.247 Test Loss: 47.980 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5452895164489746
Epoch: 8, Steps: 17 | Train Loss: 34.622 Vali Loss: 38.012 Vali Acc: 0.259 Test Loss: 38.012 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.452390432357788
Epoch: 9, Steps: 17 | Train Loss: 27.283 Vali Loss: 48.435 Vali Acc: 0.259 Test Loss: 48.435 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5642268657684326
Epoch: 10, Steps: 17 | Train Loss: 31.466 Vali Loss: 28.052 Vali Acc: 0.255 Test Loss: 28.052 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.436774730682373
Epoch: 11, Steps: 17 | Train Loss: 22.095 Vali Loss: 45.053 Vali Acc: 0.255 Test Loss: 45.053 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6268231868743896
Epoch: 12, Steps: 17 | Train Loss: 23.858 Vali Loss: 40.698 Vali Acc: 0.240 Test Loss: 40.698 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4880712032318115
Epoch: 13, Steps: 17 | Train Loss: 18.494 Vali Loss: 21.664 Vali Acc: 0.278 Test Loss: 21.664 Test Acc: 0.278
Validation loss decreased (-0.262050 --> -0.277350).  Saving model ...
Epoch: 14 cost time: 1.4963395595550537
Epoch: 14, Steps: 17 | Train Loss: 12.423 Vali Loss: 18.450 Vali Acc: 0.232 Test Loss: 18.450 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4831056594848633
Epoch: 15, Steps: 17 | Train Loss: 14.261 Vali Loss: 43.059 Vali Acc: 0.297 Test Loss: 43.059 Test Acc: 0.297
Validation loss decreased (-0.277350 --> -0.296147).  Saving model ...
Epoch: 16 cost time: 1.429013729095459
Epoch: 16, Steps: 17 | Train Loss: 12.548 Vali Loss: 31.659 Vali Acc: 0.243 Test Loss: 31.659 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4383537769317627
Epoch: 17, Steps: 17 | Train Loss: 13.637 Vali Loss: 30.806 Vali Acc: 0.274 Test Loss: 30.806 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.384026288986206
Epoch: 18, Steps: 17 | Train Loss: 13.373 Vali Loss: 45.273 Vali Acc: 0.270 Test Loss: 45.273 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5129115581512451
Epoch: 19, Steps: 17 | Train Loss: 13.547 Vali Loss: 42.286 Vali Acc: 0.278 Test Loss: 42.286 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5405852794647217
Epoch: 20, Steps: 17 | Train Loss: 11.852 Vali Loss: 47.867 Vali Acc: 0.247 Test Loss: 47.867 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5099787712097168
Epoch: 21, Steps: 17 | Train Loss: 12.479 Vali Loss: 55.279 Vali Acc: 0.266 Test Loss: 55.279 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5925185680389404
Epoch: 22, Steps: 17 | Train Loss: 10.752 Vali Loss: 42.180 Vali Acc: 0.232 Test Loss: 42.180 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4738130569458008
Epoch: 23, Steps: 17 | Train Loss: 7.626 Vali Loss: 47.560 Vali Acc: 0.255 Test Loss: 47.560 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4497644901275635
Epoch: 24, Steps: 17 | Train Loss: 10.083 Vali Loss: 68.163 Vali Acc: 0.255 Test Loss: 68.163 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.315755844116211
Epoch: 25, Steps: 17 | Train Loss: 11.088 Vali Loss: 76.526 Vali Acc: 0.270 Test Loss: 76.526 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 466400
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.260418176651001
Epoch: 1, Steps: 17 | Train Loss: 6.996 Vali Loss: 14.727 Vali Acc: 0.247 Test Loss: 14.727 Test Acc: 0.247
Validation loss decreased (inf --> -0.247001).  Saving model ...
Epoch: 2 cost time: 1.3876700401306152
Epoch: 2, Steps: 17 | Train Loss: 16.221 Vali Loss: 27.773 Vali Acc: 0.243 Test Loss: 27.773 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4901542663574219
Epoch: 3, Steps: 17 | Train Loss: 26.756 Vali Loss: 33.505 Vali Acc: 0.251 Test Loss: 33.505 Test Acc: 0.251
Validation loss decreased (-0.247001 --> -0.250616).  Saving model ...
Epoch: 4 cost time: 1.3835580348968506
Epoch: 4, Steps: 17 | Train Loss: 20.013 Vali Loss: 42.163 Vali Acc: 0.251 Test Loss: 42.163 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3708372116088867
Epoch: 5, Steps: 17 | Train Loss: 21.535 Vali Loss: 15.715 Vali Acc: 0.251 Test Loss: 15.715 Test Acc: 0.251
Validation loss decreased (-0.250616 --> -0.250793).  Saving model ...
Epoch: 6 cost time: 1.5141115188598633
Epoch: 6, Steps: 17 | Train Loss: 27.288 Vali Loss: 25.210 Vali Acc: 0.232 Test Loss: 25.210 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4765419960021973
Epoch: 7, Steps: 17 | Train Loss: 14.787 Vali Loss: 12.077 Vali Acc: 0.251 Test Loss: 12.077 Test Acc: 0.251
Validation loss decreased (-0.250793 --> -0.250830).  Saving model ...
Epoch: 8 cost time: 1.5557947158813477
Epoch: 8, Steps: 17 | Train Loss: 23.457 Vali Loss: 30.310 Vali Acc: 0.236 Test Loss: 30.310 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4955394268035889
Epoch: 9, Steps: 17 | Train Loss: 22.833 Vali Loss: 23.232 Vali Acc: 0.266 Test Loss: 23.232 Test Acc: 0.266
Validation loss decreased (-0.250830 --> -0.265927).  Saving model ...
Epoch: 10 cost time: 1.3684163093566895
Epoch: 10, Steps: 17 | Train Loss: 14.762 Vali Loss: 29.166 Vali Acc: 0.243 Test Loss: 29.166 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4284701347351074
Epoch: 11, Steps: 17 | Train Loss: 17.225 Vali Loss: 27.805 Vali Acc: 0.251 Test Loss: 27.805 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5291180610656738
Epoch: 12, Steps: 17 | Train Loss: 11.373 Vali Loss: 26.029 Vali Acc: 0.224 Test Loss: 26.029 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4938287734985352
Epoch: 13, Steps: 17 | Train Loss: 15.647 Vali Loss: 18.553 Vali Acc: 0.259 Test Loss: 18.553 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3096950054168701
Epoch: 14, Steps: 17 | Train Loss: 25.493 Vali Loss: 66.130 Vali Acc: 0.255 Test Loss: 66.130 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3906197547912598
Epoch: 15, Steps: 17 | Train Loss: 25.090 Vali Loss: 58.833 Vali Acc: 0.262 Test Loss: 58.833 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3948919773101807
Epoch: 16, Steps: 17 | Train Loss: 15.165 Vali Loss: 41.163 Vali Acc: 0.251 Test Loss: 41.163 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4678077697753906
Epoch: 17, Steps: 17 | Train Loss: 18.183 Vali Loss: 35.585 Vali Acc: 0.255 Test Loss: 35.585 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.520618200302124
Epoch: 18, Steps: 17 | Train Loss: 16.341 Vali Loss: 38.344 Vali Acc: 0.236 Test Loss: 38.344 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.484131097793579
Epoch: 19, Steps: 17 | Train Loss: 9.312 Vali Loss: 54.659 Vali Acc: 0.236 Test Loss: 54.659 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 466400
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.1750245094299316
Epoch: 1, Steps: 17 | Train Loss: 11.943 Vali Loss: 13.642 Vali Acc: 0.247 Test Loss: 13.642 Test Acc: 0.247
Validation loss decreased (inf --> -0.247012).  Saving model ...
Epoch: 2 cost time: 1.2447161674499512
Epoch: 2, Steps: 17 | Train Loss: 12.305 Vali Loss: 10.731 Vali Acc: 0.274 Test Loss: 10.731 Test Acc: 0.274
Validation loss decreased (-0.247012 --> -0.273657).  Saving model ...
Epoch: 3 cost time: 1.3210647106170654
Epoch: 3, Steps: 17 | Train Loss: 14.346 Vali Loss: 15.665 Vali Acc: 0.243 Test Loss: 15.665 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.413649082183838
Epoch: 4, Steps: 17 | Train Loss: 19.357 Vali Loss: 27.290 Vali Acc: 0.270 Test Loss: 27.290 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3684756755828857
Epoch: 5, Steps: 17 | Train Loss: 20.877 Vali Loss: 10.407 Vali Acc: 0.236 Test Loss: 10.407 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4172124862670898
Epoch: 6, Steps: 17 | Train Loss: 17.799 Vali Loss: 29.711 Vali Acc: 0.251 Test Loss: 29.711 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3564250469207764
Epoch: 7, Steps: 17 | Train Loss: 24.384 Vali Loss: 22.517 Vali Acc: 0.240 Test Loss: 22.517 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.292726755142212
Epoch: 8, Steps: 17 | Train Loss: 26.248 Vali Loss: 37.784 Vali Acc: 0.247 Test Loss: 37.784 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3347089290618896
Epoch: 9, Steps: 17 | Train Loss: 34.483 Vali Loss: 28.861 Vali Acc: 0.255 Test Loss: 28.861 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.339345932006836
Epoch: 10, Steps: 17 | Train Loss: 26.433 Vali Loss: 29.198 Vali Acc: 0.243 Test Loss: 29.198 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.203195333480835
Epoch: 11, Steps: 17 | Train Loss: 16.577 Vali Loss: 41.039 Vali Acc: 0.255 Test Loss: 41.039 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3464102745056152
Epoch: 12, Steps: 17 | Train Loss: 27.817 Vali Loss: 27.961 Vali Acc: 0.259 Test Loss: 27.961 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 466400
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4211020469665527
Epoch: 1, Steps: 17 | Train Loss: 4.802 Vali Loss: 4.571 Vali Acc: 0.270 Test Loss: 4.571 Test Acc: 0.270
Validation loss decreased (inf --> -0.269916).  Saving model ...
Epoch: 2 cost time: 1.2912638187408447
Epoch: 2, Steps: 17 | Train Loss: 5.876 Vali Loss: 11.271 Vali Acc: 0.262 Test Loss: 11.271 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4051599502563477
Epoch: 3, Steps: 17 | Train Loss: 7.042 Vali Loss: 5.971 Vali Acc: 0.255 Test Loss: 5.971 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.330559492111206
Epoch: 4, Steps: 17 | Train Loss: 8.429 Vali Loss: 8.935 Vali Acc: 0.270 Test Loss: 8.935 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.325256109237671
Epoch: 5, Steps: 17 | Train Loss: 11.489 Vali Loss: 11.379 Vali Acc: 0.236 Test Loss: 11.379 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5529115200042725
Epoch: 6, Steps: 17 | Train Loss: 6.595 Vali Loss: 16.892 Vali Acc: 0.240 Test Loss: 16.892 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.359001636505127
Epoch: 7, Steps: 17 | Train Loss: 10.084 Vali Loss: 12.078 Vali Acc: 0.247 Test Loss: 12.078 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3549535274505615
Epoch: 8, Steps: 17 | Train Loss: 10.190 Vali Loss: 14.553 Vali Acc: 0.251 Test Loss: 14.553 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4118402004241943
Epoch: 9, Steps: 17 | Train Loss: 12.867 Vali Loss: 25.124 Vali Acc: 0.247 Test Loss: 25.124 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3887240886688232
Epoch: 10, Steps: 17 | Train Loss: 11.812 Vali Loss: 15.516 Vali Acc: 0.247 Test Loss: 15.516 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3648879528045654
Epoch: 11, Steps: 17 | Train Loss: 7.041 Vali Loss: 10.842 Vali Acc: 0.251 Test Loss: 10.842 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 358144
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4925146102905273
Epoch: 1, Steps: 17 | Train Loss: 4.746 Vali Loss: 3.558 Vali Acc: 0.274 Test Loss: 3.558 Test Acc: 0.274
Validation loss decreased (inf --> -0.273729).  Saving model ...
Epoch: 2 cost time: 1.3946313858032227
Epoch: 2, Steps: 17 | Train Loss: 6.305 Vali Loss: 9.234 Vali Acc: 0.255 Test Loss: 9.234 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3106639385223389
Epoch: 3, Steps: 17 | Train Loss: 7.471 Vali Loss: 4.948 Vali Acc: 0.259 Test Loss: 4.948 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4647142887115479
Epoch: 4, Steps: 17 | Train Loss: 9.327 Vali Loss: 8.728 Vali Acc: 0.243 Test Loss: 8.728 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3518469333648682
Epoch: 5, Steps: 17 | Train Loss: 7.928 Vali Loss: 4.891 Vali Acc: 0.240 Test Loss: 4.891 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2434055805206299
Epoch: 6, Steps: 17 | Train Loss: 7.097 Vali Loss: 16.779 Vali Acc: 0.247 Test Loss: 16.779 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2315125465393066
Epoch: 7, Steps: 17 | Train Loss: 7.104 Vali Loss: 14.634 Vali Acc: 0.240 Test Loss: 14.634 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3982608318328857
Epoch: 8, Steps: 17 | Train Loss: 14.626 Vali Loss: 19.469 Vali Acc: 0.255 Test Loss: 19.469 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3334152698516846
Epoch: 9, Steps: 17 | Train Loss: 13.807 Vali Loss: 19.209 Vali Acc: 0.262 Test Loss: 19.209 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4913785457611084
Epoch: 10, Steps: 17 | Train Loss: 6.974 Vali Loss: 15.000 Vali Acc: 0.259 Test Loss: 15.000 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4069788455963135
Epoch: 11, Steps: 17 | Train Loss: 7.257 Vali Loss: 17.598 Vali Acc: 0.262 Test Loss: 17.598 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 358144
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4972479343414307
Epoch: 1, Steps: 17 | Train Loss: 4.458 Vali Loss: 3.783 Vali Acc: 0.228 Test Loss: 3.783 Test Acc: 0.228
Validation loss decreased (inf --> -0.228099).  Saving model ...
Epoch: 2 cost time: 1.3224091529846191
Epoch: 2, Steps: 17 | Train Loss: 7.314 Vali Loss: 15.673 Vali Acc: 0.251 Test Loss: 15.673 Test Acc: 0.251
Validation loss decreased (-0.228099 --> -0.250794).  Saving model ...
Epoch: 3 cost time: 1.2186808586120605
Epoch: 3, Steps: 17 | Train Loss: 15.006 Vali Loss: 33.040 Vali Acc: 0.247 Test Loss: 33.040 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3179011344909668
Epoch: 4, Steps: 17 | Train Loss: 17.064 Vali Loss: 9.921 Vali Acc: 0.255 Test Loss: 9.921 Test Acc: 0.255
Validation loss decreased (-0.250794 --> -0.254654).  Saving model ...
Epoch: 5 cost time: 1.3969464302062988
Epoch: 5, Steps: 17 | Train Loss: 8.205 Vali Loss: 15.202 Vali Acc: 0.243 Test Loss: 15.202 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.393984317779541
Epoch: 6, Steps: 17 | Train Loss: 10.968 Vali Loss: 9.350 Vali Acc: 0.255 Test Loss: 9.350 Test Acc: 0.255
Validation loss decreased (-0.254654 --> -0.254659).  Saving model ...
Epoch: 7 cost time: 1.2981417179107666
Epoch: 7, Steps: 17 | Train Loss: 12.353 Vali Loss: 17.066 Vali Acc: 0.262 Test Loss: 17.066 Test Acc: 0.262
Validation loss decreased (-0.254659 --> -0.262187).  Saving model ...
Epoch: 8 cost time: 1.2521889209747314
Epoch: 8, Steps: 17 | Train Loss: 14.861 Vali Loss: 18.008 Vali Acc: 0.262 Test Loss: 18.008 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2983763217926025
Epoch: 9, Steps: 17 | Train Loss: 18.555 Vali Loss: 15.299 Vali Acc: 0.224 Test Loss: 15.299 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3595566749572754
Epoch: 10, Steps: 17 | Train Loss: 22.881 Vali Loss: 24.709 Vali Acc: 0.259 Test Loss: 24.709 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3536839485168457
Epoch: 11, Steps: 17 | Train Loss: 19.981 Vali Loss: 21.484 Vali Acc: 0.255 Test Loss: 21.484 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.337517499923706
Epoch: 12, Steps: 17 | Train Loss: 17.672 Vali Loss: 17.886 Vali Acc: 0.247 Test Loss: 17.886 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3430922031402588
Epoch: 13, Steps: 17 | Train Loss: 8.353 Vali Loss: 20.426 Vali Acc: 0.247 Test Loss: 20.426 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.313185691833496
Epoch: 14, Steps: 17 | Train Loss: 10.938 Vali Loss: 20.887 Vali Acc: 0.262 Test Loss: 20.887 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.383324146270752
Epoch: 15, Steps: 17 | Train Loss: 7.826 Vali Loss: 10.547 Vali Acc: 0.259 Test Loss: 10.547 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.510284423828125
Epoch: 16, Steps: 17 | Train Loss: 4.126 Vali Loss: 7.424 Vali Acc: 0.243 Test Loss: 7.424 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.378530502319336
Epoch: 17, Steps: 17 | Train Loss: 5.434 Vali Loss: 21.893 Vali Acc: 0.251 Test Loss: 21.893 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 358144
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3793325424194336
Epoch: 1, Steps: 17 | Train Loss: 4.545 Vali Loss: 5.545 Vali Acc: 0.278 Test Loss: 5.545 Test Acc: 0.278
Validation loss decreased (inf --> -0.277511).  Saving model ...
Epoch: 2 cost time: 1.3693280220031738
Epoch: 2, Steps: 17 | Train Loss: 6.088 Vali Loss: 4.802 Vali Acc: 0.266 Test Loss: 4.802 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3137195110321045
Epoch: 3, Steps: 17 | Train Loss: 8.019 Vali Loss: 8.127 Vali Acc: 0.247 Test Loss: 8.127 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.407611608505249
Epoch: 4, Steps: 17 | Train Loss: 9.309 Vali Loss: 6.847 Vali Acc: 0.262 Test Loss: 6.847 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.336003303527832
Epoch: 5, Steps: 17 | Train Loss: 10.770 Vali Loss: 10.205 Vali Acc: 0.251 Test Loss: 10.205 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2969708442687988
Epoch: 6, Steps: 17 | Train Loss: 15.392 Vali Loss: 19.719 Vali Acc: 0.251 Test Loss: 19.719 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3408269882202148
Epoch: 7, Steps: 17 | Train Loss: 17.383 Vali Loss: 14.165 Vali Acc: 0.262 Test Loss: 14.165 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3770318031311035
Epoch: 8, Steps: 17 | Train Loss: 9.266 Vali Loss: 10.201 Vali Acc: 0.255 Test Loss: 10.201 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3584256172180176
Epoch: 9, Steps: 17 | Train Loss: 7.731 Vali Loss: 6.517 Vali Acc: 0.224 Test Loss: 6.517 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3130526542663574
Epoch: 10, Steps: 17 | Train Loss: 7.226 Vali Loss: 5.954 Vali Acc: 0.266 Test Loss: 5.954 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4006016254425049
Epoch: 11, Steps: 17 | Train Loss: 8.258 Vali Loss: 20.267 Vali Acc: 0.259 Test Loss: 20.267 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 358144
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.213526487350464
Epoch: 1, Steps: 17 | Train Loss: 5.737 Vali Loss: 8.496 Vali Acc: 0.259 Test Loss: 8.496 Test Acc: 0.259
Validation loss decreased (inf --> -0.258470).  Saving model ...
Epoch: 2 cost time: 1.3375372886657715
Epoch: 2, Steps: 17 | Train Loss: 9.245 Vali Loss: 6.722 Vali Acc: 0.240 Test Loss: 6.722 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.291121482849121
Epoch: 3, Steps: 17 | Train Loss: 6.577 Vali Loss: 23.958 Vali Acc: 0.262 Test Loss: 23.958 Test Acc: 0.262
Validation loss decreased (-0.258470 --> -0.262118).  Saving model ...
Epoch: 4 cost time: 1.1355254650115967
Epoch: 4, Steps: 17 | Train Loss: 14.865 Vali Loss: 16.975 Vali Acc: 0.259 Test Loss: 16.975 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.265369176864624
Epoch: 5, Steps: 17 | Train Loss: 12.975 Vali Loss: 14.323 Vali Acc: 0.251 Test Loss: 14.323 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.299407958984375
Epoch: 6, Steps: 17 | Train Loss: 12.675 Vali Loss: 23.147 Vali Acc: 0.259 Test Loss: 23.147 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.296262264251709
Epoch: 7, Steps: 17 | Train Loss: 14.266 Vali Loss: 21.797 Vali Acc: 0.240 Test Loss: 21.797 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0380945205688477
Epoch: 8, Steps: 17 | Train Loss: 16.159 Vali Loss: 25.237 Vali Acc: 0.262 Test Loss: 25.237 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4686834812164307
Epoch: 9, Steps: 17 | Train Loss: 14.367 Vali Loss: 17.233 Vali Acc: 0.262 Test Loss: 17.233 Test Acc: 0.262
Validation loss decreased (-0.262118 --> -0.262185).  Saving model ...
Epoch: 10 cost time: 1.4303030967712402
Epoch: 10, Steps: 17 | Train Loss: 11.765 Vali Loss: 15.951 Vali Acc: 0.247 Test Loss: 15.951 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4113667011260986
Epoch: 11, Steps: 17 | Train Loss: 8.012 Vali Loss: 25.167 Vali Acc: 0.251 Test Loss: 25.167 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3712873458862305
Epoch: 12, Steps: 17 | Train Loss: 12.713 Vali Loss: 18.571 Vali Acc: 0.262 Test Loss: 18.571 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3220741748809814
Epoch: 13, Steps: 17 | Train Loss: 10.440 Vali Loss: 18.124 Vali Acc: 0.251 Test Loss: 18.124 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2051222324371338
Epoch: 14, Steps: 17 | Train Loss: 12.564 Vali Loss: 13.708 Vali Acc: 0.259 Test Loss: 13.708 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.111048936843872
Epoch: 15, Steps: 17 | Train Loss: 14.206 Vali Loss: 21.067 Vali Acc: 0.243 Test Loss: 21.067 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.124539852142334
Epoch: 16, Steps: 17 | Train Loss: 13.372 Vali Loss: 18.983 Vali Acc: 0.240 Test Loss: 18.983 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2888915538787842
Epoch: 17, Steps: 17 | Train Loss: 10.957 Vali Loss: 19.012 Vali Acc: 0.232 Test Loss: 19.012 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4954063892364502
Epoch: 18, Steps: 17 | Train Loss: 11.065 Vali Loss: 20.814 Vali Acc: 0.255 Test Loss: 20.814 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4331903457641602
Epoch: 19, Steps: 17 | Train Loss: 11.498 Vali Loss: 11.601 Vali Acc: 0.236 Test Loss: 11.601 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 292608
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4338085651397705
Epoch: 1, Steps: 17 | Train Loss: 5.586 Vali Loss: 7.191 Vali Acc: 0.274 Test Loss: 7.191 Test Acc: 0.274
Validation loss decreased (inf --> -0.273692).  Saving model ...
Epoch: 2 cost time: 1.2261395454406738
Epoch: 2, Steps: 17 | Train Loss: 8.139 Vali Loss: 6.596 Vali Acc: 0.232 Test Loss: 6.596 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2809088230133057
Epoch: 3, Steps: 17 | Train Loss: 5.079 Vali Loss: 17.152 Vali Acc: 0.247 Test Loss: 17.152 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.197840929031372
Epoch: 4, Steps: 17 | Train Loss: 8.858 Vali Loss: 8.622 Vali Acc: 0.262 Test Loss: 8.622 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.242311716079712
Epoch: 5, Steps: 17 | Train Loss: 10.731 Vali Loss: 18.822 Vali Acc: 0.266 Test Loss: 18.822 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1475741863250732
Epoch: 6, Steps: 17 | Train Loss: 16.212 Vali Loss: 18.484 Vali Acc: 0.259 Test Loss: 18.484 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.274282693862915
Epoch: 7, Steps: 17 | Train Loss: 11.618 Vali Loss: 20.683 Vali Acc: 0.255 Test Loss: 20.683 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.185185432434082
Epoch: 8, Steps: 17 | Train Loss: 12.310 Vali Loss: 14.642 Vali Acc: 0.255 Test Loss: 14.642 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2726645469665527
Epoch: 9, Steps: 17 | Train Loss: 16.019 Vali Loss: 15.741 Vali Acc: 0.247 Test Loss: 15.741 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.157257318496704
Epoch: 10, Steps: 17 | Train Loss: 12.292 Vali Loss: 11.955 Vali Acc: 0.255 Test Loss: 11.955 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.246769666671753
Epoch: 11, Steps: 17 | Train Loss: 10.962 Vali Loss: 21.023 Vali Acc: 0.228 Test Loss: 21.023 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 292608
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4283483028411865
Epoch: 1, Steps: 17 | Train Loss: 5.963 Vali Loss: 7.290 Vali Acc: 0.251 Test Loss: 7.290 Test Acc: 0.251
Validation loss decreased (inf --> -0.250878).  Saving model ...
Epoch: 2 cost time: 1.2457382678985596
Epoch: 2, Steps: 17 | Train Loss: 6.994 Vali Loss: 8.710 Vali Acc: 0.255 Test Loss: 8.710 Test Acc: 0.255
Validation loss decreased (-0.250878 --> -0.254666).  Saving model ...
Epoch: 3 cost time: 1.330538034439087
Epoch: 3, Steps: 17 | Train Loss: 6.822 Vali Loss: 18.829 Vali Acc: 0.259 Test Loss: 18.829 Test Acc: 0.259
Validation loss decreased (-0.254666 --> -0.258367).  Saving model ...
Epoch: 4 cost time: 1.1720120906829834
Epoch: 4, Steps: 17 | Train Loss: 10.867 Vali Loss: 6.424 Vali Acc: 0.270 Test Loss: 6.424 Test Acc: 0.270
Validation loss decreased (-0.258367 --> -0.269898).  Saving model ...
Epoch: 5 cost time: 1.3699626922607422
Epoch: 5, Steps: 17 | Train Loss: 12.674 Vali Loss: 17.404 Vali Acc: 0.247 Test Loss: 17.404 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.266700267791748
Epoch: 6, Steps: 17 | Train Loss: 11.754 Vali Loss: 14.327 Vali Acc: 0.255 Test Loss: 14.327 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3283987045288086
Epoch: 7, Steps: 17 | Train Loss: 12.592 Vali Loss: 27.978 Vali Acc: 0.259 Test Loss: 27.978 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2263083457946777
Epoch: 8, Steps: 17 | Train Loss: 16.455 Vali Loss: 24.094 Vali Acc: 0.259 Test Loss: 24.094 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.239333152770996
Epoch: 9, Steps: 17 | Train Loss: 19.421 Vali Loss: 17.222 Vali Acc: 0.247 Test Loss: 17.222 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2289690971374512
Epoch: 10, Steps: 17 | Train Loss: 16.598 Vali Loss: 18.849 Vali Acc: 0.228 Test Loss: 18.849 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2387733459472656
Epoch: 11, Steps: 17 | Train Loss: 10.849 Vali Loss: 28.970 Vali Acc: 0.251 Test Loss: 28.970 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3164830207824707
Epoch: 12, Steps: 17 | Train Loss: 15.408 Vali Loss: 22.083 Vali Acc: 0.224 Test Loss: 22.083 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3114042282104492
Epoch: 13, Steps: 17 | Train Loss: 14.593 Vali Loss: 12.161 Vali Acc: 0.259 Test Loss: 12.161 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2802999019622803
Epoch: 14, Steps: 17 | Train Loss: 7.780 Vali Loss: 18.048 Vali Acc: 0.243 Test Loss: 18.048 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 292608
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3907601833343506
Epoch: 1, Steps: 17 | Train Loss: 6.130 Vali Loss: 3.435 Vali Acc: 0.262 Test Loss: 3.435 Test Acc: 0.262
Validation loss decreased (inf --> -0.262323).  Saving model ...
Epoch: 2 cost time: 1.3485782146453857
Epoch: 2, Steps: 17 | Train Loss: 4.897 Vali Loss: 4.505 Vali Acc: 0.255 Test Loss: 4.505 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5624215602874756
Epoch: 3, Steps: 17 | Train Loss: 8.610 Vali Loss: 8.392 Vali Acc: 0.270 Test Loss: 8.392 Test Acc: 0.270
Validation loss decreased (-0.262323 --> -0.269878).  Saving model ...
Epoch: 4 cost time: 1.2933290004730225
Epoch: 4, Steps: 17 | Train Loss: 6.464 Vali Loss: 9.606 Vali Acc: 0.266 Test Loss: 9.606 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2835731506347656
Epoch: 5, Steps: 17 | Train Loss: 9.701 Vali Loss: 12.072 Vali Acc: 0.266 Test Loss: 12.072 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3817558288574219
Epoch: 6, Steps: 17 | Train Loss: 13.817 Vali Loss: 5.717 Vali Acc: 0.266 Test Loss: 5.717 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.229809284210205
Epoch: 7, Steps: 17 | Train Loss: 6.325 Vali Loss: 12.958 Vali Acc: 0.243 Test Loss: 12.958 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1530277729034424
Epoch: 8, Steps: 17 | Train Loss: 12.053 Vali Loss: 13.395 Vali Acc: 0.251 Test Loss: 13.395 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2015454769134521
Epoch: 9, Steps: 17 | Train Loss: 12.331 Vali Loss: 11.470 Vali Acc: 0.243 Test Loss: 11.470 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1942219734191895
Epoch: 10, Steps: 17 | Train Loss: 8.936 Vali Loss: 16.559 Vali Acc: 0.255 Test Loss: 16.559 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.201956033706665
Epoch: 11, Steps: 17 | Train Loss: 14.928 Vali Loss: 16.932 Vali Acc: 0.274 Test Loss: 16.932 Test Acc: 0.274
Validation loss decreased (-0.269878 --> -0.273595).  Saving model ...
Epoch: 12 cost time: 1.1942205429077148
Epoch: 12, Steps: 17 | Train Loss: 14.540 Vali Loss: 9.490 Vali Acc: 0.232 Test Loss: 9.490 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2695691585540771
Epoch: 13, Steps: 17 | Train Loss: 11.934 Vali Loss: 13.356 Vali Acc: 0.262 Test Loss: 13.356 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2382164001464844
Epoch: 14, Steps: 17 | Train Loss: 6.762 Vali Loss: 12.493 Vali Acc: 0.243 Test Loss: 12.493 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2750837802886963
Epoch: 15, Steps: 17 | Train Loss: 7.838 Vali Loss: 9.341 Vali Acc: 0.266 Test Loss: 9.341 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3572397232055664
Epoch: 16, Steps: 17 | Train Loss: 6.686 Vali Loss: 9.068 Vali Acc: 0.278 Test Loss: 9.068 Test Acc: 0.278
Validation loss decreased (-0.273595 --> -0.277476).  Saving model ...
Epoch: 17 cost time: 1.270554542541504
Epoch: 17, Steps: 17 | Train Loss: 5.055 Vali Loss: 10.438 Vali Acc: 0.240 Test Loss: 10.438 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.352283239364624
Epoch: 18, Steps: 17 | Train Loss: 5.841 Vali Loss: 12.207 Vali Acc: 0.243 Test Loss: 12.207 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2421777248382568
Epoch: 19, Steps: 17 | Train Loss: 7.580 Vali Loss: 15.677 Vali Acc: 0.255 Test Loss: 15.677 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2264246940612793
Epoch: 20, Steps: 17 | Train Loss: 7.298 Vali Loss: 13.223 Vali Acc: 0.285 Test Loss: 13.223 Test Acc: 0.285
Validation loss decreased (-0.277476 --> -0.285039).  Saving model ...
Epoch: 21 cost time: 1.365933895111084
Epoch: 21, Steps: 17 | Train Loss: 5.204 Vali Loss: 11.546 Vali Acc: 0.255 Test Loss: 11.546 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2931523323059082
Epoch: 22, Steps: 17 | Train Loss: 4.643 Vali Loss: 23.666 Vali Acc: 0.266 Test Loss: 23.666 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2260866165161133
Epoch: 23, Steps: 17 | Train Loss: 5.407 Vali Loss: 18.660 Vali Acc: 0.262 Test Loss: 18.660 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3029322624206543
Epoch: 24, Steps: 17 | Train Loss: 4.213 Vali Loss: 18.579 Vali Acc: 0.278 Test Loss: 18.579 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2444167137145996
Epoch: 25, Steps: 17 | Train Loss: 2.811 Vali Loss: 20.123 Vali Acc: 0.251 Test Loss: 20.123 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2257683277130127
Epoch: 26, Steps: 17 | Train Loss: 2.341 Vali Loss: 24.939 Vali Acc: 0.274 Test Loss: 24.939 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1417357921600342
Epoch: 27, Steps: 17 | Train Loss: 4.593 Vali Loss: 22.158 Vali Acc: 0.308 Test Loss: 22.158 Test Acc: 0.308
Validation loss decreased (-0.285039 --> -0.307763).  Saving model ...
Epoch: 28 cost time: 1.1942758560180664
Epoch: 28, Steps: 17 | Train Loss: 3.245 Vali Loss: 25.946 Vali Acc: 0.236 Test Loss: 25.946 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1861472129821777
Epoch: 29, Steps: 17 | Train Loss: 2.994 Vali Loss: 30.879 Vali Acc: 0.262 Test Loss: 30.879 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3898561000823975
Epoch: 30, Steps: 17 | Train Loss: 1.999 Vali Loss: 29.884 Vali Acc: 0.240 Test Loss: 29.884 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2860937118530273
Epoch: 31, Steps: 17 | Train Loss: 1.899 Vali Loss: 33.054 Vali Acc: 0.247 Test Loss: 33.054 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2481014728546143
Epoch: 32, Steps: 17 | Train Loss: 2.838 Vali Loss: 32.862 Vali Acc: 0.232 Test Loss: 32.862 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2438783645629883
Epoch: 33, Steps: 17 | Train Loss: 1.945 Vali Loss: 42.903 Vali Acc: 0.251 Test Loss: 42.903 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4350793361663818
Epoch: 34, Steps: 17 | Train Loss: 1.549 Vali Loss: 52.779 Vali Acc: 0.293 Test Loss: 52.779 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.257056713104248
Epoch: 35, Steps: 17 | Train Loss: 2.073 Vali Loss: 48.153 Vali Acc: 0.232 Test Loss: 48.153 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.3430941104888916
Epoch: 36, Steps: 17 | Train Loss: 1.162 Vali Loss: 48.561 Vali Acc: 0.236 Test Loss: 48.561 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2434959411621094
Epoch: 37, Steps: 17 | Train Loss: 1.683 Vali Loss: 53.053 Vali Acc: 0.274 Test Loss: 53.053 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 292608
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.493581771850586
Epoch: 1, Steps: 17 | Train Loss: 5.537 Vali Loss: 3.356 Vali Acc: 0.262 Test Loss: 3.356 Test Acc: 0.262
Validation loss decreased (inf --> -0.262324).  Saving model ...
Epoch: 2 cost time: 1.4037258625030518
Epoch: 2, Steps: 17 | Train Loss: 7.146 Vali Loss: 4.910 Vali Acc: 0.232 Test Loss: 4.910 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2749948501586914
Epoch: 3, Steps: 17 | Train Loss: 10.261 Vali Loss: 21.215 Vali Acc: 0.251 Test Loss: 21.215 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3690426349639893
Epoch: 4, Steps: 17 | Train Loss: 9.392 Vali Loss: 19.819 Vali Acc: 0.266 Test Loss: 19.819 Test Acc: 0.266
Validation loss decreased (-0.262324 --> -0.265962).  Saving model ...
Epoch: 5 cost time: 1.2655255794525146
Epoch: 5, Steps: 17 | Train Loss: 14.669 Vali Loss: 8.942 Vali Acc: 0.232 Test Loss: 8.942 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.385180950164795
Epoch: 6, Steps: 17 | Train Loss: 11.245 Vali Loss: 7.791 Vali Acc: 0.262 Test Loss: 7.791 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.920426607131958
Epoch: 7, Steps: 17 | Train Loss: 7.480 Vali Loss: 10.280 Vali Acc: 0.266 Test Loss: 10.280 Test Acc: 0.266
Validation loss decreased (-0.265962 --> -0.266057).  Saving model ...
Epoch: 8 cost time: 1.6166675090789795
Epoch: 8, Steps: 17 | Train Loss: 13.799 Vali Loss: 25.349 Vali Acc: 0.259 Test Loss: 25.349 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.339857578277588
Epoch: 9, Steps: 17 | Train Loss: 13.292 Vali Loss: 9.256 Vali Acc: 0.247 Test Loss: 9.256 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3586335182189941
Epoch: 10, Steps: 17 | Train Loss: 8.354 Vali Loss: 23.347 Vali Acc: 0.251 Test Loss: 23.347 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2422230243682861
Epoch: 11, Steps: 17 | Train Loss: 9.086 Vali Loss: 15.221 Vali Acc: 0.255 Test Loss: 15.221 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1927430629730225
Epoch: 12, Steps: 17 | Train Loss: 8.655 Vali Loss: 12.560 Vali Acc: 0.266 Test Loss: 12.560 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1639697551727295
Epoch: 13, Steps: 17 | Train Loss: 7.954 Vali Loss: 11.411 Vali Acc: 0.221 Test Loss: 11.411 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2427043914794922
Epoch: 14, Steps: 17 | Train Loss: 7.703 Vali Loss: 18.468 Vali Acc: 0.255 Test Loss: 18.468 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2807118892669678
Epoch: 15, Steps: 17 | Train Loss: 12.804 Vali Loss: 22.121 Vali Acc: 0.251 Test Loss: 22.121 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.381638765335083
Epoch: 16, Steps: 17 | Train Loss: 12.093 Vali Loss: 16.848 Vali Acc: 0.255 Test Loss: 16.848 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3569610118865967
Epoch: 17, Steps: 17 | Train Loss: 7.643 Vali Loss: 19.445 Vali Acc: 0.236 Test Loss: 19.445 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 259840
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.346025228500366
Epoch: 1, Steps: 17 | Train Loss: 5.166 Vali Loss: 6.062 Vali Acc: 0.247 Test Loss: 6.062 Test Acc: 0.247
Validation loss decreased (inf --> -0.247088).  Saving model ...
Epoch: 2 cost time: 1.129765510559082
Epoch: 2, Steps: 17 | Train Loss: 9.508 Vali Loss: 14.573 Vali Acc: 0.259 Test Loss: 14.573 Test Acc: 0.259
Validation loss decreased (-0.247088 --> -0.258409).  Saving model ...
Epoch: 3 cost time: 1.1562578678131104
Epoch: 3, Steps: 17 | Train Loss: 10.665 Vali Loss: 15.148 Vali Acc: 0.255 Test Loss: 15.148 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4584197998046875
Epoch: 4, Steps: 17 | Train Loss: 8.836 Vali Loss: 8.186 Vali Acc: 0.247 Test Loss: 8.186 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2649524211883545
Epoch: 5, Steps: 17 | Train Loss: 9.359 Vali Loss: 12.280 Vali Acc: 0.221 Test Loss: 12.280 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.352952241897583
Epoch: 6, Steps: 17 | Train Loss: 10.594 Vali Loss: 11.056 Vali Acc: 0.266 Test Loss: 11.056 Test Acc: 0.266
Validation loss decreased (-0.258409 --> -0.266049).  Saving model ...
Epoch: 7 cost time: 1.244781494140625
Epoch: 7, Steps: 17 | Train Loss: 8.885 Vali Loss: 19.526 Vali Acc: 0.243 Test Loss: 19.526 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2163004875183105
Epoch: 8, Steps: 17 | Train Loss: 13.995 Vali Loss: 16.971 Vali Acc: 0.270 Test Loss: 16.971 Test Acc: 0.270
Validation loss decreased (-0.266049 --> -0.269792).  Saving model ...
Epoch: 9 cost time: 1.2426435947418213
Epoch: 9, Steps: 17 | Train Loss: 7.903 Vali Loss: 10.882 Vali Acc: 0.247 Test Loss: 10.882 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3534786701202393
Epoch: 10, Steps: 17 | Train Loss: 8.411 Vali Loss: 10.267 Vali Acc: 0.270 Test Loss: 10.267 Test Acc: 0.270
Validation loss decreased (-0.269792 --> -0.269859).  Saving model ...
Epoch: 11 cost time: 1.3181426525115967
Epoch: 11, Steps: 17 | Train Loss: 10.898 Vali Loss: 10.740 Vali Acc: 0.270 Test Loss: 10.740 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3758997917175293
Epoch: 12, Steps: 17 | Train Loss: 10.112 Vali Loss: 8.297 Vali Acc: 0.270 Test Loss: 8.297 Test Acc: 0.270
Validation loss decreased (-0.269859 --> -0.269879).  Saving model ...
Epoch: 13 cost time: 1.3457560539245605
Epoch: 13, Steps: 17 | Train Loss: 11.664 Vali Loss: 21.078 Vali Acc: 0.240 Test Loss: 21.078 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.249157190322876
Epoch: 14, Steps: 17 | Train Loss: 8.215 Vali Loss: 14.173 Vali Acc: 0.270 Test Loss: 14.173 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.315657615661621
Epoch: 15, Steps: 17 | Train Loss: 10.616 Vali Loss: 29.740 Vali Acc: 0.247 Test Loss: 29.740 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3090527057647705
Epoch: 16, Steps: 17 | Train Loss: 10.755 Vali Loss: 19.118 Vali Acc: 0.259 Test Loss: 19.118 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3438587188720703
Epoch: 17, Steps: 17 | Train Loss: 11.805 Vali Loss: 21.381 Vali Acc: 0.251 Test Loss: 21.381 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3070898056030273
Epoch: 18, Steps: 17 | Train Loss: 8.695 Vali Loss: 17.681 Vali Acc: 0.243 Test Loss: 17.681 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2428572177886963
Epoch: 19, Steps: 17 | Train Loss: 5.977 Vali Loss: 13.256 Vali Acc: 0.251 Test Loss: 13.256 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0579884052276611
Epoch: 20, Steps: 17 | Train Loss: 4.739 Vali Loss: 17.196 Vali Acc: 0.274 Test Loss: 17.196 Test Acc: 0.274
Validation loss decreased (-0.269879 --> -0.273592).  Saving model ...
Epoch: 21 cost time: 1.2940573692321777
Epoch: 21, Steps: 17 | Train Loss: 3.882 Vali Loss: 21.823 Vali Acc: 0.270 Test Loss: 21.823 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3460414409637451
Epoch: 22, Steps: 17 | Train Loss: 9.976 Vali Loss: 21.309 Vali Acc: 0.281 Test Loss: 21.309 Test Acc: 0.281
Validation loss decreased (-0.273592 --> -0.281156).  Saving model ...
Epoch: 23 cost time: 1.3713598251342773
Epoch: 23, Steps: 17 | Train Loss: 4.885 Vali Loss: 15.780 Vali Acc: 0.297 Test Loss: 15.780 Test Acc: 0.297
Validation loss decreased (-0.281156 --> -0.296420).  Saving model ...
Epoch: 24 cost time: 1.1808347702026367
Epoch: 24, Steps: 17 | Train Loss: 3.879 Vali Loss: 19.627 Vali Acc: 0.278 Test Loss: 19.627 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2971720695495605
Epoch: 25, Steps: 17 | Train Loss: 4.574 Vali Loss: 20.792 Vali Acc: 0.274 Test Loss: 20.792 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3048179149627686
Epoch: 26, Steps: 17 | Train Loss: 3.950 Vali Loss: 36.097 Vali Acc: 0.270 Test Loss: 36.097 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2166471481323242
Epoch: 27, Steps: 17 | Train Loss: 7.379 Vali Loss: 19.571 Vali Acc: 0.247 Test Loss: 19.571 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3074421882629395
Epoch: 28, Steps: 17 | Train Loss: 4.012 Vali Loss: 31.682 Vali Acc: 0.270 Test Loss: 31.682 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1549527645111084
Epoch: 29, Steps: 17 | Train Loss: 4.256 Vali Loss: 30.259 Vali Acc: 0.251 Test Loss: 30.259 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2165987491607666
Epoch: 30, Steps: 17 | Train Loss: 2.870 Vali Loss: 26.367 Vali Acc: 0.259 Test Loss: 26.367 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3328578472137451
Epoch: 31, Steps: 17 | Train Loss: 2.775 Vali Loss: 35.515 Vali Acc: 0.213 Test Loss: 35.515 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3060295581817627
Epoch: 32, Steps: 17 | Train Loss: 2.040 Vali Loss: 34.490 Vali Acc: 0.262 Test Loss: 34.490 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.2804245948791504
Epoch: 33, Steps: 17 | Train Loss: 2.866 Vali Loss: 36.417 Vali Acc: 0.262 Test Loss: 36.417 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 259840
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.563547134399414
Epoch: 1, Steps: 17 | Train Loss: 5.778 Vali Loss: 4.346 Vali Acc: 0.236 Test Loss: 4.346 Test Acc: 0.236
Validation loss decreased (inf --> -0.235698).  Saving model ...
Epoch: 2 cost time: 1.2214207649230957
Epoch: 2, Steps: 17 | Train Loss: 8.323 Vali Loss: 5.352 Vali Acc: 0.285 Test Loss: 5.352 Test Acc: 0.285
Validation loss decreased (-0.235698 --> -0.285118).  Saving model ...
Epoch: 3 cost time: 1.1978540420532227
Epoch: 3, Steps: 17 | Train Loss: 9.429 Vali Loss: 16.265 Vali Acc: 0.266 Test Loss: 16.265 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3223426342010498
Epoch: 4, Steps: 17 | Train Loss: 10.963 Vali Loss: 14.053 Vali Acc: 0.255 Test Loss: 14.053 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3214459419250488
Epoch: 5, Steps: 17 | Train Loss: 11.813 Vali Loss: 12.749 Vali Acc: 0.251 Test Loss: 12.749 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2728726863861084
Epoch: 6, Steps: 17 | Train Loss: 13.321 Vali Loss: 16.236 Vali Acc: 0.236 Test Loss: 16.236 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2073590755462646
Epoch: 7, Steps: 17 | Train Loss: 9.807 Vali Loss: 13.768 Vali Acc: 0.251 Test Loss: 13.768 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1559147834777832
Epoch: 8, Steps: 17 | Train Loss: 12.231 Vali Loss: 17.410 Vali Acc: 0.255 Test Loss: 17.410 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2142517566680908
Epoch: 9, Steps: 17 | Train Loss: 16.610 Vali Loss: 13.862 Vali Acc: 0.274 Test Loss: 13.862 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0669200420379639
Epoch: 10, Steps: 17 | Train Loss: 12.555 Vali Loss: 19.756 Vali Acc: 0.240 Test Loss: 19.756 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.100454568862915
Epoch: 11, Steps: 17 | Train Loss: 17.749 Vali Loss: 23.210 Vali Acc: 0.247 Test Loss: 23.210 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1768207550048828
Epoch: 12, Steps: 17 | Train Loss: 17.645 Vali Loss: 13.887 Vali Acc: 0.259 Test Loss: 13.887 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 259840
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2558858394622803
Epoch: 1, Steps: 17 | Train Loss: 5.529 Vali Loss: 6.407 Vali Acc: 0.243 Test Loss: 6.407 Test Acc: 0.243
Validation loss decreased (inf --> -0.243282).  Saving model ...
Epoch: 2 cost time: 1.2461369037628174
Epoch: 2, Steps: 17 | Train Loss: 4.673 Vali Loss: 11.619 Vali Acc: 0.247 Test Loss: 11.619 Test Acc: 0.247
Validation loss decreased (-0.243282 --> -0.247032).  Saving model ...
Epoch: 3 cost time: 1.174933910369873
Epoch: 3, Steps: 17 | Train Loss: 8.246 Vali Loss: 9.126 Vali Acc: 0.247 Test Loss: 9.126 Test Acc: 0.247
Validation loss decreased (-0.247032 --> -0.247057).  Saving model ...
Epoch: 4 cost time: 1.3248963356018066
Epoch: 4, Steps: 17 | Train Loss: 9.078 Vali Loss: 10.515 Vali Acc: 0.255 Test Loss: 10.515 Test Acc: 0.255
Validation loss decreased (-0.247057 --> -0.254648).  Saving model ...
Epoch: 5 cost time: 1.3615996837615967
Epoch: 5, Steps: 17 | Train Loss: 6.785 Vali Loss: 7.002 Vali Acc: 0.289 Test Loss: 7.002 Test Acc: 0.289
Validation loss decreased (-0.254648 --> -0.288903).  Saving model ...
Epoch: 6 cost time: 1.1357090473175049
Epoch: 6, Steps: 17 | Train Loss: 8.707 Vali Loss: 10.098 Vali Acc: 0.243 Test Loss: 10.098 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1871416568756104
Epoch: 7, Steps: 17 | Train Loss: 8.998 Vali Loss: 16.690 Vali Acc: 0.255 Test Loss: 16.690 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2601728439331055
Epoch: 8, Steps: 17 | Train Loss: 13.329 Vali Loss: 32.256 Vali Acc: 0.255 Test Loss: 32.256 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2996854782104492
Epoch: 9, Steps: 17 | Train Loss: 16.685 Vali Loss: 14.733 Vali Acc: 0.251 Test Loss: 14.733 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1775851249694824
Epoch: 10, Steps: 17 | Train Loss: 9.724 Vali Loss: 10.012 Vali Acc: 0.247 Test Loss: 10.012 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1995046138763428
Epoch: 11, Steps: 17 | Train Loss: 8.770 Vali Loss: 5.645 Vali Acc: 0.293 Test Loss: 5.645 Test Acc: 0.293
Validation loss decreased (-0.288903 --> -0.292719).  Saving model ...
Epoch: 12 cost time: 1.3357281684875488
Epoch: 12, Steps: 17 | Train Loss: 10.275 Vali Loss: 10.004 Vali Acc: 0.266 Test Loss: 10.004 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.410351037979126
Epoch: 13, Steps: 17 | Train Loss: 6.765 Vali Loss: 8.484 Vali Acc: 0.266 Test Loss: 8.484 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.370222806930542
Epoch: 14, Steps: 17 | Train Loss: 6.286 Vali Loss: 12.759 Vali Acc: 0.262 Test Loss: 12.759 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3796496391296387
Epoch: 15, Steps: 17 | Train Loss: 8.070 Vali Loss: 7.201 Vali Acc: 0.262 Test Loss: 7.201 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2293612957000732
Epoch: 16, Steps: 17 | Train Loss: 9.389 Vali Loss: 28.512 Vali Acc: 0.251 Test Loss: 28.512 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2749197483062744
Epoch: 17, Steps: 17 | Train Loss: 9.390 Vali Loss: 12.656 Vali Acc: 0.259 Test Loss: 12.656 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2771100997924805
Epoch: 18, Steps: 17 | Train Loss: 7.740 Vali Loss: 14.710 Vali Acc: 0.255 Test Loss: 14.710 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1940009593963623
Epoch: 19, Steps: 17 | Train Loss: 6.792 Vali Loss: 16.877 Vali Acc: 0.259 Test Loss: 16.877 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3585214614868164
Epoch: 20, Steps: 17 | Train Loss: 6.696 Vali Loss: 20.954 Vali Acc: 0.270 Test Loss: 20.954 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3395497798919678
Epoch: 21, Steps: 17 | Train Loss: 5.685 Vali Loss: 20.796 Vali Acc: 0.278 Test Loss: 20.796 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 259840
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3713018894195557
Epoch: 1, Steps: 17 | Train Loss: 5.124 Vali Loss: 5.343 Vali Acc: 0.285 Test Loss: 5.343 Test Acc: 0.285
Validation loss decreased (inf --> -0.285118).  Saving model ...
Epoch: 2 cost time: 1.2963085174560547
Epoch: 2, Steps: 17 | Train Loss: 8.687 Vali Loss: 10.739 Vali Acc: 0.255 Test Loss: 10.739 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3088197708129883
Epoch: 3, Steps: 17 | Train Loss: 9.391 Vali Loss: 9.746 Vali Acc: 0.251 Test Loss: 9.746 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3228137493133545
Epoch: 4, Steps: 17 | Train Loss: 10.510 Vali Loss: 6.496 Vali Acc: 0.236 Test Loss: 6.496 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.324202537536621
Epoch: 5, Steps: 17 | Train Loss: 8.381 Vali Loss: 17.552 Vali Acc: 0.240 Test Loss: 17.552 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2858359813690186
Epoch: 6, Steps: 17 | Train Loss: 10.086 Vali Loss: 11.767 Vali Acc: 0.251 Test Loss: 11.767 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3513851165771484
Epoch: 7, Steps: 17 | Train Loss: 13.972 Vali Loss: 18.075 Vali Acc: 0.251 Test Loss: 18.075 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4774281978607178
Epoch: 8, Steps: 17 | Train Loss: 9.399 Vali Loss: 13.202 Vali Acc: 0.236 Test Loss: 13.202 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1090137958526611
Epoch: 9, Steps: 17 | Train Loss: 7.628 Vali Loss: 9.073 Vali Acc: 0.240 Test Loss: 9.073 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1740937232971191
Epoch: 10, Steps: 17 | Train Loss: 7.603 Vali Loss: 13.716 Vali Acc: 0.247 Test Loss: 13.716 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1624715328216553
Epoch: 11, Steps: 17 | Train Loss: 6.482 Vali Loss: 7.917 Vali Acc: 0.240 Test Loss: 7.917 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 243456
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.8511524200439453
Epoch: 1, Steps: 17 | Train Loss: 4.764 Vali Loss: 4.686 Vali Acc: 0.259 Test Loss: 4.686 Test Acc: 0.259
Validation loss decreased (inf --> -0.258508).  Saving model ...
Epoch: 2 cost time: 0.9500234127044678
Epoch: 2, Steps: 17 | Train Loss: 9.567 Vali Loss: 8.001 Vali Acc: 0.236 Test Loss: 8.001 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0860569477081299
Epoch: 3, Steps: 17 | Train Loss: 11.797 Vali Loss: 11.238 Vali Acc: 0.240 Test Loss: 11.238 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.140836238861084
Epoch: 4, Steps: 17 | Train Loss: 9.037 Vali Loss: 14.140 Vali Acc: 0.247 Test Loss: 14.140 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1076297760009766
Epoch: 5, Steps: 17 | Train Loss: 7.507 Vali Loss: 19.151 Vali Acc: 0.259 Test Loss: 19.151 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1014816761016846
Epoch: 6, Steps: 17 | Train Loss: 12.737 Vali Loss: 21.610 Vali Acc: 0.247 Test Loss: 21.610 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2464759349822998
Epoch: 7, Steps: 17 | Train Loss: 16.184 Vali Loss: 24.851 Vali Acc: 0.255 Test Loss: 24.851 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1882221698760986
Epoch: 8, Steps: 17 | Train Loss: 15.624 Vali Loss: 8.852 Vali Acc: 0.232 Test Loss: 8.852 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2337164878845215
Epoch: 9, Steps: 17 | Train Loss: 16.820 Vali Loss: 23.962 Vali Acc: 0.251 Test Loss: 23.962 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0370965003967285
Epoch: 10, Steps: 17 | Train Loss: 11.110 Vali Loss: 17.684 Vali Acc: 0.255 Test Loss: 17.684 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.133268117904663
Epoch: 11, Steps: 17 | Train Loss: 11.883 Vali Loss: 20.063 Vali Acc: 0.251 Test Loss: 20.063 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 243456
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.898258924484253
Epoch: 1, Steps: 17 | Train Loss: 4.628 Vali Loss: 3.867 Vali Acc: 0.236 Test Loss: 3.867 Test Acc: 0.236
Validation loss decreased (inf --> -0.235703).  Saving model ...
Epoch: 2 cost time: 1.16074538230896
Epoch: 2, Steps: 17 | Train Loss: 7.635 Vali Loss: 21.403 Vali Acc: 0.251 Test Loss: 21.403 Test Acc: 0.251
Validation loss decreased (-0.235703 --> -0.250737).  Saving model ...
Epoch: 3 cost time: 1.0516862869262695
Epoch: 3, Steps: 17 | Train Loss: 11.956 Vali Loss: 12.010 Vali Acc: 0.270 Test Loss: 12.010 Test Acc: 0.270
Validation loss decreased (-0.250737 --> -0.269842).  Saving model ...
Epoch: 4 cost time: 1.0636134147644043
Epoch: 4, Steps: 17 | Train Loss: 10.452 Vali Loss: 12.374 Vali Acc: 0.262 Test Loss: 12.374 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1687705516815186
Epoch: 5, Steps: 17 | Train Loss: 6.706 Vali Loss: 10.807 Vali Acc: 0.243 Test Loss: 10.807 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1554672718048096
Epoch: 6, Steps: 17 | Train Loss: 7.907 Vali Loss: 10.138 Vali Acc: 0.247 Test Loss: 10.138 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1076292991638184
Epoch: 7, Steps: 17 | Train Loss: 9.300 Vali Loss: 12.568 Vali Acc: 0.293 Test Loss: 12.568 Test Acc: 0.293
Validation loss decreased (-0.269842 --> -0.292650).  Saving model ...
Epoch: 8 cost time: 1.0999212265014648
Epoch: 8, Steps: 17 | Train Loss: 10.303 Vali Loss: 20.772 Vali Acc: 0.255 Test Loss: 20.772 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.348423719406128
Epoch: 9, Steps: 17 | Train Loss: 13.773 Vali Loss: 14.174 Vali Acc: 0.247 Test Loss: 14.174 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0684802532196045
Epoch: 10, Steps: 17 | Train Loss: 9.082 Vali Loss: 10.069 Vali Acc: 0.236 Test Loss: 10.069 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1834471225738525
Epoch: 11, Steps: 17 | Train Loss: 5.367 Vali Loss: 10.416 Vali Acc: 0.285 Test Loss: 10.416 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1823267936706543
Epoch: 12, Steps: 17 | Train Loss: 10.538 Vali Loss: 8.623 Vali Acc: 0.251 Test Loss: 8.623 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.076936960220337
Epoch: 13, Steps: 17 | Train Loss: 8.752 Vali Loss: 19.514 Vali Acc: 0.255 Test Loss: 19.514 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.139054298400879
Epoch: 14, Steps: 17 | Train Loss: 15.477 Vali Loss: 26.922 Vali Acc: 0.262 Test Loss: 26.922 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1384084224700928
Epoch: 15, Steps: 17 | Train Loss: 7.095 Vali Loss: 8.747 Vali Acc: 0.259 Test Loss: 8.747 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.205045461654663
Epoch: 16, Steps: 17 | Train Loss: 6.188 Vali Loss: 14.987 Vali Acc: 0.247 Test Loss: 14.987 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1897106170654297
Epoch: 17, Steps: 17 | Train Loss: 6.158 Vali Loss: 10.445 Vali Acc: 0.213 Test Loss: 10.445 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 243456
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.041372776031494
Epoch: 1, Steps: 17 | Train Loss: 5.049 Vali Loss: 2.439 Vali Acc: 0.221 Test Loss: 2.439 Test Acc: 0.221
Validation loss decreased (inf --> -0.220508).  Saving model ...
Epoch: 2 cost time: 1.1775579452514648
Epoch: 2, Steps: 17 | Train Loss: 6.599 Vali Loss: 8.054 Vali Acc: 0.255 Test Loss: 8.054 Test Acc: 0.255
Validation loss decreased (-0.220508 --> -0.254672).  Saving model ...
Epoch: 3 cost time: 1.0470855236053467
Epoch: 3, Steps: 17 | Train Loss: 9.212 Vali Loss: 7.697 Vali Acc: 0.251 Test Loss: 7.697 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.098217487335205
Epoch: 4, Steps: 17 | Train Loss: 10.589 Vali Loss: 7.255 Vali Acc: 0.278 Test Loss: 7.255 Test Acc: 0.278
Validation loss decreased (-0.254672 --> -0.277494).  Saving model ...
Epoch: 5 cost time: 1.1451663970947266
Epoch: 5, Steps: 17 | Train Loss: 7.453 Vali Loss: 7.451 Vali Acc: 0.259 Test Loss: 7.451 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2043845653533936
Epoch: 6, Steps: 17 | Train Loss: 8.862 Vali Loss: 19.873 Vali Acc: 0.251 Test Loss: 19.873 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9044866561889648
Epoch: 7, Steps: 17 | Train Loss: 7.723 Vali Loss: 11.435 Vali Acc: 0.266 Test Loss: 11.435 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1625826358795166
Epoch: 8, Steps: 17 | Train Loss: 9.638 Vali Loss: 7.511 Vali Acc: 0.285 Test Loss: 7.511 Test Acc: 0.285
Validation loss decreased (-0.277494 --> -0.285096).  Saving model ...
Epoch: 9 cost time: 1.1703641414642334
Epoch: 9, Steps: 17 | Train Loss: 10.307 Vali Loss: 5.787 Vali Acc: 0.240 Test Loss: 5.787 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.195885419845581
Epoch: 10, Steps: 17 | Train Loss: 7.021 Vali Loss: 7.193 Vali Acc: 0.247 Test Loss: 7.193 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1435468196868896
Epoch: 11, Steps: 17 | Train Loss: 10.351 Vali Loss: 7.477 Vali Acc: 0.224 Test Loss: 7.477 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2521202564239502
Epoch: 12, Steps: 17 | Train Loss: 11.298 Vali Loss: 16.969 Vali Acc: 0.251 Test Loss: 16.969 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.094022274017334
Epoch: 13, Steps: 17 | Train Loss: 9.853 Vali Loss: 22.277 Vali Acc: 0.240 Test Loss: 22.277 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2126154899597168
Epoch: 14, Steps: 17 | Train Loss: 15.428 Vali Loss: 16.146 Vali Acc: 0.259 Test Loss: 16.146 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2223615646362305
Epoch: 15, Steps: 17 | Train Loss: 8.692 Vali Loss: 9.373 Vali Acc: 0.259 Test Loss: 9.373 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.110234260559082
Epoch: 16, Steps: 17 | Train Loss: 11.122 Vali Loss: 15.986 Vali Acc: 0.270 Test Loss: 15.986 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2000532150268555
Epoch: 17, Steps: 17 | Train Loss: 10.722 Vali Loss: 10.307 Vali Acc: 0.281 Test Loss: 10.307 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.257383108139038
Epoch: 18, Steps: 17 | Train Loss: 5.251 Vali Loss: 17.657 Vali Acc: 0.240 Test Loss: 17.657 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 243456
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.495607376098633
Epoch: 1, Steps: 17 | Train Loss: 6.822 Vali Loss: 11.626 Vali Acc: 0.247 Test Loss: 11.626 Test Acc: 0.247
Validation loss decreased (inf --> -0.247032).  Saving model ...
Epoch: 2 cost time: 1.2495131492614746
Epoch: 2, Steps: 17 | Train Loss: 8.317 Vali Loss: 5.722 Vali Acc: 0.236 Test Loss: 5.722 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.329378366470337
Epoch: 3, Steps: 17 | Train Loss: 7.409 Vali Loss: 23.192 Vali Acc: 0.251 Test Loss: 23.192 Test Acc: 0.251
Validation loss decreased (-0.247032 --> -0.250719).  Saving model ...
Epoch: 4 cost time: 1.3819618225097656
Epoch: 4, Steps: 17 | Train Loss: 13.399 Vali Loss: 11.237 Vali Acc: 0.255 Test Loss: 11.237 Test Acc: 0.255
Validation loss decreased (-0.250719 --> -0.254640).  Saving model ...
Epoch: 5 cost time: 1.401221513748169
Epoch: 5, Steps: 17 | Train Loss: 9.307 Vali Loss: 15.061 Vali Acc: 0.251 Test Loss: 15.061 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.414090633392334
Epoch: 6, Steps: 17 | Train Loss: 11.049 Vali Loss: 20.256 Vali Acc: 0.259 Test Loss: 20.256 Test Acc: 0.259
Validation loss decreased (-0.254640 --> -0.258353).  Saving model ...
Epoch: 7 cost time: 1.4202320575714111
Epoch: 7, Steps: 17 | Train Loss: 18.050 Vali Loss: 20.377 Vali Acc: 0.255 Test Loss: 20.377 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.536092758178711
Epoch: 8, Steps: 17 | Train Loss: 20.164 Vali Loss: 21.077 Vali Acc: 0.240 Test Loss: 21.077 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4786338806152344
Epoch: 9, Steps: 17 | Train Loss: 12.906 Vali Loss: 14.830 Vali Acc: 0.232 Test Loss: 14.830 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3675141334533691
Epoch: 10, Steps: 17 | Train Loss: 11.280 Vali Loss: 26.008 Vali Acc: 0.236 Test Loss: 26.008 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2794742584228516
Epoch: 11, Steps: 17 | Train Loss: 11.043 Vali Loss: 23.011 Vali Acc: 0.259 Test Loss: 23.011 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.307814598083496
Epoch: 12, Steps: 17 | Train Loss: 8.921 Vali Loss: 18.429 Vali Acc: 0.247 Test Loss: 18.429 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2529213428497314
Epoch: 13, Steps: 17 | Train Loss: 15.355 Vali Loss: 38.199 Vali Acc: 0.251 Test Loss: 38.199 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.323531150817871
Epoch: 14, Steps: 17 | Train Loss: 13.249 Vali Loss: 11.186 Vali Acc: 0.240 Test Loss: 11.186 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4594461917877197
Epoch: 15, Steps: 17 | Train Loss: 14.219 Vali Loss: 19.478 Vali Acc: 0.270 Test Loss: 19.478 Test Acc: 0.270
Validation loss decreased (-0.258353 --> -0.269767).  Saving model ...
Epoch: 16 cost time: 1.5634582042694092
Epoch: 16, Steps: 17 | Train Loss: 10.750 Vali Loss: 17.581 Vali Acc: 0.262 Test Loss: 17.581 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6962544918060303
Epoch: 17, Steps: 17 | Train Loss: 6.984 Vali Loss: 20.141 Vali Acc: 0.266 Test Loss: 20.141 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.551025390625
Epoch: 18, Steps: 17 | Train Loss: 10.818 Vali Loss: 14.427 Vali Acc: 0.232 Test Loss: 14.427 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5686440467834473
Epoch: 19, Steps: 17 | Train Loss: 5.630 Vali Loss: 12.601 Vali Acc: 0.251 Test Loss: 12.601 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4642813205718994
Epoch: 20, Steps: 17 | Train Loss: 4.534 Vali Loss: 25.291 Vali Acc: 0.259 Test Loss: 25.291 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3928656578063965
Epoch: 21, Steps: 17 | Train Loss: 9.564 Vali Loss: 22.788 Vali Acc: 0.278 Test Loss: 22.788 Test Acc: 0.278
Validation loss decreased (-0.269767 --> -0.277339).  Saving model ...
Epoch: 22 cost time: 1.4015812873840332
Epoch: 22, Steps: 17 | Train Loss: 5.064 Vali Loss: 16.474 Vali Acc: 0.232 Test Loss: 16.474 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4377787113189697
Epoch: 23, Steps: 17 | Train Loss: 5.337 Vali Loss: 15.937 Vali Acc: 0.274 Test Loss: 15.937 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3959035873413086
Epoch: 24, Steps: 17 | Train Loss: 3.910 Vali Loss: 14.091 Vali Acc: 0.247 Test Loss: 14.091 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5182549953460693
Epoch: 25, Steps: 17 | Train Loss: 3.247 Vali Loss: 22.040 Vali Acc: 0.266 Test Loss: 22.040 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4670720100402832
Epoch: 26, Steps: 17 | Train Loss: 2.958 Vali Loss: 22.419 Vali Acc: 0.266 Test Loss: 22.419 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4741594791412354
Epoch: 27, Steps: 17 | Train Loss: 2.750 Vali Loss: 22.184 Vali Acc: 0.251 Test Loss: 22.184 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2500452995300293
Epoch: 28, Steps: 17 | Train Loss: 2.655 Vali Loss: 21.424 Vali Acc: 0.255 Test Loss: 21.424 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.363471508026123
Epoch: 29, Steps: 17 | Train Loss: 3.192 Vali Loss: 22.397 Vali Acc: 0.281 Test Loss: 22.397 Test Acc: 0.281
Validation loss decreased (-0.277339 --> -0.281145).  Saving model ...
Epoch: 30 cost time: 1.2728862762451172
Epoch: 30, Steps: 17 | Train Loss: 2.221 Vali Loss: 33.933 Vali Acc: 0.243 Test Loss: 33.933 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2742087841033936
Epoch: 31, Steps: 17 | Train Loss: 4.369 Vali Loss: 30.693 Vali Acc: 0.255 Test Loss: 30.693 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2812178134918213
Epoch: 32, Steps: 17 | Train Loss: 1.495 Vali Loss: 34.082 Vali Acc: 0.270 Test Loss: 34.082 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3370084762573242
Epoch: 33, Steps: 17 | Train Loss: 3.063 Vali Loss: 39.261 Vali Acc: 0.300 Test Loss: 39.261 Test Acc: 0.300
Validation loss decreased (-0.281145 --> -0.299988).  Saving model ...
Epoch: 34 cost time: 1.4007527828216553
Epoch: 34, Steps: 17 | Train Loss: 2.152 Vali Loss: 39.849 Vali Acc: 0.289 Test Loss: 39.849 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4141392707824707
Epoch: 35, Steps: 17 | Train Loss: 3.215 Vali Loss: 38.044 Vali Acc: 0.316 Test Loss: 38.044 Test Acc: 0.316
Validation loss decreased (-0.299988 --> -0.315209).  Saving model ...
Epoch: 36 cost time: 1.3264131546020508
Epoch: 36, Steps: 17 | Train Loss: 2.286 Vali Loss: 47.850 Vali Acc: 0.262 Test Loss: 47.850 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5540685653686523
Epoch: 37, Steps: 17 | Train Loss: 3.499 Vali Loss: 46.725 Vali Acc: 0.270 Test Loss: 46.725 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.308548927307129
Epoch: 38, Steps: 17 | Train Loss: 2.302 Vali Loss: 51.186 Vali Acc: 0.255 Test Loss: 51.186 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.4125330448150635
Epoch: 39, Steps: 17 | Train Loss: 2.750 Vali Loss: 54.009 Vali Acc: 0.270 Test Loss: 54.009 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.420943260192871
Epoch: 40, Steps: 17 | Train Loss: 1.676 Vali Loss: 59.088 Vali Acc: 0.255 Test Loss: 59.088 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.3860254287719727
Epoch: 41, Steps: 17 | Train Loss: 1.651 Vali Loss: 65.421 Vali Acc: 0.285 Test Loss: 65.421 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.40069580078125
Epoch: 42, Steps: 17 | Train Loss: 2.065 Vali Loss: 65.370 Vali Acc: 0.300 Test Loss: 65.370 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.3736214637756348
Epoch: 43, Steps: 17 | Train Loss: 1.996 Vali Loss: 70.913 Vali Acc: 0.270 Test Loss: 70.913 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.4257481098175049
Epoch: 44, Steps: 17 | Train Loss: 2.011 Vali Loss: 73.998 Vali Acc: 0.293 Test Loss: 73.998 Test Acc: 0.293
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2863571643829346
Epoch: 45, Steps: 17 | Train Loss: 1.889 Vali Loss: 82.525 Vali Acc: 0.259 Test Loss: 82.525 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 235264
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.251884698867798
Epoch: 1, Steps: 17 | Train Loss: 6.720 Vali Loss: 7.206 Vali Acc: 0.213 Test Loss: 7.206 Test Acc: 0.213
Validation loss decreased (inf --> -0.212856).  Saving model ...
Epoch: 2 cost time: 1.3930368423461914
Epoch: 2, Steps: 17 | Train Loss: 6.815 Vali Loss: 7.247 Vali Acc: 0.262 Test Loss: 7.247 Test Acc: 0.262
Validation loss decreased (-0.212856 --> -0.262285).  Saving model ...
Epoch: 3 cost time: 1.2797486782073975
Epoch: 3, Steps: 17 | Train Loss: 7.480 Vali Loss: 4.507 Vali Acc: 0.247 Test Loss: 4.507 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.29642915725708
Epoch: 4, Steps: 17 | Train Loss: 7.319 Vali Loss: 6.796 Vali Acc: 0.259 Test Loss: 6.796 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2694857120513916
Epoch: 5, Steps: 17 | Train Loss: 10.608 Vali Loss: 12.846 Vali Acc: 0.236 Test Loss: 12.846 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2557761669158936
Epoch: 6, Steps: 17 | Train Loss: 10.223 Vali Loss: 11.507 Vali Acc: 0.266 Test Loss: 11.507 Test Acc: 0.266
Validation loss decreased (-0.262285 --> -0.266045).  Saving model ...
Epoch: 7 cost time: 1.2313103675842285
Epoch: 7, Steps: 17 | Train Loss: 10.969 Vali Loss: 14.990 Vali Acc: 0.236 Test Loss: 14.990 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1713385581970215
Epoch: 8, Steps: 17 | Train Loss: 7.387 Vali Loss: 8.356 Vali Acc: 0.255 Test Loss: 8.356 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2515418529510498
Epoch: 9, Steps: 17 | Train Loss: 9.434 Vali Loss: 9.494 Vali Acc: 0.262 Test Loss: 9.494 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2447810173034668
Epoch: 10, Steps: 17 | Train Loss: 12.038 Vali Loss: 23.992 Vali Acc: 0.243 Test Loss: 23.992 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2696373462677002
Epoch: 11, Steps: 17 | Train Loss: 11.143 Vali Loss: 13.082 Vali Acc: 0.278 Test Loss: 13.082 Test Acc: 0.278
Validation loss decreased (-0.266045 --> -0.277436).  Saving model ...
Epoch: 12 cost time: 1.2551047801971436
Epoch: 12, Steps: 17 | Train Loss: 11.787 Vali Loss: 11.621 Vali Acc: 0.255 Test Loss: 11.621 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2575089931488037
Epoch: 13, Steps: 17 | Train Loss: 13.129 Vali Loss: 9.626 Vali Acc: 0.243 Test Loss: 9.626 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2700788974761963
Epoch: 14, Steps: 17 | Train Loss: 8.842 Vali Loss: 12.171 Vali Acc: 0.251 Test Loss: 12.171 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.249955415725708
Epoch: 15, Steps: 17 | Train Loss: 7.799 Vali Loss: 20.013 Vali Acc: 0.228 Test Loss: 20.013 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3957743644714355
Epoch: 16, Steps: 17 | Train Loss: 7.699 Vali Loss: 10.437 Vali Acc: 0.236 Test Loss: 10.437 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2429556846618652
Epoch: 17, Steps: 17 | Train Loss: 8.881 Vali Loss: 17.923 Vali Acc: 0.251 Test Loss: 17.923 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2061796188354492
Epoch: 18, Steps: 17 | Train Loss: 8.211 Vali Loss: 13.358 Vali Acc: 0.240 Test Loss: 13.358 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.226529598236084
Epoch: 19, Steps: 17 | Train Loss: 4.207 Vali Loss: 17.723 Vali Acc: 0.266 Test Loss: 17.723 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2718417644500732
Epoch: 20, Steps: 17 | Train Loss: 7.881 Vali Loss: 25.644 Vali Acc: 0.262 Test Loss: 25.644 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3163914680480957
Epoch: 21, Steps: 17 | Train Loss: 7.938 Vali Loss: 19.377 Vali Acc: 0.255 Test Loss: 19.377 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 235264
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.144394874572754
Epoch: 1, Steps: 17 | Train Loss: 6.463 Vali Loss: 9.576 Vali Acc: 0.221 Test Loss: 9.576 Test Acc: 0.221
Validation loss decreased (inf --> -0.220437).  Saving model ...
Epoch: 2 cost time: 1.2200047969818115
Epoch: 2, Steps: 17 | Train Loss: 8.391 Vali Loss: 6.070 Vali Acc: 0.243 Test Loss: 6.070 Test Acc: 0.243
Validation loss decreased (-0.220437 --> -0.243285).  Saving model ...
Epoch: 3 cost time: 1.0344526767730713
Epoch: 3, Steps: 17 | Train Loss: 6.802 Vali Loss: 9.707 Vali Acc: 0.247 Test Loss: 9.707 Test Acc: 0.247
Validation loss decreased (-0.243285 --> -0.247051).  Saving model ...
Epoch: 4 cost time: 1.1929800510406494
Epoch: 4, Steps: 17 | Train Loss: 10.563 Vali Loss: 16.703 Vali Acc: 0.266 Test Loss: 16.703 Test Acc: 0.266
Validation loss decreased (-0.247051 --> -0.265993).  Saving model ...
Epoch: 5 cost time: 1.361708641052246
Epoch: 5, Steps: 17 | Train Loss: 14.686 Vali Loss: 8.351 Vali Acc: 0.266 Test Loss: 8.351 Test Acc: 0.266
Validation loss decreased (-0.265993 --> -0.266076).  Saving model ...
Epoch: 6 cost time: 1.177825927734375
Epoch: 6, Steps: 17 | Train Loss: 7.077 Vali Loss: 16.519 Vali Acc: 0.240 Test Loss: 16.519 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2418849468231201
Epoch: 7, Steps: 17 | Train Loss: 14.301 Vali Loss: 18.885 Vali Acc: 0.243 Test Loss: 18.885 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2445330619812012
Epoch: 8, Steps: 17 | Train Loss: 13.514 Vali Loss: 13.547 Vali Acc: 0.262 Test Loss: 13.547 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.194338321685791
Epoch: 9, Steps: 17 | Train Loss: 10.819 Vali Loss: 12.976 Vali Acc: 0.259 Test Loss: 12.976 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2745018005371094
Epoch: 10, Steps: 17 | Train Loss: 11.696 Vali Loss: 12.472 Vali Acc: 0.266 Test Loss: 12.472 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.309253215789795
Epoch: 11, Steps: 17 | Train Loss: 12.835 Vali Loss: 16.007 Vali Acc: 0.259 Test Loss: 16.007 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3152656555175781
Epoch: 12, Steps: 17 | Train Loss: 11.478 Vali Loss: 12.126 Vali Acc: 0.251 Test Loss: 12.126 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6400837898254395
Epoch: 13, Steps: 17 | Train Loss: 10.193 Vali Loss: 14.465 Vali Acc: 0.240 Test Loss: 14.465 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2830495834350586
Epoch: 14, Steps: 17 | Train Loss: 7.426 Vali Loss: 18.061 Vali Acc: 0.255 Test Loss: 18.061 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3015737533569336
Epoch: 15, Steps: 17 | Train Loss: 10.027 Vali Loss: 14.997 Vali Acc: 0.255 Test Loss: 14.997 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 235264
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.386383533477783
Epoch: 1, Steps: 17 | Train Loss: 5.990 Vali Loss: 9.458 Vali Acc: 0.236 Test Loss: 9.458 Test Acc: 0.236
Validation loss decreased (inf --> -0.235647).  Saving model ...
Epoch: 2 cost time: 1.381915807723999
Epoch: 2, Steps: 17 | Train Loss: 9.397 Vali Loss: 17.273 Vali Acc: 0.247 Test Loss: 17.273 Test Acc: 0.247
Validation loss decreased (-0.235647 --> -0.246976).  Saving model ...
Epoch: 3 cost time: 1.301884412765503
Epoch: 3, Steps: 17 | Train Loss: 12.064 Vali Loss: 4.627 Vali Acc: 0.266 Test Loss: 4.627 Test Acc: 0.266
Validation loss decreased (-0.246976 --> -0.266113).  Saving model ...
Epoch: 4 cost time: 1.2214832305908203
Epoch: 4, Steps: 17 | Train Loss: 10.652 Vali Loss: 10.396 Vali Acc: 0.266 Test Loss: 10.396 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2010679244995117
Epoch: 5, Steps: 17 | Train Loss: 7.999 Vali Loss: 8.878 Vali Acc: 0.251 Test Loss: 8.878 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0844178199768066
Epoch: 6, Steps: 17 | Train Loss: 6.824 Vali Loss: 8.389 Vali Acc: 0.217 Test Loss: 8.389 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3142611980438232
Epoch: 7, Steps: 17 | Train Loss: 9.501 Vali Loss: 8.230 Vali Acc: 0.251 Test Loss: 8.230 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4162752628326416
Epoch: 8, Steps: 17 | Train Loss: 9.109 Vali Loss: 10.605 Vali Acc: 0.278 Test Loss: 10.605 Test Acc: 0.278
Validation loss decreased (-0.266113 --> -0.277460).  Saving model ...
Epoch: 9 cost time: 1.2590336799621582
Epoch: 9, Steps: 17 | Train Loss: 11.556 Vali Loss: 12.209 Vali Acc: 0.266 Test Loss: 12.209 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.243591070175171
Epoch: 10, Steps: 17 | Train Loss: 10.420 Vali Loss: 11.572 Vali Acc: 0.262 Test Loss: 11.572 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.273503303527832
Epoch: 11, Steps: 17 | Train Loss: 11.896 Vali Loss: 8.328 Vali Acc: 0.243 Test Loss: 8.328 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3170397281646729
Epoch: 12, Steps: 17 | Train Loss: 7.655 Vali Loss: 11.675 Vali Acc: 0.259 Test Loss: 11.675 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2562472820281982
Epoch: 13, Steps: 17 | Train Loss: 6.756 Vali Loss: 11.918 Vali Acc: 0.251 Test Loss: 11.918 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.275942325592041
Epoch: 14, Steps: 17 | Train Loss: 5.775 Vali Loss: 10.043 Vali Acc: 0.281 Test Loss: 10.043 Test Acc: 0.281
Validation loss decreased (-0.277460 --> -0.281268).  Saving model ...
Epoch: 15 cost time: 1.3156661987304688
Epoch: 15, Steps: 17 | Train Loss: 7.228 Vali Loss: 16.738 Vali Acc: 0.251 Test Loss: 16.738 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.277099847793579
Epoch: 16, Steps: 17 | Train Loss: 9.828 Vali Loss: 28.564 Vali Acc: 0.255 Test Loss: 28.564 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2548837661743164
Epoch: 17, Steps: 17 | Train Loss: 9.159 Vali Loss: 10.346 Vali Acc: 0.266 Test Loss: 10.346 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2526636123657227
Epoch: 18, Steps: 17 | Train Loss: 5.476 Vali Loss: 7.971 Vali Acc: 0.262 Test Loss: 7.971 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2727785110473633
Epoch: 19, Steps: 17 | Train Loss: 5.513 Vali Loss: 19.518 Vali Acc: 0.266 Test Loss: 19.518 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3174564838409424
Epoch: 20, Steps: 17 | Train Loss: 6.557 Vali Loss: 13.882 Vali Acc: 0.278 Test Loss: 13.882 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.324019432067871
Epoch: 21, Steps: 17 | Train Loss: 3.569 Vali Loss: 11.693 Vali Acc: 0.240 Test Loss: 11.693 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2845382690429688
Epoch: 22, Steps: 17 | Train Loss: 4.953 Vali Loss: 16.433 Vali Acc: 0.270 Test Loss: 16.433 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.315058708190918
Epoch: 23, Steps: 17 | Train Loss: 3.857 Vali Loss: 17.971 Vali Acc: 0.281 Test Loss: 17.971 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3700315952301025
Epoch: 24, Steps: 17 | Train Loss: 2.966 Vali Loss: 22.412 Vali Acc: 0.247 Test Loss: 22.412 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 235264
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.1090447902679443
Epoch: 1, Steps: 17 | Train Loss: 6.308 Vali Loss: 8.543 Vali Acc: 0.247 Test Loss: 8.543 Test Acc: 0.247
Validation loss decreased (inf --> -0.247063).  Saving model ...
Epoch: 2 cost time: 1.2204301357269287
Epoch: 2, Steps: 17 | Train Loss: 7.767 Vali Loss: 7.563 Vali Acc: 0.259 Test Loss: 7.563 Test Acc: 0.259
Validation loss decreased (-0.247063 --> -0.258479).  Saving model ...
Epoch: 3 cost time: 1.115638256072998
Epoch: 3, Steps: 17 | Train Loss: 10.018 Vali Loss: 22.020 Vali Acc: 0.262 Test Loss: 22.020 Test Acc: 0.262
Validation loss decreased (-0.258479 --> -0.262137).  Saving model ...
Epoch: 4 cost time: 1.2477474212646484
Epoch: 4, Steps: 17 | Train Loss: 12.968 Vali Loss: 13.111 Vali Acc: 0.251 Test Loss: 13.111 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3371052742004395
Epoch: 5, Steps: 17 | Train Loss: 8.411 Vali Loss: 6.629 Vali Acc: 0.236 Test Loss: 6.629 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.237227201461792
Epoch: 6, Steps: 17 | Train Loss: 10.015 Vali Loss: 16.796 Vali Acc: 0.243 Test Loss: 16.796 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4836289882659912
Epoch: 7, Steps: 17 | Train Loss: 14.852 Vali Loss: 13.599 Vali Acc: 0.281 Test Loss: 13.599 Test Acc: 0.281
Validation loss decreased (-0.262137 --> -0.281233).  Saving model ...
Epoch: 8 cost time: 1.308811902999878
Epoch: 8, Steps: 17 | Train Loss: 9.102 Vali Loss: 10.232 Vali Acc: 0.221 Test Loss: 10.232 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2322852611541748
Epoch: 9, Steps: 17 | Train Loss: 7.496 Vali Loss: 12.646 Vali Acc: 0.251 Test Loss: 12.646 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2439675331115723
Epoch: 10, Steps: 17 | Train Loss: 9.062 Vali Loss: 18.318 Vali Acc: 0.262 Test Loss: 18.318 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3036043643951416
Epoch: 11, Steps: 17 | Train Loss: 9.618 Vali Loss: 20.581 Vali Acc: 0.255 Test Loss: 20.581 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1614749431610107
Epoch: 12, Steps: 17 | Train Loss: 8.328 Vali Loss: 11.567 Vali Acc: 0.228 Test Loss: 11.567 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1787362098693848
Epoch: 13, Steps: 17 | Train Loss: 9.493 Vali Loss: 12.366 Vali Acc: 0.274 Test Loss: 12.366 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.187185525894165
Epoch: 14, Steps: 17 | Train Loss: 8.233 Vali Loss: 15.751 Vali Acc: 0.262 Test Loss: 15.751 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2628443241119385
Epoch: 15, Steps: 17 | Train Loss: 14.163 Vali Loss: 19.972 Vali Acc: 0.243 Test Loss: 19.972 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1218061447143555
Epoch: 16, Steps: 17 | Train Loss: 16.129 Vali Loss: 14.319 Vali Acc: 0.259 Test Loss: 14.319 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2856202125549316
Epoch: 17, Steps: 17 | Train Loss: 7.121 Vali Loss: 9.551 Vali Acc: 0.243 Test Loss: 9.551 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 231168
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.175050735473633
Epoch: 1, Steps: 17 | Train Loss: 6.216 Vali Loss: 11.043 Vali Acc: 0.251 Test Loss: 11.043 Test Acc: 0.251
Validation loss decreased (inf --> -0.250840).  Saving model ...
Epoch: 2 cost time: 1.2006187438964844
Epoch: 2, Steps: 17 | Train Loss: 6.690 Vali Loss: 7.602 Vali Acc: 0.259 Test Loss: 7.602 Test Acc: 0.259
Validation loss decreased (-0.250840 --> -0.258479).  Saving model ...
Epoch: 3 cost time: 1.1014342308044434
Epoch: 3, Steps: 17 | Train Loss: 7.737 Vali Loss: 5.372 Vali Acc: 0.266 Test Loss: 5.372 Test Acc: 0.266
Validation loss decreased (-0.258479 --> -0.266106).  Saving model ...
Epoch: 4 cost time: 1.0829811096191406
Epoch: 4, Steps: 17 | Train Loss: 7.897 Vali Loss: 6.899 Vali Acc: 0.259 Test Loss: 6.899 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.160393238067627
Epoch: 5, Steps: 17 | Train Loss: 7.383 Vali Loss: 7.226 Vali Acc: 0.243 Test Loss: 7.226 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2326245307922363
Epoch: 6, Steps: 17 | Train Loss: 10.395 Vali Loss: 21.503 Vali Acc: 0.259 Test Loss: 21.503 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1781537532806396
Epoch: 7, Steps: 17 | Train Loss: 15.484 Vali Loss: 12.224 Vali Acc: 0.243 Test Loss: 12.224 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.170149564743042
Epoch: 8, Steps: 17 | Train Loss: 10.591 Vali Loss: 22.982 Vali Acc: 0.251 Test Loss: 22.982 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2047033309936523
Epoch: 9, Steps: 17 | Train Loss: 12.381 Vali Loss: 11.302 Vali Acc: 0.221 Test Loss: 11.302 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.077338695526123
Epoch: 10, Steps: 17 | Train Loss: 7.761 Vali Loss: 13.970 Vali Acc: 0.281 Test Loss: 13.970 Test Acc: 0.281
Validation loss decreased (-0.266106 --> -0.281229).  Saving model ...
Epoch: 11 cost time: 1.0627167224884033
Epoch: 11, Steps: 17 | Train Loss: 8.555 Vali Loss: 22.116 Vali Acc: 0.247 Test Loss: 22.116 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1374263763427734
Epoch: 12, Steps: 17 | Train Loss: 7.980 Vali Loss: 9.433 Vali Acc: 0.251 Test Loss: 9.433 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1702380180358887
Epoch: 13, Steps: 17 | Train Loss: 9.433 Vali Loss: 13.698 Vali Acc: 0.251 Test Loss: 13.698 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.147829294204712
Epoch: 14, Steps: 17 | Train Loss: 16.123 Vali Loss: 25.802 Vali Acc: 0.274 Test Loss: 25.802 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.315208911895752
Epoch: 15, Steps: 17 | Train Loss: 16.248 Vali Loss: 11.564 Vali Acc: 0.255 Test Loss: 11.564 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1490399837493896
Epoch: 16, Steps: 17 | Train Loss: 8.496 Vali Loss: 17.330 Vali Acc: 0.247 Test Loss: 17.330 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.240814208984375
Epoch: 17, Steps: 17 | Train Loss: 9.260 Vali Loss: 19.230 Vali Acc: 0.259 Test Loss: 19.230 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2913336753845215
Epoch: 18, Steps: 17 | Train Loss: 7.488 Vali Loss: 14.546 Vali Acc: 0.281 Test Loss: 14.546 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3339426517486572
Epoch: 19, Steps: 17 | Train Loss: 7.163 Vali Loss: 32.506 Vali Acc: 0.243 Test Loss: 32.506 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2347135543823242
Epoch: 20, Steps: 17 | Train Loss: 9.782 Vali Loss: 22.050 Vali Acc: 0.259 Test Loss: 22.050 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 231168
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2771108150482178
Epoch: 1, Steps: 17 | Train Loss: 6.691 Vali Loss: 7.786 Vali Acc: 0.236 Test Loss: 7.786 Test Acc: 0.236
Validation loss decreased (inf --> -0.235664).  Saving model ...
Epoch: 2 cost time: 1.2200450897216797
Epoch: 2, Steps: 17 | Train Loss: 6.837 Vali Loss: 7.124 Vali Acc: 0.251 Test Loss: 7.124 Test Acc: 0.251
Validation loss decreased (-0.235664 --> -0.250879).  Saving model ...
Epoch: 3 cost time: 1.3023431301116943
Epoch: 3, Steps: 17 | Train Loss: 7.500 Vali Loss: 5.925 Vali Acc: 0.270 Test Loss: 5.925 Test Acc: 0.270
Validation loss decreased (-0.250879 --> -0.269903).  Saving model ...
Epoch: 4 cost time: 1.18099045753479
Epoch: 4, Steps: 17 | Train Loss: 8.880 Vali Loss: 15.753 Vali Acc: 0.259 Test Loss: 15.753 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1412594318389893
Epoch: 5, Steps: 17 | Train Loss: 12.620 Vali Loss: 17.314 Vali Acc: 0.251 Test Loss: 17.314 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.125875473022461
Epoch: 6, Steps: 17 | Train Loss: 13.311 Vali Loss: 10.222 Vali Acc: 0.259 Test Loss: 10.222 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1161048412322998
Epoch: 7, Steps: 17 | Train Loss: 11.145 Vali Loss: 14.087 Vali Acc: 0.281 Test Loss: 14.087 Test Acc: 0.281
Validation loss decreased (-0.269903 --> -0.281228).  Saving model ...
Epoch: 8 cost time: 1.0708467960357666
Epoch: 8, Steps: 17 | Train Loss: 9.879 Vali Loss: 9.468 Vali Acc: 0.262 Test Loss: 9.468 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1866071224212646
Epoch: 9, Steps: 17 | Train Loss: 10.206 Vali Loss: 16.815 Vali Acc: 0.262 Test Loss: 16.815 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1773426532745361
Epoch: 10, Steps: 17 | Train Loss: 7.888 Vali Loss: 12.984 Vali Acc: 0.266 Test Loss: 12.984 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2502238750457764
Epoch: 11, Steps: 17 | Train Loss: 8.225 Vali Loss: 12.613 Vali Acc: 0.243 Test Loss: 12.613 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2168920040130615
Epoch: 12, Steps: 17 | Train Loss: 7.878 Vali Loss: 13.850 Vali Acc: 0.247 Test Loss: 13.850 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3572051525115967
Epoch: 13, Steps: 17 | Train Loss: 14.229 Vali Loss: 18.398 Vali Acc: 0.266 Test Loss: 18.398 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.190337896347046
Epoch: 14, Steps: 17 | Train Loss: 12.695 Vali Loss: 21.530 Vali Acc: 0.259 Test Loss: 21.530 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2023472785949707
Epoch: 15, Steps: 17 | Train Loss: 5.682 Vali Loss: 10.279 Vali Acc: 0.270 Test Loss: 10.279 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1671440601348877
Epoch: 16, Steps: 17 | Train Loss: 8.302 Vali Loss: 16.109 Vali Acc: 0.262 Test Loss: 16.109 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.287574291229248
Epoch: 17, Steps: 17 | Train Loss: 8.306 Vali Loss: 9.965 Vali Acc: 0.221 Test Loss: 9.965 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 231168
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.188356399536133
Epoch: 1, Steps: 17 | Train Loss: 6.222 Vali Loss: 3.205 Vali Acc: 0.247 Test Loss: 3.205 Test Acc: 0.247
Validation loss decreased (inf --> -0.247116).  Saving model ...
Epoch: 2 cost time: 1.3012526035308838
Epoch: 2, Steps: 17 | Train Loss: 5.118 Vali Loss: 7.979 Vali Acc: 0.259 Test Loss: 7.979 Test Acc: 0.259
Validation loss decreased (-0.247116 --> -0.258475).  Saving model ...
Epoch: 3 cost time: 1.223062515258789
Epoch: 3, Steps: 17 | Train Loss: 5.900 Vali Loss: 9.441 Vali Acc: 0.255 Test Loss: 9.441 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.212282657623291
Epoch: 4, Steps: 17 | Train Loss: 9.497 Vali Loss: 7.401 Vali Acc: 0.255 Test Loss: 7.401 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3280189037322998
Epoch: 5, Steps: 17 | Train Loss: 7.094 Vali Loss: 8.671 Vali Acc: 0.259 Test Loss: 8.671 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2287425994873047
Epoch: 6, Steps: 17 | Train Loss: 9.583 Vali Loss: 9.339 Vali Acc: 0.270 Test Loss: 9.339 Test Acc: 0.270
Validation loss decreased (-0.258475 --> -0.269869).  Saving model ...
Epoch: 7 cost time: 1.2298073768615723
Epoch: 7, Steps: 17 | Train Loss: 11.441 Vali Loss: 4.744 Vali Acc: 0.259 Test Loss: 4.744 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.265824794769287
Epoch: 8, Steps: 17 | Train Loss: 8.702 Vali Loss: 16.339 Vali Acc: 0.259 Test Loss: 16.339 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1508958339691162
Epoch: 9, Steps: 17 | Train Loss: 11.620 Vali Loss: 6.737 Vali Acc: 0.266 Test Loss: 6.737 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2978248596191406
Epoch: 10, Steps: 17 | Train Loss: 8.036 Vali Loss: 10.484 Vali Acc: 0.247 Test Loss: 10.484 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2640407085418701
Epoch: 11, Steps: 17 | Train Loss: 13.126 Vali Loss: 7.371 Vali Acc: 0.270 Test Loss: 7.371 Test Acc: 0.270
Validation loss decreased (-0.269869 --> -0.269888).  Saving model ...
Epoch: 12 cost time: 1.1947999000549316
Epoch: 12, Steps: 17 | Train Loss: 9.083 Vali Loss: 11.216 Vali Acc: 0.259 Test Loss: 11.216 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2525296211242676
Epoch: 13, Steps: 17 | Train Loss: 12.175 Vali Loss: 7.969 Vali Acc: 0.281 Test Loss: 7.969 Test Acc: 0.281
Validation loss decreased (-0.269888 --> -0.281289).  Saving model ...
Epoch: 14 cost time: 1.261000394821167
Epoch: 14, Steps: 17 | Train Loss: 11.441 Vali Loss: 17.569 Vali Acc: 0.266 Test Loss: 17.569 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.185868501663208
Epoch: 15, Steps: 17 | Train Loss: 11.939 Vali Loss: 21.208 Vali Acc: 0.259 Test Loss: 21.208 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2568423748016357
Epoch: 16, Steps: 17 | Train Loss: 9.335 Vali Loss: 18.256 Vali Acc: 0.270 Test Loss: 18.256 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.315514087677002
Epoch: 17, Steps: 17 | Train Loss: 7.990 Vali Loss: 18.235 Vali Acc: 0.293 Test Loss: 18.235 Test Acc: 0.293
Validation loss decreased (-0.281289 --> -0.292593).  Saving model ...
Epoch: 18 cost time: 1.1982765197753906
Epoch: 18, Steps: 17 | Train Loss: 6.023 Vali Loss: 14.766 Vali Acc: 0.262 Test Loss: 14.766 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1503958702087402
Epoch: 19, Steps: 17 | Train Loss: 4.368 Vali Loss: 12.269 Vali Acc: 0.240 Test Loss: 12.269 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3343889713287354
Epoch: 20, Steps: 17 | Train Loss: 5.335 Vali Loss: 13.782 Vali Acc: 0.243 Test Loss: 13.782 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1789321899414062
Epoch: 21, Steps: 17 | Train Loss: 3.481 Vali Loss: 10.583 Vali Acc: 0.247 Test Loss: 10.583 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.094703197479248
Epoch: 22, Steps: 17 | Train Loss: 3.284 Vali Loss: 17.747 Vali Acc: 0.228 Test Loss: 17.747 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.229837417602539
Epoch: 23, Steps: 17 | Train Loss: 3.742 Vali Loss: 28.417 Vali Acc: 0.274 Test Loss: 28.417 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3938252925872803
Epoch: 24, Steps: 17 | Train Loss: 4.633 Vali Loss: 22.065 Vali Acc: 0.270 Test Loss: 22.065 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2076492309570312
Epoch: 25, Steps: 17 | Train Loss: 2.162 Vali Loss: 18.144 Vali Acc: 0.255 Test Loss: 18.144 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1844584941864014
Epoch: 26, Steps: 17 | Train Loss: 2.328 Vali Loss: 24.853 Vali Acc: 0.228 Test Loss: 24.853 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.19846773147583
Epoch: 27, Steps: 17 | Train Loss: 3.254 Vali Loss: 29.944 Vali Acc: 0.285 Test Loss: 29.944 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ETSformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 231168
model size : 1.50MB
