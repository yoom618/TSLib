Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.493849039077759
Epoch: 1, Steps: 18 | Train Loss: 2.065 Vali Loss: 0.300 Vali Acc: 0.920 Test Loss: 0.300 Test Acc: 0.920
Validation loss decreased (inf --> -0.919997).  Saving model ...
Epoch: 2 cost time: 2.715458631515503
Epoch: 2, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.239 Vali Acc: 0.943 Test Loss: 0.239 Test Acc: 0.943
Validation loss decreased (-0.919997 --> -0.943331).  Saving model ...
Epoch: 3 cost time: 2.6745667457580566
Epoch: 3, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.206 Vali Acc: 0.953 Test Loss: 0.206 Test Acc: 0.953
Validation loss decreased (-0.943331 --> -0.953331).  Saving model ...
Epoch: 4 cost time: 2.6907365322113037
Epoch: 4, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.208 Vali Acc: 0.953 Test Loss: 0.208 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.606860399246216
Epoch: 5, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7937278747558594
Epoch: 6, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.495 Vali Acc: 0.907 Test Loss: 0.495 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.163681745529175
Epoch: 7, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.211 Vali Acc: 0.953 Test Loss: 0.211 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2841994762420654
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.451 Vali Acc: 0.933 Test Loss: 0.451 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.6428542137145996
Epoch: 9, Steps: 18 | Train Loss: 0.194 Vali Loss: 0.440 Vali Acc: 0.923 Test Loss: 0.440 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.788757562637329
Epoch: 10, Steps: 18 | Train Loss: 0.146 Vali Loss: 0.652 Vali Acc: 0.907 Test Loss: 0.652 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5191609859466553
Epoch: 11, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.753 Vali Acc: 0.923 Test Loss: 0.753 Test Acc: 0.923
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.5900158882141113
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.469 Vali Acc: 0.943 Test Loss: 0.469 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.739936590194702
Epoch: 13, Steps: 18 | Train Loss: 0.210 Vali Loss: 1.075 Vali Acc: 0.873 Test Loss: 1.075 Test Acc: 0.873
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9533333333333334
model parameter : 7128705
model size : 36.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.424459934234619
Epoch: 1, Steps: 18 | Train Loss: 2.051 Vali Loss: 0.301 Vali Acc: 0.913 Test Loss: 0.301 Test Acc: 0.913
Validation loss decreased (inf --> -0.913330).  Saving model ...
Epoch: 2 cost time: 2.6042134761810303
Epoch: 2, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.189 Vali Acc: 0.957 Test Loss: 0.189 Test Acc: 0.957
Validation loss decreased (-0.913330 --> -0.956665).  Saving model ...
Epoch: 3 cost time: 2.085472345352173
Epoch: 3, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.175 Vali Acc: 0.960 Test Loss: 0.175 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959998).  Saving model ...
Epoch: 4 cost time: 2.345120668411255
Epoch: 4, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0017731189727783
Epoch: 5, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7445695400238037
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.252 Vali Acc: 0.953 Test Loss: 0.252 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.585831880569458
Epoch: 7, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.299 Vali Acc: 0.947 Test Loss: 0.299 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.421067237854004
Epoch: 8, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.697399377822876
Epoch: 9, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.381 Vali Acc: 0.937 Test Loss: 0.381 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1880688667297363
Epoch: 10, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.583 Vali Acc: 0.927 Test Loss: 0.583 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.197700023651123
Epoch: 11, Steps: 18 | Train Loss: 0.095 Vali Loss: 1.003 Vali Acc: 0.893 Test Loss: 1.003 Test Acc: 0.893
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4671857357025146
Epoch: 12, Steps: 18 | Train Loss: 0.312 Vali Loss: 0.575 Vali Acc: 0.943 Test Loss: 0.575 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.7742512226104736
Epoch: 13, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.611 Vali Acc: 0.927 Test Loss: 0.611 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.96
model parameter : 7128705
model size : 36.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.659708738327026
Epoch: 1, Steps: 18 | Train Loss: 2.051 Vali Loss: 0.288 Vali Acc: 0.913 Test Loss: 0.288 Test Acc: 0.913
Validation loss decreased (inf --> -0.913330).  Saving model ...
Epoch: 2 cost time: 2.3136813640594482
Epoch: 2, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
Validation loss decreased (-0.913330 --> -0.956665).  Saving model ...
Epoch: 3 cost time: 2.358035087585449
Epoch: 3, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 2.3959667682647705
Epoch: 4, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
Validation loss decreased (-0.956665 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 2.438004493713379
Epoch: 5, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2771542072296143
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.376 Vali Acc: 0.920 Test Loss: 0.376 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1641786098480225
Epoch: 7, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1756131649017334
Epoch: 8, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5263311862945557
Epoch: 9, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.334 Vali Acc: 0.933 Test Loss: 0.334 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.554851531982422
Epoch: 10, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.721 Vali Acc: 0.903 Test Loss: 0.721 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.3126306533813477
Epoch: 11, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.854 Vali Acc: 0.897 Test Loss: 0.854 Test Acc: 0.897
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.358032464981079
Epoch: 12, Steps: 18 | Train Loss: 0.213 Vali Loss: 0.472 Vali Acc: 0.943 Test Loss: 0.472 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.519862413406372
Epoch: 13, Steps: 18 | Train Loss: 0.173 Vali Loss: 0.780 Vali Acc: 0.907 Test Loss: 0.780 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.5038089752197266
Epoch: 14, Steps: 18 | Train Loss: 0.151 Vali Loss: 0.670 Vali Acc: 0.937 Test Loss: 0.670 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 7128705
model size : 36.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.608464479446411
Epoch: 1, Steps: 18 | Train Loss: 2.070 Vali Loss: 0.322 Vali Acc: 0.907 Test Loss: 0.322 Test Acc: 0.907
Validation loss decreased (inf --> -0.906663).  Saving model ...
Epoch: 2 cost time: 2.106940746307373
Epoch: 2, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
Validation loss decreased (-0.906663 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 2.174820899963379
Epoch: 3, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.334972858428955
Epoch: 4, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.184 Vali Acc: 0.960 Test Loss: 0.184 Test Acc: 0.960
Validation loss decreased (-0.949998 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 2.219290018081665
Epoch: 5, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 2.327378749847412
Epoch: 6, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.207 Vali Acc: 0.967 Test Loss: 0.207 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 2.229987621307373
Epoch: 7, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.219 Vali Acc: 0.953 Test Loss: 0.219 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4358036518096924
Epoch: 8, Steps: 18 | Train Loss: 0.158 Vali Loss: 0.642 Vali Acc: 0.897 Test Loss: 0.642 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3018622398376465
Epoch: 9, Steps: 18 | Train Loss: 0.206 Vali Loss: 0.642 Vali Acc: 0.900 Test Loss: 0.642 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2099051475524902
Epoch: 10, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.313 Vali Acc: 0.953 Test Loss: 0.313 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.216809034347534
Epoch: 11, Steps: 18 | Train Loss: 0.228 Vali Loss: 0.448 Vali Acc: 0.933 Test Loss: 0.448 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.5191526412963867
Epoch: 12, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.436 Vali Acc: 0.947 Test Loss: 0.436 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.190519332885742
Epoch: 13, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.495 Vali Acc: 0.940 Test Loss: 0.495 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.001136541366577
Epoch: 14, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.410 Vali Acc: 0.957 Test Loss: 0.410 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2768304347991943
Epoch: 15, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.535 Vali Acc: 0.950 Test Loss: 0.535 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.722926378250122
Epoch: 16, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.755 Vali Acc: 0.910 Test Loss: 0.755 Test Acc: 0.910
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 7128705
model size : 36.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.479156970977783
Epoch: 1, Steps: 18 | Train Loss: 2.179 Vali Loss: 0.422 Vali Acc: 0.870 Test Loss: 0.422 Test Acc: 0.870
Validation loss decreased (inf --> -0.869996).  Saving model ...
Epoch: 2 cost time: 2.2918829917907715
Epoch: 2, Steps: 18 | Train Loss: 0.110 Vali Loss: 0.200 Vali Acc: 0.940 Test Loss: 0.200 Test Acc: 0.940
Validation loss decreased (-0.869996 --> -0.939998).  Saving model ...
Epoch: 3 cost time: 2.4518439769744873
Epoch: 3, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
Validation loss decreased (-0.939998 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 2.554651975631714
Epoch: 4, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 2.6432712078094482
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3754403591156006
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.145158529281616
Epoch: 7, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.245 Vali Acc: 0.957 Test Loss: 0.245 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1733481884002686
Epoch: 8, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.277 Vali Acc: 0.943 Test Loss: 0.277 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4416143894195557
Epoch: 9, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.407 Vali Acc: 0.943 Test Loss: 0.407 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.583925485610962
Epoch: 10, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.789 Vali Acc: 0.887 Test Loss: 0.789 Test Acc: 0.887
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.447042226791382
Epoch: 11, Steps: 18 | Train Loss: 0.203 Vali Loss: 0.543 Vali Acc: 0.900 Test Loss: 0.543 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.237077236175537
Epoch: 12, Steps: 18 | Train Loss: 0.177 Vali Loss: 0.969 Vali Acc: 0.883 Test Loss: 0.969 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1635918617248535
Epoch: 13, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.704 Vali Acc: 0.930 Test Loss: 0.704 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8619890213012695
Epoch: 14, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.171 Vali Acc: 0.883 Test Loss: 1.171 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 5031553
model size : 28.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.118346214294434
Epoch: 1, Steps: 18 | Train Loss: 2.168 Vali Loss: 0.434 Vali Acc: 0.873 Test Loss: 0.434 Test Acc: 0.873
Validation loss decreased (inf --> -0.873329).  Saving model ...
Epoch: 2 cost time: 2.045833110809326
Epoch: 2, Steps: 18 | Train Loss: 0.111 Vali Loss: 0.180 Vali Acc: 0.947 Test Loss: 0.180 Test Acc: 0.947
Validation loss decreased (-0.873329 --> -0.946665).  Saving model ...
Epoch: 3 cost time: 2.047025442123413
Epoch: 3, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.171 Vali Acc: 0.977 Test Loss: 0.171 Test Acc: 0.977
Validation loss decreased (-0.946665 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 2.4109809398651123
Epoch: 4, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.574425458908081
Epoch: 5, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.327 Vali Acc: 0.940 Test Loss: 0.327 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.161320447921753
Epoch: 6, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.229 Vali Acc: 0.953 Test Loss: 0.229 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3723795413970947
Epoch: 7, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.324 Vali Acc: 0.937 Test Loss: 0.324 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.734569787979126
Epoch: 8, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.870 Vali Acc: 0.890 Test Loss: 0.870 Test Acc: 0.890
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.6212453842163086
Epoch: 9, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.320 Vali Acc: 0.957 Test Loss: 0.320 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.301969051361084
Epoch: 10, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.368 Vali Acc: 0.953 Test Loss: 0.368 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.282299518585205
Epoch: 11, Steps: 18 | Train Loss: 0.110 Vali Loss: 0.721 Vali Acc: 0.937 Test Loss: 0.721 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.8685851097106934
Epoch: 12, Steps: 18 | Train Loss: 0.111 Vali Loss: 0.533 Vali Acc: 0.953 Test Loss: 0.533 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8579983711242676
Epoch: 13, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.616 Vali Acc: 0.930 Test Loss: 0.616 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 5031553
model size : 28.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.500879287719727
Epoch: 1, Steps: 18 | Train Loss: 2.135 Vali Loss: 0.422 Vali Acc: 0.883 Test Loss: 0.422 Test Acc: 0.883
Validation loss decreased (inf --> -0.883329).  Saving model ...
Epoch: 2 cost time: 2.243317127227783
Epoch: 2, Steps: 18 | Train Loss: 0.111 Vali Loss: 0.166 Vali Acc: 0.953 Test Loss: 0.166 Test Acc: 0.953
Validation loss decreased (-0.883329 --> -0.953332).  Saving model ...
Epoch: 3 cost time: 2.202414035797119
Epoch: 3, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.185 Vali Acc: 0.963 Test Loss: 0.185 Test Acc: 0.963
Validation loss decreased (-0.953332 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 2.251915693283081
Epoch: 4, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7630012035369873
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.501 Vali Acc: 0.923 Test Loss: 0.501 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6451756954193115
Epoch: 6, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.438 Vali Acc: 0.933 Test Loss: 0.438 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4485723972320557
Epoch: 7, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.479 Vali Acc: 0.913 Test Loss: 0.479 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5590691566467285
Epoch: 8, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.645 Vali Acc: 0.900 Test Loss: 0.645 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8250389099121094
Epoch: 9, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.746 Vali Acc: 0.900 Test Loss: 0.746 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6256015300750732
Epoch: 10, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.555 Vali Acc: 0.933 Test Loss: 0.555 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6011404991149902
Epoch: 11, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.427 Vali Acc: 0.943 Test Loss: 0.427 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6637156009674072
Epoch: 12, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.377 Vali Acc: 0.960 Test Loss: 0.377 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.0659613609313965
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.698 Vali Acc: 0.927 Test Loss: 0.698 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 5031553
model size : 28.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6704752445220947
Epoch: 1, Steps: 18 | Train Loss: 2.127 Vali Loss: 0.418 Vali Acc: 0.873 Test Loss: 0.418 Test Acc: 0.873
Validation loss decreased (inf --> -0.873329).  Saving model ...
Epoch: 2 cost time: 2.182295083999634
Epoch: 2, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
Validation loss decreased (-0.873329 --> -0.956665).  Saving model ...
Epoch: 3 cost time: 1.982569932937622
Epoch: 3, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.211 Vali Acc: 0.967 Test Loss: 0.211 Test Acc: 0.967
Validation loss decreased (-0.956665 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 2.050018787384033
Epoch: 4, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7879226207733154
Epoch: 5, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.227 Vali Acc: 0.957 Test Loss: 0.227 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0939319133758545
Epoch: 6, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.952972412109375
Epoch: 7, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.192 Vali Acc: 0.947 Test Loss: 0.192 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.714242935180664
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.828 Vali Acc: 0.880 Test Loss: 0.828 Test Acc: 0.880
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.1465916633605957
Epoch: 9, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.481 Vali Acc: 0.940 Test Loss: 0.481 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.293701648712158
Epoch: 10, Steps: 18 | Train Loss: 0.154 Vali Loss: 1.107 Vali Acc: 0.913 Test Loss: 1.107 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.249063014984131
Epoch: 11, Steps: 18 | Train Loss: 0.054 Vali Loss: 1.024 Vali Acc: 0.907 Test Loss: 1.024 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.136432409286499
Epoch: 12, Steps: 18 | Train Loss: 0.187 Vali Loss: 1.260 Vali Acc: 0.887 Test Loss: 1.260 Test Acc: 0.887
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8084120750427246
Epoch: 13, Steps: 18 | Train Loss: 0.134 Vali Loss: 1.013 Vali Acc: 0.913 Test Loss: 1.013 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 5031553
model size : 28.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.885267496109009
Epoch: 1, Steps: 18 | Train Loss: 2.028 Vali Loss: 0.276 Vali Acc: 0.937 Test Loss: 0.276 Test Acc: 0.937
Validation loss decreased (inf --> -0.936664).  Saving model ...
Epoch: 2 cost time: 2.080029010772705
Epoch: 2, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
Validation loss decreased (-0.936664 --> -0.963332).  Saving model ...
Epoch: 3 cost time: 2.4125545024871826
Epoch: 3, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.963332 --> -0.983332).  Saving model ...
Epoch: 4 cost time: 2.2599053382873535
Epoch: 4, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9395489692687988
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9907135963439941
Epoch: 6, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4164931774139404
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.227 Vali Acc: 0.970 Test Loss: 0.227 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4120445251464844
Epoch: 8, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.427 Vali Acc: 0.923 Test Loss: 0.427 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.5725138187408447
Epoch: 9, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.421 Vali Acc: 0.923 Test Loss: 0.421 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.414496898651123
Epoch: 10, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.443 Vali Acc: 0.940 Test Loss: 0.443 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.643622875213623
Epoch: 11, Steps: 18 | Train Loss: 0.110 Vali Loss: 0.573 Vali Acc: 0.937 Test Loss: 0.573 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.730956792831421
Epoch: 12, Steps: 18 | Train Loss: 0.135 Vali Loss: 0.466 Vali Acc: 0.943 Test Loss: 0.466 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.45405650138855
Epoch: 13, Steps: 18 | Train Loss: 0.197 Vali Loss: 0.791 Vali Acc: 0.890 Test Loss: 0.791 Test Acc: 0.890
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 3982977
model size : 24.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.12239146232605
Epoch: 1, Steps: 18 | Train Loss: 2.016 Vali Loss: 0.272 Vali Acc: 0.943 Test Loss: 0.272 Test Acc: 0.943
Validation loss decreased (inf --> -0.943331).  Saving model ...
Epoch: 2 cost time: 2.2112786769866943
Epoch: 2, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
Validation loss decreased (-0.943331 --> -0.959999).  Saving model ...
Epoch: 3 cost time: 2.3211581707000732
Epoch: 3, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.959999 --> -0.983332).  Saving model ...
Epoch: 4 cost time: 2.4023971557617188
Epoch: 4, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.201 Vali Acc: 0.960 Test Loss: 0.201 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.210211753845215
Epoch: 5, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.943 Test Loss: 0.205 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.934924602508545
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.963 Test Loss: 0.185 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0270438194274902
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.395 Vali Acc: 0.937 Test Loss: 0.395 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2933075428009033
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.398 Vali Acc: 0.943 Test Loss: 0.398 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.209038496017456
Epoch: 9, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.501 Vali Acc: 0.933 Test Loss: 0.501 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1273980140686035
Epoch: 10, Steps: 18 | Train Loss: 0.138 Vali Loss: 0.810 Vali Acc: 0.903 Test Loss: 0.810 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.192413330078125
Epoch: 11, Steps: 18 | Train Loss: 0.207 Vali Loss: 0.466 Vali Acc: 0.927 Test Loss: 0.466 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.099576234817505
Epoch: 12, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.864 Vali Acc: 0.910 Test Loss: 0.864 Test Acc: 0.910
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9537560939788818
Epoch: 13, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.920 Vali Acc: 0.933 Test Loss: 0.920 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 3982977
model size : 24.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.019368886947632
Epoch: 1, Steps: 18 | Train Loss: 2.012 Vali Loss: 0.270 Vali Acc: 0.947 Test Loss: 0.270 Test Acc: 0.947
Validation loss decreased (inf --> -0.946664).  Saving model ...
Epoch: 2 cost time: 2.2077364921569824
Epoch: 2, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
Validation loss decreased (-0.946664 --> -0.959999).  Saving model ...
Epoch: 3 cost time: 2.235912322998047
Epoch: 3, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.959999 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 2.258920669555664
Epoch: 4, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.471 Vali Acc: 0.927 Test Loss: 0.471 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7513842582702637
Epoch: 5, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.213 Vali Acc: 0.967 Test Loss: 0.213 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5267572402954102
Epoch: 6, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.229 Vali Acc: 0.957 Test Loss: 0.229 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5248665809631348
Epoch: 7, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.260 Vali Acc: 0.957 Test Loss: 0.260 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8899450302124023
Epoch: 8, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.232 Vali Acc: 0.967 Test Loss: 0.232 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2153329849243164
Epoch: 9, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.279 Vali Acc: 0.967 Test Loss: 0.279 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3358232975006104
Epoch: 10, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.434 Vali Acc: 0.957 Test Loss: 0.434 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.125082015991211
Epoch: 11, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.953 Vali Acc: 0.880 Test Loss: 0.953 Test Acc: 0.880
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3186964988708496
Epoch: 12, Steps: 18 | Train Loss: 0.087 Vali Loss: 1.396 Vali Acc: 0.857 Test Loss: 1.396 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6796648502349854
Epoch: 13, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.547 Vali Acc: 0.940 Test Loss: 0.547 Test Acc: 0.940
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 3982977
model size : 24.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.0129547119140625
Epoch: 1, Steps: 18 | Train Loss: 2.059 Vali Loss: 0.293 Vali Acc: 0.927 Test Loss: 0.293 Test Acc: 0.927
Validation loss decreased (inf --> -0.926664).  Saving model ...
Epoch: 2 cost time: 2.0378172397613525
Epoch: 2, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.926664 --> -0.966665).  Saving model ...
Epoch: 3 cost time: 2.0130929946899414
Epoch: 3, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9389586448669434
Epoch: 4, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.221 Vali Acc: 0.953 Test Loss: 0.221 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3477284908294678
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.209 Vali Acc: 0.963 Test Loss: 0.209 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4754912853240967
Epoch: 6, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1500983238220215
Epoch: 7, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.505 Vali Acc: 0.910 Test Loss: 0.505 Test Acc: 0.910
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.028865098953247
Epoch: 8, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.602 Vali Acc: 0.897 Test Loss: 0.602 Test Acc: 0.897
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.1472389698028564
Epoch: 9, Steps: 18 | Train Loss: 0.221 Vali Loss: 0.689 Vali Acc: 0.883 Test Loss: 0.689 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1608824729919434
Epoch: 10, Steps: 18 | Train Loss: 0.181 Vali Loss: 1.027 Vali Acc: 0.863 Test Loss: 1.027 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7977890968322754
Epoch: 11, Steps: 18 | Train Loss: 0.137 Vali Loss: 1.003 Vali Acc: 0.910 Test Loss: 1.003 Test Acc: 0.910
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.744842290878296
Epoch: 12, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.480 Vali Acc: 0.940 Test Loss: 0.480 Test Acc: 0.940
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 3982977
model size : 24.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.9608523845672607
Epoch: 1, Steps: 18 | Train Loss: 2.006 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
Validation loss decreased (inf --> -0.903330).  Saving model ...
Epoch: 2 cost time: 2.172184467315674
Epoch: 2, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
Validation loss decreased (-0.903330 --> -0.953332).  Saving model ...
Epoch: 3 cost time: 2.3297314643859863
Epoch: 3, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.209 Vali Acc: 0.963 Test Loss: 0.209 Test Acc: 0.963
Validation loss decreased (-0.953332 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 1.8983256816864014
Epoch: 4, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.298 Vali Acc: 0.947 Test Loss: 0.298 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9488353729248047
Epoch: 5, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.237 Vali Acc: 0.953 Test Loss: 0.237 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9810998439788818
Epoch: 6, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.569 Vali Acc: 0.903 Test Loss: 0.569 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.298344612121582
Epoch: 7, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.549 Vali Acc: 0.920 Test Loss: 0.549 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.189141035079956
Epoch: 8, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.422 Vali Acc: 0.937 Test Loss: 0.422 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.115429639816284
Epoch: 9, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.650 Vali Acc: 0.900 Test Loss: 0.650 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1460180282592773
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.849 Vali Acc: 0.897 Test Loss: 0.849 Test Acc: 0.897
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.34122371673584
Epoch: 11, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.504 Vali Acc: 0.943 Test Loss: 0.504 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.304875373840332
Epoch: 12, Steps: 18 | Train Loss: 0.149 Vali Loss: 0.543 Vali Acc: 0.943 Test Loss: 0.543 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.063089370727539
Epoch: 13, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.500 Vali Acc: 0.933 Test Loss: 0.500 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 3458689
model size : 22.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.1940131187438965
Epoch: 1, Steps: 18 | Train Loss: 1.988 Vali Loss: 0.312 Vali Acc: 0.907 Test Loss: 0.312 Test Acc: 0.907
Validation loss decreased (inf --> -0.906664).  Saving model ...
Epoch: 2 cost time: 1.9228017330169678
Epoch: 2, Steps: 18 | Train Loss: 0.148 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
Validation loss decreased (-0.906664 --> -0.943332).  Saving model ...
Epoch: 3 cost time: 2.366776466369629
Epoch: 3, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.206 Vali Acc: 0.963 Test Loss: 0.206 Test Acc: 0.963
Validation loss decreased (-0.943332 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 2.368594169616699
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.349 Vali Acc: 0.920 Test Loss: 0.349 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.898076057434082
Epoch: 5, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 2.2442803382873535
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.339 Vali Acc: 0.947 Test Loss: 0.339 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.422182321548462
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.267 Vali Acc: 0.970 Test Loss: 0.267 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969997).  Saving model ...
Epoch: 8 cost time: 2.4070472717285156
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.399 Vali Acc: 0.937 Test Loss: 0.399 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9711458683013916
Epoch: 9, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.359 Vali Acc: 0.940 Test Loss: 0.359 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0383853912353516
Epoch: 10, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.390 Vali Acc: 0.923 Test Loss: 0.390 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.853858470916748
Epoch: 11, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.296 Vali Acc: 0.957 Test Loss: 0.296 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.41383695602417
Epoch: 12, Steps: 18 | Train Loss: 0.139 Vali Loss: 0.891 Vali Acc: 0.903 Test Loss: 0.891 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.12831974029541
Epoch: 13, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.914 Vali Acc: 0.883 Test Loss: 0.914 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9730873107910156
Epoch: 14, Steps: 18 | Train Loss: 0.422 Vali Loss: 1.729 Vali Acc: 0.850 Test Loss: 1.729 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.052480697631836
Epoch: 15, Steps: 18 | Train Loss: 0.491 Vali Loss: 0.528 Vali Acc: 0.933 Test Loss: 0.528 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.1368894577026367
Epoch: 16, Steps: 18 | Train Loss: 0.366 Vali Loss: 0.819 Vali Acc: 0.907 Test Loss: 0.819 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8491673469543457
Epoch: 17, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.751 Vali Acc: 0.923 Test Loss: 0.751 Test Acc: 0.923
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 3458689
model size : 22.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5724332332611084
Epoch: 1, Steps: 18 | Train Loss: 1.968 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
Validation loss decreased (inf --> -0.903330).  Saving model ...
Epoch: 2 cost time: 1.9500415325164795
Epoch: 2, Steps: 18 | Train Loss: 0.158 Vali Loss: 0.165 Vali Acc: 0.953 Test Loss: 0.165 Test Acc: 0.953
Validation loss decreased (-0.903330 --> -0.953332).  Saving model ...
Epoch: 3 cost time: 2.1224024295806885
Epoch: 3, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
Validation loss decreased (-0.953332 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 2.172543525695801
Epoch: 4, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.421 Vali Acc: 0.917 Test Loss: 0.421 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1453373432159424
Epoch: 5, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.258 Vali Acc: 0.953 Test Loss: 0.258 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0147173404693604
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.345 Vali Acc: 0.937 Test Loss: 0.345 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8415729999542236
Epoch: 7, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.330 Vali Acc: 0.940 Test Loss: 0.330 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8771905899047852
Epoch: 8, Steps: 18 | Train Loss: 0.096 Vali Loss: 0.905 Vali Acc: 0.873 Test Loss: 0.905 Test Acc: 0.873
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9569392204284668
Epoch: 9, Steps: 18 | Train Loss: 0.196 Vali Loss: 0.584 Vali Acc: 0.923 Test Loss: 0.584 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.013035535812378
Epoch: 10, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.534 Vali Acc: 0.927 Test Loss: 0.534 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.09822678565979
Epoch: 11, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.660 Vali Acc: 0.920 Test Loss: 0.660 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.0193986892700195
Epoch: 12, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.527 Vali Acc: 0.943 Test Loss: 0.527 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.1700327396392822
Epoch: 13, Steps: 18 | Train Loss: 0.123 Vali Loss: 1.334 Vali Acc: 0.890 Test Loss: 1.334 Test Acc: 0.890
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 3458689
model size : 22.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.777467727661133
Epoch: 1, Steps: 18 | Train Loss: 1.999 Vali Loss: 0.333 Vali Acc: 0.910 Test Loss: 0.333 Test Acc: 0.910
Validation loss decreased (inf --> -0.909997).  Saving model ...
Epoch: 2 cost time: 2.0302529335021973
Epoch: 2, Steps: 18 | Train Loss: 0.194 Vali Loss: 0.211 Vali Acc: 0.947 Test Loss: 0.211 Test Acc: 0.947
Validation loss decreased (-0.909997 --> -0.946665).  Saving model ...
Epoch: 3 cost time: 1.929614543914795
Epoch: 3, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.232 Vali Acc: 0.947 Test Loss: 0.232 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7582178115844727
Epoch: 4, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.294 Vali Acc: 0.937 Test Loss: 0.294 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9865317344665527
Epoch: 5, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.308 Vali Acc: 0.943 Test Loss: 0.308 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7603569030761719
Epoch: 6, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.645 Vali Acc: 0.890 Test Loss: 0.645 Test Acc: 0.890
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.784102439880371
Epoch: 7, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.408 Vali Acc: 0.927 Test Loss: 0.408 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.199502468109131
Epoch: 8, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.278 Vali Acc: 0.963 Test Loss: 0.278 Test Acc: 0.963
Validation loss decreased (-0.946665 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 2.3048813343048096
Epoch: 9, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.939 Vali Acc: 0.870 Test Loss: 0.939 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2999532222747803
Epoch: 10, Steps: 18 | Train Loss: 0.142 Vali Loss: 0.739 Vali Acc: 0.903 Test Loss: 0.739 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9230704307556152
Epoch: 11, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.749 Vali Acc: 0.907 Test Loss: 0.749 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8518948554992676
Epoch: 12, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.908 Vali Acc: 0.903 Test Loss: 0.908 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2554972171783447
Epoch: 13, Steps: 18 | Train Loss: 0.228 Vali Loss: 0.938 Vali Acc: 0.913 Test Loss: 0.938 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2130563259124756
Epoch: 14, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.660 Vali Acc: 0.937 Test Loss: 0.660 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8312225341796875
Epoch: 15, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.479 Vali Acc: 0.953 Test Loss: 0.479 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.94814133644104
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.953 Test Loss: 0.432 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.662041187286377
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.940 Test Loss: 0.556 Test Acc: 0.940
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0087878704071045
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.943 Test Loss: 0.570 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 3458689
model size : 22.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.106662273406982
Epoch: 1, Steps: 18 | Train Loss: 2.001 Vali Loss: 0.303 Vali Acc: 0.920 Test Loss: 0.303 Test Acc: 0.920
Validation loss decreased (inf --> -0.919997).  Saving model ...
Epoch: 2 cost time: 1.9346938133239746
Epoch: 2, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.172 Vali Acc: 0.953 Test Loss: 0.172 Test Acc: 0.953
Validation loss decreased (-0.919997 --> -0.953332).  Saving model ...
Epoch: 3 cost time: 1.949051856994629
Epoch: 3, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.168 Vali Acc: 0.973 Test Loss: 0.168 Test Acc: 0.973
Validation loss decreased (-0.953332 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.9902358055114746
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 2.1940863132476807
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.489 Vali Acc: 0.893 Test Loss: 0.489 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1273343563079834
Epoch: 6, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.384 Vali Acc: 0.947 Test Loss: 0.384 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0192673206329346
Epoch: 7, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.498 Vali Acc: 0.920 Test Loss: 0.498 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0381338596343994
Epoch: 8, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.347 Vali Acc: 0.957 Test Loss: 0.347 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.298053503036499
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.380 Vali Acc: 0.957 Test Loss: 0.380 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.073185920715332
Epoch: 10, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.374 Vali Acc: 0.947 Test Loss: 0.374 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9837820529937744
Epoch: 11, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.449 Vali Acc: 0.950 Test Loss: 0.449 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.067782402038574
Epoch: 12, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.350 Vali Acc: 0.957 Test Loss: 0.350 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.306216239929199
Epoch: 13, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.280 Vali Acc: 0.967 Test Loss: 0.280 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.0397069454193115
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.401 Vali Acc: 0.957 Test Loss: 0.401 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 3196545
model size : 21.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6580095291137695
Epoch: 1, Steps: 18 | Train Loss: 1.988 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (inf --> -0.916664).  Saving model ...
Epoch: 2 cost time: 2.0415005683898926
Epoch: 2, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
Validation loss decreased (-0.916664 --> -0.956665).  Saving model ...
Epoch: 3 cost time: 2.021265983581543
Epoch: 3, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
Validation loss decreased (-0.956665 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 2.3229939937591553
Epoch: 4, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.940 Test Loss: 0.254 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2682669162750244
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.264 Vali Acc: 0.963 Test Loss: 0.264 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.149017572402954
Epoch: 6, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.264 Vali Acc: 0.960 Test Loss: 0.264 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.033618450164795
Epoch: 7, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.528 Vali Acc: 0.930 Test Loss: 0.528 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6370518207550049
Epoch: 8, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.202 Vali Acc: 0.967 Test Loss: 0.202 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8446176052093506
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.284 Vali Acc: 0.940 Test Loss: 0.284 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7156124114990234
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2337939739227295
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.351 Vali Acc: 0.940 Test Loss: 0.351 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4149153232574463
Epoch: 12, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.825 Vali Acc: 0.903 Test Loss: 0.825 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.2293941974639893
Epoch: 13, Steps: 18 | Train Loss: 0.121 Vali Loss: 0.646 Vali Acc: 0.897 Test Loss: 0.646 Test Acc: 0.897
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 3196545
model size : 21.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.4511878490448
Epoch: 1, Steps: 18 | Train Loss: 1.975 Vali Loss: 0.300 Vali Acc: 0.920 Test Loss: 0.300 Test Acc: 0.920
Validation loss decreased (inf --> -0.919997).  Saving model ...
Epoch: 2 cost time: 1.6821274757385254
Epoch: 2, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.191 Vali Acc: 0.940 Test Loss: 0.191 Test Acc: 0.940
Validation loss decreased (-0.919997 --> -0.939998).  Saving model ...
Epoch: 3 cost time: 2.2086966037750244
Epoch: 3, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
Validation loss decreased (-0.939998 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 2.0290467739105225
Epoch: 4, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 2.017604112625122
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.319 Vali Acc: 0.937 Test Loss: 0.319 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.150261878967285
Epoch: 6, Steps: 18 | Train Loss: 0.154 Vali Loss: 0.313 Vali Acc: 0.930 Test Loss: 0.313 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.001715660095215
Epoch: 7, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.490 Vali Acc: 0.910 Test Loss: 0.490 Test Acc: 0.910
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8928256034851074
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.953 Test Loss: 0.243 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.026989698410034
Epoch: 9, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.924 Vali Acc: 0.847 Test Loss: 0.924 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0310022830963135
Epoch: 10, Steps: 18 | Train Loss: 0.111 Vali Loss: 0.729 Vali Acc: 0.907 Test Loss: 0.729 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1203243732452393
Epoch: 11, Steps: 18 | Train Loss: 0.457 Vali Loss: 0.657 Vali Acc: 0.903 Test Loss: 0.657 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.892610788345337
Epoch: 12, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.862 Vali Acc: 0.900 Test Loss: 0.862 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.153715133666992
Epoch: 13, Steps: 18 | Train Loss: 0.142 Vali Loss: 0.436 Vali Acc: 0.967 Test Loss: 0.436 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.036273956298828
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.943 Test Loss: 0.710 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 3196545
model size : 21.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.7513539791107178
Epoch: 1, Steps: 18 | Train Loss: 1.994 Vali Loss: 0.324 Vali Acc: 0.913 Test Loss: 0.324 Test Acc: 0.913
Validation loss decreased (inf --> -0.913330).  Saving model ...
Epoch: 2 cost time: 1.7890856266021729
Epoch: 2, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
Validation loss decreased (-0.913330 --> -0.943331).  Saving model ...
Epoch: 3 cost time: 1.6421136856079102
Epoch: 3, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.186 Vali Acc: 0.953 Test Loss: 0.186 Test Acc: 0.953
Validation loss decreased (-0.943331 --> -0.953331).  Saving model ...
Epoch: 4 cost time: 1.7258319854736328
Epoch: 4, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.953331 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 2.074571371078491
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.210 Vali Acc: 0.960 Test Loss: 0.210 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.924504041671753
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.474 Vali Acc: 0.910 Test Loss: 0.474 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8933539390563965
Epoch: 7, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.566 Vali Acc: 0.887 Test Loss: 0.566 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5900802612304688
Epoch: 8, Steps: 18 | Train Loss: 0.194 Vali Loss: 0.366 Vali Acc: 0.927 Test Loss: 0.366 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.173919200897217
Epoch: 9, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.449 Vali Acc: 0.920 Test Loss: 0.449 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9310429096221924
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.356 Vali Acc: 0.937 Test Loss: 0.356 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5978291034698486
Epoch: 11, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.428 Vali Acc: 0.930 Test Loss: 0.428 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7490978240966797
Epoch: 12, Steps: 18 | Train Loss: 0.075 Vali Loss: 1.042 Vali Acc: 0.870 Test Loss: 1.042 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1541030406951904
Epoch: 13, Steps: 18 | Train Loss: 0.341 Vali Loss: 0.836 Vali Acc: 0.933 Test Loss: 0.836 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9831795692443848
Epoch: 14, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.471 Vali Acc: 0.953 Test Loss: 0.471 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 3196545
model size : 21.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.549612522125244
Epoch: 1, Steps: 18 | Train Loss: 1.950 Vali Loss: 0.402 Vali Acc: 0.890 Test Loss: 0.402 Test Acc: 0.890
Validation loss decreased (inf --> -0.889996).  Saving model ...
Epoch: 2 cost time: 1.957172155380249
Epoch: 2, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.283 Vali Acc: 0.930 Test Loss: 0.283 Test Acc: 0.930
Validation loss decreased (-0.889996 --> -0.929997).  Saving model ...
Epoch: 3 cost time: 2.2256979942321777
Epoch: 3, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.243 Vali Acc: 0.943 Test Loss: 0.243 Test Acc: 0.943
Validation loss decreased (-0.929997 --> -0.943331).  Saving model ...
Epoch: 4 cost time: 2.217092990875244
Epoch: 4, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.240 Vali Acc: 0.953 Test Loss: 0.240 Test Acc: 0.953
Validation loss decreased (-0.943331 --> -0.953331).  Saving model ...
Epoch: 5 cost time: 2.0493972301483154
Epoch: 5, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.292 Vali Acc: 0.933 Test Loss: 0.292 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.146399974822998
Epoch: 6, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.428 Vali Acc: 0.920 Test Loss: 0.428 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2401864528656006
Epoch: 7, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.426 Vali Acc: 0.930 Test Loss: 0.426 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.151357650756836
Epoch: 8, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.642 Vali Acc: 0.933 Test Loss: 0.642 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0461349487304688
Epoch: 9, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.569 Vali Acc: 0.917 Test Loss: 0.569 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0985159873962402
Epoch: 10, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.545 Vali Acc: 0.927 Test Loss: 0.545 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2504215240478516
Epoch: 11, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.648 Vali Acc: 0.917 Test Loss: 0.648 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.0430781841278076
Epoch: 12, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.520 Vali Acc: 0.947 Test Loss: 0.520 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9002244472503662
Epoch: 13, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.544 Vali Acc: 0.907 Test Loss: 0.544 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7961688041687012
Epoch: 14, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.906 Vali Acc: 0.900 Test Loss: 0.906 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9533333333333334
model parameter : 3065473
model size : 21.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.088025331497192
Epoch: 1, Steps: 18 | Train Loss: 1.950 Vali Loss: 0.393 Vali Acc: 0.887 Test Loss: 0.393 Test Acc: 0.887
Validation loss decreased (inf --> -0.886663).  Saving model ...
Epoch: 2 cost time: 2.266613245010376
Epoch: 2, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.285 Vali Acc: 0.930 Test Loss: 0.285 Test Acc: 0.930
Validation loss decreased (-0.886663 --> -0.929997).  Saving model ...
Epoch: 3 cost time: 1.9909350872039795
Epoch: 3, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.223 Vali Acc: 0.940 Test Loss: 0.223 Test Acc: 0.940
Validation loss decreased (-0.929997 --> -0.939998).  Saving model ...
Epoch: 4 cost time: 2.015334129333496
Epoch: 4, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
Validation loss decreased (-0.939998 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 2.11025333404541
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.953 Test Loss: 0.215 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.157806634902954
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.960 Test Loss: 0.231 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.204512596130371
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.960 Test Loss: 0.232 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3101041316986084
Epoch: 8, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.165 Vali Acc: 0.977 Test Loss: 0.165 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 2.3987720012664795
Epoch: 9, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.410 Vali Acc: 0.957 Test Loss: 0.410 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.947835922241211
Epoch: 10, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.267 Vali Acc: 0.963 Test Loss: 0.267 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8951354026794434
Epoch: 11, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.424 Vali Acc: 0.937 Test Loss: 0.424 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9743731021881104
Epoch: 12, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.480 Vali Acc: 0.923 Test Loss: 0.480 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.266732692718506
Epoch: 13, Steps: 18 | Train Loss: 0.656 Vali Loss: 2.761 Vali Acc: 0.813 Test Loss: 2.761 Test Acc: 0.813
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.289442539215088
Epoch: 14, Steps: 18 | Train Loss: 0.429 Vali Loss: 2.306 Vali Acc: 0.820 Test Loss: 2.306 Test Acc: 0.820
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.178035020828247
Epoch: 15, Steps: 18 | Train Loss: 0.647 Vali Loss: 0.963 Vali Acc: 0.927 Test Loss: 0.963 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.2351036071777344
Epoch: 16, Steps: 18 | Train Loss: 0.213 Vali Loss: 1.107 Vali Acc: 0.913 Test Loss: 1.107 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.389287233352661
Epoch: 17, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.913 Vali Acc: 0.933 Test Loss: 0.913 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1723086833953857
Epoch: 18, Steps: 18 | Train Loss: 0.108 Vali Loss: 1.116 Vali Acc: 0.940 Test Loss: 1.116 Test Acc: 0.940
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 3065473
model size : 21.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.524620294570923
Epoch: 1, Steps: 18 | Train Loss: 1.951 Vali Loss: 0.385 Vali Acc: 0.880 Test Loss: 0.385 Test Acc: 0.880
Validation loss decreased (inf --> -0.879996).  Saving model ...
Epoch: 2 cost time: 1.795276403427124
Epoch: 2, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.258 Vali Acc: 0.940 Test Loss: 0.258 Test Acc: 0.940
Validation loss decreased (-0.879996 --> -0.939997).  Saving model ...
Epoch: 3 cost time: 1.9953649044036865
Epoch: 3, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6890342235565186
Epoch: 4, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
Validation loss decreased (-0.939997 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 2.0523037910461426
Epoch: 5, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9990816116333008
Epoch: 6, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.500 Vali Acc: 0.907 Test Loss: 0.500 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.091029644012451
Epoch: 7, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.500 Vali Acc: 0.910 Test Loss: 0.500 Test Acc: 0.910
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9052391052246094
Epoch: 8, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.434 Vali Acc: 0.930 Test Loss: 0.434 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.92183518409729
Epoch: 9, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.300 Vali Acc: 0.963 Test Loss: 0.300 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963330).  Saving model ...
Epoch: 10 cost time: 2.073932409286499
Epoch: 10, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.321 Vali Acc: 0.960 Test Loss: 0.321 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9281678199768066
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.364 Vali Acc: 0.973 Test Loss: 0.364 Test Acc: 0.973
Validation loss decreased (-0.963330 --> -0.973330).  Saving model ...
Epoch: 12 cost time: 1.8314666748046875
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.797 Vali Acc: 0.917 Test Loss: 0.797 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8279943466186523
Epoch: 13, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.606 Vali Acc: 0.930 Test Loss: 0.606 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8625009059906006
Epoch: 14, Steps: 18 | Train Loss: 0.165 Vali Loss: 0.680 Vali Acc: 0.910 Test Loss: 0.680 Test Acc: 0.910
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.983086109161377
Epoch: 15, Steps: 18 | Train Loss: 0.256 Vali Loss: 0.434 Vali Acc: 0.950 Test Loss: 0.434 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9766864776611328
Epoch: 16, Steps: 18 | Train Loss: 0.047 Vali Loss: 2.080 Vali Acc: 0.900 Test Loss: 2.080 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8178861141204834
Epoch: 17, Steps: 18 | Train Loss: 0.426 Vali Loss: 1.256 Vali Acc: 0.913 Test Loss: 1.256 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9192149639129639
Epoch: 18, Steps: 18 | Train Loss: 0.074 Vali Loss: 1.367 Vali Acc: 0.920 Test Loss: 1.367 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9323718547821045
Epoch: 19, Steps: 18 | Train Loss: 0.246 Vali Loss: 0.896 Vali Acc: 0.940 Test Loss: 0.896 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8435158729553223
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.950 Test Loss: 0.665 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0057125091552734
Epoch: 21, Steps: 18 | Train Loss: 0.076 Vali Loss: 1.570 Vali Acc: 0.920 Test Loss: 1.570 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 3065473
model size : 21.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.558267831802368
Epoch: 1, Steps: 18 | Train Loss: 1.954 Vali Loss: 0.411 Vali Acc: 0.883 Test Loss: 0.411 Test Acc: 0.883
Validation loss decreased (inf --> -0.883329).  Saving model ...
Epoch: 2 cost time: 2.1013009548187256
Epoch: 2, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.270 Vali Acc: 0.920 Test Loss: 0.270 Test Acc: 0.920
Validation loss decreased (-0.883329 --> -0.919997).  Saving model ...
Epoch: 3 cost time: 2.110992431640625
Epoch: 3, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.248 Vali Acc: 0.943 Test Loss: 0.248 Test Acc: 0.943
Validation loss decreased (-0.919997 --> -0.943331).  Saving model ...
Epoch: 4 cost time: 1.772813320159912
Epoch: 4, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.259 Vali Acc: 0.947 Test Loss: 0.259 Test Acc: 0.947
Validation loss decreased (-0.943331 --> -0.946664).  Saving model ...
Epoch: 5 cost time: 1.8363678455352783
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.253 Vali Acc: 0.947 Test Loss: 0.253 Test Acc: 0.947
Validation loss decreased (-0.946664 --> -0.946664).  Saving model ...
Epoch: 6 cost time: 2.111499547958374
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.223 Vali Acc: 0.967 Test Loss: 0.223 Test Acc: 0.967
Validation loss decreased (-0.946664 --> -0.966664).  Saving model ...
Epoch: 7 cost time: 2.1054434776306152
Epoch: 7, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.553 Vali Acc: 0.943 Test Loss: 0.553 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8620188236236572
Epoch: 8, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.568 Vali Acc: 0.917 Test Loss: 0.568 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9140851497650146
Epoch: 9, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.718 Vali Acc: 0.870 Test Loss: 0.718 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.989870309829712
Epoch: 10, Steps: 18 | Train Loss: 0.245 Vali Loss: 0.497 Vali Acc: 0.910 Test Loss: 0.497 Test Acc: 0.910
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.071794271469116
Epoch: 11, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.688 Vali Acc: 0.923 Test Loss: 0.688 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.831087350845337
Epoch: 12, Steps: 18 | Train Loss: 0.245 Vali Loss: 1.199 Vali Acc: 0.913 Test Loss: 1.199 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8667025566101074
Epoch: 13, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.489 Vali Acc: 0.963 Test Loss: 0.489 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8559341430664062
Epoch: 14, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.508 Vali Acc: 0.953 Test Loss: 0.508 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9188201427459717
Epoch: 15, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.821 Vali Acc: 0.903 Test Loss: 0.821 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8181393146514893
Epoch: 16, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.776 Vali Acc: 0.927 Test Loss: 0.776 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 3065473
model size : 21.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5243241786956787
Epoch: 1, Steps: 18 | Train Loss: 2.302 Vali Loss: 0.503 Vali Acc: 0.907 Test Loss: 0.503 Test Acc: 0.907
Validation loss decreased (inf --> -0.906662).  Saving model ...
Epoch: 2 cost time: 1.7203845977783203
Epoch: 2, Steps: 18 | Train Loss: 0.168 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.906662 --> -0.973332).  Saving model ...
Epoch: 3 cost time: 1.8292698860168457
Epoch: 3, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9037001132965088
Epoch: 4, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.751600980758667
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.8581159114837646
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.8486969470977783
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7960090637207031
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7978482246398926
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5770018100738525
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8537485599517822
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8538575172424316
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.7869257926940918
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.7318212985992432
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.0271852016448975
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 2.0730395317077637
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.8474268913269043
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.0102341175079346
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.0247528553009033
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 2.0566508769989014
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.9900832176208496
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5989418029785156
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.9986233711242676
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.9638738632202148
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.9012939929962158
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9263880252838135
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 2.089750051498413
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 2.038203001022339
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.7518603801727295
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.8792760372161865
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.9116218090057373
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9350690841674805
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.822427749633789
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.7501447200775146
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.7832109928131104
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.8283123970031738
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8704557418823242
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.7418732643127441
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.7608866691589355
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.828390121459961
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.7065575122833252
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.776559829711914
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.69985032081604
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.8108561038970947
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.793358325958252
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.7283565998077393
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.0335755348205566
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.8610138893127441
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.6932792663574219
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.6023280620574951
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.7385942935943604
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.877664566040039
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.9085679054260254
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.722825050354004
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.8577125072479248
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 3302273
model size : 17.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.4542038440704346
Epoch: 1, Steps: 18 | Train Loss: 2.292 Vali Loss: 0.489 Vali Acc: 0.913 Test Loss: 0.489 Test Acc: 0.913
Validation loss decreased (inf --> -0.913328).  Saving model ...
Epoch: 2 cost time: 1.444258213043213
Epoch: 2, Steps: 18 | Train Loss: 0.162 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.913328 --> -0.969999).  Saving model ...
Epoch: 3 cost time: 1.5107438564300537
Epoch: 3, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.960 Test Loss: 0.114 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5732917785644531
Epoch: 4, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4464468955993652
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0660579204559326
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.927574634552002
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.820707082748413
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.890148401260376
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8667163848876953
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9612534046173096
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7845544815063477
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.8652608394622803
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.844580888748169
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.8951849937438965
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.6851394176483154
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.6971399784088135
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.7328546047210693
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.8423888683319092
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.8278605937957764
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.610908031463623
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.7350068092346191
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.8755006790161133
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.7614812850952148
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.5861179828643799
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7835485935211182
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.913071632385254
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.6973364353179932
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.7740468978881836
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.7185511589050293
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.8733327388763428
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9661846160888672
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5763673782348633
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8438222408294678
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 2.1192421913146973
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.110304117202759
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8497693538665771
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.7901878356933594
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.081833839416504
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.1066651344299316
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.7594757080078125
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.999875545501709
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 2.0412235260009766
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.000072717666626
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.963932752609253
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.886115312576294
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.6924400329589844
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.006317138671875
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.8895103931427002
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.609327793121338
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.804168462753296
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.8411459922790527
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.6688625812530518
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.819035530090332
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.7889630794525146
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 3302273
model size : 17.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.545444965362549
Epoch: 1, Steps: 18 | Train Loss: 2.299 Vali Loss: 0.491 Vali Acc: 0.897 Test Loss: 0.491 Test Acc: 0.897
Validation loss decreased (inf --> -0.896662).  Saving model ...
Epoch: 2 cost time: 1.8176851272583008
Epoch: 2, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.896662 --> -0.976665).  Saving model ...
Epoch: 3 cost time: 1.8217623233795166
Epoch: 3, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.777700662612915
Epoch: 4, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7908477783203125
Epoch: 5, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7793188095092773
Epoch: 6, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.948704481124878
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.5856280326843262
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.773970127105713
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.3938419818878174
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.816011905670166
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.5775117874145508
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.7078866958618164
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.8788049221038818
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 2.0062811374664307
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.8619458675384521
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 1.7986042499542236
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.8556697368621826
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.925041913986206
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 2.0577948093414307
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.960082769393921
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8384466171264648
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.9026548862457275
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.99163818359375
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.8870525360107422
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9508349895477295
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8218047618865967
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 1.9938616752624512
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.8596057891845703
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 1.7191007137298584
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.628077507019043
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8076961040496826
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 1.687978744506836
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 34 cost time: 1.698136329650879
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 35 cost time: 1.674616813659668
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.8615877628326416
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8399074077606201
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.7792539596557617
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6438536643981934
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.8730082511901855
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.8274040222167969
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.7369835376739502
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.630120038986206
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 44 cost time: 2.0480918884277344
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 45 cost time: 1.7504305839538574
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 46 cost time: 1.8807868957519531
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.989128828048706
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.980443000793457
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.020022392272949
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.682417392730713
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 2.056570053100586
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.1825063228607178
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 2.0628674030303955
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.8345654010772705
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 2.098569869995117
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 3302273
model size : 17.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.715022563934326
Epoch: 1, Steps: 18 | Train Loss: 2.311 Vali Loss: 0.515 Vali Acc: 0.903 Test Loss: 0.515 Test Acc: 0.903
Validation loss decreased (inf --> -0.903328).  Saving model ...
Epoch: 2 cost time: 1.8790884017944336
Epoch: 2, Steps: 18 | Train Loss: 0.187 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
Validation loss decreased (-0.903328 --> -0.963332).  Saving model ...
Epoch: 3 cost time: 1.7680001258850098
Epoch: 3, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8418643474578857
Epoch: 4, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.172 Vali Acc: 0.953 Test Loss: 0.172 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.923015832901001
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.9035451412200928
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.6884725093841553
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.963 Test Loss: 0.128 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7265162467956543
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.756091833114624
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7949514389038086
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7022695541381836
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6212410926818848
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7336819171905518
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7891857624053955
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.4362998008728027
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4034430980682373
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4729762077331543
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.7239580154418945
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.7752225399017334
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.712766170501709
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.6038715839385986
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7773756980895996
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.7086405754089355
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6603217124938965
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6878116130828857
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8199429512023926
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7529265880584717
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6990315914154053
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5624287128448486
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.466742992401123
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.9434287548065186
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.7892835140228271
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 3302273
model size : 17.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.320969581604004
Epoch: 1, Steps: 18 | Train Loss: 2.384 Vali Loss: 0.536 Vali Acc: 0.920 Test Loss: 0.536 Test Acc: 0.920
Validation loss decreased (inf --> -0.919995).  Saving model ...
Epoch: 2 cost time: 1.595202922821045
Epoch: 2, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.202 Vali Acc: 0.943 Test Loss: 0.202 Test Acc: 0.943
Validation loss decreased (-0.919995 --> -0.943331).  Saving model ...
Epoch: 3 cost time: 1.5209386348724365
Epoch: 3, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.943331 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 2.0980048179626465
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 1.8334133625030518
Epoch: 5, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.959998 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 1.9323475360870361
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6844851970672607
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.9889023303985596
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.7358572483062744
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.4586694240570068
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.610569953918457
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.8971245288848877
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.7318511009216309
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.536322832107544
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.6669073104858398
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.8193984031677246
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6266069412231445
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.666640281677246
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.254016399383545
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7678544521331787
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7771649360656738
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.710822582244873
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.7579164505004883
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.824467420578003
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.786628007888794
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.7195684909820557
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8685383796691895
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8479712009429932
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.835716724395752
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7222871780395508
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.6900811195373535
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.6511776447296143
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.8899400234222412
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8157286643981934
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8600165843963623
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.757443904876709
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.9321658611297607
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8825228214263916
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.9730908870697021
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.8641252517700195
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.052839994430542
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.7750611305236816
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.7917113304138184
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.9521276950836182
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.0002830028533936
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.7939279079437256
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.6166000366210938
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.7497823238372803
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.8617982864379883
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.752587080001831
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.6591060161590576
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.8029577732086182
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2253697
model size : 13.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.7138235569000244
Epoch: 1, Steps: 18 | Train Loss: 2.378 Vali Loss: 0.521 Vali Acc: 0.920 Test Loss: 0.521 Test Acc: 0.920
Validation loss decreased (inf --> -0.919995).  Saving model ...
Epoch: 2 cost time: 1.7143397331237793
Epoch: 2, Steps: 18 | Train Loss: 0.179 Vali Loss: 0.194 Vali Acc: 0.940 Test Loss: 0.194 Test Acc: 0.940
Validation loss decreased (-0.919995 --> -0.939998).  Saving model ...
Epoch: 3 cost time: 1.7410690784454346
Epoch: 3, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
Validation loss decreased (-0.939998 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 1.5370969772338867
Epoch: 4, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.956665 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 1.8277029991149902
Epoch: 5, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5643506050109863
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5197408199310303
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.4993700981140137
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.868302345275879
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.6968445777893066
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6095459461212158
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.636476755142212
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.7748236656188965
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.6262855529785156
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.602776288986206
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.8671164512634277
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8418958187103271
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.8077936172485352
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.7947378158569336
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8463857173919678
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9316668510437012
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.714120626449585
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7670378684997559
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8731763362884521
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8920769691467285
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.967719554901123
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7985649108886719
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8972997665405273
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 2.111166477203369
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.663750171661377
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.7401177883148193
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7564709186553955
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.8487396240234375
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6084814071655273
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.6324543952941895
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.7023630142211914
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.861987829208374
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.4881532192230225
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.6840496063232422
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.8276331424713135
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.8288707733154297
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.7713649272918701
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5943398475646973
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.6964995861053467
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.7860920429229736
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.5981063842773438
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.726656436920166
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.7303345203399658
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.7947196960449219
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.7432878017425537
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.6918537616729736
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.74686861038208
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.0042858123779297
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.9292476177215576
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.7196059226989746
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.8213083744049072
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.977111577987671
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.998121976852417
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.7450926303863525
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.8232038021087646
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2253697
model size : 13.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.4726309776306152
Epoch: 1, Steps: 18 | Train Loss: 2.374 Vali Loss: 0.516 Vali Acc: 0.920 Test Loss: 0.516 Test Acc: 0.920
Validation loss decreased (inf --> -0.919995).  Saving model ...
Epoch: 2 cost time: 1.7634592056274414
Epoch: 2, Steps: 18 | Train Loss: 0.186 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
Validation loss decreased (-0.919995 --> -0.936665).  Saving model ...
Epoch: 3 cost time: 1.5101613998413086
Epoch: 3, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
Validation loss decreased (-0.936665 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 1.4590978622436523
Epoch: 4, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.32558274269104
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.7500286102294922
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.778369665145874
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.6486444473266602
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.6786093711853027
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.6794531345367432
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.7228584289550781
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.6262092590332031
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6319472789764404
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.7674367427825928
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.823528528213501
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.7057867050170898
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.7525653839111328
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.7176048755645752
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8526628017425537
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.678105354309082
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.80722975730896
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7916889190673828
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.8170711994171143
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7120563983917236
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9155299663543701
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.7964203357696533
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7396323680877686
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6127614974975586
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7529022693634033
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.838592290878296
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8557188510894775
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.6457579135894775
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.6937432289123535
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.922145128250122
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.7023561000823975
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2253697
model size : 13.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2790589332580566
Epoch: 1, Steps: 18 | Train Loss: 2.386 Vali Loss: 0.573 Vali Acc: 0.910 Test Loss: 0.573 Test Acc: 0.910
Validation loss decreased (inf --> -0.909994).  Saving model ...
Epoch: 2 cost time: 1.5152161121368408
Epoch: 2, Steps: 18 | Train Loss: 0.216 Vali Loss: 0.248 Vali Acc: 0.927 Test Loss: 0.248 Test Acc: 0.927
Validation loss decreased (-0.909994 --> -0.926664).  Saving model ...
Epoch: 3 cost time: 1.5764644145965576
Epoch: 3, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.162 Vali Acc: 0.960 Test Loss: 0.162 Test Acc: 0.960
Validation loss decreased (-0.926664 --> -0.959998).  Saving model ...
Epoch: 4 cost time: 1.6811332702636719
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.959998 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 1.6861553192138672
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.597992181777954
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4654152393341064
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7644391059875488
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6546199321746826
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5556278228759766
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4818115234375
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.709050178527832
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.478304386138916
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5751442909240723
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 2253697
model size : 13.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6050970554351807
Epoch: 1, Steps: 18 | Train Loss: 2.345 Vali Loss: 0.503 Vali Acc: 0.937 Test Loss: 0.503 Test Acc: 0.937
Validation loss decreased (inf --> -0.936662).  Saving model ...
Epoch: 2 cost time: 1.5618109703063965
Epoch: 2, Steps: 18 | Train Loss: 0.184 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.936662 --> -0.973332).  Saving model ...
Epoch: 3 cost time: 1.7396528720855713
Epoch: 3, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.573171615600586
Epoch: 4, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 1.6099283695220947
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.4920096397399902
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.701331615447998
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.8557026386260986
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6123080253601074
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7041761875152588
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9788908958435059
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.680022954940796
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7576026916503906
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7015001773834229
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.649770975112915
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.991962194442749
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7797200679779053
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1729409
model size : 11.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6004364490509033
Epoch: 1, Steps: 18 | Train Loss: 2.336 Vali Loss: 0.491 Vali Acc: 0.940 Test Loss: 0.491 Test Acc: 0.940
Validation loss decreased (inf --> -0.939995).  Saving model ...
Epoch: 2 cost time: 1.631312370300293
Epoch: 2, Steps: 18 | Train Loss: 0.181 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.939995 --> -0.976665).  Saving model ...
Epoch: 3 cost time: 1.6952266693115234
Epoch: 3, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6873424053192139
Epoch: 4, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 1.5652625560760498
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.7018563747406006
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7154912948608398
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9024255275726318
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.786902666091919
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6675543785095215
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4684715270996094
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7867355346679688
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6596264839172363
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5231380462646484
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5496971607208252
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1729409
model size : 11.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.3237075805664062
Epoch: 1, Steps: 18 | Train Loss: 2.316 Vali Loss: 0.482 Vali Acc: 0.950 Test Loss: 0.482 Test Acc: 0.950
Validation loss decreased (inf --> -0.949995).  Saving model ...
Epoch: 2 cost time: 1.6226410865783691
Epoch: 2, Steps: 18 | Train Loss: 0.184 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
Validation loss decreased (-0.949995 --> -0.963332).  Saving model ...
Epoch: 3 cost time: 1.658872127532959
Epoch: 3, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.6343803405761719
Epoch: 4, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 1.717604637145996
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.8234598636627197
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 1.6660597324371338
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6731493473052979
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.547675371170044
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7714622020721436
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5800490379333496
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4668567180633545
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6269307136535645
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9120655059814453
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.555058479309082
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6461682319641113
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1729409
model size : 11.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5554451942443848
Epoch: 1, Steps: 18 | Train Loss: 2.331 Vali Loss: 0.534 Vali Acc: 0.933 Test Loss: 0.534 Test Acc: 0.933
Validation loss decreased (inf --> -0.933328).  Saving model ...
Epoch: 2 cost time: 1.6371476650238037
Epoch: 2, Steps: 18 | Train Loss: 0.208 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
Validation loss decreased (-0.933328 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 1.9632134437561035
Epoch: 3, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
Validation loss decreased (-0.949998 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 1.5935380458831787
Epoch: 4, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.956665 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.4481885433197021
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6537904739379883
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5511047840118408
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4873018264770508
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5400655269622803
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6249253749847412
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6209092140197754
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6431658267974854
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6095819473266602
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6459064483642578
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1729409
model size : 11.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.437770128250122
Epoch: 1, Steps: 18 | Train Loss: 2.388 Vali Loss: 0.516 Vali Acc: 0.917 Test Loss: 0.516 Test Acc: 0.917
Validation loss decreased (inf --> -0.916662).  Saving model ...
Epoch: 2 cost time: 1.769380807876587
Epoch: 2, Steps: 18 | Train Loss: 0.188 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
Validation loss decreased (-0.916662 --> -0.963332).  Saving model ...
Epoch: 3 cost time: 1.5961196422576904
Epoch: 3, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.963332 --> -0.979999).  Saving model ...
Epoch: 4 cost time: 1.6521999835968018
Epoch: 4, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 1.533583641052246
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.953 Test Loss: 0.251 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6742427349090576
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.155 Vali Acc: 0.977 Test Loss: 0.155 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6291403770446777
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.983 Test Loss: 0.127 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.601072072982788
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6070618629455566
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9233176708221436
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.82432222366333
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7007582187652588
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7228312492370605
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.638171911239624
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1467265
model size : 10.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5928447246551514
Epoch: 1, Steps: 18 | Train Loss: 2.377 Vali Loss: 0.507 Vali Acc: 0.923 Test Loss: 0.507 Test Acc: 0.923
Validation loss decreased (inf --> -0.923328).  Saving model ...
Epoch: 2 cost time: 1.9080350399017334
Epoch: 2, Steps: 18 | Train Loss: 0.185 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
Validation loss decreased (-0.923328 --> -0.963332).  Saving model ...
Epoch: 3 cost time: 1.6572949886322021
Epoch: 3, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.963332 --> -0.983332).  Saving model ...
Epoch: 4 cost time: 1.6773664951324463
Epoch: 4, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.67592191696167
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.953 Test Loss: 0.213 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.447502613067627
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4656195640563965
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6037437915802002
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3644037246704102
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.715695858001709
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6157395839691162
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5976276397705078
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5537636280059814
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1467265
model size : 10.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.1918952465057373
Epoch: 1, Steps: 18 | Train Loss: 2.359 Vali Loss: 0.496 Vali Acc: 0.910 Test Loss: 0.496 Test Acc: 0.910
Validation loss decreased (inf --> -0.909995).  Saving model ...
Epoch: 2 cost time: 1.657872200012207
Epoch: 2, Steps: 18 | Train Loss: 0.182 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
Validation loss decreased (-0.909995 --> -0.963332).  Saving model ...
Epoch: 3 cost time: 1.604353904724121
Epoch: 3, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.963332 --> -0.979999).  Saving model ...
Epoch: 4 cost time: 1.662147045135498
Epoch: 4, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 1.7991957664489746
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.960 Test Loss: 0.191 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.685483455657959
Epoch: 6, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.629126787185669
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7353577613830566
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.614853858947754
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6673336029052734
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6283283233642578
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6140856742858887
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7732536792755127
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8040261268615723
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1467265
model size : 10.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.315930128097534
Epoch: 1, Steps: 18 | Train Loss: 2.365 Vali Loss: 0.547 Vali Acc: 0.917 Test Loss: 0.547 Test Acc: 0.917
Validation loss decreased (inf --> -0.916661).  Saving model ...
Epoch: 2 cost time: 1.6177961826324463
Epoch: 2, Steps: 18 | Train Loss: 0.220 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
Validation loss decreased (-0.916661 --> -0.959998).  Saving model ...
Epoch: 3 cost time: 1.4795138835906982
Epoch: 3, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.959998 --> -0.976666).  Saving model ...
Epoch: 4 cost time: 1.6715567111968994
Epoch: 4, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5945789813995361
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.947 Test Loss: 0.185 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5471415519714355
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5569727420806885
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7167060375213623
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7110414505004883
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.812657117843628
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6213996410369873
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7754006385803223
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.5737738609313965
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.7589590549468994
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.5787503719329834
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.6698062419891357
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.6283411979675293
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.5866858959197998
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.5061101913452148
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.711745262145996
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6404423713684082
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.6873571872711182
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.6740896701812744
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.5468471050262451
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.674482822418213
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.580432653427124
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.5276572704315186
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.2694907188415527
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.634399652481079
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5485503673553467
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5117249488830566
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4945085048675537
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.6760284900665283
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6505978107452393
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.7043914794921875
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.629316806793213
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.8025825023651123
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.6229579448699951
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.5376782417297363
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.534228801727295
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.795407772064209
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4887588024139404
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.600264072418213
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.5274734497070312
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.67209792137146
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.737483263015747
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.6104528903961182
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.634648323059082
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.7681565284729004
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.5545740127563477
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.55507493019104
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.5024793148040771
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.601485013961792
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.5123107433319092
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.5668253898620605
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 1.5960795879364014
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.7045743465423584
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.5822668075561523
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.664139747619629
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.3760151863098145
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.3617072105407715
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.2367889881134033
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.3086981773376465
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.3367602825164795
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.6451778411865234
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.7685749530792236
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.6356146335601807
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.5139236450195312
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.2400307655334473
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.6345486640930176
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.488938570022583
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.7837936878204346
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.7597055435180664
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.6029541492462158
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.8925464153289795
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.956268072128296
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1467265
model size : 10.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.44073486328125
Epoch: 1, Steps: 18 | Train Loss: 2.303 Vali Loss: 0.528 Vali Acc: 0.903 Test Loss: 0.528 Test Acc: 0.903
Validation loss decreased (inf --> -0.903328).  Saving model ...
Epoch: 2 cost time: 1.8747148513793945
Epoch: 2, Steps: 18 | Train Loss: 0.173 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
Validation loss decreased (-0.903328 --> -0.956665).  Saving model ...
Epoch: 3 cost time: 2.0661799907684326
Epoch: 3, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.956665 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.723024845123291
Epoch: 4, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7981517314910889
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 1.904799222946167
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0600857734680176
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.015471935272217
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9788978099822998
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6786422729492188
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.835174798965454
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.8903875350952148
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7254652976989746
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.7760694026947021
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.8659141063690186
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.7409040927886963
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8094403743743896
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.813262701034546
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.773756980895996
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.8585410118103027
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.7760231494903564
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6794078350067139
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.7463068962097168
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7058351039886475
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.697028636932373
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6984333992004395
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.718458890914917
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.9630844593048096
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.947664737701416
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.7446491718292236
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.6124210357666016
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8206696510314941
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6333959102630615
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8532428741455078
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.777951955795288
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.079793930053711
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 2.023768186569214
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.8630807399749756
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.7397546768188477
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 2.0069103240966797
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.90462327003479
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.8733651638031006
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.7581114768981934
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 2.051760196685791
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.9221205711364746
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.8295068740844727
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.8173377513885498
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.7164742946624756
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.7182340621948242
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.7539005279541016
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.6151809692382812
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.4210686683654785
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.7787129878997803
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.638542652130127
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.4658756256103516
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.6835625171661377
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.8021578788757324
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.836057186126709
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.7885007858276367
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.6471569538116455
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.7709107398986816
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.8045401573181152
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.6354594230651855
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 1.8249387741088867
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.9633231163024902
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.760810136795044
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.6984336376190186
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.6948926448822021
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.6100661754608154
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.7446534633636475
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.5722534656524658
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.4001214504241943
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.8058409690856934
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 2.0599441528320312
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 2.084113597869873
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.880201816558838
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1336193
model size : 10.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6676242351531982
Epoch: 1, Steps: 18 | Train Loss: 2.289 Vali Loss: 0.508 Vali Acc: 0.913 Test Loss: 0.508 Test Acc: 0.913
Validation loss decreased (inf --> -0.913328).  Saving model ...
Epoch: 2 cost time: 1.8082659244537354
Epoch: 2, Steps: 18 | Train Loss: 0.168 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
Validation loss decreased (-0.913328 --> -0.956665).  Saving model ...
Epoch: 3 cost time: 1.6636862754821777
Epoch: 3, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.956665 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.9060349464416504
Epoch: 4, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.8440375328063965
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.6465973854064941
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6608357429504395
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9271893501281738
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7476871013641357
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.520948886871338
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.605797529220581
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7123451232910156
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.6689209938049316
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.5921580791473389
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.5735108852386475
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.7137279510498047
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8555512428283691
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7131597995758057
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7105791568756104
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8260929584503174
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.420295000076294
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4276669025421143
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4644277095794678
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3822214603424072
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.7071218490600586
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1336193
model size : 10.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6086764335632324
Epoch: 1, Steps: 18 | Train Loss: 2.278 Vali Loss: 0.501 Vali Acc: 0.917 Test Loss: 0.501 Test Acc: 0.917
Validation loss decreased (inf --> -0.916662).  Saving model ...
Epoch: 2 cost time: 1.6460552215576172
Epoch: 2, Steps: 18 | Train Loss: 0.174 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
Validation loss decreased (-0.916662 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 1.566169023513794
Epoch: 3, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.949998 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.6318302154541016
Epoch: 4, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.7932782173156738
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.9093995094299316
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.7913155555725098
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6881680488586426
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.8312931060791016
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.8684616088867188
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.7476041316986084
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.7892487049102783
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6002488136291504
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.7913188934326172
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.4993484020233154
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.692108392715454
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6460227966308594
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.895366907119751
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7882888317108154
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5556552410125732
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7787575721740723
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6398327350616455
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.701913595199585
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6258978843688965
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4556832313537598
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1336193
model size : 10.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.355515480041504
Epoch: 1, Steps: 18 | Train Loss: 2.276 Vali Loss: 0.557 Vali Acc: 0.900 Test Loss: 0.557 Test Acc: 0.900
Validation loss decreased (inf --> -0.899994).  Saving model ...
Epoch: 2 cost time: 1.7403693199157715
Epoch: 2, Steps: 18 | Train Loss: 0.211 Vali Loss: 0.196 Vali Acc: 0.947 Test Loss: 0.196 Test Acc: 0.947
Validation loss decreased (-0.899994 --> -0.946665).  Saving model ...
Epoch: 3 cost time: 1.7702500820159912
Epoch: 3, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.150 Vali Acc: 0.953 Test Loss: 0.150 Test Acc: 0.953
Validation loss decreased (-0.946665 --> -0.953332).  Saving model ...
Epoch: 4 cost time: 1.681260108947754
Epoch: 4, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
Validation loss decreased (-0.953332 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 1.5713427066802979
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5088903903961182
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 1.6658155918121338
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.5622458457946777
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.5180997848510742
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6312532424926758
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7088887691497803
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5201003551483154
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.567187786102295
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5576646327972412
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8605642318725586
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8634426593780518
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8807740211486816
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7683393955230713
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1336193
model size : 10.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.54194712638855
Epoch: 1, Steps: 18 | Train Loss: 2.355 Vali Loss: 0.519 Vali Acc: 0.917 Test Loss: 0.519 Test Acc: 0.917
Validation loss decreased (inf --> -0.916661).  Saving model ...
Epoch: 2 cost time: 1.9270989894866943
Epoch: 2, Steps: 18 | Train Loss: 0.165 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.916661 --> -0.973332).  Saving model ...
Epoch: 3 cost time: 1.9967529773712158
Epoch: 3, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.170 Vali Acc: 0.940 Test Loss: 0.170 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.804137945175171
Epoch: 4, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.647308111190796
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8532979488372803
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 2.016996383666992
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.620420217514038
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6173231601715088
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.6057522296905518
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.7600436210632324
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.6762721538543701
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.6736581325531006
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.6708347797393799
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.8006727695465088
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.7406635284423828
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.767876148223877
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.49393630027771
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7780425548553467
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.523611307144165
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.503157138824463
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.5070757865905762
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.7827014923095703
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4619927406311035
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.617551565170288
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8207616806030273
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7374796867370605
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.6490113735198975
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.61604905128479
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.6983237266540527
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7399320602416992
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.9172091484069824
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.6228251457214355
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.8163106441497803
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9316885471343994
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.8878729343414307
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.7039642333984375
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.6818196773529053
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.9410829544067383
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.9091129302978516
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.8330037593841553
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.8373754024505615
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.9804303646087646
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1270657
model size : 9.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.691974401473999
Epoch: 1, Steps: 18 | Train Loss: 2.324 Vali Loss: 0.512 Vali Acc: 0.917 Test Loss: 0.512 Test Acc: 0.917
Validation loss decreased (inf --> -0.916662).  Saving model ...
Epoch: 2 cost time: 1.5259671211242676
Epoch: 2, Steps: 18 | Train Loss: 0.158 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
Validation loss decreased (-0.916662 --> -0.966665).  Saving model ...
Epoch: 3 cost time: 1.495497465133667
Epoch: 3, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7192044258117676
Epoch: 4, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.7869834899902344
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5958704948425293
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.6584818363189697
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.7310996055603027
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.8449256420135498
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8913521766662598
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6859560012817383
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.711209774017334
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.7041347026824951
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.821948766708374
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.7131962776184082
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.6430444717407227
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.7894256114959717
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.6923983097076416
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.635549545288086
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7189958095550537
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6655991077423096
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.4772999286651611
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5918056964874268
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5539560317993164
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7483041286468506
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8416099548339844
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7186293601989746
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.78507399559021
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6526172161102295
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8215858936309814
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7044703960418701
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.7032356262207031
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.7356598377227783
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.8821747303009033
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.7843616008758545
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.8913347721099854
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.7654147148132324
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1270657
model size : 9.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.30243182182312
Epoch: 1, Steps: 18 | Train Loss: 2.307 Vali Loss: 0.503 Vali Acc: 0.920 Test Loss: 0.503 Test Acc: 0.920
Validation loss decreased (inf --> -0.919995).  Saving model ...
Epoch: 2 cost time: 1.5632312297821045
Epoch: 2, Steps: 18 | Train Loss: 0.156 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.919995 --> -0.969999).  Saving model ...
Epoch: 3 cost time: 1.6336643695831299
Epoch: 3, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6629397869110107
Epoch: 4, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6104469299316406
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.4697206020355225
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.6003153324127197
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.6207993030548096
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.5754570960998535
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.646911859512329
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.761423110961914
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.521080493927002
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3968231678009033
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5622801780700684
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.3948073387145996
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.4096269607543945
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.4711964130401611
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.605755090713501
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.3852972984313965
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6400790214538574
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7307853698730469
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.7359309196472168
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9135348796844482
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6804924011230469
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6882085800170898
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.77034330368042
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8977413177490234
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.595655918121338
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.617905616760254
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5311129093170166
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.9041790962219238
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6803956031799316
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.604097604751587
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5909380912780762
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.8375844955444336
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.553229808807373
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.481658935546875
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1270657
model size : 9.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.29115891456604
Epoch: 1, Steps: 18 | Train Loss: 2.291 Vali Loss: 0.531 Vali Acc: 0.917 Test Loss: 0.531 Test Acc: 0.917
Validation loss decreased (inf --> -0.916661).  Saving model ...
Epoch: 2 cost time: 1.4510517120361328
Epoch: 2, Steps: 18 | Train Loss: 0.189 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.916661 --> -0.973332).  Saving model ...
Epoch: 3 cost time: 1.6660211086273193
Epoch: 3, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3939597606658936
Epoch: 4, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3251726627349854
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.464590311050415
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.4603750705718994
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2487080097198486
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.506591796875
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5607187747955322
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6257941722869873
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7378098964691162
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5262157917022705
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.578721284866333
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6221725940704346
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7402896881103516
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1270657
model size : 9.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.809664726257324
Epoch: 1, Steps: 18 | Train Loss: 2.671 Vali Loss: 1.245 Vali Acc: 0.840 Test Loss: 1.245 Test Acc: 0.840
Validation loss decreased (inf --> -0.839988).  Saving model ...
Epoch: 2 cost time: 1.9909508228302002
Epoch: 2, Steps: 18 | Train Loss: 0.559 Vali Loss: 0.210 Vali Acc: 0.960 Test Loss: 0.210 Test Acc: 0.960
Validation loss decreased (-0.839988 --> -0.959998).  Saving model ...
Epoch: 3 cost time: 1.723113775253296
Epoch: 3, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.155 Vali Acc: 0.953 Test Loss: 0.155 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7444419860839844
Epoch: 4, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.959998 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.8110570907592773
Epoch: 5, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.6438357830047607
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7017765045166016
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.7421607971191406
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.4524140357971191
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4828684329986572
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3843371868133545
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5798885822296143
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.7943639755249023
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7237563133239746
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5910520553588867
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.5969891548156738
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 1.575495958328247
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4739878177642822
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3829421997070312
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3249361515045166
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.635627269744873
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.666623830795288
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5539608001708984
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.379850149154663
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7238926887512207
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5562124252319336
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1585665
model size : 8.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.453382968902588
Epoch: 1, Steps: 18 | Train Loss: 2.675 Vali Loss: 1.229 Vali Acc: 0.853 Test Loss: 1.229 Test Acc: 0.853
Validation loss decreased (inf --> -0.853321).  Saving model ...
Epoch: 2 cost time: 1.533928632736206
Epoch: 2, Steps: 18 | Train Loss: 0.552 Vali Loss: 0.202 Vali Acc: 0.960 Test Loss: 0.202 Test Acc: 0.960
Validation loss decreased (-0.853321 --> -0.959998).  Saving model ...
Epoch: 3 cost time: 1.6162021160125732
Epoch: 3, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 4 cost time: 1.5905351638793945
Epoch: 4, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.959998 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.5505523681640625
Epoch: 5, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.683748722076416
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4313709735870361
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.6391212940216064
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.548675298690796
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.6568832397460938
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.6467454433441162
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.745086431503296
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.599928617477417
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.635972261428833
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7351272106170654
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.7274253368377686
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.526219129562378
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.541323184967041
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5657715797424316
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6949539184570312
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5848796367645264
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5664594173431396
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.41660737991333
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.562013864517212
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.616835594177246
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1585665
model size : 8.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2729928493499756
Epoch: 1, Steps: 18 | Train Loss: 2.666 Vali Loss: 1.214 Vali Acc: 0.873 Test Loss: 1.214 Test Acc: 0.873
Validation loss decreased (inf --> -0.873321).  Saving model ...
Epoch: 2 cost time: 1.5254998207092285
Epoch: 2, Steps: 18 | Train Loss: 0.548 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
Validation loss decreased (-0.873321 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 1.4743216037750244
Epoch: 3, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4339556694030762
Epoch: 4, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.4179866313934326
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.4557876586914062
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.5638198852539062
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.5785491466522217
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.532515287399292
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.499974250793457
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.711176872253418
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6329982280731201
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6266241073608398
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4601261615753174
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.542126178741455
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6686089038848877
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.6667485237121582
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6385738849639893
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7386417388916016
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.592257022857666
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6399893760681152
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6419217586517334
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8545618057250977
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7865574359893799
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7917115688323975
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8144915103912354
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1585665
model size : 8.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.3316333293914795
Epoch: 1, Steps: 18 | Train Loss: 2.651 Vali Loss: 1.253 Vali Acc: 0.887 Test Loss: 1.253 Test Acc: 0.887
Validation loss decreased (inf --> -0.886654).  Saving model ...
Epoch: 2 cost time: 1.4420835971832275
Epoch: 2, Steps: 18 | Train Loss: 0.578 Vali Loss: 0.219 Vali Acc: 0.963 Test Loss: 0.219 Test Acc: 0.963
Validation loss decreased (-0.886654 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 1.378483772277832
Epoch: 3, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 1.4303889274597168
Epoch: 4, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.3791942596435547
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.3012101650238037
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.327301263809204
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 8 cost time: 1.4145097732543945
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 1.542238712310791
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3950128555297852
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3103036880493164
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4496309757232666
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5618987083435059
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3195827007293701
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4049909114837646
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.427854299545288
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 1.4707694053649902
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4150373935699463
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3434412479400635
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4702064990997314
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.4332096576690674
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5804083347320557
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4587090015411377
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.70454740524292
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3882544040679932
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4291439056396484
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.437549352645874
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 1.4761996269226074
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4181740283966064
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 1.5595059394836426
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5504050254821777
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3639955520629883
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5443506240844727
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 1.5311503410339355
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.370175838470459
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3413527011871338
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3607444763183594
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 1.3351409435272217
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.7632777690887451
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.6252708435058594
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.5924804210662842
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.5882604122161865
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.6022133827209473
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.643876075744629
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.433934211730957
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.4753127098083496
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.2499964237213135
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1585665
model size : 8.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.766718626022339
Epoch: 1, Steps: 18 | Train Loss: 2.671 Vali Loss: 1.231 Vali Acc: 0.920 Test Loss: 1.231 Test Acc: 0.920
Validation loss decreased (inf --> -0.919988).  Saving model ...
Epoch: 2 cost time: 1.8696539402008057
Epoch: 2, Steps: 18 | Train Loss: 0.547 Vali Loss: 0.217 Vali Acc: 0.963 Test Loss: 0.217 Test Acc: 0.963
Validation loss decreased (-0.919988 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 1.680842638015747
Epoch: 3, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.963331 --> -0.983332).  Saving model ...
Epoch: 4 cost time: 1.6384501457214355
Epoch: 4, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6281850337982178
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6939868927001953
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 7 cost time: 1.5913331508636475
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 8 cost time: 1.4301836490631104
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 1.474550724029541
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 1.7481253147125244
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7577884197235107
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6115615367889404
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.570845603942871
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8085079193115234
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6815483570098877
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.465522289276123
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6469597816467285
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.805234670639038
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.842980146408081
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1061377
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.3971354961395264
Epoch: 1, Steps: 18 | Train Loss: 2.662 Vali Loss: 1.219 Vali Acc: 0.903 Test Loss: 1.219 Test Acc: 0.903
Validation loss decreased (inf --> -0.903321).  Saving model ...
Epoch: 2 cost time: 1.4642014503479004
Epoch: 2, Steps: 18 | Train Loss: 0.544 Vali Loss: 0.208 Vali Acc: 0.967 Test Loss: 0.208 Test Acc: 0.967
Validation loss decreased (-0.903321 --> -0.966665).  Saving model ...
Epoch: 3 cost time: 1.504225492477417
Epoch: 3, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.103 Vali Acc: 0.987 Test Loss: 0.103 Test Acc: 0.987
Validation loss decreased (-0.966665 --> -0.986666).  Saving model ...
Epoch: 4 cost time: 1.7081799507141113
Epoch: 4, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.800065279006958
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6443147659301758
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.581864356994629
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6518380641937256
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8353524208068848
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4882276058197021
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4644341468811035
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5986526012420654
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5852251052856445
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 1061377
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6085445880889893
Epoch: 1, Steps: 18 | Train Loss: 2.655 Vali Loss: 1.195 Vali Acc: 0.897 Test Loss: 1.195 Test Acc: 0.897
Validation loss decreased (inf --> -0.896655).  Saving model ...
Epoch: 2 cost time: 1.5462253093719482
Epoch: 2, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.201 Vali Acc: 0.970 Test Loss: 0.201 Test Acc: 0.970
Validation loss decreased (-0.896655 --> -0.969998).  Saving model ...
Epoch: 3 cost time: 1.4597058296203613
Epoch: 3, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.969998 --> -0.983332).  Saving model ...
Epoch: 4 cost time: 1.5178396701812744
Epoch: 4, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6174261569976807
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6417903900146484
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 7 cost time: 1.6117746829986572
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 8 cost time: 1.4875125885009766
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 1.7090604305267334
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 1.5979609489440918
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 1.495652437210083
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2818126678466797
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3533685207366943
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.651803731918335
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.507072925567627
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6350648403167725
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5775692462921143
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4427781105041504
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7894186973571777
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5633766651153564
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1061377
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.239136219024658
Epoch: 1, Steps: 18 | Train Loss: 2.684 Vali Loss: 1.255 Vali Acc: 0.877 Test Loss: 1.255 Test Acc: 0.877
Validation loss decreased (inf --> -0.876654).  Saving model ...
Epoch: 2 cost time: 1.670602798461914
Epoch: 2, Steps: 18 | Train Loss: 0.606 Vali Loss: 0.233 Vali Acc: 0.963 Test Loss: 0.233 Test Acc: 0.963
Validation loss decreased (-0.876654 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 1.5594029426574707
Epoch: 3, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
Validation loss decreased (-0.963331 --> -0.983332).  Saving model ...
Epoch: 4 cost time: 1.5560636520385742
Epoch: 4, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 1.5463624000549316
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.638230562210083
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5487494468688965
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6274960041046143
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5352866649627686
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.585324764251709
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 1.4834890365600586
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.630974531173706
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 1.73494553565979
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6304848194122314
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4849779605865479
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4963419437408447
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.66908597946167
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3795716762542725
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4796247482299805
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 1.344130516052246
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5705642700195312
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.725327730178833
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 1.5855376720428467
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.675595998764038
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5648672580718994
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 1.4721238613128662
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6404759883880615
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 1.6476850509643555
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5599119663238525
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5071570873260498
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5813701152801514
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5185699462890625
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.578160285949707
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6649000644683838
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.7945704460144043
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 1.7690789699554443
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 1.623405933380127
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5837078094482422
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.5860254764556885
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.6986067295074463
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.6518807411193848
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6286146640777588
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.5386383533477783
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.6276435852050781
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.64320969581604
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.809774398803711
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1061377
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.369878053665161
Epoch: 1, Steps: 18 | Train Loss: 2.751 Vali Loss: 1.269 Vali Acc: 0.910 Test Loss: 1.269 Test Acc: 0.910
Validation loss decreased (inf --> -0.909987).  Saving model ...
Epoch: 2 cost time: 1.8854038715362549
Epoch: 2, Steps: 18 | Train Loss: 0.578 Vali Loss: 0.204 Vali Acc: 0.963 Test Loss: 0.204 Test Acc: 0.963
Validation loss decreased (-0.909987 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 1.6832630634307861
Epoch: 3, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.8935518264770508
Epoch: 4, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.503053903579712
Epoch: 5, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.3222200870513916
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.118 Vali Acc: 0.960 Test Loss: 0.118 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.29288911819458
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.4647631645202637
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6438350677490234
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.5395541191101074
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6055524349212646
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3710103034973145
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7216136455535889
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7320849895477295
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6076710224151611
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.400808572769165
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6492884159088135
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6055364608764648
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.388761043548584
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.3280930519104004
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.657477855682373
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.4975974559783936
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3957247734069824
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.382955551147461
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.753046989440918
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5701651573181152
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.676966667175293
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.465709924697876
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7505722045898438
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6271181106567383
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6014468669891357
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 799233
model size : 5.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2754242420196533
Epoch: 1, Steps: 18 | Train Loss: 2.747 Vali Loss: 1.252 Vali Acc: 0.907 Test Loss: 1.252 Test Acc: 0.907
Validation loss decreased (inf --> -0.906654).  Saving model ...
Epoch: 2 cost time: 1.4046518802642822
Epoch: 2, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
Validation loss decreased (-0.906654 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 1.6965501308441162
Epoch: 3, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.5105557441711426
Epoch: 4, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.357818365097046
Epoch: 5, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.4571101665496826
Epoch: 6, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6777000427246094
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.626314401626587
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.665910243988037
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.5669879913330078
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6110196113586426
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5835466384887695
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4977402687072754
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5367786884307861
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6239898204803467
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.609722375869751
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.542283296585083
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3841073513031006
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.4896275997161865
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.5516386032104492
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4843194484710693
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.310556411743164
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5460615158081055
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5909907817840576
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.547283411026001
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.746894359588623
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6126747131347656
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6296679973602295
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4890532493591309
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5174999237060547
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3936097621917725
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 799233
model size : 5.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2241244316101074
Epoch: 1, Steps: 18 | Train Loss: 2.733 Vali Loss: 1.238 Vali Acc: 0.907 Test Loss: 1.238 Test Acc: 0.907
Validation loss decreased (inf --> -0.906654).  Saving model ...
Epoch: 2 cost time: 1.6871004104614258
Epoch: 2, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.199 Vali Acc: 0.960 Test Loss: 0.199 Test Acc: 0.960
Validation loss decreased (-0.906654 --> -0.959998).  Saving model ...
Epoch: 3 cost time: 1.5901858806610107
Epoch: 3, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 1.4709570407867432
Epoch: 4, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 1.483184576034546
Epoch: 5, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.7058954238891602
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.599097490310669
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.6482784748077393
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4234025478363037
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.679537296295166
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6166377067565918
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6066398620605469
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.607917070388794
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4838674068450928
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8182342052459717
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.568613052368164
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5184335708618164
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5616049766540527
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.5589497089385986
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.4159064292907715
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.3744964599609375
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.664252758026123
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4558675289154053
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1564533710479736
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1382496356964111
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2305328845977783
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.216944932937622
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4212946891784668
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5045092105865479
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5293190479278564
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4730494022369385
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 799233
model size : 5.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.0572524070739746
Epoch: 1, Steps: 18 | Train Loss: 2.717 Vali Loss: 1.291 Vali Acc: 0.880 Test Loss: 1.291 Test Acc: 0.880
Validation loss decreased (inf --> -0.879987).  Saving model ...
Epoch: 2 cost time: 1.417860984802246
Epoch: 2, Steps: 18 | Train Loss: 0.619 Vali Loss: 0.224 Vali Acc: 0.967 Test Loss: 0.224 Test Acc: 0.967
Validation loss decreased (-0.879987 --> -0.966664).  Saving model ...
Epoch: 3 cost time: 1.272855281829834
Epoch: 3, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.966664 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 1.3214657306671143
Epoch: 4, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3656046390533447
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.4466731548309326
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3596153259277344
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6046032905578613
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.6987411975860596
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.577326774597168
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4825546741485596
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.5385513305664062
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5065701007843018
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.549858570098877
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5317883491516113
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.3659605979919434
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.5810096263885498
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5674479007720947
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.5175950527191162
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.4127686023712158
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.425529956817627
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 1.4625742435455322
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 1.5433557033538818
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.4448671340942383
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3608217239379883
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3757171630859375
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4679265022277832
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3695881366729736
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3079559803009033
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.490471363067627
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.4677717685699463
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3899989128112793
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 1.328726053237915
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 1.2928338050842285
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3847839832305908
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4066507816314697
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.497725009918213
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.4048418998718262
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.4233369827270508
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.357551097869873
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.5496885776519775
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.4201054573059082
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.5110669136047363
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 799233
model size : 5.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.12729811668396
Epoch: 1, Steps: 18 | Train Loss: 2.760 Vali Loss: 1.271 Vali Acc: 0.917 Test Loss: 1.271 Test Acc: 0.917
Validation loss decreased (inf --> -0.916654).  Saving model ...
Epoch: 2 cost time: 1.2882356643676758
Epoch: 2, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.226 Vali Acc: 0.963 Test Loss: 0.226 Test Acc: 0.963
Validation loss decreased (-0.916654 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 1.4417245388031006
Epoch: 3, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976666).  Saving model ...
Epoch: 4 cost time: 1.3824214935302734
Epoch: 4, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6206176280975342
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.6753835678100586
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6790688037872314
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5259120464324951
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7006323337554932
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6754553318023682
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.48539400100708
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.536632776260376
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2894985675811768
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.732733964920044
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5350127220153809
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 668161
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.235612154006958
Epoch: 1, Steps: 18 | Train Loss: 2.739 Vali Loss: 1.241 Vali Acc: 0.920 Test Loss: 1.241 Test Acc: 0.920
Validation loss decreased (inf --> -0.919988).  Saving model ...
Epoch: 2 cost time: 1.5003314018249512
Epoch: 2, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.218 Vali Acc: 0.963 Test Loss: 0.218 Test Acc: 0.963
Validation loss decreased (-0.919988 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 1.4630749225616455
Epoch: 3, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976666).  Saving model ...
Epoch: 4 cost time: 1.492264747619629
Epoch: 4, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5576987266540527
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.503180742263794
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2387211322784424
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.570070743560791
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4372458457946777
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3849680423736572
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.358677625656128
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5338218212127686
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4548380374908447
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4194457530975342
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4277830123901367
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 668161
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.1276307106018066
Epoch: 1, Steps: 18 | Train Loss: 2.735 Vali Loss: 1.216 Vali Acc: 0.933 Test Loss: 1.216 Test Acc: 0.933
Validation loss decreased (inf --> -0.933321).  Saving model ...
Epoch: 2 cost time: 1.4882245063781738
Epoch: 2, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.206 Vali Acc: 0.967 Test Loss: 0.206 Test Acc: 0.967
Validation loss decreased (-0.933321 --> -0.966665).  Saving model ...
Epoch: 3 cost time: 1.4424879550933838
Epoch: 3, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.966665 --> -0.979999).  Saving model ...
Epoch: 4 cost time: 1.6966228485107422
Epoch: 4, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.57374906539917
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.4814174175262451
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4501476287841797
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.5897550582885742
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.6991384029388428
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.5194644927978516
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4751670360565186
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3617899417877197
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.837874412536621
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5011706352233887
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.535552978515625
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.636845588684082
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6713042259216309
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5382788181304932
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.625363826751709
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 668161
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6734836101531982
Epoch: 1, Steps: 18 | Train Loss: 2.785 Vali Loss: 1.304 Vali Acc: 0.927 Test Loss: 1.304 Test Acc: 0.927
Validation loss decreased (inf --> -0.926654).  Saving model ...
Epoch: 2 cost time: 1.8722186088562012
Epoch: 2, Steps: 18 | Train Loss: 0.650 Vali Loss: 0.237 Vali Acc: 0.963 Test Loss: 0.237 Test Acc: 0.963
Validation loss decreased (-0.926654 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 1.830322265625
Epoch: 3, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 1.6693518161773682
Epoch: 4, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.124 Vali Acc: 0.963 Test Loss: 0.124 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.65468430519104
Epoch: 5, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.9914515018463135
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.832914113998413
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.8463797569274902
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.9852921962738037
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 2.0407791137695312
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7628436088562012
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9704279899597168
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1393096446990967
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.251241445541382
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.040738582611084
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.099963903427124
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.135800361633301
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9882657527923584
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5623095035552979
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 668161
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.678650379180908
Epoch: 1, Steps: 18 | Train Loss: 2.777 Vali Loss: 1.284 Vali Acc: 0.907 Test Loss: 1.284 Test Acc: 0.907
Validation loss decreased (inf --> -0.906654).  Saving model ...
Epoch: 2 cost time: 1.7867763042449951
Epoch: 2, Steps: 18 | Train Loss: 0.585 Vali Loss: 0.231 Vali Acc: 0.967 Test Loss: 0.231 Test Acc: 0.967
Validation loss decreased (-0.906654 --> -0.966664).  Saving model ...
Epoch: 3 cost time: 2.221723794937134
Epoch: 3, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.966664 --> -0.979999).  Saving model ...
Epoch: 4 cost time: 2.440154790878296
Epoch: 4, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 2.8046607971191406
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.35149884223938
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1247692108154297
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 2.1753902435302734
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1616857051849365
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 2.5195066928863525
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 2.416797637939453
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0017669200897217
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.838822364807129
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 2.1385419368743896
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.3194215297698975
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1781821250915527
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.688912868499756
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.423506259918213
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.6180129051208496
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.2057597637176514
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8683867454528809
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5657410621643066
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.2279911041259766
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.005110025405884
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 602625
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.206179857254028
Epoch: 1, Steps: 18 | Train Loss: 2.768 Vali Loss: 1.260 Vali Acc: 0.887 Test Loss: 1.260 Test Acc: 0.887
Validation loss decreased (inf --> -0.886654).  Saving model ...
Epoch: 2 cost time: 1.8207929134368896
Epoch: 2, Steps: 18 | Train Loss: 0.573 Vali Loss: 0.228 Vali Acc: 0.967 Test Loss: 0.228 Test Acc: 0.967
Validation loss decreased (-0.886654 --> -0.966664).  Saving model ...
Epoch: 3 cost time: 2.2932074069976807
Epoch: 3, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.966664 --> -0.979999).  Saving model ...
Epoch: 4 cost time: 2.0730085372924805
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.950732707977295
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0825204849243164
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1779096126556396
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 2.1313154697418213
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9493308067321777
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1804611682891846
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.360769748687744
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.7479617595672607
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6779515743255615
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.7650387287139893
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.1800663471221924
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.350121021270752
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.016792058944702
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 602625
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.203948736190796
Epoch: 1, Steps: 18 | Train Loss: 2.778 Vali Loss: 1.231 Vali Acc: 0.897 Test Loss: 1.231 Test Acc: 0.897
Validation loss decreased (inf --> -0.896654).  Saving model ...
Epoch: 2 cost time: 1.9377286434173584
Epoch: 2, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.226 Vali Acc: 0.963 Test Loss: 0.226 Test Acc: 0.963
Validation loss decreased (-0.896654 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 1.842376470565796
Epoch: 3, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.963331 --> -0.979999).  Saving model ...
Epoch: 4 cost time: 2.027189254760742
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.698124408721924
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 2.419813871383667
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6839630603790283
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 2.6163952350616455
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 2.9779469966888428
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 2.81335711479187
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 2.7829065322875977
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.582340717315674
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.701497793197632
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 2.4946680068969727
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 1.844961166381836
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8412272930145264
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.975329875946045
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.1718223094940186
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9973986148834229
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9806199073791504
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.418919324874878
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.335897207260132
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.474252700805664
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.394782781600952
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 602625
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.9451355934143066
Epoch: 1, Steps: 18 | Train Loss: 2.802 Vali Loss: 1.316 Vali Acc: 0.903 Test Loss: 1.316 Test Acc: 0.903
Validation loss decreased (inf --> -0.903320).  Saving model ...
Epoch: 2 cost time: 1.6691884994506836
Epoch: 2, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.252 Vali Acc: 0.967 Test Loss: 0.252 Test Acc: 0.967
Validation loss decreased (-0.903320 --> -0.966664).  Saving model ...
Epoch: 3 cost time: 1.7562930583953857
Epoch: 3, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.732269525527954
Epoch: 4, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.811025857925415
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.6285407543182373
Epoch: 6, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.4538226127624512
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.5715010166168213
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.6836159229278564
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.8275103569030762
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0822174549102783
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6694145202636719
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.880103588104248
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.943329095840454
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.105077028274536
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.02013897895813
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8476543426513672
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9045445919036865
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.8693578243255615
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0306556224823
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.7246050834655762
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9717493057250977
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.127166986465454
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.2138683795928955
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.214904308319092
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.7610037326812744
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9885118007659912
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5344655513763428
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5010402202606201
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7943017482757568
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.9287123680114746
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.927795171737671
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.112513303756714
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.0829200744628906
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.778198003768921
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 602625
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.2272868156433105
Epoch: 1, Steps: 18 | Train Loss: 2.691 Vali Loss: 1.179 Vali Acc: 0.910 Test Loss: 1.179 Test Acc: 0.910
Validation loss decreased (inf --> -0.909988).  Saving model ...
Epoch: 2 cost time: 2.1180531978607178
Epoch: 2, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.195 Vali Acc: 0.970 Test Loss: 0.195 Test Acc: 0.970
Validation loss decreased (-0.909988 --> -0.969998).  Saving model ...
Epoch: 3 cost time: 1.8813986778259277
Epoch: 3, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.969998 --> -0.983332).  Saving model ...
Epoch: 4 cost time: 1.9898262023925781
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.100971221923828
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 2.42484974861145
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 7 cost time: 2.4375929832458496
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 8 cost time: 2.448875665664673
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 1.8380863666534424
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 1.7274045944213867
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 1.8030195236206055
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0625503063201904
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8416686058044434
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.234661817550659
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0228946208953857
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.263683319091797
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2563869953155518
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.2309627532958984
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.313640594482422
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.3947789669036865
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 569857
model size : 4.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.910489559173584
Epoch: 1, Steps: 18 | Train Loss: 2.677 Vali Loss: 1.166 Vali Acc: 0.933 Test Loss: 1.166 Test Acc: 0.933
Validation loss decreased (inf --> -0.933322).  Saving model ...
Epoch: 2 cost time: 2.059736490249634
Epoch: 2, Steps: 18 | Train Loss: 0.533 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
Validation loss decreased (-0.933322 --> -0.969998).  Saving model ...
Epoch: 3 cost time: 2.3869147300720215
Epoch: 3, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.969998 --> -0.983332).  Saving model ...
Epoch: 4 cost time: 2.4699485301971436
Epoch: 4, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.272010326385498
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 2.0535078048706055
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 7 cost time: 2.121295213699341
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 8 cost time: 2.6705846786499023
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 2.1739163398742676
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 2.135120153427124
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.182792901992798
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2178525924682617
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5316638946533203
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.218841314315796
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8289589881896973
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.676140546798706
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7123255729675293
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0788023471832275
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9080922603607178
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 569857
model size : 4.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5725018978118896
Epoch: 1, Steps: 18 | Train Loss: 2.671 Vali Loss: 1.155 Vali Acc: 0.927 Test Loss: 1.155 Test Acc: 0.927
Validation loss decreased (inf --> -0.926655).  Saving model ...
Epoch: 2 cost time: 2.112542152404785
Epoch: 2, Steps: 18 | Train Loss: 0.532 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
Validation loss decreased (-0.926655 --> -0.966665).  Saving model ...
Epoch: 3 cost time: 2.223271369934082
Epoch: 3, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.099 Vali Acc: 0.987 Test Loss: 0.099 Test Acc: 0.987
Validation loss decreased (-0.966665 --> -0.986666).  Saving model ...
Epoch: 4 cost time: 2.1748545169830322
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.296863079071045
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9948625564575195
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7756662368774414
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.007905960083008
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.228421926498413
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3084096908569336
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.0434484481811523
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8249971866607666
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.971440076828003
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 569857
model size : 4.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.8579277992248535
Epoch: 1, Steps: 18 | Train Loss: 2.681 Vali Loss: 1.233 Vali Acc: 0.917 Test Loss: 1.233 Test Acc: 0.917
Validation loss decreased (inf --> -0.916654).  Saving model ...
Epoch: 2 cost time: 1.4925732612609863
Epoch: 2, Steps: 18 | Train Loss: 0.598 Vali Loss: 0.222 Vali Acc: 0.963 Test Loss: 0.222 Test Acc: 0.963
Validation loss decreased (-0.916654 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 1.4966330528259277
Epoch: 3, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.963331 --> -0.983332).  Saving model ...
Epoch: 4 cost time: 1.5123424530029297
Epoch: 4, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8106520175933838
Epoch: 5, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5448508262634277
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 1.7006111145019531
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 8 cost time: 2.0139963626861572
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 2.1657907962799072
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 1.653454303741455
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 1.9488894939422607
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.094947576522827
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3834784030914307
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6905276775360107
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.977504014968872
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1305575370788574
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2283074855804443
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.1026175022125244
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8471615314483643
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.882950782775879
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 569857
model size : 4.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.942637205123901
Epoch: 1, Steps: 18 | Train Loss: 3.102 Vali Loss: 2.135 Vali Acc: 0.670 Test Loss: 2.135 Test Acc: 0.670
Validation loss decreased (inf --> -0.669979).  Saving model ...
Epoch: 2 cost time: 2.488908290863037
Epoch: 2, Steps: 18 | Train Loss: 1.302 Vali Loss: 0.573 Vali Acc: 0.960 Test Loss: 0.573 Test Acc: 0.960
Validation loss decreased (-0.669979 --> -0.959994).  Saving model ...
Epoch: 3 cost time: 2.064401149749756
Epoch: 3, Steps: 18 | Train Loss: 0.278 Vali Loss: 0.193 Vali Acc: 0.970 Test Loss: 0.193 Test Acc: 0.970
Validation loss decreased (-0.959994 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 1.7480669021606445
Epoch: 4, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.5717978477478027
Epoch: 5, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.8541128635406494
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 2.289965867996216
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.9958510398864746
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 2.161181688308716
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1023428440093994
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4301700592041016
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 2.2985708713531494
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 1.9138097763061523
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 2.2461860179901123
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 2.2315104007720947
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 2.407566785812378
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5651233196258545
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4635143280029297
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.684727191925049
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.282607316970825
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9669506549835205
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.766371250152588
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8105902671813965
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.269896984100342
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9552974700927734
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 776513
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.472981929779053
Epoch: 1, Steps: 18 | Train Loss: 3.087 Vali Loss: 2.103 Vali Acc: 0.683 Test Loss: 2.103 Test Acc: 0.683
Validation loss decreased (inf --> -0.683312).  Saving model ...
Epoch: 2 cost time: 2.507394790649414
Epoch: 2, Steps: 18 | Train Loss: 1.298 Vali Loss: 0.550 Vali Acc: 0.960 Test Loss: 0.550 Test Acc: 0.960
Validation loss decreased (-0.683312 --> -0.959995).  Saving model ...
Epoch: 3 cost time: 2.8168978691101074
Epoch: 3, Steps: 18 | Train Loss: 0.274 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
Validation loss decreased (-0.959995 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 2.519685983657837
Epoch: 4, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 2.425333261489868
Epoch: 5, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 2.5519704818725586
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 2.4825069904327393
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.9892077445983887
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 2.3971760272979736
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 2.2959821224212646
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3572325706481934
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 2.231842279434204
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9830718040466309
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 2.2647953033447266
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 1.8137295246124268
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 2.212435007095337
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.120870351791382
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7167744636535645
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8609857559204102
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9186732769012451
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 2.4294838905334473
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 2.577622652053833
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.607262134552002
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 2.429177761077881
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 2.364999771118164
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8738417625427246
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0390465259552
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0674445629119873
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.147768497467041
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.4471962451934814
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.180126905441284
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.137925863265991
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.9584593772888184
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.229135274887085
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 776513
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.520777702331543
Epoch: 1, Steps: 18 | Train Loss: 3.090 Vali Loss: 2.094 Vali Acc: 0.707 Test Loss: 2.094 Test Acc: 0.707
Validation loss decreased (inf --> -0.706646).  Saving model ...
Epoch: 2 cost time: 1.5042691230773926
Epoch: 2, Steps: 18 | Train Loss: 1.280 Vali Loss: 0.537 Vali Acc: 0.963 Test Loss: 0.537 Test Acc: 0.963
Validation loss decreased (-0.706646 --> -0.963328).  Saving model ...
Epoch: 3 cost time: 1.7015678882598877
Epoch: 3, Steps: 18 | Train Loss: 0.275 Vali Loss: 0.183 Vali Acc: 0.967 Test Loss: 0.183 Test Acc: 0.967
Validation loss decreased (-0.963328 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.6358697414398193
Epoch: 4, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.966665 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.9391241073608398
Epoch: 5, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.8089406490325928
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 2.2906086444854736
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 8 cost time: 2.0047719478607178
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 1.8646018505096436
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 2.00005841255188
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9972410202026367
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1643903255462646
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2276859283447266
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3714911937713623
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4193222522735596
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 1.8219316005706787
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9259860515594482
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.879472255706787
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.017782211303711
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.204840660095215
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.405773401260376
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4830706119537354
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.203441858291626
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.1926465034484863
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0336616039276123
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 776513
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.575507879257202
Epoch: 1, Steps: 18 | Train Loss: 3.071 Vali Loss: 2.110 Vali Acc: 0.710 Test Loss: 2.110 Test Acc: 0.710
Validation loss decreased (inf --> -0.709979).  Saving model ...
Epoch: 2 cost time: 1.3843669891357422
Epoch: 2, Steps: 18 | Train Loss: 1.322 Vali Loss: 0.594 Vali Acc: 0.950 Test Loss: 0.594 Test Acc: 0.950
Validation loss decreased (-0.709979 --> -0.949994).  Saving model ...
Epoch: 3 cost time: 1.5508136749267578
Epoch: 3, Steps: 18 | Train Loss: 0.312 Vali Loss: 0.199 Vali Acc: 0.960 Test Loss: 0.199 Test Acc: 0.960
Validation loss decreased (-0.949994 --> -0.959998).  Saving model ...
Epoch: 4 cost time: 1.7142624855041504
Epoch: 4, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.959998 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 1.7473664283752441
Epoch: 5, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.9041469097137451
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.045652151107788
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 8 cost time: 1.8931176662445068
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 2.0066096782684326
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 1.9757773876190186
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.023306131362915
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 2.0034494400024414
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 2.219759464263916
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 2.303717613220215
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 2.175072431564331
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 1.7261600494384766
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 1.6018025875091553
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 1.708258867263794
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.5692112445831299
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 1.7696032524108887
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 2.2355003356933594
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 2.1957173347473145
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8328917026519775
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.6970188617706299
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 1.5788018703460693
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5037381649017334
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.047435760498047
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.992802619934082
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.348414659500122
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 2.122673988342285
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 2.253218650817871
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 2.0813307762145996
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 2.1381595134735107
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 1.6251881122589111
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 2.031271457672119
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 2.1100099086761475
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.2818403244018555
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.2656731605529785
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.1967246532440186
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.1836392879486084
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.2502338886260986
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.40083646774292
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.2625339031219482
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.3418471813201904
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.2640316486358643
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 776513
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.24131965637207
Epoch: 1, Steps: 18 | Train Loss: 2.990 Vali Loss: 2.038 Vali Acc: 0.670 Test Loss: 2.038 Test Acc: 0.670
Validation loss decreased (inf --> -0.669980).  Saving model ...
Epoch: 2 cost time: 1.6625216007232666
Epoch: 2, Steps: 18 | Train Loss: 1.249 Vali Loss: 0.561 Vali Acc: 0.960 Test Loss: 0.561 Test Acc: 0.960
Validation loss decreased (-0.669980 --> -0.959994).  Saving model ...
Epoch: 3 cost time: 2.0293757915496826
Epoch: 3, Steps: 18 | Train Loss: 0.301 Vali Loss: 0.198 Vali Acc: 0.967 Test Loss: 0.198 Test Acc: 0.967
Validation loss decreased (-0.959994 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 2.021775960922241
Epoch: 4, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.8572108745574951
Epoch: 5, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 2.1883373260498047
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 2.023913860321045
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 2.4793858528137207
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 2.554234504699707
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4311113357543945
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.012294292449951
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.736341953277588
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8319530487060547
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6937742233276367
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8526010513305664
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0861940383911133
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1104116439819336
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8787586688995361
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 514369
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.388651132583618
Epoch: 1, Steps: 18 | Train Loss: 2.986 Vali Loss: 2.020 Vali Acc: 0.670 Test Loss: 2.020 Test Acc: 0.670
Validation loss decreased (inf --> -0.669980).  Saving model ...
Epoch: 2 cost time: 2.0543863773345947
Epoch: 2, Steps: 18 | Train Loss: 1.238 Vali Loss: 0.542 Vali Acc: 0.960 Test Loss: 0.542 Test Acc: 0.960
Validation loss decreased (-0.669980 --> -0.959995).  Saving model ...
Epoch: 3 cost time: 1.9567694664001465
Epoch: 3, Steps: 18 | Train Loss: 0.289 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
Validation loss decreased (-0.959995 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.923795461654663
Epoch: 4, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.966665 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.875786542892456
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8150615692138672
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.4383869171142578
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.5492143630981445
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.8955514430999756
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.7279937267303467
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.238410472869873
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.259645462036133
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.278163433074951
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.4429287910461426
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.469390869140625
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7069990634918213
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.663519859313965
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.6902222633361816
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.3350634574890137
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 514369
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.8429324626922607
Epoch: 1, Steps: 18 | Train Loss: 2.973 Vali Loss: 2.004 Vali Acc: 0.700 Test Loss: 2.004 Test Acc: 0.700
Validation loss decreased (inf --> -0.699980).  Saving model ...
Epoch: 2 cost time: 1.7399091720581055
Epoch: 2, Steps: 18 | Train Loss: 1.227 Vali Loss: 0.527 Vali Acc: 0.953 Test Loss: 0.527 Test Acc: 0.953
Validation loss decreased (-0.699980 --> -0.953328).  Saving model ...
Epoch: 3 cost time: 2.1852710247039795
Epoch: 3, Steps: 18 | Train Loss: 0.285 Vali Loss: 0.183 Vali Acc: 0.967 Test Loss: 0.183 Test Acc: 0.967
Validation loss decreased (-0.953328 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.946925163269043
Epoch: 4, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.966665 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.8197598457336426
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.650580644607544
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.59464693069458
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7725486755371094
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.8909790515899658
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 2.0924696922302246
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9339780807495117
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0126054286956787
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9525389671325684
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 2.058513879776001
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8099408149719238
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.58125638961792
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9187378883361816
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9106230735778809
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8144793510437012
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.967545986175537
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.085313081741333
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.834160327911377
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.9488348960876465
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.8305997848510742
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5543508529663086
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6135597229003906
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7170460224151611
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.2713370323181152
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.175422191619873
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.620725154876709
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.002302646636963
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.009606122970581
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.9270694255828857
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 514369
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.970855951309204
Epoch: 1, Steps: 18 | Train Loss: 3.030 Vali Loss: 2.089 Vali Acc: 0.650 Test Loss: 2.089 Test Acc: 0.650
Validation loss decreased (inf --> -0.649979).  Saving model ...
Epoch: 2 cost time: 1.9733083248138428
Epoch: 2, Steps: 18 | Train Loss: 1.333 Vali Loss: 0.606 Vali Acc: 0.957 Test Loss: 0.606 Test Acc: 0.957
Validation loss decreased (-0.649979 --> -0.956661).  Saving model ...
Epoch: 3 cost time: 2.0173943042755127
Epoch: 3, Steps: 18 | Train Loss: 0.339 Vali Loss: 0.210 Vali Acc: 0.970 Test Loss: 0.210 Test Acc: 0.970
Validation loss decreased (-0.956661 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 1.874549150466919
Epoch: 4, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 2.123054027557373
Epoch: 5, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.872727870941162
Epoch: 6, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.9415042400360107
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.936032772064209
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.005354881286621
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.034430503845215
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 2.100125312805176
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 12 cost time: 1.9066967964172363
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 13 cost time: 1.896521806716919
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 14 cost time: 1.5246872901916504
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.861903429031372
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.987 Test Loss: 0.075 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 16 cost time: 1.4122238159179688
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.987 Test Loss: 0.075 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 17 cost time: 1.7129523754119873
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.987 Test Loss: 0.075 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5952305793762207
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 19 cost time: 1.7981457710266113
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9740855693817139
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 21 cost time: 1.9055945873260498
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9174864292144775
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8349361419677734
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.888216257095337
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.780226230621338
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6285395622253418
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8319015502929688
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7182972431182861
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9223692417144775
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7481491565704346
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 514369
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.605685710906982
Epoch: 1, Steps: 18 | Train Loss: 3.029 Vali Loss: 2.102 Vali Acc: 0.633 Test Loss: 2.102 Test Acc: 0.633
Validation loss decreased (inf --> -0.633312).  Saving model ...
Epoch: 2 cost time: 1.9426054954528809
Epoch: 2, Steps: 18 | Train Loss: 1.300 Vali Loss: 0.590 Vali Acc: 0.970 Test Loss: 0.590 Test Acc: 0.970
Validation loss decreased (-0.633312 --> -0.969994).  Saving model ...
Epoch: 3 cost time: 2.040473699569702
Epoch: 3, Steps: 18 | Train Loss: 0.292 Vali Loss: 0.226 Vali Acc: 0.953 Test Loss: 0.226 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8644564151763916
Epoch: 4, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.969994 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 1.8594930171966553
Epoch: 5, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.987 Test Loss: 0.098 Test Acc: 0.987
Validation loss decreased (-0.976665 --> -0.986666).  Saving model ...
Epoch: 6 cost time: 1.9853606224060059
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.987 Test Loss: 0.090 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 7 cost time: 1.7396376132965088
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.987 Test Loss: 0.085 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 8 cost time: 1.7684438228607178
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8663032054901123
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6008927822113037
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.340716600418091
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5774238109588623
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9891421794891357
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3852243423461914
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9964754581451416
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.080535411834717
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.4794328212738037
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 383297
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.3940510749816895
Epoch: 1, Steps: 18 | Train Loss: 3.026 Vali Loss: 2.094 Vali Acc: 0.643 Test Loss: 2.094 Test Acc: 0.643
Validation loss decreased (inf --> -0.643312).  Saving model ...
Epoch: 2 cost time: 2.2413740158081055
Epoch: 2, Steps: 18 | Train Loss: 1.280 Vali Loss: 0.578 Vali Acc: 0.970 Test Loss: 0.578 Test Acc: 0.970
Validation loss decreased (-0.643312 --> -0.969994).  Saving model ...
Epoch: 3 cost time: 2.145839214324951
Epoch: 3, Steps: 18 | Train Loss: 0.283 Vali Loss: 0.217 Vali Acc: 0.953 Test Loss: 0.217 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9320228099822998
Epoch: 4, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.969994 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 1.6905102729797363
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.096 Vali Acc: 0.987 Test Loss: 0.096 Test Acc: 0.987
Validation loss decreased (-0.976665 --> -0.986666).  Saving model ...
Epoch: 6 cost time: 1.7805371284484863
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9550728797912598
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 8 cost time: 2.5818655490875244
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5665016174316406
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9868669509887695
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8948781490325928
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9696106910705566
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8472449779510498
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.879380702972412
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0074963569641113
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 16 cost time: 2.1533689498901367
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.206815004348755
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.354386568069458
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.4546866416931152
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.987 Test Loss: 0.075 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 20 cost time: 2.466374158859253
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.987 Test Loss: 0.075 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 21 cost time: 2.0579380989074707
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8331022262573242
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9043796062469482
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.141143560409546
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.987 Test Loss: 0.075 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.439521551132202
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.2947323322296143
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.191892385482788
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.545819044113159
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.6657047271728516
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.8877601623535156
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 383297
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.7599246501922607
Epoch: 1, Steps: 18 | Train Loss: 3.026 Vali Loss: 2.085 Vali Acc: 0.647 Test Loss: 2.085 Test Acc: 0.647
Validation loss decreased (inf --> -0.646646).  Saving model ...
Epoch: 2 cost time: 1.5387601852416992
Epoch: 2, Steps: 18 | Train Loss: 1.289 Vali Loss: 0.572 Vali Acc: 0.977 Test Loss: 0.572 Test Acc: 0.977
Validation loss decreased (-0.646646 --> -0.976661).  Saving model ...
Epoch: 3 cost time: 1.4896373748779297
Epoch: 3, Steps: 18 | Train Loss: 0.289 Vali Loss: 0.208 Vali Acc: 0.960 Test Loss: 0.208 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5447776317596436
Epoch: 4, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.785032033920288
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
Validation loss decreased (-0.976661 --> -0.986666).  Saving model ...
Epoch: 6 cost time: 1.500258445739746
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 7 cost time: 1.5676729679107666
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 8 cost time: 1.6927106380462646
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.987 Test Loss: 0.085 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.901799201965332
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.617476224899292
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 11 cost time: 1.9180829524993896
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8360636234283447
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7527515888214111
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 14 cost time: 1.7850704193115234
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.767199993133545
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 16 cost time: 1.8071393966674805
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 17 cost time: 1.7745418548583984
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.749936580657959
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 19 cost time: 1.8607101440429688
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.987 Test Loss: 0.077 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 20 cost time: 1.7027287483215332
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.987 Test Loss: 0.077 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 21 cost time: 1.5549523830413818
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 22 cost time: 1.5395925045013428
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 23 cost time: 1.46685791015625
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4050116539001465
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.987 Test Loss: 0.077 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1994900703430176
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.987 Test Loss: 0.077 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7931103706359863
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5921132564544678
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7729072570800781
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.665912389755249
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.987 Test Loss: 0.077 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6837334632873535
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.66420578956604
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.8483986854553223
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 383297
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.955415964126587
Epoch: 1, Steps: 18 | Train Loss: 3.017 Vali Loss: 2.137 Vali Acc: 0.660 Test Loss: 2.137 Test Acc: 0.660
Validation loss decreased (inf --> -0.659979).  Saving model ...
Epoch: 2 cost time: 1.9096994400024414
Epoch: 2, Steps: 18 | Train Loss: 1.366 Vali Loss: 0.645 Vali Acc: 0.960 Test Loss: 0.645 Test Acc: 0.960
Validation loss decreased (-0.659979 --> -0.959994).  Saving model ...
Epoch: 3 cost time: 1.5848491191864014
Epoch: 3, Steps: 18 | Train Loss: 0.346 Vali Loss: 0.239 Vali Acc: 0.953 Test Loss: 0.239 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.556516408920288
Epoch: 4, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
Validation loss decreased (-0.959994 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 1.576220989227295
Epoch: 5, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.100 Vali Acc: 0.987 Test Loss: 0.100 Test Acc: 0.987
Validation loss decreased (-0.976665 --> -0.986666).  Saving model ...
Epoch: 6 cost time: 1.9268333911895752
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 7 cost time: 1.777576208114624
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.987 Test Loss: 0.086 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 8 cost time: 1.8346409797668457
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.987 Test Loss: 0.086 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8220460414886475
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 10 cost time: 1.790562629699707
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 11 cost time: 1.804992914199829
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8234977722167969
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 13 cost time: 1.6818900108337402
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 14 cost time: 1.714599609375
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 15 cost time: 1.7955472469329834
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8654437065124512
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5611045360565186
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8524515628814697
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.805891990661621
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.987 Test Loss: 0.075 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 20 cost time: 1.5356457233428955
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 21 cost time: 1.721566915512085
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 22 cost time: 1.693256139755249
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4051933288574219
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.987 Test Loss: 0.075 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.538358211517334
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6111528873443604
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.987 Test Loss: 0.075 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4696223735809326
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4453976154327393
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 28 cost time: 1.7106387615203857
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 29 cost time: 1.6315734386444092
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 30 cost time: 1.7673008441925049
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 31 cost time: 1.7985122203826904
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.737739086151123
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.823202133178711
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8331527709960938
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6687519550323486
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.602919101715088
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 37 cost time: 1.570474624633789
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5748310089111328
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.5612826347351074
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.4707608222961426
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.4372754096984863
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.591094970703125
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.7431445121765137
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.7908642292022705
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.8199024200439453
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.7917842864990234
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 383297
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.4617276191711426
Epoch: 1, Steps: 18 | Train Loss: 3.151 Vali Loss: 2.119 Vali Acc: 0.667 Test Loss: 2.119 Test Acc: 0.667
Validation loss decreased (inf --> -0.666645).  Saving model ...
Epoch: 2 cost time: 1.8047451972961426
Epoch: 2, Steps: 18 | Train Loss: 1.268 Vali Loss: 0.578 Vali Acc: 0.957 Test Loss: 0.578 Test Acc: 0.957
Validation loss decreased (-0.666645 --> -0.956661).  Saving model ...
Epoch: 3 cost time: 1.7622389793395996
Epoch: 3, Steps: 18 | Train Loss: 0.312 Vali Loss: 0.195 Vali Acc: 0.977 Test Loss: 0.195 Test Acc: 0.977
Validation loss decreased (-0.956661 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 2.2967779636383057
Epoch: 4, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.103 Vali Acc: 0.987 Test Loss: 0.103 Test Acc: 0.987
Validation loss decreased (-0.976665 --> -0.986666).  Saving model ...
Epoch: 5 cost time: 2.095486640930176
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9995410442352295
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2479543685913086
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8970398902893066
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8443291187286377
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.824171781539917
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.869847059249878
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8919782638549805
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.016179323196411
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.5846147537231445
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 317761
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.014731168746948
Epoch: 1, Steps: 18 | Train Loss: 3.124 Vali Loss: 2.103 Vali Acc: 0.707 Test Loss: 2.103 Test Acc: 0.707
Validation loss decreased (inf --> -0.706646).  Saving model ...
Epoch: 2 cost time: 2.0326874256134033
Epoch: 2, Steps: 18 | Train Loss: 1.259 Vali Loss: 0.567 Vali Acc: 0.957 Test Loss: 0.567 Test Acc: 0.957
Validation loss decreased (-0.706646 --> -0.956661).  Saving model ...
Epoch: 3 cost time: 1.7083215713500977
Epoch: 3, Steps: 18 | Train Loss: 0.301 Vali Loss: 0.194 Vali Acc: 0.977 Test Loss: 0.194 Test Acc: 0.977
Validation loss decreased (-0.956661 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 1.8844659328460693
Epoch: 4, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.104 Vali Acc: 0.987 Test Loss: 0.104 Test Acc: 0.987
Validation loss decreased (-0.976665 --> -0.986666).  Saving model ...
Epoch: 5 cost time: 2.067641258239746
Epoch: 5, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 6 cost time: 2.097203493118286
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.287584066390991
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.932455062866211
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 9 cost time: 1.7757184505462646
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8849749565124512
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9479618072509766
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9577875137329102
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 13 cost time: 2.196080207824707
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9668645858764648
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9513497352600098
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.830770492553711
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.944286584854126
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.66579270362854
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.836900234222412
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7793536186218262
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9801230430603027
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.276808261871338
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 317761
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.508429527282715
Epoch: 1, Steps: 18 | Train Loss: 3.115 Vali Loss: 2.083 Vali Acc: 0.723 Test Loss: 2.083 Test Acc: 0.723
Validation loss decreased (inf --> -0.723313).  Saving model ...
Epoch: 2 cost time: 1.530806303024292
Epoch: 2, Steps: 18 | Train Loss: 1.254 Vali Loss: 0.550 Vali Acc: 0.967 Test Loss: 0.550 Test Acc: 0.967
Validation loss decreased (-0.723313 --> -0.966661).  Saving model ...
Epoch: 3 cost time: 1.8187246322631836
Epoch: 3, Steps: 18 | Train Loss: 0.292 Vali Loss: 0.190 Vali Acc: 0.973 Test Loss: 0.190 Test Acc: 0.973
Validation loss decreased (-0.966661 --> -0.973331).  Saving model ...
Epoch: 4 cost time: 1.6090657711029053
Epoch: 4, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.973331 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 1.9185371398925781
Epoch: 5, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7050092220306396
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9546067714691162
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 8 cost time: 1.9149723052978516
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 2.0408177375793457
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 2.108264207839966
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 1.8196766376495361
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 1.7903106212615967
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 1.6310875415802002
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 1.9600529670715332
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7984466552734375
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6751344203948975
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5908961296081543
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0940825939178467
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.036010980606079
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.075975179672241
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.803131341934204
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7074682712554932
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7988083362579346
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 317761
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.569868564605713
Epoch: 1, Steps: 18 | Train Loss: 3.105 Vali Loss: 2.115 Vali Acc: 0.680 Test Loss: 2.115 Test Acc: 0.680
Validation loss decreased (inf --> -0.679979).  Saving model ...
Epoch: 2 cost time: 1.6847500801086426
Epoch: 2, Steps: 18 | Train Loss: 1.330 Vali Loss: 0.614 Vali Acc: 0.960 Test Loss: 0.614 Test Acc: 0.960
Validation loss decreased (-0.679979 --> -0.959994).  Saving model ...
Epoch: 3 cost time: 1.6853818893432617
Epoch: 3, Steps: 18 | Train Loss: 0.356 Vali Loss: 0.213 Vali Acc: 0.980 Test Loss: 0.213 Test Acc: 0.980
Validation loss decreased (-0.959994 --> -0.979998).  Saving model ...
Epoch: 4 cost time: 1.6916966438293457
Epoch: 4, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.109 Vali Acc: 0.987 Test Loss: 0.109 Test Acc: 0.987
Validation loss decreased (-0.979998 --> -0.986666).  Saving model ...
Epoch: 5 cost time: 1.7563347816467285
Epoch: 5, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.092 Vali Acc: 0.987 Test Loss: 0.092 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 6 cost time: 1.5587217807769775
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.987 Test Loss: 0.086 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 7 cost time: 1.7664413452148438
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7502543926239014
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.075 Vali Acc: 0.987 Test Loss: 0.075 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 9 cost time: 1.383744716644287
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5156755447387695
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3959007263183594
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 12 cost time: 1.8380625247955322
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.775890588760376
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.980163335800171
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8817377090454102
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 16 cost time: 1.65647292137146
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 17 cost time: 1.7282781600952148
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 18 cost time: 1.8367841243743896
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 19 cost time: 1.6338846683502197
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7523837089538574
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 21 cost time: 1.6484973430633545
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 22 cost time: 1.878903865814209
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 23 cost time: 2.3096187114715576
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9748308658599854
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 25 cost time: 1.8204760551452637
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7505722045898438
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 27 cost time: 2.095736026763916
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0255234241485596
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1343486309051514
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 30 cost time: 1.8501901626586914
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7512593269348145
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.769857406616211
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.8375632762908936
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 34 cost time: 1.6547818183898926
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 35 cost time: 1.901923418045044
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.065403699874878
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7452754974365234
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.8299682140350342
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.8302133083343506
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.8975005149841309
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.8656642436981201
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.6629621982574463
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.9346022605895996
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.9453377723693848
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 317761
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.936044692993164
Epoch: 1, Steps: 18 | Train Loss: 2.967 Vali Loss: 2.036 Vali Acc: 0.733 Test Loss: 2.036 Test Acc: 0.733
Validation loss decreased (inf --> -0.733313).  Saving model ...
Epoch: 2 cost time: 1.6994311809539795
Epoch: 2, Steps: 18 | Train Loss: 1.229 Vali Loss: 0.573 Vali Acc: 0.953 Test Loss: 0.573 Test Acc: 0.953
Validation loss decreased (-0.733313 --> -0.953328).  Saving model ...
Epoch: 3 cost time: 1.6208105087280273
Epoch: 3, Steps: 18 | Train Loss: 0.261 Vali Loss: 0.183 Vali Acc: 0.973 Test Loss: 0.183 Test Acc: 0.973
Validation loss decreased (-0.953328 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 2.1531569957733154
Epoch: 4, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 2.198702812194824
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.973332 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.996500015258789
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 1.9512543678283691
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.8012192249298096
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.9923357963562012
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 2.145831346511841
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 2.079738140106201
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7300119400024414
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.090637445449829
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 2.1144118309020996
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 2.298398733139038
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 1.8264062404632568
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 1.6201553344726562
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 1.7248103618621826
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 2.4222543239593506
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.199969530105591
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.791306972503662
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7653841972351074
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1261019706726074
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.251678943634033
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.5856897830963135
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.0307857990264893
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.986304759979248
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.4629900455474854
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 284993
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.145179271697998
Epoch: 1, Steps: 18 | Train Loss: 2.963 Vali Loss: 2.020 Vali Acc: 0.723 Test Loss: 2.020 Test Acc: 0.723
Validation loss decreased (inf --> -0.723313).  Saving model ...
Epoch: 2 cost time: 2.2697882652282715
Epoch: 2, Steps: 18 | Train Loss: 1.217 Vali Loss: 0.558 Vali Acc: 0.963 Test Loss: 0.558 Test Acc: 0.963
Validation loss decreased (-0.723313 --> -0.963328).  Saving model ...
Epoch: 3 cost time: 2.0107743740081787
Epoch: 3, Steps: 18 | Train Loss: 0.260 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
Validation loss decreased (-0.963328 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 1.8955094814300537
Epoch: 4, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9752469062805176
Epoch: 5, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.969998 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.5642809867858887
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 1.746664047241211
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.6900832653045654
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.9267184734344482
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 2.222083568572998
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 2.5506882667541504
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9852135181427002
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7667737007141113
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 2.1111466884613037
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 2.254148244857788
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 1.977475881576538
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 1.7591118812561035
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 1.7164371013641357
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 2.171231746673584
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 2.2051122188568115
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9089813232421875
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5843193531036377
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7268784046173096
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.330078601837158
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.343679666519165
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0739166736602783
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8836376667022705
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.9376482963562012
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.152771472930908
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 284993
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.115158319473267
Epoch: 1, Steps: 18 | Train Loss: 2.951 Vali Loss: 2.012 Vali Acc: 0.720 Test Loss: 2.012 Test Acc: 0.720
Validation loss decreased (inf --> -0.719980).  Saving model ...
Epoch: 2 cost time: 2.02724552154541
Epoch: 2, Steps: 18 | Train Loss: 1.222 Vali Loss: 0.550 Vali Acc: 0.957 Test Loss: 0.550 Test Acc: 0.957
Validation loss decreased (-0.719980 --> -0.956661).  Saving model ...
Epoch: 3 cost time: 2.0288631916046143
Epoch: 3, Steps: 18 | Train Loss: 0.261 Vali Loss: 0.184 Vali Acc: 0.970 Test Loss: 0.184 Test Acc: 0.970
Validation loss decreased (-0.956661 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 1.8013083934783936
Epoch: 4, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7283265590667725
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 2.035749912261963
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 2.0676612854003906
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.867826223373413
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.072777271270752
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.979003667831421
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.977346658706665
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8478877544403076
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8214702606201172
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.573577642440796
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.863206148147583
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 1.7689707279205322
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 1.9236080646514893
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7988171577453613
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.8730096817016602
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9743070602416992
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8340516090393066
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7890632152557373
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.753222942352295
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9476702213287354
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7962877750396729
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.57252836227417
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.58754563331604
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.591181993484497
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 284993
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.827873468399048
Epoch: 1, Steps: 18 | Train Loss: 2.956 Vali Loss: 2.060 Vali Acc: 0.720 Test Loss: 2.060 Test Acc: 0.720
Validation loss decreased (inf --> -0.719979).  Saving model ...
Epoch: 2 cost time: 1.9418492317199707
Epoch: 2, Steps: 18 | Train Loss: 1.304 Vali Loss: 0.612 Vali Acc: 0.943 Test Loss: 0.612 Test Acc: 0.943
Validation loss decreased (-0.719979 --> -0.943327).  Saving model ...
Epoch: 3 cost time: 2.1175341606140137
Epoch: 3, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.210 Vali Acc: 0.967 Test Loss: 0.210 Test Acc: 0.967
Validation loss decreased (-0.943327 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.831230640411377
Epoch: 4, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.8024213314056396
Epoch: 5, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.7293379306793213
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.9955410957336426
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8830475807189941
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 2.1654117107391357
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.9115426540374756
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.235347270965576
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8869705200195312
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.595869541168213
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6164183616638184
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.7773680686950684
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9825754165649414
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.6539249420166016
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.676422119140625
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.0388360023498535
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.721064805984497
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1905946731567383
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7548012733459473
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6904027462005615
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7302896976470947
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6386268138885498
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.739938497543335
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.919776439666748
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.695770263671875
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.7327439785003662
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8722457885742188
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.7873754501342773
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7292447090148926
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5853757858276367
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.585939884185791
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.7738900184631348
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.871703863143921
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 1.6241414546966553
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7839701175689697
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.9876539707183838
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 1.7664873600006104
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.7701935768127441
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.8548331260681152
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.7552025318145752
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.8626842498779297
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.5015785694122314
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.3673579692840576
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.4343218803405762
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.583927869796753
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.6919660568237305
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 284993
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.889859437942505
Epoch: 1, Steps: 18 | Train Loss: 2.988 Vali Loss: 2.056 Vali Acc: 0.653 Test Loss: 2.056 Test Acc: 0.653
Validation loss decreased (inf --> -0.653313).  Saving model ...
Epoch: 2 cost time: 2.115358352661133
Epoch: 2, Steps: 18 | Train Loss: 1.304 Vali Loss: 0.582 Vali Acc: 0.957 Test Loss: 0.582 Test Acc: 0.957
Validation loss decreased (-0.653313 --> -0.956661).  Saving model ...
Epoch: 3 cost time: 1.9159457683563232
Epoch: 3, Steps: 18 | Train Loss: 0.277 Vali Loss: 0.216 Vali Acc: 0.957 Test Loss: 0.216 Test Acc: 0.957
Validation loss decreased (-0.956661 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 1.5588040351867676
Epoch: 4, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.956665 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 2.004443407058716
Epoch: 5, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2214417457580566
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.8017497062683105
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8839905261993408
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2253079414367676
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.9410791397094727
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 2.009943962097168
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.897953987121582
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.729581594467163
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.9745423793792725
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.724454641342163
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.4036331176757812
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7986176013946533
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.120933771133423
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.1806771755218506
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.8428587913513184
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0881025791168213
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.9687530994415283
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 2.2117886543273926
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8652453422546387
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8430263996124268
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8380041122436523
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.1394710540771484
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 2.295820951461792
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0576083660125732
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.975252628326416
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.9718647003173828
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.0024049282073975
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.0426554679870605
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.066511869430542
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.8184659481048584
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5652356147766113
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4988229274749756
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4390287399291992
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 1.8072452545166016
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 2.4591214656829834
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 2.1002397537231445
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.0975093841552734
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 2.054704189300537
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 2.323892116546631
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.2278645038604736
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.823549509048462
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.8777742385864258
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.8285844326019287
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.9614596366882324
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.633786678314209
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 2.0104870796203613
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.906226634979248
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 2.0720105171203613
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 268609
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.909566879272461
Epoch: 1, Steps: 18 | Train Loss: 2.984 Vali Loss: 2.050 Vali Acc: 0.660 Test Loss: 2.050 Test Acc: 0.660
Validation loss decreased (inf --> -0.659979).  Saving model ...
Epoch: 2 cost time: 2.0113577842712402
Epoch: 2, Steps: 18 | Train Loss: 1.287 Vali Loss: 0.570 Vali Acc: 0.953 Test Loss: 0.570 Test Acc: 0.953
Validation loss decreased (-0.659979 --> -0.953328).  Saving model ...
Epoch: 3 cost time: 1.6401126384735107
Epoch: 3, Steps: 18 | Train Loss: 0.275 Vali Loss: 0.206 Vali Acc: 0.960 Test Loss: 0.206 Test Acc: 0.960
Validation loss decreased (-0.953328 --> -0.959998).  Saving model ...
Epoch: 4 cost time: 1.9392168521881104
Epoch: 4, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.959998 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.5434119701385498
Epoch: 5, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.6671619415283203
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.698549747467041
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.693765640258789
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.834021806716919
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.610229253768921
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.123502016067505
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.8718156814575195
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9851667881011963
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8274545669555664
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.182790517807007
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9678406715393066
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9074304103851318
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6450328826904297
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6538527011871338
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.651024580001831
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8607723712921143
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 268609
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.947903633117676
Epoch: 1, Steps: 18 | Train Loss: 2.983 Vali Loss: 2.043 Vali Acc: 0.660 Test Loss: 2.043 Test Acc: 0.660
Validation loss decreased (inf --> -0.659980).  Saving model ...
Epoch: 2 cost time: 2.1498758792877197
Epoch: 2, Steps: 18 | Train Loss: 1.291 Vali Loss: 0.558 Vali Acc: 0.957 Test Loss: 0.558 Test Acc: 0.957
Validation loss decreased (-0.659980 --> -0.956661).  Saving model ...
Epoch: 3 cost time: 2.0498147010803223
Epoch: 3, Steps: 18 | Train Loss: 0.272 Vali Loss: 0.199 Vali Acc: 0.957 Test Loss: 0.199 Test Acc: 0.957
Validation loss decreased (-0.956661 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 2.0600333213806152
Epoch: 4, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.956665 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.8489618301391602
Epoch: 5, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.9061548709869385
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.712446928024292
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.7900924682617188
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.916478157043457
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.7679479122161865
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.7871100902557373
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.6713306903839111
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.5264146327972412
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.8731133937835693
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.590379238128662
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7114171981811523
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7287211418151855
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.860914945602417
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.9262893199920654
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.6977860927581787
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.720276117324829
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.7726421356201172
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 2.101160764694214
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8287599086761475
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7037367820739746
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.543710708618164
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5420868396759033
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5750586986541748
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.767240285873413
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5985307693481445
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7915019989013672
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.7178308963775635
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 268609
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.7307496070861816
Epoch: 1, Steps: 18 | Train Loss: 2.967 Vali Loss: 2.097 Vali Acc: 0.643 Test Loss: 2.097 Test Acc: 0.643
Validation loss decreased (inf --> -0.643312).  Saving model ...
Epoch: 2 cost time: 1.7656211853027344
Epoch: 2, Steps: 18 | Train Loss: 1.383 Vali Loss: 0.636 Vali Acc: 0.950 Test Loss: 0.636 Test Acc: 0.950
Validation loss decreased (-0.643312 --> -0.949994).  Saving model ...
Epoch: 3 cost time: 1.7682671546936035
Epoch: 3, Steps: 18 | Train Loss: 0.334 Vali Loss: 0.237 Vali Acc: 0.957 Test Loss: 0.237 Test Acc: 0.957
Validation loss decreased (-0.949994 --> -0.956664).  Saving model ...
Epoch: 4 cost time: 2.1482431888580322
Epoch: 4, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.956664 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.5683481693267822
Epoch: 5, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.646052360534668
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 1.4503114223480225
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.697507619857788
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.7784080505371094
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 2.0152411460876465
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 1.7908899784088135
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 12 cost time: 2.063006639480591
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.036212682723999
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8741333484649658
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8368868827819824
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.783341646194458
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7669403553009033
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.096257209777832
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8093128204345703
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7511005401611328
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6476006507873535
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 268609
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.675527334213257
Epoch: 1, Steps: 18 | Train Loss: 3.326 Vali Loss: 2.811 Vali Acc: 0.197 Test Loss: 2.811 Test Acc: 0.197
Validation loss decreased (inf --> -0.196639).  Saving model ...
Epoch: 2 cost time: 1.7156524658203125
Epoch: 2, Steps: 18 | Train Loss: 2.249 Vali Loss: 1.659 Vali Acc: 0.840 Test Loss: 1.659 Test Acc: 0.840
Validation loss decreased (-0.196639 --> -0.839983).  Saving model ...
Epoch: 3 cost time: 1.6972594261169434
Epoch: 3, Steps: 18 | Train Loss: 1.161 Vali Loss: 0.775 Vali Acc: 0.937 Test Loss: 0.775 Test Acc: 0.937
Validation loss decreased (-0.839983 --> -0.936659).  Saving model ...
Epoch: 4 cost time: 1.8282444477081299
Epoch: 4, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.367 Vali Acc: 0.950 Test Loss: 0.367 Test Acc: 0.950
Validation loss decreased (-0.936659 --> -0.949996).  Saving model ...
Epoch: 5 cost time: 1.6002483367919922
Epoch: 5, Steps: 18 | Train Loss: 0.173 Vali Loss: 0.228 Vali Acc: 0.967 Test Loss: 0.228 Test Acc: 0.967
Validation loss decreased (-0.949996 --> -0.966664).  Saving model ...
Epoch: 6 cost time: 1.44804048538208
Epoch: 6, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.5072779655456543
Epoch: 7, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.7052874565124512
Epoch: 8, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.825326681137085
Epoch: 9, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.129 Vali Acc: 0.983 Test Loss: 0.129 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.7424380779266357
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.6335208415985107
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5744812488555908
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.5142254829406738
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6870107650756836
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.8523149490356445
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.647878646850586
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8248083591461182
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.7237343788146973
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9744987487792969
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9267799854278564
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9859874248504639
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9653635025024414
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8653652667999268
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9285635948181152
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.709963083267212
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0148355960845947
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.597069263458252
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7224912643432617
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.866591453552246
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 1.599132776260376
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.5931296348571777
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 1.6580514907836914
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 1.669294834136963
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8428127765655518
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.488088846206665
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.0462443828582764
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.730208396911621
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.9480493068695068
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.7116622924804688
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 40 cost time: 2.083042860031128
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 41 cost time: 1.6261520385742188
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 42 cost time: 1.607039451599121
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.5417168140411377
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.4491755962371826
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.4070944786071777
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.5991265773773193
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.6788930892944336
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 48 cost time: 1.6695396900177002
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.8139605522155762
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 50 cost time: 1.7115416526794434
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 51 cost time: 1.616586446762085
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 52 cost time: 1.7454020977020264
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.7609949111938477
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.6977732181549072
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.7371673583984375
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.7636198997497559
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.8216798305511475
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.7727832794189453
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.673125982284546
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.6507198810577393
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.6046028137207031
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 384225
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.8868753910064697
Epoch: 1, Steps: 18 | Train Loss: 3.322 Vali Loss: 2.819 Vali Acc: 0.200 Test Loss: 2.819 Test Acc: 0.200
Validation loss decreased (inf --> -0.199972).  Saving model ...
Epoch: 2 cost time: 1.672161340713501
Epoch: 2, Steps: 18 | Train Loss: 2.238 Vali Loss: 1.651 Vali Acc: 0.843 Test Loss: 1.651 Test Acc: 0.843
Validation loss decreased (-0.199972 --> -0.843317).  Saving model ...
Epoch: 3 cost time: 1.5313231945037842
Epoch: 3, Steps: 18 | Train Loss: 1.141 Vali Loss: 0.763 Vali Acc: 0.940 Test Loss: 0.763 Test Acc: 0.940
Validation loss decreased (-0.843317 --> -0.939992).  Saving model ...
Epoch: 4 cost time: 1.6812634468078613
Epoch: 4, Steps: 18 | Train Loss: 0.428 Vali Loss: 0.359 Vali Acc: 0.953 Test Loss: 0.359 Test Acc: 0.953
Validation loss decreased (-0.939992 --> -0.953330).  Saving model ...
Epoch: 5 cost time: 1.7653391361236572
Epoch: 5, Steps: 18 | Train Loss: 0.170 Vali Loss: 0.224 Vali Acc: 0.957 Test Loss: 0.224 Test Acc: 0.957
Validation loss decreased (-0.953330 --> -0.956664).  Saving model ...
Epoch: 6 cost time: 1.8565430641174316
Epoch: 6, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.161 Vali Acc: 0.973 Test Loss: 0.161 Test Acc: 0.973
Validation loss decreased (-0.956664 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.9318618774414062
Epoch: 7, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.7514188289642334
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 2.031611442565918
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.8182668685913086
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.7614095211029053
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.9013867378234863
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6915526390075684
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6263868808746338
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.448476791381836
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.962507724761963
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7774884700775146
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7766616344451904
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7789294719696045
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8336918354034424
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8737380504608154
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 384225
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.4250106811523438
Epoch: 1, Steps: 18 | Train Loss: 3.310 Vali Loss: 2.802 Vali Acc: 0.210 Test Loss: 2.802 Test Acc: 0.210
Validation loss decreased (inf --> -0.209972).  Saving model ...
Epoch: 2 cost time: 1.6134226322174072
Epoch: 2, Steps: 18 | Train Loss: 2.240 Vali Loss: 1.627 Vali Acc: 0.827 Test Loss: 1.627 Test Acc: 0.827
Validation loss decreased (-0.209972 --> -0.826650).  Saving model ...
Epoch: 3 cost time: 1.6089627742767334
Epoch: 3, Steps: 18 | Train Loss: 1.134 Vali Loss: 0.733 Vali Acc: 0.940 Test Loss: 0.733 Test Acc: 0.940
Validation loss decreased (-0.826650 --> -0.939993).  Saving model ...
Epoch: 4 cost time: 1.6221683025360107
Epoch: 4, Steps: 18 | Train Loss: 0.420 Vali Loss: 0.337 Vali Acc: 0.963 Test Loss: 0.337 Test Acc: 0.963
Validation loss decreased (-0.939993 --> -0.963330).  Saving model ...
Epoch: 5 cost time: 1.358971357345581
Epoch: 5, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.205 Vali Acc: 0.967 Test Loss: 0.205 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.572248935699463
Epoch: 6, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.8781530857086182
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8169584274291992
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.7190163135528564
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.5663046836853027
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.4952690601348877
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6677188873291016
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.6550285816192627
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6852402687072754
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7195045948028564
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5214171409606934
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.5700836181640625
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5780363082885742
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.6093635559082031
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5460498332977295
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.5183143615722656
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.8316915035247803
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6589252948760986
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7777142524719238
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.783588171005249
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9316401481628418
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7444660663604736
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.885751724243164
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.748225212097168
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.887805700302124
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4837400913238525
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6777937412261963
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.7009081840515137
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.9334571361541748
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.703916311264038
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.7558517456054688
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.861217737197876
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 38 cost time: 1.6928536891937256
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 1.6403203010559082
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 40 cost time: 1.6294808387756348
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.5888724327087402
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.8524086475372314
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.6601223945617676
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.7175357341766357
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.6225366592407227
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.7156543731689453
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.7638647556304932
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.823606014251709
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.7734785079956055
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 384225
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.705942153930664
Epoch: 1, Steps: 18 | Train Loss: 3.290 Vali Loss: 2.793 Vali Acc: 0.223 Test Loss: 2.793 Test Acc: 0.223
Validation loss decreased (inf --> -0.223305).  Saving model ...
Epoch: 2 cost time: 1.592818260192871
Epoch: 2, Steps: 18 | Train Loss: 2.263 Vali Loss: 1.662 Vali Acc: 0.820 Test Loss: 1.662 Test Acc: 0.820
Validation loss decreased (-0.223305 --> -0.819983).  Saving model ...
Epoch: 3 cost time: 1.5240607261657715
Epoch: 3, Steps: 18 | Train Loss: 1.194 Vali Loss: 0.785 Vali Acc: 0.937 Test Loss: 0.785 Test Acc: 0.937
Validation loss decreased (-0.819983 --> -0.936659).  Saving model ...
Epoch: 4 cost time: 1.5889229774475098
Epoch: 4, Steps: 18 | Train Loss: 0.469 Vali Loss: 0.374 Vali Acc: 0.967 Test Loss: 0.374 Test Acc: 0.967
Validation loss decreased (-0.936659 --> -0.966663).  Saving model ...
Epoch: 5 cost time: 1.6323564052581787
Epoch: 5, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.237 Vali Acc: 0.960 Test Loss: 0.237 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3855187892913818
Epoch: 6, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 1.440821647644043
Epoch: 7, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.744173288345337
Epoch: 8, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.983 Test Loss: 0.131 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.6778345108032227
Epoch: 9, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9060595035552979
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.8054819107055664
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7517080307006836
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8324754238128662
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8406660556793213
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.899918556213379
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.678471326828003
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7658898830413818
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9730818271636963
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7639074325561523
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7948219776153564
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 384225
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.0469741821289062
Epoch: 1, Steps: 18 | Train Loss: 3.267 Vali Loss: 2.751 Vali Acc: 0.310 Test Loss: 2.751 Test Acc: 0.310
Validation loss decreased (inf --> -0.309972).  Saving model ...
Epoch: 2 cost time: 1.3063864707946777
Epoch: 2, Steps: 18 | Train Loss: 2.239 Vali Loss: 1.572 Vali Acc: 0.857 Test Loss: 1.572 Test Acc: 0.857
Validation loss decreased (-0.309972 --> -0.856651).  Saving model ...
Epoch: 3 cost time: 1.4588305950164795
Epoch: 3, Steps: 18 | Train Loss: 1.075 Vali Loss: 0.728 Vali Acc: 0.950 Test Loss: 0.728 Test Acc: 0.950
Validation loss decreased (-0.856651 --> -0.949993).  Saving model ...
Epoch: 4 cost time: 1.6821351051330566
Epoch: 4, Steps: 18 | Train Loss: 0.433 Vali Loss: 0.341 Vali Acc: 0.967 Test Loss: 0.341 Test Acc: 0.967
Validation loss decreased (-0.949993 --> -0.966663).  Saving model ...
Epoch: 5 cost time: 1.5922796726226807
Epoch: 5, Steps: 18 | Train Loss: 0.157 Vali Loss: 0.205 Vali Acc: 0.970 Test Loss: 0.205 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.4397122859954834
Epoch: 6, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 1.7699768543243408
Epoch: 7, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.7078502178192139
Epoch: 8, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8289365768432617
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6400258541107178
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.766512393951416
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6772050857543945
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6344077587127686
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5828142166137695
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2749738693237305
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3830411434173584
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.6565439701080322
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4098374843597412
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.69425630569458
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4653208255767822
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6904888153076172
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6826481819152832
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.75885009765625
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7321527004241943
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8280818462371826
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8388965129852295
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 253153
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6352596282958984
Epoch: 1, Steps: 18 | Train Loss: 3.262 Vali Loss: 2.743 Vali Acc: 0.337 Test Loss: 2.743 Test Acc: 0.337
Validation loss decreased (inf --> -0.336639).  Saving model ...
Epoch: 2 cost time: 1.6399705410003662
Epoch: 2, Steps: 18 | Train Loss: 2.238 Vali Loss: 1.554 Vali Acc: 0.860 Test Loss: 1.554 Test Acc: 0.860
Validation loss decreased (-0.336639 --> -0.859984).  Saving model ...
Epoch: 3 cost time: 1.6634843349456787
Epoch: 3, Steps: 18 | Train Loss: 1.062 Vali Loss: 0.715 Vali Acc: 0.947 Test Loss: 0.715 Test Acc: 0.947
Validation loss decreased (-0.859984 --> -0.946660).  Saving model ...
Epoch: 4 cost time: 1.581193208694458
Epoch: 4, Steps: 18 | Train Loss: 0.428 Vali Loss: 0.331 Vali Acc: 0.963 Test Loss: 0.331 Test Acc: 0.963
Validation loss decreased (-0.946660 --> -0.963330).  Saving model ...
Epoch: 5 cost time: 1.6402690410614014
Epoch: 5, Steps: 18 | Train Loss: 0.152 Vali Loss: 0.201 Vali Acc: 0.973 Test Loss: 0.201 Test Acc: 0.973
Validation loss decreased (-0.963330 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 1.6244971752166748
Epoch: 6, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0096700191497803
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
Validation loss decreased (-0.973331 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.6829030513763428
Epoch: 8, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8830056190490723
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8060920238494873
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7316222190856934
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8219516277313232
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8251135349273682
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9450619220733643
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.757185697555542
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5860719680786133
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7569587230682373
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 253153
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.3048877716064453
Epoch: 1, Steps: 18 | Train Loss: 3.265 Vali Loss: 2.743 Vali Acc: 0.347 Test Loss: 2.743 Test Acc: 0.347
Validation loss decreased (inf --> -0.346639).  Saving model ...
Epoch: 2 cost time: 1.5023491382598877
Epoch: 2, Steps: 18 | Train Loss: 2.223 Vali Loss: 1.541 Vali Acc: 0.863 Test Loss: 1.541 Test Acc: 0.863
Validation loss decreased (-0.346639 --> -0.863318).  Saving model ...
Epoch: 3 cost time: 1.4345932006835938
Epoch: 3, Steps: 18 | Train Loss: 1.053 Vali Loss: 0.697 Vali Acc: 0.943 Test Loss: 0.697 Test Acc: 0.943
Validation loss decreased (-0.863318 --> -0.943326).  Saving model ...
Epoch: 4 cost time: 1.4590392112731934
Epoch: 4, Steps: 18 | Train Loss: 0.427 Vali Loss: 0.320 Vali Acc: 0.963 Test Loss: 0.320 Test Acc: 0.963
Validation loss decreased (-0.943326 --> -0.963330).  Saving model ...
Epoch: 5 cost time: 1.686927080154419
Epoch: 5, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.195 Vali Acc: 0.973 Test Loss: 0.195 Test Acc: 0.973
Validation loss decreased (-0.963330 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 1.568408489227295
Epoch: 6, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.818437099456787
Epoch: 7, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.5018229484558105
Epoch: 8, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.7558364868164062
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.595348834991455
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6908469200134277
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5535016059875488
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5820770263671875
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3644089698791504
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1926639080047607
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.4220290184020996
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.3398282527923584
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.684385061264038
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.6465733051300049
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.694383144378662
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8311188220977783
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.7210605144500732
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.8625104427337646
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.6555204391479492
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7052650451660156
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.757652997970581
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7741847038269043
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.796959400177002
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5992920398712158
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6137690544128418
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.4218485355377197
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.6972477436065674
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.8633930683135986
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 253153
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.7202236652374268
Epoch: 1, Steps: 18 | Train Loss: 3.257 Vali Loss: 2.765 Vali Acc: 0.340 Test Loss: 2.765 Test Acc: 0.340
Validation loss decreased (inf --> -0.339972).  Saving model ...
Epoch: 2 cost time: 1.693901777267456
Epoch: 2, Steps: 18 | Train Loss: 2.259 Vali Loss: 1.614 Vali Acc: 0.840 Test Loss: 1.614 Test Acc: 0.840
Validation loss decreased (-0.339972 --> -0.839984).  Saving model ...
Epoch: 3 cost time: 1.5939550399780273
Epoch: 3, Steps: 18 | Train Loss: 1.131 Vali Loss: 0.779 Vali Acc: 0.937 Test Loss: 0.779 Test Acc: 0.937
Validation loss decreased (-0.839984 --> -0.936659).  Saving model ...
Epoch: 4 cost time: 1.496650218963623
Epoch: 4, Steps: 18 | Train Loss: 0.503 Vali Loss: 0.382 Vali Acc: 0.957 Test Loss: 0.382 Test Acc: 0.957
Validation loss decreased (-0.936659 --> -0.956663).  Saving model ...
Epoch: 5 cost time: 1.5875184535980225
Epoch: 5, Steps: 18 | Train Loss: 0.199 Vali Loss: 0.236 Vali Acc: 0.970 Test Loss: 0.236 Test Acc: 0.970
Validation loss decreased (-0.956663 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.5049824714660645
Epoch: 6, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.176 Vali Acc: 0.973 Test Loss: 0.176 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.4568960666656494
Epoch: 7, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.4055702686309814
Epoch: 8, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.5517497062683105
Epoch: 9, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5883691310882568
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5284113883972168
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.4998269081115723
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.333630084991455
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.5929880142211914
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.6237988471984863
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.6966884136199951
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.637434959411621
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.4774878025054932
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.626067876815796
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.6202714443206787
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.5786521434783936
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.7019639015197754
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5349678993225098
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.60086989402771
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.6911022663116455
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.7497751712799072
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.734769344329834
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8323545455932617
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.6797504425048828
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 1.8879189491271973
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 1.7659926414489746
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.701803207397461
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 1.664231538772583
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 1.7682580947875977
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.577864408493042
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 1.5655524730682373
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 1.4895429611206055
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 1.9226233959197998
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 1.6669433116912842
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.7174315452575684
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.690506935119629
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.9279816150665283
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.7102470397949219
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.7124888896942139
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.5313999652862549
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.8476545810699463
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.7333598136901855
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.6284432411193848
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 253153
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2834391593933105
Epoch: 1, Steps: 18 | Train Loss: 3.313 Vali Loss: 2.764 Vali Acc: 0.263 Test Loss: 2.764 Test Acc: 0.263
Validation loss decreased (inf --> -0.263306).  Saving model ...
Epoch: 2 cost time: 1.4848895072937012
Epoch: 2, Steps: 18 | Train Loss: 2.246 Vali Loss: 1.625 Vali Acc: 0.843 Test Loss: 1.625 Test Acc: 0.843
Validation loss decreased (-0.263306 --> -0.843317).  Saving model ...
Epoch: 3 cost time: 1.6672711372375488
Epoch: 3, Steps: 18 | Train Loss: 1.155 Vali Loss: 0.764 Vali Acc: 0.950 Test Loss: 0.764 Test Acc: 0.950
Validation loss decreased (-0.843317 --> -0.949992).  Saving model ...
Epoch: 4 cost time: 1.6463282108306885
Epoch: 4, Steps: 18 | Train Loss: 0.448 Vali Loss: 0.357 Vali Acc: 0.970 Test Loss: 0.357 Test Acc: 0.970
Validation loss decreased (-0.949992 --> -0.969996).  Saving model ...
Epoch: 5 cost time: 1.4988553524017334
Epoch: 5, Steps: 18 | Train Loss: 0.157 Vali Loss: 0.213 Vali Acc: 0.977 Test Loss: 0.213 Test Acc: 0.977
Validation loss decreased (-0.969996 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 1.5564098358154297
Epoch: 6, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.164 Vali Acc: 0.977 Test Loss: 0.164 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.6159453392028809
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.6439800262451172
Epoch: 8, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.4250576496124268
Epoch: 9, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6949191093444824
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5998930931091309
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.4743943214416504
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.5910751819610596
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.701279640197754
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8174357414245605
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6615967750549316
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.76054048538208
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5889098644256592
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5826261043548584
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.490048885345459
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7019991874694824
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7248625755310059
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.475919246673584
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 187617
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.761145830154419
Epoch: 1, Steps: 18 | Train Loss: 3.289 Vali Loss: 2.761 Vali Acc: 0.250 Test Loss: 2.761 Test Acc: 0.250
Validation loss decreased (inf --> -0.249972).  Saving model ...
Epoch: 2 cost time: 1.7842183113098145
Epoch: 2, Steps: 18 | Train Loss: 2.236 Vali Loss: 1.614 Vali Acc: 0.857 Test Loss: 1.614 Test Acc: 0.857
Validation loss decreased (-0.249972 --> -0.856651).  Saving model ...
Epoch: 3 cost time: 1.6785993576049805
Epoch: 3, Steps: 18 | Train Loss: 1.140 Vali Loss: 0.750 Vali Acc: 0.967 Test Loss: 0.750 Test Acc: 0.967
Validation loss decreased (-0.856651 --> -0.966659).  Saving model ...
Epoch: 4 cost time: 1.738753080368042
Epoch: 4, Steps: 18 | Train Loss: 0.437 Vali Loss: 0.349 Vali Acc: 0.973 Test Loss: 0.349 Test Acc: 0.973
Validation loss decreased (-0.966659 --> -0.973330).  Saving model ...
Epoch: 5 cost time: 1.890073537826538
Epoch: 5, Steps: 18 | Train Loss: 0.154 Vali Loss: 0.208 Vali Acc: 0.977 Test Loss: 0.208 Test Acc: 0.977
Validation loss decreased (-0.973330 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 1.7761385440826416
Epoch: 6, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.162 Vali Acc: 0.980 Test Loss: 0.162 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 7 cost time: 1.5573656558990479
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.4419896602630615
Epoch: 8, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3563218116760254
Epoch: 9, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.6381878852844238
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.6004958152770996
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.5546174049377441
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.4300010204315186
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.8421237468719482
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.7180235385894775
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.689094066619873
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 1.6709330081939697
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.644758701324463
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.6216981410980225
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.5718235969543457
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.6228575706481934
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.7003839015960693
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7369561195373535
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.5602033138275146
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.7429511547088623
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.5234413146972656
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 1.6321406364440918
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5255961418151855
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7501695156097412
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9121248722076416
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.8580808639526367
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 1.6432163715362549
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 1.4835872650146484
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 34 cost time: 1.6897644996643066
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6892170906066895
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.712397575378418
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.5918781757354736
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 38 cost time: 1.5030176639556885
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.640080451965332
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.6774876117706299
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.587284803390503
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 42 cost time: 1.796926736831665
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 43 cost time: 1.7430171966552734
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 44 cost time: 1.8331890106201172
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 45 cost time: 1.6853604316711426
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.77927565574646
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 47 cost time: 1.6699955463409424
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.6666538715362549
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.7116448879241943
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.7811427116394043
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 51 cost time: 1.7000091075897217
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 52 cost time: 1.7612395286560059
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.6199893951416016
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 54 cost time: 1.5254669189453125
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 55 cost time: 1.5496737957000732
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.6232621669769287
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.5233352184295654
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.551070213317871
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.5275700092315674
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.563645362854004
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.6830146312713623
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.8020508289337158
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.647545576095581
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.9344258308410645
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 187617
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.351555347442627
Epoch: 1, Steps: 18 | Train Loss: 3.269 Vali Loss: 2.746 Vali Acc: 0.270 Test Loss: 2.746 Test Acc: 0.270
Validation loss decreased (inf --> -0.269973).  Saving model ...
Epoch: 2 cost time: 1.634126901626587
Epoch: 2, Steps: 18 | Train Loss: 2.225 Vali Loss: 1.590 Vali Acc: 0.850 Test Loss: 1.590 Test Acc: 0.850
Validation loss decreased (-0.269973 --> -0.849984).  Saving model ...
Epoch: 3 cost time: 1.5853281021118164
Epoch: 3, Steps: 18 | Train Loss: 1.129 Vali Loss: 0.730 Vali Acc: 0.960 Test Loss: 0.730 Test Acc: 0.960
Validation loss decreased (-0.849984 --> -0.959993).  Saving model ...
Epoch: 4 cost time: 1.9171226024627686
Epoch: 4, Steps: 18 | Train Loss: 0.430 Vali Loss: 0.334 Vali Acc: 0.973 Test Loss: 0.334 Test Acc: 0.973
Validation loss decreased (-0.959993 --> -0.973330).  Saving model ...
Epoch: 5 cost time: 1.8268866539001465
Epoch: 5, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.201 Vali Acc: 0.980 Test Loss: 0.201 Test Acc: 0.980
Validation loss decreased (-0.973330 --> -0.979998).  Saving model ...
Epoch: 6 cost time: 1.6287307739257812
Epoch: 6, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 7 cost time: 1.693068027496338
Epoch: 7, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.5972621440887451
Epoch: 8, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7109019756317139
Epoch: 9, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.787309169769287
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.7096481323242188
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.8140201568603516
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.7686796188354492
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.8820455074310303
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.6593496799468994
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.9044959545135498
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 1.615755558013916
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.5300836563110352
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.593050241470337
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.6062867641448975
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.758434772491455
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.647897720336914
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7099699974060059
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6831083297729492
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.618455410003662
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.6500425338745117
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 1.519531488418579
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 1.771108627319336
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.664686918258667
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 1.7265794277191162
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.6176271438598633
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 1.6546764373779297
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 1.8067026138305664
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 34 cost time: 1.476147174835205
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7281618118286133
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4765963554382324
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.624100685119629
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.6832780838012695
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.805119514465332
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.6480331420898438
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.7940280437469482
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.8849096298217773
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.813495397567749
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 187617
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.8201301097869873
Epoch: 1, Steps: 18 | Train Loss: 3.256 Vali Loss: 2.768 Vali Acc: 0.267 Test Loss: 2.768 Test Acc: 0.267
Validation loss decreased (inf --> -0.266639).  Saving model ...
Epoch: 2 cost time: 1.7323460578918457
Epoch: 2, Steps: 18 | Train Loss: 2.283 Vali Loss: 1.660 Vali Acc: 0.853 Test Loss: 1.660 Test Acc: 0.853
Validation loss decreased (-0.266639 --> -0.853317).  Saving model ...
Epoch: 3 cost time: 1.4256656169891357
Epoch: 3, Steps: 18 | Train Loss: 1.220 Vali Loss: 0.817 Vali Acc: 0.957 Test Loss: 0.817 Test Acc: 0.957
Validation loss decreased (-0.853317 --> -0.956658).  Saving model ...
Epoch: 4 cost time: 1.5441346168518066
Epoch: 4, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.398 Vali Acc: 0.963 Test Loss: 0.398 Test Acc: 0.963
Validation loss decreased (-0.956658 --> -0.963329).  Saving model ...
Epoch: 5 cost time: 1.605818748474121
Epoch: 5, Steps: 18 | Train Loss: 0.195 Vali Loss: 0.242 Vali Acc: 0.970 Test Loss: 0.242 Test Acc: 0.970
Validation loss decreased (-0.963329 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.755488395690918
Epoch: 6, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.183 Vali Acc: 0.977 Test Loss: 0.183 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.6218454837799072
Epoch: 7, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.158 Vali Acc: 0.980 Test Loss: 0.158 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 8 cost time: 1.5328876972198486
Epoch: 8, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.8175983428955078
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8819975852966309
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.126 Vali Acc: 0.983 Test Loss: 0.126 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.6150407791137695
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.6716017723083496
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.6073966026306152
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.6686508655548096
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.638852596282959
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.6463143825531006
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 1.7641291618347168
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.6237385272979736
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.6126914024353027
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.6576330661773682
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.627626895904541
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.590660810470581
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7588000297546387
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.702451467514038
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.7573297023773193
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6354587078094482
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 1.5972912311553955
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 1.6859476566314697
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5943677425384521
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7132184505462646
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.6878321170806885
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 1.7237370014190674
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 1.751634120941162
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.654237985610962
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6996128559112549
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7691280841827393
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.8129761219024658
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 38 cost time: 1.609421968460083
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.7769994735717773
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.6167237758636475
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.5370495319366455
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.5085949897766113
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.5772593021392822
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.7901101112365723
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.6564290523529053
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.777339220046997
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.695160150527954
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 187617
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.627828598022461
Epoch: 1, Steps: 18 | Train Loss: 3.098 Vali Loss: 2.612 Vali Acc: 0.333 Test Loss: 2.612 Test Acc: 0.333
Validation loss decreased (inf --> -0.333307).  Saving model ...
Epoch: 2 cost time: 1.645336627960205
Epoch: 2, Steps: 18 | Train Loss: 2.073 Vali Loss: 1.495 Vali Acc: 0.877 Test Loss: 1.495 Test Acc: 0.877
Validation loss decreased (-0.333307 --> -0.876652).  Saving model ...
Epoch: 3 cost time: 1.6368553638458252
Epoch: 3, Steps: 18 | Train Loss: 0.979 Vali Loss: 0.681 Vali Acc: 0.940 Test Loss: 0.681 Test Acc: 0.940
Validation loss decreased (-0.876652 --> -0.939993).  Saving model ...
Epoch: 4 cost time: 1.6109607219696045
Epoch: 4, Steps: 18 | Train Loss: 0.390 Vali Loss: 0.327 Vali Acc: 0.970 Test Loss: 0.327 Test Acc: 0.970
Validation loss decreased (-0.939993 --> -0.969997).  Saving model ...
Epoch: 5 cost time: 1.533935785293579
Epoch: 5, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.204 Vali Acc: 0.970 Test Loss: 0.204 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.69169020652771
Epoch: 6, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.157 Vali Acc: 0.973 Test Loss: 0.157 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.5933315753936768
Epoch: 7, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.6398470401763916
Epoch: 8, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.611656665802002
Epoch: 9, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.505706548690796
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5517804622650146
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.4559977054595947
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.6307671070098877
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.6561548709869385
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8593788146972656
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.885798692703247
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.756535530090332
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.7797906398773193
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.8889813423156738
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.7044994831085205
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8252065181732178
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.7877914905548096
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.7113142013549805
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.684485673904419
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.8790738582611084
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.7329049110412598
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.712418794631958
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.7026355266571045
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.6719145774841309
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.785057544708252
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.638331651687622
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.6059303283691406
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.8496427536010742
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.648773431777954
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8362610340118408
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8331809043884277
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.6898305416107178
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.6138153076171875
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5989816188812256
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.5676178932189941
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.6901097297668457
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.6334035396575928
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.7228047847747803
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.672593116760254
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.7980167865753174
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.6126322746276855
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.6274313926696777
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.7579288482666016
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.7114009857177734
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.377061367034912
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.5393884181976318
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.5283403396606445
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.817807674407959
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.5184521675109863
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.525395154953003
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.541985273361206
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.7307085990905762
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.667050838470459
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 154849
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.414198398590088
Epoch: 1, Steps: 18 | Train Loss: 3.097 Vali Loss: 2.605 Vali Acc: 0.340 Test Loss: 2.605 Test Acc: 0.340
Validation loss decreased (inf --> -0.339974).  Saving model ...
Epoch: 2 cost time: 1.655601978302002
Epoch: 2, Steps: 18 | Train Loss: 2.065 Vali Loss: 1.482 Vali Acc: 0.877 Test Loss: 1.482 Test Acc: 0.877
Validation loss decreased (-0.339974 --> -0.876652).  Saving model ...
Epoch: 3 cost time: 1.8221714496612549
Epoch: 3, Steps: 18 | Train Loss: 0.974 Vali Loss: 0.671 Vali Acc: 0.943 Test Loss: 0.671 Test Acc: 0.943
Validation loss decreased (-0.876652 --> -0.943327).  Saving model ...
Epoch: 4 cost time: 1.7214303016662598
Epoch: 4, Steps: 18 | Train Loss: 0.388 Vali Loss: 0.323 Vali Acc: 0.967 Test Loss: 0.323 Test Acc: 0.967
Validation loss decreased (-0.943327 --> -0.966663).  Saving model ...
Epoch: 5 cost time: 1.829334020614624
Epoch: 5, Steps: 18 | Train Loss: 0.146 Vali Loss: 0.202 Vali Acc: 0.970 Test Loss: 0.202 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.7548704147338867
Epoch: 6, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.157 Vali Acc: 0.977 Test Loss: 0.157 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.7610008716583252
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.802518606185913
Epoch: 8, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8038761615753174
Epoch: 9, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8760888576507568
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.734757900238037
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.614325761795044
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.7880940437316895
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6849968433380127
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.818321943283081
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5943899154663086
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.703073263168335
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.858558177947998
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.842313289642334
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6250009536743164
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7543809413909912
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7985656261444092
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 154849
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.4186627864837646
Epoch: 1, Steps: 18 | Train Loss: 3.100 Vali Loss: 2.614 Vali Acc: 0.327 Test Loss: 2.614 Test Acc: 0.327
Validation loss decreased (inf --> -0.326641).  Saving model ...
Epoch: 2 cost time: 1.588423490524292
Epoch: 2, Steps: 18 | Train Loss: 2.078 Vali Loss: 1.481 Vali Acc: 0.867 Test Loss: 1.481 Test Acc: 0.867
Validation loss decreased (-0.326641 --> -0.866652).  Saving model ...
Epoch: 3 cost time: 1.469433069229126
Epoch: 3, Steps: 18 | Train Loss: 0.988 Vali Loss: 0.664 Vali Acc: 0.950 Test Loss: 0.664 Test Acc: 0.950
Validation loss decreased (-0.866652 --> -0.949993).  Saving model ...
Epoch: 4 cost time: 1.3731262683868408
Epoch: 4, Steps: 18 | Train Loss: 0.393 Vali Loss: 0.319 Vali Acc: 0.970 Test Loss: 0.319 Test Acc: 0.970
Validation loss decreased (-0.949993 --> -0.969997).  Saving model ...
Epoch: 5 cost time: 1.3619132041931152
Epoch: 5, Steps: 18 | Train Loss: 0.152 Vali Loss: 0.197 Vali Acc: 0.970 Test Loss: 0.197 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.4967913627624512
Epoch: 6, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.4375627040863037
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.5718486309051514
Epoch: 8, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.5116350650787354
Epoch: 9, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.613081455230713
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.5922679901123047
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.821220874786377
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.7829771041870117
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7861342430114746
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5236270427703857
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6473057270050049
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6270873546600342
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.627366542816162
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6883010864257812
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2825400829315186
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7656071186065674
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8435115814208984
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 154849
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5108277797698975
Epoch: 1, Steps: 18 | Train Loss: 3.104 Vali Loss: 2.647 Vali Acc: 0.313 Test Loss: 2.647 Test Acc: 0.313
Validation loss decreased (inf --> -0.313307).  Saving model ...
Epoch: 2 cost time: 1.5991895198822021
Epoch: 2, Steps: 18 | Train Loss: 2.151 Vali Loss: 1.567 Vali Acc: 0.857 Test Loss: 1.567 Test Acc: 0.857
Validation loss decreased (-0.313307 --> -0.856651).  Saving model ...
Epoch: 3 cost time: 1.6959054470062256
Epoch: 3, Steps: 18 | Train Loss: 1.082 Vali Loss: 0.750 Vali Acc: 0.937 Test Loss: 0.750 Test Acc: 0.937
Validation loss decreased (-0.856651 --> -0.936659).  Saving model ...
Epoch: 4 cost time: 1.6590356826782227
Epoch: 4, Steps: 18 | Train Loss: 0.471 Vali Loss: 0.376 Vali Acc: 0.963 Test Loss: 0.376 Test Acc: 0.963
Validation loss decreased (-0.936659 --> -0.963330).  Saving model ...
Epoch: 5 cost time: 1.6645827293395996
Epoch: 5, Steps: 18 | Train Loss: 0.200 Vali Loss: 0.232 Vali Acc: 0.963 Test Loss: 0.232 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 1.7327163219451904
Epoch: 6, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 1.7504854202270508
Epoch: 7, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.157 Vali Acc: 0.977 Test Loss: 0.157 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.6284856796264648
Epoch: 8, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.142 Vali Acc: 0.980 Test Loss: 0.142 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.5538451671600342
Epoch: 9, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.440417766571045
Epoch: 10, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.710326910018921
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.5478007793426514
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.4930567741394043
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.505265235900879
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.6702463626861572
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.832688570022583
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.4979238510131836
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.6472492218017578
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.54905366897583
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.5996830463409424
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8154730796813965
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.6021356582641602
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.598487138748169
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5810701847076416
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.6083118915557861
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.3531742095947266
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.4917943477630615
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.6022789478302002
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.6283893585205078
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.6374614238739014
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.5526630878448486
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.621253490447998
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.5261077880859375
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.4208686351776123
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7072627544403076
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.5805211067199707
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.7290773391723633
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.6694905757904053
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.6129450798034668
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.6068308353424072
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.6358604431152344
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.5516250133514404
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.5557537078857422
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.533182144165039
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.7035276889801025
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.73557710647583
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.6905410289764404
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.545396089553833
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.69321608543396
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.5132973194122314
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.5515336990356445
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.6348817348480225
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.6461536884307861
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.74635648727417
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.5955588817596436
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.5767784118652344
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.5404322147369385
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.4751276969909668
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.5085399150848389
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.3638107776641846
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.289705514907837
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.4226047992706299
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.7134909629821777
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 1.5983750820159912
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 65 cost time: 1.471489667892456
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 66 cost time: 1.5741140842437744
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.7153210639953613
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.6251294612884521
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.7184395790100098
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 70 cost time: 1.5790398120880127
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 71 cost time: 1.6177475452423096
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 72 cost time: 1.413971185684204
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 73 cost time: 1.3893299102783203
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.354097843170166
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.3863861560821533
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.5100252628326416
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 77 cost time: 1.5184154510498047
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
Validation loss decreased (-0.983332 --> -0.986666).  Saving model ...
Epoch: 78 cost time: 1.5257174968719482
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 79 cost time: 1.7456839084625244
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 80 cost time: 1.5111172199249268
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.6351265907287598
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.6653845310211182
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.9308030605316162
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.7847959995269775
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 85 cost time: 1.7633121013641357
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 86 cost time: 1.7817299365997314
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.9810941219329834
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.7421178817749023
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 1.62876558303833
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 1.5443236827850342
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 1.3768296241760254
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 1.391078233718872
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 1.5234136581420898
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 1.7471592426300049
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 95 cost time: 1.7423629760742188
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.642409086227417
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 1.6958441734313965
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 98 cost time: 1.5409550666809082
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 99 cost time: 1.5767583847045898
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 100 cost time: 1.6687226295471191
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 154849
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.4245524406433105
Epoch: 1, Steps: 18 | Train Loss: 3.173 Vali Loss: 2.684 Vali Acc: 0.330 Test Loss: 2.684 Test Acc: 0.330
Validation loss decreased (inf --> -0.329973).  Saving model ...
Epoch: 2 cost time: 1.556894063949585
Epoch: 2, Steps: 18 | Train Loss: 2.194 Vali Loss: 1.572 Vali Acc: 0.840 Test Loss: 1.572 Test Acc: 0.840
Validation loss decreased (-0.329973 --> -0.839984).  Saving model ...
Epoch: 3 cost time: 1.4593956470489502
Epoch: 3, Steps: 18 | Train Loss: 1.097 Vali Loss: 0.727 Vali Acc: 0.940 Test Loss: 0.727 Test Acc: 0.940
Validation loss decreased (-0.839984 --> -0.939993).  Saving model ...
Epoch: 4 cost time: 1.4698131084442139
Epoch: 4, Steps: 18 | Train Loss: 0.420 Vali Loss: 0.343 Vali Acc: 0.960 Test Loss: 0.343 Test Acc: 0.960
Validation loss decreased (-0.939993 --> -0.959997).  Saving model ...
Epoch: 5 cost time: 1.4708271026611328
Epoch: 5, Steps: 18 | Train Loss: 0.172 Vali Loss: 0.207 Vali Acc: 0.973 Test Loss: 0.207 Test Acc: 0.973
Validation loss decreased (-0.959997 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 1.4875502586364746
Epoch: 6, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.161 Vali Acc: 0.973 Test Loss: 0.161 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.6615955829620361
Epoch: 7, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.6331093311309814
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.7439665794372559
Epoch: 9, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.5706350803375244
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.5992333889007568
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.6175808906555176
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.7225992679595947
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6541781425476074
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5915136337280273
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3247389793395996
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6223719120025635
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6072914600372314
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6024510860443115
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6131336688995361
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6196212768554688
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.6028802394866943
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.7472267150878906
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.545619249343872
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6622719764709473
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5911900997161865
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.687173843383789
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6543662548065186
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6559815406799316
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7888548374176025
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 1.7561638355255127
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.7393269538879395
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 1.6879513263702393
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4982812404632568
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5468652248382568
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6246638298034668
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.5314912796020508
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.6516573429107666
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.5846083164215088
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.6419167518615723
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.6756117343902588
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.4607093334197998
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 138465
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.460653305053711
Epoch: 1, Steps: 18 | Train Loss: 3.171 Vali Loss: 2.672 Vali Acc: 0.323 Test Loss: 2.672 Test Acc: 0.323
Validation loss decreased (inf --> -0.323307).  Saving model ...
Epoch: 2 cost time: 1.5128071308135986
Epoch: 2, Steps: 18 | Train Loss: 2.175 Vali Loss: 1.554 Vali Acc: 0.857 Test Loss: 1.554 Test Acc: 0.857
Validation loss decreased (-0.323307 --> -0.856651).  Saving model ...
Epoch: 3 cost time: 1.5128912925720215
Epoch: 3, Steps: 18 | Train Loss: 1.081 Vali Loss: 0.713 Vali Acc: 0.943 Test Loss: 0.713 Test Acc: 0.943
Validation loss decreased (-0.856651 --> -0.943326).  Saving model ...
Epoch: 4 cost time: 1.4407925605773926
Epoch: 4, Steps: 18 | Train Loss: 0.410 Vali Loss: 0.333 Vali Acc: 0.960 Test Loss: 0.333 Test Acc: 0.960
Validation loss decreased (-0.943326 --> -0.959997).  Saving model ...
Epoch: 5 cost time: 1.3272936344146729
Epoch: 5, Steps: 18 | Train Loss: 0.170 Vali Loss: 0.203 Vali Acc: 0.967 Test Loss: 0.203 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.3362789154052734
Epoch: 6, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.324195384979248
Epoch: 7, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.5265555381774902
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.127 Vali Acc: 0.983 Test Loss: 0.127 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.7493610382080078
Epoch: 9, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8773038387298584
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9794559478759766
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.7018554210662842
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.6675987243652344
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.637343168258667
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7854673862457275
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8488922119140625
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.526587724685669
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8687551021575928
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6114537715911865
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6582984924316406
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.479198932647705
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.571868896484375
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.4798378944396973
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.632875680923462
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.777998447418213
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7098731994628906
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6357815265655518
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.765815258026123
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5139095783233643
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5179133415222168
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.478668451309204
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 1.616089105606079
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 1.6343109607696533
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4205517768859863
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3110852241516113
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3644802570343018
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3663246631622314
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.3389296531677246
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 1.372319221496582
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.50816011428833
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.5281226634979248
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.6286985874176025
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.6643736362457275
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.6312994956970215
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.6535329818725586
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.7166943550109863
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.7842118740081787
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.7216477394104004
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 138465
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.320797920227051
Epoch: 1, Steps: 18 | Train Loss: 3.164 Vali Loss: 2.673 Vali Acc: 0.350 Test Loss: 2.673 Test Acc: 0.350
Validation loss decreased (inf --> -0.349973).  Saving model ...
Epoch: 2 cost time: 1.7429301738739014
Epoch: 2, Steps: 18 | Train Loss: 2.170 Vali Loss: 1.547 Vali Acc: 0.860 Test Loss: 1.547 Test Acc: 0.860
Validation loss decreased (-0.349973 --> -0.859985).  Saving model ...
Epoch: 3 cost time: 1.6127862930297852
Epoch: 3, Steps: 18 | Train Loss: 1.074 Vali Loss: 0.703 Vali Acc: 0.940 Test Loss: 0.703 Test Acc: 0.940
Validation loss decreased (-0.859985 --> -0.939993).  Saving model ...
Epoch: 4 cost time: 1.5119376182556152
Epoch: 4, Steps: 18 | Train Loss: 0.415 Vali Loss: 0.332 Vali Acc: 0.957 Test Loss: 0.332 Test Acc: 0.957
Validation loss decreased (-0.939993 --> -0.956663).  Saving model ...
Epoch: 5 cost time: 1.7898356914520264
Epoch: 5, Steps: 18 | Train Loss: 0.177 Vali Loss: 0.201 Vali Acc: 0.970 Test Loss: 0.201 Test Acc: 0.970
Validation loss decreased (-0.956663 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.6646785736083984
Epoch: 6, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.6520164012908936
Epoch: 7, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.139 Vali Acc: 0.987 Test Loss: 0.139 Test Acc: 0.987
Validation loss decreased (-0.976665 --> -0.986665).  Saving model ...
Epoch: 8 cost time: 1.6625196933746338
Epoch: 8, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.983 Test Loss: 0.127 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7359676361083984
Epoch: 9, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.983 Test Loss: 0.118 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4923408031463623
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5896875858306885
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.987 Test Loss: 0.109 Test Acc: 0.987
Validation loss decreased (-0.986665 --> -0.986666).  Saving model ...
Epoch: 12 cost time: 1.7227180004119873
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6060428619384766
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4766926765441895
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5339603424072266
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5322275161743164
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5452861785888672
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5141561031341553
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.52237868309021
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4881107807159424
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4528381824493408
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 138465
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.583867073059082
Epoch: 1, Steps: 18 | Train Loss: 3.128 Vali Loss: 2.684 Vali Acc: 0.370 Test Loss: 2.684 Test Acc: 0.370
Validation loss decreased (inf --> -0.369973).  Saving model ...
Epoch: 2 cost time: 1.8018851280212402
Epoch: 2, Steps: 18 | Train Loss: 2.226 Vali Loss: 1.620 Vali Acc: 0.843 Test Loss: 1.620 Test Acc: 0.843
Validation loss decreased (-0.369973 --> -0.843317).  Saving model ...
Epoch: 3 cost time: 1.5832500457763672
Epoch: 3, Steps: 18 | Train Loss: 1.189 Vali Loss: 0.795 Vali Acc: 0.940 Test Loss: 0.795 Test Acc: 0.940
Validation loss decreased (-0.843317 --> -0.939992).  Saving model ...
Epoch: 4 cost time: 1.5174527168273926
Epoch: 4, Steps: 18 | Train Loss: 0.506 Vali Loss: 0.399 Vali Acc: 0.953 Test Loss: 0.399 Test Acc: 0.953
Validation loss decreased (-0.939992 --> -0.953329).  Saving model ...
Epoch: 5 cost time: 1.5984909534454346
Epoch: 5, Steps: 18 | Train Loss: 0.238 Vali Loss: 0.241 Vali Acc: 0.970 Test Loss: 0.241 Test Acc: 0.970
Validation loss decreased (-0.953329 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.6502184867858887
Epoch: 6, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 1.5308308601379395
Epoch: 7, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.2943167686462402
Epoch: 8, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.139 Vali Acc: 0.980 Test Loss: 0.139 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.480271816253662
Epoch: 9, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.5789966583251953
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6077029705047607
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.7715575695037842
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.691392421722412
Epoch: 13, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.8350367546081543
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.6598024368286133
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.817314863204956
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.5810232162475586
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6912410259246826
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.5779972076416016
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.5642287731170654
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.7686831951141357
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.758394718170166
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.7777471542358398
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.8252501487731934
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.756608486175537
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8570048809051514
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 1.5586931705474854
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 1.798978567123413
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.7674806118011475
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 1.6594865322113037
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 1.5660419464111328
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.5758490562438965
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 1.635854721069336
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6279842853546143
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6286287307739258
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 1.6544196605682373
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 1.6704306602478027
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 1.6836466789245605
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.6893134117126465
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.5512721538543701
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.5313997268676758
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.5474278926849365
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.6799671649932861
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.693204402923584
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.6116492748260498
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.5641231536865234
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.6162209510803223
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 1.6670582294464111
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 1.538759708404541
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 1.8098974227905273
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.6844213008880615
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.7487013339996338
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 1.6713311672210693
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 1.5306506156921387
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.5311763286590576
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.6866943836212158
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.5080711841583252
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.5736973285675049
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.770353078842163
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.744971513748169
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.7661116123199463
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.6370596885681152
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.567223072052002
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.6040263175964355
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.6226201057434082
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.7035844326019287
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.6527454853057861
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.508669376373291
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 1.5483381748199463
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.552537441253662
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.6378436088562012
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 72 cost time: 1.5192952156066895
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 1.5867626667022705
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.5510978698730469
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.6780602931976318
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.6885464191436768
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.7693276405334473
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.8022398948669434
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.5858967304229736
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 1.7491505146026611
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 1.5851061344146729
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 82 cost time: 1.7277603149414062
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.5463387966156006
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.7229135036468506
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.5757596492767334
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 1.681154727935791
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 1.7826473712921143
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 1.6796433925628662
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 1.8890814781188965
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 1.6585350036621094
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 1.6469781398773193
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 138465
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.684532642364502
Epoch: 1, Steps: 18 | Train Loss: 3.185 Vali Loss: 2.669 Vali Acc: 0.330 Test Loss: 2.669 Test Acc: 0.330
Validation loss decreased (inf --> -0.329973).  Saving model ...
Epoch: 2 cost time: 1.8439140319824219
Epoch: 2, Steps: 18 | Train Loss: 2.170 Vali Loss: 1.559 Vali Acc: 0.887 Test Loss: 1.559 Test Acc: 0.887
Validation loss decreased (-0.329973 --> -0.886651).  Saving model ...
Epoch: 3 cost time: 1.7091293334960938
Epoch: 3, Steps: 18 | Train Loss: 1.118 Vali Loss: 0.732 Vali Acc: 0.963 Test Loss: 0.732 Test Acc: 0.963
Validation loss decreased (-0.886651 --> -0.963326).  Saving model ...
Epoch: 4 cost time: 1.644115686416626
Epoch: 4, Steps: 18 | Train Loss: 0.440 Vali Loss: 0.350 Vali Acc: 0.970 Test Loss: 0.350 Test Acc: 0.970
Validation loss decreased (-0.963326 --> -0.969997).  Saving model ...
Epoch: 5 cost time: 1.6193599700927734
Epoch: 5, Steps: 18 | Train Loss: 0.170 Vali Loss: 0.202 Vali Acc: 0.970 Test Loss: 0.202 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.6626100540161133
Epoch: 6, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.4988093376159668
Epoch: 7, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.544142484664917
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.5051677227020264
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.5460822582244873
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.5643160343170166
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.508194923400879
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.4574120044708252
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.6739771366119385
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.5267233848571777
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.6451659202575684
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.5838885307312012
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5753071308135986
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.6193437576293945
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5894982814788818
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5256366729736328
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5586650371551514
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5022304058074951
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5089809894561768
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4946386814117432
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4161856174468994
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5526463985443115
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9091331958770752
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 130273
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5452682971954346
Epoch: 1, Steps: 18 | Train Loss: 3.195 Vali Loss: 2.668 Vali Acc: 0.330 Test Loss: 2.668 Test Acc: 0.330
Validation loss decreased (inf --> -0.329973).  Saving model ...
Epoch: 2 cost time: 1.5306904315948486
Epoch: 2, Steps: 18 | Train Loss: 2.170 Vali Loss: 1.549 Vali Acc: 0.897 Test Loss: 1.549 Test Acc: 0.897
Validation loss decreased (-0.329973 --> -0.896651).  Saving model ...
Epoch: 3 cost time: 1.7390823364257812
Epoch: 3, Steps: 18 | Train Loss: 1.113 Vali Loss: 0.720 Vali Acc: 0.963 Test Loss: 0.720 Test Acc: 0.963
Validation loss decreased (-0.896651 --> -0.963326).  Saving model ...
Epoch: 4 cost time: 1.6568892002105713
Epoch: 4, Steps: 18 | Train Loss: 0.433 Vali Loss: 0.346 Vali Acc: 0.967 Test Loss: 0.346 Test Acc: 0.967
Validation loss decreased (-0.963326 --> -0.966663).  Saving model ...
Epoch: 5 cost time: 1.4654216766357422
Epoch: 5, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.200 Vali Acc: 0.970 Test Loss: 0.200 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.4818222522735596
Epoch: 6, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 1.5303473472595215
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.6749765872955322
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.4588370323181152
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.5219900608062744
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.7242345809936523
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.5703990459442139
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.671250820159912
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.6639034748077393
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.9998891353607178
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 2.125480890274048
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 2.4329614639282227
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3003287315368652
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.22417950630188
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 2.0402798652648926
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.356638193130493
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 2.462887763977051
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 2.256737470626831
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.2371435165405273
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.2555603981018066
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3121702671051025
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.33514666557312
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 2.291337251663208
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 2.475550889968872
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 2.5767617225646973
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 2.2691638469696045
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.091057062149048
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.290020227432251
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.4734678268432617
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 2.4716265201568604
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.340327739715576
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.068209648132324
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 2.2499730587005615
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 2.1672186851501465
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 2.4973089694976807
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 2.4676365852355957
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.397385358810425
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.552119016647339
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.5992789268493652
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 2.6074697971343994
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 2.5358433723449707
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 2.4619243144989014
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.3843915462493896
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.4279990196228027
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.321317672729492
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 2.199634552001953
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.441983938217163
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 2.5114383697509766
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 2.0790252685546875
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 2.3955771923065186
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 2.4079487323760986
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 2.2705812454223633
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.2191617488861084
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 2.249439001083374
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 2.14581298828125
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 1.9479618072509766
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.1087281703948975
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 2.1107594966888428
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 2.247774839401245
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 2.2749664783477783
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 2.2273433208465576
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 2.1136181354522705
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 2.1360745429992676
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 2.2109081745147705
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 2.252218723297119
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 130273
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.101333141326904
Epoch: 1, Steps: 18 | Train Loss: 3.190 Vali Loss: 2.673 Vali Acc: 0.363 Test Loss: 2.673 Test Acc: 0.363
Validation loss decreased (inf --> -0.363307).  Saving model ...
Epoch: 2 cost time: 2.0272905826568604
Epoch: 2, Steps: 18 | Train Loss: 2.162 Vali Loss: 1.547 Vali Acc: 0.883 Test Loss: 1.547 Test Acc: 0.883
Validation loss decreased (-0.363307 --> -0.883318).  Saving model ...
Epoch: 3 cost time: 2.0242865085601807
Epoch: 3, Steps: 18 | Train Loss: 1.114 Vali Loss: 0.716 Vali Acc: 0.963 Test Loss: 0.716 Test Acc: 0.963
Validation loss decreased (-0.883318 --> -0.963326).  Saving model ...
Epoch: 4 cost time: 2.025757312774658
Epoch: 4, Steps: 18 | Train Loss: 0.437 Vali Loss: 0.345 Vali Acc: 0.970 Test Loss: 0.345 Test Acc: 0.970
Validation loss decreased (-0.963326 --> -0.969997).  Saving model ...
Epoch: 5 cost time: 1.9239025115966797
Epoch: 5, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.199 Vali Acc: 0.973 Test Loss: 0.199 Test Acc: 0.973
Validation loss decreased (-0.969997 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 1.9885165691375732
Epoch: 6, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.8926458358764648
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 2.2333970069885254
Epoch: 8, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 2.016313314437866
Epoch: 9, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 2.121690273284912
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 2.0216429233551025
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 2.104978322982788
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.054269790649414
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.906442403793335
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.138152599334717
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 2.2925331592559814
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 2.292977809906006
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3064427375793457
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 2.294754981994629
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1684162616729736
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 2.216810941696167
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 2.3311052322387695
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0048675537109375
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.306417942047119
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2104501724243164
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.276160717010498
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.254575729370117
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.255754232406616
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.0209577083587646
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.7395875453948975
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 2.154788017272949
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.108159065246582
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.0749804973602295
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.964737892150879
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 2.136293649673462
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.107522487640381
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.2719292640686035
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 2.018751859664917
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.4233925342559814
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.296860456466675
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.2194712162017822
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.166233777999878
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.350276470184326
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.065559148788452
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.0933804512023926
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.2333197593688965
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.233725070953369
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 130273
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.53801155090332
Epoch: 1, Steps: 18 | Train Loss: 3.133 Vali Loss: 2.673 Vali Acc: 0.357 Test Loss: 2.673 Test Acc: 0.357
Validation loss decreased (inf --> -0.356640).  Saving model ...
Epoch: 2 cost time: 2.38667893409729
Epoch: 2, Steps: 18 | Train Loss: 2.175 Vali Loss: 1.602 Vali Acc: 0.863 Test Loss: 1.602 Test Acc: 0.863
Validation loss decreased (-0.356640 --> -0.863317).  Saving model ...
Epoch: 3 cost time: 2.3509790897369385
Epoch: 3, Steps: 18 | Train Loss: 1.180 Vali Loss: 0.794 Vali Acc: 0.950 Test Loss: 0.794 Test Acc: 0.950
Validation loss decreased (-0.863317 --> -0.949992).  Saving model ...
Epoch: 4 cost time: 2.373837947845459
Epoch: 4, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.400 Vali Acc: 0.957 Test Loss: 0.400 Test Acc: 0.957
Validation loss decreased (-0.949992 --> -0.956663).  Saving model ...
Epoch: 5 cost time: 2.382688045501709
Epoch: 5, Steps: 18 | Train Loss: 0.230 Vali Loss: 0.239 Vali Acc: 0.970 Test Loss: 0.239 Test Acc: 0.970
Validation loss decreased (-0.956663 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 2.500983953475952
Epoch: 6, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 2.570765733718872
Epoch: 7, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.157 Vali Acc: 0.973 Test Loss: 0.157 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 2.41363525390625
Epoch: 8, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 2.372843027114868
Epoch: 9, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 2.4473085403442383
Epoch: 10, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 3.0405001640319824
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 2.0706369876861572
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 2.0555033683776855
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 2.149061441421509
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.4429633617401123
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 2.3455586433410645
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 2.4080777168273926
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6074612140655518
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 2.520230531692505
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4413340091705322
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.410810708999634
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 2.4442782402038574
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 2.5821313858032227
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 2.128866672515869
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 2.2764980792999268
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.148693561553955
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 2.576026201248169
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 2.4916725158691406
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 2.193948984146118
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.2135422229766846
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 2.1839661598205566
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 2.2962942123413086
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.353905439376831
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8634521961212158
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.182527542114258
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.301370143890381
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.462862491607666
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.457906484603882
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.280897617340088
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 40 cost time: 2.472106695175171
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 41 cost time: 2.531937599182129
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 42 cost time: 2.067042350769043
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 43 cost time: 2.440924644470215
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 44 cost time: 2.377617597579956
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 45 cost time: 2.363863706588745
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 46 cost time: 2.2740559577941895
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 47 cost time: 2.2515411376953125
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.451868772506714
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.7351295948028564
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.7537238597869873
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 2.4603404998779297
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.529277801513672
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 2.9933018684387207
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 2.5892438888549805
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 2.6911232471466064
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 56 cost time: 2.5681040287017822
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 2.7102410793304443
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 2.5844740867614746
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 2.810178518295288
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 2.60563588142395
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 2.4006359577178955
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 2.715388536453247
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 2.6398184299468994
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 3.151547431945801
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 65 cost time: 2.666815757751465
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 66 cost time: 2.621725559234619
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 67 cost time: 2.9953436851501465
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 2.409411907196045
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 2.4544622898101807
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 2.523808240890503
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 2.27288556098938
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 2.510260581970215
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 2.6246695518493652
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 2.705278158187866
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 2.6073739528656006
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 2.4908413887023926
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 2.5016119480133057
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 2.7672505378723145
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 2.885849714279175
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 2.7224555015563965
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 2.755601167678833
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 2.646202802658081
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 2.734492540359497
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 130273
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.126306056976318
Epoch: 1, Steps: 18 | Train Loss: 1.875 Vali Loss: 0.277 Vali Acc: 0.913 Test Loss: 0.277 Test Acc: 0.913
Validation loss decreased (inf --> -0.913331).  Saving model ...
Epoch: 2 cost time: 2.583355665206909
Epoch: 2, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.913331 --> -0.973332).  Saving model ...
Epoch: 3 cost time: 3.009439706802368
Epoch: 3, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.209 Vali Acc: 0.953 Test Loss: 0.209 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5213558673858643
Epoch: 4, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6526546478271484
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.967 Test Loss: 0.229 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.881781816482544
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.973 Test Loss: 0.170 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.436039686203003
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 2.69923996925354
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 2.250312328338623
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 2.15578556060791
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 2.3696563243865967
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 2.1442723274230957
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 2.4817917346954346
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 2.347554922103882
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.280412197113037
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 2.9554951190948486
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 2.3889620304107666
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.785956621170044
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.1580634117126465
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 2.0370564460754395
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 2.146249532699585
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 2.7021842002868652
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 2.886932611465454
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 2.7651708126068115
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 2.8653581142425537
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 2.766507148742676
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 2.475175142288208
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 2.186061143875122
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 2.0828444957733154
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 2.453568696975708
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 2.552398204803467
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 2.7299349308013916
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 2.3716368675231934
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 34 cost time: 2.163515090942383
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 35 cost time: 2.4146523475646973
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 36 cost time: 2.8487589359283447
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 37 cost time: 2.8714792728424072
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 38 cost time: 2.559462070465088
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 2.1388537883758545
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 40 cost time: 2.3544204235076904
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.48897123336792
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 42 cost time: 2.780031442642212
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 43 cost time: 2.631251096725464
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 44 cost time: 2.3781583309173584
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.9106049537658691
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.330841302871704
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.217374801635742
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 48 cost time: 2.331031084060669
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.3485727310180664
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 50 cost time: 2.298635244369507
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 51 cost time: 2.6349189281463623
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 52 cost time: 2.585488796234131
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 53 cost time: 2.678614854812622
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.4814088344573975
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 55 cost time: 2.4713656902313232
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 56 cost time: 2.5153238773345947
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 57 cost time: 2.479358673095703
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.1737661361694336
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 2.705536127090454
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 2.4010915756225586
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 2.3055779933929443
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.6197905540466309
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.85111665725708
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.904534101486206
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 2.5030083656311035
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 2.5223913192749023
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 67 cost time: 2.7265663146972656
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 68 cost time: 2.398994207382202
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 69 cost time: 2.655937433242798
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 70 cost time: 2.8260130882263184
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 2.810892343521118
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 2.235412836074829
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 2.468461036682129
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 2.1436359882354736
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.9057419300079346
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 2.332545280456543
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 2.783156394958496
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.8463397026062012
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 2.027087450027466
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 4493901
model size : 26.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.31363844871521
Epoch: 1, Steps: 18 | Train Loss: 1.880 Vali Loss: 0.286 Vali Acc: 0.910 Test Loss: 0.286 Test Acc: 0.910
Validation loss decreased (inf --> -0.909997).  Saving model ...
Epoch: 2 cost time: 2.5543596744537354
Epoch: 2, Steps: 18 | Train Loss: 0.137 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.909997 --> -0.973332).  Saving model ...
Epoch: 3 cost time: 2.57495379447937
Epoch: 3, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.210 Vali Acc: 0.953 Test Loss: 0.210 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7176296710968018
Epoch: 4, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4912729263305664
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4050166606903076
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.963 Test Loss: 0.260 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0666303634643555
Epoch: 7, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.300 Vali Acc: 0.960 Test Loss: 0.300 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.172714948654175
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.805 Vali Acc: 0.890 Test Loss: 0.805 Test Acc: 0.890
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.1183571815490723
Epoch: 9, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.599 Vali Acc: 0.900 Test Loss: 0.599 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1849892139434814
Epoch: 10, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.687 Vali Acc: 0.900 Test Loss: 0.687 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.129716634750366
Epoch: 11, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.417 Vali Acc: 0.937 Test Loss: 0.417 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9931631088256836
Epoch: 12, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.390 Vali Acc: 0.937 Test Loss: 0.390 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 4493901
model size : 26.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.926837205886841
Epoch: 1, Steps: 18 | Train Loss: 1.903 Vali Loss: 0.290 Vali Acc: 0.920 Test Loss: 0.290 Test Acc: 0.920
Validation loss decreased (inf --> -0.919997).  Saving model ...
Epoch: 2 cost time: 2.535210132598877
Epoch: 2, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.919997 --> -0.966665).  Saving model ...
Epoch: 3 cost time: 2.0239720344543457
Epoch: 3, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.240 Vali Acc: 0.947 Test Loss: 0.240 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.06858229637146
Epoch: 4, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1370623111724854
Epoch: 5, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.317 Vali Acc: 0.927 Test Loss: 0.317 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7820284366607666
Epoch: 6, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.699416160583496
Epoch: 7, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.330 Vali Acc: 0.937 Test Loss: 0.330 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5894882678985596
Epoch: 8, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.408 Vali Acc: 0.947 Test Loss: 0.408 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.4679675102233887
Epoch: 9, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.517 Vali Acc: 0.937 Test Loss: 0.517 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.137526273727417
Epoch: 10, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.661 Vali Acc: 0.907 Test Loss: 0.661 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.845669984817505
Epoch: 11, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.534 Vali Acc: 0.900 Test Loss: 0.534 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.5202279090881348
Epoch: 12, Steps: 18 | Train Loss: 0.162 Vali Loss: 0.452 Vali Acc: 0.953 Test Loss: 0.452 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 4493901
model size : 26.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.238891839981079
Epoch: 1, Steps: 18 | Train Loss: 1.972 Vali Loss: 0.362 Vali Acc: 0.907 Test Loss: 0.362 Test Acc: 0.907
Validation loss decreased (inf --> -0.906663).  Saving model ...
Epoch: 2 cost time: 2.562342643737793
Epoch: 2, Steps: 18 | Train Loss: 0.187 Vali Loss: 0.174 Vali Acc: 0.953 Test Loss: 0.174 Test Acc: 0.953
Validation loss decreased (-0.906663 --> -0.953332).  Saving model ...
Epoch: 3 cost time: 2.6035704612731934
Epoch: 3, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.230 Vali Acc: 0.953 Test Loss: 0.230 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.356133222579956
Epoch: 4, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.325 Vali Acc: 0.923 Test Loss: 0.325 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0411901473999023
Epoch: 5, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.245 Vali Acc: 0.947 Test Loss: 0.245 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.348104238510132
Epoch: 6, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.370 Vali Acc: 0.937 Test Loss: 0.370 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3541932106018066
Epoch: 7, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.503 Vali Acc: 0.897 Test Loss: 0.503 Test Acc: 0.897
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0375418663024902
Epoch: 8, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.525 Vali Acc: 0.907 Test Loss: 0.525 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6634230613708496
Epoch: 9, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.629 Vali Acc: 0.883 Test Loss: 0.629 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6031014919281006
Epoch: 10, Steps: 18 | Train Loss: 0.168 Vali Loss: 0.468 Vali Acc: 0.913 Test Loss: 0.468 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8884685039520264
Epoch: 11, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.520 Vali Acc: 0.917 Test Loss: 0.520 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.331317186355591
Epoch: 12, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.589 Vali Acc: 0.927 Test Loss: 0.589 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9533333333333334
model parameter : 4493901
model size : 26.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.311092138290405
Epoch: 1, Steps: 18 | Train Loss: 2.014 Vali Loss: 0.376 Vali Acc: 0.890 Test Loss: 0.376 Test Acc: 0.890
Validation loss decreased (inf --> -0.889996).  Saving model ...
Epoch: 2 cost time: 2.4271981716156006
Epoch: 2, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
Validation loss decreased (-0.889996 --> -0.956665).  Saving model ...
Epoch: 3 cost time: 2.2389721870422363
Epoch: 3, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.308267593383789
Epoch: 4, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.956665 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 2.569284439086914
Epoch: 5, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3310375213623047
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.307044744491577
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.160252094268799
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1430201530456543
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.14205002784729
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1285898685455322
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.4452970027923584
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8249170780181885
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1509945392608643
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 3445325
model size : 22.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.252469301223755
Epoch: 1, Steps: 18 | Train Loss: 2.012 Vali Loss: 0.385 Vali Acc: 0.890 Test Loss: 0.385 Test Acc: 0.890
Validation loss decreased (inf --> -0.889996).  Saving model ...
Epoch: 2 cost time: 2.505715847015381
Epoch: 2, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.168 Vali Acc: 0.953 Test Loss: 0.168 Test Acc: 0.953
Validation loss decreased (-0.889996 --> -0.953332).  Saving model ...
Epoch: 3 cost time: 2.604177474975586
Epoch: 3, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.640085220336914
Epoch: 4, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
Validation loss decreased (-0.953332 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 2.633281946182251
Epoch: 5, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5232644081115723
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.295 Vali Acc: 0.953 Test Loss: 0.295 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3406736850738525
Epoch: 7, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.505 Vali Acc: 0.913 Test Loss: 0.505 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5305423736572266
Epoch: 8, Steps: 18 | Train Loss: 0.161 Vali Loss: 0.298 Vali Acc: 0.953 Test Loss: 0.298 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.245619535446167
Epoch: 9, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.413 Vali Acc: 0.943 Test Loss: 0.413 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.278035879135132
Epoch: 10, Steps: 18 | Train Loss: 0.245 Vali Loss: 0.718 Vali Acc: 0.920 Test Loss: 0.718 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2421765327453613
Epoch: 11, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.455 Vali Acc: 0.933 Test Loss: 0.455 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.134150505065918
Epoch: 12, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.606 Vali Acc: 0.927 Test Loss: 0.606 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7968740463256836
Epoch: 13, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.499 Vali Acc: 0.940 Test Loss: 0.499 Test Acc: 0.940
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.068290948867798
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.619 Vali Acc: 0.930 Test Loss: 0.619 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 3445325
model size : 22.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.320980548858643
Epoch: 1, Steps: 18 | Train Loss: 2.018 Vali Loss: 0.411 Vali Acc: 0.880 Test Loss: 0.411 Test Acc: 0.880
Validation loss decreased (inf --> -0.879996).  Saving model ...
Epoch: 2 cost time: 1.9822628498077393
Epoch: 2, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
Validation loss decreased (-0.879996 --> -0.943331).  Saving model ...
Epoch: 3 cost time: 1.9252164363861084
Epoch: 3, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.212 Vali Acc: 0.963 Test Loss: 0.212 Test Acc: 0.963
Validation loss decreased (-0.943331 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 1.804602861404419
Epoch: 4, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.9243838787078857
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.456 Vali Acc: 0.937 Test Loss: 0.456 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6467621326446533
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0819454193115234
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 2.275352716445923
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.315 Vali Acc: 0.953 Test Loss: 0.315 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3118889331817627
Epoch: 9, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.423 Vali Acc: 0.913 Test Loss: 0.423 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9329779148101807
Epoch: 10, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.536 Vali Acc: 0.810 Test Loss: 1.536 Test Acc: 0.810
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9281322956085205
Epoch: 11, Steps: 18 | Train Loss: 0.629 Vali Loss: 1.339 Vali Acc: 0.877 Test Loss: 1.339 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8623197078704834
Epoch: 12, Steps: 18 | Train Loss: 0.249 Vali Loss: 1.036 Vali Acc: 0.887 Test Loss: 1.036 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1918864250183105
Epoch: 13, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.784 Vali Acc: 0.930 Test Loss: 0.784 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.363593101501465
Epoch: 14, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.791 Vali Acc: 0.927 Test Loss: 0.791 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.355999231338501
Epoch: 15, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.446 Vali Acc: 0.937 Test Loss: 0.446 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.203078508377075
Epoch: 16, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.457 Vali Acc: 0.943 Test Loss: 0.457 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8554584980010986
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.933 Test Loss: 0.511 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 3445325
model size : 22.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.851137638092041
Epoch: 1, Steps: 18 | Train Loss: 2.117 Vali Loss: 0.472 Vali Acc: 0.873 Test Loss: 0.472 Test Acc: 0.873
Validation loss decreased (inf --> -0.873329).  Saving model ...
Epoch: 2 cost time: 2.4465627670288086
Epoch: 2, Steps: 18 | Train Loss: 0.164 Vali Loss: 0.229 Vali Acc: 0.947 Test Loss: 0.229 Test Acc: 0.947
Validation loss decreased (-0.873329 --> -0.946664).  Saving model ...
Epoch: 3 cost time: 2.137042999267578
Epoch: 3, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.199 Vali Acc: 0.963 Test Loss: 0.199 Test Acc: 0.963
Validation loss decreased (-0.946664 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 2.007464647293091
Epoch: 4, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.261 Vali Acc: 0.940 Test Loss: 0.261 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2001705169677734
Epoch: 5, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.301 Vali Acc: 0.943 Test Loss: 0.301 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1837971210479736
Epoch: 6, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.255 Vali Acc: 0.953 Test Loss: 0.255 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8357186317443848
Epoch: 7, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.391 Vali Acc: 0.940 Test Loss: 0.391 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9608519077301025
Epoch: 8, Steps: 18 | Train Loss: 0.146 Vali Loss: 0.694 Vali Acc: 0.893 Test Loss: 0.694 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.150944232940674
Epoch: 9, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.730 Vali Acc: 0.873 Test Loss: 0.730 Test Acc: 0.873
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.042603015899658
Epoch: 10, Steps: 18 | Train Loss: 0.148 Vali Loss: 0.636 Vali Acc: 0.903 Test Loss: 0.636 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.4014735221862793
Epoch: 11, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.892 Vali Acc: 0.910 Test Loss: 0.892 Test Acc: 0.910
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4122278690338135
Epoch: 12, Steps: 18 | Train Loss: 0.139 Vali Loss: 0.796 Vali Acc: 0.920 Test Loss: 0.796 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.264007329940796
Epoch: 13, Steps: 18 | Train Loss: 0.239 Vali Loss: 0.888 Vali Acc: 0.883 Test Loss: 0.888 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 3445325
model size : 22.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.142038106918335
Epoch: 1, Steps: 18 | Train Loss: 2.021 Vali Loss: 0.246 Vali Acc: 0.923 Test Loss: 0.246 Test Acc: 0.923
Validation loss decreased (inf --> -0.923331).  Saving model ...
Epoch: 2 cost time: 2.054513692855835
Epoch: 2, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.145 Vali Acc: 0.950 Test Loss: 0.145 Test Acc: 0.950
Validation loss decreased (-0.923331 --> -0.949999).  Saving model ...
Epoch: 3 cost time: 2.2458441257476807
Epoch: 3, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.190 Vali Acc: 0.953 Test Loss: 0.190 Test Acc: 0.953
Validation loss decreased (-0.949999 --> -0.953331).  Saving model ...
Epoch: 4 cost time: 2.2922849655151367
Epoch: 4, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.206 Vali Acc: 0.947 Test Loss: 0.206 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0449001789093018
Epoch: 5, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.207 Vali Acc: 0.963 Test Loss: 0.207 Test Acc: 0.963
Validation loss decreased (-0.953331 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 2.428863525390625
Epoch: 6, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.189 Vali Acc: 0.967 Test Loss: 0.189 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 2.558420181274414
Epoch: 7, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.252 Vali Acc: 0.963 Test Loss: 0.252 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5581893920898438
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.835 Vali Acc: 0.880 Test Loss: 0.835 Test Acc: 0.880
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7088544368743896
Epoch: 9, Steps: 18 | Train Loss: 0.168 Vali Loss: 0.228 Vali Acc: 0.947 Test Loss: 0.228 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5324623584747314
Epoch: 10, Steps: 18 | Train Loss: 0.343 Vali Loss: 0.670 Vali Acc: 0.877 Test Loss: 0.670 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7444095611572266
Epoch: 11, Steps: 18 | Train Loss: 0.138 Vali Loss: 1.198 Vali Acc: 0.893 Test Loss: 1.198 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6610348224639893
Epoch: 12, Steps: 18 | Train Loss: 0.157 Vali Loss: 1.052 Vali Acc: 0.910 Test Loss: 1.052 Test Acc: 0.910
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.497006416320801
Epoch: 13, Steps: 18 | Train Loss: 0.254 Vali Loss: 0.888 Vali Acc: 0.937 Test Loss: 0.888 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1476755142211914
Epoch: 14, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.741 Vali Acc: 0.960 Test Loss: 0.741 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.5039522647857666
Epoch: 15, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.064 Vali Acc: 0.903 Test Loss: 1.064 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.1313185691833496
Epoch: 16, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.984 Vali Acc: 0.907 Test Loss: 0.984 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 2921037
model size : 20.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.769009828567505
Epoch: 1, Steps: 18 | Train Loss: 2.017 Vali Loss: 0.254 Vali Acc: 0.923 Test Loss: 0.254 Test Acc: 0.923
Validation loss decreased (inf --> -0.923331).  Saving model ...
Epoch: 2 cost time: 2.6020212173461914
Epoch: 2, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.158 Vali Acc: 0.953 Test Loss: 0.158 Test Acc: 0.953
Validation loss decreased (-0.923331 --> -0.953332).  Saving model ...
Epoch: 3 cost time: 2.5933268070220947
Epoch: 3, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.208 Vali Acc: 0.960 Test Loss: 0.208 Test Acc: 0.960
Validation loss decreased (-0.953332 --> -0.959998).  Saving model ...
Epoch: 4 cost time: 2.2168197631835938
Epoch: 4, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.224 Vali Acc: 0.953 Test Loss: 0.224 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.156003952026367
Epoch: 5, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.795487642288208
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.977 Test Loss: 0.175 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.6593170166015625
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.983 Test Loss: 0.157 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 2.2693419456481934
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.960 Test Loss: 0.207 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2654330730438232
Epoch: 9, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.358 Vali Acc: 0.913 Test Loss: 0.358 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.196305751800537
Epoch: 10, Steps: 18 | Train Loss: 0.287 Vali Loss: 0.673 Vali Acc: 0.903 Test Loss: 0.673 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1997735500335693
Epoch: 11, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.782 Vali Acc: 0.890 Test Loss: 0.782 Test Acc: 0.890
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.192751884460449
Epoch: 12, Steps: 18 | Train Loss: 0.122 Vali Loss: 1.247 Vali Acc: 0.863 Test Loss: 1.247 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.22053599357605
Epoch: 13, Steps: 18 | Train Loss: 0.280 Vali Loss: 0.558 Vali Acc: 0.943 Test Loss: 0.558 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.1615724563598633
Epoch: 14, Steps: 18 | Train Loss: 0.158 Vali Loss: 0.983 Vali Acc: 0.893 Test Loss: 0.983 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.1765193939208984
Epoch: 15, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.702 Vali Acc: 0.937 Test Loss: 0.702 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.3590235710144043
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.904 Vali Acc: 0.927 Test Loss: 0.904 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.103909730911255
Epoch: 17, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.017 Vali Acc: 0.917 Test Loss: 1.017 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2921037
model size : 20.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.149893760681152
Epoch: 1, Steps: 18 | Train Loss: 2.019 Vali Loss: 0.270 Vali Acc: 0.910 Test Loss: 0.270 Test Acc: 0.910
Validation loss decreased (inf --> -0.909997).  Saving model ...
Epoch: 2 cost time: 2.2081987857818604
Epoch: 2, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.156 Vali Acc: 0.947 Test Loss: 0.156 Test Acc: 0.947
Validation loss decreased (-0.909997 --> -0.946665).  Saving model ...
Epoch: 3 cost time: 2.588926315307617
Epoch: 3, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.254 Vali Acc: 0.940 Test Loss: 0.254 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.469273328781128
Epoch: 4, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.526684045791626
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.953 Test Loss: 0.215 Test Acc: 0.953
Validation loss decreased (-0.946665 --> -0.953331).  Saving model ...
Epoch: 6 cost time: 2.2716965675354004
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
Validation loss decreased (-0.953331 --> -0.963332).  Saving model ...
Epoch: 7 cost time: 2.388460397720337
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.287 Vali Acc: 0.923 Test Loss: 0.287 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2990565299987793
Epoch: 8, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.337 Vali Acc: 0.913 Test Loss: 0.337 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3496718406677246
Epoch: 9, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.913 Vali Acc: 0.910 Test Loss: 0.913 Test Acc: 0.910
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7394113540649414
Epoch: 10, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.433 Vali Acc: 0.933 Test Loss: 0.433 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6988821029663086
Epoch: 11, Steps: 18 | Train Loss: 0.144 Vali Loss: 1.239 Vali Acc: 0.863 Test Loss: 1.239 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.10434889793396
Epoch: 12, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.614 Vali Acc: 0.937 Test Loss: 0.614 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.629498243331909
Epoch: 13, Steps: 18 | Train Loss: 0.356 Vali Loss: 0.650 Vali Acc: 0.953 Test Loss: 0.650 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.478545665740967
Epoch: 14, Steps: 18 | Train Loss: 0.268 Vali Loss: 0.723 Vali Acc: 0.953 Test Loss: 0.723 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2689805030822754
Epoch: 15, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.714 Vali Acc: 0.957 Test Loss: 0.714 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.916689157485962
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.086 Vali Acc: 0.930 Test Loss: 1.086 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 2921037
model size : 20.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.2924041748046875
Epoch: 1, Steps: 18 | Train Loss: 2.083 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
Validation loss decreased (inf --> -0.899997).  Saving model ...
Epoch: 2 cost time: 1.9344964027404785
Epoch: 2, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.207 Vali Acc: 0.927 Test Loss: 0.207 Test Acc: 0.927
Validation loss decreased (-0.899997 --> -0.926665).  Saving model ...
Epoch: 3 cost time: 1.8222987651824951
Epoch: 3, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.241 Vali Acc: 0.947 Test Loss: 0.241 Test Acc: 0.947
Validation loss decreased (-0.926665 --> -0.946664).  Saving model ...
Epoch: 4 cost time: 1.8943758010864258
Epoch: 4, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
Validation loss decreased (-0.946664 --> -0.949997).  Saving model ...
Epoch: 5 cost time: 2.012254238128662
Epoch: 5, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
Validation loss decreased (-0.949997 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.7108855247497559
Epoch: 6, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.215 Vali Acc: 0.953 Test Loss: 0.215 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.040494203567505
Epoch: 7, Steps: 18 | Train Loss: 0.151 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.006213903427124
Epoch: 8, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.929140329360962
Epoch: 9, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.613 Vali Acc: 0.900 Test Loss: 0.613 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2935264110565186
Epoch: 10, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.696 Vali Acc: 0.907 Test Loss: 0.696 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1660304069519043
Epoch: 11, Steps: 18 | Train Loss: 0.058 Vali Loss: 1.149 Vali Acc: 0.910 Test Loss: 1.149 Test Acc: 0.910
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.735328197479248
Epoch: 12, Steps: 18 | Train Loss: 0.179 Vali Loss: 0.738 Vali Acc: 0.920 Test Loss: 0.738 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.6991991996765137
Epoch: 13, Steps: 18 | Train Loss: 0.096 Vali Loss: 0.698 Vali Acc: 0.943 Test Loss: 0.698 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.441991090774536
Epoch: 14, Steps: 18 | Train Loss: 0.252 Vali Loss: 1.377 Vali Acc: 0.890 Test Loss: 1.377 Test Acc: 0.890
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8454029560089111
Epoch: 15, Steps: 18 | Train Loss: 0.206 Vali Loss: 0.830 Vali Acc: 0.917 Test Loss: 0.830 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 2921037
model size : 20.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.732508659362793
Epoch: 1, Steps: 18 | Train Loss: 1.895 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (inf --> -0.916664).  Saving model ...
Epoch: 2 cost time: 1.186981201171875
Epoch: 2, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.144 Vali Acc: 0.953 Test Loss: 0.144 Test Acc: 0.953
Validation loss decreased (-0.916664 --> -0.953332).  Saving model ...
Epoch: 3 cost time: 1.0537676811218262
Epoch: 3, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
Validation loss decreased (-0.953332 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.0684607028961182
Epoch: 4, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 1.11663818359375
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1854767799377441
Epoch: 6, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1258320808410645
Epoch: 7, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.572 Vali Acc: 0.887 Test Loss: 0.572 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2241759300231934
Epoch: 8, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.496 Vali Acc: 0.937 Test Loss: 0.496 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.121330976486206
Epoch: 9, Steps: 18 | Train Loss: 0.096 Vali Loss: 0.654 Vali Acc: 0.907 Test Loss: 0.654 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2166478633880615
Epoch: 10, Steps: 18 | Train Loss: 0.196 Vali Loss: 0.584 Vali Acc: 0.913 Test Loss: 0.584 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2514803409576416
Epoch: 11, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.004 Vali Acc: 0.870 Test Loss: 1.004 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1918721199035645
Epoch: 12, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.640 Vali Acc: 0.943 Test Loss: 0.640 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.231489896774292
Epoch: 13, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.753 Vali Acc: 0.937 Test Loss: 0.753 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1614344120025635
Epoch: 14, Steps: 18 | Train Loss: 0.111 Vali Loss: 1.118 Vali Acc: 0.910 Test Loss: 1.118 Test Acc: 0.910
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 2658893
model size : 19.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.016176700592041
Epoch: 1, Steps: 18 | Train Loss: 1.905 Vali Loss: 0.304 Vali Acc: 0.913 Test Loss: 0.304 Test Acc: 0.913
Validation loss decreased (inf --> -0.913330).  Saving model ...
Epoch: 2 cost time: 2.40278697013855
Epoch: 2, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.142 Vali Acc: 0.953 Test Loss: 0.142 Test Acc: 0.953
Validation loss decreased (-0.913330 --> -0.953332).  Saving model ...
Epoch: 3 cost time: 2.3707022666931152
Epoch: 3, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.953332 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 2.023916721343994
Epoch: 4, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.196481943130493
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.123 Vali Acc: 0.983 Test Loss: 0.123 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 2.2739593982696533
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.973 Test Loss: 0.178 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1387827396392822
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.980 Test Loss: 0.167 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.554356336593628
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.980 Test Loss: 0.161 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5022263526916504
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.980 Test Loss: 0.157 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.87136173248291
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.980 Test Loss: 0.157 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.963135242462158
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.980 Test Loss: 0.157 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.9491844177246094
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.980 Test Loss: 0.157 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.5577728748321533
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.980 Test Loss: 0.156 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.76830792427063
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.980 Test Loss: 0.156 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.4388234615325928
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.980 Test Loss: 0.156 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2658893
model size : 19.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.993706703186035
Epoch: 1, Steps: 18 | Train Loss: 1.928 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (inf --> -0.903330).  Saving model ...
Epoch: 2 cost time: 2.618095636367798
Epoch: 2, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
Validation loss decreased (-0.903330 --> -0.959999).  Saving model ...
Epoch: 3 cost time: 2.9096755981445312
Epoch: 3, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
Validation loss decreased (-0.959999 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 2.6127281188964844
Epoch: 4, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 2.1668295860290527
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.960 Test Loss: 0.212 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1697874069213867
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.947 Test Loss: 0.271 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0572407245635986
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.967 Test Loss: 0.194 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.026850461959839
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.947 Test Loss: 0.275 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.187429189682007
Epoch: 9, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.373 Vali Acc: 0.950 Test Loss: 0.373 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.291093349456787
Epoch: 10, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.862 Vali Acc: 0.870 Test Loss: 0.862 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8534393310546875
Epoch: 11, Steps: 18 | Train Loss: 0.267 Vali Loss: 1.149 Vali Acc: 0.873 Test Loss: 1.149 Test Acc: 0.873
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.720907688140869
Epoch: 12, Steps: 18 | Train Loss: 0.267 Vali Loss: 0.689 Vali Acc: 0.910 Test Loss: 0.689 Test Acc: 0.910
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.801922559738159
Epoch: 13, Steps: 18 | Train Loss: 0.102 Vali Loss: 1.165 Vali Acc: 0.900 Test Loss: 1.165 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.3471124172210693
Epoch: 14, Steps: 18 | Train Loss: 0.188 Vali Loss: 1.032 Vali Acc: 0.917 Test Loss: 1.032 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 2658893
model size : 19.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.553835391998291
Epoch: 1, Steps: 18 | Train Loss: 1.985 Vali Loss: 0.391 Vali Acc: 0.897 Test Loss: 0.391 Test Acc: 0.897
Validation loss decreased (inf --> -0.896663).  Saving model ...
Epoch: 2 cost time: 2.4363200664520264
Epoch: 2, Steps: 18 | Train Loss: 0.190 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
Validation loss decreased (-0.896663 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 2.4264564514160156
Epoch: 3, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
Validation loss decreased (-0.949998 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 2.134429454803467
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.273 Vali Acc: 0.937 Test Loss: 0.273 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6148464679718018
Epoch: 5, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.253 Vali Acc: 0.943 Test Loss: 0.253 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1529226303100586
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.318 Vali Acc: 0.940 Test Loss: 0.318 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1665685176849365
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.351 Vali Acc: 0.940 Test Loss: 0.351 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0797176361083984
Epoch: 8, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.555 Vali Acc: 0.930 Test Loss: 0.555 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5466785430908203
Epoch: 9, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.382 Vali Acc: 0.937 Test Loss: 0.382 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7572579383850098
Epoch: 10, Steps: 18 | Train Loss: 0.108 Vali Loss: 0.859 Vali Acc: 0.877 Test Loss: 0.859 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8708789348602295
Epoch: 11, Steps: 18 | Train Loss: 0.339 Vali Loss: 0.844 Vali Acc: 0.880 Test Loss: 0.844 Test Acc: 0.880
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.84614896774292
Epoch: 12, Steps: 18 | Train Loss: 0.294 Vali Loss: 1.376 Vali Acc: 0.870 Test Loss: 1.376 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3829920291900635
Epoch: 13, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.953 Vali Acc: 0.897 Test Loss: 0.953 Test Acc: 0.897
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9566666666666667
model parameter : 2658893
model size : 19.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6169519424438477
Epoch: 1, Steps: 18 | Train Loss: 1.975 Vali Loss: 0.187 Vali Acc: 0.973 Test Loss: 0.187 Test Acc: 0.973
Validation loss decreased (inf --> -0.973331).  Saving model ...
Epoch: 2 cost time: 1.1283602714538574
Epoch: 2, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.004957675933838
Epoch: 3, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0896594524383545
Epoch: 4, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.957 Test Loss: 0.212 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1265015602111816
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
Validation loss decreased (-0.973331 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.0992798805236816
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.960 Test Loss: 0.175 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1119258403778076
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.662 Vali Acc: 0.923 Test Loss: 0.662 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1126012802124023
Epoch: 8, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.155 Vali Acc: 0.977 Test Loss: 0.155 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2076470851898193
Epoch: 9, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.615 Vali Acc: 0.920 Test Loss: 0.615 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1837666034698486
Epoch: 10, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.770 Vali Acc: 0.893 Test Loss: 0.770 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.256484031677246
Epoch: 11, Steps: 18 | Train Loss: 0.303 Vali Loss: 0.893 Vali Acc: 0.910 Test Loss: 0.893 Test Acc: 0.910
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.152982234954834
Epoch: 12, Steps: 18 | Train Loss: 0.265 Vali Loss: 0.716 Vali Acc: 0.937 Test Loss: 0.716 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.202256679534912
Epoch: 13, Steps: 18 | Train Loss: 0.150 Vali Loss: 0.811 Vali Acc: 0.930 Test Loss: 0.811 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2581596374511719
Epoch: 14, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.652 Vali Acc: 0.953 Test Loss: 0.652 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1841654777526855
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.953 Test Loss: 0.680 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2527821
model size : 19.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.570162773132324
Epoch: 1, Steps: 18 | Train Loss: 1.975 Vali Loss: 0.190 Vali Acc: 0.970 Test Loss: 0.190 Test Acc: 0.970
Validation loss decreased (inf --> -0.969998).  Saving model ...
Epoch: 2 cost time: 2.467987060546875
Epoch: 2, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.233 Vali Acc: 0.947 Test Loss: 0.233 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1678531169891357
Epoch: 3, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.188 Vali Acc: 0.970 Test Loss: 0.188 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 2.299865245819092
Epoch: 4, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2419493198394775
Epoch: 5, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.275 Vali Acc: 0.937 Test Loss: 0.275 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.08984375
Epoch: 6, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.262 Vali Acc: 0.963 Test Loss: 0.262 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1367106437683105
Epoch: 7, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.258 Vali Acc: 0.957 Test Loss: 0.258 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.885820150375366
Epoch: 8, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.252 Vali Acc: 0.963 Test Loss: 0.252 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.458739757537842
Epoch: 9, Steps: 18 | Train Loss: 0.126 Vali Loss: 1.217 Vali Acc: 0.817 Test Loss: 1.217 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2922775745391846
Epoch: 10, Steps: 18 | Train Loss: 0.299 Vali Loss: 0.439 Vali Acc: 0.940 Test Loss: 0.439 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.319211721420288
Epoch: 11, Steps: 18 | Train Loss: 0.165 Vali Loss: 0.645 Vali Acc: 0.933 Test Loss: 0.645 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4658150672912598
Epoch: 12, Steps: 18 | Train Loss: 0.170 Vali Loss: 0.602 Vali Acc: 0.947 Test Loss: 0.602 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3522348403930664
Epoch: 13, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.599 Vali Acc: 0.950 Test Loss: 0.599 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 2527821
model size : 19.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.702734708786011
Epoch: 1, Steps: 18 | Train Loss: 1.966 Vali Loss: 0.203 Vali Acc: 0.963 Test Loss: 0.203 Test Acc: 0.963
Validation loss decreased (inf --> -0.963331).  Saving model ...
Epoch: 2 cost time: 2.461235523223877
Epoch: 2, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.241 Vali Acc: 0.940 Test Loss: 0.241 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4129586219787598
Epoch: 3, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.200 Vali Acc: 0.960 Test Loss: 0.200 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3067288398742676
Epoch: 4, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.344883918762207
Epoch: 5, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.306 Vali Acc: 0.930 Test Loss: 0.306 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5212221145629883
Epoch: 6, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.214 Vali Acc: 0.953 Test Loss: 0.214 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5411124229431152
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 2.251116991043091
Epoch: 8, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.450 Vali Acc: 0.930 Test Loss: 0.450 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.36224627494812
Epoch: 9, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.535 Vali Acc: 0.910 Test Loss: 0.535 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0857014656066895
Epoch: 10, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.716 Vali Acc: 0.887 Test Loss: 0.716 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0167648792266846
Epoch: 11, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.565 Vali Acc: 0.947 Test Loss: 0.565 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7065486907958984
Epoch: 12, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.983 Vali Acc: 0.873 Test Loss: 0.983 Test Acc: 0.873
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.937612771987915
Epoch: 13, Steps: 18 | Train Loss: 0.311 Vali Loss: 0.705 Vali Acc: 0.927 Test Loss: 0.705 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7467689514160156
Epoch: 14, Steps: 18 | Train Loss: 0.119 Vali Loss: 1.167 Vali Acc: 0.900 Test Loss: 1.167 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.004467248916626
Epoch: 15, Steps: 18 | Train Loss: 0.227 Vali Loss: 0.838 Vali Acc: 0.933 Test Loss: 0.838 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.16691517829895
Epoch: 16, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.737 Vali Acc: 0.923 Test Loss: 0.737 Test Acc: 0.923
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.316056966781616
Epoch: 17, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.538 Vali Acc: 0.960 Test Loss: 0.538 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 2527821
model size : 19.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.502649784088135
Epoch: 1, Steps: 18 | Train Loss: 2.005 Vali Loss: 0.257 Vali Acc: 0.943 Test Loss: 0.257 Test Acc: 0.943
Validation loss decreased (inf --> -0.943331).  Saving model ...
Epoch: 2 cost time: 2.148623466491699
Epoch: 2, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4758379459381104
Epoch: 3, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.327 Vali Acc: 0.927 Test Loss: 0.327 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6971476078033447
Epoch: 4, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.502 Vali Acc: 0.877 Test Loss: 0.502 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7109687328338623
Epoch: 5, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.338 Vali Acc: 0.923 Test Loss: 0.338 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3075780868530273
Epoch: 6, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.328 Vali Acc: 0.937 Test Loss: 0.328 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.427522897720337
Epoch: 7, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.291 Vali Acc: 0.943 Test Loss: 0.291 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.48197603225708
Epoch: 8, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.515 Vali Acc: 0.920 Test Loss: 0.515 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.021690845489502
Epoch: 9, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
Validation loss decreased (-0.943331 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 1.9502828121185303
Epoch: 10, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.315 Vali Acc: 0.940 Test Loss: 0.315 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9609744548797607
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.559 Vali Acc: 0.917 Test Loss: 0.559 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.304889440536499
Epoch: 12, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.981 Vali Acc: 0.867 Test Loss: 0.981 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.325695037841797
Epoch: 13, Steps: 18 | Train Loss: 0.213 Vali Loss: 0.384 Vali Acc: 0.943 Test Loss: 0.384 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.70853853225708
Epoch: 14, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.489 Vali Acc: 0.940 Test Loss: 0.489 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.475581645965576
Epoch: 15, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.492 Vali Acc: 0.930 Test Loss: 0.492 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9145898818969727
Epoch: 16, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.637 Vali Acc: 0.930 Test Loss: 0.637 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1230990886688232
Epoch: 17, Steps: 18 | Train Loss: 0.142 Vali Loss: 1.447 Vali Acc: 0.877 Test Loss: 1.447 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.4023959636688232
Epoch: 18, Steps: 18 | Train Loss: 0.220 Vali Loss: 0.869 Vali Acc: 0.927 Test Loss: 0.869 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2254292964935303
Epoch: 19, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.806 Vali Acc: 0.927 Test Loss: 0.806 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.95
model parameter : 2527821
model size : 19.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.831816911697388
Epoch: 1, Steps: 18 | Train Loss: 1.907 Vali Loss: 0.269 Vali Acc: 0.940 Test Loss: 0.269 Test Acc: 0.940
Validation loss decreased (inf --> -0.939997).  Saving model ...
Epoch: 2 cost time: 2.3657939434051514
Epoch: 2, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.939997 --> -0.966665).  Saving model ...
Epoch: 3 cost time: 2.009727954864502
Epoch: 3, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.316 Vali Acc: 0.937 Test Loss: 0.316 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8950812816619873
Epoch: 4, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.074547290802002
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 2.4473564624786377
Epoch: 6, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.161 Vali Acc: 0.963 Test Loss: 0.161 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5149343013763428
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.960 Test Loss: 0.203 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4722414016723633
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0272867679595947
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.390 Vali Acc: 0.937 Test Loss: 0.390 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.406731367111206
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.89398193359375
Epoch: 11, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.428 Vali Acc: 0.920 Test Loss: 0.428 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3234128952026367
Epoch: 12, Steps: 18 | Train Loss: 0.212 Vali Loss: 0.701 Vali Acc: 0.897 Test Loss: 0.701 Test Acc: 0.897
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.6678624153137207
Epoch: 13, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.135 Vali Acc: 0.863 Test Loss: 1.135 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8504719734191895
Epoch: 14, Steps: 18 | Train Loss: 0.243 Vali Loss: 1.037 Vali Acc: 0.887 Test Loss: 1.037 Test Acc: 0.887
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.3706653118133545
Epoch: 15, Steps: 18 | Train Loss: 0.491 Vali Loss: 1.070 Vali Acc: 0.910 Test Loss: 1.070 Test Acc: 0.910
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 2462285
model size : 19.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.522899389266968
Epoch: 1, Steps: 18 | Train Loss: 1.908 Vali Loss: 0.277 Vali Acc: 0.940 Test Loss: 0.277 Test Acc: 0.940
Validation loss decreased (inf --> -0.939997).  Saving model ...
Epoch: 2 cost time: 2.6000232696533203
Epoch: 2, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
Validation loss decreased (-0.939997 --> -0.966665).  Saving model ...
Epoch: 3 cost time: 2.8541669845581055
Epoch: 3, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.359 Vali Acc: 0.933 Test Loss: 0.359 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.572847843170166
Epoch: 4, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 2.0304172039031982
Epoch: 5, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.166 Vali Acc: 0.970 Test Loss: 0.166 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9979500770568848
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.890366554260254
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8345797061920166
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 2.121291160583496
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 2.580775499343872
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 2.548372268676758
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 2.3362960815429688
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 2.359950065612793
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 2.0292556285858154
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.117816209793091
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 2.077026128768921
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 2.1642889976501465
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.072364330291748
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.3437564373016357
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 2.1968226432800293
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 2.5075931549072266
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 2.0238771438598633
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.9490747451782227
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.720707654953003
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.258416175842285
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 2.574143171310425
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 2.1602425575256348
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 2.0578203201293945
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 2.6649537086486816
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 2.437692642211914
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 2.300407648086548
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.8999295234680176
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 2.220111608505249
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 2.0786588191986084
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.9976184368133545
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.9735126495361328
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 2.150074005126953
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 2.4692506790161133
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 2.2649528980255127
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 2.01910138130188
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 2.7619574069976807
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 2.6429810523986816
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 2.196733236312866
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 2.258845329284668
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.4931106567382812
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 2.9646174907684326
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 2.051974296569824
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 2.2261435985565186
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 2.540477991104126
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 2.112692356109619
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 2.3381500244140625
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 2.2008609771728516
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 2.3927879333496094
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 2.05076265335083
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 2.319164514541626
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 2.394683837890625
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 2.4984323978424072
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 2.5648016929626465
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 2.140732765197754
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 2.8847460746765137
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 2.658890962600708
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 2.7338485717773438
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.292409896850586
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 2.262852907180786
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 2.1583938598632812
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 2.3921897411346436
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 2.296384811401367
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 2.4083237648010254
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 2.4914193153381348
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 2.5843372344970703
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 71 cost time: 2.4796853065490723
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 2.2927660942077637
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 2.230678081512451
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 2.263848304748535
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 2.3604822158813477
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 2.614511728286743
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 2.2683746814727783
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 2.272111415863037
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 2.1555585861206055
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 1.78324294090271
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 2.2879514694213867
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 2.2103381156921387
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 1.9024956226348877
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 1.7506005764007568
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.8632471561431885
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 2.50258469581604
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 2.367640972137451
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 2.157841920852661
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 1.7287936210632324
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 2.2759246826171875
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 2.5001327991485596
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 1.9284048080444336
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 2.244622230529785
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 2.14640474319458
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 2.2324888706207275
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 2.7774875164031982
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 2.544367790222168
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 2.3591349124908447
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 1.7861356735229492
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 2.263380527496338
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2462285
model size : 19.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.520813703536987
Epoch: 1, Steps: 18 | Train Loss: 1.929 Vali Loss: 0.283 Vali Acc: 0.937 Test Loss: 0.283 Test Acc: 0.937
Validation loss decreased (inf --> -0.936664).  Saving model ...
Epoch: 2 cost time: 2.4396817684173584
Epoch: 2, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.936664 --> -0.973332).  Saving model ...
Epoch: 3 cost time: 2.308560371398926
Epoch: 3, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.354 Vali Acc: 0.930 Test Loss: 0.354 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.537339448928833
Epoch: 4, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0964770317077637
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.947 Test Loss: 0.200 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.984863042831421
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.050611972808838
Epoch: 7, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.940 Test Loss: 0.201 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.698927879333496
Epoch: 8, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.457 Vali Acc: 0.923 Test Loss: 0.457 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8621833324432373
Epoch: 9, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.727 Vali Acc: 0.900 Test Loss: 0.727 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8250386714935303
Epoch: 10, Steps: 18 | Train Loss: 0.216 Vali Loss: 0.561 Vali Acc: 0.897 Test Loss: 0.561 Test Acc: 0.897
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7187047004699707
Epoch: 11, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.592 Vali Acc: 0.917 Test Loss: 0.592 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0772531032562256
Epoch: 12, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.522 Vali Acc: 0.927 Test Loss: 0.522 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 2462285
model size : 19.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.53938889503479
Epoch: 1, Steps: 18 | Train Loss: 2.023 Vali Loss: 0.368 Vali Acc: 0.913 Test Loss: 0.368 Test Acc: 0.913
Validation loss decreased (inf --> -0.913330).  Saving model ...
Epoch: 2 cost time: 2.1731724739074707
Epoch: 2, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
Validation loss decreased (-0.913330 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 2.35471773147583
Epoch: 3, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.260 Vali Acc: 0.947 Test Loss: 0.260 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1850996017456055
Epoch: 4, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.191 Vali Acc: 0.953 Test Loss: 0.191 Test Acc: 0.953
Validation loss decreased (-0.949998 --> -0.953331).  Saving model ...
Epoch: 5 cost time: 1.893968105316162
Epoch: 5, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.425 Vali Acc: 0.920 Test Loss: 0.425 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8800091743469238
Epoch: 6, Steps: 18 | Train Loss: 0.261 Vali Loss: 0.535 Vali Acc: 0.910 Test Loss: 0.535 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8044922351837158
Epoch: 7, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.866 Vali Acc: 0.873 Test Loss: 0.866 Test Acc: 0.873
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8913147449493408
Epoch: 8, Steps: 18 | Train Loss: 0.183 Vali Loss: 1.027 Vali Acc: 0.850 Test Loss: 1.027 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5448787212371826
Epoch: 9, Steps: 18 | Train Loss: 0.166 Vali Loss: 0.559 Vali Acc: 0.907 Test Loss: 0.559 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6967833042144775
Epoch: 10, Steps: 18 | Train Loss: 0.226 Vali Loss: 0.649 Vali Acc: 0.900 Test Loss: 0.649 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7025530338287354
Epoch: 11, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.604 Vali Acc: 0.923 Test Loss: 0.604 Test Acc: 0.923
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.854555606842041
Epoch: 12, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.642 Vali Acc: 0.933 Test Loss: 0.642 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9509861469268799
Epoch: 13, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.632 Vali Acc: 0.920 Test Loss: 0.632 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1070199012756348
Epoch: 14, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.568 Vali Acc: 0.947 Test Loss: 0.568 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9533333333333334
model parameter : 2462285
model size : 19.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.478562593460083
Epoch: 1, Steps: 18 | Train Loss: 2.332 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
Validation loss decreased (inf --> -0.899995).  Saving model ...
Epoch: 2 cost time: 1.6565072536468506
Epoch: 2, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.125 Vali Acc: 0.963 Test Loss: 0.125 Test Acc: 0.963
Validation loss decreased (-0.899995 --> -0.963332).  Saving model ...
Epoch: 3 cost time: 1.872007131576538
Epoch: 3, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6540818214416504
Epoch: 4, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.963332 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 1.9366610050201416
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9263994693756104
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.140458583831787
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0392048358917236
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.180765151977539
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.319345235824585
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.983 Test Loss: 0.132 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.418370008468628
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.983 Test Loss: 0.122 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.4754486083984375
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.983 Test Loss: 0.118 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.4380943775177
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.211437225341797
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2115917
model size : 12.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.913278579711914
Epoch: 1, Steps: 18 | Train Loss: 2.348 Vali Loss: 0.535 Vali Acc: 0.897 Test Loss: 0.535 Test Acc: 0.897
Validation loss decreased (inf --> -0.896661).  Saving model ...
Epoch: 2 cost time: 1.6247498989105225
Epoch: 2, Steps: 18 | Train Loss: 0.166 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
Validation loss decreased (-0.896661 --> -0.956665).  Saving model ...
Epoch: 3 cost time: 1.8438141345977783
Epoch: 3, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.956665 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 2.047011613845825
Epoch: 4, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 2.2619340419769287
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.8776912689208984
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.144 Vali Acc: 0.977 Test Loss: 0.144 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9464309215545654
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.198 Vali Acc: 0.947 Test Loss: 0.198 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9746863842010498
Epoch: 8, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4226596355438232
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.084749698638916
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9571280479431152
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.977 Test Loss: 0.164 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.194462776184082
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.245454788208008
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4656486511230469
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6743967533111572
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2115917
model size : 12.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.383949279785156
Epoch: 1, Steps: 18 | Train Loss: 2.366 Vali Loss: 0.561 Vali Acc: 0.897 Test Loss: 0.561 Test Acc: 0.897
Validation loss decreased (inf --> -0.896661).  Saving model ...
Epoch: 2 cost time: 1.4566543102264404
Epoch: 2, Steps: 18 | Train Loss: 0.183 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
Validation loss decreased (-0.896661 --> -0.959999).  Saving model ...
Epoch: 3 cost time: 1.7258927822113037
Epoch: 3, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.764134407043457
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.959999 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 2.014974355697632
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9458138942718506
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.085667848587036
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1853363513946533
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.092205286026001
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.08522629737854
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0932300090789795
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.336667537689209
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.4233624935150146
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.2514524459838867
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2115917
model size : 12.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.19828462600708
Epoch: 1, Steps: 18 | Train Loss: 2.437 Vali Loss: 0.698 Vali Acc: 0.877 Test Loss: 0.698 Test Acc: 0.877
Validation loss decreased (inf --> -0.876660).  Saving model ...
Epoch: 2 cost time: 1.960890531539917
Epoch: 2, Steps: 18 | Train Loss: 0.259 Vali Loss: 0.198 Vali Acc: 0.943 Test Loss: 0.198 Test Acc: 0.943
Validation loss decreased (-0.876660 --> -0.943331).  Saving model ...
Epoch: 3 cost time: 1.702711820602417
Epoch: 3, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.217 Vali Acc: 0.943 Test Loss: 0.217 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5423948764801025
Epoch: 4, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.171 Vali Acc: 0.953 Test Loss: 0.171 Test Acc: 0.953
Validation loss decreased (-0.943331 --> -0.953332).  Saving model ...
Epoch: 5 cost time: 1.712620735168457
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.243 Vali Acc: 0.943 Test Loss: 0.243 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.931894063949585
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
Validation loss decreased (-0.953332 --> -0.959998).  Saving model ...
Epoch: 7 cost time: 2.1088461875915527
Epoch: 7, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.140505075454712
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.218 Vali Acc: 0.947 Test Loss: 0.218 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.034290075302124
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.840439796447754
Epoch: 10, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8944594860076904
Epoch: 11, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6118535995483398
Epoch: 12, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.326 Vali Acc: 0.937 Test Loss: 0.326 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9987056255340576
Epoch: 13, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.224 Vali Acc: 0.947 Test Loss: 0.224 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1741130352020264
Epoch: 14, Steps: 18 | Train Loss: 0.110 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.336354970932007
Epoch: 15, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.512 Vali Acc: 0.913 Test Loss: 0.512 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.872143268585205
Epoch: 16, Steps: 18 | Train Loss: 0.058 Vali Loss: 1.018 Vali Acc: 0.867 Test Loss: 1.018 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.96
model parameter : 2115917
model size : 12.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.064535617828369
Epoch: 1, Steps: 18 | Train Loss: 2.373 Vali Loss: 0.572 Vali Acc: 0.870 Test Loss: 0.572 Test Acc: 0.870
Validation loss decreased (inf --> -0.869994).  Saving model ...
Epoch: 2 cost time: 1.7901465892791748
Epoch: 2, Steps: 18 | Train Loss: 0.177 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
Validation loss decreased (-0.869994 --> -0.959998).  Saving model ...
Epoch: 3 cost time: 1.8509061336517334
Epoch: 3, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.152 Vali Acc: 0.947 Test Loss: 0.152 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.639596700668335
Epoch: 4, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8316535949707031
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.959998 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 2.2780585289001465
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 2.3756775856018066
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 2.394089698791504
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.038342237472534
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5944764614105225
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7815165519714355
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.85612154006958
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6841514110565186
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7288362979888916
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.847536325454712
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.844658374786377
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.3016045093536377
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1591629
model size : 10.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.6631317138671875
Epoch: 1, Steps: 18 | Train Loss: 2.367 Vali Loss: 0.565 Vali Acc: 0.880 Test Loss: 0.565 Test Acc: 0.880
Validation loss decreased (inf --> -0.879994).  Saving model ...
Epoch: 2 cost time: 1.6046509742736816
Epoch: 2, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
Validation loss decreased (-0.879994 --> -0.966665).  Saving model ...
Epoch: 3 cost time: 1.868978500366211
Epoch: 3, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.063342571258545
Epoch: 4, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3979032039642334
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 2.364802598953247
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 2.430307149887085
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1403777599334717
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.210066080093384
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.369234800338745
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.190591812133789
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8234117031097412
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.856691598892212
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.772254467010498
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8325703144073486
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8105432987213135
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1591629
model size : 10.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.85685396194458
Epoch: 1, Steps: 18 | Train Loss: 2.360 Vali Loss: 0.587 Vali Acc: 0.887 Test Loss: 0.587 Test Acc: 0.887
Validation loss decreased (inf --> -0.886661).  Saving model ...
Epoch: 2 cost time: 1.9853570461273193
Epoch: 2, Steps: 18 | Train Loss: 0.194 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
Validation loss decreased (-0.886661 --> -0.969998).  Saving model ...
Epoch: 3 cost time: 1.8235759735107422
Epoch: 3, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7752034664154053
Epoch: 4, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.438 Vali Acc: 0.933 Test Loss: 0.438 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6489391326904297
Epoch: 5, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7903313636779785
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8012280464172363
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 2.1223156452178955
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.9215073585510254
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.627962350845337
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5611932277679443
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6087989807128906
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9058172702789307
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7055385112762451
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8651349544525146
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8022589683532715
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7328298091888428
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9347736835479736
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7540547847747803
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1591629
model size : 10.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.489671945571899
Epoch: 1, Steps: 18 | Train Loss: 2.388 Vali Loss: 0.697 Vali Acc: 0.873 Test Loss: 0.697 Test Acc: 0.873
Validation loss decreased (inf --> -0.873326).  Saving model ...
Epoch: 2 cost time: 1.7597777843475342
Epoch: 2, Steps: 18 | Train Loss: 0.249 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
Validation loss decreased (-0.873326 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 1.6416261196136475
Epoch: 3, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.855297565460205
Epoch: 4, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.449 Vali Acc: 0.930 Test Loss: 0.449 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7623546123504639
Epoch: 5, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.169 Vali Acc: 0.960 Test Loss: 0.169 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6121435165405273
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.181 Vali Acc: 0.963 Test Loss: 0.181 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 7 cost time: 1.9158308506011963
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.220 Vali Acc: 0.947 Test Loss: 0.220 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9163923263549805
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.316 Vali Acc: 0.923 Test Loss: 0.316 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.620114803314209
Epoch: 9, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8381028175354004
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0437395572662354
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2389962673187256
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 1.935976505279541
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 2.0704472064971924
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9649546146392822
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6037917137145996
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6642694473266602
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.836632251739502
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5759387016296387
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9705564975738525
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7774934768676758
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6791269779205322
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0920302867889404
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1591629
model size : 10.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.637244462966919
Epoch: 1, Steps: 18 | Train Loss: 2.347 Vali Loss: 0.472 Vali Acc: 0.953 Test Loss: 0.472 Test Acc: 0.953
Validation loss decreased (inf --> -0.953329).  Saving model ...
Epoch: 2 cost time: 1.6459920406341553
Epoch: 2, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5636589527130127
Epoch: 3, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.236 Vali Acc: 0.943 Test Loss: 0.236 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.695664405822754
Epoch: 4, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
Validation loss decreased (-0.953329 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 2.0905191898345947
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.9049561023712158
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 2.1727726459503174
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.466862916946411
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4323270320892334
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 2.17155385017395
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 2.136631965637207
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.790290355682373
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.6156761646270752
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.849363088607788
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.9653973579406738
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 2.0820682048797607
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.7761046886444092
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.9455747604370117
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.724236011505127
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.520756721496582
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.5635535717010498
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.8028686046600342
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5323116779327393
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.6665008068084717
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.0144290924072266
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.9461793899536133
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.9777500629425049
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9223287105560303
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.2362303733825684
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.8241429328918457
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.754603385925293
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7129509449005127
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.9447352886199951
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6983046531677246
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.0690808296203613
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.160255193710327
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 2.0933167934417725
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8853299617767334
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.817251205444336
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.073183059692383
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.387260675430298
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.198563575744629
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 2.3639369010925293
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 2.0431275367736816
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.8930706977844238
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.2643139362335205
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 2.091719150543213
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.8599655628204346
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.802083969116211
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.924811601638794
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.9739487171173096
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.930610179901123
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.9036657810211182
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.9661884307861328
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 2.288581132888794
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 1.9069116115570068
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 2.24904727935791
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 2.0836470127105713
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 2.072953701019287
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.080388307571411
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.729504108428955
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.582777738571167
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.6854054927825928
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 2.0453407764434814
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.697484016418457
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 1.7910807132720947
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.9392943382263184
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.8666493892669678
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 1.8650474548339844
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.7617719173431396
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.9303641319274902
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.9073798656463623
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 2.035233974456787
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 2.2685060501098633
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 2.373413562774658
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 1.8367018699645996
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 1.6684250831604004
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 1.6556923389434814
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 1.9046730995178223
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 1.8877055644989014
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.9136948585510254
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 2.1435253620147705
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 2.0528173446655273
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 1.9844815731048584
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 1.6531248092651367
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 2.02133846282959
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 2.1072373390197754
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 2.0777010917663574
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 1.9475421905517578
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 1.5600671768188477
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 1.7824327945709229
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.7445533275604248
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.7336394786834717
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 1.8101305961608887
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 1.707876443862915
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 2.0365564823150635
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 1.8347485065460205
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 1.806859016418457
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 1.9548189640045166
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 2.1115944385528564
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1329485
model size : 9.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.427750587463379
Epoch: 1, Steps: 18 | Train Loss: 2.364 Vali Loss: 0.478 Vali Acc: 0.950 Test Loss: 0.478 Test Acc: 0.950
Validation loss decreased (inf --> -0.949995).  Saving model ...
Epoch: 2 cost time: 1.6740107536315918
Epoch: 2, Steps: 18 | Train Loss: 0.177 Vali Loss: 0.175 Vali Acc: 0.953 Test Loss: 0.175 Test Acc: 0.953
Validation loss decreased (-0.949995 --> -0.953332).  Saving model ...
Epoch: 3 cost time: 1.751185655593872
Epoch: 3, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.244 Vali Acc: 0.943 Test Loss: 0.244 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5078566074371338
Epoch: 4, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
Validation loss decreased (-0.953332 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 1.9644520282745361
Epoch: 5, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 2.005228042602539
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.963332 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.7612473964691162
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.8968119621276855
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 2.1034655570983887
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.7578742504119873
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 2.2215559482574463
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.9953181743621826
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.750392198562622
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.9875030517578125
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.7956969738006592
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.7969646453857422
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.7077791690826416
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.73032546043396
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.7446131706237793
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.9226031303405762
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 2.089698076248169
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.84773588180542
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2465689182281494
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6105024814605713
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.7890400886535645
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 2.042682409286499
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1135077476501465
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.093287944793701
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.6723182201385498
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.8106122016906738
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.8317108154296875
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8378686904907227
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.9161951541900635
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8013532161712646
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7029609680175781
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.753493309020996
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 2.078883171081543
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.119372606277466
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.1126294136047363
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.290926218032837
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.9988882541656494
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.1210527420043945
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 2.2640271186828613
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 2.1272048950195312
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 2.0707154273986816
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.8258881568908691
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.5204596519470215
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.716902494430542
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.681122064590454
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.628722906112671
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.8353276252746582
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.8058218955993652
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.8155388832092285
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.5908114910125732
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.7831676006317139
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 2.0099992752075195
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.7594618797302246
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.7016656398773193
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.9244909286499023
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.092890977859497
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.0991735458374023
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.8466994762420654
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.8057563304901123
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.7750606536865234
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.6285717487335205
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 1.8820929527282715
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.7913918495178223
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.8802075386047363
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 1.8839483261108398
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 2.3297228813171387
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.993441104888916
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.9187073707580566
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.7132668495178223
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.735370397567749
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 2.1079659461975098
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 2.099058151245117
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 2.2226192951202393
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 1.9650743007659912
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1329485
model size : 9.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.853057861328125
Epoch: 1, Steps: 18 | Train Loss: 2.384 Vali Loss: 0.507 Vali Acc: 0.937 Test Loss: 0.507 Test Acc: 0.937
Validation loss decreased (inf --> -0.936662).  Saving model ...
Epoch: 2 cost time: 1.5636780261993408
Epoch: 2, Steps: 18 | Train Loss: 0.194 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7365460395812988
Epoch: 3, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.245 Vali Acc: 0.940 Test Loss: 0.245 Test Acc: 0.940
Validation loss decreased (-0.936662 --> -0.939998).  Saving model ...
Epoch: 4 cost time: 1.8921380043029785
Epoch: 4, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.176 Vali Acc: 0.960 Test Loss: 0.176 Test Acc: 0.960
Validation loss decreased (-0.939998 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 1.6503350734710693
Epoch: 5, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6921098232269287
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963332).  Saving model ...
Epoch: 7 cost time: 1.7504501342773438
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.7403976917266846
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.7719910144805908
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5554845333099365
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.6615431308746338
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.4819636344909668
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.471088171005249
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.6528611183166504
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.5480806827545166
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8104102611541748
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8619437217712402
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9890005588531494
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.391357183456421
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.6388988494873047
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.6780354976654053
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.6144068241119385
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7291154861450195
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.8817903995513916
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.6244776248931885
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.6984221935272217
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 2.1088919639587402
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7913436889648438
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4442660808563232
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6150193214416504
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.5223603248596191
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.77764892578125
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.7944529056549072
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 2.1676740646362305
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8171744346618652
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.5425586700439453
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.5547688007354736
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.9183597564697266
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.7496111392974854
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.7490534782409668
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.6203382015228271
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.0628278255462646
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.5650017261505127
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.70123291015625
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.7596261501312256
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.5475060939788818
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.6447360515594482
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.7953758239746094
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.7017903327941895
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.667923927307129
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.6756486892700195
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.8009886741638184
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.5948288440704346
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.7495157718658447
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.8673179149627686
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 1.7084765434265137
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.7710330486297607
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.7901816368103027
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.547485113143921
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.8476343154907227
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.790839433670044
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.760115623474121
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.5938587188720703
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 1.6162714958190918
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.9908685684204102
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 1.871105432510376
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.653677225112915
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 1.7357637882232666
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 2.097435712814331
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.805405855178833
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.9214293956756592
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.5592784881591797
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.745025396347046
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.5555713176727295
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 1.4736649990081787
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 1.5234613418579102
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 1.5147180557250977
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 1.777332067489624
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1329485
model size : 9.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.495002746582031
Epoch: 1, Steps: 18 | Train Loss: 2.456 Vali Loss: 0.665 Vali Acc: 0.923 Test Loss: 0.665 Test Acc: 0.923
Validation loss decreased (inf --> -0.923327).  Saving model ...
Epoch: 2 cost time: 2.083906412124634
Epoch: 2, Steps: 18 | Train Loss: 0.265 Vali Loss: 0.238 Vali Acc: 0.923 Test Loss: 0.238 Test Acc: 0.923
Validation loss decreased (-0.923327 --> -0.923331).  Saving model ...
Epoch: 3 cost time: 1.7462732791900635
Epoch: 3, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.224 Vali Acc: 0.923 Test Loss: 0.224 Test Acc: 0.923
Validation loss decreased (-0.923331 --> -0.923331).  Saving model ...
Epoch: 4 cost time: 1.5271902084350586
Epoch: 4, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
Validation loss decreased (-0.923331 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 1.6297693252563477
Epoch: 5, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7890629768371582
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 1.6594932079315186
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.803595781326294
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6058883666992188
Epoch: 9, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.220 Vali Acc: 0.953 Test Loss: 0.220 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6205980777740479
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.620877981185913
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5692851543426514
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 1.6197607517242432
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4352281093597412
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8377690315246582
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5151281356811523
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9401297569274902
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.496795654296875
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6595661640167236
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5553219318389893
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7422189712524414
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6597816944122314
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1329485
model size : 9.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.204832077026367
Epoch: 1, Steps: 18 | Train Loss: 2.415 Vali Loss: 0.499 Vali Acc: 0.913 Test Loss: 0.499 Test Acc: 0.913
Validation loss decreased (inf --> -0.913328).  Saving model ...
Epoch: 2 cost time: 1.4449963569641113
Epoch: 2, Steps: 18 | Train Loss: 0.160 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
Validation loss decreased (-0.913328 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 1.7466788291931152
Epoch: 3, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.949998 --> -0.976666).  Saving model ...
Epoch: 4 cost time: 1.7132532596588135
Epoch: 4, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9167580604553223
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.6153137683868408
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.598740816116333
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6776416301727295
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.853337287902832
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.037036895751953
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7997868061065674
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6596636772155762
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5815801620483398
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.588639736175537
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9015307426452637
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1198413
model size : 9.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.9598770141601562
Epoch: 1, Steps: 18 | Train Loss: 2.401 Vali Loss: 0.504 Vali Acc: 0.923 Test Loss: 0.504 Test Acc: 0.923
Validation loss decreased (inf --> -0.923328).  Saving model ...
Epoch: 2 cost time: 1.5417335033416748
Epoch: 2, Steps: 18 | Train Loss: 0.160 Vali Loss: 0.171 Vali Acc: 0.943 Test Loss: 0.171 Test Acc: 0.943
Validation loss decreased (-0.923328 --> -0.943332).  Saving model ...
Epoch: 3 cost time: 1.9392554759979248
Epoch: 3, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.943332 --> -0.979999).  Saving model ...
Epoch: 4 cost time: 1.6140966415405273
Epoch: 4, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7248785495758057
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.7538912296295166
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6597023010253906
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5233805179595947
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5402500629425049
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8107523918151855
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4258933067321777
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.73506498336792
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.8177368640899658
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.5652320384979248
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.7143254280090332
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7470834255218506
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 1.5725460052490234
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.8616468906402588
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5721101760864258
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9693429470062256
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.910088300704956
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.962815284729004
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.6667962074279785
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.753974437713623
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.811880111694336
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.414910078048706
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7023911476135254
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6546144485473633
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8447363376617432
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3484692573547363
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6148242950439453
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.731661319732666
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1198413
model size : 9.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.56867527961731
Epoch: 1, Steps: 18 | Train Loss: 2.421 Vali Loss: 0.534 Vali Acc: 0.923 Test Loss: 0.534 Test Acc: 0.923
Validation loss decreased (inf --> -0.923328).  Saving model ...
Epoch: 2 cost time: 1.8714280128479004
Epoch: 2, Steps: 18 | Train Loss: 0.179 Vali Loss: 0.176 Vali Acc: 0.940 Test Loss: 0.176 Test Acc: 0.940
Validation loss decreased (-0.923328 --> -0.939998).  Saving model ...
Epoch: 3 cost time: 1.4189047813415527
Epoch: 3, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
Validation loss decreased (-0.939998 --> -0.966666).  Saving model ...
Epoch: 4 cost time: 1.664654016494751
Epoch: 4, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.966666 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.7053513526916504
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.7377076148986816
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6867444515228271
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6902801990509033
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4372196197509766
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.132415533065796
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.854487657546997
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.682992935180664
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6753177642822266
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 2.05914044380188
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.6662371158599854
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.636451005935669
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.5308663845062256
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.6409580707550049
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.553419589996338
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.5854837894439697
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.4781620502471924
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.6337485313415527
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.649498701095581
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.6665019989013672
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.6684577465057373
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.9768221378326416
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.7475638389587402
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8214895725250244
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5880000591278076
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9641602039337158
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.9250142574310303
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.4107871055603027
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.621791124343872
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.6621270179748535
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.6627941131591797
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.554056167602539
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.5457758903503418
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.6367521286010742
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.7712821960449219
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.6793744564056396
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.9153342247009277
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1198413
model size : 9.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.1365966796875
Epoch: 1, Steps: 18 | Train Loss: 2.452 Vali Loss: 0.656 Vali Acc: 0.913 Test Loss: 0.656 Test Acc: 0.913
Validation loss decreased (inf --> -0.913327).  Saving model ...
Epoch: 2 cost time: 1.5288569927215576
Epoch: 2, Steps: 18 | Train Loss: 0.240 Vali Loss: 0.214 Vali Acc: 0.940 Test Loss: 0.214 Test Acc: 0.940
Validation loss decreased (-0.913327 --> -0.939998).  Saving model ...
Epoch: 3 cost time: 1.5435750484466553
Epoch: 3, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.160 Vali Acc: 0.963 Test Loss: 0.160 Test Acc: 0.963
Validation loss decreased (-0.939998 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 1.8828465938568115
Epoch: 4, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.155 Vali Acc: 0.953 Test Loss: 0.155 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8148162364959717
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 1.5398225784301758
Epoch: 6, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.262 Vali Acc: 0.940 Test Loss: 0.262 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6481997966766357
Epoch: 7, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.181 Vali Acc: 0.963 Test Loss: 0.181 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.963411569595337
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 1.6868314743041992
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 1.5287280082702637
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5499379634857178
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6760473251342773
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8968727588653564
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.73189377784729
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.717137336730957
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6237132549285889
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7595560550689697
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.888392686843872
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.572366714477539
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 1198413
model size : 9.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.8807694911956787
Epoch: 1, Steps: 18 | Train Loss: 2.373 Vali Loss: 0.507 Vali Acc: 0.933 Test Loss: 0.507 Test Acc: 0.933
Validation loss decreased (inf --> -0.933328).  Saving model ...
Epoch: 2 cost time: 1.37721586227417
Epoch: 2, Steps: 18 | Train Loss: 0.173 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
Validation loss decreased (-0.933328 --> -0.963332).  Saving model ...
Epoch: 3 cost time: 1.5526909828186035
Epoch: 3, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.963332 --> -0.976666).  Saving model ...
Epoch: 4 cost time: 1.578691005706787
Epoch: 4, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7212004661560059
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5600507259368896
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7349293231964111
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.8838818073272705
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 2.1506705284118652
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.8108935356140137
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.625579833984375
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.6392481327056885
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7673530578613281
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.832871675491333
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6174426078796387
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.572148084640503
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7712929248809814
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7401411533355713
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6891658306121826
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.653322696685791
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5245802402496338
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1132877
model size : 9.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6763455867767334
Epoch: 1, Steps: 18 | Train Loss: 2.371 Vali Loss: 0.512 Vali Acc: 0.937 Test Loss: 0.512 Test Acc: 0.937
Validation loss decreased (inf --> -0.936662).  Saving model ...
Epoch: 2 cost time: 1.3319871425628662
Epoch: 2, Steps: 18 | Train Loss: 0.183 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
Validation loss decreased (-0.936662 --> -0.963332).  Saving model ...
Epoch: 3 cost time: 1.819521188735962
Epoch: 3, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.963332 --> -0.976666).  Saving model ...
Epoch: 4 cost time: 1.743804931640625
Epoch: 4, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6860899925231934
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.731921911239624
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.7506418228149414
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.5054442882537842
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.8151025772094727
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.6502203941345215
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.9027254581451416
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.5854852199554443
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5097153186798096
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.574779987335205
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5602991580963135
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6198463439941406
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.54002046585083
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.965698003768921
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.888927698135376
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7642436027526855
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7852756977081299
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1132877
model size : 9.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.8500874042510986
Epoch: 1, Steps: 18 | Train Loss: 2.394 Vali Loss: 0.545 Vali Acc: 0.920 Test Loss: 0.545 Test Acc: 0.920
Validation loss decreased (inf --> -0.919995).  Saving model ...
Epoch: 2 cost time: 1.5227711200714111
Epoch: 2, Steps: 18 | Train Loss: 0.199 Vali Loss: 0.162 Vali Acc: 0.953 Test Loss: 0.162 Test Acc: 0.953
Validation loss decreased (-0.919995 --> -0.953332).  Saving model ...
Epoch: 3 cost time: 1.546001672744751
Epoch: 3, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.953332 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.4728538990020752
Epoch: 4, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6101174354553223
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6232469081878662
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.5442190170288086
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.739579200744629
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.8165838718414307
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.4242174625396729
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.7575218677520752
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.588231086730957
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.9481422901153564
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6606073379516602
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.6478776931762695
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5943150520324707
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7298753261566162
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5460865497589111
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.4874663352966309
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.7207732200622559
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.9551844596862793
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6890547275543213
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.7981760501861572
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 2.1352169513702393
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.874234914779663
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6784396171569824
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6236250400543213
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7112219333648682
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5069172382354736
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4537317752838135
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3740389347076416
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.5143547058105469
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.435396671295166
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1132877
model size : 9.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.691975116729736
Epoch: 1, Steps: 18 | Train Loss: 2.415 Vali Loss: 0.664 Vali Acc: 0.893 Test Loss: 0.664 Test Acc: 0.893
Validation loss decreased (inf --> -0.893327).  Saving model ...
Epoch: 2 cost time: 1.7328112125396729
Epoch: 2, Steps: 18 | Train Loss: 0.269 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
Validation loss decreased (-0.893327 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 1.8851032257080078
Epoch: 3, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.151 Vali Acc: 0.953 Test Loss: 0.151 Test Acc: 0.953
Validation loss decreased (-0.949998 --> -0.953332).  Saving model ...
Epoch: 4 cost time: 1.9548344612121582
Epoch: 4, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.953332 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.617445945739746
Epoch: 5, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0144925117492676
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.824373722076416
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7631394863128662
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6800649166107178
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6774301528930664
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.708549976348877
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.947 Test Loss: 0.211 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.675915241241455
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8824448585510254
Epoch: 13, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.662463665008545
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.262 Vali Acc: 0.947 Test Loss: 0.262 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8923072814941406
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6842317581176758
Epoch: 16, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.289 Vali Acc: 0.960 Test Loss: 0.289 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1132877
model size : 9.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.785876035690308
Epoch: 1, Steps: 18 | Train Loss: 2.283 Vali Loss: 0.502 Vali Acc: 0.907 Test Loss: 0.502 Test Acc: 0.907
Validation loss decreased (inf --> -0.906662).  Saving model ...
Epoch: 2 cost time: 1.7854549884796143
Epoch: 2, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
Validation loss decreased (-0.906662 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 1.7495195865631104
Epoch: 3, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.949998 --> -0.976666).  Saving model ...
Epoch: 4 cost time: 1.553614854812622
Epoch: 4, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5623316764831543
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7710692882537842
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.5379564762115479
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.7408385276794434
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8433506488800049
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.7623662948608398
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.872462272644043
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.806326150894165
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.836799144744873
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0144808292388916
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8586344718933105
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.017169713973999
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7798571586608887
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.104043483734131
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7741727828979492
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6183204650878906
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1100109
model size : 9.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.781646251678467
Epoch: 1, Steps: 18 | Train Loss: 2.281 Vali Loss: 0.494 Vali Acc: 0.903 Test Loss: 0.494 Test Acc: 0.903
Validation loss decreased (inf --> -0.903328).  Saving model ...
Epoch: 2 cost time: 1.4986472129821777
Epoch: 2, Steps: 18 | Train Loss: 0.148 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
Validation loss decreased (-0.903328 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 1.7277119159698486
Epoch: 3, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.949998 --> -0.976666).  Saving model ...
Epoch: 4 cost time: 1.9151103496551514
Epoch: 4, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7395055294036865
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.5678105354309082
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.6159098148345947
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.6133952140808105
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.571471929550171
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.5260725021362305
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.3619213104248047
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5804083347320557
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6595869064331055
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8158419132232666
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5600013732910156
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4628748893737793
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6471967697143555
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7064313888549805
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7737689018249512
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7646141052246094
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1100109
model size : 9.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.836538314819336
Epoch: 1, Steps: 18 | Train Loss: 2.303 Vali Loss: 0.530 Vali Acc: 0.900 Test Loss: 0.530 Test Acc: 0.900
Validation loss decreased (inf --> -0.899995).  Saving model ...
Epoch: 2 cost time: 1.5765867233276367
Epoch: 2, Steps: 18 | Train Loss: 0.173 Vali Loss: 0.169 Vali Acc: 0.947 Test Loss: 0.169 Test Acc: 0.947
Validation loss decreased (-0.899995 --> -0.946665).  Saving model ...
Epoch: 3 cost time: 1.6975984573364258
Epoch: 3, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.946665 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.6831166744232178
Epoch: 4, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7091834545135498
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.6989011764526367
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.3432328701019287
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.54205322265625
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.550173044204712
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.7681968212127686
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.707247257232666
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.524446725845337
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5142731666564941
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5389938354492188
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7029681205749512
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.624305009841919
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4165410995483398
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6312367916107178
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7518408298492432
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1100109
model size : 9.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.108835935592651
Epoch: 1, Steps: 18 | Train Loss: 2.416 Vali Loss: 0.686 Vali Acc: 0.860 Test Loss: 0.686 Test Acc: 0.860
Validation loss decreased (inf --> -0.859993).  Saving model ...
Epoch: 2 cost time: 1.728438138961792
Epoch: 2, Steps: 18 | Train Loss: 0.269 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
Validation loss decreased (-0.859993 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 1.5226733684539795
Epoch: 3, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
Validation loss decreased (-0.949998 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.4495117664337158
Epoch: 4, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4596748352050781
Epoch: 5, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.205 Vali Acc: 0.957 Test Loss: 0.205 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4990413188934326
Epoch: 6, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.212 Vali Acc: 0.957 Test Loss: 0.212 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5971288681030273
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.632537603378296
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.171 Vali Acc: 0.960 Test Loss: 0.171 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7023296356201172
Epoch: 9, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.239 Vali Acc: 0.953 Test Loss: 0.239 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.482405662536621
Epoch: 10, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.214 Vali Acc: 0.963 Test Loss: 0.214 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4960460662841797
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.174 Vali Acc: 0.973 Test Loss: 0.174 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.700939416885376
Epoch: 12, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.211 Vali Acc: 0.970 Test Loss: 0.211 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.592714786529541
Epoch: 13, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.389 Vali Acc: 0.917 Test Loss: 0.389 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7179350852966309
Epoch: 14, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.302 Vali Acc: 0.943 Test Loss: 0.302 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.719545841217041
Epoch: 15, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.227 Vali Acc: 0.967 Test Loss: 0.227 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.474693775177002
Epoch: 16, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.496 Vali Acc: 0.917 Test Loss: 0.496 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6428720951080322
Epoch: 17, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.840 Vali Acc: 0.847 Test Loss: 0.840 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6265640258789062
Epoch: 18, Steps: 18 | Train Loss: 0.142 Vali Loss: 0.488 Vali Acc: 0.927 Test Loss: 0.488 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6599102020263672
Epoch: 19, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.593 Vali Acc: 0.920 Test Loss: 0.593 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.509859561920166
Epoch: 20, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.576 Vali Acc: 0.917 Test Loss: 0.576 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5138027667999268
Epoch: 21, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.440 Vali Acc: 0.930 Test Loss: 0.440 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 1100109
model size : 9.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6823251247406006
Epoch: 1, Steps: 18 | Train Loss: 2.692 Vali Loss: 1.208 Vali Acc: 0.900 Test Loss: 1.208 Test Acc: 0.900
Validation loss decreased (inf --> -0.899988).  Saving model ...
Epoch: 2 cost time: 1.4638338088989258
Epoch: 2, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.899988 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 1.4955706596374512
Epoch: 3, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.949998 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 1.5357964038848877
Epoch: 4, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.6819045543670654
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.973332 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.6210777759552002
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 7 cost time: 1.453996181488037
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4261114597320557
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5698065757751465
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.716611623764038
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.651794195175171
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5218861103057861
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7480437755584717
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5063836574554443
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.830082654953003
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4758002758026123
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1025229
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.7678754329681396
Epoch: 1, Steps: 18 | Train Loss: 2.692 Vali Loss: 1.214 Vali Acc: 0.900 Test Loss: 1.214 Test Acc: 0.900
Validation loss decreased (inf --> -0.899988).  Saving model ...
Epoch: 2 cost time: 1.5384385585784912
Epoch: 2, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.223 Vali Acc: 0.947 Test Loss: 0.223 Test Acc: 0.947
Validation loss decreased (-0.899988 --> -0.946664).  Saving model ...
Epoch: 3 cost time: 1.458383321762085
Epoch: 3, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.946664 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.44950532913208
Epoch: 4, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 1.6808738708496094
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.4944758415222168
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6832692623138428
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5760741233825684
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.518310546875
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5600204467773438
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.661907434463501
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8445944786071777
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.574521780014038
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8444490432739258
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6027228832244873
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1025229
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.9650776386260986
Epoch: 1, Steps: 18 | Train Loss: 2.696 Vali Loss: 1.250 Vali Acc: 0.890 Test Loss: 1.250 Test Acc: 0.890
Validation loss decreased (inf --> -0.889987).  Saving model ...
Epoch: 2 cost time: 1.5048401355743408
Epoch: 2, Steps: 18 | Train Loss: 0.583 Vali Loss: 0.235 Vali Acc: 0.963 Test Loss: 0.235 Test Acc: 0.963
Validation loss decreased (-0.889987 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 1.387317419052124
Epoch: 3, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 1.4992756843566895
Epoch: 4, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4016330242156982
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.4436485767364502
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2986891269683838
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5809967517852783
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4516336917877197
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.523134469985962
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5741608142852783
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.996992826461792
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5657942295074463
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.646897554397583
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.574164867401123
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1025229
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.102965831756592
Epoch: 1, Steps: 18 | Train Loss: 2.744 Vali Loss: 1.426 Vali Acc: 0.840 Test Loss: 1.426 Test Acc: 0.840
Validation loss decreased (inf --> -0.839986).  Saving model ...
Epoch: 2 cost time: 1.5150363445281982
Epoch: 2, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.839986 --> -0.949997).  Saving model ...
Epoch: 3 cost time: 1.444789171218872
Epoch: 3, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.191 Vali Acc: 0.967 Test Loss: 0.191 Test Acc: 0.967
Validation loss decreased (-0.949997 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.7529969215393066
Epoch: 4, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.5119202136993408
Epoch: 5, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8065152168273926
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.6518242359161377
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.618990182876587
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.4674763679504395
Epoch: 9, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.5139923095703125
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4501981735229492
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5144503116607666
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.410228967666626
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3115451335906982
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4807977676391602
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4778144359588623
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7675995826721191
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.580310344696045
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7307977676391602
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1025229
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.251656770706177
Epoch: 1, Steps: 18 | Train Loss: 2.723 Vali Loss: 1.235 Vali Acc: 0.877 Test Loss: 1.235 Test Acc: 0.877
Validation loss decreased (inf --> -0.876654).  Saving model ...
Epoch: 2 cost time: 1.817803144454956
Epoch: 2, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
Validation loss decreased (-0.876654 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 1.6485207080841064
Epoch: 3, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.949998 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.8137764930725098
Epoch: 4, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 1.9234426021575928
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6417300701141357
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.716956615447998
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.4984500408172607
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.5405948162078857
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.7389590740203857
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.8469810485839844
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.8855564594268799
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6217331886291504
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.6537010669708252
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.5017783641815186
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5952365398406982
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.6382405757904053
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.6606955528259277
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8372163772583008
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6959307193756104
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.7269299030303955
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.6839306354522705
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5918138027191162
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4264698028564453
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5390942096710205
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.5942342281341553
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 1.5963144302368164
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 1.6250336170196533
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 1.6035394668579102
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7557287216186523
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5352210998535156
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.8872318267822266
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4679698944091797
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.5901169776916504
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.7576637268066406
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.4269864559173584
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.571526288986206
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.64400315284729
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 763085
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.340934753417969
Epoch: 1, Steps: 18 | Train Loss: 2.709 Vali Loss: 1.242 Vali Acc: 0.880 Test Loss: 1.242 Test Acc: 0.880
Validation loss decreased (inf --> -0.879988).  Saving model ...
Epoch: 2 cost time: 1.7420217990875244
Epoch: 2, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.239 Vali Acc: 0.953 Test Loss: 0.239 Test Acc: 0.953
Validation loss decreased (-0.879988 --> -0.953331).  Saving model ...
Epoch: 3 cost time: 1.8474855422973633
Epoch: 3, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.953331 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 1.9252557754516602
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 1.4978899955749512
Epoch: 5, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6067752838134766
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.72342848777771
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.685607671737671
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.8206226825714111
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.8273656368255615
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.847999095916748
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7842910289764404
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5926179885864258
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.5816714763641357
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.676161289215088
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.242494583129883
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.6504981517791748
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.7207305431365967
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7091753482818604
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0361480712890625
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.7610282897949219
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.7572071552276611
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7346479892730713
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9264941215515137
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6717700958251953
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.708153486251831
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.6385369300842285
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.674088716506958
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8936493396759033
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5901660919189453
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.6617507934570312
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.7343740463256836
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.6748137474060059
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.8117973804473877
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.6141881942749023
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.5825331211090088
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.7617013454437256
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 763085
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.123042345046997
Epoch: 1, Steps: 18 | Train Loss: 2.717 Vali Loss: 1.277 Vali Acc: 0.890 Test Loss: 1.277 Test Acc: 0.890
Validation loss decreased (inf --> -0.889987).  Saving model ...
Epoch: 2 cost time: 1.8646397590637207
Epoch: 2, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.248 Vali Acc: 0.953 Test Loss: 0.248 Test Acc: 0.953
Validation loss decreased (-0.889987 --> -0.953331).  Saving model ...
Epoch: 3 cost time: 1.8199772834777832
Epoch: 3, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.953331 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.757504940032959
Epoch: 4, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.7530386447906494
Epoch: 5, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6066241264343262
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7533726692199707
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.6546413898468018
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6299870014190674
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.7301170825958252
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.6713180541992188
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.9236092567443848
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.894324779510498
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 2.02872896194458
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.7059717178344727
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5205509662628174
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.598937749862671
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.8796026706695557
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8507325649261475
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.7876393795013428
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.6120944023132324
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.6472809314727783
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.4212770462036133
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5791103839874268
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.551037311553955
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.5085883140563965
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.941084623336792
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.6711530685424805
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.591200828552246
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9372427463531494
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.512113094329834
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5840234756469727
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4295463562011719
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4930531978607178
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.6152288913726807
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.6578903198242188
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.6255249977111816
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 763085
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6043221950531006
Epoch: 1, Steps: 18 | Train Loss: 2.760 Vali Loss: 1.434 Vali Acc: 0.863 Test Loss: 1.434 Test Acc: 0.863
Validation loss decreased (inf --> -0.863319).  Saving model ...
Epoch: 2 cost time: 1.4111781120300293
Epoch: 2, Steps: 18 | Train Loss: 0.720 Vali Loss: 0.329 Vali Acc: 0.947 Test Loss: 0.329 Test Acc: 0.947
Validation loss decreased (-0.863319 --> -0.946663).  Saving model ...
Epoch: 3 cost time: 1.5409355163574219
Epoch: 3, Steps: 18 | Train Loss: 0.140 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.946663 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 1.5558652877807617
Epoch: 4, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4557061195373535
Epoch: 5, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6750991344451904
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7090744972229004
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6177947521209717
Epoch: 8, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5060417652130127
Epoch: 9, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.4276015758514404
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5108487606048584
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.642683506011963
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6136527061462402
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3580925464630127
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3753230571746826
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4516549110412598
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5653252601623535
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5343027114868164
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.656432867050171
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7293782234191895
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.469895362854004
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 763085
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.8589775562286377
Epoch: 1, Steps: 18 | Train Loss: 2.764 Vali Loss: 1.235 Vali Acc: 0.887 Test Loss: 1.235 Test Acc: 0.887
Validation loss decreased (inf --> -0.886654).  Saving model ...
Epoch: 2 cost time: 1.4280798435211182
Epoch: 2, Steps: 18 | Train Loss: 0.509 Vali Loss: 0.197 Vali Acc: 0.977 Test Loss: 0.197 Test Acc: 0.977
Validation loss decreased (-0.886654 --> -0.976665).  Saving model ...
Epoch: 3 cost time: 1.484762191772461
Epoch: 3, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 4 cost time: 1.6207849979400635
Epoch: 4, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983333).  Saving model ...
Epoch: 5 cost time: 1.6054110527038574
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6105213165283203
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5098183155059814
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 8 cost time: 1.4587090015411377
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 1.3981764316558838
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 1.4014334678649902
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 1.3922719955444336
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 1.555957317352295
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6907732486724854
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 1.5868923664093018
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 1.6446912288665771
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3323407173156738
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7335517406463623
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5497405529022217
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.5533876419067383
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5064833164215088
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.643676519393921
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5450470447540283
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3929927349090576
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3461661338806152
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4724311828613281
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5100598335266113
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5202949047088623
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5067265033721924
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 632013
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.8240184783935547
Epoch: 1, Steps: 18 | Train Loss: 2.751 Vali Loss: 1.238 Vali Acc: 0.883 Test Loss: 1.238 Test Acc: 0.883
Validation loss decreased (inf --> -0.883321).  Saving model ...
Epoch: 2 cost time: 1.576244592666626
Epoch: 2, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.200 Vali Acc: 0.980 Test Loss: 0.200 Test Acc: 0.980
Validation loss decreased (-0.883321 --> -0.979998).  Saving model ...
Epoch: 3 cost time: 1.5187673568725586
Epoch: 3, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.63018798828125
Epoch: 4, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.979998 --> -0.983333).  Saving model ...
Epoch: 5 cost time: 1.5244879722595215
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 6 cost time: 1.4930782318115234
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.300182580947876
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.529313087463379
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4632222652435303
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.785696029663086
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.691962718963623
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.605900764465332
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.511756181716919
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 1.7954435348510742
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 1.5174965858459473
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6738886833190918
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.500899076461792
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8178870677947998
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.4670827388763428
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7574613094329834
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5345675945281982
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5013837814331055
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6024374961853027
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7617278099060059
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.541384220123291
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3533475399017334
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5140385627746582
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.765653371810913
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 632013
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6367549896240234
Epoch: 1, Steps: 18 | Train Loss: 2.753 Vali Loss: 1.273 Vali Acc: 0.877 Test Loss: 1.273 Test Acc: 0.877
Validation loss decreased (inf --> -0.876654).  Saving model ...
Epoch: 2 cost time: 1.49125337600708
Epoch: 2, Steps: 18 | Train Loss: 0.542 Vali Loss: 0.209 Vali Acc: 0.970 Test Loss: 0.209 Test Acc: 0.970
Validation loss decreased (-0.876654 --> -0.969998).  Saving model ...
Epoch: 3 cost time: 1.400911808013916
Epoch: 3, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 4 cost time: 1.4580063819885254
Epoch: 4, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 5 cost time: 1.3080182075500488
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 6 cost time: 1.6071293354034424
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.583120346069336
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6237151622772217
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6399269104003906
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6812212467193604
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5675337314605713
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 1.6247291564941406
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5725727081298828
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6532931327819824
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 1.5865967273712158
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5958828926086426
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 1.5942018032073975
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 1.7373816967010498
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7047195434570312
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7890501022338867
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.73974609375
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8363020420074463
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 1.615525245666504
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5907645225524902
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6445457935333252
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5981853008270264
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4670295715332031
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 1.4614872932434082
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5612843036651611
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6602096557617188
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.594433069229126
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.8647370338439941
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.7450964450836182
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5565176010131836
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.627964735031128
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4885022640228271
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.4141778945922852
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 632013
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.898319959640503
Epoch: 1, Steps: 18 | Train Loss: 2.772 Vali Loss: 1.405 Vali Acc: 0.867 Test Loss: 1.405 Test Acc: 0.867
Validation loss decreased (inf --> -0.866653).  Saving model ...
Epoch: 2 cost time: 1.5756170749664307
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.281 Vali Acc: 0.960 Test Loss: 0.281 Test Acc: 0.960
Validation loss decreased (-0.866653 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 1.418522834777832
Epoch: 3, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.5140266418457031
Epoch: 4, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.4795567989349365
Epoch: 5, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.3722374439239502
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.566805362701416
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.353536605834961
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5285484790802002
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3919241428375244
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4841091632843018
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.618398666381836
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5982682704925537
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3775925636291504
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.637291431427002
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6346960067749023
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5023572444915771
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5508153438568115
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4626379013061523
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5573577880859375
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5906240940093994
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 632013
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.7508292198181152
Epoch: 1, Steps: 18 | Train Loss: 2.706 Vali Loss: 1.240 Vali Acc: 0.903 Test Loss: 1.240 Test Acc: 0.903
Validation loss decreased (inf --> -0.903321).  Saving model ...
Epoch: 2 cost time: 1.4672696590423584
Epoch: 2, Steps: 18 | Train Loss: 0.541 Vali Loss: 0.215 Vali Acc: 0.960 Test Loss: 0.215 Test Acc: 0.960
Validation loss decreased (-0.903321 --> -0.959998).  Saving model ...
Epoch: 3 cost time: 1.4882092475891113
Epoch: 3, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.959998 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.5478169918060303
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.5078489780426025
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.726630687713623
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 1.5819215774536133
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.4686110019683838
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.5647764205932617
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6610021591186523
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.607377052307129
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.4777183532714844
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.4962446689605713
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6721014976501465
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6178677082061768
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5242061614990234
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7488274574279785
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.5504999160766602
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.5578265190124512
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6475651264190674
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.6083993911743164
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.760068416595459
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6017560958862305
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6274335384368896
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.628000020980835
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7727506160736084
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4852385520935059
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5859184265136719
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9352915287017822
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6340487003326416
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 1.6143825054168701
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9238948822021484
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6456451416015625
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.755155324935913
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5409281253814697
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.4195342063903809
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.5377469062805176
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.4912490844726562
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.6105501651763916
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.6221532821655273
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 566477
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.938816547393799
Epoch: 1, Steps: 18 | Train Loss: 2.705 Vali Loss: 1.231 Vali Acc: 0.913 Test Loss: 1.231 Test Acc: 0.913
Validation loss decreased (inf --> -0.913321).  Saving model ...
Epoch: 2 cost time: 1.7585108280181885
Epoch: 2, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.217 Vali Acc: 0.960 Test Loss: 0.217 Test Acc: 0.960
Validation loss decreased (-0.913321 --> -0.959998).  Saving model ...
Epoch: 3 cost time: 1.5633070468902588
Epoch: 3, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 1.6205222606658936
Epoch: 4, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.5614676475524902
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7084953784942627
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 1.6762933731079102
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.586181402206421
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.697211503982544
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6131577491760254
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4037673473358154
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.5561907291412354
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.5850000381469727
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.470935583114624
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5189621448516846
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5903561115264893
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5400216579437256
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.585068941116333
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.4230973720550537
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.605668067932129
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.51139235496521
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3614373207092285
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.752471685409546
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6853408813476562
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5650177001953125
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6292784214019775
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.733609676361084
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.629342794418335
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 566477
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.935288190841675
Epoch: 1, Steps: 18 | Train Loss: 2.700 Vali Loss: 1.257 Vali Acc: 0.913 Test Loss: 1.257 Test Acc: 0.913
Validation loss decreased (inf --> -0.913321).  Saving model ...
Epoch: 2 cost time: 1.5303082466125488
Epoch: 2, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.227 Vali Acc: 0.960 Test Loss: 0.227 Test Acc: 0.960
Validation loss decreased (-0.913321 --> -0.959998).  Saving model ...
Epoch: 3 cost time: 1.7535343170166016
Epoch: 3, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.5264785289764404
Epoch: 4, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.6178393363952637
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.762655258178711
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.9387156963348389
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.7390637397766113
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.8144817352294922
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7423715591430664
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7649106979370117
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.6545054912567139
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.7569525241851807
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9542186260223389
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0923962593078613
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9015989303588867
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7074499130249023
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.621748685836792
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.584421157836914
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9168505668640137
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.6977572441101074
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9597690105438232
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.586911678314209
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9413704872131348
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8496136665344238
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8542962074279785
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6299924850463867
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8153657913208008
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7959167957305908
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9269130229949951
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.8104543685913086
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.880084753036499
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.6375031471252441
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.715360164642334
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5263290405273438
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.5813941955566406
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.6731383800506592
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.7344396114349365
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8239164352416992
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.7638459205627441
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.050231456756592
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.9450175762176514
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.0985195636749268
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.7357821464538574
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.7664670944213867
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.6014447212219238
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.6089739799499512
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 566477
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6475911140441895
Epoch: 1, Steps: 18 | Train Loss: 2.736 Vali Loss: 1.432 Vali Acc: 0.903 Test Loss: 1.432 Test Acc: 0.903
Validation loss decreased (inf --> -0.903319).  Saving model ...
Epoch: 2 cost time: 1.5334794521331787
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.300 Vali Acc: 0.960 Test Loss: 0.300 Test Acc: 0.960
Validation loss decreased (-0.903319 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 1.5062963962554932
Epoch: 3, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4685266017913818
Epoch: 4, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.959997 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 1.4676604270935059
Epoch: 5, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.4601309299468994
Epoch: 6, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6273088455200195
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.564624547958374
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.501335620880127
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4914734363555908
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6382904052734375
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.3721554279327393
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.4988925457000732
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4125523567199707
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.960 Test Loss: 0.198 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.585500717163086
Epoch: 15, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.223 Vali Acc: 0.943 Test Loss: 0.223 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.622602939605713
Epoch: 16, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5704307556152344
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4447121620178223
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.19746732711792
Epoch: 19, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.434516191482544
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.174724817276001
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1153180599212646
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 566477
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6408472061157227
Epoch: 1, Steps: 18 | Train Loss: 2.805 Vali Loss: 1.297 Vali Acc: 0.900 Test Loss: 1.297 Test Acc: 0.900
Validation loss decreased (inf --> -0.899987).  Saving model ...
Epoch: 2 cost time: 1.6074938774108887
Epoch: 2, Steps: 18 | Train Loss: 0.548 Vali Loss: 0.190 Vali Acc: 0.973 Test Loss: 0.190 Test Acc: 0.973
Validation loss decreased (-0.899987 --> -0.973331).  Saving model ...
Epoch: 3 cost time: 1.4566354751586914
Epoch: 3, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.5098867416381836
Epoch: 4, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.960 Test Loss: 0.116 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5530946254730225
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.6360678672790527
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.4376254081726074
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7658369541168213
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.960 Test Loss: 0.120 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7427763938903809
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.747035026550293
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5876421928405762
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6596879959106445
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.712862491607666
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7802059650421143
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.601883888244629
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6062562465667725
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 533709
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.266002655029297
Epoch: 1, Steps: 18 | Train Loss: 2.783 Vali Loss: 1.292 Vali Acc: 0.900 Test Loss: 1.292 Test Acc: 0.900
Validation loss decreased (inf --> -0.899987).  Saving model ...
Epoch: 2 cost time: 1.5672352313995361
Epoch: 2, Steps: 18 | Train Loss: 0.553 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
Validation loss decreased (-0.899987 --> -0.966665).  Saving model ...
Epoch: 3 cost time: 1.6707870960235596
Epoch: 3, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.899618148803711
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.953 Test Loss: 0.124 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6428112983703613
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.5280539989471436
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6898465156555176
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7764804363250732
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7160046100616455
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8570325374603271
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6898765563964844
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.713352918624878
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7728447914123535
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7636222839355469
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8170371055603027
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 533709
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.623958110809326
Epoch: 1, Steps: 18 | Train Loss: 2.785 Vali Loss: 1.323 Vali Acc: 0.893 Test Loss: 1.323 Test Acc: 0.893
Validation loss decreased (inf --> -0.893320).  Saving model ...
Epoch: 2 cost time: 1.6013438701629639
Epoch: 2, Steps: 18 | Train Loss: 0.584 Vali Loss: 0.211 Vali Acc: 0.967 Test Loss: 0.211 Test Acc: 0.967
Validation loss decreased (-0.893320 --> -0.966665).  Saving model ...
Epoch: 3 cost time: 1.4560184478759766
Epoch: 3, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.5581436157226562
Epoch: 4, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.125 Vali Acc: 0.953 Test Loss: 0.125 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5905017852783203
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.5646498203277588
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5694599151611328
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4768893718719482
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.145 Vali Acc: 0.953 Test Loss: 0.145 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5117342472076416
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.541261911392212
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5041096210479736
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5490972995758057
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6602435111999512
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.5866978168487549
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5106494426727295
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5307788848876953
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5802254676818848
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6706657409667969
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5704681873321533
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6113955974578857
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5904457569122314
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6103343963623047
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3889729976654053
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 533709
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.402282238006592
Epoch: 1, Steps: 18 | Train Loss: 2.802 Vali Loss: 1.482 Vali Acc: 0.863 Test Loss: 1.482 Test Acc: 0.863
Validation loss decreased (inf --> -0.863319).  Saving model ...
Epoch: 2 cost time: 1.2166321277618408
Epoch: 2, Steps: 18 | Train Loss: 0.700 Vali Loss: 0.296 Vali Acc: 0.960 Test Loss: 0.296 Test Acc: 0.960
Validation loss decreased (-0.863319 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 1.4038517475128174
Epoch: 3, Steps: 18 | Train Loss: 0.139 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 1.5310859680175781
Epoch: 4, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.484417200088501
Epoch: 5, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6503491401672363
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.6998703479766846
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.476680040359497
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5758235454559326
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.3798272609710693
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.398911952972412
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.5107946395874023
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5323476791381836
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4364874362945557
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.56494140625
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5916008949279785
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4710030555725098
Epoch: 17, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.722665786743164
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.360199213027954
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3567745685577393
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.47444748878479
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 533709
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.602621555328369
Epoch: 1, Steps: 18 | Train Loss: 2.792 Vali Loss: 1.251 Vali Acc: 0.910 Test Loss: 1.251 Test Acc: 0.910
Validation loss decreased (inf --> -0.909987).  Saving model ...
Epoch: 2 cost time: 1.7396674156188965
Epoch: 2, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.229 Vali Acc: 0.943 Test Loss: 0.229 Test Acc: 0.943
Validation loss decreased (-0.909987 --> -0.943331).  Saving model ...
Epoch: 3 cost time: 1.472773790359497
Epoch: 3, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
Validation loss decreased (-0.943331 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.6711571216583252
Epoch: 4, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.966665 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.7900404930114746
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.960 Test Loss: 0.119 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6391613483428955
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4224340915679932
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.5940437316894531
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.6134099960327148
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6144089698791504
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6335906982421875
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4108116626739502
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 1.4678149223327637
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3819987773895264
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.525045394897461
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8302462100982666
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.70780348777771
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7889511585235596
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6158533096313477
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6765921115875244
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.5313749313354492
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.772003173828125
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.698866605758667
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6933634281158447
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9574065208435059
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.629059076309204
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5962693691253662
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5517489910125732
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.59432053565979
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.8084235191345215
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 517325
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.217740774154663
Epoch: 1, Steps: 18 | Train Loss: 2.795 Vali Loss: 1.263 Vali Acc: 0.917 Test Loss: 1.263 Test Acc: 0.917
Validation loss decreased (inf --> -0.916654).  Saving model ...
Epoch: 2 cost time: 1.591339111328125
Epoch: 2, Steps: 18 | Train Loss: 0.524 Vali Loss: 0.232 Vali Acc: 0.943 Test Loss: 0.232 Test Acc: 0.943
Validation loss decreased (-0.916654 --> -0.943331).  Saving model ...
Epoch: 3 cost time: 1.6191539764404297
Epoch: 3, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.943331 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 1.7482168674468994
Epoch: 4, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.956665 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.5455918312072754
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.127 Vali Acc: 0.960 Test Loss: 0.127 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7284271717071533
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.7540814876556396
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.9168193340301514
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.9074478149414062
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.6432337760925293
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6382114887237549
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.4841883182525635
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 1.624927282333374
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4329016208648682
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4755892753601074
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7433466911315918
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6987574100494385
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6181952953338623
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6575992107391357
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.63047194480896
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.5208570957183838
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4342596530914307
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.567673921585083
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4964098930358887
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.578052043914795
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8256525993347168
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9836721420288086
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7298529148101807
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8820080757141113
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4781460762023926
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 517325
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5973637104034424
Epoch: 1, Steps: 18 | Train Loss: 2.799 Vali Loss: 1.313 Vali Acc: 0.903 Test Loss: 1.313 Test Acc: 0.903
Validation loss decreased (inf --> -0.903320).  Saving model ...
Epoch: 2 cost time: 1.5053248405456543
Epoch: 2, Steps: 18 | Train Loss: 0.553 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.903320 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 1.4334793090820312
Epoch: 3, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
Validation loss decreased (-0.949998 --> -0.959998).  Saving model ...
Epoch: 4 cost time: 1.6650278568267822
Epoch: 4, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.959998 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 1.737910270690918
Epoch: 5, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5844392776489258
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7771751880645752
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7644290924072266
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5977907180786133
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5744264125823975
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.706113338470459
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7358665466308594
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 1.6031322479248047
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1487855911254883
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7269716262817383
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.742335557937622
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6468641757965088
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5386154651641846
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.56614089012146
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 1.596860408782959
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.8360130786895752
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4462785720825195
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.381666660308838
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5254344940185547
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7406654357910156
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.765953779220581
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.6994707584381104
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8485677242279053
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5733511447906494
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6116232872009277
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 517325
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.7234339714050293
Epoch: 1, Steps: 18 | Train Loss: 2.756 Vali Loss: 1.425 Vali Acc: 0.890 Test Loss: 1.425 Test Acc: 0.890
Validation loss decreased (inf --> -0.889986).  Saving model ...
Epoch: 2 cost time: 1.4109995365142822
Epoch: 2, Steps: 18 | Train Loss: 0.674 Vali Loss: 0.309 Vali Acc: 0.957 Test Loss: 0.309 Test Acc: 0.957
Validation loss decreased (-0.889986 --> -0.956664).  Saving model ...
Epoch: 3 cost time: 1.286573886871338
Epoch: 3, Steps: 18 | Train Loss: 0.137 Vali Loss: 0.196 Vali Acc: 0.947 Test Loss: 0.196 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2578556537628174
Epoch: 4, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
Validation loss decreased (-0.956664 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 1.250138759613037
Epoch: 5, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5289933681488037
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.398237705230713
Epoch: 7, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.3500618934631348
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2314038276672363
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2709465026855469
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.351776123046875
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3308358192443848
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3901355266571045
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.3481550216674805
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5650291442871094
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3937616348266602
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3116562366485596
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.3638732433319092
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3443350791931152
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3627738952636719
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2468364238739014
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.362236738204956
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3701527118682861
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.361741542816162
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5542004108428955
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4117884635925293
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4626097679138184
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3923907279968262
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.450024127960205
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.240403652191162
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.5342333316802979
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 517325
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.843313694000244
Epoch: 1, Steps: 18 | Train Loss: 3.096 Vali Loss: 2.128 Vali Acc: 0.630 Test Loss: 2.128 Test Acc: 0.630
Validation loss decreased (inf --> -0.629979).  Saving model ...
Epoch: 2 cost time: 1.6573472023010254
Epoch: 2, Steps: 18 | Train Loss: 1.263 Vali Loss: 0.563 Vali Acc: 0.960 Test Loss: 0.563 Test Acc: 0.960
Validation loss decreased (-0.629979 --> -0.959994).  Saving model ...
Epoch: 3 cost time: 1.3342220783233643
Epoch: 3, Steps: 18 | Train Loss: 0.291 Vali Loss: 0.189 Vali Acc: 0.973 Test Loss: 0.189 Test Acc: 0.973
Validation loss decreased (-0.959994 --> -0.973331).  Saving model ...
Epoch: 4 cost time: 1.392719030380249
Epoch: 4, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 1.656447410583496
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.4672870635986328
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.5525662899017334
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.633765697479248
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.4326114654541016
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.5446157455444336
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.5600051879882812
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.658728837966919
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 1.6899092197418213
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 1.4693527221679688
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 1.6217081546783447
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 1.4808812141418457
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.559863805770874
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5356965065002441
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.4794538021087646
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 1.5373518466949463
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.4348785877227783
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.482527256011963
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6294138431549072
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.534599781036377
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5649759769439697
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 1.2555303573608398
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 1.434175968170166
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3972761631011963
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4184370040893555
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4264426231384277
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.429565191268921
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.498802661895752
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6807172298431396
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.665740966796875
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.3548390865325928
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3013901710510254
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 504461
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5927751064300537
Epoch: 1, Steps: 18 | Train Loss: 3.097 Vali Loss: 2.139 Vali Acc: 0.630 Test Loss: 2.139 Test Acc: 0.630
Validation loss decreased (inf --> -0.629979).  Saving model ...
Epoch: 2 cost time: 1.510373592376709
Epoch: 2, Steps: 18 | Train Loss: 1.271 Vali Loss: 0.575 Vali Acc: 0.957 Test Loss: 0.575 Test Acc: 0.957
Validation loss decreased (-0.629979 --> -0.956661).  Saving model ...
Epoch: 3 cost time: 1.2244670391082764
Epoch: 3, Steps: 18 | Train Loss: 0.303 Vali Loss: 0.193 Vali Acc: 0.973 Test Loss: 0.193 Test Acc: 0.973
Validation loss decreased (-0.956661 --> -0.973331).  Saving model ...
Epoch: 4 cost time: 1.2700481414794922
Epoch: 4, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.417281150817871
Epoch: 5, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.973332 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.395153284072876
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5455083847045898
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4354064464569092
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.3728587627410889
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.5176966190338135
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.5652987957000732
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.480757474899292
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 1.5946671962738037
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 1.4924373626708984
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 1.3454887866973877
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 1.2812557220458984
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 1.4354708194732666
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 1.5882072448730469
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.4757468700408936
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6937425136566162
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.383518934249878
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5578560829162598
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4473810195922852
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.4735221862792969
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 1.5056219100952148
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 1.4134047031402588
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 1.6269950866699219
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6175484657287598
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8124446868896484
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8433237075805664
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.971811056137085
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6912460327148438
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.896087408065796
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.6161000728607178
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.492457389831543
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.5678634643554688
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 504461
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.695289134979248
Epoch: 1, Steps: 18 | Train Loss: 3.079 Vali Loss: 2.152 Vali Acc: 0.627 Test Loss: 2.152 Test Acc: 0.627
Validation loss decreased (inf --> -0.626645).  Saving model ...
Epoch: 2 cost time: 1.4817335605621338
Epoch: 2, Steps: 18 | Train Loss: 1.303 Vali Loss: 0.607 Vali Acc: 0.960 Test Loss: 0.607 Test Acc: 0.960
Validation loss decreased (-0.626645 --> -0.959994).  Saving model ...
Epoch: 3 cost time: 1.5012304782867432
Epoch: 3, Steps: 18 | Train Loss: 0.318 Vali Loss: 0.205 Vali Acc: 0.970 Test Loss: 0.205 Test Acc: 0.970
Validation loss decreased (-0.959994 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 1.4765219688415527
Epoch: 4, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 1.3568000793457031
Epoch: 5, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.7132320404052734
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4241654872894287
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.44317626953125
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 1.2748148441314697
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 1.3953168392181396
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 1.428971767425537
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 1.5309298038482666
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 1.5318448543548584
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 1.3976271152496338
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.681457757949829
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 1.6754767894744873
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 1.4715650081634521
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 1.4122421741485596
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.5048542022705078
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 1.6276631355285645
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.508528470993042
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5137736797332764
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 1.4890785217285156
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.452744483947754
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4855411052703857
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 1.463273525238037
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 27 cost time: 1.4276132583618164
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4356465339660645
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5255181789398193
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6477925777435303
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.419382095336914
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5030207633972168
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.5564696788787842
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5372705459594727
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 35 cost time: 1.519435167312622
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4950017929077148
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4625587463378906
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 38 cost time: 1.5075531005859375
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.600395917892456
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.6200525760650635
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.6696622371673584
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.6558244228363037
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.6026158332824707
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.5559680461883545
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.4553840160369873
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.4591798782348633
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.4789044857025146
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 504461
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.834969997406006
Epoch: 1, Steps: 18 | Train Loss: 3.053 Vali Loss: 2.246 Vali Acc: 0.603 Test Loss: 2.246 Test Acc: 0.603
Validation loss decreased (inf --> -0.603311).  Saving model ...
Epoch: 2 cost time: 1.3469030857086182
Epoch: 2, Steps: 18 | Train Loss: 1.430 Vali Loss: 0.788 Vali Acc: 0.933 Test Loss: 0.788 Test Acc: 0.933
Validation loss decreased (-0.603311 --> -0.933325).  Saving model ...
Epoch: 3 cost time: 1.8222880363464355
Epoch: 3, Steps: 18 | Train Loss: 0.421 Vali Loss: 0.298 Vali Acc: 0.947 Test Loss: 0.298 Test Acc: 0.947
Validation loss decreased (-0.933325 --> -0.946664).  Saving model ...
Epoch: 4 cost time: 1.6669886112213135
Epoch: 4, Steps: 18 | Train Loss: 0.140 Vali Loss: 0.204 Vali Acc: 0.963 Test Loss: 0.204 Test Acc: 0.963
Validation loss decreased (-0.946664 --> -0.963331).  Saving model ...
Epoch: 5 cost time: 1.4195973873138428
Epoch: 5, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.5216095447540283
Epoch: 6, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6137561798095703
Epoch: 7, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5483441352844238
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4271326065063477
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4441637992858887
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.43259859085083
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.963 Test Loss: 0.116 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3785414695739746
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.294942855834961
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.963 Test Loss: 0.116 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3854339122772217
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.115 Vali Acc: 0.963 Test Loss: 0.115 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4229605197906494
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 504461
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.756265878677368
Epoch: 1, Steps: 18 | Train Loss: 3.086 Vali Loss: 2.095 Vali Acc: 0.660 Test Loss: 2.095 Test Acc: 0.660
Validation loss decreased (inf --> -0.659979).  Saving model ...
Epoch: 2 cost time: 1.4156737327575684
Epoch: 2, Steps: 18 | Train Loss: 1.249 Vali Loss: 0.550 Vali Acc: 0.970 Test Loss: 0.550 Test Acc: 0.970
Validation loss decreased (-0.659979 --> -0.969995).  Saving model ...
Epoch: 3 cost time: 1.6897809505462646
Epoch: 3, Steps: 18 | Train Loss: 0.256 Vali Loss: 0.180 Vali Acc: 0.977 Test Loss: 0.180 Test Acc: 0.977
Validation loss decreased (-0.969995 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 1.753535270690918
Epoch: 4, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.106 Vali Acc: 0.987 Test Loss: 0.106 Test Acc: 0.987
Validation loss decreased (-0.976665 --> -0.986666).  Saving model ...
Epoch: 5 cost time: 1.5457217693328857
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.987 Test Loss: 0.092 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 6 cost time: 1.551990032196045
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.987 Test Loss: 0.085 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 7 cost time: 1.7210373878479004
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8833136558532715
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4959924221038818
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.570622444152832
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4798200130462646
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3093769550323486
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.349759817123413
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.864760398864746
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3689556121826172
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.454956293106079
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 373389
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.037110805511475
Epoch: 1, Steps: 18 | Train Loss: 3.081 Vali Loss: 2.092 Vali Acc: 0.667 Test Loss: 2.092 Test Acc: 0.667
Validation loss decreased (inf --> -0.666646).  Saving model ...
Epoch: 2 cost time: 1.539637565612793
Epoch: 2, Steps: 18 | Train Loss: 1.262 Vali Loss: 0.555 Vali Acc: 0.970 Test Loss: 0.555 Test Acc: 0.970
Validation loss decreased (-0.666646 --> -0.969994).  Saving model ...
Epoch: 3 cost time: 1.4017860889434814
Epoch: 3, Steps: 18 | Train Loss: 0.261 Vali Loss: 0.182 Vali Acc: 0.980 Test Loss: 0.182 Test Acc: 0.980
Validation loss decreased (-0.969994 --> -0.979998).  Saving model ...
Epoch: 4 cost time: 1.6581048965454102
Epoch: 4, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.979998 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 1.2916271686553955
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.987 Test Loss: 0.096 Test Acc: 0.987
Validation loss decreased (-0.983332 --> -0.986666).  Saving model ...
Epoch: 6 cost time: 1.4615778923034668
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.987 Test Loss: 0.086 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 7 cost time: 1.7968029975891113
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.331427812576294
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5799462795257568
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.845792293548584
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8227763175964355
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7994205951690674
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6189243793487549
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.396461009979248
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5352728366851807
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3243613243103027
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 373389
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5810086727142334
Epoch: 1, Steps: 18 | Train Loss: 3.080 Vali Loss: 2.118 Vali Acc: 0.657 Test Loss: 2.118 Test Acc: 0.657
Validation loss decreased (inf --> -0.656645).  Saving model ...
Epoch: 2 cost time: 1.2820236682891846
Epoch: 2, Steps: 18 | Train Loss: 1.299 Vali Loss: 0.587 Vali Acc: 0.967 Test Loss: 0.587 Test Acc: 0.967
Validation loss decreased (-0.656645 --> -0.966661).  Saving model ...
Epoch: 3 cost time: 1.4092442989349365
Epoch: 3, Steps: 18 | Train Loss: 0.288 Vali Loss: 0.194 Vali Acc: 0.977 Test Loss: 0.194 Test Acc: 0.977
Validation loss decreased (-0.966661 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 1.3493916988372803
Epoch: 4, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.113 Vali Acc: 0.987 Test Loss: 0.113 Test Acc: 0.987
Validation loss decreased (-0.976665 --> -0.986666).  Saving model ...
Epoch: 5 cost time: 1.2652616500854492
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2193341255187988
Epoch: 6, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.085 Vali Acc: 0.987 Test Loss: 0.085 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 7 cost time: 1.5367403030395508
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 8 cost time: 1.426011085510254
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3952724933624268
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5936548709869385
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5215201377868652
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4632465839385986
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4804747104644775
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 14 cost time: 1.4805352687835693
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3564248085021973
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4207427501678467
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3380861282348633
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6837003231048584
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 19 cost time: 1.4007854461669922
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.34946870803833
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 21 cost time: 1.5393199920654297
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.430938482284546
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 23 cost time: 1.470043420791626
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 24 cost time: 1.4671204090118408
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 25 cost time: 1.4569950103759766
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4596586227416992
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 27 cost time: 1.4381117820739746
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.511017084121704
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 29 cost time: 1.3143599033355713
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3630878925323486
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.466005802154541
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2897586822509766
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4544739723205566
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.4393024444580078
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.5109047889709473
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 36 cost time: 1.3756928443908691
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3511908054351807
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.5684990882873535
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.6941370964050293
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.7624750137329102
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 41 cost time: 1.5939385890960693
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 42 cost time: 1.4960718154907227
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.5752782821655273
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 44 cost time: 1.652794361114502
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3517382144927979
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4554469585418701
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.350926399230957
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.5055139064788818
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.4760065078735352
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.3483397960662842
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.455998182296753
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.3581054210662842
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.428072452545166
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 373389
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.7611443996429443
Epoch: 1, Steps: 18 | Train Loss: 3.008 Vali Loss: 2.188 Vali Acc: 0.643 Test Loss: 2.188 Test Acc: 0.643
Validation loss decreased (inf --> -0.643311).  Saving model ...
Epoch: 2 cost time: 1.334049940109253
Epoch: 2, Steps: 18 | Train Loss: 1.424 Vali Loss: 0.753 Vali Acc: 0.947 Test Loss: 0.753 Test Acc: 0.947
Validation loss decreased (-0.643311 --> -0.946659).  Saving model ...
Epoch: 3 cost time: 1.3424818515777588
Epoch: 3, Steps: 18 | Train Loss: 0.388 Vali Loss: 0.286 Vali Acc: 0.963 Test Loss: 0.286 Test Acc: 0.963
Validation loss decreased (-0.946659 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 1.4721720218658447
Epoch: 4, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 1.57147216796875
Epoch: 5, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.141 Vali Acc: 0.980 Test Loss: 0.141 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.3751435279846191
Epoch: 6, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.370753288269043
Epoch: 7, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3500494956970215
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2570669651031494
Epoch: 9, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.398376703262329
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.328657627105713
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4509644508361816
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4679615497589111
Epoch: 13, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6114494800567627
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3723113536834717
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 373389
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2112858295440674
Epoch: 1, Steps: 18 | Train Loss: 3.090 Vali Loss: 2.052 Vali Acc: 0.780 Test Loss: 2.052 Test Acc: 0.780
Validation loss decreased (inf --> -0.779979).  Saving model ...
Epoch: 2 cost time: 1.2992260456085205
Epoch: 2, Steps: 18 | Train Loss: 1.191 Vali Loss: 0.529 Vali Acc: 0.963 Test Loss: 0.529 Test Acc: 0.963
Validation loss decreased (-0.779979 --> -0.963328).  Saving model ...
Epoch: 3 cost time: 1.2344183921813965
Epoch: 3, Steps: 18 | Train Loss: 0.242 Vali Loss: 0.176 Vali Acc: 0.977 Test Loss: 0.176 Test Acc: 0.977
Validation loss decreased (-0.963328 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 1.3049843311309814
Epoch: 4, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.2927656173706055
Epoch: 5, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.1806702613830566
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.353560447692871
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.394698143005371
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 1.4972074031829834
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6005859375
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7776501178741455
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2667412757873535
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.462805986404419
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 14 cost time: 1.399571180343628
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.580979824066162
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5393967628479004
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5558223724365234
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.468118667602539
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.595139980316162
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.37172532081604
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4298102855682373
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4197120666503906
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5716440677642822
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 307853
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.8679423332214355
Epoch: 1, Steps: 18 | Train Loss: 3.091 Vali Loss: 2.060 Vali Acc: 0.777 Test Loss: 2.060 Test Acc: 0.777
Validation loss decreased (inf --> -0.776646).  Saving model ...
Epoch: 2 cost time: 1.4408352375030518
Epoch: 2, Steps: 18 | Train Loss: 1.205 Vali Loss: 0.540 Vali Acc: 0.957 Test Loss: 0.540 Test Acc: 0.957
Validation loss decreased (-0.776646 --> -0.956661).  Saving model ...
Epoch: 3 cost time: 1.4243662357330322
Epoch: 3, Steps: 18 | Train Loss: 0.251 Vali Loss: 0.180 Vali Acc: 0.973 Test Loss: 0.180 Test Acc: 0.973
Validation loss decreased (-0.956661 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.35176420211792
Epoch: 4, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.3697903156280518
Epoch: 5, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.4848215579986572
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4390590190887451
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5253212451934814
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 1.4620444774627686
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.509131908416748
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5432090759277344
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4200387001037598
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4725978374481201
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 14 cost time: 1.592395544052124
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2126038074493408
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.420078992843628
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3237602710723877
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2945072650909424
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.361478328704834
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2880744934082031
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3671109676361084
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3932976722717285
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4298906326293945
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 307853
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.9684104919433594
Epoch: 1, Steps: 18 | Train Loss: 3.099 Vali Loss: 2.084 Vali Acc: 0.777 Test Loss: 2.084 Test Acc: 0.777
Validation loss decreased (inf --> -0.776646).  Saving model ...
Epoch: 2 cost time: 1.5424857139587402
Epoch: 2, Steps: 18 | Train Loss: 1.249 Vali Loss: 0.572 Vali Acc: 0.950 Test Loss: 0.572 Test Acc: 0.950
Validation loss decreased (-0.776646 --> -0.949994).  Saving model ...
Epoch: 3 cost time: 1.5832240581512451
Epoch: 3, Steps: 18 | Train Loss: 0.274 Vali Loss: 0.189 Vali Acc: 0.980 Test Loss: 0.189 Test Acc: 0.980
Validation loss decreased (-0.949994 --> -0.979998).  Saving model ...
Epoch: 4 cost time: 1.5900819301605225
Epoch: 4, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3016080856323242
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.979998 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.3444559574127197
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
Validation loss decreased (-0.983332 --> -0.986666).  Saving model ...
Epoch: 7 cost time: 1.3468835353851318
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 8 cost time: 1.4495675563812256
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 9 cost time: 1.2747833728790283
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 10 cost time: 1.5531995296478271
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2666904926300049
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 12 cost time: 1.420128345489502
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3911161422729492
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3365423679351807
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 15 cost time: 1.450834035873413
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 16 cost time: 1.355278730392456
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 17 cost time: 1.1557581424713135
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.341322898864746
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 19 cost time: 1.379997968673706
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 20 cost time: 1.383687973022461
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4325041770935059
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 22 cost time: 1.3131506443023682
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 23 cost time: 1.7109811305999756
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4604380130767822
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 25 cost time: 1.5010502338409424
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 26 cost time: 1.4717085361480713
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.614889144897461
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4551701545715332
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3699193000793457
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3713726997375488
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.592562198638916
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4250550270080566
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4272079467773438
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3513720035552979
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.5678138732910156
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 307853
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.589991807937622
Epoch: 1, Steps: 18 | Train Loss: 3.125 Vali Loss: 2.203 Vali Acc: 0.690 Test Loss: 2.203 Test Acc: 0.690
Validation loss decreased (inf --> -0.689978).  Saving model ...
Epoch: 2 cost time: 1.4288392066955566
Epoch: 2, Steps: 18 | Train Loss: 1.426 Vali Loss: 0.756 Vali Acc: 0.920 Test Loss: 0.756 Test Acc: 0.920
Validation loss decreased (-0.689978 --> -0.919992).  Saving model ...
Epoch: 3 cost time: 1.3393449783325195
Epoch: 3, Steps: 18 | Train Loss: 0.388 Vali Loss: 0.282 Vali Acc: 0.953 Test Loss: 0.282 Test Acc: 0.953
Validation loss decreased (-0.919992 --> -0.953331).  Saving model ...
Epoch: 4 cost time: 1.3197605609893799
Epoch: 4, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.178 Vali Acc: 0.970 Test Loss: 0.178 Test Acc: 0.970
Validation loss decreased (-0.953331 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 1.3229751586914062
Epoch: 5, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3959486484527588
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5959784984588623
Epoch: 7, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3109121322631836
Epoch: 8, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3794846534729004
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4804766178131104
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.119 Vali Acc: 0.960 Test Loss: 0.119 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4819817543029785
Epoch: 11, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.963 Test Loss: 0.115 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4986906051635742
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4539623260498047
Epoch: 13, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.123 Vali Acc: 0.963 Test Loss: 0.123 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5206382274627686
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 1.3440885543823242
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.428877830505371
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 1.3734099864959717
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 1.2852299213409424
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.963 Test Loss: 0.107 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3936636447906494
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.275660753250122
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.438495397567749
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 22 cost time: 1.4494550228118896
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 1.295480489730835
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.238957405090332
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1884729862213135
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2555603981018066
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.558119773864746
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 1.379828691482544
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.336784839630127
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4672162532806396
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.351050615310669
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 1.4653587341308594
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 1.3302457332611084
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.769967794418335
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.735015630722046
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4524421691894531
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4462974071502686
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5491199493408203
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.507969856262207
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.6573309898376465
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.398545503616333
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.6823835372924805
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 307853
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.089308977127075
Epoch: 1, Steps: 18 | Train Loss: 2.966 Vali Loss: 2.034 Vali Acc: 0.723 Test Loss: 2.034 Test Acc: 0.723
Validation loss decreased (inf --> -0.723313).  Saving model ...
Epoch: 2 cost time: 1.557399034500122
Epoch: 2, Steps: 18 | Train Loss: 1.159 Vali Loss: 0.540 Vali Acc: 0.963 Test Loss: 0.540 Test Acc: 0.963
Validation loss decreased (-0.723313 --> -0.963328).  Saving model ...
Epoch: 3 cost time: 1.4733679294586182
Epoch: 3, Steps: 18 | Train Loss: 0.231 Vali Loss: 0.174 Vali Acc: 0.973 Test Loss: 0.174 Test Acc: 0.973
Validation loss decreased (-0.963328 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.401723861694336
Epoch: 4, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4983229637145996
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.4125957489013672
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 1.662651777267456
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.5938591957092285
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4246044158935547
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5957238674163818
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3183064460754395
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3780899047851562
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6739108562469482
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4984288215637207
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.36859130859375
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4503555297851562
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5193324089050293
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 275085
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.040262222290039
Epoch: 1, Steps: 18 | Train Loss: 2.970 Vali Loss: 2.039 Vali Acc: 0.730 Test Loss: 2.039 Test Acc: 0.730
Validation loss decreased (inf --> -0.729980).  Saving model ...
Epoch: 2 cost time: 1.217261791229248
Epoch: 2, Steps: 18 | Train Loss: 1.170 Vali Loss: 0.551 Vali Acc: 0.967 Test Loss: 0.551 Test Acc: 0.967
Validation loss decreased (-0.729980 --> -0.966661).  Saving model ...
Epoch: 3 cost time: 1.2600667476654053
Epoch: 3, Steps: 18 | Train Loss: 0.239 Vali Loss: 0.179 Vali Acc: 0.977 Test Loss: 0.179 Test Acc: 0.977
Validation loss decreased (-0.966661 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 1.6283211708068848
Epoch: 4, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4925942420959473
Epoch: 5, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.4593331813812256
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 1.3745629787445068
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7567048072814941
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.5878899097442627
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5774617195129395
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6829681396484375
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4795136451721191
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.446833610534668
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.697495698928833
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 1.4143896102905273
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5015416145324707
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5759727954864502
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6301519870758057
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3822171688079834
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5129010677337646
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.388946294784546
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7978496551513672
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 1.4114840030670166
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.757530689239502
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6428062915802002
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 1.4124038219451904
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 1.4734227657318115
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6869113445281982
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5890858173370361
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 1.7077016830444336
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7425048351287842
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4121575355529785
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.496577262878418
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.4839658737182617
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7115459442138672
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.648374319076538
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.6917483806610107
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.4365928173065186
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.656498908996582
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 275085
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.801995038986206
Epoch: 1, Steps: 18 | Train Loss: 2.973 Vali Loss: 2.080 Vali Acc: 0.727 Test Loss: 2.080 Test Acc: 0.727
Validation loss decreased (inf --> -0.726646).  Saving model ...
Epoch: 2 cost time: 1.4111607074737549
Epoch: 2, Steps: 18 | Train Loss: 1.228 Vali Loss: 0.594 Vali Acc: 0.950 Test Loss: 0.594 Test Acc: 0.950
Validation loss decreased (-0.726646 --> -0.949994).  Saving model ...
Epoch: 3 cost time: 1.4455645084381104
Epoch: 3, Steps: 18 | Train Loss: 0.265 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
Validation loss decreased (-0.949994 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 1.3943536281585693
Epoch: 4, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.3934416770935059
Epoch: 5, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.3266253471374512
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 1.5024495124816895
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3149919509887695
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 1.3060762882232666
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3074321746826172
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3587167263031006
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2443828582763672
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5011801719665527
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.282423496246338
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2871885299682617
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2209031581878662
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4623100757598877
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3509318828582764
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 275085
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.766059160232544
Epoch: 1, Steps: 18 | Train Loss: 3.001 Vali Loss: 2.200 Vali Acc: 0.677 Test Loss: 2.200 Test Acc: 0.677
Validation loss decreased (inf --> -0.676645).  Saving model ...
Epoch: 2 cost time: 1.2371745109558105
Epoch: 2, Steps: 18 | Train Loss: 1.386 Vali Loss: 0.770 Vali Acc: 0.910 Test Loss: 0.770 Test Acc: 0.910
Validation loss decreased (-0.676645 --> -0.909992).  Saving model ...
Epoch: 3 cost time: 1.4798429012298584
Epoch: 3, Steps: 18 | Train Loss: 0.380 Vali Loss: 0.281 Vali Acc: 0.960 Test Loss: 0.281 Test Acc: 0.960
Validation loss decreased (-0.909992 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 1.455291509628296
Epoch: 4, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3041887283325195
Epoch: 5, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
Validation loss decreased (-0.959997 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.3533198833465576
Epoch: 6, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.3683130741119385
Epoch: 7, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1794443130493164
Epoch: 8, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7804138660430908
Epoch: 9, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5809040069580078
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4747333526611328
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4121043682098389
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.519460916519165
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.519629716873169
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4447309970855713
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.110 Vali Acc: 0.963 Test Loss: 0.110 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4239287376403809
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 275085
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.546400785446167
Epoch: 1, Steps: 18 | Train Loss: 2.878 Vali Loss: 1.954 Vali Acc: 0.780 Test Loss: 1.954 Test Acc: 0.780
Validation loss decreased (inf --> -0.779980).  Saving model ...
Epoch: 2 cost time: 1.5553007125854492
Epoch: 2, Steps: 18 | Train Loss: 1.212 Vali Loss: 0.538 Vali Acc: 0.953 Test Loss: 0.538 Test Acc: 0.953
Validation loss decreased (-0.779980 --> -0.953328).  Saving model ...
Epoch: 3 cost time: 1.3998386859893799
Epoch: 3, Steps: 18 | Train Loss: 0.251 Vali Loss: 0.191 Vali Acc: 0.970 Test Loss: 0.191 Test Acc: 0.970
Validation loss decreased (-0.953328 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 1.3160450458526611
Epoch: 4, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.622617244720459
Epoch: 5, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.362297534942627
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.3323023319244385
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.5766143798828125
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.327894687652588
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3449816703796387
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4153451919555664
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 1.2958745956420898
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 1.4302728176116943
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 1.364670753479004
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 1.3025102615356445
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2396326065063477
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1574516296386719
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 1.3852190971374512
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.4019355773925781
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 1.5635766983032227
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.2790310382843018
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 1.4276115894317627
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 1.5053493976593018
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3899133205413818
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 1.5177950859069824
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4927804470062256
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 1.3045430183410645
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4937608242034912
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3913311958312988
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4417164325714111
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.320232629776001
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4765079021453857
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2607860565185547
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.379713773727417
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.3722169399261475
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.6670567989349365
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 258701
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2117960453033447
Epoch: 1, Steps: 18 | Train Loss: 2.888 Vali Loss: 1.967 Vali Acc: 0.773 Test Loss: 1.967 Test Acc: 0.773
Validation loss decreased (inf --> -0.773314).  Saving model ...
Epoch: 2 cost time: 1.5182836055755615
Epoch: 2, Steps: 18 | Train Loss: 1.227 Vali Loss: 0.548 Vali Acc: 0.953 Test Loss: 0.548 Test Acc: 0.953
Validation loss decreased (-0.773314 --> -0.953328).  Saving model ...
Epoch: 3 cost time: 1.2558681964874268
Epoch: 3, Steps: 18 | Train Loss: 0.255 Vali Loss: 0.197 Vali Acc: 0.970 Test Loss: 0.197 Test Acc: 0.970
Validation loss decreased (-0.953328 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 1.2361526489257812
Epoch: 4, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.5556139945983887
Epoch: 5, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6115851402282715
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6388278007507324
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.4737751483917236
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.507986307144165
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.5578579902648926
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.4602456092834473
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 1.5765278339385986
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 1.479541540145874
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 1.3826608657836914
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 1.5106024742126465
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5661351680755615
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 1.7309768199920654
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 1.4733459949493408
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.6041111946105957
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 1.3722729682922363
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.3531734943389893
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5330946445465088
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4299602508544922
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4328129291534424
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 1.4850349426269531
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.389948844909668
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.594141960144043
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.476423740386963
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5593476295471191
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3312578201293945
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.3741846084594727
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5250203609466553
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.5174717903137207
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.5763123035430908
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 258701
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.558469533920288
Epoch: 1, Steps: 18 | Train Loss: 2.883 Vali Loss: 1.998 Vali Acc: 0.757 Test Loss: 1.998 Test Acc: 0.757
Validation loss decreased (inf --> -0.756647).  Saving model ...
Epoch: 2 cost time: 1.7153635025024414
Epoch: 2, Steps: 18 | Train Loss: 1.257 Vali Loss: 0.580 Vali Acc: 0.950 Test Loss: 0.580 Test Acc: 0.950
Validation loss decreased (-0.756647 --> -0.949994).  Saving model ...
Epoch: 3 cost time: 1.3493802547454834
Epoch: 3, Steps: 18 | Train Loss: 0.280 Vali Loss: 0.208 Vali Acc: 0.970 Test Loss: 0.208 Test Acc: 0.970
Validation loss decreased (-0.949994 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 1.3299622535705566
Epoch: 4, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 1.5169429779052734
Epoch: 5, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.3973376750946045
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5901837348937988
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.540804386138916
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 1.4475877285003662
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 1.3370981216430664
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 1.3572089672088623
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 1.3699522018432617
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 1.4420342445373535
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 1.3753471374511719
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 1.4224522113800049
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 1.4916329383850098
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 1.6155619621276855
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 18 cost time: 1.5737829208374023
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 19 cost time: 1.4463129043579102
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6410410404205322
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 21 cost time: 1.4227979183197021
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 22 cost time: 1.4152584075927734
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 23 cost time: 1.4791510105133057
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4450795650482178
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 25 cost time: 1.3617098331451416
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.575089693069458
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4692168235778809
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4699087142944336
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5209901332855225
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6027343273162842
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6304502487182617
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.531576156616211
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.434544324874878
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.536116123199463
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 258701
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.3225088119506836
Epoch: 1, Steps: 18 | Train Loss: 2.916 Vali Loss: 2.116 Vali Acc: 0.727 Test Loss: 2.116 Test Acc: 0.727
Validation loss decreased (inf --> -0.726646).  Saving model ...
Epoch: 2 cost time: 1.2825524806976318
Epoch: 2, Steps: 18 | Train Loss: 1.408 Vali Loss: 0.743 Vali Acc: 0.933 Test Loss: 0.743 Test Acc: 0.933
Validation loss decreased (-0.726646 --> -0.933326).  Saving model ...
Epoch: 3 cost time: 1.4674851894378662
Epoch: 3, Steps: 18 | Train Loss: 0.381 Vali Loss: 0.295 Vali Acc: 0.967 Test Loss: 0.295 Test Acc: 0.967
Validation loss decreased (-0.933326 --> -0.966664).  Saving model ...
Epoch: 4 cost time: 1.2301595211029053
Epoch: 4, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 1.3575315475463867
Epoch: 5, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.3669383525848389
Epoch: 6, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2442874908447266
Epoch: 7, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4043800830841064
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.437753438949585
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3056280612945557
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.272207260131836
Epoch: 11, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.2580993175506592
Epoch: 12, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3544564247131348
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.471971035003662
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2767210006713867
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.119 Vali Acc: 0.963 Test Loss: 0.119 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4053466320037842
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3143863677978516
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3407416343688965
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3742058277130127
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3167307376861572
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2874581813812256
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 258701
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5521738529205322
Epoch: 1, Steps: 18 | Train Loss: 3.031 Vali Loss: 2.091 Vali Acc: 0.687 Test Loss: 2.091 Test Acc: 0.687
Validation loss decreased (inf --> -0.686646).  Saving model ...
Epoch: 2 cost time: 1.4184200763702393
Epoch: 2, Steps: 18 | Train Loss: 1.242 Vali Loss: 0.572 Vali Acc: 0.947 Test Loss: 0.572 Test Acc: 0.947
Validation loss decreased (-0.686646 --> -0.946661).  Saving model ...
Epoch: 3 cost time: 1.3368463516235352
Epoch: 3, Steps: 18 | Train Loss: 0.257 Vali Loss: 0.191 Vali Acc: 0.973 Test Loss: 0.191 Test Acc: 0.973
Validation loss decreased (-0.946661 --> -0.973331).  Saving model ...
Epoch: 4 cost time: 1.581319808959961
Epoch: 4, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.973331 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.676337718963623
Epoch: 5, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.7286930084228516
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.3271656036376953
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3313422203063965
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3005728721618652
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2611300945281982
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6617043018341064
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3244421482086182
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7004995346069336
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4031484127044678
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4195122718811035
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7878930568695068
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 250509
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.712231159210205
Epoch: 1, Steps: 18 | Train Loss: 3.033 Vali Loss: 2.095 Vali Acc: 0.680 Test Loss: 2.095 Test Acc: 0.680
Validation loss decreased (inf --> -0.679979).  Saving model ...
Epoch: 2 cost time: 1.312023401260376
Epoch: 2, Steps: 18 | Train Loss: 1.256 Vali Loss: 0.577 Vali Acc: 0.943 Test Loss: 0.577 Test Acc: 0.943
Validation loss decreased (-0.679979 --> -0.943328).  Saving model ...
Epoch: 3 cost time: 1.4334099292755127
Epoch: 3, Steps: 18 | Train Loss: 0.266 Vali Loss: 0.193 Vali Acc: 0.970 Test Loss: 0.193 Test Acc: 0.970
Validation loss decreased (-0.943328 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 1.356255054473877
Epoch: 4, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 1.680537223815918
Epoch: 5, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.3122682571411133
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.2080562114715576
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4243345260620117
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.268522024154663
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2957446575164795
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3939740657806396
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5323128700256348
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.412292242050171
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5487151145935059
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3623123168945312
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5844917297363281
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 250509
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.231956720352173
Epoch: 1, Steps: 18 | Train Loss: 3.036 Vali Loss: 2.129 Vali Acc: 0.650 Test Loss: 2.129 Test Acc: 0.650
Validation loss decreased (inf --> -0.649979).  Saving model ...
Epoch: 2 cost time: 1.2060110569000244
Epoch: 2, Steps: 18 | Train Loss: 1.297 Vali Loss: 0.615 Vali Acc: 0.940 Test Loss: 0.615 Test Acc: 0.940
Validation loss decreased (-0.649979 --> -0.939994).  Saving model ...
Epoch: 3 cost time: 1.2219176292419434
Epoch: 3, Steps: 18 | Train Loss: 0.290 Vali Loss: 0.207 Vali Acc: 0.970 Test Loss: 0.207 Test Acc: 0.970
Validation loss decreased (-0.939994 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 1.2538490295410156
Epoch: 4, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 1.2316782474517822
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2253174781799316
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2638533115386963
Epoch: 7, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1877014636993408
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.2749989032745361
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2740216255187988
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.253894329071045
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.260774850845337
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.1851108074188232
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2510759830474854
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.3232431411743164
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.2661116123199463
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.0823633670806885
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.2281317710876465
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.2442524433135986
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.2572641372680664
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1711976528167725
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3785216808319092
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3076305389404297
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.3205161094665527
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.3101646900177002
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.2735519409179688
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3921914100646973
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.4182615280151367
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.3351764678955078
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.3342783451080322
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2969305515289307
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3461365699768066
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.23919677734375
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3020563125610352
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2798199653625488
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3149943351745605
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.302445411682129
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2149114608764648
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.1933481693267822
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.223212718963623
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1937341690063477
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.2975785732269287
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.2813599109649658
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2531893253326416
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.223212480545044
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.2365837097167969
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2658348083496094
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.3376333713531494
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.2548484802246094
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.4948654174804688
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.2280120849609375
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.3286340236663818
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 250509
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.3177778720855713
Epoch: 1, Steps: 18 | Train Loss: 3.012 Vali Loss: 2.230 Vali Acc: 0.560 Test Loss: 2.230 Test Acc: 0.560
Validation loss decreased (inf --> -0.559978).  Saving model ...
Epoch: 2 cost time: 1.274564504623413
Epoch: 2, Steps: 18 | Train Loss: 1.425 Vali Loss: 0.789 Vali Acc: 0.920 Test Loss: 0.789 Test Acc: 0.920
Validation loss decreased (-0.559978 --> -0.919992).  Saving model ...
Epoch: 3 cost time: 1.2277047634124756
Epoch: 3, Steps: 18 | Train Loss: 0.397 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
Validation loss decreased (-0.919992 --> -0.949997).  Saving model ...
Epoch: 4 cost time: 1.254826307296753
Epoch: 4, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.183 Vali Acc: 0.953 Test Loss: 0.183 Test Acc: 0.953
Validation loss decreased (-0.949997 --> -0.953332).  Saving model ...
Epoch: 5 cost time: 1.1183886528015137
Epoch: 5, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
Validation loss decreased (-0.953332 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.2155728340148926
Epoch: 6, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.222238302230835
Epoch: 7, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.296781063079834
Epoch: 8, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3065259456634521
Epoch: 9, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3193106651306152
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.239778757095337
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.34358549118042
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.963 Test Loss: 0.122 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2576477527618408
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.121 Vali Acc: 0.960 Test Loss: 0.121 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.323631763458252
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2663447856903076
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.963 Test Loss: 0.121 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1567168235778809
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 250509
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.0750911235809326
Epoch: 1, Steps: 18 | Train Loss: 3.259 Vali Loss: 2.695 Vali Acc: 0.313 Test Loss: 2.695 Test Acc: 0.313
Validation loss decreased (inf --> -0.313306).  Saving model ...
Epoch: 2 cost time: 1.5028207302093506
Epoch: 2, Steps: 18 | Train Loss: 2.183 Vali Loss: 1.561 Vali Acc: 0.850 Test Loss: 1.561 Test Acc: 0.850
Validation loss decreased (-0.313306 --> -0.849984).  Saving model ...
Epoch: 3 cost time: 1.5122981071472168
Epoch: 3, Steps: 18 | Train Loss: 1.071 Vali Loss: 0.735 Vali Acc: 0.930 Test Loss: 0.735 Test Acc: 0.930
Validation loss decreased (-0.849984 --> -0.929993).  Saving model ...
Epoch: 4 cost time: 1.3455018997192383
Epoch: 4, Steps: 18 | Train Loss: 0.398 Vali Loss: 0.360 Vali Acc: 0.947 Test Loss: 0.360 Test Acc: 0.947
Validation loss decreased (-0.929993 --> -0.946663).  Saving model ...
Epoch: 5 cost time: 1.4939846992492676
Epoch: 5, Steps: 18 | Train Loss: 0.160 Vali Loss: 0.222 Vali Acc: 0.963 Test Loss: 0.222 Test Acc: 0.963
Validation loss decreased (-0.946663 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 1.2133715152740479
Epoch: 6, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.167 Vali Acc: 0.980 Test Loss: 0.167 Test Acc: 0.980
Validation loss decreased (-0.963331 --> -0.979998).  Saving model ...
Epoch: 7 cost time: 1.490908145904541
Epoch: 7, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.391641616821289
Epoch: 8, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4127392768859863
Epoch: 9, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2939510345458984
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4896011352539062
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.29205322265625
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3310954570770264
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3732044696807861
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3487896919250488
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3970019817352295
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 250221
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.340536117553711
Epoch: 1, Steps: 18 | Train Loss: 3.249 Vali Loss: 2.687 Vali Acc: 0.310 Test Loss: 2.687 Test Acc: 0.310
Validation loss decreased (inf --> -0.309973).  Saving model ...
Epoch: 2 cost time: 1.4424498081207275
Epoch: 2, Steps: 18 | Train Loss: 2.177 Vali Loss: 1.562 Vali Acc: 0.853 Test Loss: 1.562 Test Acc: 0.853
Validation loss decreased (-0.309973 --> -0.853318).  Saving model ...
Epoch: 3 cost time: 1.5023880004882812
Epoch: 3, Steps: 18 | Train Loss: 1.085 Vali Loss: 0.740 Vali Acc: 0.933 Test Loss: 0.740 Test Acc: 0.933
Validation loss decreased (-0.853318 --> -0.933326).  Saving model ...
Epoch: 4 cost time: 1.1838386058807373
Epoch: 4, Steps: 18 | Train Loss: 0.404 Vali Loss: 0.365 Vali Acc: 0.947 Test Loss: 0.365 Test Acc: 0.947
Validation loss decreased (-0.933326 --> -0.946663).  Saving model ...
Epoch: 5 cost time: 1.574296236038208
Epoch: 5, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.226 Vali Acc: 0.963 Test Loss: 0.226 Test Acc: 0.963
Validation loss decreased (-0.946663 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 1.3420321941375732
Epoch: 6, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.169 Vali Acc: 0.977 Test Loss: 0.169 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.2177956104278564
Epoch: 7, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.3584814071655273
Epoch: 8, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.4073209762573242
Epoch: 9, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.5530402660369873
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5085856914520264
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.212477445602417
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2878851890563965
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.215623378753662
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1871039867401123
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2571847438812256
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1604161262512207
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.094223976135254
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.2794344425201416
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.091430425643921
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4476375579833984
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.4637792110443115
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.3748068809509277
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.44358491897583
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2717623710632324
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3689091205596924
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1592884063720703
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.241636037826538
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2392852306365967
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.297792673110962
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4375016689300537
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3081116676330566
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 250221
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.1667654514312744
Epoch: 1, Steps: 18 | Train Loss: 3.246 Vali Loss: 2.689 Vali Acc: 0.323 Test Loss: 2.689 Test Acc: 0.323
Validation loss decreased (inf --> -0.323306).  Saving model ...
Epoch: 2 cost time: 1.2834970951080322
Epoch: 2, Steps: 18 | Train Loss: 2.201 Vali Loss: 1.599 Vali Acc: 0.857 Test Loss: 1.599 Test Acc: 0.857
Validation loss decreased (-0.323306 --> -0.856651).  Saving model ...
Epoch: 3 cost time: 1.2761964797973633
Epoch: 3, Steps: 18 | Train Loss: 1.128 Vali Loss: 0.787 Vali Acc: 0.927 Test Loss: 0.787 Test Acc: 0.927
Validation loss decreased (-0.856651 --> -0.926659).  Saving model ...
Epoch: 4 cost time: 1.214111089706421
Epoch: 4, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.407 Vali Acc: 0.937 Test Loss: 0.407 Test Acc: 0.937
Validation loss decreased (-0.926659 --> -0.936663).  Saving model ...
Epoch: 5 cost time: 1.2221794128417969
Epoch: 5, Steps: 18 | Train Loss: 0.200 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.936663 --> -0.949997).  Saving model ...
Epoch: 6 cost time: 1.208648681640625
Epoch: 6, Steps: 18 | Train Loss: 0.096 Vali Loss: 0.191 Vali Acc: 0.970 Test Loss: 0.191 Test Acc: 0.970
Validation loss decreased (-0.949997 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 1.2878339290618896
Epoch: 7, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2750470638275146
Epoch: 8, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2976477146148682
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 1.2133724689483643
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2396807670593262
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1052117347717285
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 1.3101046085357666
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2058517932891846
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 1.2223570346832275
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 1.2567634582519531
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 1.2639703750610352
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 1.1512641906738281
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2887043952941895
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 1.1926326751708984
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 21 cost time: 1.2139465808868408
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.106245994567871
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 23 cost time: 1.0863630771636963
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 24 cost time: 1.1183111667633057
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 25 cost time: 1.1513280868530273
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 26 cost time: 1.1354553699493408
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 27 cost time: 1.0814714431762695
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 28 cost time: 1.2212982177734375
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 29 cost time: 1.1735155582427979
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3630495071411133
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 31 cost time: 1.3015575408935547
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 32 cost time: 1.2878072261810303
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 33 cost time: 1.3412065505981445
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 34 cost time: 1.3198585510253906
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 35 cost time: 1.2988688945770264
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 36 cost time: 1.3372368812561035
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 37 cost time: 1.2641406059265137
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2423062324523926
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 39 cost time: 1.2585062980651855
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 40 cost time: 1.2919609546661377
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2012567520141602
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1707789897918701
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 43 cost time: 1.292602300643921
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 44 cost time: 1.1908459663391113
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1091692447662354
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.139491081237793
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 47 cost time: 1.2199363708496094
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1372010707855225
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2358245849609375
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 50 cost time: 1.2345800399780273
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.214317798614502
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.2203314304351807
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.1729238033294678
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 54 cost time: 1.209069013595581
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.2964096069335938
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.332909107208252
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.2484960556030273
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.335325002670288
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 59 cost time: 1.348790168762207
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.3246448040008545
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.0916707515716553
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.2529823780059814
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.2327589988708496
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.1708028316497803
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.302170991897583
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.2283275127410889
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 67 cost time: 1.3087387084960938
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 68 cost time: 1.18070387840271
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.3132104873657227
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.2245821952819824
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 71 cost time: 1.2487106323242188
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 72 cost time: 1.3388097286224365
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.21378755569458
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.4352941513061523
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.1403086185455322
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.10416841506958
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 77 cost time: 1.3874499797821045
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 78 cost time: 1.2368547916412354
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.1938989162445068
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.3220958709716797
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 81 cost time: 1.390199899673462
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 82 cost time: 1.226165533065796
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.2991044521331787
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 84 cost time: 1.253141164779663
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.5293128490447998
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.3341147899627686
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 1.4276795387268066
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.3075766563415527
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 89 cost time: 1.2705755233764648
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 90 cost time: 1.102276086807251
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 1.2675554752349854
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 92 cost time: 1.1624126434326172
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 93 cost time: 1.3902814388275146
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 94 cost time: 1.280139684677124
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.2831711769104004
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 1.2551383972167969
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 97 cost time: 1.3401920795440674
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 98 cost time: 1.2755928039550781
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 99 cost time: 1.4196195602416992
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.2054033279418945
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 250221
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.1807594299316406
Epoch: 1, Steps: 18 | Train Loss: 3.217 Vali Loss: 2.707 Vali Acc: 0.350 Test Loss: 2.707 Test Acc: 0.350
Validation loss decreased (inf --> -0.349973).  Saving model ...
Epoch: 2 cost time: 1.1759686470031738
Epoch: 2, Steps: 18 | Train Loss: 2.293 Vali Loss: 1.712 Vali Acc: 0.800 Test Loss: 1.712 Test Acc: 0.800
Validation loss decreased (-0.349973 --> -0.799983).  Saving model ...
Epoch: 3 cost time: 1.2564988136291504
Epoch: 3, Steps: 18 | Train Loss: 1.268 Vali Loss: 0.930 Vali Acc: 0.913 Test Loss: 0.930 Test Acc: 0.913
Validation loss decreased (-0.799983 --> -0.913324).  Saving model ...
Epoch: 4 cost time: 1.1953938007354736
Epoch: 4, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.523 Vali Acc: 0.937 Test Loss: 0.523 Test Acc: 0.937
Validation loss decreased (-0.913324 --> -0.936661).  Saving model ...
Epoch: 5 cost time: 1.1778349876403809
Epoch: 5, Steps: 18 | Train Loss: 0.294 Vali Loss: 0.331 Vali Acc: 0.947 Test Loss: 0.331 Test Acc: 0.947
Validation loss decreased (-0.936661 --> -0.946663).  Saving model ...
Epoch: 6 cost time: 1.2146334648132324
Epoch: 6, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.253 Vali Acc: 0.953 Test Loss: 0.253 Test Acc: 0.953
Validation loss decreased (-0.946663 --> -0.953331).  Saving model ...
Epoch: 7 cost time: 1.1538922786712646
Epoch: 7, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.215 Vali Acc: 0.967 Test Loss: 0.215 Test Acc: 0.967
Validation loss decreased (-0.953331 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 1.2141938209533691
Epoch: 8, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2367289066314697
Epoch: 9, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.186 Vali Acc: 0.960 Test Loss: 0.186 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2105348110198975
Epoch: 10, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.174 Vali Acc: 0.973 Test Loss: 0.174 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.1591951847076416
Epoch: 11, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.186051368713379
Epoch: 12, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1366796493530273
Epoch: 13, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2546684741973877
Epoch: 14, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.161 Vali Acc: 0.963 Test Loss: 0.161 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2690362930297852
Epoch: 15, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.216148853302002
Epoch: 16, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4060444831848145
Epoch: 17, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2061011791229248
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1877691745758057
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3425681591033936
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 250221
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6410999298095703
Epoch: 1, Steps: 18 | Train Loss: 3.148 Vali Loss: 2.609 Vali Acc: 0.360 Test Loss: 2.609 Test Acc: 0.360
Validation loss decreased (inf --> -0.359974).  Saving model ...
Epoch: 2 cost time: 1.2836315631866455
Epoch: 2, Steps: 18 | Train Loss: 2.111 Vali Loss: 1.493 Vali Acc: 0.873 Test Loss: 1.493 Test Acc: 0.873
Validation loss decreased (-0.359974 --> -0.873318).  Saving model ...
Epoch: 3 cost time: 1.5513975620269775
Epoch: 3, Steps: 18 | Train Loss: 0.995 Vali Loss: 0.678 Vali Acc: 0.947 Test Loss: 0.678 Test Acc: 0.947
Validation loss decreased (-0.873318 --> -0.946660).  Saving model ...
Epoch: 4 cost time: 1.4032924175262451
Epoch: 4, Steps: 18 | Train Loss: 0.378 Vali Loss: 0.329 Vali Acc: 0.960 Test Loss: 0.329 Test Acc: 0.960
Validation loss decreased (-0.946660 --> -0.959997).  Saving model ...
Epoch: 5 cost time: 1.4551451206207275
Epoch: 5, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.207 Vali Acc: 0.967 Test Loss: 0.207 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.2908892631530762
Epoch: 6, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.155 Vali Acc: 0.977 Test Loss: 0.155 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.34159517288208
Epoch: 7, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.2915456295013428
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.1892337799072266
Epoch: 9, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.2164905071258545
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.2343907356262207
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.0883021354675293
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.130065679550171
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.522385597229004
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3536601066589355
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.4234018325805664
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2330291271209717
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.41615891456604
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.285691499710083
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.2954602241516113
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.201108455657959
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.1855828762054443
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.3401198387145996
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.1745376586914062
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1791813373565674
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.0590858459472656
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.2032699584960938
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1064152717590332
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.2066304683685303
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.136305332183838
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.1601128578186035
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.145573616027832
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.013746976852417
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2087292671203613
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2280681133270264
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.5692224502563477
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.184906244277954
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2450695037841797
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2684335708618164
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2297096252441406
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.3751378059387207
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.3655343055725098
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3184480667114258
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.464219331741333
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.4027690887451172
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.3145616054534912
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 184685
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.259575843811035
Epoch: 1, Steps: 18 | Train Loss: 3.147 Vali Loss: 2.616 Vali Acc: 0.370 Test Loss: 2.616 Test Acc: 0.370
Validation loss decreased (inf --> -0.369974).  Saving model ...
Epoch: 2 cost time: 1.382575273513794
Epoch: 2, Steps: 18 | Train Loss: 2.123 Vali Loss: 1.505 Vali Acc: 0.880 Test Loss: 1.505 Test Acc: 0.880
Validation loss decreased (-0.369974 --> -0.879985).  Saving model ...
Epoch: 3 cost time: 1.3848366737365723
Epoch: 3, Steps: 18 | Train Loss: 1.011 Vali Loss: 0.690 Vali Acc: 0.943 Test Loss: 0.690 Test Acc: 0.943
Validation loss decreased (-0.879985 --> -0.943326).  Saving model ...
Epoch: 4 cost time: 1.317383050918579
Epoch: 4, Steps: 18 | Train Loss: 0.389 Vali Loss: 0.337 Vali Acc: 0.963 Test Loss: 0.337 Test Acc: 0.963
Validation loss decreased (-0.943326 --> -0.963330).  Saving model ...
Epoch: 5 cost time: 1.4096848964691162
Epoch: 5, Steps: 18 | Train Loss: 0.152 Vali Loss: 0.212 Vali Acc: 0.963 Test Loss: 0.212 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 1.2235429286956787
Epoch: 6, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.161 Vali Acc: 0.977 Test Loss: 0.161 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.3925738334655762
Epoch: 7, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3443424701690674
Epoch: 8, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.3004472255706787
Epoch: 9, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.357710361480713
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7461774349212646
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.4546756744384766
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.4764244556427002
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4324660301208496
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.477409839630127
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.4773554801940918
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.3153495788574219
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.400843858718872
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.3444266319274902
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.4774582386016846
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5242805480957031
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3712646961212158
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2376465797424316
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1942734718322754
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2764534950256348
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.312239646911621
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.311171531677246
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2662742137908936
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4019007682800293
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 184685
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.3402998447418213
Epoch: 1, Steps: 18 | Train Loss: 3.140 Vali Loss: 2.635 Vali Acc: 0.387 Test Loss: 2.635 Test Acc: 0.387
Validation loss decreased (inf --> -0.386640).  Saving model ...
Epoch: 2 cost time: 1.267362117767334
Epoch: 2, Steps: 18 | Train Loss: 2.142 Vali Loss: 1.557 Vali Acc: 0.877 Test Loss: 1.557 Test Acc: 0.877
Validation loss decreased (-0.386640 --> -0.876651).  Saving model ...
Epoch: 3 cost time: 1.219249963760376
Epoch: 3, Steps: 18 | Train Loss: 1.067 Vali Loss: 0.749 Vali Acc: 0.943 Test Loss: 0.749 Test Acc: 0.943
Validation loss decreased (-0.876651 --> -0.943326).  Saving model ...
Epoch: 4 cost time: 1.1993615627288818
Epoch: 4, Steps: 18 | Train Loss: 0.432 Vali Loss: 0.379 Vali Acc: 0.953 Test Loss: 0.379 Test Acc: 0.953
Validation loss decreased (-0.943326 --> -0.953330).  Saving model ...
Epoch: 5 cost time: 1.2737102508544922
Epoch: 5, Steps: 18 | Train Loss: 0.181 Vali Loss: 0.244 Vali Acc: 0.963 Test Loss: 0.244 Test Acc: 0.963
Validation loss decreased (-0.953330 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 1.299567461013794
Epoch: 6, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 1.291527509689331
Epoch: 7, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 1.2057089805603027
Epoch: 8, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.1974585056304932
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.3771629333496094
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.2197120189666748
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2433838844299316
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1928002834320068
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3666770458221436
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3050363063812256
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1912076473236084
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2887303829193115
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3233177661895752
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.2914810180664062
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.2486050128936768
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2242259979248047
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.2608277797698975
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2803833484649658
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3294663429260254
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.336263656616211
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 1.3033926486968994
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2456889152526855
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2557766437530518
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 1.2618281841278076
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 1.1683881282806396
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2200837135314941
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 1.3647043704986572
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 1.2398591041564941
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.254906415939331
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2601118087768555
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.25148606300354
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 37 cost time: 1.3618464469909668
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.34096360206604
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.245896577835083
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2912592887878418
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2686240673065186
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.2421636581420898
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.0589466094970703
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.2265868186950684
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.1444106101989746
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.967 Test Loss: 0.094 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.177384376525879
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 184685
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.391223907470703
Epoch: 1, Steps: 18 | Train Loss: 3.121 Vali Loss: 2.684 Vali Acc: 0.390 Test Loss: 2.684 Test Acc: 0.390
Validation loss decreased (inf --> -0.389973).  Saving model ...
Epoch: 2 cost time: 1.1224658489227295
Epoch: 2, Steps: 18 | Train Loss: 2.228 Vali Loss: 1.698 Vali Acc: 0.810 Test Loss: 1.698 Test Acc: 0.810
Validation loss decreased (-0.389973 --> -0.809983).  Saving model ...
Epoch: 3 cost time: 1.3115403652191162
Epoch: 3, Steps: 18 | Train Loss: 1.230 Vali Loss: 0.912 Vali Acc: 0.937 Test Loss: 0.912 Test Acc: 0.937
Validation loss decreased (-0.809983 --> -0.936658).  Saving model ...
Epoch: 4 cost time: 1.1426305770874023
Epoch: 4, Steps: 18 | Train Loss: 0.582 Vali Loss: 0.496 Vali Acc: 0.950 Test Loss: 0.496 Test Acc: 0.950
Validation loss decreased (-0.936658 --> -0.949995).  Saving model ...
Epoch: 5 cost time: 1.1903584003448486
Epoch: 5, Steps: 18 | Train Loss: 0.273 Vali Loss: 0.325 Vali Acc: 0.957 Test Loss: 0.325 Test Acc: 0.957
Validation loss decreased (-0.949995 --> -0.956663).  Saving model ...
Epoch: 6 cost time: 1.2613465785980225
Epoch: 6, Steps: 18 | Train Loss: 0.143 Vali Loss: 0.240 Vali Acc: 0.963 Test Loss: 0.240 Test Acc: 0.963
Validation loss decreased (-0.956663 --> -0.963331).  Saving model ...
Epoch: 7 cost time: 1.1911964416503906
Epoch: 7, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 1.1788625717163086
Epoch: 8, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 1.2050323486328125
Epoch: 9, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 10 cost time: 1.2080745697021484
Epoch: 10, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.157632827758789
Epoch: 11, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 1.0767865180969238
Epoch: 12, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 13 cost time: 1.008756160736084
Epoch: 13, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9819040298461914
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0465035438537598
Epoch: 15, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.111863613128662
Epoch: 16, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2796497344970703
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 18 cost time: 1.1254394054412842
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1825604438781738
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.227933645248413
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 21 cost time: 1.2161579132080078
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2755446434020996
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3186333179473877
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3571467399597168
Epoch: 24, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.184650182723999
Epoch: 25, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 26 cost time: 1.339496374130249
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2223138809204102
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2177979946136475
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1984786987304688
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2313387393951416
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3255035877227783
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3169341087341309
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2874329090118408
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.224691390991211
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.2895560264587402
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 184685
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.3901445865631104
Epoch: 1, Steps: 18 | Train Loss: 3.259 Vali Loss: 2.729 Vali Acc: 0.273 Test Loss: 2.729 Test Acc: 0.273
Validation loss decreased (inf --> -0.273306).  Saving model ...
Epoch: 2 cost time: 1.3673548698425293
Epoch: 2, Steps: 18 | Train Loss: 2.201 Vali Loss: 1.558 Vali Acc: 0.843 Test Loss: 1.558 Test Acc: 0.843
Validation loss decreased (-0.273306 --> -0.843318).  Saving model ...
Epoch: 3 cost time: 1.1722157001495361
Epoch: 3, Steps: 18 | Train Loss: 1.046 Vali Loss: 0.712 Vali Acc: 0.937 Test Loss: 0.712 Test Acc: 0.937
Validation loss decreased (-0.843318 --> -0.936660).  Saving model ...
Epoch: 4 cost time: 1.3147261142730713
Epoch: 4, Steps: 18 | Train Loss: 0.391 Vali Loss: 0.337 Vali Acc: 0.967 Test Loss: 0.337 Test Acc: 0.967
Validation loss decreased (-0.936660 --> -0.966663).  Saving model ...
Epoch: 5 cost time: 1.2325923442840576
Epoch: 5, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.210 Vali Acc: 0.973 Test Loss: 0.210 Test Acc: 0.973
Validation loss decreased (-0.966663 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 1.3863556385040283
Epoch: 6, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.3056821823120117
Epoch: 7, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.257033109664917
Epoch: 8, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.317014217376709
Epoch: 9, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.3452231884002686
Epoch: 10, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.3488962650299072
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.2542693614959717
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.2933056354522705
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.3270297050476074
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.2654931545257568
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.2139613628387451
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5767779350280762
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3279881477355957
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3759984970092773
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3622186183929443
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.403259038925171
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.349808931350708
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4529788494110107
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0935142040252686
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2606558799743652
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 151917
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.1639270782470703
Epoch: 1, Steps: 18 | Train Loss: 3.248 Vali Loss: 2.739 Vali Acc: 0.280 Test Loss: 2.739 Test Acc: 0.280
Validation loss decreased (inf --> -0.279973).  Saving model ...
Epoch: 2 cost time: 1.29953932762146
Epoch: 2, Steps: 18 | Train Loss: 2.199 Vali Loss: 1.574 Vali Acc: 0.847 Test Loss: 1.574 Test Acc: 0.847
Validation loss decreased (-0.279973 --> -0.846651).  Saving model ...
Epoch: 3 cost time: 1.2203617095947266
Epoch: 3, Steps: 18 | Train Loss: 1.053 Vali Loss: 0.727 Vali Acc: 0.940 Test Loss: 0.727 Test Acc: 0.940
Validation loss decreased (-0.846651 --> -0.939993).  Saving model ...
Epoch: 4 cost time: 1.3481559753417969
Epoch: 4, Steps: 18 | Train Loss: 0.399 Vali Loss: 0.347 Vali Acc: 0.963 Test Loss: 0.347 Test Acc: 0.963
Validation loss decreased (-0.939993 --> -0.963330).  Saving model ...
Epoch: 5 cost time: 1.2020022869110107
Epoch: 5, Steps: 18 | Train Loss: 0.161 Vali Loss: 0.219 Vali Acc: 0.977 Test Loss: 0.219 Test Acc: 0.977
Validation loss decreased (-0.963330 --> -0.976664).  Saving model ...
Epoch: 6 cost time: 1.224735975265503
Epoch: 6, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.163 Vali Acc: 0.977 Test Loss: 0.163 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.2694625854492188
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.3206901550292969
Epoch: 8, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4188671112060547
Epoch: 9, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.983 Test Loss: 0.125 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.1934089660644531
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2883274555206299
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4411885738372803
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4865775108337402
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3902757167816162
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.3438386917114258
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.2496166229248047
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 1.3228065967559814
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2433929443359375
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.172426700592041
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.167565107345581
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3287074565887451
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5324926376342773
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.4760165214538574
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.4192280769348145
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3491895198822021
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2395656108856201
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 1.308833360671997
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3286256790161133
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.3359360694885254
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3522965908050537
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.3211345672607422
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 1.2612242698669434
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 1.338155746459961
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 1.1527471542358398
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 1.334533452987671
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2289690971374512
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 1.204951286315918
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2485029697418213
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2798821926116943
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1368045806884766
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.393822193145752
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 1.2810113430023193
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2280218601226807
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 1.3508572578430176
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2322962284088135
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2057406902313232
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.162675380706787
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 1.2370884418487549
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 1.187990665435791
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 1.1208539009094238
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.3690476417541504
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.3432588577270508
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.2545075416564941
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.3945283889770508
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.2067627906799316
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.1318652629852295
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.2414867877960205
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.2556838989257812
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.3375530242919922
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 1.3102385997772217
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.2959027290344238
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 1.344977617263794
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.251875877380371
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.224174976348877
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 1.3113057613372803
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.3716480731964111
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.4261195659637451
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.1955878734588623
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.2055528163909912
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.2065284252166748
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 1.264664888381958
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.5202722549438477
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.732640266418457
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.6023173332214355
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.6246602535247803
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.2090795040130615
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.405839443206787
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 1.4644625186920166
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 1.367846965789795
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 80 cost time: 1.536452293395996
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 81 cost time: 1.3472743034362793
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.286834955215454
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.2677001953125
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.3191676139831543
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.3362407684326172
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 1.3107361793518066
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 1.1187183856964111
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 1.3303420543670654
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 1.2972359657287598
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 1.3055963516235352
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 151917
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2103610038757324
Epoch: 1, Steps: 18 | Train Loss: 3.225 Vali Loss: 2.736 Vali Acc: 0.307 Test Loss: 2.736 Test Acc: 0.307
Validation loss decreased (inf --> -0.306639).  Saving model ...
Epoch: 2 cost time: 1.3876843452453613
Epoch: 2, Steps: 18 | Train Loss: 2.225 Vali Loss: 1.610 Vali Acc: 0.843 Test Loss: 1.610 Test Acc: 0.843
Validation loss decreased (-0.306639 --> -0.843317).  Saving model ...
Epoch: 3 cost time: 1.1996145248413086
Epoch: 3, Steps: 18 | Train Loss: 1.107 Vali Loss: 0.775 Vali Acc: 0.920 Test Loss: 0.775 Test Acc: 0.920
Validation loss decreased (-0.843317 --> -0.919992).  Saving model ...
Epoch: 4 cost time: 1.362138032913208
Epoch: 4, Steps: 18 | Train Loss: 0.440 Vali Loss: 0.384 Vali Acc: 0.960 Test Loss: 0.384 Test Acc: 0.960
Validation loss decreased (-0.919992 --> -0.959996).  Saving model ...
Epoch: 5 cost time: 1.3899459838867188
Epoch: 5, Steps: 18 | Train Loss: 0.190 Vali Loss: 0.242 Vali Acc: 0.960 Test Loss: 0.242 Test Acc: 0.960
Validation loss decreased (-0.959996 --> -0.959998).  Saving model ...
Epoch: 6 cost time: 1.2703475952148438
Epoch: 6, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.180 Vali Acc: 0.973 Test Loss: 0.180 Test Acc: 0.973
Validation loss decreased (-0.959998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.2365074157714844
Epoch: 7, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.1742839813232422
Epoch: 8, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3250625133514404
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.1996729373931885
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3200721740722656
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.2320959568023682
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1542184352874756
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2701225280761719
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1854057312011719
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1345791816711426
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.129887342453003
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.357102632522583
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.255185604095459
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.4671056270599365
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.3227436542510986
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.3914258480072021
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4555823802947998
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2522311210632324
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3570256233215332
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.221869707107544
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.254530668258667
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 1.4503474235534668
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4102718830108643
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 1.303532600402832
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2441961765289307
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4769399166107178
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.253296136856079
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 34 cost time: 1.3494017124176025
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 35 cost time: 1.3823394775390625
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3200676441192627
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3547499179840088
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4385690689086914
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.4479975700378418
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.3234360218048096
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.2381038665771484
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 42 cost time: 1.2413759231567383
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.263594150543213
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 44 cost time: 1.345942735671997
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2471213340759277
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1848783493041992
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2830188274383545
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 48 cost time: 1.2379717826843262
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 49 cost time: 1.4532434940338135
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 50 cost time: 1.3819866180419922
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 51 cost time: 1.3000082969665527
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.3524203300476074
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.5358471870422363
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.4574108123779297
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.508866548538208
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.511596441268921
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.5107970237731934
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.3311984539031982
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.306105613708496
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 60 cost time: 1.37058424949646
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 61 cost time: 1.2807767391204834
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 62 cost time: 1.2104182243347168
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 63 cost time: 1.1850545406341553
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 1.1337854862213135
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.18017578125
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.359917163848877
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.2832379341125488
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 1.197291612625122
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 69 cost time: 1.290686845779419
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 70 cost time: 1.4294450283050537
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 71 cost time: 1.4163436889648438
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.4768321514129639
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.527848720550537
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.427335262298584
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.5380322933197021
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.4755487442016602
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.5114285945892334
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 1.275925636291504
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 1.257054328918457
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 1.331974983215332
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 81 cost time: 1.3175065517425537
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 82 cost time: 1.2848999500274658
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 83 cost time: 1.3520772457122803
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.2492690086364746
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.368009090423584
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 1.2207441329956055
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 1.1230430603027344
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 1.2649004459381104
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 1.189727544784546
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 1.2802188396453857
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 1.24881911277771
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 1.342965841293335
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 151917
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2825300693511963
Epoch: 1, Steps: 18 | Train Loss: 3.171 Vali Loss: 2.757 Vali Acc: 0.317 Test Loss: 2.757 Test Acc: 0.317
Validation loss decreased (inf --> -0.316639).  Saving model ...
Epoch: 2 cost time: 1.2349562644958496
Epoch: 2, Steps: 18 | Train Loss: 2.299 Vali Loss: 1.745 Vali Acc: 0.803 Test Loss: 1.745 Test Acc: 0.803
Validation loss decreased (-0.316639 --> -0.803316).  Saving model ...
Epoch: 3 cost time: 1.4240844249725342
Epoch: 3, Steps: 18 | Train Loss: 1.259 Vali Loss: 0.938 Vali Acc: 0.910 Test Loss: 0.938 Test Acc: 0.910
Validation loss decreased (-0.803316 --> -0.909991).  Saving model ...
Epoch: 4 cost time: 1.3656373023986816
Epoch: 4, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.506 Vali Acc: 0.953 Test Loss: 0.506 Test Acc: 0.953
Validation loss decreased (-0.909991 --> -0.953328).  Saving model ...
Epoch: 5 cost time: 1.3788321018218994
Epoch: 5, Steps: 18 | Train Loss: 0.283 Vali Loss: 0.321 Vali Acc: 0.963 Test Loss: 0.321 Test Acc: 0.963
Validation loss decreased (-0.953328 --> -0.963330).  Saving model ...
Epoch: 6 cost time: 1.2275781631469727
Epoch: 6, Steps: 18 | Train Loss: 0.139 Vali Loss: 0.246 Vali Acc: 0.960 Test Loss: 0.246 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3891112804412842
Epoch: 7, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.211 Vali Acc: 0.963 Test Loss: 0.211 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 1.178360939025879
Epoch: 8, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 1.4364323616027832
Epoch: 9, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 10 cost time: 1.1249053478240967
Epoch: 10, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 1.1679534912109375
Epoch: 11, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 1.2135484218597412
Epoch: 12, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.160 Vali Acc: 0.963 Test Loss: 0.160 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.366159200668335
Epoch: 13, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3945856094360352
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 15 cost time: 1.1805198192596436
Epoch: 15, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 16 cost time: 1.2637882232666016
Epoch: 16, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.173637866973877
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 1.1835978031158447
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2954416275024414
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 1.126413106918335
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1924102306365967
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 22 cost time: 1.2734899520874023
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2671666145324707
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 24 cost time: 1.310737133026123
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3650550842285156
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 26 cost time: 1.2455053329467773
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 27 cost time: 1.2287757396697998
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3130664825439453
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4816129207611084
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3936941623687744
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 31 cost time: 1.3087584972381592
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.348663091659546
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2580935955047607
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 34 cost time: 1.3721091747283936
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1927714347839355
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 36 cost time: 1.332024335861206
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.256225347518921
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.244955062866211
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.179032564163208
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3021230697631836
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.394939661026001
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.4063947200775146
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.5082013607025146
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.4376153945922852
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.363417148590088
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 151917
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.785578489303589
Epoch: 1, Steps: 18 | Train Loss: 3.175 Vali Loss: 2.698 Vali Acc: 0.367 Test Loss: 2.698 Test Acc: 0.367
Validation loss decreased (inf --> -0.366640).  Saving model ...
Epoch: 2 cost time: 1.346024751663208
Epoch: 2, Steps: 18 | Train Loss: 2.147 Vali Loss: 1.518 Vali Acc: 0.880 Test Loss: 1.518 Test Acc: 0.880
Validation loss decreased (-0.366640 --> -0.879985).  Saving model ...
Epoch: 3 cost time: 1.3226768970489502
Epoch: 3, Steps: 18 | Train Loss: 0.995 Vali Loss: 0.667 Vali Acc: 0.950 Test Loss: 0.667 Test Acc: 0.950
Validation loss decreased (-0.879985 --> -0.949993).  Saving model ...
Epoch: 4 cost time: 1.2603235244750977
Epoch: 4, Steps: 18 | Train Loss: 0.381 Vali Loss: 0.323 Vali Acc: 0.967 Test Loss: 0.323 Test Acc: 0.967
Validation loss decreased (-0.949993 --> -0.966663).  Saving model ...
Epoch: 5 cost time: 1.3823881149291992
Epoch: 5, Steps: 18 | Train Loss: 0.148 Vali Loss: 0.200 Vali Acc: 0.973 Test Loss: 0.200 Test Acc: 0.973
Validation loss decreased (-0.966663 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 1.3354911804199219
Epoch: 6, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.2795593738555908
Epoch: 7, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.093221664428711
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.1795282363891602
Epoch: 9, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0538420677185059
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.018843650817871
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1676521301269531
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0278122425079346
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.1853270530700684
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2142868041992188
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2370185852050781
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2525606155395508
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2683906555175781
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2546846866607666
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3643333911895752
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3568809032440186
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2758522033691406
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.230776071548462
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.344527244567871
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 1.243828296661377
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2459070682525635
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1934595108032227
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2876029014587402
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1618995666503906
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2503573894500732
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 1.2305552959442139
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.1685791015625
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 1.274451732635498
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 34 cost time: 1.1115458011627197
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0623126029968262
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 36 cost time: 1.2611680030822754
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 37 cost time: 1.043097972869873
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1933705806732178
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.146641731262207
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2992076873779297
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2693908214569092
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0664169788360596
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.987 Test Loss: 0.072 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 43 cost time: 1.2703330516815186
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.987 Test Loss: 0.072 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 44 cost time: 1.2473957538604736
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.987 Test Loss: 0.072 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2071013450622559
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2452456951141357
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.386626958847046
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.3079841136932373
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.29343843460083
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 50 cost time: 1.3415098190307617
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 51 cost time: 1.3146002292633057
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 52 cost time: 1.236018180847168
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3193986415863037
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.2425308227539062
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.2727653980255127
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.370880126953125
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.129140853881836
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.2888901233673096
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.2766282558441162
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.2541253566741943
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 61 cost time: 1.1813116073608398
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.3301334381103516
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 63 cost time: 1.259582281112671
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.2820961475372314
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.4108319282531738
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 66 cost time: 1.2697687149047852
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 67 cost time: 1.2795603275299072
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.2177345752716064
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 69 cost time: 1.1786057949066162
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 70 cost time: 1.1922821998596191
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 71 cost time: 1.346468210220337
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 72 cost time: 1.3366169929504395
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.3989231586456299
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.2648110389709473
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.3523972034454346
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.3155767917633057
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 1.147003412246704
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 1.3677279949188232
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 1.2419581413269043
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 1.2510271072387695
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 1.2738103866577148
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 135533
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.385709285736084
Epoch: 1, Steps: 18 | Train Loss: 3.176 Vali Loss: 2.703 Vali Acc: 0.353 Test Loss: 2.703 Test Acc: 0.353
Validation loss decreased (inf --> -0.353306).  Saving model ...
Epoch: 2 cost time: 1.5406506061553955
Epoch: 2, Steps: 18 | Train Loss: 2.145 Vali Loss: 1.531 Vali Acc: 0.877 Test Loss: 1.531 Test Acc: 0.877
Validation loss decreased (-0.353306 --> -0.876651).  Saving model ...
Epoch: 3 cost time: 1.3053152561187744
Epoch: 3, Steps: 18 | Train Loss: 1.008 Vali Loss: 0.678 Vali Acc: 0.957 Test Loss: 0.678 Test Acc: 0.957
Validation loss decreased (-0.876651 --> -0.956660).  Saving model ...
Epoch: 4 cost time: 1.2657673358917236
Epoch: 4, Steps: 18 | Train Loss: 0.393 Vali Loss: 0.330 Vali Acc: 0.970 Test Loss: 0.330 Test Acc: 0.970
Validation loss decreased (-0.956660 --> -0.969997).  Saving model ...
Epoch: 5 cost time: 1.236039638519287
Epoch: 5, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.204 Vali Acc: 0.977 Test Loss: 0.204 Test Acc: 0.977
Validation loss decreased (-0.969997 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 1.4818603992462158
Epoch: 6, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.161 Vali Acc: 0.977 Test Loss: 0.161 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.3861100673675537
Epoch: 7, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.422691822052002
Epoch: 8, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.987 Test Loss: 0.115 Test Acc: 0.987
Validation loss decreased (-0.976665 --> -0.986666).  Saving model ...
Epoch: 9 cost time: 1.3725252151489258
Epoch: 9, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2834899425506592
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3522331714630127
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2869713306427002
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2560226917266846
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.398965835571289
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4466369152069092
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2255597114562988
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.270117998123169
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3071517944335938
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 135533
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.8079640865325928
Epoch: 1, Steps: 18 | Train Loss: 3.198 Vali Loss: 2.728 Vali Acc: 0.347 Test Loss: 2.728 Test Acc: 0.347
Validation loss decreased (inf --> -0.346639).  Saving model ...
Epoch: 2 cost time: 1.1979694366455078
Epoch: 2, Steps: 18 | Train Loss: 2.212 Vali Loss: 1.592 Vali Acc: 0.870 Test Loss: 1.592 Test Acc: 0.870
Validation loss decreased (-0.346639 --> -0.869984).  Saving model ...
Epoch: 3 cost time: 1.3392419815063477
Epoch: 3, Steps: 18 | Train Loss: 1.070 Vali Loss: 0.740 Vali Acc: 0.947 Test Loss: 0.740 Test Acc: 0.947
Validation loss decreased (-0.869984 --> -0.946659).  Saving model ...
Epoch: 4 cost time: 1.3158445358276367
Epoch: 4, Steps: 18 | Train Loss: 0.448 Vali Loss: 0.374 Vali Acc: 0.953 Test Loss: 0.374 Test Acc: 0.953
Validation loss decreased (-0.946659 --> -0.953330).  Saving model ...
Epoch: 5 cost time: 1.3876519203186035
Epoch: 5, Steps: 18 | Train Loss: 0.189 Vali Loss: 0.236 Vali Acc: 0.957 Test Loss: 0.236 Test Acc: 0.957
Validation loss decreased (-0.953330 --> -0.956664).  Saving model ...
Epoch: 6 cost time: 1.3225045204162598
Epoch: 6, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.183 Vali Acc: 0.970 Test Loss: 0.183 Test Acc: 0.970
Validation loss decreased (-0.956664 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 1.4244647026062012
Epoch: 7, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 1.4368746280670166
Epoch: 8, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.3360414505004883
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.378511905670166
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.239769458770752
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.161419153213501
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3410460948944092
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.295839786529541
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4152071475982666
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3582837581634521
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2465221881866455
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1947157382965088
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 135533
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.186281442642212
Epoch: 1, Steps: 18 | Train Loss: 3.146 Vali Loss: 2.750 Vali Acc: 0.363 Test Loss: 2.750 Test Acc: 0.363
Validation loss decreased (inf --> -0.363306).  Saving model ...
Epoch: 2 cost time: 1.2707388401031494
Epoch: 2, Steps: 18 | Train Loss: 2.286 Vali Loss: 1.717 Vali Acc: 0.807 Test Loss: 1.717 Test Acc: 0.807
Validation loss decreased (-0.363306 --> -0.806649).  Saving model ...
Epoch: 3 cost time: 1.2528471946716309
Epoch: 3, Steps: 18 | Train Loss: 1.220 Vali Loss: 0.898 Vali Acc: 0.923 Test Loss: 0.898 Test Acc: 0.923
Validation loss decreased (-0.806649 --> -0.923324).  Saving model ...
Epoch: 4 cost time: 1.194854736328125
Epoch: 4, Steps: 18 | Train Loss: 0.583 Vali Loss: 0.493 Vali Acc: 0.947 Test Loss: 0.493 Test Acc: 0.947
Validation loss decreased (-0.923324 --> -0.946662).  Saving model ...
Epoch: 5 cost time: 1.264495611190796
Epoch: 5, Steps: 18 | Train Loss: 0.271 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
Validation loss decreased (-0.946662 --> -0.949997).  Saving model ...
Epoch: 6 cost time: 1.3508532047271729
Epoch: 6, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.243 Vali Acc: 0.957 Test Loss: 0.243 Test Acc: 0.957
Validation loss decreased (-0.949997 --> -0.956664).  Saving model ...
Epoch: 7 cost time: 1.3106911182403564
Epoch: 7, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.204 Vali Acc: 0.960 Test Loss: 0.204 Test Acc: 0.960
Validation loss decreased (-0.956664 --> -0.959998).  Saving model ...
Epoch: 8 cost time: 1.6139435768127441
Epoch: 8, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 1.3162658214569092
Epoch: 9, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 10 cost time: 1.25575590133667
Epoch: 10, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.147514820098877
Epoch: 11, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1144452095031738
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1272222995758057
Epoch: 13, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1777763366699219
Epoch: 14, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1722426414489746
Epoch: 15, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.2711117267608643
Epoch: 16, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.308577537536621
Epoch: 17, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3776912689208984
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3120081424713135
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.263551950454712
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.224459171295166
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 22 cost time: 1.2698147296905518
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3346002101898193
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.231264352798462
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3606760501861572
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3588051795959473
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 27 cost time: 1.3407762050628662
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3365468978881836
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.4210295677185059
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3047778606414795
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.208991289138794
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.2747490406036377
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2860212326049805
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2463834285736084
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.2125496864318848
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2298541069030762
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0715887546539307
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.983 Test Loss: 0.123 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 38 cost time: 1.2210822105407715
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1715068817138672
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2619554996490479
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2969658374786377
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.2888426780700684
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.2787394523620605
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.3307032585144043
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.3495111465454102
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.3481533527374268
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.2082428932189941
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 135533
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.37343168258667
Epoch: 1, Steps: 18 | Train Loss: 3.276 Vali Loss: 2.723 Vali Acc: 0.343 Test Loss: 2.723 Test Acc: 0.343
Validation loss decreased (inf --> -0.343306).  Saving model ...
Epoch: 2 cost time: 1.158820629119873
Epoch: 2, Steps: 18 | Train Loss: 2.185 Vali Loss: 1.541 Vali Acc: 0.877 Test Loss: 1.541 Test Acc: 0.877
Validation loss decreased (-0.343306 --> -0.876651).  Saving model ...
Epoch: 3 cost time: 1.1347894668579102
Epoch: 3, Steps: 18 | Train Loss: 1.044 Vali Loss: 0.710 Vali Acc: 0.950 Test Loss: 0.710 Test Acc: 0.950
Validation loss decreased (-0.876651 --> -0.949993).  Saving model ...
Epoch: 4 cost time: 1.2677788734436035
Epoch: 4, Steps: 18 | Train Loss: 0.389 Vali Loss: 0.327 Vali Acc: 0.967 Test Loss: 0.327 Test Acc: 0.967
Validation loss decreased (-0.949993 --> -0.966663).  Saving model ...
Epoch: 5 cost time: 1.250990390777588
Epoch: 5, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.205 Vali Acc: 0.970 Test Loss: 0.205 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.2066397666931152
Epoch: 6, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.1965727806091309
Epoch: 7, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.2435376644134521
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.2228991985321045
Epoch: 9, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.1575539112091064
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3027551174163818
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.1564357280731201
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.2331492900848389
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.3022112846374512
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.2498421669006348
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.1010642051696777
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2291653156280518
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.2144193649291992
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2878475189208984
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.2387757301330566
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.3781914710998535
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.3563470840454102
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 1.3081154823303223
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.2092325687408447
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 1.3094465732574463
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 1.2718274593353271
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 1.3252389430999756
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2942767143249512
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2497875690460205
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3278870582580566
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 1.339547872543335
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.405768632888794
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1688477993011475
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 1.1798946857452393
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 1.2734603881835938
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2142691612243652
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.146444320678711
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3800883293151855
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 1.1707451343536377
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1207380294799805
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.275038242340088
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2957828044891357
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.268925666809082
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 1.41473388671875
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 1.2660183906555176
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 1.2773749828338623
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4160234928131104
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.3675813674926758
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.4134681224822998
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 1.1780996322631836
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.2706842422485352
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.309140920639038
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.2918174266815186
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.240283727645874
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.251222848892212
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.3660268783569336
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.2812187671661377
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.3558874130249023
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.343414545059204
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.2576208114624023
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 127341
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.781965970993042
Epoch: 1, Steps: 18 | Train Loss: 3.271 Vali Loss: 2.717 Vali Acc: 0.353 Test Loss: 2.717 Test Acc: 0.353
Validation loss decreased (inf --> -0.353306).  Saving model ...
Epoch: 2 cost time: 1.2302591800689697
Epoch: 2, Steps: 18 | Train Loss: 2.195 Vali Loss: 1.544 Vali Acc: 0.880 Test Loss: 1.544 Test Acc: 0.880
Validation loss decreased (-0.353306 --> -0.879985).  Saving model ...
Epoch: 3 cost time: 1.306631326675415
Epoch: 3, Steps: 18 | Train Loss: 1.052 Vali Loss: 0.718 Vali Acc: 0.957 Test Loss: 0.718 Test Acc: 0.957
Validation loss decreased (-0.879985 --> -0.956659).  Saving model ...
Epoch: 4 cost time: 1.437096118927002
Epoch: 4, Steps: 18 | Train Loss: 0.401 Vali Loss: 0.335 Vali Acc: 0.967 Test Loss: 0.335 Test Acc: 0.967
Validation loss decreased (-0.956659 --> -0.966663).  Saving model ...
Epoch: 5 cost time: 1.2393686771392822
Epoch: 5, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.210 Vali Acc: 0.970 Test Loss: 0.210 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.3413946628570557
Epoch: 6, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.4485106468200684
Epoch: 7, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.3817462921142578
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.126 Vali Acc: 0.983 Test Loss: 0.126 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.484062671661377
Epoch: 9, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.2648077011108398
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4489984512329102
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.3189036846160889
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.3589539527893066
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3586175441741943
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.378124713897705
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2063908576965332
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1915805339813232
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.3272297382354736
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3755042552947998
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.5695056915283203
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.327847957611084
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.3966648578643799
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.2771248817443848
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.2067351341247559
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 1.1898629665374756
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 1.3699040412902832
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 1.179853916168213
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2754056453704834
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2965714931488037
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3695182800292969
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 1.3257343769073486
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2983527183532715
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3928723335266113
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1750938892364502
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 1.1983842849731445
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3277204036712646
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2594282627105713
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2054383754730225
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 1.1523208618164062
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 1.343935489654541
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2895069122314453
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3742473125457764
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3252224922180176
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 1.3100643157958984
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 1.417891263961792
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 1.2278566360473633
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0871014595031738
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2692818641662598
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1997134685516357
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 1.2031667232513428
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.3610823154449463
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.346104621887207
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.3711261749267578
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.3093974590301514
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.272902011871338
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.3207166194915771
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.3001227378845215
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.2688162326812744
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.264430046081543
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 127341
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.3089871406555176
Epoch: 1, Steps: 18 | Train Loss: 3.254 Vali Loss: 2.740 Vali Acc: 0.357 Test Loss: 2.740 Test Acc: 0.357
Validation loss decreased (inf --> -0.356639).  Saving model ...
Epoch: 2 cost time: 1.167832612991333
Epoch: 2, Steps: 18 | Train Loss: 2.226 Vali Loss: 1.599 Vali Acc: 0.850 Test Loss: 1.599 Test Acc: 0.850
Validation loss decreased (-0.356639 --> -0.849984).  Saving model ...
Epoch: 3 cost time: 1.280503273010254
Epoch: 3, Steps: 18 | Train Loss: 1.108 Vali Loss: 0.778 Vali Acc: 0.937 Test Loss: 0.778 Test Acc: 0.937
Validation loss decreased (-0.849984 --> -0.936659).  Saving model ...
Epoch: 4 cost time: 1.1991868019104004
Epoch: 4, Steps: 18 | Train Loss: 0.443 Vali Loss: 0.377 Vali Acc: 0.960 Test Loss: 0.377 Test Acc: 0.960
Validation loss decreased (-0.936659 --> -0.959996).  Saving model ...
Epoch: 5 cost time: 1.227419137954712
Epoch: 5, Steps: 18 | Train Loss: 0.192 Vali Loss: 0.235 Vali Acc: 0.963 Test Loss: 0.235 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 1.230098009109497
Epoch: 6, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.171 Vali Acc: 0.973 Test Loss: 0.171 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.2248427867889404
Epoch: 7, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.385965347290039
Epoch: 8, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.2134909629821777
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.2541053295135498
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2539916038513184
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.2006235122680664
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.2403316497802734
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1651124954223633
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.1685569286346436
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.2448832988739014
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.33225679397583
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.2897233963012695
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2594308853149414
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.1958279609680176
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.2304542064666748
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3728187084197998
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3319494724273682
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.253525972366333
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.0511727333068848
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.2270760536193848
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.069948673248291
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.218975305557251
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2464897632598877
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.246340274810791
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2385544776916504
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.1926658153533936
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3827464580535889
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.4260780811309814
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3465211391448975
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2231109142303467
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.245471477508545
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3236889839172363
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.1845130920410156
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1791205406188965
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.238875389099121
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.1535687446594238
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.2763867378234863
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.1218085289001465
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.119480848312378
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.3932139873504639
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2818925380706787
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1022379398345947
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.3164012432098389
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.2001430988311768
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.19331955909729
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.20477294921875
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.2919492721557617
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.231830358505249
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 1.2200994491577148
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 1.3955013751983643
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.2628586292266846
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 1.1904079914093018
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 1.0901730060577393
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.145749568939209
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.1527972221374512
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.2031683921813965
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 63 cost time: 1.2187137603759766
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 1.2153809070587158
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 1.2778034210205078
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.1749234199523926
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 67 cost time: 1.135105848312378
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 1.2782652378082275
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.2727532386779785
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 70 cost time: 1.210329532623291
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.2177793979644775
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.38077974319458
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.3203978538513184
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.1673216819763184
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.3157708644866943
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.266249656677246
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.2973873615264893
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.1511189937591553
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 79 cost time: 1.2215025424957275
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 80 cost time: 1.241281509399414
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 81 cost time: 1.2668657302856445
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 82 cost time: 1.1767253875732422
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.2608387470245361
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.1310584545135498
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.1270990371704102
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 1.3007373809814453
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 1.2610819339752197
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 1.308093786239624
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 1.2672696113586426
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 1.268686294555664
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 1.229856014251709
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 127341
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.4255425930023193
Epoch: 1, Steps: 18 | Train Loss: 3.210 Vali Loss: 2.780 Vali Acc: 0.307 Test Loss: 2.780 Test Acc: 0.307
Validation loss decreased (inf --> -0.306639).  Saving model ...
Epoch: 2 cost time: 1.2369494438171387
Epoch: 2, Steps: 18 | Train Loss: 2.297 Vali Loss: 1.747 Vali Acc: 0.810 Test Loss: 1.747 Test Acc: 0.810
Validation loss decreased (-0.306639 --> -0.809983).  Saving model ...
Epoch: 3 cost time: 1.3193552494049072
Epoch: 3, Steps: 18 | Train Loss: 1.280 Vali Loss: 0.947 Vali Acc: 0.930 Test Loss: 0.947 Test Acc: 0.930
Validation loss decreased (-0.809983 --> -0.929991).  Saving model ...
Epoch: 4 cost time: 1.2986135482788086
Epoch: 4, Steps: 18 | Train Loss: 0.592 Vali Loss: 0.510 Vali Acc: 0.960 Test Loss: 0.510 Test Acc: 0.960
Validation loss decreased (-0.929991 --> -0.959995).  Saving model ...
Epoch: 5 cost time: 1.3096284866333008
Epoch: 5, Steps: 18 | Train Loss: 0.289 Vali Loss: 0.318 Vali Acc: 0.963 Test Loss: 0.318 Test Acc: 0.963
Validation loss decreased (-0.959995 --> -0.963330).  Saving model ...
Epoch: 6 cost time: 1.2900421619415283
Epoch: 6, Steps: 18 | Train Loss: 0.143 Vali Loss: 0.237 Vali Acc: 0.967 Test Loss: 0.237 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966664).  Saving model ...
Epoch: 7 cost time: 1.3818299770355225
Epoch: 7, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.206 Vali Acc: 0.963 Test Loss: 0.206 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.173034906387329
Epoch: 8, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.187 Vali Acc: 0.970 Test Loss: 0.187 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 1.2066521644592285
Epoch: 9, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.178 Vali Acc: 0.970 Test Loss: 0.178 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 1.3195176124572754
Epoch: 10, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.169 Vali Acc: 0.977 Test Loss: 0.169 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.3014287948608398
Epoch: 11, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.163 Vali Acc: 0.973 Test Loss: 0.163 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3346683979034424
Epoch: 12, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.155 Vali Acc: 0.977 Test Loss: 0.155 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 1.4254331588745117
Epoch: 13, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.332078218460083
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5179600715637207
Epoch: 15, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 1.3075573444366455
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3395025730133057
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2810230255126953
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 1.328709363937378
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3334376811981201
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 1.3948445320129395
Epoch: 21, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4066746234893799
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4406964778900146
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5446650981903076
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 25 cost time: 1.2888908386230469
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2552268505096436
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2315704822540283
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 28 cost time: 1.363982915878296
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 29 cost time: 1.3058781623840332
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2720527648925781
Epoch: 30, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2521588802337646
Epoch: 31, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.248767614364624
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2992141246795654
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.276888132095337
Epoch: 34, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.3446383476257324
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.6216251850128174
Epoch: 36, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.5270404815673828
Epoch: 37, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.3959689140319824
Epoch: 38, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 127341
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.126044750213623
Epoch: 1, Steps: 18 | Train Loss: 3.270 Vali Loss: 2.731 Vali Acc: 0.330 Test Loss: 2.731 Test Acc: 0.330
Validation loss decreased (inf --> -0.329973).  Saving model ...
Epoch: 2 cost time: 1.1569499969482422
Epoch: 2, Steps: 18 | Train Loss: 2.167 Vali Loss: 1.572 Vali Acc: 0.820 Test Loss: 1.572 Test Acc: 0.820
Validation loss decreased (-0.329973 --> -0.819984).  Saving model ...
Epoch: 3 cost time: 1.222376823425293
Epoch: 3, Steps: 18 | Train Loss: 1.051 Vali Loss: 0.714 Vali Acc: 0.950 Test Loss: 0.714 Test Acc: 0.950
Validation loss decreased (-0.819984 --> -0.949993).  Saving model ...
Epoch: 4 cost time: 1.2378182411193848
Epoch: 4, Steps: 18 | Train Loss: 0.395 Vali Loss: 0.340 Vali Acc: 0.967 Test Loss: 0.340 Test Acc: 0.967
Validation loss decreased (-0.949993 --> -0.966663).  Saving model ...
Epoch: 5 cost time: 1.1601803302764893
Epoch: 5, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.218 Vali Acc: 0.970 Test Loss: 0.218 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.2697434425354004
Epoch: 6, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.160 Vali Acc: 0.980 Test Loss: 0.160 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979998).  Saving model ...
Epoch: 7 cost time: 1.2691795825958252
Epoch: 7, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2466604709625244
Epoch: 8, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1845831871032715
Epoch: 9, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.2417752742767334
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.1988284587860107
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.2227003574371338
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.3146848678588867
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.230050802230835
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.1617341041564941
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.361670970916748
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.3603785037994385
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.1984055042266846
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.191305160522461
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1946651935577393
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1813938617706299
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2112538814544678
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3754725456237793
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.2137198448181152
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.1859822273254395
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1350281238555908
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2132203578948975
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2118957042694092
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2355635166168213
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.327362060546875
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1377074718475342
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.3431930541992188
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.4275286197662354
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 34 cost time: 1.3112800121307373
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2540688514709473
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2967817783355713
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2860045433044434
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.175271987915039
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2234864234924316
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2937102317810059
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.3120713233947754
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.2487373352050781
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.3155429363250732
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 123245
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.348057270050049
Epoch: 1, Steps: 18 | Train Loss: 3.266 Vali Loss: 2.728 Vali Acc: 0.343 Test Loss: 2.728 Test Acc: 0.343
Validation loss decreased (inf --> -0.343306).  Saving model ...
Epoch: 2 cost time: 1.2654497623443604
Epoch: 2, Steps: 18 | Train Loss: 2.168 Vali Loss: 1.578 Vali Acc: 0.820 Test Loss: 1.578 Test Acc: 0.820
Validation loss decreased (-0.343306 --> -0.819984).  Saving model ...
Epoch: 3 cost time: 1.3105196952819824
Epoch: 3, Steps: 18 | Train Loss: 1.066 Vali Loss: 0.723 Vali Acc: 0.950 Test Loss: 0.723 Test Acc: 0.950
Validation loss decreased (-0.819984 --> -0.949993).  Saving model ...
Epoch: 4 cost time: 1.2202472686767578
Epoch: 4, Steps: 18 | Train Loss: 0.406 Vali Loss: 0.349 Vali Acc: 0.970 Test Loss: 0.349 Test Acc: 0.970
Validation loss decreased (-0.949993 --> -0.969997).  Saving model ...
Epoch: 5 cost time: 1.1770744323730469
Epoch: 5, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.224 Vali Acc: 0.967 Test Loss: 0.224 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1112127304077148
Epoch: 6, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.166 Vali Acc: 0.977 Test Loss: 0.166 Test Acc: 0.977
Validation loss decreased (-0.969997 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.2242319583892822
Epoch: 7, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.146 Vali Acc: 0.980 Test Loss: 0.146 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.4040641784667969
Epoch: 8, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3142008781433105
Epoch: 9, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.2504780292510986
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.2253549098968506
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2736151218414307
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.456087350845337
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.374290943145752
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.2928428649902344
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.5345253944396973
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.4803202152252197
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.3791732788085938
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4890344142913818
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2737209796905518
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2721421718597412
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4283454418182373
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.1178302764892578
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.2007534503936768
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.1612951755523682
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.170496940612793
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.191127061843872
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 1.2658390998840332
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2483465671539307
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2895071506500244
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2737092971801758
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5354938507080078
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.351698398590088
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5035755634307861
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.4065582752227783
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.3526701927185059
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.3524281978607178
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 123245
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.203324317932129
Epoch: 1, Steps: 18 | Train Loss: 3.256 Vali Loss: 2.745 Vali Acc: 0.343 Test Loss: 2.745 Test Acc: 0.343
Validation loss decreased (inf --> -0.343306).  Saving model ...
Epoch: 2 cost time: 1.18330979347229
Epoch: 2, Steps: 18 | Train Loss: 2.202 Vali Loss: 1.630 Vali Acc: 0.793 Test Loss: 1.630 Test Acc: 0.793
Validation loss decreased (-0.343306 --> -0.793317).  Saving model ...
Epoch: 3 cost time: 1.1435010433197021
Epoch: 3, Steps: 18 | Train Loss: 1.116 Vali Loss: 0.781 Vali Acc: 0.933 Test Loss: 0.781 Test Acc: 0.933
Validation loss decreased (-0.793317 --> -0.933326).  Saving model ...
Epoch: 4 cost time: 1.2179760932922363
Epoch: 4, Steps: 18 | Train Loss: 0.453 Vali Loss: 0.391 Vali Acc: 0.957 Test Loss: 0.391 Test Acc: 0.957
Validation loss decreased (-0.933326 --> -0.956663).  Saving model ...
Epoch: 5 cost time: 1.106020450592041
Epoch: 5, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.252 Vali Acc: 0.957 Test Loss: 0.252 Test Acc: 0.957
Validation loss decreased (-0.956663 --> -0.956664).  Saving model ...
Epoch: 6 cost time: 1.2566041946411133
Epoch: 6, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.184 Vali Acc: 0.977 Test Loss: 0.184 Test Acc: 0.977
Validation loss decreased (-0.956664 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.2896058559417725
Epoch: 7, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4532787799835205
Epoch: 8, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2175943851470947
Epoch: 9, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.301260232925415
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2073509693145752
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.105370283126831
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1590209007263184
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.131382703781128
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1994071006774902
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2422053813934326
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 123245
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2099058628082275
Epoch: 1, Steps: 18 | Train Loss: 3.239 Vali Loss: 2.769 Vali Acc: 0.310 Test Loss: 2.769 Test Acc: 0.310
Validation loss decreased (inf --> -0.309972).  Saving model ...
Epoch: 2 cost time: 1.1567230224609375
Epoch: 2, Steps: 18 | Train Loss: 2.282 Vali Loss: 1.757 Vali Acc: 0.790 Test Loss: 1.757 Test Acc: 0.790
Validation loss decreased (-0.309972 --> -0.789982).  Saving model ...
Epoch: 3 cost time: 1.279956340789795
Epoch: 3, Steps: 18 | Train Loss: 1.283 Vali Loss: 0.936 Vali Acc: 0.927 Test Loss: 0.936 Test Acc: 0.927
Validation loss decreased (-0.789982 --> -0.926657).  Saving model ...
Epoch: 4 cost time: 1.0826294422149658
Epoch: 4, Steps: 18 | Train Loss: 0.574 Vali Loss: 0.503 Vali Acc: 0.947 Test Loss: 0.503 Test Acc: 0.947
Validation loss decreased (-0.926657 --> -0.946662).  Saving model ...
Epoch: 5 cost time: 1.173525333404541
Epoch: 5, Steps: 18 | Train Loss: 0.261 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.946662 --> -0.949997).  Saving model ...
Epoch: 6 cost time: 1.1132194995880127
Epoch: 6, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.247 Vali Acc: 0.970 Test Loss: 0.247 Test Acc: 0.970
Validation loss decreased (-0.949997 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 1.16105055809021
Epoch: 7, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2770271301269531
Epoch: 8, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.198 Vali Acc: 0.957 Test Loss: 0.198 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.24894380569458
Epoch: 9, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.185 Vali Acc: 0.960 Test Loss: 0.185 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.112748622894287
Epoch: 10, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.287890911102295
Epoch: 11, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2332189083099365
Epoch: 12, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.225916862487793
Epoch: 13, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1773738861083984
Epoch: 14, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1471929550170898
Epoch: 15, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 16 cost time: 1.1308393478393555
Epoch: 16, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1250345706939697
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.0619285106658936
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2910809516906738
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1908648014068604
Epoch: 20, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1768922805786133
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.323831558227539
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.278585433959961
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3304884433746338
Epoch: 24, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2739219665527344
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1477181911468506
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2229301929473877
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 123245
model size : 1.09MB
