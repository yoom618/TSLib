Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.528982162475586
Epoch: 1, Steps: 7 | Train Loss: 2.380 Vali Loss: 1.616 Vali Acc: 0.708 Test Loss: 1.616 Test Acc: 0.708
Validation loss decreased (inf --> -0.708317).  Saving model ...
Epoch: 2 cost time: 3.030841112136841
Epoch: 2, Steps: 7 | Train Loss: 0.491 Vali Loss: 1.286 Vali Acc: 0.819 Test Loss: 1.286 Test Acc: 0.819
Validation loss decreased (-0.708317 --> -0.819432).  Saving model ...
Epoch: 3 cost time: 3.3153679370880127
Epoch: 3, Steps: 7 | Train Loss: 0.207 Vali Loss: 1.506 Vali Acc: 0.847 Test Loss: 1.506 Test Acc: 0.847
Validation loss decreased (-0.819432 --> -0.847207).  Saving model ...
Epoch: 4 cost time: 3.769575357437134
Epoch: 4, Steps: 7 | Train Loss: 0.013 Vali Loss: 1.046 Vali Acc: 0.903 Test Loss: 1.046 Test Acc: 0.903
Validation loss decreased (-0.847207 --> -0.902767).  Saving model ...
Epoch: 5 cost time: 3.5536277294158936
Epoch: 5, Steps: 7 | Train Loss: 0.012 Vali Loss: 1.050 Vali Acc: 0.903 Test Loss: 1.050 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7220845222473145
Epoch: 6, Steps: 7 | Train Loss: 0.145 Vali Loss: 1.319 Vali Acc: 0.875 Test Loss: 1.319 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8915276527404785
Epoch: 7, Steps: 7 | Train Loss: 0.417 Vali Loss: 6.358 Vali Acc: 0.847 Test Loss: 6.358 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.7633535861968994
Epoch: 8, Steps: 7 | Train Loss: 0.037 Vali Loss: 2.260 Vali Acc: 0.903 Test Loss: 2.260 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.6064069271087646
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.490 Vali Acc: 0.903 Test Loss: 2.490 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.9528753757476807
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.623 Vali Acc: 0.861 Test Loss: 2.623 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.157793045043945
Epoch: 11, Steps: 7 | Train Loss: 0.167 Vali Loss: 3.881 Vali Acc: 0.806 Test Loss: 3.881 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.291197776794434
Epoch: 12, Steps: 7 | Train Loss: 0.665 Vali Loss: 5.008 Vali Acc: 0.847 Test Loss: 5.008 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.147403717041016
Epoch: 13, Steps: 7 | Train Loss: 0.590 Vali Loss: 6.949 Vali Acc: 0.806 Test Loss: 6.949 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.251625061035156
Epoch: 14, Steps: 7 | Train Loss: 0.171 Vali Loss: 4.484 Vali Acc: 0.819 Test Loss: 4.484 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 12629084
model size : 57.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.257951974868774
Epoch: 1, Steps: 7 | Train Loss: 2.375 Vali Loss: 1.656 Vali Acc: 0.722 Test Loss: 1.656 Test Acc: 0.722
Validation loss decreased (inf --> -0.722206).  Saving model ...
Epoch: 2 cost time: 3.8190019130706787
Epoch: 2, Steps: 7 | Train Loss: 0.503 Vali Loss: 1.371 Vali Acc: 0.806 Test Loss: 1.371 Test Acc: 0.806
Validation loss decreased (-0.722206 --> -0.805542).  Saving model ...
Epoch: 3 cost time: 3.6394858360290527
Epoch: 3, Steps: 7 | Train Loss: 0.240 Vali Loss: 2.661 Vali Acc: 0.833 Test Loss: 2.661 Test Acc: 0.833
Validation loss decreased (-0.805542 --> -0.833307).  Saving model ...
Epoch: 4 cost time: 3.8410911560058594
Epoch: 4, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.941 Vali Acc: 0.903 Test Loss: 0.941 Test Acc: 0.903
Validation loss decreased (-0.833307 --> -0.902768).  Saving model ...
Epoch: 5 cost time: 4.096967458724976
Epoch: 5, Steps: 7 | Train Loss: 0.096 Vali Loss: 1.175 Vali Acc: 0.875 Test Loss: 1.175 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5036985874176025
Epoch: 6, Steps: 7 | Train Loss: 0.702 Vali Loss: 1.008 Vali Acc: 0.903 Test Loss: 1.008 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.7675375938415527
Epoch: 7, Steps: 7 | Train Loss: 0.446 Vali Loss: 0.627 Vali Acc: 0.944 Test Loss: 0.627 Test Acc: 0.944
Validation loss decreased (-0.902768 --> -0.944438).  Saving model ...
Epoch: 8 cost time: 3.418400287628174
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 8.618 Vali Acc: 0.792 Test Loss: 8.618 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5734267234802246
Epoch: 9, Steps: 7 | Train Loss: 2.574 Vali Loss: 0.740 Vali Acc: 0.944 Test Loss: 0.740 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.962287187576294
Epoch: 10, Steps: 7 | Train Loss: 0.234 Vali Loss: 4.192 Vali Acc: 0.861 Test Loss: 4.192 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.2600321769714355
Epoch: 11, Steps: 7 | Train Loss: 0.979 Vali Loss: 6.069 Vali Acc: 0.847 Test Loss: 6.069 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.9895458221435547
Epoch: 12, Steps: 7 | Train Loss: 0.046 Vali Loss: 2.376 Vali Acc: 0.861 Test Loss: 2.376 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.101913690567017
Epoch: 13, Steps: 7 | Train Loss: 0.079 Vali Loss: 3.970 Vali Acc: 0.847 Test Loss: 3.970 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.7430784702301025
Epoch: 14, Steps: 7 | Train Loss: 0.102 Vali Loss: 3.510 Vali Acc: 0.875 Test Loss: 3.510 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.189199924468994
Epoch: 15, Steps: 7 | Train Loss: 0.096 Vali Loss: 4.620 Vali Acc: 0.903 Test Loss: 4.620 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.079036474227905
Epoch: 16, Steps: 7 | Train Loss: 0.116 Vali Loss: 5.035 Vali Acc: 0.875 Test Loss: 5.035 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.732710123062134
Epoch: 17, Steps: 7 | Train Loss: 0.203 Vali Loss: 4.456 Vali Acc: 0.903 Test Loss: 4.456 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 12629084
model size : 57.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.031195640563965
Epoch: 1, Steps: 7 | Train Loss: 2.358 Vali Loss: 1.634 Vali Acc: 0.736 Test Loss: 1.634 Test Acc: 0.736
Validation loss decreased (inf --> -0.736095).  Saving model ...
Epoch: 2 cost time: 3.5597970485687256
Epoch: 2, Steps: 7 | Train Loss: 0.463 Vali Loss: 1.288 Vali Acc: 0.792 Test Loss: 1.288 Test Acc: 0.792
Validation loss decreased (-0.736095 --> -0.791654).  Saving model ...
Epoch: 3 cost time: 3.3947439193725586
Epoch: 3, Steps: 7 | Train Loss: 0.318 Vali Loss: 1.735 Vali Acc: 0.861 Test Loss: 1.735 Test Acc: 0.861
Validation loss decreased (-0.791654 --> -0.861094).  Saving model ...
Epoch: 4 cost time: 3.3344357013702393
Epoch: 4, Steps: 7 | Train Loss: 0.052 Vali Loss: 1.691 Vali Acc: 0.833 Test Loss: 1.691 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.344647169113159
Epoch: 5, Steps: 7 | Train Loss: 0.052 Vali Loss: 2.160 Vali Acc: 0.875 Test Loss: 2.160 Test Acc: 0.875
Validation loss decreased (-0.861094 --> -0.874978).  Saving model ...
Epoch: 6 cost time: 3.57833194732666
Epoch: 6, Steps: 7 | Train Loss: 0.249 Vali Loss: 2.464 Vali Acc: 0.903 Test Loss: 2.464 Test Acc: 0.903
Validation loss decreased (-0.874978 --> -0.902753).  Saving model ...
Epoch: 7 cost time: 3.2881686687469482
Epoch: 7, Steps: 7 | Train Loss: 0.921 Vali Loss: 3.636 Vali Acc: 0.875 Test Loss: 3.636 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.000462055206299
Epoch: 8, Steps: 7 | Train Loss: 0.245 Vali Loss: 2.423 Vali Acc: 0.861 Test Loss: 2.423 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0159554481506348
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.190 Vali Acc: 0.917 Test Loss: 1.190 Test Acc: 0.917
Validation loss decreased (-0.902753 --> -0.916655).  Saving model ...
Epoch: 10 cost time: 3.4915826320648193
Epoch: 10, Steps: 7 | Train Loss: 0.166 Vali Loss: 3.015 Vali Acc: 0.889 Test Loss: 3.015 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3243348598480225
Epoch: 11, Steps: 7 | Train Loss: 0.322 Vali Loss: 2.401 Vali Acc: 0.889 Test Loss: 2.401 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0584936141967773
Epoch: 12, Steps: 7 | Train Loss: 0.247 Vali Loss: 0.571 Vali Acc: 0.972 Test Loss: 0.571 Test Acc: 0.972
Validation loss decreased (-0.916655 --> -0.972217).  Saving model ...
Epoch: 13 cost time: 3.4413864612579346
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 3.277 Vali Acc: 0.806 Test Loss: 3.277 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.645020008087158
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.523 Vali Acc: 0.833 Test Loss: 4.523 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.600675106048584
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.621 Vali Acc: 0.847 Test Loss: 3.621 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6941235065460205
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.859 Vali Acc: 0.847 Test Loss: 2.859 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.488853693008423
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.636 Vali Acc: 0.875 Test Loss: 2.636 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.4673569202423096
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.531 Vali Acc: 0.875 Test Loss: 2.531 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.3305797576904297
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.476 Vali Acc: 0.875 Test Loss: 2.476 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.322425365447998
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.445 Vali Acc: 0.875 Test Loss: 2.445 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.980902671813965
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.418 Vali Acc: 0.875 Test Loss: 2.418 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.138801336288452
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.401 Vali Acc: 0.875 Test Loss: 2.401 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 12629084
model size : 57.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.94050669670105
Epoch: 1, Steps: 7 | Train Loss: 2.320 Vali Loss: 1.491 Vali Acc: 0.764 Test Loss: 1.491 Test Acc: 0.764
Validation loss decreased (inf --> -0.763874).  Saving model ...
Epoch: 2 cost time: 3.038329839706421
Epoch: 2, Steps: 7 | Train Loss: 0.493 Vali Loss: 1.605 Vali Acc: 0.736 Test Loss: 1.605 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2415924072265625
Epoch: 3, Steps: 7 | Train Loss: 0.518 Vali Loss: 1.901 Vali Acc: 0.833 Test Loss: 1.901 Test Acc: 0.833
Validation loss decreased (-0.763874 --> -0.833314).  Saving model ...
Epoch: 4 cost time: 3.355989694595337
Epoch: 4, Steps: 7 | Train Loss: 0.105 Vali Loss: 2.968 Vali Acc: 0.792 Test Loss: 2.968 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.802572727203369
Epoch: 5, Steps: 7 | Train Loss: 0.511 Vali Loss: 3.737 Vali Acc: 0.819 Test Loss: 3.737 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.3828623294830322
Epoch: 6, Steps: 7 | Train Loss: 0.854 Vali Loss: 2.289 Vali Acc: 0.847 Test Loss: 2.289 Test Acc: 0.847
Validation loss decreased (-0.833314 --> -0.847199).  Saving model ...
Epoch: 7 cost time: 3.127809762954712
Epoch: 7, Steps: 7 | Train Loss: 0.032 Vali Loss: 1.947 Vali Acc: 0.889 Test Loss: 1.947 Test Acc: 0.889
Validation loss decreased (-0.847199 --> -0.888869).  Saving model ...
Epoch: 8 cost time: 3.3547091484069824
Epoch: 8, Steps: 7 | Train Loss: 0.161 Vali Loss: 2.889 Vali Acc: 0.861 Test Loss: 2.889 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.469944477081299
Epoch: 9, Steps: 7 | Train Loss: 0.144 Vali Loss: 2.880 Vali Acc: 0.875 Test Loss: 2.880 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1375653743743896
Epoch: 10, Steps: 7 | Train Loss: 0.058 Vali Loss: 1.959 Vali Acc: 0.903 Test Loss: 1.959 Test Acc: 0.903
Validation loss decreased (-0.888869 --> -0.902758).  Saving model ...
Epoch: 11 cost time: 2.639843225479126
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.879 Vali Acc: 0.917 Test Loss: 0.879 Test Acc: 0.917
Validation loss decreased (-0.902758 --> -0.916658).  Saving model ...
Epoch: 12 cost time: 2.5379998683929443
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.273 Vali Acc: 0.917 Test Loss: 2.273 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8451638221740723
Epoch: 13, Steps: 7 | Train Loss: 0.122 Vali Loss: 2.271 Vali Acc: 0.931 Test Loss: 2.271 Test Acc: 0.931
Validation loss decreased (-0.916658 --> -0.930533).  Saving model ...
Epoch: 14 cost time: 3.1719107627868652
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.876 Vali Acc: 0.903 Test Loss: 3.876 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0349316596984863
Epoch: 15, Steps: 7 | Train Loss: 0.169 Vali Loss: 2.211 Vali Acc: 0.861 Test Loss: 2.211 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.897148847579956
Epoch: 16, Steps: 7 | Train Loss: 0.889 Vali Loss: 1.119 Vali Acc: 0.931 Test Loss: 1.119 Test Acc: 0.931
Validation loss decreased (-0.930533 --> -0.930544).  Saving model ...
Epoch: 17 cost time: 3.3927698135375977
Epoch: 17, Steps: 7 | Train Loss: 0.541 Vali Loss: 2.074 Vali Acc: 0.889 Test Loss: 2.074 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.289963483810425
Epoch: 18, Steps: 7 | Train Loss: 0.161 Vali Loss: 2.118 Vali Acc: 0.903 Test Loss: 2.118 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.127944231033325
Epoch: 19, Steps: 7 | Train Loss: 0.260 Vali Loss: 5.080 Vali Acc: 0.819 Test Loss: 5.080 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.001101493835449
Epoch: 20, Steps: 7 | Train Loss: 0.842 Vali Loss: 1.687 Vali Acc: 0.931 Test Loss: 1.687 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.1086978912353516
Epoch: 21, Steps: 7 | Train Loss: 1.040 Vali Loss: 7.253 Vali Acc: 0.861 Test Loss: 7.253 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.0506396293640137
Epoch: 22, Steps: 7 | Train Loss: 1.035 Vali Loss: 3.302 Vali Acc: 0.903 Test Loss: 3.302 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.884723424911499
Epoch: 23, Steps: 7 | Train Loss: 0.999 Vali Loss: 3.499 Vali Acc: 0.903 Test Loss: 3.499 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.7195026874542236
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 8.321 Vali Acc: 0.833 Test Loss: 8.321 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.8285303115844727
Epoch: 25, Steps: 7 | Train Loss: 0.824 Vali Loss: 10.121 Vali Acc: 0.778 Test Loss: 10.121 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.0433342456817627
Epoch: 26, Steps: 7 | Train Loss: 0.077 Vali Loss: 3.290 Vali Acc: 0.931 Test Loss: 3.290 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 12629084
model size : 57.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.182541370391846
Epoch: 1, Steps: 7 | Train Loss: 2.378 Vali Loss: 1.106 Vali Acc: 0.708 Test Loss: 1.106 Test Acc: 0.708
Validation loss decreased (inf --> -0.708322).  Saving model ...
Epoch: 2 cost time: 3.713190793991089
Epoch: 2, Steps: 7 | Train Loss: 0.253 Vali Loss: 0.673 Vali Acc: 0.889 Test Loss: 0.673 Test Acc: 0.889
Validation loss decreased (-0.708322 --> -0.888882).  Saving model ...
Epoch: 3 cost time: 3.857973575592041
Epoch: 3, Steps: 7 | Train Loss: 0.159 Vali Loss: 1.744 Vali Acc: 0.819 Test Loss: 1.744 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6060726642608643
Epoch: 4, Steps: 7 | Train Loss: 0.716 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
Validation loss decreased (-0.888882 --> -0.958331).  Saving model ...
Epoch: 5 cost time: 3.678041458129883
Epoch: 5, Steps: 7 | Train Loss: 0.446 Vali Loss: 2.988 Vali Acc: 0.833 Test Loss: 2.988 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.436055898666382
Epoch: 6, Steps: 7 | Train Loss: 0.037 Vali Loss: 2.622 Vali Acc: 0.833 Test Loss: 2.622 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.010723829269409
Epoch: 7, Steps: 7 | Train Loss: 0.046 Vali Loss: 6.982 Vali Acc: 0.764 Test Loss: 6.982 Test Acc: 0.764
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.7528116703033447
Epoch: 8, Steps: 7 | Train Loss: 0.029 Vali Loss: 2.972 Vali Acc: 0.833 Test Loss: 2.972 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.519157648086548
Epoch: 9, Steps: 7 | Train Loss: 0.088 Vali Loss: 5.098 Vali Acc: 0.819 Test Loss: 5.098 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.4293267726898193
Epoch: 10, Steps: 7 | Train Loss: 0.044 Vali Loss: 3.307 Vali Acc: 0.861 Test Loss: 3.307 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.908705949783325
Epoch: 11, Steps: 7 | Train Loss: 0.043 Vali Loss: 4.274 Vali Acc: 0.889 Test Loss: 4.274 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.9811949729919434
Epoch: 12, Steps: 7 | Train Loss: 0.403 Vali Loss: 2.430 Vali Acc: 0.861 Test Loss: 2.430 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.042501211166382
Epoch: 13, Steps: 7 | Train Loss: 0.292 Vali Loss: 4.603 Vali Acc: 0.792 Test Loss: 4.603 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.9614076614379883
Epoch: 14, Steps: 7 | Train Loss: 0.542 Vali Loss: 10.509 Vali Acc: 0.792 Test Loss: 10.509 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 10531932
model size : 49.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.2666590213775635
Epoch: 1, Steps: 7 | Train Loss: 2.382 Vali Loss: 1.077 Vali Acc: 0.722 Test Loss: 1.077 Test Acc: 0.722
Validation loss decreased (inf --> -0.722211).  Saving model ...
Epoch: 2 cost time: 3.4027249813079834
Epoch: 2, Steps: 7 | Train Loss: 0.273 Vali Loss: 0.648 Vali Acc: 0.875 Test Loss: 0.648 Test Acc: 0.875
Validation loss decreased (-0.722211 --> -0.874994).  Saving model ...
Epoch: 3 cost time: 3.3528237342834473
Epoch: 3, Steps: 7 | Train Loss: 0.178 Vali Loss: 1.814 Vali Acc: 0.847 Test Loss: 1.814 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.159827947616577
Epoch: 4, Steps: 7 | Train Loss: 0.584 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.874994 --> -0.958331).  Saving model ...
Epoch: 5 cost time: 3.5717461109161377
Epoch: 5, Steps: 7 | Train Loss: 0.660 Vali Loss: 1.603 Vali Acc: 0.847 Test Loss: 1.603 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6981914043426514
Epoch: 6, Steps: 7 | Train Loss: 0.103 Vali Loss: 2.043 Vali Acc: 0.917 Test Loss: 2.043 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.889049530029297
Epoch: 7, Steps: 7 | Train Loss: 0.835 Vali Loss: 3.840 Vali Acc: 0.889 Test Loss: 3.840 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.5859694480895996
Epoch: 8, Steps: 7 | Train Loss: 0.294 Vali Loss: 3.599 Vali Acc: 0.889 Test Loss: 3.599 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.27303409576416
Epoch: 9, Steps: 7 | Train Loss: 0.117 Vali Loss: 4.975 Vali Acc: 0.847 Test Loss: 4.975 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.008392095565796
Epoch: 10, Steps: 7 | Train Loss: 0.172 Vali Loss: 2.158 Vali Acc: 0.903 Test Loss: 2.158 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.1448681354522705
Epoch: 11, Steps: 7 | Train Loss: 0.106 Vali Loss: 1.591 Vali Acc: 0.903 Test Loss: 1.591 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.2286767959594727
Epoch: 12, Steps: 7 | Train Loss: 0.268 Vali Loss: 3.301 Vali Acc: 0.931 Test Loss: 3.301 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.645946979522705
Epoch: 13, Steps: 7 | Train Loss: 0.238 Vali Loss: 7.258 Vali Acc: 0.778 Test Loss: 7.258 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.3340559005737305
Epoch: 14, Steps: 7 | Train Loss: 0.667 Vali Loss: 6.683 Vali Acc: 0.681 Test Loss: 6.683 Test Acc: 0.681
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 10531932
model size : 49.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.978518486022949
Epoch: 1, Steps: 7 | Train Loss: 2.380 Vali Loss: 1.085 Vali Acc: 0.722 Test Loss: 1.085 Test Acc: 0.722
Validation loss decreased (inf --> -0.722211).  Saving model ...
Epoch: 2 cost time: 3.1809630393981934
Epoch: 2, Steps: 7 | Train Loss: 0.251 Vali Loss: 0.632 Vali Acc: 0.847 Test Loss: 0.632 Test Acc: 0.847
Validation loss decreased (-0.722211 --> -0.847216).  Saving model ...
Epoch: 3 cost time: 3.016846179962158
Epoch: 3, Steps: 7 | Train Loss: 0.201 Vali Loss: 2.218 Vali Acc: 0.806 Test Loss: 2.218 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1521689891815186
Epoch: 4, Steps: 7 | Train Loss: 0.864 Vali Loss: 1.067 Vali Acc: 0.861 Test Loss: 1.067 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861100).  Saving model ...
Epoch: 5 cost time: 3.3215935230255127
Epoch: 5, Steps: 7 | Train Loss: 0.646 Vali Loss: 1.495 Vali Acc: 0.875 Test Loss: 1.495 Test Acc: 0.875
Validation loss decreased (-0.861100 --> -0.874985).  Saving model ...
Epoch: 6 cost time: 3.008871555328369
Epoch: 6, Steps: 7 | Train Loss: 0.291 Vali Loss: 4.479 Vali Acc: 0.819 Test Loss: 4.479 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.952380418777466
Epoch: 7, Steps: 7 | Train Loss: 0.755 Vali Loss: 3.724 Vali Acc: 0.875 Test Loss: 3.724 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0151212215423584
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.530 Vali Acc: 0.931 Test Loss: 1.530 Test Acc: 0.931
Validation loss decreased (-0.874985 --> -0.930540).  Saving model ...
Epoch: 9 cost time: 2.6248779296875
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 2.024 Vali Acc: 0.903 Test Loss: 2.024 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9080734252929688
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.518 Vali Acc: 0.861 Test Loss: 2.518 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1769001483917236
Epoch: 11, Steps: 7 | Train Loss: 0.032 Vali Loss: 3.332 Vali Acc: 0.861 Test Loss: 3.332 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2582335472106934
Epoch: 12, Steps: 7 | Train Loss: 0.664 Vali Loss: 3.086 Vali Acc: 0.875 Test Loss: 3.086 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.5565969944000244
Epoch: 13, Steps: 7 | Train Loss: 0.702 Vali Loss: 1.174 Vali Acc: 0.931 Test Loss: 1.174 Test Acc: 0.931
Validation loss decreased (-0.930540 --> -0.930544).  Saving model ...
Epoch: 14 cost time: 3.2862415313720703
Epoch: 14, Steps: 7 | Train Loss: 0.149 Vali Loss: 3.110 Vali Acc: 0.875 Test Loss: 3.110 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3592453002929688
Epoch: 15, Steps: 7 | Train Loss: 0.501 Vali Loss: 8.279 Vali Acc: 0.708 Test Loss: 8.279 Test Acc: 0.708
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.8000869750976562
Epoch: 16, Steps: 7 | Train Loss: 0.082 Vali Loss: 3.970 Vali Acc: 0.847 Test Loss: 3.970 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.567518472671509
Epoch: 17, Steps: 7 | Train Loss: 0.998 Vali Loss: 2.429 Vali Acc: 0.875 Test Loss: 2.429 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.1653406620025635
Epoch: 18, Steps: 7 | Train Loss: 0.192 Vali Loss: 6.916 Vali Acc: 0.792 Test Loss: 6.916 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.251129627227783
Epoch: 19, Steps: 7 | Train Loss: 0.357 Vali Loss: 3.788 Vali Acc: 0.889 Test Loss: 3.788 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.187346935272217
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.856 Vali Acc: 0.861 Test Loss: 2.856 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.435619354248047
Epoch: 21, Steps: 7 | Train Loss: 0.389 Vali Loss: 3.197 Vali Acc: 0.861 Test Loss: 3.197 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.420616865158081
Epoch: 22, Steps: 7 | Train Loss: 0.066 Vali Loss: 2.999 Vali Acc: 0.917 Test Loss: 2.999 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.2239794731140137
Epoch: 23, Steps: 7 | Train Loss: 0.398 Vali Loss: 10.999 Vali Acc: 0.764 Test Loss: 10.999 Test Acc: 0.764
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 10531932
model size : 49.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.300990581512451
Epoch: 1, Steps: 7 | Train Loss: 2.365 Vali Loss: 1.096 Vali Acc: 0.736 Test Loss: 1.096 Test Acc: 0.736
Validation loss decreased (inf --> -0.736100).  Saving model ...
Epoch: 2 cost time: 2.4874191284179688
Epoch: 2, Steps: 7 | Train Loss: 0.289 Vali Loss: 0.491 Vali Acc: 0.875 Test Loss: 0.491 Test Acc: 0.875
Validation loss decreased (-0.736100 --> -0.874995).  Saving model ...
Epoch: 3 cost time: 2.6366934776306152
Epoch: 3, Steps: 7 | Train Loss: 0.186 Vali Loss: 2.211 Vali Acc: 0.806 Test Loss: 2.211 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7986373901367188
Epoch: 4, Steps: 7 | Train Loss: 0.424 Vali Loss: 0.407 Vali Acc: 0.903 Test Loss: 0.407 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 2.944535255432129
Epoch: 5, Steps: 7 | Train Loss: 0.697 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 2.834293842315674
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.810 Vali Acc: 0.875 Test Loss: 0.810 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.610941171646118
Epoch: 7, Steps: 7 | Train Loss: 0.442 Vali Loss: 2.533 Vali Acc: 0.847 Test Loss: 2.533 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9658403396606445
Epoch: 8, Steps: 7 | Train Loss: 0.185 Vali Loss: 1.222 Vali Acc: 0.917 Test Loss: 1.222 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0068464279174805
Epoch: 9, Steps: 7 | Train Loss: 0.439 Vali Loss: 1.197 Vali Acc: 0.917 Test Loss: 1.197 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0037789344787598
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 4.286 Vali Acc: 0.792 Test Loss: 4.286 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.7418909072875977
Epoch: 11, Steps: 7 | Train Loss: 0.833 Vali Loss: 0.743 Vali Acc: 0.931 Test Loss: 0.743 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930548).  Saving model ...
Epoch: 12 cost time: 2.7449851036071777
Epoch: 12, Steps: 7 | Train Loss: 0.465 Vali Loss: 1.206 Vali Acc: 0.903 Test Loss: 1.206 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.749519109725952
Epoch: 13, Steps: 7 | Train Loss: 0.103 Vali Loss: 2.686 Vali Acc: 0.792 Test Loss: 2.686 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.1160731315612793
Epoch: 14, Steps: 7 | Train Loss: 0.508 Vali Loss: 2.939 Vali Acc: 0.847 Test Loss: 2.939 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.9292702674865723
Epoch: 15, Steps: 7 | Train Loss: 0.648 Vali Loss: 6.195 Vali Acc: 0.806 Test Loss: 6.195 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.9181981086730957
Epoch: 16, Steps: 7 | Train Loss: 0.440 Vali Loss: 2.968 Vali Acc: 0.861 Test Loss: 2.968 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.9752492904663086
Epoch: 17, Steps: 7 | Train Loss: 0.038 Vali Loss: 6.037 Vali Acc: 0.806 Test Loss: 6.037 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.5974841117858887
Epoch: 18, Steps: 7 | Train Loss: 0.413 Vali Loss: 7.138 Vali Acc: 0.861 Test Loss: 7.138 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.1154837608337402
Epoch: 19, Steps: 7 | Train Loss: 0.864 Vali Loss: 7.352 Vali Acc: 0.861 Test Loss: 7.352 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.0209333896636963
Epoch: 20, Steps: 7 | Train Loss: 0.236 Vali Loss: 5.534 Vali Acc: 0.931 Test Loss: 5.534 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.9037861824035645
Epoch: 21, Steps: 7 | Train Loss: 0.030 Vali Loss: 4.550 Vali Acc: 0.903 Test Loss: 4.550 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 10531932
model size : 49.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.703105926513672
Epoch: 1, Steps: 7 | Train Loss: 2.151 Vali Loss: 0.745 Vali Acc: 0.778 Test Loss: 0.745 Test Acc: 0.778
Validation loss decreased (inf --> -0.777770).  Saving model ...
Epoch: 2 cost time: 3.038144111633301
Epoch: 2, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.923 Vali Acc: 0.833 Test Loss: 0.923 Test Acc: 0.833
Validation loss decreased (-0.777770 --> -0.833324).  Saving model ...
Epoch: 3 cost time: 3.4544167518615723
Epoch: 3, Steps: 7 | Train Loss: 0.023 Vali Loss: 3.045 Vali Acc: 0.792 Test Loss: 3.045 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7929210662841797
Epoch: 4, Steps: 7 | Train Loss: 1.610 Vali Loss: 0.993 Vali Acc: 0.889 Test Loss: 0.993 Test Acc: 0.889
Validation loss decreased (-0.833324 --> -0.888879).  Saving model ...
Epoch: 5 cost time: 3.194831132888794
Epoch: 5, Steps: 7 | Train Loss: 0.309 Vali Loss: 3.964 Vali Acc: 0.847 Test Loss: 3.964 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.606588363647461
Epoch: 6, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.975 Vali Acc: 0.917 Test Loss: 0.975 Test Acc: 0.917
Validation loss decreased (-0.888879 --> -0.916657).  Saving model ...
Epoch: 7 cost time: 4.1598803997039795
Epoch: 7, Steps: 7 | Train Loss: 0.390 Vali Loss: 1.097 Vali Acc: 0.944 Test Loss: 1.097 Test Acc: 0.944
Validation loss decreased (-0.916657 --> -0.944433).  Saving model ...
Epoch: 8 cost time: 4.110148191452026
Epoch: 8, Steps: 7 | Train Loss: 0.118 Vali Loss: 1.284 Vali Acc: 0.903 Test Loss: 1.284 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8347227573394775
Epoch: 9, Steps: 7 | Train Loss: 0.037 Vali Loss: 1.771 Vali Acc: 0.903 Test Loss: 1.771 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.617321729660034
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.576 Vali Acc: 0.819 Test Loss: 4.576 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.4871814250946045
Epoch: 11, Steps: 7 | Train Loss: 0.081 Vali Loss: 3.058 Vali Acc: 0.833 Test Loss: 3.058 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.152266025543213
Epoch: 12, Steps: 7 | Train Loss: 0.346 Vali Loss: 2.973 Vali Acc: 0.861 Test Loss: 2.973 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.767853021621704
Epoch: 13, Steps: 7 | Train Loss: 0.978 Vali Loss: 1.385 Vali Acc: 0.903 Test Loss: 1.385 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.3264169692993164
Epoch: 14, Steps: 7 | Train Loss: 0.029 Vali Loss: 4.659 Vali Acc: 0.806 Test Loss: 4.659 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.4235095977783203
Epoch: 15, Steps: 7 | Train Loss: 0.792 Vali Loss: 3.504 Vali Acc: 0.889 Test Loss: 3.504 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.1287267208099365
Epoch: 16, Steps: 7 | Train Loss: 0.069 Vali Loss: 3.636 Vali Acc: 0.833 Test Loss: 3.636 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.6603524684906006
Epoch: 17, Steps: 7 | Train Loss: 0.153 Vali Loss: 9.770 Vali Acc: 0.833 Test Loss: 9.770 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 9483356
model size : 45.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.0914812088012695
Epoch: 1, Steps: 7 | Train Loss: 2.125 Vali Loss: 0.741 Vali Acc: 0.750 Test Loss: 0.741 Test Acc: 0.750
Validation loss decreased (inf --> -0.749993).  Saving model ...
Epoch: 2 cost time: 3.0051445960998535
Epoch: 2, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.821 Vali Acc: 0.861 Test Loss: 0.821 Test Acc: 0.861
Validation loss decreased (-0.749993 --> -0.861103).  Saving model ...
Epoch: 3 cost time: 2.8530707359313965
Epoch: 3, Steps: 7 | Train Loss: 0.136 Vali Loss: 1.722 Vali Acc: 0.819 Test Loss: 1.722 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.903369903564453
Epoch: 4, Steps: 7 | Train Loss: 0.981 Vali Loss: 0.738 Vali Acc: 0.875 Test Loss: 0.738 Test Acc: 0.875
Validation loss decreased (-0.861103 --> -0.874993).  Saving model ...
Epoch: 5 cost time: 3.6132760047912598
Epoch: 5, Steps: 7 | Train Loss: 0.099 Vali Loss: 1.039 Vali Acc: 0.847 Test Loss: 1.039 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.311911106109619
Epoch: 6, Steps: 7 | Train Loss: 0.059 Vali Loss: 1.029 Vali Acc: 0.903 Test Loss: 1.029 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902767).  Saving model ...
Epoch: 7 cost time: 3.1905112266540527
Epoch: 7, Steps: 7 | Train Loss: 1.348 Vali Loss: 0.566 Vali Acc: 0.944 Test Loss: 0.566 Test Acc: 0.944
Validation loss decreased (-0.902767 --> -0.944439).  Saving model ...
Epoch: 8 cost time: 3.339444160461426
Epoch: 8, Steps: 7 | Train Loss: 0.406 Vali Loss: 1.958 Vali Acc: 0.875 Test Loss: 1.958 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.653996706008911
Epoch: 9, Steps: 7 | Train Loss: 0.074 Vali Loss: 2.704 Vali Acc: 0.903 Test Loss: 2.704 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6344900131225586
Epoch: 10, Steps: 7 | Train Loss: 0.380 Vali Loss: 2.263 Vali Acc: 0.889 Test Loss: 2.263 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.3468432426452637
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 3.621 Vali Acc: 0.847 Test Loss: 3.621 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.275848865509033
Epoch: 12, Steps: 7 | Train Loss: 0.265 Vali Loss: 3.754 Vali Acc: 0.875 Test Loss: 3.754 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.1152780055999756
Epoch: 13, Steps: 7 | Train Loss: 1.427 Vali Loss: 3.128 Vali Acc: 0.889 Test Loss: 3.128 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.1792685985565186
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.258 Vali Acc: 0.917 Test Loss: 1.258 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.914774179458618
Epoch: 15, Steps: 7 | Train Loss: 0.065 Vali Loss: 2.174 Vali Acc: 0.833 Test Loss: 2.174 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.1418659687042236
Epoch: 16, Steps: 7 | Train Loss: 0.065 Vali Loss: 5.751 Vali Acc: 0.875 Test Loss: 5.751 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.3209636211395264
Epoch: 17, Steps: 7 | Train Loss: 0.678 Vali Loss: 4.291 Vali Acc: 0.889 Test Loss: 4.291 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 9483356
model size : 45.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.917165040969849
Epoch: 1, Steps: 7 | Train Loss: 2.091 Vali Loss: 0.713 Vali Acc: 0.736 Test Loss: 0.713 Test Acc: 0.736
Validation loss decreased (inf --> -0.736104).  Saving model ...
Epoch: 2 cost time: 3.1708567142486572
Epoch: 2, Steps: 7 | Train Loss: 0.122 Vali Loss: 0.572 Vali Acc: 0.847 Test Loss: 0.572 Test Acc: 0.847
Validation loss decreased (-0.736104 --> -0.847216).  Saving model ...
Epoch: 3 cost time: 3.4163506031036377
Epoch: 3, Steps: 7 | Train Loss: 0.094 Vali Loss: 1.327 Vali Acc: 0.792 Test Loss: 1.327 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.849963665008545
Epoch: 4, Steps: 7 | Train Loss: 0.974 Vali Loss: 4.005 Vali Acc: 0.833 Test Loss: 4.005 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9696507453918457
Epoch: 5, Steps: 7 | Train Loss: 0.306 Vali Loss: 1.919 Vali Acc: 0.875 Test Loss: 1.919 Test Acc: 0.875
Validation loss decreased (-0.847216 --> -0.874981).  Saving model ...
Epoch: 6 cost time: 3.2445120811462402
Epoch: 6, Steps: 7 | Train Loss: 0.334 Vali Loss: 0.379 Vali Acc: 0.931 Test Loss: 0.379 Test Acc: 0.931
Validation loss decreased (-0.874981 --> -0.930552).  Saving model ...
Epoch: 7 cost time: 3.279404640197754
Epoch: 7, Steps: 7 | Train Loss: 0.299 Vali Loss: 1.872 Vali Acc: 0.889 Test Loss: 1.872 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.336723804473877
Epoch: 8, Steps: 7 | Train Loss: 0.095 Vali Loss: 3.500 Vali Acc: 0.833 Test Loss: 3.500 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1409358978271484
Epoch: 9, Steps: 7 | Train Loss: 0.406 Vali Loss: 2.784 Vali Acc: 0.875 Test Loss: 2.784 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.570955991744995
Epoch: 10, Steps: 7 | Train Loss: 0.097 Vali Loss: 2.711 Vali Acc: 0.903 Test Loss: 2.711 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.5922367572784424
Epoch: 11, Steps: 7 | Train Loss: 0.148 Vali Loss: 3.889 Vali Acc: 0.847 Test Loss: 3.889 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.8821160793304443
Epoch: 12, Steps: 7 | Train Loss: 0.207 Vali Loss: 2.885 Vali Acc: 0.889 Test Loss: 2.885 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.158426284790039
Epoch: 13, Steps: 7 | Train Loss: 0.119 Vali Loss: 4.834 Vali Acc: 0.903 Test Loss: 4.834 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.2869715690612793
Epoch: 14, Steps: 7 | Train Loss: 0.018 Vali Loss: 5.899 Vali Acc: 0.847 Test Loss: 5.899 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.1889917850494385
Epoch: 15, Steps: 7 | Train Loss: 0.720 Vali Loss: 2.503 Vali Acc: 0.903 Test Loss: 2.503 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.148198366165161
Epoch: 16, Steps: 7 | Train Loss: 0.197 Vali Loss: 7.625 Vali Acc: 0.764 Test Loss: 7.625 Test Acc: 0.764
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 9483356
model size : 45.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.59247350692749
Epoch: 1, Steps: 7 | Train Loss: 2.118 Vali Loss: 0.702 Vali Acc: 0.736 Test Loss: 0.702 Test Acc: 0.736
Validation loss decreased (inf --> -0.736104).  Saving model ...
Epoch: 2 cost time: 2.7977354526519775
Epoch: 2, Steps: 7 | Train Loss: 0.171 Vali Loss: 0.491 Vali Acc: 0.889 Test Loss: 0.491 Test Acc: 0.889
Validation loss decreased (-0.736104 --> -0.888884).  Saving model ...
Epoch: 3 cost time: 2.818347454071045
Epoch: 3, Steps: 7 | Train Loss: 0.028 Vali Loss: 1.308 Vali Acc: 0.778 Test Loss: 1.308 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5436747074127197
Epoch: 4, Steps: 7 | Train Loss: 0.805 Vali Loss: 1.986 Vali Acc: 0.806 Test Loss: 1.986 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9157543182373047
Epoch: 5, Steps: 7 | Train Loss: 0.714 Vali Loss: 1.405 Vali Acc: 0.847 Test Loss: 1.405 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.917762517929077
Epoch: 6, Steps: 7 | Train Loss: 0.288 Vali Loss: 0.970 Vali Acc: 0.903 Test Loss: 0.970 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902768).  Saving model ...
Epoch: 7 cost time: 2.5269126892089844
Epoch: 7, Steps: 7 | Train Loss: 0.186 Vali Loss: 1.033 Vali Acc: 0.931 Test Loss: 1.033 Test Acc: 0.931
Validation loss decreased (-0.902768 --> -0.930545).  Saving model ...
Epoch: 8 cost time: 2.3972461223602295
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.219 Vali Acc: 0.917 Test Loss: 1.219 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4878015518188477
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.859 Vali Acc: 0.889 Test Loss: 1.859 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9780914783477783
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.970 Vali Acc: 0.903 Test Loss: 1.970 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.783565044403076
Epoch: 11, Steps: 7 | Train Loss: 0.479 Vali Loss: 2.459 Vali Acc: 0.903 Test Loss: 2.459 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8363800048828125
Epoch: 12, Steps: 7 | Train Loss: 0.187 Vali Loss: 1.396 Vali Acc: 0.931 Test Loss: 1.396 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.9773895740509033
Epoch: 13, Steps: 7 | Train Loss: 0.327 Vali Loss: 2.915 Vali Acc: 0.847 Test Loss: 2.915 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.8708512783050537
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 5.242 Vali Acc: 0.806 Test Loss: 5.242 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.285395383834839
Epoch: 15, Steps: 7 | Train Loss: 0.439 Vali Loss: 4.606 Vali Acc: 0.819 Test Loss: 4.606 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.3157806396484375
Epoch: 16, Steps: 7 | Train Loss: 0.021 Vali Loss: 5.268 Vali Acc: 0.833 Test Loss: 5.268 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.235356330871582
Epoch: 17, Steps: 7 | Train Loss: 0.445 Vali Loss: 3.096 Vali Acc: 0.875 Test Loss: 3.096 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 9483356
model size : 45.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.507899284362793
Epoch: 1, Steps: 7 | Train Loss: 2.235 Vali Loss: 0.682 Vali Acc: 0.736 Test Loss: 0.682 Test Acc: 0.736
Validation loss decreased (inf --> -0.736104).  Saving model ...
Epoch: 2 cost time: 3.2938501834869385
Epoch: 2, Steps: 7 | Train Loss: 0.178 Vali Loss: 1.267 Vali Acc: 0.833 Test Loss: 1.267 Test Acc: 0.833
Validation loss decreased (-0.736104 --> -0.833321).  Saving model ...
Epoch: 3 cost time: 3.0709893703460693
Epoch: 3, Steps: 7 | Train Loss: 0.097 Vali Loss: 2.402 Vali Acc: 0.847 Test Loss: 2.402 Test Acc: 0.847
Validation loss decreased (-0.833321 --> -0.847198).  Saving model ...
Epoch: 4 cost time: 3.378757953643799
Epoch: 4, Steps: 7 | Train Loss: 0.052 Vali Loss: 1.503 Vali Acc: 0.903 Test Loss: 1.503 Test Acc: 0.903
Validation loss decreased (-0.847198 --> -0.902763).  Saving model ...
Epoch: 5 cost time: 3.346097707748413
Epoch: 5, Steps: 7 | Train Loss: 0.191 Vali Loss: 1.539 Vali Acc: 0.917 Test Loss: 1.539 Test Acc: 0.917
Validation loss decreased (-0.902763 --> -0.916651).  Saving model ...
Epoch: 6 cost time: 3.556652307510376
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.442 Vali Acc: 0.861 Test Loss: 2.442 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.295408248901367
Epoch: 7, Steps: 7 | Train Loss: 0.292 Vali Loss: 1.908 Vali Acc: 0.903 Test Loss: 1.908 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3356692790985107
Epoch: 8, Steps: 7 | Train Loss: 0.365 Vali Loss: 1.712 Vali Acc: 0.903 Test Loss: 1.712 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.4985570907592773
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.833 Vali Acc: 0.889 Test Loss: 2.833 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.153876781463623
Epoch: 10, Steps: 7 | Train Loss: 0.022 Vali Loss: 1.412 Vali Acc: 0.931 Test Loss: 1.412 Test Acc: 0.931
Validation loss decreased (-0.916651 --> -0.930541).  Saving model ...
Epoch: 11 cost time: 3.847710609436035
Epoch: 11, Steps: 7 | Train Loss: 0.030 Vali Loss: 1.081 Vali Acc: 0.931 Test Loss: 1.081 Test Acc: 0.931
Validation loss decreased (-0.930541 --> -0.930545).  Saving model ...
Epoch: 12 cost time: 3.472322463989258
Epoch: 12, Steps: 7 | Train Loss: 0.505 Vali Loss: 3.734 Vali Acc: 0.833 Test Loss: 3.734 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.349410057067871
Epoch: 13, Steps: 7 | Train Loss: 0.756 Vali Loss: 10.493 Vali Acc: 0.736 Test Loss: 10.493 Test Acc: 0.736
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.2726752758026123
Epoch: 14, Steps: 7 | Train Loss: 0.859 Vali Loss: 9.692 Vali Acc: 0.722 Test Loss: 9.692 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.6062121391296387
Epoch: 15, Steps: 7 | Train Loss: 0.770 Vali Loss: 4.969 Vali Acc: 0.847 Test Loss: 4.969 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.6800734996795654
Epoch: 16, Steps: 7 | Train Loss: 1.592 Vali Loss: 3.583 Vali Acc: 0.819 Test Loss: 3.583 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.75266432762146
Epoch: 17, Steps: 7 | Train Loss: 0.724 Vali Loss: 4.951 Vali Acc: 0.847 Test Loss: 4.951 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.8742380142211914
Epoch: 18, Steps: 7 | Train Loss: 0.292 Vali Loss: 4.908 Vali Acc: 0.903 Test Loss: 4.908 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.7770798206329346
Epoch: 19, Steps: 7 | Train Loss: 0.223 Vali Loss: 7.390 Vali Acc: 0.847 Test Loss: 7.390 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.3947184085845947
Epoch: 20, Steps: 7 | Train Loss: 0.165 Vali Loss: 8.651 Vali Acc: 0.833 Test Loss: 8.651 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.386898994445801
Epoch: 21, Steps: 7 | Train Loss: 0.184 Vali Loss: 6.488 Vali Acc: 0.903 Test Loss: 6.488 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 8959068
model size : 43.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.6010355949401855
Epoch: 1, Steps: 7 | Train Loss: 2.208 Vali Loss: 0.649 Vali Acc: 0.750 Test Loss: 0.649 Test Acc: 0.750
Validation loss decreased (inf --> -0.749994).  Saving model ...
Epoch: 2 cost time: 3.0087287425994873
Epoch: 2, Steps: 7 | Train Loss: 0.160 Vali Loss: 1.242 Vali Acc: 0.819 Test Loss: 1.242 Test Acc: 0.819
Validation loss decreased (-0.749994 --> -0.819432).  Saving model ...
Epoch: 3 cost time: 3.2608883380889893
Epoch: 3, Steps: 7 | Train Loss: 0.151 Vali Loss: 2.412 Vali Acc: 0.847 Test Loss: 2.412 Test Acc: 0.847
Validation loss decreased (-0.819432 --> -0.847198).  Saving model ...
Epoch: 4 cost time: 3.0128350257873535
Epoch: 4, Steps: 7 | Train Loss: 0.070 Vali Loss: 1.444 Vali Acc: 0.889 Test Loss: 1.444 Test Acc: 0.889
Validation loss decreased (-0.847198 --> -0.888874).  Saving model ...
Epoch: 5 cost time: 3.3788790702819824
Epoch: 5, Steps: 7 | Train Loss: 0.453 Vali Loss: 1.499 Vali Acc: 0.917 Test Loss: 1.499 Test Acc: 0.917
Validation loss decreased (-0.888874 --> -0.916652).  Saving model ...
Epoch: 6 cost time: 3.4270012378692627
Epoch: 6, Steps: 7 | Train Loss: 0.294 Vali Loss: 1.919 Vali Acc: 0.889 Test Loss: 1.919 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.109578847885132
Epoch: 7, Steps: 7 | Train Loss: 0.241 Vali Loss: 0.327 Vali Acc: 0.958 Test Loss: 0.327 Test Acc: 0.958
Validation loss decreased (-0.916652 --> -0.958330).  Saving model ...
Epoch: 8 cost time: 2.9967575073242188
Epoch: 8, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.549 Vali Acc: 0.931 Test Loss: 0.549 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1736464500427246
Epoch: 9, Steps: 7 | Train Loss: 0.118 Vali Loss: 3.767 Vali Acc: 0.833 Test Loss: 3.767 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.525076389312744
Epoch: 10, Steps: 7 | Train Loss: 0.161 Vali Loss: 4.914 Vali Acc: 0.833 Test Loss: 4.914 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.291788339614868
Epoch: 11, Steps: 7 | Train Loss: 1.011 Vali Loss: 3.034 Vali Acc: 0.847 Test Loss: 3.034 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.038466453552246
Epoch: 12, Steps: 7 | Train Loss: 0.291 Vali Loss: 1.908 Vali Acc: 0.931 Test Loss: 1.908 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.824803352355957
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 3.281 Vali Acc: 0.861 Test Loss: 3.281 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.126647472381592
Epoch: 14, Steps: 7 | Train Loss: 0.223 Vali Loss: 9.707 Vali Acc: 0.792 Test Loss: 9.707 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.5216922760009766
Epoch: 15, Steps: 7 | Train Loss: 0.191 Vali Loss: 2.085 Vali Acc: 0.889 Test Loss: 2.085 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.3017725944519043
Epoch: 16, Steps: 7 | Train Loss: 0.484 Vali Loss: 2.222 Vali Acc: 0.917 Test Loss: 2.222 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.3886334896087646
Epoch: 17, Steps: 7 | Train Loss: 0.021 Vali Loss: 13.408 Vali Acc: 0.819 Test Loss: 13.408 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 8959068
model size : 43.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.802144527435303
Epoch: 1, Steps: 7 | Train Loss: 2.165 Vali Loss: 0.664 Vali Acc: 0.750 Test Loss: 0.664 Test Acc: 0.750
Validation loss decreased (inf --> -0.749993).  Saving model ...
Epoch: 2 cost time: 2.9965476989746094
Epoch: 2, Steps: 7 | Train Loss: 0.160 Vali Loss: 1.031 Vali Acc: 0.833 Test Loss: 1.031 Test Acc: 0.833
Validation loss decreased (-0.749993 --> -0.833323).  Saving model ...
Epoch: 3 cost time: 3.3374829292297363
Epoch: 3, Steps: 7 | Train Loss: 0.031 Vali Loss: 1.983 Vali Acc: 0.847 Test Loss: 1.983 Test Acc: 0.847
Validation loss decreased (-0.833323 --> -0.847202).  Saving model ...
Epoch: 4 cost time: 2.9904870986938477
Epoch: 4, Steps: 7 | Train Loss: 0.038 Vali Loss: 1.464 Vali Acc: 0.903 Test Loss: 1.464 Test Acc: 0.903
Validation loss decreased (-0.847202 --> -0.902763).  Saving model ...
Epoch: 5 cost time: 3.1248972415924072
Epoch: 5, Steps: 7 | Train Loss: 0.050 Vali Loss: 2.008 Vali Acc: 0.847 Test Loss: 2.008 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.06252121925354
Epoch: 6, Steps: 7 | Train Loss: 0.250 Vali Loss: 1.830 Vali Acc: 0.847 Test Loss: 1.830 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0808298587799072
Epoch: 7, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.821 Vali Acc: 0.903 Test Loss: 0.821 Test Acc: 0.903
Validation loss decreased (-0.902763 --> -0.902770).  Saving model ...
Epoch: 8 cost time: 2.9648549556732178
Epoch: 8, Steps: 7 | Train Loss: 0.213 Vali Loss: 2.811 Vali Acc: 0.917 Test Loss: 2.811 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916639).  Saving model ...
Epoch: 9 cost time: 3.103731632232666
Epoch: 9, Steps: 7 | Train Loss: 0.025 Vali Loss: 2.058 Vali Acc: 0.875 Test Loss: 2.058 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2142622470855713
Epoch: 10, Steps: 7 | Train Loss: 0.073 Vali Loss: 8.941 Vali Acc: 0.847 Test Loss: 8.941 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.0772645473480225
Epoch: 11, Steps: 7 | Train Loss: 1.216 Vali Loss: 2.763 Vali Acc: 0.889 Test Loss: 2.763 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.08434796333313
Epoch: 12, Steps: 7 | Train Loss: 0.459 Vali Loss: 3.266 Vali Acc: 0.861 Test Loss: 3.266 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.9729766845703125
Epoch: 13, Steps: 7 | Train Loss: 0.456 Vali Loss: 2.881 Vali Acc: 0.889 Test Loss: 2.881 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.3243961334228516
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.741 Vali Acc: 0.833 Test Loss: 5.741 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.3083982467651367
Epoch: 15, Steps: 7 | Train Loss: 0.226 Vali Loss: 4.012 Vali Acc: 0.861 Test Loss: 4.012 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.3628957271575928
Epoch: 16, Steps: 7 | Train Loss: 0.115 Vali Loss: 4.176 Vali Acc: 0.875 Test Loss: 4.176 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.019357442855835
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 1.605 Vali Acc: 0.903 Test Loss: 1.605 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.7225399017333984
Epoch: 18, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.834 Vali Acc: 0.931 Test Loss: 0.834 Test Acc: 0.931
Validation loss decreased (-0.916639 --> -0.930547).  Saving model ...
Epoch: 19 cost time: 3.255664348602295
Epoch: 19, Steps: 7 | Train Loss: 0.074 Vali Loss: 2.555 Vali Acc: 0.889 Test Loss: 2.555 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1431617736816406
Epoch: 20, Steps: 7 | Train Loss: 0.150 Vali Loss: 1.153 Vali Acc: 0.917 Test Loss: 1.153 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.9865562915802
Epoch: 21, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.484 Vali Acc: 0.958 Test Loss: 0.484 Test Acc: 0.958
Validation loss decreased (-0.930547 --> -0.958328).  Saving model ...
Epoch: 22 cost time: 2.940234422683716
Epoch: 22, Steps: 7 | Train Loss: 0.180 Vali Loss: 0.940 Vali Acc: 0.958 Test Loss: 0.940 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.530734062194824
Epoch: 23, Steps: 7 | Train Loss: 0.253 Vali Loss: 3.535 Vali Acc: 0.903 Test Loss: 3.535 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.9124321937561035
Epoch: 24, Steps: 7 | Train Loss: 0.054 Vali Loss: 7.807 Vali Acc: 0.833 Test Loss: 7.807 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.756598711013794
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 19.208 Vali Acc: 0.708 Test Loss: 19.208 Test Acc: 0.708
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.792865037918091
Epoch: 26, Steps: 7 | Train Loss: 0.863 Vali Loss: 7.108 Vali Acc: 0.889 Test Loss: 7.108 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.9133431911468506
Epoch: 27, Steps: 7 | Train Loss: 0.361 Vali Loss: 7.292 Vali Acc: 0.861 Test Loss: 7.292 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.790698766708374
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 9.073 Vali Acc: 0.875 Test Loss: 9.073 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.2950046062469482
Epoch: 29, Steps: 7 | Train Loss: 0.063 Vali Loss: 13.254 Vali Acc: 0.736 Test Loss: 13.254 Test Acc: 0.736
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.1098055839538574
Epoch: 30, Steps: 7 | Train Loss: 0.030 Vali Loss: 12.563 Vali Acc: 0.792 Test Loss: 12.563 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.9335436820983887
Epoch: 31, Steps: 7 | Train Loss: 0.079 Vali Loss: 18.249 Vali Acc: 0.750 Test Loss: 18.249 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 8959068
model size : 43.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.607553005218506
Epoch: 1, Steps: 7 | Train Loss: 2.136 Vali Loss: 0.666 Vali Acc: 0.708 Test Loss: 0.666 Test Acc: 0.708
Validation loss decreased (inf --> -0.708327).  Saving model ...
Epoch: 2 cost time: 2.6156065464019775
Epoch: 2, Steps: 7 | Train Loss: 0.244 Vali Loss: 1.011 Vali Acc: 0.833 Test Loss: 1.011 Test Acc: 0.833
Validation loss decreased (-0.708327 --> -0.833323).  Saving model ...
Epoch: 3 cost time: 2.865537405014038
Epoch: 3, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.854 Vali Acc: 0.875 Test Loss: 0.854 Test Acc: 0.875
Validation loss decreased (-0.833323 --> -0.874991).  Saving model ...
Epoch: 4 cost time: 2.90986704826355
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.861 Test Loss: 1.252 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7953052520751953
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.871 Vali Acc: 0.875 Test Loss: 1.871 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5751349925994873
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.894 Vali Acc: 0.847 Test Loss: 1.894 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4650092124938965
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.874 Vali Acc: 0.861 Test Loss: 1.874 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8017287254333496
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.004 Vali Acc: 0.875 Test Loss: 2.004 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.871638536453247
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.090 Vali Acc: 0.861 Test Loss: 2.090 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.912853240966797
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.110 Vali Acc: 0.861 Test Loss: 2.110 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.6331756114959717
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.053 Vali Acc: 0.861 Test Loss: 2.053 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.8349475860595703
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.018 Vali Acc: 0.861 Test Loss: 2.018 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4319779872894287
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.997 Vali Acc: 0.861 Test Loss: 1.997 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 8959068
model size : 43.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.038202285766602
Epoch: 1, Steps: 7 | Train Loss: 2.238 Vali Loss: 0.907 Vali Acc: 0.639 Test Loss: 0.907 Test Acc: 0.639
Validation loss decreased (inf --> -0.638880).  Saving model ...
Epoch: 2 cost time: 3.0988833904266357
Epoch: 2, Steps: 7 | Train Loss: 0.200 Vali Loss: 1.264 Vali Acc: 0.806 Test Loss: 1.264 Test Acc: 0.806
Validation loss decreased (-0.638880 --> -0.805543).  Saving model ...
Epoch: 3 cost time: 3.636045217514038
Epoch: 3, Steps: 7 | Train Loss: 0.232 Vali Loss: 1.799 Vali Acc: 0.875 Test Loss: 1.799 Test Acc: 0.875
Validation loss decreased (-0.805543 --> -0.874982).  Saving model ...
Epoch: 4 cost time: 3.624122142791748
Epoch: 4, Steps: 7 | Train Loss: 0.135 Vali Loss: 2.678 Vali Acc: 0.806 Test Loss: 2.678 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.489485740661621
Epoch: 5, Steps: 7 | Train Loss: 0.051 Vali Loss: 1.816 Vali Acc: 0.903 Test Loss: 1.816 Test Acc: 0.903
Validation loss decreased (-0.874982 --> -0.902760).  Saving model ...
Epoch: 6 cost time: 3.5456411838531494
Epoch: 6, Steps: 7 | Train Loss: 0.031 Vali Loss: 2.571 Vali Acc: 0.819 Test Loss: 2.571 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4584596157073975
Epoch: 7, Steps: 7 | Train Loss: 0.181 Vali Loss: 4.688 Vali Acc: 0.806 Test Loss: 4.688 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.446683883666992
Epoch: 8, Steps: 7 | Train Loss: 0.404 Vali Loss: 2.388 Vali Acc: 0.903 Test Loss: 2.388 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.182290554046631
Epoch: 9, Steps: 7 | Train Loss: 0.312 Vali Loss: 2.132 Vali Acc: 0.861 Test Loss: 2.132 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0499699115753174
Epoch: 10, Steps: 7 | Train Loss: 0.523 Vali Loss: 2.293 Vali Acc: 0.819 Test Loss: 2.293 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.9148240089416504
Epoch: 11, Steps: 7 | Train Loss: 0.913 Vali Loss: 5.480 Vali Acc: 0.708 Test Loss: 5.480 Test Acc: 0.708
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.01627779006958
Epoch: 12, Steps: 7 | Train Loss: 0.502 Vali Loss: 4.245 Vali Acc: 0.861 Test Loss: 4.245 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.071868419647217
Epoch: 13, Steps: 7 | Train Loss: 0.312 Vali Loss: 4.849 Vali Acc: 0.819 Test Loss: 4.849 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.3179080486297607
Epoch: 14, Steps: 7 | Train Loss: 0.087 Vali Loss: 5.088 Vali Acc: 0.792 Test Loss: 5.088 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.087618350982666
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 6.112 Vali Acc: 0.792 Test Loss: 6.112 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 8696924
model size : 42.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.565341949462891
Epoch: 1, Steps: 7 | Train Loss: 2.215 Vali Loss: 0.852 Vali Acc: 0.625 Test Loss: 0.852 Test Acc: 0.625
Validation loss decreased (inf --> -0.624991).  Saving model ...
Epoch: 2 cost time: 3.2899909019470215
Epoch: 2, Steps: 7 | Train Loss: 0.195 Vali Loss: 1.088 Vali Acc: 0.833 Test Loss: 1.088 Test Acc: 0.833
Validation loss decreased (-0.624991 --> -0.833322).  Saving model ...
Epoch: 3 cost time: 2.9257445335388184
Epoch: 3, Steps: 7 | Train Loss: 0.148 Vali Loss: 1.829 Vali Acc: 0.819 Test Loss: 1.829 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.927189826965332
Epoch: 4, Steps: 7 | Train Loss: 0.205 Vali Loss: 1.327 Vali Acc: 0.931 Test Loss: 1.327 Test Acc: 0.931
Validation loss decreased (-0.833322 --> -0.930542).  Saving model ...
Epoch: 5 cost time: 3.1892831325531006
Epoch: 5, Steps: 7 | Train Loss: 0.280 Vali Loss: 0.704 Vali Acc: 0.903 Test Loss: 0.704 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.224160671234131
Epoch: 6, Steps: 7 | Train Loss: 0.014 Vali Loss: 4.308 Vali Acc: 0.819 Test Loss: 4.308 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.816056489944458
Epoch: 7, Steps: 7 | Train Loss: 0.700 Vali Loss: 3.624 Vali Acc: 0.750 Test Loss: 3.624 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.89543080329895
Epoch: 8, Steps: 7 | Train Loss: 1.517 Vali Loss: 0.814 Vali Acc: 0.903 Test Loss: 0.814 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.177600383758545
Epoch: 9, Steps: 7 | Train Loss: 0.721 Vali Loss: 1.230 Vali Acc: 0.903 Test Loss: 1.230 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.434770107269287
Epoch: 10, Steps: 7 | Train Loss: 0.428 Vali Loss: 6.075 Vali Acc: 0.792 Test Loss: 6.075 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.222410202026367
Epoch: 11, Steps: 7 | Train Loss: 0.085 Vali Loss: 1.969 Vali Acc: 0.903 Test Loss: 1.969 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.0216591358184814
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.685 Vali Acc: 0.875 Test Loss: 1.685 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.194892168045044
Epoch: 13, Steps: 7 | Train Loss: 0.440 Vali Loss: 3.847 Vali Acc: 0.861 Test Loss: 3.847 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.498143196105957
Epoch: 14, Steps: 7 | Train Loss: 0.377 Vali Loss: 2.501 Vali Acc: 0.903 Test Loss: 2.501 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 8696924
model size : 42.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.055612325668335
Epoch: 1, Steps: 7 | Train Loss: 2.174 Vali Loss: 0.913 Vali Acc: 0.625 Test Loss: 0.913 Test Acc: 0.625
Validation loss decreased (inf --> -0.624991).  Saving model ...
Epoch: 2 cost time: 2.917961835861206
Epoch: 2, Steps: 7 | Train Loss: 0.240 Vali Loss: 0.884 Vali Acc: 0.875 Test Loss: 0.884 Test Acc: 0.875
Validation loss decreased (-0.624991 --> -0.874991).  Saving model ...
Epoch: 3 cost time: 2.930568218231201
Epoch: 3, Steps: 7 | Train Loss: 0.203 Vali Loss: 1.126 Vali Acc: 0.861 Test Loss: 1.126 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0670390129089355
Epoch: 4, Steps: 7 | Train Loss: 0.532 Vali Loss: 2.355 Vali Acc: 0.833 Test Loss: 2.355 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.205573797225952
Epoch: 5, Steps: 7 | Train Loss: 0.230 Vali Loss: 2.377 Vali Acc: 0.875 Test Loss: 2.377 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.76053524017334
Epoch: 6, Steps: 7 | Train Loss: 0.078 Vali Loss: 2.010 Vali Acc: 0.861 Test Loss: 2.010 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5081112384796143
Epoch: 7, Steps: 7 | Train Loss: 0.039 Vali Loss: 1.222 Vali Acc: 0.903 Test Loss: 1.222 Test Acc: 0.903
Validation loss decreased (-0.874991 --> -0.902766).  Saving model ...
Epoch: 8 cost time: 2.640519142150879
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.675 Vali Acc: 0.903 Test Loss: 1.675 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.868457794189453
Epoch: 9, Steps: 7 | Train Loss: 0.128 Vali Loss: 1.260 Vali Acc: 0.889 Test Loss: 1.260 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.164485454559326
Epoch: 10, Steps: 7 | Train Loss: 0.014 Vali Loss: 3.605 Vali Acc: 0.819 Test Loss: 3.605 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.9900782108306885
Epoch: 11, Steps: 7 | Train Loss: 0.314 Vali Loss: 1.640 Vali Acc: 0.875 Test Loss: 1.640 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.9975080490112305
Epoch: 12, Steps: 7 | Train Loss: 0.220 Vali Loss: 1.375 Vali Acc: 0.931 Test Loss: 1.375 Test Acc: 0.931
Validation loss decreased (-0.902766 --> -0.930542).  Saving model ...
Epoch: 13 cost time: 3.0961451530456543
Epoch: 13, Steps: 7 | Train Loss: 0.016 Vali Loss: 3.496 Vali Acc: 0.778 Test Loss: 3.496 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0161969661712646
Epoch: 14, Steps: 7 | Train Loss: 0.028 Vali Loss: 1.724 Vali Acc: 0.931 Test Loss: 1.724 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.799379587173462
Epoch: 15, Steps: 7 | Train Loss: 0.098 Vali Loss: 3.007 Vali Acc: 0.875 Test Loss: 3.007 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.087979793548584
Epoch: 16, Steps: 7 | Train Loss: 1.092 Vali Loss: 4.000 Vali Acc: 0.847 Test Loss: 4.000 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.887549877166748
Epoch: 17, Steps: 7 | Train Loss: 0.640 Vali Loss: 2.149 Vali Acc: 0.889 Test Loss: 2.149 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.835275173187256
Epoch: 18, Steps: 7 | Train Loss: 0.763 Vali Loss: 4.822 Vali Acc: 0.847 Test Loss: 4.822 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.0175020694732666
Epoch: 19, Steps: 7 | Train Loss: 0.627 Vali Loss: 7.326 Vali Acc: 0.819 Test Loss: 7.326 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.5197770595550537
Epoch: 20, Steps: 7 | Train Loss: 1.128 Vali Loss: 13.440 Vali Acc: 0.764 Test Loss: 13.440 Test Acc: 0.764
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.765404462814331
Epoch: 21, Steps: 7 | Train Loss: 1.938 Vali Loss: 9.747 Vali Acc: 0.778 Test Loss: 9.747 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.8778605461120605
Epoch: 22, Steps: 7 | Train Loss: 0.536 Vali Loss: 3.297 Vali Acc: 0.861 Test Loss: 3.297 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 8696924
model size : 42.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.276535511016846
Epoch: 1, Steps: 7 | Train Loss: 2.170 Vali Loss: 0.972 Vali Acc: 0.569 Test Loss: 0.972 Test Acc: 0.569
Validation loss decreased (inf --> -0.569435).  Saving model ...
Epoch: 2 cost time: 2.7395055294036865
Epoch: 2, Steps: 7 | Train Loss: 0.358 Vali Loss: 0.772 Vali Acc: 0.861 Test Loss: 0.772 Test Acc: 0.861
Validation loss decreased (-0.569435 --> -0.861103).  Saving model ...
Epoch: 3 cost time: 2.6069302558898926
Epoch: 3, Steps: 7 | Train Loss: 0.332 Vali Loss: 0.777 Vali Acc: 0.903 Test Loss: 0.777 Test Acc: 0.903
Validation loss decreased (-0.861103 --> -0.902770).  Saving model ...
Epoch: 4 cost time: 2.532989740371704
Epoch: 4, Steps: 7 | Train Loss: 0.179 Vali Loss: 1.853 Vali Acc: 0.861 Test Loss: 1.853 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.449687957763672
Epoch: 5, Steps: 7 | Train Loss: 0.110 Vali Loss: 1.731 Vali Acc: 0.861 Test Loss: 1.731 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.875807046890259
Epoch: 6, Steps: 7 | Train Loss: 0.252 Vali Loss: 1.731 Vali Acc: 0.861 Test Loss: 1.731 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.565734624862671
Epoch: 7, Steps: 7 | Train Loss: 0.466 Vali Loss: 1.178 Vali Acc: 0.917 Test Loss: 1.178 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916655).  Saving model ...
Epoch: 8 cost time: 2.310826539993286
Epoch: 8, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.923 Vali Acc: 0.944 Test Loss: 0.923 Test Acc: 0.944
Validation loss decreased (-0.916655 --> -0.944435).  Saving model ...
Epoch: 9 cost time: 2.4230897426605225
Epoch: 9, Steps: 7 | Train Loss: 0.121 Vali Loss: 2.915 Vali Acc: 0.806 Test Loss: 2.915 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3573215007781982
Epoch: 10, Steps: 7 | Train Loss: 0.396 Vali Loss: 2.264 Vali Acc: 0.917 Test Loss: 2.264 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.779998540878296
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.875 Vali Acc: 0.931 Test Loss: 0.875 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6327803134918213
Epoch: 12, Steps: 7 | Train Loss: 0.221 Vali Loss: 0.543 Vali Acc: 0.944 Test Loss: 0.543 Test Acc: 0.944
Validation loss decreased (-0.944435 --> -0.944439).  Saving model ...
Epoch: 13 cost time: 2.6053364276885986
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.256 Vali Acc: 0.917 Test Loss: 2.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.404031753540039
Epoch: 14, Steps: 7 | Train Loss: 0.158 Vali Loss: 1.528 Vali Acc: 0.931 Test Loss: 1.528 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.9826409816741943
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.743 Vali Acc: 0.931 Test Loss: 1.743 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.97493314743042
Epoch: 16, Steps: 7 | Train Loss: 0.012 Vali Loss: 2.913 Vali Acc: 0.847 Test Loss: 2.913 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.749425172805786
Epoch: 17, Steps: 7 | Train Loss: 0.114 Vali Loss: 2.997 Vali Acc: 0.875 Test Loss: 2.997 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.699765682220459
Epoch: 18, Steps: 7 | Train Loss: 0.574 Vali Loss: 2.462 Vali Acc: 0.903 Test Loss: 2.462 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.7859272956848145
Epoch: 19, Steps: 7 | Train Loss: 0.483 Vali Loss: 2.047 Vali Acc: 0.903 Test Loss: 2.047 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.5779287815093994
Epoch: 20, Steps: 7 | Train Loss: 0.151 Vali Loss: 7.854 Vali Acc: 0.778 Test Loss: 7.854 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.4492573738098145
Epoch: 21, Steps: 7 | Train Loss: 1.038 Vali Loss: 6.896 Vali Acc: 0.833 Test Loss: 6.896 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.610332727432251
Epoch: 22, Steps: 7 | Train Loss: 0.480 Vali Loss: 7.775 Vali Acc: 0.875 Test Loss: 7.775 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 8696924
model size : 42.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.430991888046265
Epoch: 1, Steps: 7 | Train Loss: 2.228 Vali Loss: 1.315 Vali Acc: 0.653 Test Loss: 1.315 Test Acc: 0.653
Validation loss decreased (inf --> -0.652765).  Saving model ...
Epoch: 2 cost time: 3.630464792251587
Epoch: 2, Steps: 7 | Train Loss: 0.404 Vali Loss: 1.382 Vali Acc: 0.861 Test Loss: 1.382 Test Acc: 0.861
Validation loss decreased (-0.652765 --> -0.861097).  Saving model ...
Epoch: 3 cost time: 3.8577983379364014
Epoch: 3, Steps: 7 | Train Loss: 0.146 Vali Loss: 1.466 Vali Acc: 0.875 Test Loss: 1.466 Test Acc: 0.875
Validation loss decreased (-0.861097 --> -0.874985).  Saving model ...
Epoch: 4 cost time: 3.602126359939575
Epoch: 4, Steps: 7 | Train Loss: 0.175 Vali Loss: 1.008 Vali Acc: 0.889 Test Loss: 1.008 Test Acc: 0.889
Validation loss decreased (-0.874985 --> -0.888879).  Saving model ...
Epoch: 5 cost time: 3.473179340362549
Epoch: 5, Steps: 7 | Train Loss: 0.085 Vali Loss: 1.630 Vali Acc: 0.875 Test Loss: 1.630 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.450812578201294
Epoch: 6, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.976 Vali Acc: 0.931 Test Loss: 0.976 Test Acc: 0.931
Validation loss decreased (-0.888879 --> -0.930546).  Saving model ...
Epoch: 7 cost time: 3.4959840774536133
Epoch: 7, Steps: 7 | Train Loss: 0.062 Vali Loss: 2.722 Vali Acc: 0.861 Test Loss: 2.722 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.233870267868042
Epoch: 8, Steps: 7 | Train Loss: 0.273 Vali Loss: 0.809 Vali Acc: 0.931 Test Loss: 0.809 Test Acc: 0.931
Validation loss decreased (-0.930546 --> -0.930547).  Saving model ...
Epoch: 9 cost time: 3.3180527687072754
Epoch: 9, Steps: 7 | Train Loss: 0.119 Vali Loss: 2.643 Vali Acc: 0.847 Test Loss: 2.643 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4477710723876953
Epoch: 10, Steps: 7 | Train Loss: 0.220 Vali Loss: 5.518 Vali Acc: 0.861 Test Loss: 5.518 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.517958641052246
Epoch: 11, Steps: 7 | Train Loss: 0.914 Vali Loss: 9.339 Vali Acc: 0.750 Test Loss: 9.339 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0128729343414307
Epoch: 12, Steps: 7 | Train Loss: 0.120 Vali Loss: 8.352 Vali Acc: 0.708 Test Loss: 8.352 Test Acc: 0.708
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7698075771331787
Epoch: 13, Steps: 7 | Train Loss: 0.493 Vali Loss: 3.144 Vali Acc: 0.819 Test Loss: 3.144 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.173149585723877
Epoch: 14, Steps: 7 | Train Loss: 0.230 Vali Loss: 10.351 Vali Acc: 0.847 Test Loss: 10.351 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.550523281097412
Epoch: 15, Steps: 7 | Train Loss: 2.143 Vali Loss: 3.513 Vali Acc: 0.833 Test Loss: 3.513 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.5019259452819824
Epoch: 16, Steps: 7 | Train Loss: 1.036 Vali Loss: 5.129 Vali Acc: 0.903 Test Loss: 5.129 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.317601442337036
Epoch: 17, Steps: 7 | Train Loss: 0.116 Vali Loss: 2.604 Vali Acc: 0.917 Test Loss: 2.604 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.3839690685272217
Epoch: 18, Steps: 7 | Train Loss: 1.425 Vali Loss: 4.401 Vali Acc: 0.861 Test Loss: 4.401 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 8565852
model size : 42.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.729523420333862
Epoch: 1, Steps: 7 | Train Loss: 2.186 Vali Loss: 1.280 Vali Acc: 0.625 Test Loss: 1.280 Test Acc: 0.625
Validation loss decreased (inf --> -0.624987).  Saving model ...
Epoch: 2 cost time: 3.3347325325012207
Epoch: 2, Steps: 7 | Train Loss: 0.367 Vali Loss: 1.320 Vali Acc: 0.847 Test Loss: 1.320 Test Acc: 0.847
Validation loss decreased (-0.624987 --> -0.847209).  Saving model ...
Epoch: 3 cost time: 3.2178752422332764
Epoch: 3, Steps: 7 | Train Loss: 0.164 Vali Loss: 1.255 Vali Acc: 0.833 Test Loss: 1.255 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.053284168243408
Epoch: 4, Steps: 7 | Train Loss: 0.093 Vali Loss: 1.269 Vali Acc: 0.861 Test Loss: 1.269 Test Acc: 0.861
Validation loss decreased (-0.847209 --> -0.861098).  Saving model ...
Epoch: 5 cost time: 3.0573229789733887
Epoch: 5, Steps: 7 | Train Loss: 0.180 Vali Loss: 2.665 Vali Acc: 0.875 Test Loss: 2.665 Test Acc: 0.875
Validation loss decreased (-0.861098 --> -0.874973).  Saving model ...
Epoch: 6 cost time: 2.9620962142944336
Epoch: 6, Steps: 7 | Train Loss: 0.545 Vali Loss: 1.733 Vali Acc: 0.903 Test Loss: 1.733 Test Acc: 0.903
Validation loss decreased (-0.874973 --> -0.902760).  Saving model ...
Epoch: 7 cost time: 2.939176321029663
Epoch: 7, Steps: 7 | Train Loss: 0.307 Vali Loss: 0.414 Vali Acc: 0.944 Test Loss: 0.414 Test Acc: 0.944
Validation loss decreased (-0.902760 --> -0.944440).  Saving model ...
Epoch: 8 cost time: 3.4685754776000977
Epoch: 8, Steps: 7 | Train Loss: 0.204 Vali Loss: 1.306 Vali Acc: 0.875 Test Loss: 1.306 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.422559976577759
Epoch: 9, Steps: 7 | Train Loss: 0.132 Vali Loss: 6.221 Vali Acc: 0.736 Test Loss: 6.221 Test Acc: 0.736
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.707754611968994
Epoch: 10, Steps: 7 | Train Loss: 1.063 Vali Loss: 2.287 Vali Acc: 0.889 Test Loss: 2.287 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.3621833324432373
Epoch: 11, Steps: 7 | Train Loss: 0.445 Vali Loss: 3.939 Vali Acc: 0.833 Test Loss: 3.939 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.4575605392456055
Epoch: 12, Steps: 7 | Train Loss: 0.431 Vali Loss: 5.810 Vali Acc: 0.764 Test Loss: 5.810 Test Acc: 0.764
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.4797844886779785
Epoch: 13, Steps: 7 | Train Loss: 0.164 Vali Loss: 2.964 Vali Acc: 0.889 Test Loss: 2.964 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.5849530696868896
Epoch: 14, Steps: 7 | Train Loss: 0.642 Vali Loss: 4.132 Vali Acc: 0.875 Test Loss: 4.132 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.184321165084839
Epoch: 15, Steps: 7 | Train Loss: 0.377 Vali Loss: 2.653 Vali Acc: 0.917 Test Loss: 2.653 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.1822052001953125
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 4.164 Vali Acc: 0.875 Test Loss: 4.164 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.434882879257202
Epoch: 17, Steps: 7 | Train Loss: 0.952 Vali Loss: 3.147 Vali Acc: 0.875 Test Loss: 3.147 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 8565852
model size : 42.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.477277755737305
Epoch: 1, Steps: 7 | Train Loss: 2.174 Vali Loss: 1.218 Vali Acc: 0.625 Test Loss: 1.218 Test Acc: 0.625
Validation loss decreased (inf --> -0.624988).  Saving model ...
Epoch: 2 cost time: 2.383409261703491
Epoch: 2, Steps: 7 | Train Loss: 0.370 Vali Loss: 1.709 Vali Acc: 0.792 Test Loss: 1.709 Test Acc: 0.792
Validation loss decreased (-0.624988 --> -0.791650).  Saving model ...
Epoch: 3 cost time: 2.4727838039398193
Epoch: 3, Steps: 7 | Train Loss: 0.194 Vali Loss: 0.741 Vali Acc: 0.875 Test Loss: 0.741 Test Acc: 0.875
Validation loss decreased (-0.791650 --> -0.874993).  Saving model ...
Epoch: 4 cost time: 2.966552257537842
Epoch: 4, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.836 Vali Acc: 0.875 Test Loss: 0.836 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9546189308166504
Epoch: 5, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.801 Vali Acc: 0.903 Test Loss: 0.801 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902770).  Saving model ...
Epoch: 6 cost time: 2.6970643997192383
Epoch: 6, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.828 Vali Acc: 0.917 Test Loss: 0.828 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916658).  Saving model ...
Epoch: 7 cost time: 2.7644100189208984
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.897 Vali Acc: 0.917 Test Loss: 0.897 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8485350608825684
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.917 Test Loss: 1.019 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.854989528656006
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.145 Vali Acc: 0.917 Test Loss: 1.145 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.993546485900879
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.888 Vali Acc: 0.917 Test Loss: 0.888 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6153290271759033
Epoch: 11, Steps: 7 | Train Loss: 0.703 Vali Loss: 1.425 Vali Acc: 0.889 Test Loss: 1.425 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.760190963745117
Epoch: 12, Steps: 7 | Train Loss: 0.277 Vali Loss: 1.773 Vali Acc: 0.833 Test Loss: 1.773 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.90865421295166
Epoch: 13, Steps: 7 | Train Loss: 0.205 Vali Loss: 2.695 Vali Acc: 0.819 Test Loss: 2.695 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.902588129043579
Epoch: 14, Steps: 7 | Train Loss: 0.574 Vali Loss: 4.056 Vali Acc: 0.875 Test Loss: 4.056 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.3913323879241943
Epoch: 15, Steps: 7 | Train Loss: 1.079 Vali Loss: 4.610 Vali Acc: 0.819 Test Loss: 4.610 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.4387967586517334
Epoch: 16, Steps: 7 | Train Loss: 1.746 Vali Loss: 6.955 Vali Acc: 0.806 Test Loss: 6.955 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 8565852
model size : 42.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.385882139205933
Epoch: 1, Steps: 7 | Train Loss: 2.148 Vali Loss: 1.178 Vali Acc: 0.639 Test Loss: 1.178 Test Acc: 0.639
Validation loss decreased (inf --> -0.638877).  Saving model ...
Epoch: 2 cost time: 2.5320398807525635
Epoch: 2, Steps: 7 | Train Loss: 0.490 Vali Loss: 1.555 Vali Acc: 0.778 Test Loss: 1.555 Test Acc: 0.778
Validation loss decreased (-0.638877 --> -0.777762).  Saving model ...
Epoch: 3 cost time: 2.7002196311950684
Epoch: 3, Steps: 7 | Train Loss: 0.576 Vali Loss: 0.666 Vali Acc: 0.889 Test Loss: 0.666 Test Acc: 0.889
Validation loss decreased (-0.777762 --> -0.888882).  Saving model ...
Epoch: 4 cost time: 2.409601926803589
Epoch: 4, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.969 Vali Acc: 0.861 Test Loss: 0.969 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4853615760803223
Epoch: 5, Steps: 7 | Train Loss: 0.402 Vali Loss: 2.132 Vali Acc: 0.861 Test Loss: 2.132 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6707444190979004
Epoch: 6, Steps: 7 | Train Loss: 0.253 Vali Loss: 1.868 Vali Acc: 0.889 Test Loss: 1.868 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.765263557434082
Epoch: 7, Steps: 7 | Train Loss: 0.084 Vali Loss: 2.297 Vali Acc: 0.889 Test Loss: 2.297 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4380688667297363
Epoch: 8, Steps: 7 | Train Loss: 0.237 Vali Loss: 2.239 Vali Acc: 0.861 Test Loss: 2.239 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.236562490463257
Epoch: 9, Steps: 7 | Train Loss: 0.779 Vali Loss: 1.295 Vali Acc: 0.903 Test Loss: 1.295 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902765).  Saving model ...
Epoch: 10 cost time: 2.7072532176971436
Epoch: 10, Steps: 7 | Train Loss: 0.247 Vali Loss: 3.939 Vali Acc: 0.847 Test Loss: 3.939 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.817516326904297
Epoch: 11, Steps: 7 | Train Loss: 0.139 Vali Loss: 1.805 Vali Acc: 0.903 Test Loss: 1.805 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.545487642288208
Epoch: 12, Steps: 7 | Train Loss: 0.410 Vali Loss: 2.688 Vali Acc: 0.917 Test Loss: 2.688 Test Acc: 0.917
Validation loss decreased (-0.902765 --> -0.916640).  Saving model ...
Epoch: 13 cost time: 2.629694938659668
Epoch: 13, Steps: 7 | Train Loss: 0.036 Vali Loss: 2.012 Vali Acc: 0.875 Test Loss: 2.012 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.556746006011963
Epoch: 14, Steps: 7 | Train Loss: 0.916 Vali Loss: 1.982 Vali Acc: 0.903 Test Loss: 1.982 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.741053342819214
Epoch: 15, Steps: 7 | Train Loss: 1.483 Vali Loss: 4.042 Vali Acc: 0.764 Test Loss: 4.042 Test Acc: 0.764
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9331130981445312
Epoch: 16, Steps: 7 | Train Loss: 0.315 Vali Loss: 3.851 Vali Acc: 0.819 Test Loss: 3.851 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.574861764907837
Epoch: 17, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.727 Vali Acc: 0.931 Test Loss: 0.727 Test Acc: 0.931
Validation loss decreased (-0.916640 --> -0.930548).  Saving model ...
Epoch: 18 cost time: 2.80060076713562
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.025 Vali Acc: 0.889 Test Loss: 1.025 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7858641147613525
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.745 Vali Acc: 0.875 Test Loss: 1.745 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.0031168460845947
Epoch: 20, Steps: 7 | Train Loss: 0.014 Vali Loss: 1.815 Vali Acc: 0.875 Test Loss: 1.815 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.654951810836792
Epoch: 21, Steps: 7 | Train Loss: 0.165 Vali Loss: 1.883 Vali Acc: 0.847 Test Loss: 1.883 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.68576717376709
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.056 Vali Acc: 0.861 Test Loss: 2.056 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.715045928955078
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.590 Vali Acc: 0.847 Test Loss: 2.590 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.9654617309570312
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.878 Vali Acc: 0.833 Test Loss: 2.878 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.7351291179656982
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.016 Vali Acc: 0.847 Test Loss: 3.016 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.6354641914367676
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.051 Vali Acc: 0.847 Test Loss: 3.051 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.9867329597473145
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.053 Vali Acc: 0.847 Test Loss: 3.053 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 8565852
model size : 42.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.554648399353027
Epoch: 1, Steps: 7 | Train Loss: 2.384 Vali Loss: 0.860 Vali Acc: 0.806 Test Loss: 0.860 Test Acc: 0.806
Validation loss decreased (inf --> -0.805547).  Saving model ...
Epoch: 2 cost time: 1.7939066886901855
Epoch: 2, Steps: 7 | Train Loss: 0.247 Vali Loss: 0.604 Vali Acc: 0.875 Test Loss: 0.604 Test Acc: 0.875
Validation loss decreased (-0.805547 --> -0.874994).  Saving model ...
Epoch: 3 cost time: 1.904146671295166
Epoch: 3, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.345 Vali Acc: 0.917 Test Loss: 0.345 Test Acc: 0.917
Validation loss decreased (-0.874994 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 1.9584379196166992
Epoch: 4, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.682 Vali Acc: 0.903 Test Loss: 0.682 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7986199855804443
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.931 Test Loss: 0.662 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930549).  Saving model ...
Epoch: 6 cost time: 2.173673391342163
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.917 Test Loss: 0.568 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2508397102355957
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.931 Test Loss: 0.594 Test Acc: 0.931
Validation loss decreased (-0.930549 --> -0.930550).  Saving model ...
Epoch: 8 cost time: 2.395460844039917
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.931 Test Loss: 0.630 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4346842765808105
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.931 Test Loss: 0.654 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.29757022857666
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.917 Test Loss: 0.667 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.284104824066162
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.917 Test Loss: 0.674 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.319845199584961
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.917 Test Loss: 0.676 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6156482696533203
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.917 Test Loss: 0.676 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3111536502838135
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.917 Test Loss: 0.675 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0802412033081055
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.917 Test Loss: 0.673 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.104710102081299
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.917 Test Loss: 0.672 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.269378662109375
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.917 Test Loss: 0.670 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 6052444
model size : 27.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.093580484390259
Epoch: 1, Steps: 7 | Train Loss: 2.366 Vali Loss: 0.825 Vali Acc: 0.833 Test Loss: 0.825 Test Acc: 0.833
Validation loss decreased (inf --> -0.833325).  Saving model ...
Epoch: 2 cost time: 2.211740493774414
Epoch: 2, Steps: 7 | Train Loss: 0.248 Vali Loss: 0.568 Vali Acc: 0.875 Test Loss: 0.568 Test Acc: 0.875
Validation loss decreased (-0.833325 --> -0.874994).  Saving model ...
Epoch: 3 cost time: 2.117814540863037
Epoch: 3, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
Validation loss decreased (-0.874994 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 2.254470109939575
Epoch: 4, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.736 Vali Acc: 0.917 Test Loss: 0.736 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916659).  Saving model ...
Epoch: 5 cost time: 2.1447558403015137
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.370 Vali Acc: 0.931 Test Loss: 0.370 Test Acc: 0.931
Validation loss decreased (-0.916659 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 2.301363945007324
Epoch: 6, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.064 Vali Acc: 0.958 Test Loss: 0.064 Test Acc: 0.958
Validation loss decreased (-0.930552 --> -0.958333).  Saving model ...
Epoch: 7 cost time: 2.167609691619873
Epoch: 7, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.055 Vali Acc: 0.958 Test Loss: 0.055 Test Acc: 0.958
Validation loss decreased (-0.958333 --> -0.958333).  Saving model ...
Epoch: 8 cost time: 1.8557424545288086
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.958 Test Loss: 0.075 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.190599203109741
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.126 Vali Acc: 0.931 Test Loss: 0.126 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.225778818130493
Epoch: 10, Steps: 7 | Train Loss: 0.214 Vali Loss: 0.062 Vali Acc: 0.958 Test Loss: 0.062 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1523382663726807
Epoch: 11, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.289958953857422
Epoch: 12, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.2617099285125732
Epoch: 13, Steps: 7 | Train Loss: 0.149 Vali Loss: 1.556 Vali Acc: 0.889 Test Loss: 1.556 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.1280746459960938
Epoch: 14, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.564 Vali Acc: 0.931 Test Loss: 0.564 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.6633899211883545
Epoch: 15, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.677 Vali Acc: 0.847 Test Loss: 0.677 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.237887144088745
Epoch: 16, Steps: 7 | Train Loss: 0.118 Vali Loss: 0.923 Vali Acc: 0.889 Test Loss: 0.923 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.4195716381073
Epoch: 17, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.650 Vali Acc: 0.875 Test Loss: 0.650 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 6052444
model size : 27.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.179274559020996
Epoch: 1, Steps: 7 | Train Loss: 2.362 Vali Loss: 0.853 Vali Acc: 0.764 Test Loss: 0.853 Test Acc: 0.764
Validation loss decreased (inf --> -0.763880).  Saving model ...
Epoch: 2 cost time: 2.2014238834381104
Epoch: 2, Steps: 7 | Train Loss: 0.256 Vali Loss: 0.480 Vali Acc: 0.861 Test Loss: 0.480 Test Acc: 0.861
Validation loss decreased (-0.763880 --> -0.861106).  Saving model ...
Epoch: 3 cost time: 2.2713286876678467
Epoch: 3, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
Validation loss decreased (-0.861106 --> -0.930553).  Saving model ...
Epoch: 4 cost time: 2.293835163116455
Epoch: 4, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.510 Vali Acc: 0.903 Test Loss: 0.510 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.191049098968506
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.351 Vali Acc: 0.958 Test Loss: 0.351 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958330).  Saving model ...
Epoch: 6 cost time: 2.162245512008667
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.958 Test Loss: 0.282 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 7 cost time: 2.2604377269744873
Epoch: 7, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.268 Vali Acc: 0.958 Test Loss: 0.268 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 8 cost time: 2.413437604904175
Epoch: 8, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.297 Vali Acc: 0.958 Test Loss: 0.297 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2129178047180176
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.972 Test Loss: 0.264 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 10 cost time: 2.0208935737609863
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.972 Test Loss: 0.267 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9820313453674316
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.958 Test Loss: 0.269 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.065916061401367
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.972 Test Loss: 0.263 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 1.9454023838043213
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.972 Test Loss: 0.263 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.115574359893799
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.972 Test Loss: 0.260 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 15 cost time: 2.200068235397339
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.972 Test Loss: 0.259 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 16 cost time: 2.230940818786621
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.972 Test Loss: 0.261 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1124701499938965
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.958 Test Loss: 0.261 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.205385684967041
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.958 Test Loss: 0.262 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2028143405914307
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.958 Test Loss: 0.264 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1557085514068604
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.958 Test Loss: 0.262 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.090228796005249
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.958 Test Loss: 0.261 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9617483615875244
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.958 Test Loss: 0.260 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.1862101554870605
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.958 Test Loss: 0.260 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.2810635566711426
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.958 Test Loss: 0.259 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.121938943862915
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.958 Test Loss: 0.258 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 6052444
model size : 27.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6381614208221436
Epoch: 1, Steps: 7 | Train Loss: 2.401 Vali Loss: 0.894 Vali Acc: 0.764 Test Loss: 0.894 Test Acc: 0.764
Validation loss decreased (inf --> -0.763880).  Saving model ...
Epoch: 2 cost time: 1.9817399978637695
Epoch: 2, Steps: 7 | Train Loss: 0.295 Vali Loss: 0.350 Vali Acc: 0.861 Test Loss: 0.350 Test Acc: 0.861
Validation loss decreased (-0.763880 --> -0.861108).  Saving model ...
Epoch: 3 cost time: 1.9949960708618164
Epoch: 3, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.446 Vali Acc: 0.917 Test Loss: 0.446 Test Acc: 0.917
Validation loss decreased (-0.861108 --> -0.916662).  Saving model ...
Epoch: 4 cost time: 2.1767196655273438
Epoch: 4, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.843 Vali Acc: 0.875 Test Loss: 0.843 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8662135601043701
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.931 Test Loss: 0.540 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930550).  Saving model ...
Epoch: 6 cost time: 1.6212072372436523
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.917 Test Loss: 0.465 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7529246807098389
Epoch: 7, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.403 Vali Acc: 0.917 Test Loss: 0.403 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.945826530456543
Epoch: 8, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.401 Vali Acc: 0.931 Test Loss: 0.401 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 1.6947972774505615
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.972 Test Loss: 0.246 Test Acc: 0.972
Validation loss decreased (-0.930552 --> -0.972220).  Saving model ...
Epoch: 10 cost time: 1.769622802734375
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.730 Vali Acc: 0.903 Test Loss: 0.730 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7956757545471191
Epoch: 11, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.649 Vali Acc: 0.944 Test Loss: 0.649 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1790897846221924
Epoch: 12, Steps: 7 | Train Loss: 0.261 Vali Loss: 0.307 Vali Acc: 0.944 Test Loss: 0.307 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2207508087158203
Epoch: 13, Steps: 7 | Train Loss: 0.385 Vali Loss: 0.217 Vali Acc: 0.972 Test Loss: 0.217 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 14 cost time: 2.29526948928833
Epoch: 14, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.688 Vali Acc: 0.944 Test Loss: 0.688 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0947611331939697
Epoch: 15, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.708 Vali Acc: 0.931 Test Loss: 0.708 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8626375198364258
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.944 Test Loss: 0.416 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1983377933502197
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.917 Test Loss: 0.426 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2474231719970703
Epoch: 18, Steps: 7 | Train Loss: 0.017 Vali Loss: 1.460 Vali Acc: 0.903 Test Loss: 1.460 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.1489291191101074
Epoch: 19, Steps: 7 | Train Loss: 0.090 Vali Loss: 3.089 Vali Acc: 0.903 Test Loss: 3.089 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.861168622970581
Epoch: 20, Steps: 7 | Train Loss: 0.449 Vali Loss: 3.595 Vali Acc: 0.819 Test Loss: 3.595 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9815967082977295
Epoch: 21, Steps: 7 | Train Loss: 0.253 Vali Loss: 4.222 Vali Acc: 0.819 Test Loss: 4.222 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.9382293224334717
Epoch: 22, Steps: 7 | Train Loss: 0.311 Vali Loss: 6.780 Vali Acc: 0.750 Test Loss: 6.780 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1185951232910156
Epoch: 23, Steps: 7 | Train Loss: 1.516 Vali Loss: 2.831 Vali Acc: 0.889 Test Loss: 2.831 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 6052444
model size : 27.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.166982650756836
Epoch: 1, Steps: 7 | Train Loss: 2.326 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
Validation loss decreased (inf --> -0.749992).  Saving model ...
Epoch: 2 cost time: 2.48248291015625
Epoch: 2, Steps: 7 | Train Loss: 0.266 Vali Loss: 0.633 Vali Acc: 0.819 Test Loss: 0.633 Test Acc: 0.819
Validation loss decreased (-0.749992 --> -0.819438).  Saving model ...
Epoch: 3 cost time: 2.5486016273498535
Epoch: 3, Steps: 7 | Train Loss: 0.048 Vali Loss: 1.187 Vali Acc: 0.875 Test Loss: 1.187 Test Acc: 0.875
Validation loss decreased (-0.819438 --> -0.874988).  Saving model ...
Epoch: 4 cost time: 2.5543107986450195
Epoch: 4, Steps: 7 | Train Loss: 0.089 Vali Loss: 1.551 Vali Acc: 0.833 Test Loss: 1.551 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2714498043060303
Epoch: 5, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.724 Vali Acc: 0.931 Test Loss: 0.724 Test Acc: 0.931
Validation loss decreased (-0.874988 --> -0.930548).  Saving model ...
Epoch: 6 cost time: 2.30058217048645
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.050 Vali Acc: 0.889 Test Loss: 1.050 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1276090145111084
Epoch: 7, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.570 Vali Acc: 0.958 Test Loss: 0.570 Test Acc: 0.958
Validation loss decreased (-0.930548 --> -0.958328).  Saving model ...
Epoch: 8 cost time: 2.3768956661224365
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.854 Vali Acc: 0.917 Test Loss: 0.854 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1460721492767334
Epoch: 9, Steps: 7 | Train Loss: 0.136 Vali Loss: 2.783 Vali Acc: 0.833 Test Loss: 2.783 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5606608390808105
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.933 Vali Acc: 0.931 Test Loss: 0.933 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4997217655181885
Epoch: 11, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.839 Vali Acc: 0.917 Test Loss: 0.839 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5085644721984863
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.861 Test Loss: 1.454 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.51940655708313
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.401 Vali Acc: 0.861 Test Loss: 1.401 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.267864227294922
Epoch: 14, Steps: 7 | Train Loss: 0.061 Vali Loss: 1.705 Vali Acc: 0.875 Test Loss: 1.705 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.544281482696533
Epoch: 15, Steps: 7 | Train Loss: 0.073 Vali Loss: 2.372 Vali Acc: 0.833 Test Loss: 2.372 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4064788818359375
Epoch: 16, Steps: 7 | Train Loss: 0.164 Vali Loss: 5.041 Vali Acc: 0.764 Test Loss: 5.041 Test Acc: 0.764
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.49273419380188
Epoch: 17, Steps: 7 | Train Loss: 0.167 Vali Loss: 4.706 Vali Acc: 0.778 Test Loss: 4.706 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 5003868
model size : 23.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.121044635772705
Epoch: 1, Steps: 7 | Train Loss: 2.308 Vali Loss: 0.858 Vali Acc: 0.736 Test Loss: 0.858 Test Acc: 0.736
Validation loss decreased (inf --> -0.736103).  Saving model ...
Epoch: 2 cost time: 2.1718666553497314
Epoch: 2, Steps: 7 | Train Loss: 0.264 Vali Loss: 0.597 Vali Acc: 0.833 Test Loss: 0.597 Test Acc: 0.833
Validation loss decreased (-0.736103 --> -0.833327).  Saving model ...
Epoch: 3 cost time: 2.2220494747161865
Epoch: 3, Steps: 7 | Train Loss: 0.059 Vali Loss: 1.289 Vali Acc: 0.861 Test Loss: 1.289 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861098).  Saving model ...
Epoch: 4 cost time: 2.1359317302703857
Epoch: 4, Steps: 7 | Train Loss: 0.073 Vali Loss: 1.257 Vali Acc: 0.833 Test Loss: 1.257 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0510036945343018
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.905 Vali Acc: 0.861 Test Loss: 0.905 Test Acc: 0.861
Validation loss decreased (-0.861098 --> -0.861102).  Saving model ...
Epoch: 6 cost time: 1.9068591594696045
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.982 Vali Acc: 0.833 Test Loss: 1.982 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0475339889526367
Epoch: 7, Steps: 7 | Train Loss: 0.047 Vali Loss: 1.881 Vali Acc: 0.847 Test Loss: 1.881 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0982227325439453
Epoch: 8, Steps: 7 | Train Loss: 0.183 Vali Loss: 2.467 Vali Acc: 0.806 Test Loss: 2.467 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1185989379882812
Epoch: 9, Steps: 7 | Train Loss: 0.027 Vali Loss: 2.146 Vali Acc: 0.819 Test Loss: 2.146 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.070363759994507
Epoch: 10, Steps: 7 | Train Loss: 0.165 Vali Loss: 1.556 Vali Acc: 0.875 Test Loss: 1.556 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874984).  Saving model ...
Epoch: 11 cost time: 1.8347105979919434
Epoch: 11, Steps: 7 | Train Loss: 0.112 Vali Loss: 1.253 Vali Acc: 0.861 Test Loss: 1.253 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.300708293914795
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.296 Vali Acc: 0.931 Test Loss: 0.296 Test Acc: 0.931
Validation loss decreased (-0.874984 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 2.362522602081299
Epoch: 13, Steps: 7 | Train Loss: 0.101 Vali Loss: 1.539 Vali Acc: 0.903 Test Loss: 1.539 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3107926845550537
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 4.207 Vali Acc: 0.833 Test Loss: 4.207 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.190608263015747
Epoch: 15, Steps: 7 | Train Loss: 0.121 Vali Loss: 1.981 Vali Acc: 0.917 Test Loss: 1.981 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.143017530441284
Epoch: 16, Steps: 7 | Train Loss: 0.494 Vali Loss: 2.280 Vali Acc: 0.875 Test Loss: 2.280 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.145185708999634
Epoch: 17, Steps: 7 | Train Loss: 0.203 Vali Loss: 3.030 Vali Acc: 0.861 Test Loss: 3.030 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.3520667552948
Epoch: 18, Steps: 7 | Train Loss: 0.192 Vali Loss: 1.104 Vali Acc: 0.917 Test Loss: 1.104 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.3718671798706055
Epoch: 19, Steps: 7 | Train Loss: 0.291 Vali Loss: 4.579 Vali Acc: 0.750 Test Loss: 4.579 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.4676120281219482
Epoch: 20, Steps: 7 | Train Loss: 0.205 Vali Loss: 1.473 Vali Acc: 0.931 Test Loss: 1.473 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.189032554626465
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.538 Vali Acc: 0.889 Test Loss: 2.538 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.1161320209503174
Epoch: 22, Steps: 7 | Train Loss: 0.295 Vali Loss: 3.599 Vali Acc: 0.903 Test Loss: 3.599 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 5003868
model size : 23.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7362470626831055
Epoch: 1, Steps: 7 | Train Loss: 2.266 Vali Loss: 0.867 Vali Acc: 0.736 Test Loss: 0.867 Test Acc: 0.736
Validation loss decreased (inf --> -0.736102).  Saving model ...
Epoch: 2 cost time: 2.0521607398986816
Epoch: 2, Steps: 7 | Train Loss: 0.284 Vali Loss: 0.583 Vali Acc: 0.833 Test Loss: 0.583 Test Acc: 0.833
Validation loss decreased (-0.736102 --> -0.833328).  Saving model ...
Epoch: 3 cost time: 1.7823505401611328
Epoch: 3, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.821 Vali Acc: 0.833 Test Loss: 0.821 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7978870868682861
Epoch: 4, Steps: 7 | Train Loss: 0.081 Vali Loss: 1.374 Vali Acc: 0.833 Test Loss: 1.374 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.028477668762207
Epoch: 5, Steps: 7 | Train Loss: 0.038 Vali Loss: 1.020 Vali Acc: 0.861 Test Loss: 1.020 Test Acc: 0.861
Validation loss decreased (-0.833328 --> -0.861101).  Saving model ...
Epoch: 6 cost time: 2.0205321311950684
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.941 Vali Acc: 0.875 Test Loss: 0.941 Test Acc: 0.875
Validation loss decreased (-0.861101 --> -0.874991).  Saving model ...
Epoch: 7 cost time: 1.9409332275390625
Epoch: 7, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.516 Vali Acc: 0.931 Test Loss: 0.516 Test Acc: 0.931
Validation loss decreased (-0.874991 --> -0.930550).  Saving model ...
Epoch: 8 cost time: 1.8266644477844238
Epoch: 8, Steps: 7 | Train Loss: 0.048 Vali Loss: 1.330 Vali Acc: 0.833 Test Loss: 1.330 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.070018768310547
Epoch: 9, Steps: 7 | Train Loss: 0.026 Vali Loss: 3.497 Vali Acc: 0.750 Test Loss: 3.497 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8923497200012207
Epoch: 10, Steps: 7 | Train Loss: 0.108 Vali Loss: 0.845 Vali Acc: 0.889 Test Loss: 0.845 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1184983253479004
Epoch: 11, Steps: 7 | Train Loss: 0.094 Vali Loss: 1.076 Vali Acc: 0.889 Test Loss: 1.076 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.074533224105835
Epoch: 12, Steps: 7 | Train Loss: 0.025 Vali Loss: 2.421 Vali Acc: 0.847 Test Loss: 2.421 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9722373485565186
Epoch: 13, Steps: 7 | Train Loss: 0.037 Vali Loss: 1.428 Vali Acc: 0.875 Test Loss: 1.428 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9599559307098389
Epoch: 14, Steps: 7 | Train Loss: 0.030 Vali Loss: 1.263 Vali Acc: 0.917 Test Loss: 1.263 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8305819034576416
Epoch: 15, Steps: 7 | Train Loss: 0.086 Vali Loss: 2.516 Vali Acc: 0.792 Test Loss: 2.516 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9435324668884277
Epoch: 16, Steps: 7 | Train Loss: 0.066 Vali Loss: 1.707 Vali Acc: 0.917 Test Loss: 1.707 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9915225505828857
Epoch: 17, Steps: 7 | Train Loss: 0.039 Vali Loss: 2.587 Vali Acc: 0.917 Test Loss: 2.587 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 5003868
model size : 23.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.650019884109497
Epoch: 1, Steps: 7 | Train Loss: 2.250 Vali Loss: 0.898 Vali Acc: 0.694 Test Loss: 0.898 Test Acc: 0.694
Validation loss decreased (inf --> -0.694435).  Saving model ...
Epoch: 2 cost time: 1.8970718383789062
Epoch: 2, Steps: 7 | Train Loss: 0.345 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
Validation loss decreased (-0.694435 --> -0.888885).  Saving model ...
Epoch: 3 cost time: 1.8660669326782227
Epoch: 3, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.615126371383667
Epoch: 4, Steps: 7 | Train Loss: 0.012 Vali Loss: 1.432 Vali Acc: 0.875 Test Loss: 1.432 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6373035907745361
Epoch: 5, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.649 Vali Acc: 0.917 Test Loss: 0.649 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916660).  Saving model ...
Epoch: 6 cost time: 1.620497703552246
Epoch: 6, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.628 Vali Acc: 0.931 Test Loss: 0.628 Test Acc: 0.931
Validation loss decreased (-0.916660 --> -0.930549).  Saving model ...
Epoch: 7 cost time: 1.7778229713439941
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.681 Vali Acc: 0.903 Test Loss: 0.681 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8378124237060547
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.917 Test Loss: 0.667 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8446016311645508
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.917 Test Loss: 0.670 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7673430442810059
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.931 Test Loss: 0.682 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8696253299713135
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.931 Test Loss: 0.686 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8974289894104004
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.931 Test Loss: 0.685 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7934722900390625
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.931 Test Loss: 0.681 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8704326152801514
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.931 Test Loss: 0.678 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8804659843444824
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.931 Test Loss: 0.675 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9415531158447266
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.931 Test Loss: 0.674 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 5003868
model size : 23.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.4714860916137695
Epoch: 1, Steps: 7 | Train Loss: 2.304 Vali Loss: 0.744 Vali Acc: 0.819 Test Loss: 0.744 Test Acc: 0.819
Validation loss decreased (inf --> -0.819437).  Saving model ...
Epoch: 2 cost time: 2.2468748092651367
Epoch: 2, Steps: 7 | Train Loss: 0.228 Vali Loss: 0.781 Vali Acc: 0.778 Test Loss: 0.781 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2389533519744873
Epoch: 3, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.944 Vali Acc: 0.903 Test Loss: 0.944 Test Acc: 0.903
Validation loss decreased (-0.819437 --> -0.902768).  Saving model ...
Epoch: 4 cost time: 2.2096400260925293
Epoch: 4, Steps: 7 | Train Loss: 0.075 Vali Loss: 1.360 Vali Acc: 0.875 Test Loss: 1.360 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.078672170639038
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.558 Vali Acc: 0.903 Test Loss: 0.558 Test Acc: 0.903
Validation loss decreased (-0.902768 --> -0.902772).  Saving model ...
Epoch: 6 cost time: 2.5408077239990234
Epoch: 6, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 2.405517816543579
Epoch: 7, Steps: 7 | Train Loss: 0.166 Vali Loss: 1.225 Vali Acc: 0.903 Test Loss: 1.225 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2499117851257324
Epoch: 8, Steps: 7 | Train Loss: 0.042 Vali Loss: 2.443 Vali Acc: 0.806 Test Loss: 2.443 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.079435110092163
Epoch: 9, Steps: 7 | Train Loss: 0.182 Vali Loss: 0.664 Vali Acc: 0.917 Test Loss: 0.664 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3733408451080322
Epoch: 10, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.969 Vali Acc: 0.917 Test Loss: 0.969 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3815250396728516
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.958 Test Loss: 0.724 Test Acc: 0.958
Validation loss decreased (-0.916664 --> -0.958326).  Saving model ...
Epoch: 12 cost time: 2.63067364692688
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.944 Test Loss: 0.752 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.267064332962036
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.917 Test Loss: 0.911 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3058218955993652
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.029 Vali Acc: 0.889 Test Loss: 1.029 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.293884038925171
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.142 Vali Acc: 0.889 Test Loss: 1.142 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.110055446624756
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.889 Test Loss: 1.036 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.627934217453003
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.993 Vali Acc: 0.903 Test Loss: 0.993 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.63576340675354
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.974 Vali Acc: 0.903 Test Loss: 0.974 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.918670654296875
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.961 Vali Acc: 0.903 Test Loss: 0.961 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9724762439727783
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.952 Vali Acc: 0.903 Test Loss: 0.952 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.173675537109375
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.948 Vali Acc: 0.903 Test Loss: 0.948 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 4479580
model size : 21.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.836256980895996
Epoch: 1, Steps: 7 | Train Loss: 2.269 Vali Loss: 0.715 Vali Acc: 0.847 Test Loss: 0.715 Test Acc: 0.847
Validation loss decreased (inf --> -0.847215).  Saving model ...
Epoch: 2 cost time: 2.070819854736328
Epoch: 2, Steps: 7 | Train Loss: 0.230 Vali Loss: 0.847 Vali Acc: 0.750 Test Loss: 0.847 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0719192028045654
Epoch: 3, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.815 Vali Acc: 0.889 Test Loss: 0.815 Test Acc: 0.889
Validation loss decreased (-0.847215 --> -0.888881).  Saving model ...
Epoch: 4 cost time: 2.2188830375671387
Epoch: 4, Steps: 7 | Train Loss: 0.073 Vali Loss: 1.118 Vali Acc: 0.861 Test Loss: 1.118 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9775359630584717
Epoch: 5, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.712 Vali Acc: 0.875 Test Loss: 0.712 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0883524417877197
Epoch: 6, Steps: 7 | Train Loss: 0.043 Vali Loss: 1.588 Vali Acc: 0.819 Test Loss: 1.588 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0735011100769043
Epoch: 7, Steps: 7 | Train Loss: 0.212 Vali Loss: 0.446 Vali Acc: 0.889 Test Loss: 0.446 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 1.9511618614196777
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 2.467 Vali Acc: 0.889 Test Loss: 2.467 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1868059635162354
Epoch: 9, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.785 Vali Acc: 0.917 Test Loss: 0.785 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916659).  Saving model ...
Epoch: 10 cost time: 2.1802070140838623
Epoch: 10, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.732 Vali Acc: 0.931 Test Loss: 0.732 Test Acc: 0.931
Validation loss decreased (-0.916659 --> -0.930548).  Saving model ...
Epoch: 11 cost time: 2.0832223892211914
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.335 Vali Acc: 0.944 Test Loss: 0.335 Test Acc: 0.944
Validation loss decreased (-0.930548 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 1.926973819732666
Epoch: 12, Steps: 7 | Train Loss: 0.170 Vali Loss: 0.526 Vali Acc: 0.958 Test Loss: 0.526 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958328).  Saving model ...
Epoch: 13 cost time: 2.022264003753662
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.889 Test Loss: 1.371 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.289508819580078
Epoch: 14, Steps: 7 | Train Loss: 0.011 Vali Loss: 1.407 Vali Acc: 0.889 Test Loss: 1.407 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.153766393661499
Epoch: 15, Steps: 7 | Train Loss: 0.086 Vali Loss: 1.260 Vali Acc: 0.903 Test Loss: 1.260 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8785810470581055
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.114 Vali Acc: 0.931 Test Loss: 1.114 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9444527626037598
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.875 Test Loss: 1.550 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8526995182037354
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.902 Vali Acc: 0.958 Test Loss: 0.902 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9090793132781982
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.958 Test Loss: 0.733 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.156921625137329
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.944 Test Loss: 0.699 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.171901226043701
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.944 Test Loss: 0.702 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9369056224822998
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.944 Test Loss: 0.704 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 4479580
model size : 21.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.046945095062256
Epoch: 1, Steps: 7 | Train Loss: 2.247 Vali Loss: 0.737 Vali Acc: 0.819 Test Loss: 0.737 Test Acc: 0.819
Validation loss decreased (inf --> -0.819437).  Saving model ...
Epoch: 2 cost time: 2.0062317848205566
Epoch: 2, Steps: 7 | Train Loss: 0.234 Vali Loss: 0.793 Vali Acc: 0.750 Test Loss: 0.793 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0260844230651855
Epoch: 3, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.634 Vali Acc: 0.889 Test Loss: 0.634 Test Acc: 0.889
Validation loss decreased (-0.819437 --> -0.888883).  Saving model ...
Epoch: 4 cost time: 2.0432488918304443
Epoch: 4, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.629 Vali Acc: 0.903 Test Loss: 0.629 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902771).  Saving model ...
Epoch: 5 cost time: 2.172327995300293
Epoch: 5, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.567 Vali Acc: 0.931 Test Loss: 0.567 Test Acc: 0.931
Validation loss decreased (-0.902771 --> -0.930550).  Saving model ...
Epoch: 6 cost time: 2.1437370777130127
Epoch: 6, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.763 Vali Acc: 0.903 Test Loss: 0.763 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.974865436553955
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.930550 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 2.102646827697754
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
Validation loss decreased (-0.944442 --> -0.972221).  Saving model ...
Epoch: 9 cost time: 1.9049668312072754
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8984217643737793
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.944 Test Loss: 0.467 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9991073608398438
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.903 Test Loss: 0.703 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9733052253723145
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.903 Test Loss: 0.821 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7502093315124512
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.889 Test Loss: 0.865 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0919315814971924
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.889 Test Loss: 0.872 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0761969089508057
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.889 Test Loss: 0.872 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.022876501083374
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.869 Vali Acc: 0.889 Test Loss: 0.869 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1699233055114746
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.889 Test Loss: 0.865 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.254303216934204
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.889 Test Loss: 0.859 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 4479580
model size : 21.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7527613639831543
Epoch: 1, Steps: 7 | Train Loss: 2.239 Vali Loss: 0.790 Vali Acc: 0.819 Test Loss: 0.790 Test Acc: 0.819
Validation loss decreased (inf --> -0.819437).  Saving model ...
Epoch: 2 cost time: 1.8490114212036133
Epoch: 2, Steps: 7 | Train Loss: 0.285 Vali Loss: 0.704 Vali Acc: 0.736 Test Loss: 0.704 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8427698612213135
Epoch: 3, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.561 Vali Acc: 0.917 Test Loss: 0.561 Test Acc: 0.917
Validation loss decreased (-0.819437 --> -0.916661).  Saving model ...
Epoch: 4 cost time: 1.755406141281128
Epoch: 4, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.669 Vali Acc: 0.903 Test Loss: 0.669 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7985734939575195
Epoch: 5, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.395 Vali Acc: 0.931 Test Loss: 0.395 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 1.6528613567352295
Epoch: 6, Steps: 7 | Train Loss: 0.070 Vali Loss: 1.901 Vali Acc: 0.792 Test Loss: 1.901 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.839996337890625
Epoch: 7, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.961 Vali Acc: 0.903 Test Loss: 0.961 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8306102752685547
Epoch: 8, Steps: 7 | Train Loss: 0.057 Vali Loss: 1.000 Vali Acc: 0.889 Test Loss: 1.000 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7982466220855713
Epoch: 9, Steps: 7 | Train Loss: 0.133 Vali Loss: 0.759 Vali Acc: 0.889 Test Loss: 0.759 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7419366836547852
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.021 Vali Acc: 0.903 Test Loss: 1.021 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.741684913635254
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.524 Vali Acc: 0.819 Test Loss: 2.524 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.750697374343872
Epoch: 12, Steps: 7 | Train Loss: 0.128 Vali Loss: 4.620 Vali Acc: 0.833 Test Loss: 4.620 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7504651546478271
Epoch: 13, Steps: 7 | Train Loss: 0.087 Vali Loss: 3.488 Vali Acc: 0.819 Test Loss: 3.488 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7309906482696533
Epoch: 14, Steps: 7 | Train Loss: 0.226 Vali Loss: 2.808 Vali Acc: 0.750 Test Loss: 2.808 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.548914909362793
Epoch: 15, Steps: 7 | Train Loss: 0.053 Vali Loss: 1.897 Vali Acc: 0.861 Test Loss: 1.897 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 4479580
model size : 21.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.251806974411011
Epoch: 1, Steps: 7 | Train Loss: 2.297 Vali Loss: 0.923 Vali Acc: 0.736 Test Loss: 0.923 Test Acc: 0.736
Validation loss decreased (inf --> -0.736102).  Saving model ...
Epoch: 2 cost time: 2.0321850776672363
Epoch: 2, Steps: 7 | Train Loss: 0.440 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
Validation loss decreased (-0.736102 --> -0.833327).  Saving model ...
Epoch: 3 cost time: 2.0840725898742676
Epoch: 3, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.985 Vali Acc: 0.861 Test Loss: 0.985 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861101).  Saving model ...
Epoch: 4 cost time: 2.328932285308838
Epoch: 4, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.447 Vali Acc: 0.889 Test Loss: 0.447 Test Acc: 0.889
Validation loss decreased (-0.861101 --> -0.888884).  Saving model ...
Epoch: 5 cost time: 2.2815499305725098
Epoch: 5, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.996 Vali Acc: 0.917 Test Loss: 0.996 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916657).  Saving model ...
Epoch: 6 cost time: 2.3729159832000732
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.749 Vali Acc: 0.903 Test Loss: 0.749 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1340346336364746
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.402 Vali Acc: 0.889 Test Loss: 1.402 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.088822841644287
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.521 Vali Acc: 0.931 Test Loss: 0.521 Test Acc: 0.931
Validation loss decreased (-0.916657 --> -0.930550).  Saving model ...
Epoch: 9 cost time: 2.0591673851013184
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 2.5501129627227783
Epoch: 10, Steps: 7 | Train Loss: 0.544 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 2.337372303009033
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 1.600 Vali Acc: 0.819 Test Loss: 1.600 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1719720363616943
Epoch: 12, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.314 Vali Acc: 0.931 Test Loss: 0.314 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.437209129333496
Epoch: 13, Steps: 7 | Train Loss: 0.126 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.3647308349609375
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.727 Vali Acc: 0.889 Test Loss: 0.727 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.451188564300537
Epoch: 15, Steps: 7 | Train Loss: 0.519 Vali Loss: 1.091 Vali Acc: 0.847 Test Loss: 1.091 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.291161298751831
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.931 Test Loss: 0.385 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.144512176513672
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.889 Test Loss: 0.759 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.1713008880615234
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.272 Vali Acc: 0.833 Test Loss: 2.272 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.274462938308716
Epoch: 19, Steps: 7 | Train Loss: 0.237 Vali Loss: 4.076 Vali Acc: 0.764 Test Loss: 4.076 Test Acc: 0.764
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.249575138092041
Epoch: 20, Steps: 7 | Train Loss: 1.140 Vali Loss: 4.483 Vali Acc: 0.792 Test Loss: 4.483 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 4217436
model size : 20.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.241453170776367
Epoch: 1, Steps: 7 | Train Loss: 2.281 Vali Loss: 0.926 Vali Acc: 0.778 Test Loss: 0.926 Test Acc: 0.778
Validation loss decreased (inf --> -0.777769).  Saving model ...
Epoch: 2 cost time: 2.1293368339538574
Epoch: 2, Steps: 7 | Train Loss: 0.466 Vali Loss: 0.715 Vali Acc: 0.819 Test Loss: 0.715 Test Acc: 0.819
Validation loss decreased (-0.777769 --> -0.819437).  Saving model ...
Epoch: 3 cost time: 2.2347044944763184
Epoch: 3, Steps: 7 | Train Loss: 0.144 Vali Loss: 0.729 Vali Acc: 0.875 Test Loss: 0.729 Test Acc: 0.875
Validation loss decreased (-0.819437 --> -0.874993).  Saving model ...
Epoch: 4 cost time: 2.1684043407440186
Epoch: 4, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 1.9787876605987549
Epoch: 5, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.417 Vali Acc: 0.931 Test Loss: 0.417 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930551).  Saving model ...
Epoch: 6 cost time: 1.9896321296691895
Epoch: 6, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.539 Vali Acc: 0.903 Test Loss: 0.539 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8744840621948242
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.875 Test Loss: 1.405 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9892964363098145
Epoch: 8, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.522 Vali Acc: 0.931 Test Loss: 0.522 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9943773746490479
Epoch: 9, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.530 Vali Acc: 0.917 Test Loss: 0.530 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.999774694442749
Epoch: 10, Steps: 7 | Train Loss: 0.705 Vali Loss: 1.593 Vali Acc: 0.875 Test Loss: 1.593 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.155144691467285
Epoch: 11, Steps: 7 | Train Loss: 0.110 Vali Loss: 4.641 Vali Acc: 0.778 Test Loss: 4.641 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2101476192474365
Epoch: 12, Steps: 7 | Train Loss: 0.399 Vali Loss: 3.719 Vali Acc: 0.819 Test Loss: 3.719 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.1689274311065674
Epoch: 13, Steps: 7 | Train Loss: 0.130 Vali Loss: 3.675 Vali Acc: 0.778 Test Loss: 3.675 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1726901531219482
Epoch: 14, Steps: 7 | Train Loss: 0.254 Vali Loss: 5.148 Vali Acc: 0.833 Test Loss: 5.148 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.177809953689575
Epoch: 15, Steps: 7 | Train Loss: 0.409 Vali Loss: 4.195 Vali Acc: 0.819 Test Loss: 4.195 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 4217436
model size : 20.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5154635906219482
Epoch: 1, Steps: 7 | Train Loss: 2.253 Vali Loss: 0.951 Vali Acc: 0.764 Test Loss: 0.951 Test Acc: 0.764
Validation loss decreased (inf --> -0.763879).  Saving model ...
Epoch: 2 cost time: 1.947617769241333
Epoch: 2, Steps: 7 | Train Loss: 0.542 Vali Loss: 0.849 Vali Acc: 0.819 Test Loss: 0.849 Test Acc: 0.819
Validation loss decreased (-0.763879 --> -0.819436).  Saving model ...
Epoch: 3 cost time: 1.9413394927978516
Epoch: 3, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.688 Vali Acc: 0.875 Test Loss: 0.688 Test Acc: 0.875
Validation loss decreased (-0.819436 --> -0.874993).  Saving model ...
Epoch: 4 cost time: 1.754631757736206
Epoch: 4, Steps: 7 | Train Loss: 0.126 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
Validation loss decreased (-0.874993 --> -0.944442).  Saving model ...
Epoch: 5 cost time: 1.9325544834136963
Epoch: 5, Steps: 7 | Train Loss: 0.070 Vali Loss: 2.722 Vali Acc: 0.847 Test Loss: 2.722 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9822044372558594
Epoch: 6, Steps: 7 | Train Loss: 0.223 Vali Loss: 1.429 Vali Acc: 0.861 Test Loss: 1.429 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9904565811157227
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.814 Vali Acc: 0.889 Test Loss: 0.814 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8567368984222412
Epoch: 8, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.574 Vali Acc: 0.917 Test Loss: 0.574 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0742852687835693
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.191 Vali Acc: 0.931 Test Loss: 1.191 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.810640573501587
Epoch: 10, Steps: 7 | Train Loss: 0.655 Vali Loss: 1.077 Vali Acc: 0.917 Test Loss: 1.077 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9923310279846191
Epoch: 11, Steps: 7 | Train Loss: 0.099 Vali Loss: 3.186 Vali Acc: 0.792 Test Loss: 3.186 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6161844730377197
Epoch: 12, Steps: 7 | Train Loss: 0.114 Vali Loss: 1.476 Vali Acc: 0.903 Test Loss: 1.476 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5317974090576172
Epoch: 13, Steps: 7 | Train Loss: 0.163 Vali Loss: 1.444 Vali Acc: 0.903 Test Loss: 1.444 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5458006858825684
Epoch: 14, Steps: 7 | Train Loss: 0.042 Vali Loss: 1.601 Vali Acc: 0.917 Test Loss: 1.601 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 4217436
model size : 20.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.637305736541748
Epoch: 1, Steps: 7 | Train Loss: 2.291 Vali Loss: 1.014 Vali Acc: 0.764 Test Loss: 1.014 Test Acc: 0.764
Validation loss decreased (inf --> -0.763879).  Saving model ...
Epoch: 2 cost time: 1.9385161399841309
Epoch: 2, Steps: 7 | Train Loss: 0.651 Vali Loss: 0.829 Vali Acc: 0.806 Test Loss: 0.829 Test Acc: 0.806
Validation loss decreased (-0.763879 --> -0.805547).  Saving model ...
Epoch: 3 cost time: 1.8802003860473633
Epoch: 3, Steps: 7 | Train Loss: 0.182 Vali Loss: 0.427 Vali Acc: 0.903 Test Loss: 0.427 Test Acc: 0.903
Validation loss decreased (-0.805547 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 1.686584711074829
Epoch: 4, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.493 Vali Acc: 0.903 Test Loss: 0.493 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9279022216796875
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.643 Vali Acc: 0.875 Test Loss: 1.643 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8047776222229004
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.992 Vali Acc: 0.931 Test Loss: 0.992 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930546).  Saving model ...
Epoch: 7 cost time: 1.7578511238098145
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.931 Test Loss: 0.633 Test Acc: 0.931
Validation loss decreased (-0.930546 --> -0.930549).  Saving model ...
Epoch: 8 cost time: 1.7717030048370361
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.931 Test Loss: 0.544 Test Acc: 0.931
Validation loss decreased (-0.930549 --> -0.930550).  Saving model ...
Epoch: 9 cost time: 2.133497714996338
Epoch: 9, Steps: 7 | Train Loss: 0.111 Vali Loss: 0.664 Vali Acc: 0.917 Test Loss: 0.664 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9482944011688232
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.944 Test Loss: 0.544 Test Acc: 0.944
Validation loss decreased (-0.930550 --> -0.944439).  Saving model ...
Epoch: 11 cost time: 1.7916545867919922
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.917 Test Loss: 0.647 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8497803211212158
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.903 Test Loss: 0.727 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7132923603057861
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.889 Test Loss: 0.792 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8032968044281006
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.889 Test Loss: 0.837 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8676278591156006
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.889 Test Loss: 0.858 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.675978183746338
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.861 Vali Acc: 0.889 Test Loss: 0.861 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8062231540679932
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.852 Vali Acc: 0.889 Test Loss: 0.852 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7089838981628418
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.889 Test Loss: 0.844 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.724212408065796
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.836 Vali Acc: 0.889 Test Loss: 0.836 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8015186786651611
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.827 Vali Acc: 0.903 Test Loss: 0.827 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 4217436
model size : 20.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.956162214279175
Epoch: 1, Steps: 7 | Train Loss: 2.408 Vali Loss: 0.772 Vali Acc: 0.819 Test Loss: 0.772 Test Acc: 0.819
Validation loss decreased (inf --> -0.819437).  Saving model ...
Epoch: 2 cost time: 2.2462527751922607
Epoch: 2, Steps: 7 | Train Loss: 0.212 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
Validation loss decreased (-0.819437 --> -0.916663).  Saving model ...
Epoch: 3 cost time: 2.21451735496521
Epoch: 3, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.531 Vali Acc: 0.847 Test Loss: 0.531 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1126914024353027
Epoch: 4, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.394 Vali Acc: 0.903 Test Loss: 0.394 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0542781352996826
Epoch: 5, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.624 Vali Acc: 0.889 Test Loss: 0.624 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0375797748565674
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.847 Test Loss: 1.467 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.098505973815918
Epoch: 7, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.926 Vali Acc: 0.875 Test Loss: 0.926 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1544911861419678
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.720 Vali Acc: 0.917 Test Loss: 0.720 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9060730934143066
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.954 Vali Acc: 0.833 Test Loss: 0.954 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0023117065429688
Epoch: 10, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.925 Vali Acc: 0.861 Test Loss: 0.925 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0967142581939697
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.702 Vali Acc: 0.931 Test Loss: 0.702 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930549).  Saving model ...
Epoch: 12 cost time: 2.0819544792175293
Epoch: 12, Steps: 7 | Train Loss: 0.398 Vali Loss: 2.329 Vali Acc: 0.833 Test Loss: 2.329 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.316854953765869
Epoch: 13, Steps: 7 | Train Loss: 0.371 Vali Loss: 3.594 Vali Acc: 0.792 Test Loss: 3.594 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.236724376678467
Epoch: 14, Steps: 7 | Train Loss: 0.495 Vali Loss: 1.692 Vali Acc: 0.861 Test Loss: 1.692 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.196425437927246
Epoch: 15, Steps: 7 | Train Loss: 0.719 Vali Loss: 2.631 Vali Acc: 0.792 Test Loss: 2.631 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2239365577697754
Epoch: 16, Steps: 7 | Train Loss: 0.483 Vali Loss: 2.302 Vali Acc: 0.847 Test Loss: 2.302 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.2643914222717285
Epoch: 17, Steps: 7 | Train Loss: 0.727 Vali Loss: 3.428 Vali Acc: 0.875 Test Loss: 3.428 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.1861724853515625
Epoch: 18, Steps: 7 | Train Loss: 0.336 Vali Loss: 4.062 Vali Acc: 0.903 Test Loss: 4.062 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.3321008682250977
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 2.566 Vali Acc: 0.917 Test Loss: 2.566 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.2496559619903564
Epoch: 20, Steps: 7 | Train Loss: 0.254 Vali Loss: 3.625 Vali Acc: 0.861 Test Loss: 3.625 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.3069028854370117
Epoch: 21, Steps: 7 | Train Loss: 0.577 Vali Loss: 9.366 Vali Acc: 0.819 Test Loss: 9.366 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 4086364
model size : 20.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6478824615478516
Epoch: 1, Steps: 7 | Train Loss: 2.368 Vali Loss: 0.784 Vali Acc: 0.792 Test Loss: 0.784 Test Acc: 0.792
Validation loss decreased (inf --> -0.791659).  Saving model ...
Epoch: 2 cost time: 1.925563097000122
Epoch: 2, Steps: 7 | Train Loss: 0.218 Vali Loss: 0.368 Vali Acc: 0.917 Test Loss: 0.368 Test Acc: 0.917
Validation loss decreased (-0.791659 --> -0.916663).  Saving model ...
Epoch: 3 cost time: 2.219487428665161
Epoch: 3, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3526785373687744
Epoch: 4, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.418 Vali Acc: 0.875 Test Loss: 0.418 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2262773513793945
Epoch: 5, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.098808526992798
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.389 Vali Acc: 0.847 Test Loss: 1.389 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0087361335754395
Epoch: 7, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.899 Vali Acc: 0.889 Test Loss: 0.899 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1231272220611572
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.945 Vali Acc: 0.889 Test Loss: 0.945 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.236131191253662
Epoch: 9, Steps: 7 | Train Loss: 0.040 Vali Loss: 1.291 Vali Acc: 0.861 Test Loss: 1.291 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3508195877075195
Epoch: 10, Steps: 7 | Train Loss: 0.047 Vali Loss: 1.742 Vali Acc: 0.847 Test Loss: 1.742 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.064668893814087
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.758 Vali Acc: 0.792 Test Loss: 2.758 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9188542366027832
Epoch: 12, Steps: 7 | Train Loss: 0.369 Vali Loss: 0.949 Vali Acc: 0.917 Test Loss: 0.949 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 4086364
model size : 20.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6193692684173584
Epoch: 1, Steps: 7 | Train Loss: 2.319 Vali Loss: 0.787 Vali Acc: 0.778 Test Loss: 0.787 Test Acc: 0.778
Validation loss decreased (inf --> -0.777770).  Saving model ...
Epoch: 2 cost time: 1.8153481483459473
Epoch: 2, Steps: 7 | Train Loss: 0.230 Vali Loss: 0.358 Vali Acc: 0.917 Test Loss: 0.358 Test Acc: 0.917
Validation loss decreased (-0.777770 --> -0.916663).  Saving model ...
Epoch: 3 cost time: 1.6745500564575195
Epoch: 3, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.406 Vali Acc: 0.889 Test Loss: 0.406 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.860384225845337
Epoch: 4, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.552 Vali Acc: 0.903 Test Loss: 0.552 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8738019466400146
Epoch: 5, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.636 Vali Acc: 0.917 Test Loss: 0.636 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.847259283065796
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.889 Test Loss: 0.833 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.75813627243042
Epoch: 7, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.896 Vali Acc: 0.889 Test Loss: 0.896 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.89851975440979
Epoch: 8, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.888 Vali Acc: 0.875 Test Loss: 0.888 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8268542289733887
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.869 Vali Acc: 0.847 Test Loss: 0.869 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9010436534881592
Epoch: 10, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.510 Vali Acc: 0.917 Test Loss: 0.510 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.967832326889038
Epoch: 11, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.938 Vali Acc: 0.875 Test Loss: 0.938 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8341481685638428
Epoch: 12, Steps: 7 | Train Loss: 0.579 Vali Loss: 0.401 Vali Acc: 0.903 Test Loss: 0.401 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 4086364
model size : 20.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3154349327087402
Epoch: 1, Steps: 7 | Train Loss: 2.311 Vali Loss: 0.839 Vali Acc: 0.750 Test Loss: 0.839 Test Acc: 0.750
Validation loss decreased (inf --> -0.749992).  Saving model ...
Epoch: 2 cost time: 1.626349687576294
Epoch: 2, Steps: 7 | Train Loss: 0.277 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (-0.749992 --> -0.888885).  Saving model ...
Epoch: 3 cost time: 1.646385908126831
Epoch: 3, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.370 Vali Acc: 0.903 Test Loss: 0.370 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 1.486537218093872
Epoch: 4, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.124 Vali Acc: 0.986 Test Loss: 0.124 Test Acc: 0.986
Validation loss decreased (-0.902774 --> -0.986110).  Saving model ...
Epoch: 5 cost time: 1.8832097053527832
Epoch: 5, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7630455493927002
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6850345134735107
Epoch: 7, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.669 Vali Acc: 0.889 Test Loss: 0.669 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.871718406677246
Epoch: 8, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.869 Vali Acc: 0.889 Test Loss: 0.869 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7838492393493652
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.030 Vali Acc: 0.847 Test Loss: 1.030 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6287217140197754
Epoch: 10, Steps: 7 | Train Loss: 0.133 Vali Loss: 0.878 Vali Acc: 0.889 Test Loss: 0.878 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8177895545959473
Epoch: 11, Steps: 7 | Train Loss: 0.071 Vali Loss: 1.196 Vali Acc: 0.861 Test Loss: 1.196 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8254079818725586
Epoch: 12, Steps: 7 | Train Loss: 0.975 Vali Loss: 2.571 Vali Acc: 0.861 Test Loss: 2.571 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6533784866333008
Epoch: 13, Steps: 7 | Train Loss: 0.258 Vali Loss: 1.398 Vali Acc: 0.861 Test Loss: 1.398 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6686208248138428
Epoch: 14, Steps: 7 | Train Loss: 0.052 Vali Loss: 1.398 Vali Acc: 0.889 Test Loss: 1.398 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9861111111111112
model parameter : 4086364
model size : 20.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9117884635925293
Epoch: 1, Steps: 7 | Train Loss: 2.249 Vali Loss: 0.742 Vali Acc: 0.792 Test Loss: 0.742 Test Acc: 0.792
Validation loss decreased (inf --> -0.791659).  Saving model ...
Epoch: 2 cost time: 1.9758625030517578
Epoch: 2, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
Validation loss decreased (-0.791659 --> -0.916663).  Saving model ...
Epoch: 3 cost time: 2.0294430255889893
Epoch: 3, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.667 Vali Acc: 0.875 Test Loss: 0.667 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.333336353302002
Epoch: 4, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.328 Vali Acc: 0.958 Test Loss: 0.328 Test Acc: 0.958
Validation loss decreased (-0.916663 --> -0.958330).  Saving model ...
Epoch: 5 cost time: 2.236891269683838
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.379 Vali Acc: 0.944 Test Loss: 0.379 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.377197265625
Epoch: 6, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.436 Vali Acc: 0.944 Test Loss: 0.436 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3692867755889893
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.447 Vali Acc: 0.944 Test Loss: 0.447 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2576239109039307
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.917 Test Loss: 0.603 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2260615825653076
Epoch: 9, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.631 Vali Acc: 0.875 Test Loss: 0.631 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.228900909423828
Epoch: 10, Steps: 7 | Train Loss: 0.026 Vali Loss: 1.293 Vali Acc: 0.833 Test Loss: 1.293 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.305288791656494
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.900 Vali Acc: 0.875 Test Loss: 0.900 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.226917028427124
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.903 Test Loss: 0.817 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.330165386199951
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.889 Test Loss: 0.845 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.5283238887786865
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.870 Vali Acc: 0.889 Test Loss: 0.870 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 4020828
model size : 20.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.735140085220337
Epoch: 1, Steps: 7 | Train Loss: 2.223 Vali Loss: 0.737 Vali Acc: 0.792 Test Loss: 0.737 Test Acc: 0.792
Validation loss decreased (inf --> -0.791659).  Saving model ...
Epoch: 2 cost time: 2.0665977001190186
Epoch: 2, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.345 Vali Acc: 0.917 Test Loss: 0.345 Test Acc: 0.917
Validation loss decreased (-0.791659 --> -0.916663).  Saving model ...
Epoch: 3 cost time: 1.9572267532348633
Epoch: 3, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.444 Vali Acc: 0.903 Test Loss: 0.444 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7532315254211426
Epoch: 4, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.357 Vali Acc: 0.944 Test Loss: 0.357 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944441).  Saving model ...
Epoch: 5 cost time: 1.7745745182037354
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.889 Test Loss: 0.548 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9556159973144531
Epoch: 6, Steps: 7 | Train Loss: 0.048 Vali Loss: 1.770 Vali Acc: 0.861 Test Loss: 1.770 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1892426013946533
Epoch: 7, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.916 Vali Acc: 0.875 Test Loss: 0.916 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.857682228088379
Epoch: 8, Steps: 7 | Train Loss: 0.046 Vali Loss: 1.277 Vali Acc: 0.833 Test Loss: 1.277 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9566161632537842
Epoch: 9, Steps: 7 | Train Loss: 0.076 Vali Loss: 2.896 Vali Acc: 0.764 Test Loss: 2.896 Test Acc: 0.764
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9131402969360352
Epoch: 10, Steps: 7 | Train Loss: 0.216 Vali Loss: 1.380 Vali Acc: 0.806 Test Loss: 1.380 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9569029808044434
Epoch: 11, Steps: 7 | Train Loss: 0.119 Vali Loss: 1.435 Vali Acc: 0.903 Test Loss: 1.435 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.1790051460266113
Epoch: 12, Steps: 7 | Train Loss: 0.072 Vali Loss: 3.976 Vali Acc: 0.847 Test Loss: 3.976 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1661360263824463
Epoch: 13, Steps: 7 | Train Loss: 0.209 Vali Loss: 1.499 Vali Acc: 0.931 Test Loss: 1.499 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.0511507987976074
Epoch: 14, Steps: 7 | Train Loss: 0.349 Vali Loss: 3.216 Vali Acc: 0.847 Test Loss: 3.216 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 4020828
model size : 20.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5069046020507812
Epoch: 1, Steps: 7 | Train Loss: 2.242 Vali Loss: 0.729 Vali Acc: 0.778 Test Loss: 0.729 Test Acc: 0.778
Validation loss decreased (inf --> -0.777770).  Saving model ...
Epoch: 2 cost time: 1.9446723461151123
Epoch: 2, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.364 Vali Acc: 0.917 Test Loss: 0.364 Test Acc: 0.917
Validation loss decreased (-0.777770 --> -0.916663).  Saving model ...
Epoch: 3 cost time: 1.855011224746704
Epoch: 3, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7949113845825195
Epoch: 4, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.297 Vali Acc: 0.931 Test Loss: 0.297 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 1.9184751510620117
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.917 Test Loss: 0.472 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.956803321838379
Epoch: 6, Steps: 7 | Train Loss: 0.277 Vali Loss: 0.693 Vali Acc: 0.861 Test Loss: 0.693 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5979349613189697
Epoch: 7, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.887 Vali Acc: 0.903 Test Loss: 0.887 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.575002670288086
Epoch: 8, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.524 Vali Acc: 0.931 Test Loss: 0.524 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6356585025787354
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.606 Vali Acc: 0.903 Test Loss: 0.606 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7524371147155762
Epoch: 10, Steps: 7 | Train Loss: 0.010 Vali Loss: 1.246 Vali Acc: 0.875 Test Loss: 1.246 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.899487018585205
Epoch: 11, Steps: 7 | Train Loss: 0.272 Vali Loss: 3.589 Vali Acc: 0.833 Test Loss: 3.589 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6859850883483887
Epoch: 12, Steps: 7 | Train Loss: 0.294 Vali Loss: 0.867 Vali Acc: 0.875 Test Loss: 0.867 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7410240173339844
Epoch: 13, Steps: 7 | Train Loss: 0.204 Vali Loss: 0.484 Vali Acc: 0.917 Test Loss: 0.484 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8112273216247559
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.903 Test Loss: 0.567 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 4020828
model size : 20.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5005197525024414
Epoch: 1, Steps: 7 | Train Loss: 2.231 Vali Loss: 0.783 Vali Acc: 0.819 Test Loss: 0.783 Test Acc: 0.819
Validation loss decreased (inf --> -0.819437).  Saving model ...
Epoch: 2 cost time: 1.7894346714019775
Epoch: 2, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.819437 --> -0.902775).  Saving model ...
Epoch: 3 cost time: 1.7198100090026855
Epoch: 3, Steps: 7 | Train Loss: 0.122 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.877417802810669
Epoch: 4, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.842 Vali Acc: 0.875 Test Loss: 0.842 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7886033058166504
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.353 Vali Acc: 0.931 Test Loss: 0.353 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 1.8187415599822998
Epoch: 6, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.475 Vali Acc: 0.931 Test Loss: 0.475 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.930690050125122
Epoch: 7, Steps: 7 | Train Loss: 0.052 Vali Loss: 2.092 Vali Acc: 0.889 Test Loss: 2.092 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.85994553565979
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 2.489 Vali Acc: 0.861 Test Loss: 2.489 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9052917957305908
Epoch: 9, Steps: 7 | Train Loss: 0.043 Vali Loss: 2.760 Vali Acc: 0.833 Test Loss: 2.760 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7430083751678467
Epoch: 10, Steps: 7 | Train Loss: 0.044 Vali Loss: 2.272 Vali Acc: 0.861 Test Loss: 2.272 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7255988121032715
Epoch: 11, Steps: 7 | Train Loss: 0.055 Vali Loss: 2.315 Vali Acc: 0.861 Test Loss: 2.315 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6646106243133545
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 1.817 Vali Acc: 0.861 Test Loss: 1.817 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6815431118011475
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.847 Test Loss: 1.408 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5207724571228027
Epoch: 14, Steps: 7 | Train Loss: 0.031 Vali Loss: 1.494 Vali Acc: 0.861 Test Loss: 1.494 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6539559364318848
Epoch: 15, Steps: 7 | Train Loss: 0.211 Vali Loss: 1.953 Vali Acc: 0.847 Test Loss: 1.953 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 4020828
model size : 20.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4778332710266113
Epoch: 1, Steps: 7 | Train Loss: 2.226 Vali Loss: 1.134 Vali Acc: 0.722 Test Loss: 1.134 Test Acc: 0.722
Validation loss decreased (inf --> -0.722211).  Saving model ...
Epoch: 2 cost time: 1.5633139610290527
Epoch: 2, Steps: 7 | Train Loss: 0.404 Vali Loss: 0.497 Vali Acc: 0.875 Test Loss: 0.497 Test Acc: 0.875
Validation loss decreased (-0.722211 --> -0.874995).  Saving model ...
Epoch: 3 cost time: 1.6717288494110107
Epoch: 3, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.874995 --> -0.916664).  Saving model ...
Epoch: 4 cost time: 1.7140674591064453
Epoch: 4, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 1.6970446109771729
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7367496490478516
Epoch: 6, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6760900020599365
Epoch: 7, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 1.631464958190918
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7806813716888428
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.903 Test Loss: 0.456 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.340247392654419
Epoch: 10, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.404 Vali Acc: 0.903 Test Loss: 0.404 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3755967617034912
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.321138858795166
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3638865947723389
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3942012786865234
Epoch: 14, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.385 Vali Acc: 0.931 Test Loss: 0.385 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6181018352508545
Epoch: 15, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.626 Vali Acc: 0.917 Test Loss: 0.626 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7580046653747559
Epoch: 16, Steps: 7 | Train Loss: 0.166 Vali Loss: 0.485 Vali Acc: 0.944 Test Loss: 0.485 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6269183158874512
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2960732
model size : 13.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3952181339263916
Epoch: 1, Steps: 7 | Train Loss: 2.222 Vali Loss: 1.126 Vali Acc: 0.722 Test Loss: 1.126 Test Acc: 0.722
Validation loss decreased (inf --> -0.722211).  Saving model ...
Epoch: 2 cost time: 1.603276014328003
Epoch: 2, Steps: 7 | Train Loss: 0.407 Vali Loss: 0.465 Vali Acc: 0.861 Test Loss: 0.465 Test Acc: 0.861
Validation loss decreased (-0.722211 --> -0.861106).  Saving model ...
Epoch: 3 cost time: 1.4916050434112549
Epoch: 3, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 1.6117935180664062
Epoch: 4, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930554).  Saving model ...
Epoch: 5 cost time: 1.5119240283966064
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6790874004364014
Epoch: 6, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.669891595840454
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5247483253479004
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6955618858337402
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.400 Vali Acc: 0.889 Test Loss: 0.400 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.682037353515625
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5344080924987793
Epoch: 11, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8166983127593994
Epoch: 12, Steps: 7 | Train Loss: 0.085 Vali Loss: 1.100 Vali Acc: 0.861 Test Loss: 1.100 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7495994567871094
Epoch: 13, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.304 Vali Acc: 0.944 Test Loss: 0.304 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944441).  Saving model ...
Epoch: 14 cost time: 1.6700820922851562
Epoch: 14, Steps: 7 | Train Loss: 0.094 Vali Loss: 1.098 Vali Acc: 0.847 Test Loss: 1.098 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.666097640991211
Epoch: 15, Steps: 7 | Train Loss: 0.021 Vali Loss: 1.716 Vali Acc: 0.806 Test Loss: 1.716 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6615872383117676
Epoch: 16, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.843 Vali Acc: 0.903 Test Loss: 0.843 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5563671588897705
Epoch: 17, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.738 Vali Acc: 0.875 Test Loss: 0.738 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6071736812591553
Epoch: 18, Steps: 7 | Train Loss: 0.223 Vali Loss: 1.060 Vali Acc: 0.861 Test Loss: 1.060 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.731217384338379
Epoch: 19, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.931 Vali Acc: 0.792 Test Loss: 0.931 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5751314163208008
Epoch: 20, Steps: 7 | Train Loss: 0.310 Vali Loss: 2.675 Vali Acc: 0.792 Test Loss: 2.675 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5401132106781006
Epoch: 21, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.764 Vali Acc: 0.889 Test Loss: 0.764 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.527569055557251
Epoch: 22, Steps: 7 | Train Loss: 0.080 Vali Loss: 1.358 Vali Acc: 0.875 Test Loss: 1.358 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.611814260482788
Epoch: 23, Steps: 7 | Train Loss: 0.019 Vali Loss: 1.449 Vali Acc: 0.875 Test Loss: 1.449 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2960732
model size : 13.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1733341217041016
Epoch: 1, Steps: 7 | Train Loss: 2.200 Vali Loss: 1.116 Vali Acc: 0.764 Test Loss: 1.116 Test Acc: 0.764
Validation loss decreased (inf --> -0.763878).  Saving model ...
Epoch: 2 cost time: 1.4415781497955322
Epoch: 2, Steps: 7 | Train Loss: 0.430 Vali Loss: 0.442 Vali Acc: 0.861 Test Loss: 0.442 Test Acc: 0.861
Validation loss decreased (-0.763878 --> -0.861107).  Saving model ...
Epoch: 3 cost time: 1.6226015090942383
Epoch: 3, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.324 Vali Acc: 0.931 Test Loss: 0.324 Test Acc: 0.931
Validation loss decreased (-0.861107 --> -0.930552).  Saving model ...
Epoch: 4 cost time: 1.673419713973999
Epoch: 4, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2687315940856934
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.401 Vali Acc: 0.861 Test Loss: 0.401 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7099416255950928
Epoch: 6, Steps: 7 | Train Loss: 0.179 Vali Loss: 0.423 Vali Acc: 0.861 Test Loss: 0.423 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.724308729171753
Epoch: 7, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5855939388275146
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.889 Test Loss: 0.545 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8623626232147217
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6994307041168213
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8974411487579346
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.875 Test Loss: 0.493 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9162795543670654
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.875 Test Loss: 0.486 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5338506698608398
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2960732
model size : 13.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8336105346679688
Epoch: 1, Steps: 7 | Train Loss: 2.232 Vali Loss: 1.189 Vali Acc: 0.722 Test Loss: 1.189 Test Acc: 0.722
Validation loss decreased (inf --> -0.722210).  Saving model ...
Epoch: 2 cost time: 1.2057445049285889
Epoch: 2, Steps: 7 | Train Loss: 0.514 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
Validation loss decreased (-0.722210 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 1.2541818618774414
Epoch: 3, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.357 Vali Acc: 0.875 Test Loss: 0.357 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 4 cost time: 1.3833036422729492
Epoch: 4, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.874996 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 1.2665741443634033
Epoch: 5, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2990503311157227
Epoch: 6, Steps: 7 | Train Loss: 0.457 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3384733200073242
Epoch: 7, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 1.3221533298492432
Epoch: 8, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.325 Vali Acc: 0.931 Test Loss: 0.325 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.341968059539795
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.917 Test Loss: 0.449 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.42645263671875
Epoch: 10, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.388 Vali Acc: 0.931 Test Loss: 0.388 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4804189205169678
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.391 Vali Acc: 0.931 Test Loss: 0.391 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4490115642547607
Epoch: 12, Steps: 7 | Train Loss: 0.178 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.319671869277954
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.429 Vali Acc: 0.917 Test Loss: 0.429 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4221134185791016
Epoch: 14, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.861 Vali Acc: 0.917 Test Loss: 0.861 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4790070056915283
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.685 Vali Acc: 0.917 Test Loss: 0.685 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4619050025939941
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3569309711456299
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.864 Vali Acc: 0.917 Test Loss: 0.864 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3417670726776123
Epoch: 18, Steps: 7 | Train Loss: 0.033 Vali Loss: 1.355 Vali Acc: 0.875 Test Loss: 1.355 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.56453275680542
Epoch: 19, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.924 Vali Acc: 0.944 Test Loss: 0.924 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3012120723724365
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.636 Vali Acc: 0.889 Test Loss: 1.636 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4433987140655518
Epoch: 21, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.910 Vali Acc: 0.931 Test Loss: 0.910 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2982056140899658
Epoch: 22, Steps: 7 | Train Loss: 0.075 Vali Loss: 1.751 Vali Acc: 0.833 Test Loss: 1.751 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2960732
model size : 13.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.062795877456665
Epoch: 1, Steps: 7 | Train Loss: 2.486 Vali Loss: 1.226 Vali Acc: 0.722 Test Loss: 1.226 Test Acc: 0.722
Validation loss decreased (inf --> -0.722210).  Saving model ...
Epoch: 2 cost time: 1.6208300590515137
Epoch: 2, Steps: 7 | Train Loss: 0.538 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
Validation loss decreased (-0.722210 --> -0.847217).  Saving model ...
Epoch: 3 cost time: 1.7241921424865723
Epoch: 3, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.772 Vali Acc: 0.833 Test Loss: 0.772 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7538628578186035
Epoch: 4, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.607 Vali Acc: 0.861 Test Loss: 0.607 Test Acc: 0.861
Validation loss decreased (-0.847217 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 1.5042352676391602
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.420 Vali Acc: 0.889 Test Loss: 0.420 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.4975082874298096
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.404 Vali Acc: 0.889 Test Loss: 0.404 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 1.6144764423370361
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.479 Vali Acc: 0.903 Test Loss: 0.479 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 1.6283783912658691
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.544 Vali Acc: 0.903 Test Loss: 0.544 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5213258266448975
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.540 Vali Acc: 0.917 Test Loss: 0.540 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916661).  Saving model ...
Epoch: 10 cost time: 1.8047597408294678
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.889 Test Loss: 0.552 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5668327808380127
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.903 Test Loss: 0.563 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6518876552581787
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.903 Test Loss: 0.567 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5929160118103027
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.903 Test Loss: 0.568 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7190361022949219
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.903 Test Loss: 0.565 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8246562480926514
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.903 Test Loss: 0.560 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8187999725341797
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.903 Test Loss: 0.555 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.544792652130127
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.903 Test Loss: 0.551 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6542236804962158
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.903 Test Loss: 0.548 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6034066677093506
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.903 Test Loss: 0.545 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 2436444
model size : 11.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2949090003967285
Epoch: 1, Steps: 7 | Train Loss: 2.452 Vali Loss: 1.220 Vali Acc: 0.750 Test Loss: 1.220 Test Acc: 0.750
Validation loss decreased (inf --> -0.749988).  Saving model ...
Epoch: 2 cost time: 1.452505111694336
Epoch: 2, Steps: 7 | Train Loss: 0.545 Vali Loss: 0.467 Vali Acc: 0.861 Test Loss: 0.467 Test Acc: 0.861
Validation loss decreased (-0.749988 --> -0.861106).  Saving model ...
Epoch: 3 cost time: 1.4027066230773926
Epoch: 3, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.806 Vali Acc: 0.833 Test Loss: 0.806 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6463961601257324
Epoch: 4, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.670 Vali Acc: 0.847 Test Loss: 0.670 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5550537109375
Epoch: 5, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.428 Vali Acc: 0.903 Test Loss: 0.428 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902773).  Saving model ...
Epoch: 6 cost time: 1.4543216228485107
Epoch: 6, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.453 Vali Acc: 0.889 Test Loss: 0.453 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6628212928771973
Epoch: 7, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.732 Vali Acc: 0.861 Test Loss: 0.732 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7471156120300293
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.889 Test Loss: 0.686 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4903967380523682
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.875 Test Loss: 0.727 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6307129859924316
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.875 Test Loss: 0.789 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5470366477966309
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.815 Vali Acc: 0.889 Test Loss: 0.815 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5820643901824951
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.809 Vali Acc: 0.889 Test Loss: 0.809 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6014299392700195
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.889 Test Loss: 0.789 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5899848937988281
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.875 Test Loss: 0.754 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.541978359222412
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.875 Test Loss: 0.730 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 2436444
model size : 11.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2489585876464844
Epoch: 1, Steps: 7 | Train Loss: 2.470 Vali Loss: 1.254 Vali Acc: 0.722 Test Loss: 1.254 Test Acc: 0.722
Validation loss decreased (inf --> -0.722210).  Saving model ...
Epoch: 2 cost time: 1.4886367321014404
Epoch: 2, Steps: 7 | Train Loss: 0.563 Vali Loss: 0.459 Vali Acc: 0.861 Test Loss: 0.459 Test Acc: 0.861
Validation loss decreased (-0.722210 --> -0.861107).  Saving model ...
Epoch: 3 cost time: 1.4294662475585938
Epoch: 3, Steps: 7 | Train Loss: 0.040 Vali Loss: 1.036 Vali Acc: 0.792 Test Loss: 1.036 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4075136184692383
Epoch: 4, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.552 Vali Acc: 0.861 Test Loss: 0.552 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3055768013000488
Epoch: 5, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.561 Vali Acc: 0.889 Test Loss: 0.561 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 1.3494656085968018
Epoch: 6, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.454 Vali Acc: 0.889 Test Loss: 0.454 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 1.3341569900512695
Epoch: 7, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.973 Vali Acc: 0.889 Test Loss: 0.973 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2651259899139404
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.889 Test Loss: 0.774 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4008033275604248
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.944 Test Loss: 0.445 Test Acc: 0.944
Validation loss decreased (-0.888884 --> -0.944440).  Saving model ...
Epoch: 10 cost time: 1.4420139789581299
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.355 Vali Acc: 0.944 Test Loss: 0.355 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 1.2703468799591064
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.944 Test Loss: 0.318 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 1.4003140926361084
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.303 Vali Acc: 0.944 Test Loss: 0.303 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 1.3678717613220215
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 14 cost time: 1.4168856143951416
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 1.3866748809814453
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.3204996585845947
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.296595811843872
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.3170459270477295
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.944 Test Loss: 0.292 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.3408408164978027
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.944 Test Loss: 0.292 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.2893383502960205
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 1.4390902519226074
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.4862279891967773
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.944 Test Loss: 0.289 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 1.4925541877746582
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 1.4675214290618896
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.528102159500122
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 1.4072580337524414
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.4594452381134033
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 1.4549736976623535
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.568669319152832
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.944 Test Loss: 0.283 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.6200931072235107
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.3871886730194092
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 1.4447219371795654
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 1.3872501850128174
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 1.4464972019195557
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 1.3610410690307617
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 1.489027738571167
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 1.5028841495513916
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 1.4110445976257324
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 1.4990642070770264
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 1.398813009262085
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 1.461378574371338
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 1.563157320022583
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 1.3430912494659424
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 1.5447030067443848
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 1.428238868713379
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 1.3874876499176025
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 1.4413812160491943
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 1.346503734588623
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 1.4945192337036133
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 1.4798502922058105
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 1.3628239631652832
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 1.395495891571045
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 1.488457441329956
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 1.415557861328125
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 1.4214446544647217
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 1.398061752319336
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 1.3124876022338867
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 1.3586540222167969
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 1.3642549514770508
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 1.4362437725067139
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 1.3477795124053955
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 62 cost time: 1.4622774124145508
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 63 cost time: 1.3990013599395752
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 64 cost time: 1.237550973892212
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 65 cost time: 1.4161553382873535
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 66 cost time: 1.329331398010254
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 67 cost time: 1.4421982765197754
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 68 cost time: 1.433135747909546
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 69 cost time: 1.488114833831787
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 70 cost time: 1.4325134754180908
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 71 cost time: 1.4156408309936523
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 72 cost time: 1.411381483078003
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 73 cost time: 1.2429115772247314
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 74 cost time: 1.3023450374603271
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 75 cost time: 1.3870675563812256
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 76 cost time: 1.366330862045288
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 77 cost time: 1.2720880508422852
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 78 cost time: 1.3538236618041992
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 79 cost time: 1.3598263263702393
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 80 cost time: 1.4548635482788086
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 81 cost time: 1.544377326965332
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 82 cost time: 1.494804859161377
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 83 cost time: 1.458803415298462
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 84 cost time: 1.6158268451690674
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 85 cost time: 1.3834176063537598
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 86 cost time: 1.4979424476623535
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 87 cost time: 1.5545241832733154
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 88 cost time: 1.5883476734161377
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 89 cost time: 1.5194728374481201
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 90 cost time: 1.5120642185211182
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 91 cost time: 1.6187851428985596
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 92 cost time: 1.555129051208496
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 93 cost time: 1.3403282165527344
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 94 cost time: 1.5578737258911133
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 95 cost time: 1.4947597980499268
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.3466770648956299
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 1.5811126232147217
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 1.3942246437072754
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 1.392397403717041
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 1.3184034824371338
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2436444
model size : 11.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7844760417938232
Epoch: 1, Steps: 7 | Train Loss: 2.434 Vali Loss: 1.313 Vali Acc: 0.792 Test Loss: 1.313 Test Acc: 0.792
Validation loss decreased (inf --> -0.791654).  Saving model ...
Epoch: 2 cost time: 1.224125862121582
Epoch: 2, Steps: 7 | Train Loss: 0.615 Vali Loss: 0.383 Vali Acc: 0.847 Test Loss: 0.383 Test Acc: 0.847
Validation loss decreased (-0.791654 --> -0.847218).  Saving model ...
Epoch: 3 cost time: 1.222515344619751
Epoch: 3, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.870 Vali Acc: 0.792 Test Loss: 0.870 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.291987657546997
Epoch: 4, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
Validation loss decreased (-0.847218 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 1.2618942260742188
Epoch: 5, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.367 Vali Acc: 0.917 Test Loss: 0.367 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 1.282240390777588
Epoch: 6, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.4097058773040771
Epoch: 7, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.697 Vali Acc: 0.861 Test Loss: 0.697 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3680603504180908
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.473 Vali Acc: 0.903 Test Loss: 0.473 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.41363525390625
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.297 Vali Acc: 0.931 Test Loss: 0.297 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.3175225257873535
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.3544199466705322
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.2468044757843018
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.2891833782196045
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.285172939300537
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 1.2489235401153564
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 1.2071130275726318
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 1.3066380023956299
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 1.0896739959716797
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.154512643814087
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 1.122772216796875
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 1.043715476989746
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 1.3408105373382568
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 1.1679720878601074
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 1.1984694004058838
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 1.1206202507019043
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 1.0813584327697754
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 1.2914683818817139
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 1.3370118141174316
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 1.355534315109253
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 1.4074840545654297
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 1.2592442035675049
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 1.1933231353759766
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 1.2599470615386963
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 1.257749319076538
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 1.258683443069458
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 1.2626588344573975
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 1.2545113563537598
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 1.3328402042388916
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 1.4485909938812256
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 1.2490651607513428
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 1.3680744171142578
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 1.4496569633483887
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 1.3774361610412598
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.958332 --> -0.972220).  Saving model ...
Epoch: 44 cost time: 1.2956717014312744
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 45 cost time: 1.3787038326263428
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 46 cost time: 1.286613941192627
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 47 cost time: 1.3121495246887207
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 48 cost time: 1.3086097240447998
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 49 cost time: 1.3061084747314453
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 50 cost time: 1.3406524658203125
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 51 cost time: 1.4421799182891846
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 52 cost time: 1.2798516750335693
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 53 cost time: 1.4160144329071045
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 54 cost time: 1.422253131866455
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 55 cost time: 1.2802207469940186
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 56 cost time: 1.2782151699066162
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 57 cost time: 1.2345082759857178
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 58 cost time: 1.4114491939544678
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 59 cost time: 1.3122336864471436
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.972 Test Loss: 0.177 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 60 cost time: 1.3814265727996826
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.972 Test Loss: 0.177 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 61 cost time: 1.4074580669403076
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.972 Test Loss: 0.177 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 62 cost time: 1.5745995044708252
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.972 Test Loss: 0.177 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 63 cost time: 1.4219083786010742
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.2468299865722656
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.302884817123413
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.245737075805664
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.337794542312622
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.1916530132293701
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.227644920349121
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.166677713394165
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.2049787044525146
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 1.199218511581421
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 2436444
model size : 11.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.362771511077881
Epoch: 1, Steps: 7 | Train Loss: 2.331 Vali Loss: 1.233 Vali Acc: 0.681 Test Loss: 1.233 Test Acc: 0.681
Validation loss decreased (inf --> -0.680543).  Saving model ...
Epoch: 2 cost time: 1.5553982257843018
Epoch: 2, Steps: 7 | Train Loss: 0.487 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.680543 --> -0.888886).  Saving model ...
Epoch: 3 cost time: 1.4349682331085205
Epoch: 3, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 4 cost time: 1.5369141101837158
Epoch: 4, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4674088954925537
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.403059959411621
Epoch: 6, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5713062286376953
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.375 Vali Acc: 0.903 Test Loss: 0.375 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5194690227508545
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.401 Vali Acc: 0.903 Test Loss: 0.401 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5084331035614014
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4145572185516357
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4448115825653076
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5240724086761475
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.228426456451416
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 2174300
model size : 10.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.029965400695801
Epoch: 1, Steps: 7 | Train Loss: 2.332 Vali Loss: 1.203 Vali Acc: 0.722 Test Loss: 1.203 Test Acc: 0.722
Validation loss decreased (inf --> -0.722210).  Saving model ...
Epoch: 2 cost time: 1.4030394554138184
Epoch: 2, Steps: 7 | Train Loss: 0.502 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.722210 --> -0.902775).  Saving model ...
Epoch: 3 cost time: 1.2686314582824707
Epoch: 3, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 4 cost time: 1.4600632190704346
Epoch: 4, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.358 Vali Acc: 0.903 Test Loss: 0.358 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5019457340240479
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.357856035232544
Epoch: 6, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 1.3967649936676025
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.396 Vali Acc: 0.903 Test Loss: 0.396 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5865392684936523
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5661242008209229
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4695441722869873
Epoch: 10, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.392 Vali Acc: 0.931 Test Loss: 0.392 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3635904788970947
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.364 Vali Acc: 0.917 Test Loss: 0.364 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.396622657775879
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.903 Test Loss: 0.485 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4951586723327637
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.345 Vali Acc: 0.917 Test Loss: 0.345 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4338109493255615
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.903 Test Loss: 0.517 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.431992769241333
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.436 Vali Acc: 0.903 Test Loss: 0.436 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4297871589660645
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.875 Test Loss: 0.581 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2174300
model size : 10.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.96722674369812
Epoch: 1, Steps: 7 | Train Loss: 2.378 Vali Loss: 1.210 Vali Acc: 0.778 Test Loss: 1.210 Test Acc: 0.778
Validation loss decreased (inf --> -0.777766).  Saving model ...
Epoch: 2 cost time: 1.2842531204223633
Epoch: 2, Steps: 7 | Train Loss: 0.524 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.777766 --> -0.916664).  Saving model ...
Epoch: 3 cost time: 1.2510497570037842
Epoch: 3, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 4 cost time: 1.21441650390625
Epoch: 4, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.390 Vali Acc: 0.889 Test Loss: 0.390 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2084519863128662
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.410 Vali Acc: 0.889 Test Loss: 0.410 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1954798698425293
Epoch: 6, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.465 Vali Acc: 0.889 Test Loss: 0.465 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3671224117279053
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3579704761505127
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.889 Test Loss: 0.607 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0980968475341797
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.875 Test Loss: 0.735 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.326258659362793
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.861 Test Loss: 0.778 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1991636753082275
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.739 Vali Acc: 0.875 Test Loss: 0.739 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2303032875061035
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.889 Test Loss: 0.707 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.18272066116333
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.889 Test Loss: 0.679 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2174300
model size : 10.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8253674507141113
Epoch: 1, Steps: 7 | Train Loss: 2.397 Vali Loss: 1.283 Vali Acc: 0.764 Test Loss: 1.283 Test Acc: 0.764
Validation loss decreased (inf --> -0.763876).  Saving model ...
Epoch: 2 cost time: 1.1777150630950928
Epoch: 2, Steps: 7 | Train Loss: 0.593 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.763876 --> -0.916664).  Saving model ...
Epoch: 3 cost time: 1.0935513973236084
Epoch: 3, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 4 cost time: 1.069596290588379
Epoch: 4, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.503 Vali Acc: 0.889 Test Loss: 0.503 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1992228031158447
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 1.0648596286773682
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958332).  Saving model ...
Epoch: 7 cost time: 1.1875696182250977
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1829700469970703
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0865764617919922
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1187357902526855
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1095333099365234
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.10308837890625
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.25327467918396
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.154177188873291
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.256887674331665
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1286635398864746
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 2174300
model size : 10.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2879209518432617
Epoch: 1, Steps: 7 | Train Loss: 2.378 Vali Loss: 1.165 Vali Acc: 0.736 Test Loss: 1.165 Test Acc: 0.736
Validation loss decreased (inf --> -0.736099).  Saving model ...
Epoch: 2 cost time: 1.4425280094146729
Epoch: 2, Steps: 7 | Train Loss: 0.500 Vali Loss: 0.717 Vali Acc: 0.736 Test Loss: 0.717 Test Acc: 0.736
Validation loss decreased (-0.736099 --> -0.736104).  Saving model ...
Epoch: 3 cost time: 1.406930923461914
Epoch: 3, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.513 Vali Acc: 0.861 Test Loss: 0.513 Test Acc: 0.861
Validation loss decreased (-0.736104 --> -0.861106).  Saving model ...
Epoch: 4 cost time: 1.323577642440796
Epoch: 4, Steps: 7 | Train Loss: 0.178 Vali Loss: 0.697 Vali Acc: 0.903 Test Loss: 0.697 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902771).  Saving model ...
Epoch: 5 cost time: 1.3683114051818848
Epoch: 5, Steps: 7 | Train Loss: 0.109 Vali Loss: 2.033 Vali Acc: 0.792 Test Loss: 2.033 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4063498973846436
Epoch: 6, Steps: 7 | Train Loss: 0.157 Vali Loss: 0.940 Vali Acc: 0.861 Test Loss: 0.940 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.500096082687378
Epoch: 7, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.739 Vali Acc: 0.861 Test Loss: 0.739 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4641401767730713
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.902771 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 1.4427096843719482
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.944 Test Loss: 0.641 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5551910400390625
Epoch: 10, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.598670244216919
Epoch: 11, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.4631831645965576
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.944 Test Loss: 0.369 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5279309749603271
Epoch: 13, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.537 Vali Acc: 0.931 Test Loss: 0.537 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.572601079940796
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.903 Test Loss: 0.504 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5905005931854248
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.344 Vali Acc: 0.944 Test Loss: 0.344 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4405896663665771
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.944 Test Loss: 0.460 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.370086431503296
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.944 Test Loss: 0.448 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5041427612304688
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.931 Test Loss: 0.461 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3137578964233398
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.931 Test Loss: 0.477 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.420252799987793
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.931 Test Loss: 0.485 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4956073760986328
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.931 Test Loss: 0.488 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2043228
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3458237648010254
Epoch: 1, Steps: 7 | Train Loss: 2.373 Vali Loss: 1.154 Vali Acc: 0.750 Test Loss: 1.154 Test Acc: 0.750
Validation loss decreased (inf --> -0.749988).  Saving model ...
Epoch: 2 cost time: 1.3308005332946777
Epoch: 2, Steps: 7 | Train Loss: 0.510 Vali Loss: 0.683 Vali Acc: 0.736 Test Loss: 0.683 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3680810928344727
Epoch: 3, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
Validation loss decreased (-0.749988 --> -0.847217).  Saving model ...
Epoch: 4 cost time: 1.3200528621673584
Epoch: 4, Steps: 7 | Train Loss: 0.183 Vali Loss: 0.627 Vali Acc: 0.903 Test Loss: 0.627 Test Acc: 0.903
Validation loss decreased (-0.847217 --> -0.902772).  Saving model ...
Epoch: 5 cost time: 1.4109647274017334
Epoch: 5, Steps: 7 | Train Loss: 0.144 Vali Loss: 1.644 Vali Acc: 0.792 Test Loss: 1.644 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3403129577636719
Epoch: 6, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.864 Vali Acc: 0.861 Test Loss: 0.864 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4151170253753662
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.702 Vali Acc: 0.903 Test Loss: 0.702 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.440805435180664
Epoch: 8, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.829 Vali Acc: 0.861 Test Loss: 0.829 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3957154750823975
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.931 Test Loss: 0.495 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930551).  Saving model ...
Epoch: 10 cost time: 1.407250165939331
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.317 Vali Acc: 0.931 Test Loss: 0.317 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 1.3194222450256348
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.860 Vali Acc: 0.889 Test Loss: 0.860 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2559034824371338
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.096 Vali Acc: 0.889 Test Loss: 1.096 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3886675834655762
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.245 Vali Acc: 0.889 Test Loss: 1.245 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4429221153259277
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.683 Vali Acc: 0.847 Test Loss: 1.683 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2862920761108398
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.903 Test Loss: 1.007 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.392401933670044
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.917 Test Loss: 0.834 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2977609634399414
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.917 Test Loss: 0.834 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3078217506408691
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.824 Vali Acc: 0.917 Test Loss: 0.824 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3511621952056885
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.815 Vali Acc: 0.917 Test Loss: 0.815 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3587250709533691
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.812 Vali Acc: 0.917 Test Loss: 0.812 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2043228
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.108261823654175
Epoch: 1, Steps: 7 | Train Loss: 2.355 Vali Loss: 1.158 Vali Acc: 0.764 Test Loss: 1.158 Test Acc: 0.764
Validation loss decreased (inf --> -0.763877).  Saving model ...
Epoch: 2 cost time: 1.2284014225006104
Epoch: 2, Steps: 7 | Train Loss: 0.516 Vali Loss: 0.656 Vali Acc: 0.736 Test Loss: 0.656 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.300844430923462
Epoch: 3, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.427 Vali Acc: 0.903 Test Loss: 0.427 Test Acc: 0.903
Validation loss decreased (-0.763877 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 1.1380043029785156
Epoch: 4, Steps: 7 | Train Loss: 0.142 Vali Loss: 0.572 Vali Acc: 0.889 Test Loss: 0.572 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2935149669647217
Epoch: 5, Steps: 7 | Train Loss: 0.089 Vali Loss: 1.072 Vali Acc: 0.847 Test Loss: 1.072 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2635228633880615
Epoch: 6, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.451 Vali Acc: 0.903 Test Loss: 0.451 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3495073318481445
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 1.2998414039611816
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.308 Vali Acc: 0.944 Test Loss: 0.308 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 1.2405939102172852
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.536 Vali Acc: 0.931 Test Loss: 0.536 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.190215826034546
Epoch: 10, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2408223152160645
Epoch: 11, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.1864736080169678
Epoch: 12, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.287109613418579
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 1.229661226272583
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.260617971420288
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2444102764129639
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1175603866577148
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.30729341506958
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2334113121032715
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3018879890441895
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.438633918762207
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.320448398590088
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3140389919281006
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 2043228
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0541324615478516
Epoch: 1, Steps: 7 | Train Loss: 2.329 Vali Loss: 1.187 Vali Acc: 0.806 Test Loss: 1.187 Test Acc: 0.806
Validation loss decreased (inf --> -0.805544).  Saving model ...
Epoch: 2 cost time: 1.1127028465270996
Epoch: 2, Steps: 7 | Train Loss: 0.578 Vali Loss: 0.583 Vali Acc: 0.736 Test Loss: 0.583 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2795097827911377
Epoch: 3, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.466 Vali Acc: 0.889 Test Loss: 0.466 Test Acc: 0.889
Validation loss decreased (-0.805544 --> -0.888884).  Saving model ...
Epoch: 4 cost time: 1.1881935596466064
Epoch: 4, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.800 Vali Acc: 0.889 Test Loss: 0.800 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2403950691223145
Epoch: 5, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.425 Vali Acc: 0.861 Test Loss: 0.425 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1412250995635986
Epoch: 6, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.420 Vali Acc: 0.917 Test Loss: 0.420 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916662).  Saving model ...
Epoch: 7 cost time: 1.1155085563659668
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.616 Vali Acc: 0.917 Test Loss: 0.616 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2947895526885986
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.859 Vali Acc: 0.917 Test Loss: 0.859 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1508252620697021
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.818 Vali Acc: 0.931 Test Loss: 0.818 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930547).  Saving model ...
Epoch: 10 cost time: 1.2608070373535156
Epoch: 10, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.846 Vali Acc: 0.903 Test Loss: 0.846 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3378074169158936
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.745 Vali Acc: 0.903 Test Loss: 0.745 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2719981670379639
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.121 Vali Acc: 0.875 Test Loss: 1.121 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3157157897949219
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.875 Test Loss: 1.236 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.289158821105957
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.159 Vali Acc: 0.889 Test Loss: 1.159 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2669072151184082
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.094 Vali Acc: 0.889 Test Loss: 1.094 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.200537919998169
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.889 Test Loss: 1.055 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.359501600265503
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.029 Vali Acc: 0.889 Test Loss: 1.029 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3821868896484375
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.889 Test Loss: 1.012 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1866588592529297
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.889 Test Loss: 0.997 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2043228
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.991748571395874
Epoch: 1, Steps: 7 | Train Loss: 2.441 Vali Loss: 1.308 Vali Acc: 0.681 Test Loss: 1.308 Test Acc: 0.681
Validation loss decreased (inf --> -0.680542).  Saving model ...
Epoch: 2 cost time: 1.336038589477539
Epoch: 2, Steps: 7 | Train Loss: 0.472 Vali Loss: 0.550 Vali Acc: 0.806 Test Loss: 0.550 Test Acc: 0.806
Validation loss decreased (-0.680542 --> -0.805550).  Saving model ...
Epoch: 3 cost time: 1.2429263591766357
Epoch: 3, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
Validation loss decreased (-0.805550 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 1.2246134281158447
Epoch: 4, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.532 Vali Acc: 0.889 Test Loss: 0.532 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3142290115356445
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.612 Vali Acc: 0.889 Test Loss: 0.612 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3966031074523926
Epoch: 6, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.763 Vali Acc: 0.889 Test Loss: 0.763 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4690017700195312
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.833 Test Loss: 1.042 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3949816226959229
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.903 Test Loss: 0.554 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.422602653503418
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.903 Test Loss: 0.523 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3707444667816162
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.889 Test Loss: 0.532 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4012153148651123
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.903 Test Loss: 0.551 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3893117904663086
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.889 Test Loss: 0.573 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3243045806884766
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.889 Test Loss: 0.583 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1977692
model size : 10.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0707075595855713
Epoch: 1, Steps: 7 | Train Loss: 2.421 Vali Loss: 1.326 Vali Acc: 0.653 Test Loss: 1.326 Test Acc: 0.653
Validation loss decreased (inf --> -0.652765).  Saving model ...
Epoch: 2 cost time: 1.4328820705413818
Epoch: 2, Steps: 7 | Train Loss: 0.473 Vali Loss: 0.551 Vali Acc: 0.806 Test Loss: 0.551 Test Acc: 0.806
Validation loss decreased (-0.652765 --> -0.805550).  Saving model ...
Epoch: 3 cost time: 1.4842760562896729
Epoch: 3, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
Validation loss decreased (-0.805550 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 1.2951219081878662
Epoch: 4, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.512 Vali Acc: 0.889 Test Loss: 0.512 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3271172046661377
Epoch: 5, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.641 Vali Acc: 0.875 Test Loss: 0.641 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.329021692276001
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.889 Test Loss: 0.647 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2620556354522705
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.889 Test Loss: 0.644 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3051812648773193
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.875 Test Loss: 0.638 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4291481971740723
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.875 Test Loss: 0.616 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3514132499694824
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.875 Test Loss: 0.597 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2991023063659668
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.875 Test Loss: 0.578 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3183417320251465
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.889 Test Loss: 0.566 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.191992998123169
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.889 Test Loss: 0.549 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1977692
model size : 10.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1261608600616455
Epoch: 1, Steps: 7 | Train Loss: 2.391 Vali Loss: 1.328 Vali Acc: 0.694 Test Loss: 1.328 Test Acc: 0.694
Validation loss decreased (inf --> -0.694431).  Saving model ...
Epoch: 2 cost time: 1.2259900569915771
Epoch: 2, Steps: 7 | Train Loss: 0.495 Vali Loss: 0.542 Vali Acc: 0.819 Test Loss: 0.542 Test Acc: 0.819
Validation loss decreased (-0.694431 --> -0.819439).  Saving model ...
Epoch: 3 cost time: 1.31266450881958
Epoch: 3, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.422 Vali Acc: 0.889 Test Loss: 0.422 Test Acc: 0.889
Validation loss decreased (-0.819439 --> -0.888885).  Saving model ...
Epoch: 4 cost time: 1.2870886325836182
Epoch: 4, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.580 Vali Acc: 0.903 Test Loss: 0.580 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902772).  Saving model ...
Epoch: 5 cost time: 1.285536289215088
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.664 Vali Acc: 0.903 Test Loss: 0.664 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1303229331970215
Epoch: 6, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.551 Vali Acc: 0.903 Test Loss: 0.551 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 7 cost time: 1.150407314300537
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.889 Test Loss: 0.517 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1398611068725586
Epoch: 8, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.503 Vali Acc: 0.903 Test Loss: 0.503 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 1.1565451622009277
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.395 Vali Acc: 0.931 Test Loss: 0.395 Test Acc: 0.931
Validation loss decreased (-0.902773 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 1.3989956378936768
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.917 Test Loss: 0.417 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.280980110168457
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.903 Test Loss: 0.464 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2262930870056152
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.903 Test Loss: 0.498 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2721943855285645
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.903 Test Loss: 0.513 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3408455848693848
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.903 Test Loss: 0.520 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4064843654632568
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.903 Test Loss: 0.522 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3213403224945068
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.903 Test Loss: 0.520 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4010562896728516
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.903 Test Loss: 0.517 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4389376640319824
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.903 Test Loss: 0.512 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4700334072113037
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.903 Test Loss: 0.508 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1977692
model size : 10.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.882025718688965
Epoch: 1, Steps: 7 | Train Loss: 2.387 Vali Loss: 1.339 Vali Acc: 0.694 Test Loss: 1.339 Test Acc: 0.694
Validation loss decreased (inf --> -0.694431).  Saving model ...
Epoch: 2 cost time: 1.2130448818206787
Epoch: 2, Steps: 7 | Train Loss: 0.551 Vali Loss: 0.479 Vali Acc: 0.819 Test Loss: 0.479 Test Acc: 0.819
Validation loss decreased (-0.694431 --> -0.819440).  Saving model ...
Epoch: 3 cost time: 1.1941826343536377
Epoch: 3, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.819440 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 1.2523841857910156
Epoch: 4, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.785 Vali Acc: 0.875 Test Loss: 0.785 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0664429664611816
Epoch: 5, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.354 Vali Acc: 0.931 Test Loss: 0.354 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 1.1796236038208008
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.382 Vali Acc: 0.917 Test Loss: 0.382 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1856505870819092
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.917 Test Loss: 0.410 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1628336906433105
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.440 Vali Acc: 0.917 Test Loss: 0.440 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0523502826690674
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.917 Test Loss: 0.466 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1084167957305908
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.917 Test Loss: 0.483 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0178899765014648
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.917 Test Loss: 0.488 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1406917572021484
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.917 Test Loss: 0.490 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0803487300872803
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.917 Test Loss: 0.489 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0673713684082031
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.917 Test Loss: 0.489 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0780560970306396
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.917 Test Loss: 0.487 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1977692
model size : 10.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3195126056671143
Epoch: 1, Steps: 7 | Train Loss: 2.327 Vali Loss: 1.154 Vali Acc: 0.764 Test Loss: 1.154 Test Acc: 0.764
Validation loss decreased (inf --> -0.763877).  Saving model ...
Epoch: 2 cost time: 1.466599464416504
Epoch: 2, Steps: 7 | Train Loss: 0.483 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
Validation loss decreased (-0.763877 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 1.4476983547210693
Epoch: 3, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.577 Vali Acc: 0.875 Test Loss: 0.577 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6295115947723389
Epoch: 4, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.947 Vali Acc: 0.819 Test Loss: 0.947 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6033790111541748
Epoch: 5, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.750 Vali Acc: 0.889 Test Loss: 0.750 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888881).  Saving model ...
Epoch: 6 cost time: 1.5546045303344727
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.917 Test Loss: 0.472 Test Acc: 0.917
Validation loss decreased (-0.888881 --> -0.916662).  Saving model ...
Epoch: 7 cost time: 1.3011674880981445
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.457 Vali Acc: 0.931 Test Loss: 0.457 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930551).  Saving model ...
Epoch: 8 cost time: 1.4148974418640137
Epoch: 8, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.741 Vali Acc: 0.875 Test Loss: 0.741 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5370407104492188
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.847 Test Loss: 1.409 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5858020782470703
Epoch: 10, Steps: 7 | Train Loss: 0.045 Vali Loss: 1.361 Vali Acc: 0.847 Test Loss: 1.361 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4249284267425537
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.867 Vali Acc: 0.861 Test Loss: 0.867 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4583852291107178
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.166 Vali Acc: 0.875 Test Loss: 1.166 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4440343379974365
Epoch: 13, Steps: 7 | Train Loss: 0.033 Vali Loss: 1.824 Vali Acc: 0.819 Test Loss: 1.824 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4807260036468506
Epoch: 14, Steps: 7 | Train Loss: 0.021 Vali Loss: 3.840 Vali Acc: 0.750 Test Loss: 3.840 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5544116497039795
Epoch: 15, Steps: 7 | Train Loss: 0.225 Vali Loss: 0.635 Vali Acc: 0.931 Test Loss: 0.635 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5941181182861328
Epoch: 16, Steps: 7 | Train Loss: 0.062 Vali Loss: 2.160 Vali Acc: 0.833 Test Loss: 2.160 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6002721786499023
Epoch: 17, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.597 Vali Acc: 0.889 Test Loss: 0.597 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1944924
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4047985076904297
Epoch: 1, Steps: 7 | Train Loss: 2.332 Vali Loss: 1.176 Vali Acc: 0.736 Test Loss: 1.176 Test Acc: 0.736
Validation loss decreased (inf --> -0.736099).  Saving model ...
Epoch: 2 cost time: 1.4469480514526367
Epoch: 2, Steps: 7 | Train Loss: 0.508 Vali Loss: 0.355 Vali Acc: 0.861 Test Loss: 0.355 Test Acc: 0.861
Validation loss decreased (-0.736099 --> -0.861108).  Saving model ...
Epoch: 3 cost time: 1.3999016284942627
Epoch: 3, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.625 Vali Acc: 0.889 Test Loss: 0.625 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888883).  Saving model ...
Epoch: 4 cost time: 1.4756579399108887
Epoch: 4, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.990 Vali Acc: 0.833 Test Loss: 0.990 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4871470928192139
Epoch: 5, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.789 Vali Acc: 0.889 Test Loss: 0.789 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.313985824584961
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.917 Test Loss: 0.529 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916661).  Saving model ...
Epoch: 7 cost time: 1.290273666381836
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.944 Test Loss: 0.481 Test Acc: 0.944
Validation loss decreased (-0.916661 --> -0.944440).  Saving model ...
Epoch: 8 cost time: 1.3380577564239502
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.944 Test Loss: 0.489 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3735508918762207
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.944 Test Loss: 0.489 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3699431419372559
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.944 Test Loss: 0.481 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 11 cost time: 1.486485242843628
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.944 Test Loss: 0.480 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 12 cost time: 1.6114370822906494
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.944 Test Loss: 0.478 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 13 cost time: 1.324042558670044
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.944 Test Loss: 0.476 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 14 cost time: 1.2789170742034912
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.944 Test Loss: 0.474 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 15 cost time: 1.2605633735656738
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.944 Test Loss: 0.473 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 16 cost time: 1.4566640853881836
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.944 Test Loss: 0.472 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 17 cost time: 1.3039357662200928
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.944 Test Loss: 0.471 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 18 cost time: 1.4331138134002686
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.944 Test Loss: 0.475 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3088045120239258
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.944 Test Loss: 0.470 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 20 cost time: 1.3675172328948975
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.944 Test Loss: 0.474 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4361138343811035
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.944 Test Loss: 0.474 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3898401260375977
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.944 Test Loss: 0.473 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4315249919891357
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.944 Test Loss: 0.473 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4137959480285645
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.944 Test Loss: 0.473 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3052470684051514
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.944 Test Loss: 0.473 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3359334468841553
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.944 Test Loss: 0.473 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3442456722259521
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.944 Test Loss: 0.472 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.410060167312622
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.944 Test Loss: 0.472 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4581258296966553
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.944 Test Loss: 0.472 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1944924
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2181620597839355
Epoch: 1, Steps: 7 | Train Loss: 2.339 Vali Loss: 1.201 Vali Acc: 0.722 Test Loss: 1.201 Test Acc: 0.722
Validation loss decreased (inf --> -0.722210).  Saving model ...
Epoch: 2 cost time: 1.1867482662200928
Epoch: 2, Steps: 7 | Train Loss: 0.541 Vali Loss: 0.279 Vali Acc: 0.875 Test Loss: 0.279 Test Acc: 0.875
Validation loss decreased (-0.722210 --> -0.874997).  Saving model ...
Epoch: 3 cost time: 1.3454010486602783
Epoch: 3, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.700 Vali Acc: 0.875 Test Loss: 0.700 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2091450691223145
Epoch: 4, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.649 Vali Acc: 0.875 Test Loss: 0.649 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.248164415359497
Epoch: 5, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.671 Vali Acc: 0.917 Test Loss: 0.671 Test Acc: 0.917
Validation loss decreased (-0.874997 --> -0.916660).  Saving model ...
Epoch: 6 cost time: 1.2090213298797607
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.917 Test Loss: 0.477 Test Acc: 0.917
Validation loss decreased (-0.916660 --> -0.916662).  Saving model ...
Epoch: 7 cost time: 1.2281672954559326
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.917 Test Loss: 0.484 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1494355201721191
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.903 Test Loss: 0.520 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1475498676300049
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.917 Test Loss: 0.519 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3701679706573486
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.917 Test Loss: 0.465 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 11 cost time: 1.3384971618652344
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.442 Vali Acc: 0.917 Test Loss: 0.442 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 12 cost time: 1.342200756072998
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.917 Test Loss: 0.435 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 13 cost time: 1.388014554977417
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.917 Test Loss: 0.431 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 14 cost time: 1.2188692092895508
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.917 Test Loss: 0.429 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 15 cost time: 1.3035180568695068
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.917 Test Loss: 0.428 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 16 cost time: 1.4334213733673096
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.917 Test Loss: 0.428 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 17 cost time: 1.2908134460449219
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.917 Test Loss: 0.428 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 18 cost time: 1.4081575870513916
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.917 Test Loss: 0.428 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3023996353149414
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.917 Test Loss: 0.428 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.330932378768921
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.917 Test Loss: 0.429 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2021865844726562
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.917 Test Loss: 0.428 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.276808738708496
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.917 Test Loss: 0.428 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.270616054534912
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.917 Test Loss: 0.428 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1446855068206787
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.917 Test Loss: 0.428 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4832377433776855
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.917 Test Loss: 0.429 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3638768196105957
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.917 Test Loss: 0.429 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3475968837738037
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.917 Test Loss: 0.429 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1944924
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.088245391845703
Epoch: 1, Steps: 7 | Train Loss: 2.348 Vali Loss: 1.234 Vali Acc: 0.722 Test Loss: 1.234 Test Acc: 0.722
Validation loss decreased (inf --> -0.722210).  Saving model ...
Epoch: 2 cost time: 1.1446876525878906
Epoch: 2, Steps: 7 | Train Loss: 0.619 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.722210 --> -0.930553).  Saving model ...
Epoch: 3 cost time: 1.123795747756958
Epoch: 3, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.462 Vali Acc: 0.889 Test Loss: 0.462 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2074830532073975
Epoch: 4, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.502 Vali Acc: 0.903 Test Loss: 0.502 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1962358951568604
Epoch: 5, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.624 Vali Acc: 0.875 Test Loss: 0.624 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.269258737564087
Epoch: 6, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.429 Vali Acc: 0.917 Test Loss: 0.429 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1988816261291504
Epoch: 7, Steps: 7 | Train Loss: 0.091 Vali Loss: 1.078 Vali Acc: 0.875 Test Loss: 1.078 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2720184326171875
Epoch: 8, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.824 Vali Acc: 0.847 Test Loss: 0.824 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1627724170684814
Epoch: 9, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.364 Vali Acc: 0.931 Test Loss: 0.364 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1292750835418701
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.389 Vali Acc: 0.931 Test Loss: 0.389 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1620643138885498
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.875 Test Loss: 0.617 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1503164768218994
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.894 Vali Acc: 0.875 Test Loss: 0.894 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1944924
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1890993118286133
Epoch: 1, Steps: 7 | Train Loss: 2.497 Vali Loss: 1.730 Vali Acc: 0.639 Test Loss: 1.730 Test Acc: 0.639
Validation loss decreased (inf --> -0.638872).  Saving model ...
Epoch: 2 cost time: 1.3117473125457764
Epoch: 2, Steps: 7 | Train Loss: 0.877 Vali Loss: 0.477 Vali Acc: 0.861 Test Loss: 0.477 Test Acc: 0.861
Validation loss decreased (-0.638872 --> -0.861106).  Saving model ...
Epoch: 3 cost time: 1.281236171722412
Epoch: 3, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874997).  Saving model ...
Epoch: 4 cost time: 1.2387216091156006
Epoch: 4, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 1.139451026916504
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.474 Vali Acc: 0.875 Test Loss: 0.474 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.188774585723877
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.454 Vali Acc: 0.889 Test Loss: 0.454 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3002939224243164
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.861 Test Loss: 0.435 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.322209358215332
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.404 Vali Acc: 0.889 Test Loss: 0.404 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.217271327972412
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.903 Test Loss: 0.383 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2618999481201172
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.903 Test Loss: 0.369 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1644587516784668
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.360 Vali Acc: 0.917 Test Loss: 0.360 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 1.2754321098327637
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.354 Vali Acc: 0.917 Test Loss: 0.354 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 1.3261539936065674
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.352 Vali Acc: 0.917 Test Loss: 0.352 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 1.3628993034362793
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 1.2009830474853516
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 1.2545294761657715
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 1.178060531616211
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 18 cost time: 1.2310383319854736
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 19 cost time: 1.3192431926727295
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 1.2752110958099365
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 21 cost time: 1.2407658100128174
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 22 cost time: 1.2107305526733398
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 23 cost time: 1.1828696727752686
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 24 cost time: 1.2730038166046143
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 25 cost time: 1.268425464630127
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 1.3385560512542725
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 27 cost time: 1.3042106628417969
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 28 cost time: 1.280897855758667
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.2331643104553223
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.3078980445861816
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.248013973236084
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.342320442199707
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 1.4010350704193115
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.408975601196289
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2717688083648682
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4202299118041992
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 1.3820350170135498
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 1.3082807064056396
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 1.1199982166290283
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 1.2040605545043945
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 1.282376766204834
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 1.1162517070770264
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 1.138598918914795
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 1.1416845321655273
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 1.3529610633850098
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 1.388970136642456
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 1.25364351272583
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 1.3604238033294678
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 1.4768331050872803
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 1.267404317855835
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.4130496978759766
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.4162263870239258
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 1.2893345355987549
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 1.2024872303009033
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 1.1905949115753174
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 1.1622960567474365
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 1.332876443862915
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 1.296586513519287
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 1.1402268409729004
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.1841535568237305
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.1806597709655762
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.1473307609558105
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 63 cost time: 1.2440614700317383
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 1.2503423690795898
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.2010242938995361
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 1.2516655921936035
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 1.2442553043365479
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 1.210090160369873
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.178313970565796
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 1.279092788696289
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 1.1374943256378174
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.225708246231079
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.1116082668304443
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.249488115310669
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.3167831897735596
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.3043179512023926
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.1668174266815186
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 1.2991013526916504
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 1.2938053607940674
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 1.3360188007354736
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 81 cost time: 1.21944260597229
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.2608981132507324
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.3601410388946533
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.3028814792633057
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.2189176082611084
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 1.2820556163787842
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 1.1318745613098145
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 88 cost time: 1.2455248832702637
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.3501782417297363
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 90 cost time: 1.3370823860168457
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 91 cost time: 1.1839544773101807
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 92 cost time: 1.1938276290893555
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 93 cost time: 1.2625386714935303
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 94 cost time: 1.4675686359405518
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 95 cost time: 1.3573193550109863
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 96 cost time: 1.140883207321167
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.342782974243164
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 1.2439475059509277
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 1.2121286392211914
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 1.1265909671783447
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1464028
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.958298444747925
Epoch: 1, Steps: 7 | Train Loss: 2.499 Vali Loss: 1.690 Vali Acc: 0.667 Test Loss: 1.690 Test Acc: 0.667
Validation loss decreased (inf --> -0.666650).  Saving model ...
Epoch: 2 cost time: 1.3262434005737305
Epoch: 2, Steps: 7 | Train Loss: 0.888 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
Validation loss decreased (-0.666650 --> -0.874995).  Saving model ...
Epoch: 3 cost time: 1.3070626258850098
Epoch: 3, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.340 Vali Acc: 0.847 Test Loss: 0.340 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.242565631866455
Epoch: 4, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.874995 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 1.2892577648162842
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.439 Vali Acc: 0.861 Test Loss: 0.439 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2831971645355225
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2450616359710693
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.317275047302246
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.375 Vali Acc: 0.903 Test Loss: 0.375 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2354671955108643
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2440428733825684
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1788597106933594
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.0469286441802979
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.2451324462890625
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.924288272857666
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.2720987796783447
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.268911600112915
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.1291463375091553
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.2257428169250488
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.216784954071045
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.176384687423706
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1236786842346191
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.3071134090423584
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.2803730964660645
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 1.2377536296844482
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.0916705131530762
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.2036957740783691
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.1031150817871094
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.213007926940918
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.1903235912322998
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.2044470310211182
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.1397383213043213
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.2360050678253174
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 1.1011085510253906
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.3465187549591064
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3452155590057373
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 1.2806103229522705
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2080607414245605
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 1.3786699771881104
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 1.1605138778686523
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2872519493103027
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 1.220815896987915
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 1.250727653503418
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2549264430999756
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 1.2011959552764893
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.998114824295044
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 1.1623568534851074
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 1.1683547496795654
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 1.2438170909881592
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 1.2084290981292725
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 1.2041082382202148
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.161466121673584
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 1.2951714992523193
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 1.311340570449829
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 1.3128902912139893
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 1.1568095684051514
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2456879615783691
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1594972610473633
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 1.3874523639678955
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.3045406341552734
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.30710768699646
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.2562065124511719
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.171010971069336
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.3367352485656738
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 1.328115701675415
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 1.2598974704742432
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 1.252638339996338
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 1.2561852931976318
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 1.1025612354278564
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 1.1944727897644043
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 1.201688528060913
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 1.3025016784667969
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.4168250560760498
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.2927324771881104
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.2200610637664795
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.2690982818603516
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 76 cost time: 1.4073340892791748
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.1988615989685059
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.2835001945495605
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.209747314453125
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.3635706901550293
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 81 cost time: 1.3702058792114258
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 82 cost time: 1.376678228378296
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 83 cost time: 1.38149094581604
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.5475027561187744
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 85 cost time: 1.3969874382019043
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.3687520027160645
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.270298957824707
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 1.3222215175628662
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 1.0669682025909424
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 90 cost time: 0.9641385078430176
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 1.106863021850586
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 92 cost time: 0.9134392738342285
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 93 cost time: 1.0166676044464111
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.000331163406372
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 95 cost time: 0.9299273490905762
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 96 cost time: 1.027040719985962
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.0164318084716797
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 1.1251802444458008
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 99 cost time: 1.072509765625
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.0816118717193604
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1464028
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0213770866394043
Epoch: 1, Steps: 7 | Train Loss: 2.472 Vali Loss: 1.651 Vali Acc: 0.750 Test Loss: 1.651 Test Acc: 0.750
Validation loss decreased (inf --> -0.749983).  Saving model ...
Epoch: 2 cost time: 1.1140966415405273
Epoch: 2, Steps: 7 | Train Loss: 0.923 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.749983 --> -0.874995).  Saving model ...
Epoch: 3 cost time: 1.2476768493652344
Epoch: 3, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.362 Vali Acc: 0.847 Test Loss: 0.362 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2058119773864746
Epoch: 4, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 5 cost time: 0.9891605377197266
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.16109037399292
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 1.0107591152191162
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.0140728950500488
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.0386829376220703
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.0871105194091797
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0332555770874023
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0580205917358398
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1081786155700684
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0197739601135254
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1074440479278564
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1822915077209473
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.158616542816162
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9910545349121094
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.1761407852172852
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.0759949684143066
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.103006362915039
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.2015461921691895
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.164597749710083
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0254592895507812
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0464651584625244
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.155308723449707
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.2332022190093994
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 1.2647814750671387
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 1.2105894088745117
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 1.2829539775848389
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1989266872406006
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.265336275100708
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.156864881515503
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.079864501953125
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1849136352539062
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 1.1947519779205322
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1831679344177246
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2665605545043945
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2123405933380127
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 1.1513636112213135
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 1.1668415069580078
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.261714220046997
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.276559829711914
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0652461051940918
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 1.1426434516906738
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 1.0740375518798828
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 1.2119083404541016
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 1.103114128112793
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2000665664672852
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.2248382568359375
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.2524659633636475
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.2130486965179443
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 53 cost time: 1.1949164867401123
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 54 cost time: 1.17787766456604
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 55 cost time: 1.0593550205230713
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 56 cost time: 1.1733391284942627
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1193749904632568
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.1812071800231934
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.9957811832427979
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.218034029006958
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.9927124977111816
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.1368677616119385
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 63 cost time: 1.1599929332733154
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.125514268875122
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.1025080680847168
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.1404294967651367
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.0904569625854492
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.0957775115966797
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.1698675155639648
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.1121711730957031
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.1976447105407715
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 1.2027208805084229
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1464028
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8986198902130127
Epoch: 1, Steps: 7 | Train Loss: 2.430 Vali Loss: 1.659 Vali Acc: 0.708 Test Loss: 1.659 Test Acc: 0.708
Validation loss decreased (inf --> -0.708317).  Saving model ...
Epoch: 2 cost time: 1.1403045654296875
Epoch: 2, Steps: 7 | Train Loss: 1.032 Vali Loss: 0.569 Vali Acc: 0.875 Test Loss: 0.569 Test Acc: 0.875
Validation loss decreased (-0.708317 --> -0.874994).  Saving model ...
Epoch: 3 cost time: 1.3401589393615723
Epoch: 3, Steps: 7 | Train Loss: 0.208 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874997).  Saving model ...
Epoch: 4 cost time: 1.0491909980773926
Epoch: 4, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 1.1542613506317139
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 6 cost time: 1.1530122756958008
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.902775 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 1.247086763381958
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958332).  Saving model ...
Epoch: 8 cost time: 1.2200539112091064
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1827118396759033
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.057321548461914
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0725243091583252
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.150822401046753
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0798776149749756
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2523119449615479
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2974879741668701
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1825833320617676
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2758204936981201
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1464028
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2096028327941895
Epoch: 1, Steps: 7 | Train Loss: 2.386 Vali Loss: 1.557 Vali Acc: 0.681 Test Loss: 1.557 Test Acc: 0.681
Validation loss decreased (inf --> -0.680540).  Saving model ...
Epoch: 2 cost time: 1.168391227722168
Epoch: 2, Steps: 7 | Train Loss: 0.890 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
Validation loss decreased (-0.680540 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 1.3086025714874268
Epoch: 3, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.435 Vali Acc: 0.833 Test Loss: 0.435 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.133533239364624
Epoch: 4, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 1.2173950672149658
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1974637508392334
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 1.3157727718353271
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2613325119018555
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.312652587890625
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.378 Vali Acc: 0.903 Test Loss: 0.378 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2409119606018066
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1676340103149414
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2402329444885254
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2478253841400146
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0546181201934814
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1679675579071045
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.903 Test Loss: 0.335 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1122243404388428
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1201884
model size : 5.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.97137451171875
Epoch: 1, Steps: 7 | Train Loss: 2.371 Vali Loss: 1.554 Vali Acc: 0.778 Test Loss: 1.554 Test Acc: 0.778
Validation loss decreased (inf --> -0.777762).  Saving model ...
Epoch: 2 cost time: 1.118375301361084
Epoch: 2, Steps: 7 | Train Loss: 0.885 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
Validation loss decreased (-0.777762 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 1.1702539920806885
Epoch: 3, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.423 Vali Acc: 0.833 Test Loss: 0.423 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.161813735961914
Epoch: 4, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 1.0914137363433838
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1120216846466064
Epoch: 6, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2726902961730957
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2067756652832031
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.099379301071167
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2694556713104248
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.356 Vali Acc: 0.903 Test Loss: 0.356 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2085905075073242
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.345 Vali Acc: 0.903 Test Loss: 0.345 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1907813549041748
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2099881172180176
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2101120948791504
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1201884
model size : 5.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8048031330108643
Epoch: 1, Steps: 7 | Train Loss: 2.327 Vali Loss: 1.541 Vali Acc: 0.792 Test Loss: 1.541 Test Acc: 0.792
Validation loss decreased (inf --> -0.791651).  Saving model ...
Epoch: 2 cost time: 1.0896098613739014
Epoch: 2, Steps: 7 | Train Loss: 0.899 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
Validation loss decreased (-0.791651 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 1.0022261142730713
Epoch: 3, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.400 Vali Acc: 0.833 Test Loss: 0.400 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1433091163635254
Epoch: 4, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.874996 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 1.0852890014648438
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.332 Vali Acc: 0.889 Test Loss: 0.332 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.176743745803833
Epoch: 6, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1452319622039795
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.058912754058838
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9878482818603516
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.861 Test Loss: 0.384 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1015610694885254
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.861 Test Loss: 0.402 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8373463153839111
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1202754974365234
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.193221092224121
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1654095649719238
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.389 Vali Acc: 0.889 Test Loss: 0.389 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1201884
model size : 5.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.194309949874878
Epoch: 1, Steps: 7 | Train Loss: 2.338 Vali Loss: 1.596 Vali Acc: 0.778 Test Loss: 1.596 Test Acc: 0.778
Validation loss decreased (inf --> -0.777762).  Saving model ...
Epoch: 2 cost time: 1.08394455909729
Epoch: 2, Steps: 7 | Train Loss: 0.985 Vali Loss: 0.441 Vali Acc: 0.889 Test Loss: 0.441 Test Acc: 0.889
Validation loss decreased (-0.777762 --> -0.888884).  Saving model ...
Epoch: 3 cost time: 1.0804290771484375
Epoch: 3, Steps: 7 | Train Loss: 0.207 Vali Loss: 0.354 Vali Acc: 0.861 Test Loss: 0.354 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0438945293426514
Epoch: 4, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 1.1254825592041016
Epoch: 5, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9800541400909424
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9070498943328857
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0085959434509277
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0857014656066895
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.9552240371704102
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.081507682800293
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.150611400604248
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1029090881347656
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.227447748184204
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.200695514678955
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1049280166625977
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2046587467193604
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2385857105255127
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0256662368774414
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1639254093170166
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0331096649169922
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1201884
model size : 5.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.78136944770813
Epoch: 1, Steps: 7 | Train Loss: 2.429 Vali Loss: 1.577 Vali Acc: 0.681 Test Loss: 1.577 Test Acc: 0.681
Validation loss decreased (inf --> -0.680540).  Saving model ...
Epoch: 2 cost time: 0.9799072742462158
Epoch: 2, Steps: 7 | Train Loss: 0.945 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
Validation loss decreased (-0.680540 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 1.2175438404083252
Epoch: 3, Steps: 7 | Train Loss: 0.157 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 4 cost time: 1.1383740901947021
Epoch: 4, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 1.0537114143371582
Epoch: 5, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1841206550598145
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0235953330993652
Epoch: 7, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0312893390655518
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0876224040985107
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1146464347839355
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1098804473876953
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.931 Test Loss: 0.297 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.1478519439697266
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.268726110458374
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2368884086608887
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.302 Vali Acc: 0.931 Test Loss: 0.302 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3460626602172852
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.302 Vali Acc: 0.931 Test Loss: 0.302 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.215719223022461
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1734507083892822
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1880652904510498
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.234313726425171
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1712913513183594
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2386391162872314
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1070812
model size : 5.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8876044750213623
Epoch: 1, Steps: 7 | Train Loss: 2.402 Vali Loss: 1.593 Vali Acc: 0.681 Test Loss: 1.593 Test Acc: 0.681
Validation loss decreased (inf --> -0.680540).  Saving model ...
Epoch: 2 cost time: 1.1137292385101318
Epoch: 2, Steps: 7 | Train Loss: 0.954 Vali Loss: 0.418 Vali Acc: 0.847 Test Loss: 0.418 Test Acc: 0.847
Validation loss decreased (-0.680540 --> -0.847218).  Saving model ...
Epoch: 3 cost time: 1.155491590499878
Epoch: 3, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
Validation loss decreased (-0.847218 --> -0.888885).  Saving model ...
Epoch: 4 cost time: 1.125906229019165
Epoch: 4, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.888885 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 1.1767621040344238
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1386151313781738
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.889 Test Loss: 0.382 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1789686679840088
Epoch: 7, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1584289073944092
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1426146030426025
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1769554615020752
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1653456687927246
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.861 Test Loss: 0.408 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1138014793395996
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2682836055755615
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.140944242477417
Epoch: 14, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1070812
model size : 5.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8697519302368164
Epoch: 1, Steps: 7 | Train Loss: 2.390 Vali Loss: 1.597 Vali Acc: 0.736 Test Loss: 1.597 Test Acc: 0.736
Validation loss decreased (inf --> -0.736095).  Saving model ...
Epoch: 2 cost time: 1.180687427520752
Epoch: 2, Steps: 7 | Train Loss: 0.964 Vali Loss: 0.430 Vali Acc: 0.861 Test Loss: 0.430 Test Acc: 0.861
Validation loss decreased (-0.736095 --> -0.861107).  Saving model ...
Epoch: 3 cost time: 1.0926182270050049
Epoch: 3, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 4 cost time: 1.1898269653320312
Epoch: 4, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 1.2300310134887695
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.386 Vali Acc: 0.889 Test Loss: 0.386 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0349810123443604
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.382 Vali Acc: 0.889 Test Loss: 0.382 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1169748306274414
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1139135360717773
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.989020586013794
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9448606967926025
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.994835615158081
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.094111680984497
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0592577457427979
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9582505226135254
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1070812
model size : 5.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.897529125213623
Epoch: 1, Steps: 7 | Train Loss: 2.355 Vali Loss: 1.652 Vali Acc: 0.694 Test Loss: 1.652 Test Acc: 0.694
Validation loss decreased (inf --> -0.694428).  Saving model ...
Epoch: 2 cost time: 0.9227466583251953
Epoch: 2, Steps: 7 | Train Loss: 1.053 Vali Loss: 0.475 Vali Acc: 0.875 Test Loss: 0.475 Test Acc: 0.875
Validation loss decreased (-0.694428 --> -0.874995).  Saving model ...
Epoch: 3 cost time: 1.02091646194458
Epoch: 3, Steps: 7 | Train Loss: 0.204 Vali Loss: 0.328 Vali Acc: 0.917 Test Loss: 0.328 Test Acc: 0.917
Validation loss decreased (-0.874995 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 0.8995957374572754
Epoch: 4, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0145325660705566
Epoch: 5, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 0.9052579402923584
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 0.9605097770690918
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8897016048431396
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9750521183013916
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9405336380004883
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.020836591720581
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.026643991470337
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9812314510345459
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0551037788391113
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9862995147705078
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9570951461791992
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1070812
model size : 5.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0182313919067383
Epoch: 1, Steps: 7 | Train Loss: 2.391 Vali Loss: 1.603 Vali Acc: 0.694 Test Loss: 1.603 Test Acc: 0.694
Validation loss decreased (inf --> -0.694428).  Saving model ...
Epoch: 2 cost time: 1.3676097393035889
Epoch: 2, Steps: 7 | Train Loss: 0.762 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
Validation loss decreased (-0.694428 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 1.3164212703704834
Epoch: 3, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 1.2470531463623047
Epoch: 4, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.20591139793396
Epoch: 5, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.423 Vali Acc: 0.889 Test Loss: 0.423 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2729227542877197
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.382 Vali Acc: 0.917 Test Loss: 0.382 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.2483155727386475
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.903 Test Loss: 0.442 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.223207950592041
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.889 Test Loss: 0.525 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.242722511291504
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.421 Vali Acc: 0.903 Test Loss: 0.421 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2176296710968018
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 1.2078158855438232
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.368 Vali Acc: 0.917 Test Loss: 0.368 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2367374897003174
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.917 Test Loss: 0.410 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2440080642700195
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.903 Test Loss: 0.475 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3464198112487793
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.903 Test Loss: 0.461 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2984154224395752
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.903 Test Loss: 0.429 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3121285438537598
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.903 Test Loss: 0.407 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1945781707763672
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.903 Test Loss: 0.394 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1390583515167236
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.386 Vali Acc: 0.903 Test Loss: 0.386 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0966463088989258
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.380 Vali Acc: 0.903 Test Loss: 0.380 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.166177749633789
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.375 Vali Acc: 0.903 Test Loss: 0.375 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1005276
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.936582565307617
Epoch: 1, Steps: 7 | Train Loss: 2.411 Vali Loss: 1.608 Vali Acc: 0.736 Test Loss: 1.608 Test Acc: 0.736
Validation loss decreased (inf --> -0.736095).  Saving model ...
Epoch: 2 cost time: 1.2248039245605469
Epoch: 2, Steps: 7 | Train Loss: 0.776 Vali Loss: 0.360 Vali Acc: 0.861 Test Loss: 0.360 Test Acc: 0.861
Validation loss decreased (-0.736095 --> -0.861108).  Saving model ...
Epoch: 3 cost time: 1.14457368850708
Epoch: 3, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 1.2014353275299072
Epoch: 4, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2122323513031006
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.405 Vali Acc: 0.889 Test Loss: 0.405 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.212224006652832
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.353 Vali Acc: 0.917 Test Loss: 0.353 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.0944254398345947
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.903 Test Loss: 0.419 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0823643207550049
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0532104969024658
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.406 Vali Acc: 0.903 Test Loss: 0.406 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0262982845306396
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0329229831695557
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.358 Vali Acc: 0.903 Test Loss: 0.358 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0943429470062256
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.903 Test Loss: 0.414 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1214756965637207
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.875 Test Loss: 0.480 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1975083351135254
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.427 Vali Acc: 0.889 Test Loss: 0.427 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1887025833129883
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.255422592163086
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.378 Vali Acc: 0.889 Test Loss: 0.378 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1005276
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7206871509552
Epoch: 1, Steps: 7 | Train Loss: 2.427 Vali Loss: 1.639 Vali Acc: 0.694 Test Loss: 1.639 Test Acc: 0.694
Validation loss decreased (inf --> -0.694428).  Saving model ...
Epoch: 2 cost time: 0.9718484878540039
Epoch: 2, Steps: 7 | Train Loss: 0.823 Vali Loss: 0.379 Vali Acc: 0.861 Test Loss: 0.379 Test Acc: 0.861
Validation loss decreased (-0.694428 --> -0.861107).  Saving model ...
Epoch: 3 cost time: 1.0506908893585205
Epoch: 3, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 4 cost time: 1.0211551189422607
Epoch: 4, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
Validation loss decreased (-0.861108 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 1.0452356338500977
Epoch: 5, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0181474685668945
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 1.1754555702209473
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0829570293426514
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.192380666732788
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0722668170928955
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.0923914909362793
Epoch: 11, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0410516262054443
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.861 Test Loss: 0.668 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1499030590057373
Epoch: 13, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0696687698364258
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0802888870239258
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0679380893707275
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2549266815185547
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0923373699188232
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1286070346832275
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9698565006256104
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1005276
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8111791610717773
Epoch: 1, Steps: 7 | Train Loss: 2.400 Vali Loss: 1.704 Vali Acc: 0.694 Test Loss: 1.704 Test Acc: 0.694
Validation loss decreased (inf --> -0.694427).  Saving model ...
Epoch: 2 cost time: 1.088453769683838
Epoch: 2, Steps: 7 | Train Loss: 0.921 Vali Loss: 0.428 Vali Acc: 0.861 Test Loss: 0.428 Test Acc: 0.861
Validation loss decreased (-0.694427 --> -0.861107).  Saving model ...
Epoch: 3 cost time: 1.0816199779510498
Epoch: 3, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 0.9932665824890137
Epoch: 4, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.202 Vali Acc: 0.903 Test Loss: 0.202 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902776).  Saving model ...
Epoch: 5 cost time: 1.1107535362243652
Epoch: 5, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.902776 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 1.1285560131072998
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0714044570922852
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1887376308441162
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.390 Vali Acc: 0.903 Test Loss: 0.390 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0970380306243896
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9962222576141357
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.931 Test Loss: 0.285 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.110710620880127
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0519661903381348
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.024979591369629
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.0550880432128906
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.0827922821044922
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.9488925933837891
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.0627028942108154
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.1327388286590576
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.1101646423339844
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.1039717197418213
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.9953947067260742
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0556554794311523
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9401497840881348
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0173704624176025
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9262330532073975
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9498028755187988
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9098303318023682
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0232245922088623
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8352205753326416
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.064138650894165
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1005276
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.073808431625366
Epoch: 1, Steps: 7 | Train Loss: 2.414 Vali Loss: 1.503 Vali Acc: 0.653 Test Loss: 1.503 Test Acc: 0.653
Validation loss decreased (inf --> -0.652763).  Saving model ...
Epoch: 2 cost time: 1.1153044700622559
Epoch: 2, Steps: 7 | Train Loss: 0.822 Vali Loss: 0.438 Vali Acc: 0.833 Test Loss: 0.438 Test Acc: 0.833
Validation loss decreased (-0.652763 --> -0.833329).  Saving model ...
Epoch: 3 cost time: 1.198282241821289
Epoch: 3, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
Validation loss decreased (-0.833329 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 1.0649137496948242
Epoch: 4, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.888886 --> -0.944443).  Saving model ...
Epoch: 5 cost time: 1.120448350906372
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0613796710968018
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.385 Vali Acc: 0.903 Test Loss: 0.385 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1745476722717285
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.389 Vali Acc: 0.903 Test Loss: 0.389 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.200549840927124
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.382 Vali Acc: 0.903 Test Loss: 0.382 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.250941276550293
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.917 Test Loss: 0.373 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0465264320373535
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.367 Vali Acc: 0.917 Test Loss: 0.367 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1494221687316895
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.360 Vali Acc: 0.917 Test Loss: 0.360 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0923354625701904
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.352 Vali Acc: 0.917 Test Loss: 0.352 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2122249603271484
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.917 Test Loss: 0.347 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2048184871673584
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.342 Vali Acc: 0.917 Test Loss: 0.342 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 972508
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8797032833099365
Epoch: 1, Steps: 7 | Train Loss: 2.418 Vali Loss: 1.527 Vali Acc: 0.639 Test Loss: 1.527 Test Acc: 0.639
Validation loss decreased (inf --> -0.638874).  Saving model ...
Epoch: 2 cost time: 0.9113523960113525
Epoch: 2, Steps: 7 | Train Loss: 0.836 Vali Loss: 0.460 Vali Acc: 0.833 Test Loss: 0.460 Test Acc: 0.833
Validation loss decreased (-0.638874 --> -0.833329).  Saving model ...
Epoch: 3 cost time: 1.054222822189331
Epoch: 3, Steps: 7 | Train Loss: 0.096 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
Validation loss decreased (-0.833329 --> -0.874997).  Saving model ...
Epoch: 4 cost time: 1.245166540145874
Epoch: 4, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.874997 --> -0.944443).  Saving model ...
Epoch: 5 cost time: 1.0939366817474365
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2698485851287842
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.107877492904663
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1336712837219238
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.149141788482666
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.195242166519165
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2509520053863525
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0414738655090332
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2333142757415771
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2082459926605225
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 972508
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.991363525390625
Epoch: 1, Steps: 7 | Train Loss: 2.396 Vali Loss: 1.573 Vali Acc: 0.625 Test Loss: 1.573 Test Acc: 0.625
Validation loss decreased (inf --> -0.624984).  Saving model ...
Epoch: 2 cost time: 1.0135326385498047
Epoch: 2, Steps: 7 | Train Loss: 0.870 Vali Loss: 0.487 Vali Acc: 0.792 Test Loss: 0.487 Test Acc: 0.792
Validation loss decreased (-0.624984 --> -0.791662).  Saving model ...
Epoch: 3 cost time: 1.2219047546386719
Epoch: 3, Steps: 7 | Train Loss: 0.108 Vali Loss: 0.344 Vali Acc: 0.861 Test Loss: 0.344 Test Acc: 0.861
Validation loss decreased (-0.791662 --> -0.861108).  Saving model ...
Epoch: 4 cost time: 1.0533909797668457
Epoch: 4, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.861108 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 1.1662788391113281
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.053100824356079
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0643665790557861
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1599643230438232
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.039853811264038
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9786436557769775
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.986152172088623
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0135233402252197
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0995447635650635
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.018066167831421
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 972508
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8371026515960693
Epoch: 1, Steps: 7 | Train Loss: 2.345 Vali Loss: 1.602 Vali Acc: 0.625 Test Loss: 1.602 Test Acc: 0.625
Validation loss decreased (inf --> -0.624984).  Saving model ...
Epoch: 2 cost time: 1.030505895614624
Epoch: 2, Steps: 7 | Train Loss: 0.924 Vali Loss: 0.515 Vali Acc: 0.819 Test Loss: 0.515 Test Acc: 0.819
Validation loss decreased (-0.624984 --> -0.819439).  Saving model ...
Epoch: 3 cost time: 1.0465047359466553
Epoch: 3, Steps: 7 | Train Loss: 0.174 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
Validation loss decreased (-0.819439 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 1.0086023807525635
Epoch: 4, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 1.0011706352233887
Epoch: 5, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0019123554229736
Epoch: 6, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9643325805664062
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0245227813720703
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8931267261505127
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9653167724609375
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9428422451019287
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9317188262939453
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.899695873260498
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.9574458599090576
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.9328000545501709
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.971912145614624
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.9218990802764893
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.061290979385376
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.9735922813415527
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.106992244720459
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 0.9782605171203613
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.9697222709655762
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 0.9963481426239014
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 0.9880197048187256
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 1.0854015350341797
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 1.0715501308441162
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 1.043527364730835
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 1.0931270122528076
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0429134368896484
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 1.0800025463104248
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 1.002830982208252
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 1.0602619647979736
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 1.0504889488220215
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1037824153900146
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0918183326721191
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9970083236694336
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 1.0590174198150635
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 1.119974136352539
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.9949462413787842
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.114490270614624
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1435093879699707
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.113682746887207
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.1073708534240723
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0992014408111572
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.0551307201385498
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.0455999374389648
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.1549930572509766
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 1.1055591106414795
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.016016960144043
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1026484966278076
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 51 cost time: 1.0880303382873535
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0537476539611816
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0546860694885254
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.0232479572296143
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 55 cost time: 1.0227265357971191
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 56 cost time: 0.9469048976898193
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 57 cost time: 1.120483160018921
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 58 cost time: 1.0800988674163818
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.0754308700561523
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.9928576946258545
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.0812056064605713
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.9878621101379395
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.9946839809417725
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.957036018371582
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.0819242000579834
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.098242998123169
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.0580124855041504
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 972508
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.006814956665039
Epoch: 1, Steps: 7 | Train Loss: 2.385 Vali Loss: 1.593 Vali Acc: 0.750 Test Loss: 1.593 Test Acc: 0.750
Validation loss decreased (inf --> -0.749984).  Saving model ...
Epoch: 2 cost time: 1.0626304149627686
Epoch: 2, Steps: 7 | Train Loss: 0.813 Vali Loss: 0.407 Vali Acc: 0.903 Test Loss: 0.407 Test Acc: 0.903
Validation loss decreased (-0.749984 --> -0.902774).  Saving model ...
Epoch: 3 cost time: 1.23746657371521
Epoch: 3, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2686588764190674
Epoch: 4, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 1.2711143493652344
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 1.1812193393707275
Epoch: 6, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1703367233276367
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 1.2541048526763916
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.1688554286956787
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.135779857635498
Epoch: 10, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1663568019866943
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2045979499816895
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.2072627544403076
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.3317551612854004
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2042100429534912
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.298757791519165
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.280299186706543
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.259688138961792
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.284590482711792
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3377118110656738
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2032639980316162
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.342090368270874
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3251838684082031
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 956124
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6865899562835693
Epoch: 1, Steps: 7 | Train Loss: 2.362 Vali Loss: 1.558 Vali Acc: 0.806 Test Loss: 1.558 Test Acc: 0.806
Validation loss decreased (inf --> -0.805540).  Saving model ...
Epoch: 2 cost time: 1.0949292182922363
Epoch: 2, Steps: 7 | Train Loss: 0.807 Vali Loss: 0.403 Vali Acc: 0.917 Test Loss: 0.403 Test Acc: 0.917
Validation loss decreased (-0.805540 --> -0.916663).  Saving model ...
Epoch: 3 cost time: 1.084482192993164
Epoch: 3, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0792458057403564
Epoch: 4, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.113248348236084
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1933410167694092
Epoch: 6, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.079103946685791
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0034270286560059
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.0121312141418457
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1250622272491455
Epoch: 10, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0153253078460693
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.1703767776489258
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.1415557861328125
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9667794704437256
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.056666612625122
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0525479316711426
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1530735492706299
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0019807815551758
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.119652271270752
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0139553546905518
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0256524085998535
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9920737743377686
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 956124
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8005053997039795
Epoch: 1, Steps: 7 | Train Loss: 2.343 Vali Loss: 1.570 Vali Acc: 0.792 Test Loss: 1.570 Test Acc: 0.792
Validation loss decreased (inf --> -0.791651).  Saving model ...
Epoch: 2 cost time: 1.0413658618927002
Epoch: 2, Steps: 7 | Train Loss: 0.828 Vali Loss: 0.420 Vali Acc: 0.903 Test Loss: 0.420 Test Acc: 0.903
Validation loss decreased (-0.791651 --> -0.902774).  Saving model ...
Epoch: 3 cost time: 1.0969748497009277
Epoch: 3, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9556481838226318
Epoch: 4, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.274 Vali Acc: 0.875 Test Loss: 0.274 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9335439205169678
Epoch: 5, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9766225814819336
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9246418476104736
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.0051426887512207
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.9132816791534424
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9344677925109863
Epoch: 10, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0276329517364502
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.9765207767486572
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.9761137962341309
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8044278621673584
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.903 Test Loss: 0.368 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9615070819854736
Epoch: 15, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7631442546844482
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.8921492099761963
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8773863315582275
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7845034599304199
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8469305038452148
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8180594444274902
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.916496992111206
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8748209476470947
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9536638259887695
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9908874034881592
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9068388938903809
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 956124
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.942708730697632
Epoch: 1, Steps: 7 | Train Loss: 2.381 Vali Loss: 1.641 Vali Acc: 0.736 Test Loss: 1.641 Test Acc: 0.736
Validation loss decreased (inf --> -0.736095).  Saving model ...
Epoch: 2 cost time: 0.9613528251647949
Epoch: 2, Steps: 7 | Train Loss: 0.966 Vali Loss: 0.460 Vali Acc: 0.889 Test Loss: 0.460 Test Acc: 0.889
Validation loss decreased (-0.736095 --> -0.888884).  Saving model ...
Epoch: 3 cost time: 1.0480058193206787
Epoch: 3, Steps: 7 | Train Loss: 0.167 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 4 cost time: 0.9688990116119385
Epoch: 4, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 1.0873196125030518
Epoch: 5, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 0.8990919589996338
Epoch: 6, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0800871849060059
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0075852870941162
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9166688919067383
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.924760103225708
Epoch: 10, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.905620813369751
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.9769504070281982
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0030369758605957
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9800925254821777
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9857101440429688
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8705394268035889
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0408222675323486
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9213073253631592
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.078733205795288
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0644431114196777
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9763193130493164
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 956124
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7402448654174805
Epoch: 1, Steps: 7 | Train Loss: 2.530 Vali Loss: 2.070 Vali Acc: 0.403 Test Loss: 2.070 Test Acc: 0.403
Validation loss decreased (inf --> -0.402757).  Saving model ...
Epoch: 2 cost time: 1.3744792938232422
Epoch: 2, Steps: 7 | Train Loss: 1.441 Vali Loss: 0.869 Vali Acc: 0.792 Test Loss: 0.869 Test Acc: 0.792
Validation loss decreased (-0.402757 --> -0.791658).  Saving model ...
Epoch: 3 cost time: 1.334190845489502
Epoch: 3, Steps: 7 | Train Loss: 0.465 Vali Loss: 0.456 Vali Acc: 0.847 Test Loss: 0.456 Test Acc: 0.847
Validation loss decreased (-0.791658 --> -0.847218).  Saving model ...
Epoch: 4 cost time: 1.4727540016174316
Epoch: 4, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.285 Vali Acc: 0.875 Test Loss: 0.285 Test Acc: 0.875
Validation loss decreased (-0.847218 --> -0.874997).  Saving model ...
Epoch: 5 cost time: 1.2885372638702393
Epoch: 5, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.874997 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 1.227541446685791
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4184329509735107
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.428898811340332
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6663696765899658
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4394471645355225
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4616291522979736
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4159431457519531
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.284677267074585
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2956724166870117
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3258004188537598
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 727964
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5129950046539307
Epoch: 1, Steps: 7 | Train Loss: 2.512 Vali Loss: 2.056 Vali Acc: 0.444 Test Loss: 2.056 Test Acc: 0.444
Validation loss decreased (inf --> -0.444424).  Saving model ...
Epoch: 2 cost time: 1.2598774433135986
Epoch: 2, Steps: 7 | Train Loss: 1.437 Vali Loss: 0.869 Vali Acc: 0.819 Test Loss: 0.869 Test Acc: 0.819
Validation loss decreased (-0.444424 --> -0.819436).  Saving model ...
Epoch: 3 cost time: 1.3291335105895996
Epoch: 3, Steps: 7 | Train Loss: 0.474 Vali Loss: 0.446 Vali Acc: 0.875 Test Loss: 0.446 Test Acc: 0.875
Validation loss decreased (-0.819436 --> -0.874996).  Saving model ...
Epoch: 4 cost time: 1.2211518287658691
Epoch: 4, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 5 cost time: 1.0612921714782715
Epoch: 5, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 6 cost time: 1.3014440536499023
Epoch: 6, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.45060396194458
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5043449401855469
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4723069667816162
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4955179691314697
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2974693775177002
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2679932117462158
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.390136480331421
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.22017502784729
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3478097915649414
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.374011754989624
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2666513919830322
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5154087543487549
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4124443531036377
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4257047176361084
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2477588653564453
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4219095706939697
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 727964
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9212465286254883
Epoch: 1, Steps: 7 | Train Loss: 2.492 Vali Loss: 2.051 Vali Acc: 0.417 Test Loss: 2.051 Test Acc: 0.417
Validation loss decreased (inf --> -0.416646).  Saving model ...
Epoch: 2 cost time: 1.4243834018707275
Epoch: 2, Steps: 7 | Train Loss: 1.449 Vali Loss: 0.889 Vali Acc: 0.819 Test Loss: 0.889 Test Acc: 0.819
Validation loss decreased (-0.416646 --> -0.819436).  Saving model ...
Epoch: 3 cost time: 1.4477529525756836
Epoch: 3, Steps: 7 | Train Loss: 0.497 Vali Loss: 0.452 Vali Acc: 0.861 Test Loss: 0.452 Test Acc: 0.861
Validation loss decreased (-0.819436 --> -0.861107).  Saving model ...
Epoch: 4 cost time: 1.2385013103485107
Epoch: 4, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.861107 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 1.394493579864502
Epoch: 5, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 1.615422010421753
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3672704696655273
Epoch: 7, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6655280590057373
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.349 Vali Acc: 0.931 Test Loss: 0.349 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 1.5681354999542236
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.506690263748169
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.493274450302124
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5020887851715088
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.556244134902954
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5742766857147217
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4893710613250732
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.6666665077209473
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.4751641750335693
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.299820899963379
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.3301548957824707
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4353761672973633
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6148021221160889
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.4464199542999268
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3723289966583252
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.3435924053192139
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.529686450958252
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.5327250957489014
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8404066562652588
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4731330871582031
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 1.6004981994628906
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 1.565314769744873
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.5549695491790771
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 1.5661687850952148
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6176605224609375
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5730304718017578
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.582524299621582
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.6529827117919922
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.4061169624328613
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.5488853454589844
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.5480685234069824
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.410524606704712
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.3985416889190674
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 727964
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.704760789871216
Epoch: 1, Steps: 7 | Train Loss: 2.468 Vali Loss: 2.096 Vali Acc: 0.389 Test Loss: 2.096 Test Acc: 0.389
Validation loss decreased (inf --> -0.388868).  Saving model ...
Epoch: 2 cost time: 1.4041152000427246
Epoch: 2, Steps: 7 | Train Loss: 1.531 Vali Loss: 0.994 Vali Acc: 0.792 Test Loss: 0.994 Test Acc: 0.792
Validation loss decreased (-0.388868 --> -0.791657).  Saving model ...
Epoch: 3 cost time: 1.3650476932525635
Epoch: 3, Steps: 7 | Train Loss: 0.598 Vali Loss: 0.516 Vali Acc: 0.847 Test Loss: 0.516 Test Acc: 0.847
Validation loss decreased (-0.791657 --> -0.847217).  Saving model ...
Epoch: 4 cost time: 1.2615551948547363
Epoch: 4, Steps: 7 | Train Loss: 0.168 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.847217 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 1.3178865909576416
Epoch: 5, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 6 cost time: 1.2967979907989502
Epoch: 6, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4354405403137207
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4270215034484863
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3416788578033447
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6076951026916504
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3762192726135254
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 1.3847711086273193
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5730555057525635
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.374711513519287
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6776313781738281
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4632682800292969
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4634394645690918
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5737431049346924
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.482027530670166
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6344199180603027
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.281165599822998
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 727964
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4215328693389893
Epoch: 1, Steps: 7 | Train Loss: 2.562 Vali Loss: 2.026 Vali Acc: 0.417 Test Loss: 2.026 Test Acc: 0.417
Validation loss decreased (inf --> -0.416646).  Saving model ...
Epoch: 2 cost time: 1.3225746154785156
Epoch: 2, Steps: 7 | Train Loss: 1.436 Vali Loss: 0.849 Vali Acc: 0.833 Test Loss: 0.849 Test Acc: 0.833
Validation loss decreased (-0.416646 --> -0.833325).  Saving model ...
Epoch: 3 cost time: 1.1470766067504883
Epoch: 3, Steps: 7 | Train Loss: 0.420 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
Validation loss decreased (-0.833325 --> -0.888884).  Saving model ...
Epoch: 4 cost time: 1.3631489276885986
Epoch: 4, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 1.2850735187530518
Epoch: 5, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 1.2261478900909424
Epoch: 6, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3496978282928467
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3963184356689453
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4533305168151855
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2184867858886719
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.4003803730010986
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.1681163311004639
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1144840717315674
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2285370826721191
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2093889713287354
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4085946083068848
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4399926662445068
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5622069835662842
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.522409439086914
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.558685064315796
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.422407627105713
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 596892
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8463802337646484
Epoch: 1, Steps: 7 | Train Loss: 2.551 Vali Loss: 2.031 Vali Acc: 0.403 Test Loss: 2.031 Test Acc: 0.403
Validation loss decreased (inf --> -0.402757).  Saving model ...
Epoch: 2 cost time: 1.4983444213867188
Epoch: 2, Steps: 7 | Train Loss: 1.457 Vali Loss: 0.857 Vali Acc: 0.819 Test Loss: 0.857 Test Acc: 0.819
Validation loss decreased (-0.402757 --> -0.819436).  Saving model ...
Epoch: 3 cost time: 1.601226806640625
Epoch: 3, Steps: 7 | Train Loss: 0.448 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
Validation loss decreased (-0.819436 --> -0.874995).  Saving model ...
Epoch: 4 cost time: 1.413050889968872
Epoch: 4, Steps: 7 | Train Loss: 0.108 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 1.3352482318878174
Epoch: 5, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 1.3363986015319824
Epoch: 6, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 1.32208251953125
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.470233678817749
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.3869638442993164
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.3483633995056152
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3381729125976562
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2067015171051025
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3367657661437988
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.241403341293335
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1699907779693604
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1732349395751953
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3788349628448486
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.248788833618164
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4060556888580322
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 596892
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.449079751968384
Epoch: 1, Steps: 7 | Train Loss: 2.526 Vali Loss: 2.052 Vali Acc: 0.375 Test Loss: 2.052 Test Acc: 0.375
Validation loss decreased (inf --> -0.374979).  Saving model ...
Epoch: 2 cost time: 1.3176136016845703
Epoch: 2, Steps: 7 | Train Loss: 1.459 Vali Loss: 0.889 Vali Acc: 0.819 Test Loss: 0.889 Test Acc: 0.819
Validation loss decreased (-0.374979 --> -0.819436).  Saving model ...
Epoch: 3 cost time: 1.266143560409546
Epoch: 3, Steps: 7 | Train Loss: 0.481 Vali Loss: 0.493 Vali Acc: 0.875 Test Loss: 0.493 Test Acc: 0.875
Validation loss decreased (-0.819436 --> -0.874995).  Saving model ...
Epoch: 4 cost time: 1.2008445262908936
Epoch: 4, Steps: 7 | Train Loss: 0.114 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 1.2183332443237305
Epoch: 5, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.342 Vali Acc: 0.917 Test Loss: 0.342 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 1.4110291004180908
Epoch: 6, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 1.3689208030700684
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.3133368492126465
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4025654792785645
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1707615852355957
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4365489482879639
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3029983043670654
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.510730266571045
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.430694818496704
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.422701120376587
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3539385795593262
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3153882026672363
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 596892
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8623557090759277
Epoch: 1, Steps: 7 | Train Loss: 2.471 Vali Loss: 2.054 Vali Acc: 0.403 Test Loss: 2.054 Test Acc: 0.403
Validation loss decreased (inf --> -0.402757).  Saving model ...
Epoch: 2 cost time: 1.306856393814087
Epoch: 2, Steps: 7 | Train Loss: 1.515 Vali Loss: 0.965 Vali Acc: 0.819 Test Loss: 0.965 Test Acc: 0.819
Validation loss decreased (-0.402757 --> -0.819435).  Saving model ...
Epoch: 3 cost time: 1.5250747203826904
Epoch: 3, Steps: 7 | Train Loss: 0.549 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
Validation loss decreased (-0.819435 --> -0.847217).  Saving model ...
Epoch: 4 cost time: 1.4265389442443848
Epoch: 4, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
Validation loss decreased (-0.847217 --> -0.888886).  Saving model ...
Epoch: 5 cost time: 1.2131354808807373
Epoch: 5, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 6 cost time: 1.498208999633789
Epoch: 6, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 1.4998714923858643
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4050991535186768
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4461820125579834
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4795289039611816
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4716792106628418
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6444017887115479
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6136226654052734
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5892362594604492
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7364506721496582
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4038965702056885
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 596892
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.537059783935547
Epoch: 1, Steps: 7 | Train Loss: 2.580 Vali Loss: 1.980 Vali Acc: 0.500 Test Loss: 1.980 Test Acc: 0.500
Validation loss decreased (inf --> -0.499980).  Saving model ...
Epoch: 2 cost time: 1.7031524181365967
Epoch: 2, Steps: 7 | Train Loss: 1.431 Vali Loss: 0.852 Vali Acc: 0.792 Test Loss: 0.852 Test Acc: 0.792
Validation loss decreased (-0.499980 --> -0.791658).  Saving model ...
Epoch: 3 cost time: 1.2808079719543457
Epoch: 3, Steps: 7 | Train Loss: 0.427 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
Validation loss decreased (-0.791658 --> -0.874996).  Saving model ...
Epoch: 4 cost time: 1.48409104347229
Epoch: 4, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 5 cost time: 1.8450636863708496
Epoch: 5, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.378 Vali Acc: 0.861 Test Loss: 0.378 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3965239524841309
Epoch: 6, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 7 cost time: 1.5040678977966309
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 1.4211206436157227
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.476870059967041
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.3389215469360352
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.5397844314575195
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 1.684903621673584
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 1.686751365661621
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 1.5648691654205322
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 1.6229262351989746
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 1.3552134037017822
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 1.6393370628356934
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7550921440124512
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 1.5661442279815674
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 1.557539701461792
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5716993808746338
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 1.3635139465332031
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 1.583768606185913
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 1.583237886428833
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 1.2093141078948975
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 1.558474063873291
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 1.2624313831329346
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 1.3400609493255615
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5124070644378662
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3455286026000977
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2309691905975342
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5073838233947754
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.3352584838867188
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6042068004608154
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2501776218414307
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4381422996520996
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.5819463729858398
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 531356
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.64408278465271
Epoch: 1, Steps: 7 | Train Loss: 2.554 Vali Loss: 1.986 Vali Acc: 0.528 Test Loss: 1.986 Test Acc: 0.528
Validation loss decreased (inf --> -0.527758).  Saving model ...
Epoch: 2 cost time: 1.3352274894714355
Epoch: 2, Steps: 7 | Train Loss: 1.426 Vali Loss: 0.873 Vali Acc: 0.764 Test Loss: 0.873 Test Acc: 0.764
Validation loss decreased (-0.527758 --> -0.763880).  Saving model ...
Epoch: 3 cost time: 1.4197263717651367
Epoch: 3, Steps: 7 | Train Loss: 0.427 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
Validation loss decreased (-0.763880 --> -0.888885).  Saving model ...
Epoch: 4 cost time: 1.4449937343597412
Epoch: 4, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5377576351165771
Epoch: 5, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.390 Vali Acc: 0.861 Test Loss: 0.390 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.583289384841919
Epoch: 6, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4394166469573975
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 1.4343249797821045
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 1.6101841926574707
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.5146005153656006
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.6181974411010742
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 1.5196478366851807
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 1.4948160648345947
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6250462532043457
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6349480152130127
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 1.2398762702941895
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 1.4334216117858887
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 1.5312151908874512
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 1.1361887454986572
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 1.4745495319366455
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3612432479858398
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 1.4169464111328125
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.55104398727417
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.627065658569336
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 1.5115923881530762
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6992642879486084
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4818482398986816
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 1.4022059440612793
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4948375225067139
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 1.3920435905456543
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5358607769012451
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4277348518371582
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.7840917110443115
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.7838435173034668
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7431654930114746
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.5325593948364258
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.829280138015747
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.6128041744232178
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.565638542175293
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 531356
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.238288879394531
Epoch: 1, Steps: 7 | Train Loss: 2.508 Vali Loss: 1.981 Vali Acc: 0.542 Test Loss: 1.981 Test Acc: 0.542
Validation loss decreased (inf --> -0.541647).  Saving model ...
Epoch: 2 cost time: 1.6586995124816895
Epoch: 2, Steps: 7 | Train Loss: 1.420 Vali Loss: 0.893 Vali Acc: 0.806 Test Loss: 0.893 Test Acc: 0.806
Validation loss decreased (-0.541647 --> -0.805547).  Saving model ...
Epoch: 3 cost time: 1.6140682697296143
Epoch: 3, Steps: 7 | Train Loss: 0.465 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
Validation loss decreased (-0.805547 --> -0.874996).  Saving model ...
Epoch: 4 cost time: 1.6040513515472412
Epoch: 4, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 5 cost time: 1.5773918628692627
Epoch: 5, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.394 Vali Acc: 0.861 Test Loss: 0.394 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6544380187988281
Epoch: 6, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 7 cost time: 1.6289722919464111
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 1.6619811058044434
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 1.4849846363067627
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.6275949478149414
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.7477014064788818
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.3780255317687988
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.5077259540557861
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.365370750427246
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6104826927185059
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.6481585502624512
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5976250171661377
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7403359413146973
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.4815936088562012
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.609816551208496
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.6444883346557617
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.5425963401794434
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6760880947113037
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8537909984588623
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6319656372070312
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8115973472595215
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5636701583862305
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.411590576171875
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3376214504241943
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6572847366333008
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.805748701095581
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 531356
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.829259157180786
Epoch: 1, Steps: 7 | Train Loss: 2.567 Vali Loss: 2.076 Vali Acc: 0.542 Test Loss: 2.076 Test Acc: 0.542
Validation loss decreased (inf --> -0.541646).  Saving model ...
Epoch: 2 cost time: 1.6943175792694092
Epoch: 2, Steps: 7 | Train Loss: 1.574 Vali Loss: 1.027 Vali Acc: 0.792 Test Loss: 1.027 Test Acc: 0.792
Validation loss decreased (-0.541646 --> -0.791656).  Saving model ...
Epoch: 3 cost time: 1.6037871837615967
Epoch: 3, Steps: 7 | Train Loss: 0.599 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
Validation loss decreased (-0.791656 --> -0.847217).  Saving model ...
Epoch: 4 cost time: 1.5499019622802734
Epoch: 4, Steps: 7 | Train Loss: 0.204 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
Validation loss decreased (-0.847217 --> -0.888885).  Saving model ...
Epoch: 5 cost time: 1.5059340000152588
Epoch: 5, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5243620872497559
Epoch: 6, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 7 cost time: 1.3126912117004395
Epoch: 7, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6814770698547363
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3452913761138916
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 1.4725511074066162
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.6079380512237549
Epoch: 11, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.6682350635528564
Epoch: 12, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7175531387329102
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.5660958290100098
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.6447105407714844
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4889256954193115
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4612278938293457
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5883560180664062
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.517831563949585
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.5156099796295166
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.5024070739746094
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.514354944229126
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.246936321258545
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 1.3325448036193848
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4382271766662598
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4867963790893555
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.648817777633667
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.5912787914276123
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.5927517414093018
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7061042785644531
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.518157720565796
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.679793357849121
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4067189693450928
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.5219535827636719
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.6357803344726562
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.5171277523040771
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.398566722869873
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.7430341243743896
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 531356
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4606618881225586
Epoch: 1, Steps: 7 | Train Loss: 2.659 Vali Loss: 2.084 Vali Acc: 0.389 Test Loss: 2.084 Test Acc: 0.389
Validation loss decreased (inf --> -0.388868).  Saving model ...
Epoch: 2 cost time: 1.6714158058166504
Epoch: 2, Steps: 7 | Train Loss: 1.557 Vali Loss: 0.909 Vali Acc: 0.819 Test Loss: 0.909 Test Acc: 0.819
Validation loss decreased (-0.388868 --> -0.819435).  Saving model ...
Epoch: 3 cost time: 1.4967718124389648
Epoch: 3, Steps: 7 | Train Loss: 0.493 Vali Loss: 0.442 Vali Acc: 0.861 Test Loss: 0.442 Test Acc: 0.861
Validation loss decreased (-0.819435 --> -0.861107).  Saving model ...
Epoch: 4 cost time: 1.5426199436187744
Epoch: 4, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.389 Vali Acc: 0.875 Test Loss: 0.389 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 5 cost time: 1.4709997177124023
Epoch: 5, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 6 cost time: 1.802962064743042
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.953214168548584
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.814335584640503
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.6963443756103516
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.7602367401123047
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9384126663208008
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7766904830932617
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.741309642791748
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8550810813903809
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9745287895202637
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6126716136932373
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.61081862449646
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.6418936252593994
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4745063781738281
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.4528322219848633
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6376235485076904
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.793947458267212
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5849945545196533
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7060520648956299
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9269821643829346
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6456401348114014
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8869168758392334
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7265434265136719
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7856273651123047
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 498588
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.24322509765625
Epoch: 1, Steps: 7 | Train Loss: 2.640 Vali Loss: 2.091 Vali Acc: 0.417 Test Loss: 2.091 Test Acc: 0.417
Validation loss decreased (inf --> -0.416646).  Saving model ...
Epoch: 2 cost time: 1.4535868167877197
Epoch: 2, Steps: 7 | Train Loss: 1.551 Vali Loss: 0.924 Vali Acc: 0.819 Test Loss: 0.924 Test Acc: 0.819
Validation loss decreased (-0.416646 --> -0.819435).  Saving model ...
Epoch: 3 cost time: 1.6022417545318604
Epoch: 3, Steps: 7 | Train Loss: 0.505 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
Validation loss decreased (-0.819435 --> -0.874995).  Saving model ...
Epoch: 4 cost time: 1.4260408878326416
Epoch: 4, Steps: 7 | Train Loss: 0.152 Vali Loss: 0.400 Vali Acc: 0.847 Test Loss: 0.400 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.746558666229248
Epoch: 5, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.4854767322540283
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 1.4549896717071533
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5657649040222168
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6382946968078613
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5718119144439697
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6652226448059082
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3525173664093018
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6720917224884033
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.3710157871246338
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.3935596942901611
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.6197702884674072
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.4468457698822021
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.4396545886993408
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.6736993789672852
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.5485613346099854
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.801924228668213
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6404469013214111
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.332871913909912
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.635481357574463
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5343210697174072
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4660329818725586
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4644126892089844
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2428574562072754
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3472900390625
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3638789653778076
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 498588
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.290750503540039
Epoch: 1, Steps: 7 | Train Loss: 2.627 Vali Loss: 2.143 Vali Acc: 0.319 Test Loss: 2.143 Test Acc: 0.319
Validation loss decreased (inf --> -0.319423).  Saving model ...
Epoch: 2 cost time: 1.3547077178955078
Epoch: 2, Steps: 7 | Train Loss: 1.547 Vali Loss: 0.961 Vali Acc: 0.833 Test Loss: 0.961 Test Acc: 0.833
Validation loss decreased (-0.319423 --> -0.833324).  Saving model ...
Epoch: 3 cost time: 1.4280967712402344
Epoch: 3, Steps: 7 | Train Loss: 0.528 Vali Loss: 0.475 Vali Acc: 0.889 Test Loss: 0.475 Test Acc: 0.889
Validation loss decreased (-0.833324 --> -0.888884).  Saving model ...
Epoch: 4 cost time: 1.3129982948303223
Epoch: 4, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.420 Vali Acc: 0.819 Test Loss: 0.420 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4182353019714355
Epoch: 5, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.4886634349822998
Epoch: 6, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
Validation loss decreased (-0.888885 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 1.5400364398956299
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.408250093460083
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4119794368743896
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4943768978118896
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.487809181213379
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.584500789642334
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5856378078460693
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2834937572479248
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6170392036437988
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5110282897949219
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 498588
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3785789012908936
Epoch: 1, Steps: 7 | Train Loss: 2.612 Vali Loss: 2.162 Vali Acc: 0.250 Test Loss: 2.162 Test Acc: 0.250
Validation loss decreased (inf --> -0.249978).  Saving model ...
Epoch: 2 cost time: 1.5173330307006836
Epoch: 2, Steps: 7 | Train Loss: 1.660 Vali Loss: 1.057 Vali Acc: 0.778 Test Loss: 1.057 Test Acc: 0.778
Validation loss decreased (-0.249978 --> -0.777767).  Saving model ...
Epoch: 3 cost time: 1.475393533706665
Epoch: 3, Steps: 7 | Train Loss: 0.659 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
Validation loss decreased (-0.777767 --> -0.861106).  Saving model ...
Epoch: 4 cost time: 1.1321604251861572
Epoch: 4, Steps: 7 | Train Loss: 0.256 Vali Loss: 0.407 Vali Acc: 0.847 Test Loss: 0.407 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5093848705291748
Epoch: 5, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874997).  Saving model ...
Epoch: 6 cost time: 1.1623694896697998
Epoch: 6, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 1.5655872821807861
Epoch: 7, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3869192600250244
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.4937140941619873
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.6635005474090576
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.438795804977417
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6086575984954834
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5781364440917969
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5064561367034912
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.590641975402832
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3609161376953125
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.5462772846221924
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.3820223808288574
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.3243331909179688
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.6786835193634033
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.3368923664093018
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.6814162731170654
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5531530380249023
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4279682636260986
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5279316902160645
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4024412631988525
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4205191135406494
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2297310829162598
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.436786413192749
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4568328857421875
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.5295627117156982
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 498588
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9471209049224854
Epoch: 1, Steps: 7 | Train Loss: 2.478 Vali Loss: 2.110 Vali Acc: 0.306 Test Loss: 2.110 Test Acc: 0.306
Validation loss decreased (inf --> -0.305534).  Saving model ...
Epoch: 2 cost time: 1.6612284183502197
Epoch: 2, Steps: 7 | Train Loss: 1.426 Vali Loss: 0.917 Vali Acc: 0.764 Test Loss: 0.917 Test Acc: 0.764
Validation loss decreased (-0.305534 --> -0.763880).  Saving model ...
Epoch: 3 cost time: 1.4347879886627197
Epoch: 3, Steps: 7 | Train Loss: 0.415 Vali Loss: 0.490 Vali Acc: 0.861 Test Loss: 0.490 Test Acc: 0.861
Validation loss decreased (-0.763880 --> -0.861106).  Saving model ...
Epoch: 4 cost time: 1.5416498184204102
Epoch: 4, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888885).  Saving model ...
Epoch: 5 cost time: 1.727217197418213
Epoch: 5, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3449115753173828
Epoch: 6, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6359219551086426
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.4985344409942627
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.462700605392456
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5613248348236084
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.704542636871338
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6023812294006348
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6255137920379639
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5892589092254639
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7057125568389893
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6699159145355225
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7032482624053955
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5467767715454102
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.4538638591766357
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.547175407409668
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6311523914337158
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3680031299591064
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.433760166168213
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 1.6138908863067627
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.313340663909912
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.648202657699585
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.6351466178894043
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.438340187072754
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.2861812114715576
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.5590920448303223
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.3441214561462402
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.5006403923034668
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 1.2531306743621826
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4844226837158203
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4495890140533447
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.389622449874878
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.5384864807128906
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.8525547981262207
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.5696399211883545
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.6697273254394531
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.4901256561279297
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.5982105731964111
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 482204
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.270761489868164
Epoch: 1, Steps: 7 | Train Loss: 2.459 Vali Loss: 2.069 Vali Acc: 0.306 Test Loss: 2.069 Test Acc: 0.306
Validation loss decreased (inf --> -0.305535).  Saving model ...
Epoch: 2 cost time: 1.5415501594543457
Epoch: 2, Steps: 7 | Train Loss: 1.434 Vali Loss: 0.891 Vali Acc: 0.847 Test Loss: 0.891 Test Acc: 0.847
Validation loss decreased (-0.305535 --> -0.847213).  Saving model ...
Epoch: 3 cost time: 1.2746896743774414
Epoch: 3, Steps: 7 | Train Loss: 0.425 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
Validation loss decreased (-0.847213 --> -0.874995).  Saving model ...
Epoch: 4 cost time: 1.34725022315979
Epoch: 4, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 1.330230474472046
Epoch: 5, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.259648323059082
Epoch: 6, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.180616855621338
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6262993812561035
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.588181972503662
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.57255220413208
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5786468982696533
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.346662998199463
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.3620121479034424
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.6193225383758545
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.6550981998443604
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4315681457519531
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7688932418823242
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.5382368564605713
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.5355145931243896
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5421395301818848
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5156269073486328
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3358662128448486
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3639588356018066
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2598497867584229
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5119340419769287
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.490490436553955
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3013906478881836
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4094312191009521
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 1.4162943363189697
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 1.5054006576538086
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.44671630859375
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 1.437638759613037
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 1.4800739288330078
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5725724697113037
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7456252574920654
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.740283489227295
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.5900981426239014
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.7878389358520508
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.0073132514953613
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.6860167980194092
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.773301601409912
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.8074865341186523
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 482204
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.011739015579224
Epoch: 1, Steps: 7 | Train Loss: 2.427 Vali Loss: 2.062 Vali Acc: 0.375 Test Loss: 2.062 Test Acc: 0.375
Validation loss decreased (inf --> -0.374979).  Saving model ...
Epoch: 2 cost time: 1.5624380111694336
Epoch: 2, Steps: 7 | Train Loss: 1.456 Vali Loss: 0.922 Vali Acc: 0.806 Test Loss: 0.922 Test Acc: 0.806
Validation loss decreased (-0.374979 --> -0.805546).  Saving model ...
Epoch: 3 cost time: 1.5368070602416992
Epoch: 3, Steps: 7 | Train Loss: 0.447 Vali Loss: 0.484 Vali Acc: 0.847 Test Loss: 0.484 Test Acc: 0.847
Validation loss decreased (-0.805546 --> -0.847217).  Saving model ...
Epoch: 4 cost time: 1.709810495376587
Epoch: 4, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
Validation loss decreased (-0.847217 --> -0.888885).  Saving model ...
Epoch: 5 cost time: 1.502774953842163
Epoch: 5, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.445 Vali Acc: 0.819 Test Loss: 0.445 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5785267353057861
Epoch: 6, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 7 cost time: 1.4002735614776611
Epoch: 7, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.4278545379638672
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.5635895729064941
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.6689321994781494
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.7875277996063232
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.6848516464233398
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.561729907989502
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5367565155029297
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4469835758209229
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.4676566123962402
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5803940296173096
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7189855575561523
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.528517723083496
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6855449676513672
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5141456127166748
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.45595383644104
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.849292516708374
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.533975601196289
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6098012924194336
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 482204
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.883157253265381
Epoch: 1, Steps: 7 | Train Loss: 2.421 Vali Loss: 2.077 Vali Acc: 0.347 Test Loss: 2.077 Test Acc: 0.347
Validation loss decreased (inf --> -0.347201).  Saving model ...
Epoch: 2 cost time: 1.3613018989562988
Epoch: 2, Steps: 7 | Train Loss: 1.562 Vali Loss: 1.015 Vali Acc: 0.764 Test Loss: 1.015 Test Acc: 0.764
Validation loss decreased (-0.347201 --> -0.763879).  Saving model ...
Epoch: 3 cost time: 1.3966679573059082
Epoch: 3, Steps: 7 | Train Loss: 0.563 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
Validation loss decreased (-0.763879 --> -0.847217).  Saving model ...
Epoch: 4 cost time: 1.494818925857544
Epoch: 4, Steps: 7 | Train Loss: 0.194 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
Validation loss decreased (-0.847217 --> -0.888885).  Saving model ...
Epoch: 5 cost time: 1.4831829071044922
Epoch: 5, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3900141716003418
Epoch: 6, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 1.3777482509613037
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4032018184661865
Epoch: 8, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.443835973739624
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.285 Vali Acc: 0.861 Test Loss: 0.285 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5034894943237305
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.467257022857666
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3368184566497803
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.479867696762085
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.3030037879943848
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.292351484298706
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 16 cost time: 1.443937063217163
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.435114860534668
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4236812591552734
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.728356122970581
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.508263111114502
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.489286184310913
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.6845791339874268
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 23 cost time: 1.4229557514190674
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5103332996368408
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 1.3782281875610352
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 1.2860419750213623
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 27 cost time: 1.2655293941497803
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4544060230255127
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5836951732635498
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 1.327319860458374
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 31 cost time: 1.5289864540100098
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 32 cost time: 1.3477532863616943
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 1.6512298583984375
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5144586563110352
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4490101337432861
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.423475980758667
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4000637531280518
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2513082027435303
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.377084493637085
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.3110992908477783
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.6188457012176514
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.6365694999694824
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 482204
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.199689626693726
Epoch: 1, Steps: 7 | Train Loss: 2.399 Vali Loss: 1.973 Vali Acc: 0.458 Test Loss: 1.973 Test Acc: 0.458
Validation loss decreased (inf --> -0.458314).  Saving model ...
Epoch: 2 cost time: 1.6965935230255127
Epoch: 2, Steps: 7 | Train Loss: 1.390 Vali Loss: 0.858 Vali Acc: 0.847 Test Loss: 0.858 Test Acc: 0.847
Validation loss decreased (-0.458314 --> -0.847214).  Saving model ...
Epoch: 3 cost time: 1.5116093158721924
Epoch: 3, Steps: 7 | Train Loss: 0.377 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
Validation loss decreased (-0.847214 --> -0.874996).  Saving model ...
Epoch: 4 cost time: 1.5254700183868408
Epoch: 4, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.344 Vali Acc: 0.903 Test Loss: 0.344 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 1.548642635345459
Epoch: 5, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7204771041870117
Epoch: 6, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5830762386322021
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.600663423538208
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.55899977684021
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.649634838104248
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.6628777980804443
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.447312355041504
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.6111373901367188
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.3978018760681152
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.3901615142822266
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.5801911354064941
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.4020941257476807
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.393911600112915
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.515791893005371
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.4969334602355957
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.3862826824188232
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.701179027557373
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4593656063079834
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5146727561950684
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.61098051071167
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.389866590499878
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.4808077812194824
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.5042595863342285
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.7814667224884033
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.760746955871582
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7067885398864746
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8150436878204346
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.6636993885040283
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.4654176235198975
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7283265590667725
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.4845407009124756
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.6417434215545654
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.6185507774353027
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.665952444076538
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 474012
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.96278715133667
Epoch: 1, Steps: 7 | Train Loss: 2.405 Vali Loss: 1.945 Vali Acc: 0.514 Test Loss: 1.945 Test Acc: 0.514
Validation loss decreased (inf --> -0.513869).  Saving model ...
Epoch: 2 cost time: 1.5440473556518555
Epoch: 2, Steps: 7 | Train Loss: 1.410 Vali Loss: 0.843 Vali Acc: 0.861 Test Loss: 0.843 Test Acc: 0.861
Validation loss decreased (-0.513869 --> -0.861103).  Saving model ...
Epoch: 3 cost time: 1.515200138092041
Epoch: 3, Steps: 7 | Train Loss: 0.384 Vali Loss: 0.395 Vali Acc: 0.903 Test Loss: 0.395 Test Acc: 0.903
Validation loss decreased (-0.861103 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 1.612046241760254
Epoch: 4, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8522520065307617
Epoch: 5, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5942997932434082
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.7765064239501953
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 1.581050157546997
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6486225128173828
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.2964880466461182
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.554774522781372
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.6147782802581787
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.3770387172698975
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.1725175380706787
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.5711607933044434
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.3073399066925049
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4272422790527344
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2652854919433594
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6090033054351807
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5970332622528076
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.423762321472168
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7052950859069824
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8467180728912354
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7860238552093506
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5026397705078125
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 474012
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.419834852218628
Epoch: 1, Steps: 7 | Train Loss: 2.366 Vali Loss: 1.900 Vali Acc: 0.597 Test Loss: 1.900 Test Acc: 0.597
Validation loss decreased (inf --> -0.597203).  Saving model ...
Epoch: 2 cost time: 1.4633679389953613
Epoch: 2, Steps: 7 | Train Loss: 1.409 Vali Loss: 0.836 Vali Acc: 0.833 Test Loss: 0.836 Test Acc: 0.833
Validation loss decreased (-0.597203 --> -0.833325).  Saving model ...
Epoch: 3 cost time: 1.592893123626709
Epoch: 3, Steps: 7 | Train Loss: 0.400 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
Validation loss decreased (-0.833325 --> -0.888885).  Saving model ...
Epoch: 4 cost time: 1.6171832084655762
Epoch: 4, Steps: 7 | Train Loss: 0.114 Vali Loss: 0.343 Vali Acc: 0.917 Test Loss: 0.343 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 1.4604525566101074
Epoch: 5, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6864733695983887
Epoch: 6, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5386104583740234
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4325339794158936
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5281085968017578
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4161133766174316
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4783062934875488
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.554732322692871
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5045359134674072
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6937832832336426
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 474012
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8426053524017334
Epoch: 1, Steps: 7 | Train Loss: 2.387 Vali Loss: 1.936 Vali Acc: 0.583 Test Loss: 1.936 Test Acc: 0.583
Validation loss decreased (inf --> -0.583314).  Saving model ...
Epoch: 2 cost time: 1.278982162475586
Epoch: 2, Steps: 7 | Train Loss: 1.532 Vali Loss: 0.931 Vali Acc: 0.861 Test Loss: 0.931 Test Acc: 0.861
Validation loss decreased (-0.583314 --> -0.861102).  Saving model ...
Epoch: 3 cost time: 1.3863623142242432
Epoch: 3, Steps: 7 | Train Loss: 0.542 Vali Loss: 0.445 Vali Acc: 0.861 Test Loss: 0.445 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861107).  Saving model ...
Epoch: 4 cost time: 1.3410406112670898
Epoch: 4, Steps: 7 | Train Loss: 0.188 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 5 cost time: 1.5267393589019775
Epoch: 5, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888886).  Saving model ...
Epoch: 6 cost time: 1.409965991973877
Epoch: 6, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 1.5644924640655518
Epoch: 7, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.559617519378662
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5797948837280273
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7311670780181885
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.3726701736450195
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.6862597465515137
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.4495940208435059
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6398296356201172
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4531464576721191
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.7597291469573975
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.554084062576294
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6261544227600098
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3539400100708008
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.418762445449829
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4893410205841064
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.648672103881836
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4926176071166992
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6048064231872559
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5153841972351074
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7114391326904297
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 474012
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.356419324874878
Epoch: 1, Steps: 7 | Train Loss: 2.197 Vali Loss: 1.257 Vali Acc: 0.653 Test Loss: 1.257 Test Acc: 0.653
Validation loss decreased (inf --> -0.652765).  Saving model ...
Epoch: 2 cost time: 1.7627990245819092
Epoch: 2, Steps: 7 | Train Loss: 0.571 Vali Loss: 0.498 Vali Acc: 0.861 Test Loss: 0.498 Test Acc: 0.861
Validation loss decreased (-0.652765 --> -0.861106).  Saving model ...
Epoch: 3 cost time: 1.6468565464019775
Epoch: 3, Steps: 7 | Train Loss: 0.187 Vali Loss: 1.834 Vali Acc: 0.819 Test Loss: 1.834 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6651618480682373
Epoch: 4, Steps: 7 | Train Loss: 0.511 Vali Loss: 4.206 Vali Acc: 0.833 Test Loss: 4.206 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.705601692199707
Epoch: 5, Steps: 7 | Train Loss: 0.439 Vali Loss: 1.504 Vali Acc: 0.861 Test Loss: 1.504 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7842350006103516
Epoch: 6, Steps: 7 | Train Loss: 0.525 Vali Loss: 1.000 Vali Acc: 0.889 Test Loss: 1.000 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888879).  Saving model ...
Epoch: 7 cost time: 1.7300503253936768
Epoch: 7, Steps: 7 | Train Loss: 0.094 Vali Loss: 2.483 Vali Acc: 0.903 Test Loss: 2.483 Test Acc: 0.903
Validation loss decreased (-0.888879 --> -0.902753).  Saving model ...
Epoch: 8 cost time: 1.6305689811706543
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 4.027 Vali Acc: 0.875 Test Loss: 4.027 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8683626651763916
Epoch: 9, Steps: 7 | Train Loss: 0.048 Vali Loss: 4.146 Vali Acc: 0.861 Test Loss: 4.146 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8281257152557373
Epoch: 10, Steps: 7 | Train Loss: 0.548 Vali Loss: 2.530 Vali Acc: 0.875 Test Loss: 2.530 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7521822452545166
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.448 Vali Acc: 0.833 Test Loss: 4.448 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6595797538757324
Epoch: 12, Steps: 7 | Train Loss: 0.422 Vali Loss: 4.905 Vali Acc: 0.806 Test Loss: 4.905 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7282826900482178
Epoch: 13, Steps: 7 | Train Loss: 0.481 Vali Loss: 3.968 Vali Acc: 0.833 Test Loss: 3.968 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8786282539367676
Epoch: 14, Steps: 7 | Train Loss: 0.577 Vali Loss: 4.197 Vali Acc: 0.861 Test Loss: 4.197 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8010501861572266
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.581 Vali Acc: 0.847 Test Loss: 7.581 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7023391723632812
Epoch: 16, Steps: 7 | Train Loss: 0.035 Vali Loss: 5.388 Vali Acc: 0.861 Test Loss: 5.388 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7263312339782715
Epoch: 17, Steps: 7 | Train Loss: 0.453 Vali Loss: 2.803 Vali Acc: 0.889 Test Loss: 2.803 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 9997364
model size : 47.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.729480028152466
Epoch: 1, Steps: 7 | Train Loss: 2.155 Vali Loss: 1.140 Vali Acc: 0.681 Test Loss: 1.140 Test Acc: 0.681
Validation loss decreased (inf --> -0.680544).  Saving model ...
Epoch: 2 cost time: 3.180091619491577
Epoch: 2, Steps: 7 | Train Loss: 0.485 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
Validation loss decreased (-0.680544 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 3.116584539413452
Epoch: 3, Steps: 7 | Train Loss: 0.155 Vali Loss: 1.388 Vali Acc: 0.861 Test Loss: 1.388 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.494694709777832
Epoch: 4, Steps: 7 | Train Loss: 0.275 Vali Loss: 4.098 Vali Acc: 0.750 Test Loss: 4.098 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4485156536102295
Epoch: 5, Steps: 7 | Train Loss: 0.578 Vali Loss: 1.314 Vali Acc: 0.875 Test Loss: 1.314 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.679476737976074
Epoch: 6, Steps: 7 | Train Loss: 0.144 Vali Loss: 0.748 Vali Acc: 0.917 Test Loss: 0.748 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916659).  Saving model ...
Epoch: 7 cost time: 3.0249273777008057
Epoch: 7, Steps: 7 | Train Loss: 0.349 Vali Loss: 1.495 Vali Acc: 0.917 Test Loss: 1.495 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.838114023208618
Epoch: 8, Steps: 7 | Train Loss: 0.026 Vali Loss: 2.952 Vali Acc: 0.889 Test Loss: 2.952 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.836825370788574
Epoch: 9, Steps: 7 | Train Loss: 0.035 Vali Loss: 2.539 Vali Acc: 0.875 Test Loss: 2.539 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5216434001922607
Epoch: 10, Steps: 7 | Train Loss: 0.092 Vali Loss: 3.397 Vali Acc: 0.875 Test Loss: 3.397 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7132558822631836
Epoch: 11, Steps: 7 | Train Loss: 0.180 Vali Loss: 3.542 Vali Acc: 0.861 Test Loss: 3.542 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.806870460510254
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.285 Vali Acc: 0.889 Test Loss: 2.285 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.0917277336120605
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.477 Vali Acc: 0.847 Test Loss: 3.477 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.0656373500823975
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 2.742 Vali Acc: 0.861 Test Loss: 2.742 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.599808692932129
Epoch: 15, Steps: 7 | Train Loss: 0.010 Vali Loss: 4.317 Vali Acc: 0.903 Test Loss: 4.317 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.948443651199341
Epoch: 16, Steps: 7 | Train Loss: 0.163 Vali Loss: 4.961 Vali Acc: 0.806 Test Loss: 4.961 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 9997364
model size : 47.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.688106298446655
Epoch: 1, Steps: 7 | Train Loss: 2.137 Vali Loss: 1.037 Vali Acc: 0.667 Test Loss: 1.037 Test Acc: 0.667
Validation loss decreased (inf --> -0.666656).  Saving model ...
Epoch: 2 cost time: 2.9592039585113525
Epoch: 2, Steps: 7 | Train Loss: 0.468 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
Validation loss decreased (-0.666656 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 2.834047555923462
Epoch: 3, Steps: 7 | Train Loss: 0.266 Vali Loss: 1.758 Vali Acc: 0.847 Test Loss: 1.758 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.681190013885498
Epoch: 4, Steps: 7 | Train Loss: 0.421 Vali Loss: 2.282 Vali Acc: 0.806 Test Loss: 2.282 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.053858995437622
Epoch: 5, Steps: 7 | Train Loss: 0.590 Vali Loss: 0.776 Vali Acc: 0.903 Test Loss: 0.776 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902770).  Saving model ...
Epoch: 6 cost time: 2.9277987480163574
Epoch: 6, Steps: 7 | Train Loss: 0.074 Vali Loss: 1.746 Vali Acc: 0.861 Test Loss: 1.746 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5207576751708984
Epoch: 7, Steps: 7 | Train Loss: 0.060 Vali Loss: 1.620 Vali Acc: 0.917 Test Loss: 1.620 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916650).  Saving model ...
Epoch: 8 cost time: 2.1026487350463867
Epoch: 8, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.797 Vali Acc: 0.903 Test Loss: 0.797 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2569897174835205
Epoch: 9, Steps: 7 | Train Loss: 0.239 Vali Loss: 4.001 Vali Acc: 0.806 Test Loss: 4.001 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.251378059387207
Epoch: 10, Steps: 7 | Train Loss: 0.501 Vali Loss: 5.110 Vali Acc: 0.778 Test Loss: 5.110 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.518505573272705
Epoch: 11, Steps: 7 | Train Loss: 0.049 Vali Loss: 6.213 Vali Acc: 0.750 Test Loss: 6.213 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8523125648498535
Epoch: 12, Steps: 7 | Train Loss: 0.150 Vali Loss: 4.865 Vali Acc: 0.917 Test Loss: 4.865 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8553028106689453
Epoch: 13, Steps: 7 | Train Loss: 0.139 Vali Loss: 3.048 Vali Acc: 0.861 Test Loss: 3.048 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.103203058242798
Epoch: 14, Steps: 7 | Train Loss: 0.027 Vali Loss: 4.458 Vali Acc: 0.819 Test Loss: 4.458 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.9013943672180176
Epoch: 15, Steps: 7 | Train Loss: 0.279 Vali Loss: 5.469 Vali Acc: 0.819 Test Loss: 5.469 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.85091233253479
Epoch: 16, Steps: 7 | Train Loss: 0.033 Vali Loss: 7.260 Vali Acc: 0.806 Test Loss: 7.260 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.380828380584717
Epoch: 17, Steps: 7 | Train Loss: 0.491 Vali Loss: 4.217 Vali Acc: 0.875 Test Loss: 4.217 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 9997364
model size : 47.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.968632698059082
Epoch: 1, Steps: 7 | Train Loss: 2.128 Vali Loss: 1.047 Vali Acc: 0.681 Test Loss: 1.047 Test Acc: 0.681
Validation loss decreased (inf --> -0.680545).  Saving model ...
Epoch: 2 cost time: 2.658139228820801
Epoch: 2, Steps: 7 | Train Loss: 0.580 Vali Loss: 0.414 Vali Acc: 0.917 Test Loss: 0.414 Test Acc: 0.917
Validation loss decreased (-0.680545 --> -0.916663).  Saving model ...
Epoch: 3 cost time: 2.7674789428710938
Epoch: 3, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.792 Vali Acc: 0.889 Test Loss: 0.792 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.583808660507202
Epoch: 4, Steps: 7 | Train Loss: 0.340 Vali Loss: 3.447 Vali Acc: 0.764 Test Loss: 3.447 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5873560905456543
Epoch: 5, Steps: 7 | Train Loss: 0.684 Vali Loss: 2.826 Vali Acc: 0.778 Test Loss: 2.826 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3706555366516113
Epoch: 6, Steps: 7 | Train Loss: 0.221 Vali Loss: 3.287 Vali Acc: 0.764 Test Loss: 3.287 Test Acc: 0.764
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.180402994155884
Epoch: 7, Steps: 7 | Train Loss: 0.242 Vali Loss: 1.907 Vali Acc: 0.847 Test Loss: 1.907 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.376750946044922
Epoch: 8, Steps: 7 | Train Loss: 0.654 Vali Loss: 0.790 Vali Acc: 0.958 Test Loss: 0.790 Test Acc: 0.958
Validation loss decreased (-0.916663 --> -0.958325).  Saving model ...
Epoch: 9 cost time: 2.9170031547546387
Epoch: 9, Steps: 7 | Train Loss: 0.224 Vali Loss: 1.433 Vali Acc: 0.917 Test Loss: 1.433 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7958860397338867
Epoch: 10, Steps: 7 | Train Loss: 0.271 Vali Loss: 3.218 Vali Acc: 0.806 Test Loss: 3.218 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4010932445526123
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.143 Vali Acc: 0.889 Test Loss: 3.143 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4258954524993896
Epoch: 12, Steps: 7 | Train Loss: 0.059 Vali Loss: 2.803 Vali Acc: 0.889 Test Loss: 2.803 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.535602331161499
Epoch: 13, Steps: 7 | Train Loss: 0.027 Vali Loss: 3.909 Vali Acc: 0.917 Test Loss: 3.909 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.667243480682373
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 5.027 Vali Acc: 0.875 Test Loss: 5.027 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5978140830993652
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 5.380 Vali Acc: 0.847 Test Loss: 5.380 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1713368892669678
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 3.896 Vali Acc: 0.833 Test Loss: 3.896 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.225482225418091
Epoch: 17, Steps: 7 | Train Loss: 0.017 Vali Loss: 1.103 Vali Acc: 0.944 Test Loss: 1.103 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2228150367736816
Epoch: 18, Steps: 7 | Train Loss: 0.413 Vali Loss: 0.821 Vali Acc: 0.958 Test Loss: 0.821 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 9997364
model size : 47.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.054533243179321
Epoch: 1, Steps: 7 | Train Loss: 2.273 Vali Loss: 1.259 Vali Acc: 0.625 Test Loss: 1.259 Test Acc: 0.625
Validation loss decreased (inf --> -0.624987).  Saving model ...
Epoch: 2 cost time: 2.4701671600341797
Epoch: 2, Steps: 7 | Train Loss: 0.386 Vali Loss: 1.197 Vali Acc: 0.861 Test Loss: 1.197 Test Acc: 0.861
Validation loss decreased (-0.624987 --> -0.861099).  Saving model ...
Epoch: 3 cost time: 2.357290267944336
Epoch: 3, Steps: 7 | Train Loss: 0.014 Vali Loss: 1.991 Vali Acc: 0.819 Test Loss: 1.991 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6633591651916504
Epoch: 4, Steps: 7 | Train Loss: 0.115 Vali Loss: 1.653 Vali Acc: 0.889 Test Loss: 1.653 Test Acc: 0.889
Validation loss decreased (-0.861099 --> -0.888872).  Saving model ...
Epoch: 5 cost time: 2.8368465900421143
Epoch: 5, Steps: 7 | Train Loss: 0.154 Vali Loss: 2.772 Vali Acc: 0.875 Test Loss: 2.772 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6643331050872803
Epoch: 6, Steps: 7 | Train Loss: 0.447 Vali Loss: 3.546 Vali Acc: 0.819 Test Loss: 3.546 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.266173839569092
Epoch: 7, Steps: 7 | Train Loss: 0.397 Vali Loss: 3.908 Vali Acc: 0.806 Test Loss: 3.908 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7897281646728516
Epoch: 8, Steps: 7 | Train Loss: 0.128 Vali Loss: 3.193 Vali Acc: 0.792 Test Loss: 3.193 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.753485679626465
Epoch: 9, Steps: 7 | Train Loss: 0.096 Vali Loss: 2.957 Vali Acc: 0.847 Test Loss: 2.957 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8283214569091797
Epoch: 10, Steps: 7 | Train Loss: 0.271 Vali Loss: 3.155 Vali Acc: 0.903 Test Loss: 3.155 Test Acc: 0.903
Validation loss decreased (-0.888872 --> -0.902746).  Saving model ...
Epoch: 11 cost time: 2.9000885486602783
Epoch: 11, Steps: 7 | Train Loss: 0.174 Vali Loss: 3.085 Vali Acc: 0.889 Test Loss: 3.085 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0405120849609375
Epoch: 12, Steps: 7 | Train Loss: 0.071 Vali Loss: 3.144 Vali Acc: 0.847 Test Loss: 3.144 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8400206565856934
Epoch: 13, Steps: 7 | Train Loss: 0.590 Vali Loss: 1.546 Vali Acc: 0.889 Test Loss: 1.546 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5866646766662598
Epoch: 14, Steps: 7 | Train Loss: 0.760 Vali Loss: 1.897 Vali Acc: 0.889 Test Loss: 1.897 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.4362196922302246
Epoch: 15, Steps: 7 | Train Loss: 0.239 Vali Loss: 2.941 Vali Acc: 0.889 Test Loss: 2.941 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.8313915729522705
Epoch: 16, Steps: 7 | Train Loss: 0.156 Vali Loss: 2.177 Vali Acc: 0.861 Test Loss: 2.177 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.455557107925415
Epoch: 17, Steps: 7 | Train Loss: 0.810 Vali Loss: 2.623 Vali Acc: 0.847 Test Loss: 2.623 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.587865114212036
Epoch: 18, Steps: 7 | Train Loss: 0.378 Vali Loss: 5.833 Vali Acc: 0.819 Test Loss: 5.833 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.859575033187866
Epoch: 19, Steps: 7 | Train Loss: 0.333 Vali Loss: 14.021 Vali Acc: 0.681 Test Loss: 14.021 Test Acc: 0.681
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.2468435764312744
Epoch: 20, Steps: 7 | Train Loss: 0.374 Vali Loss: 8.123 Vali Acc: 0.861 Test Loss: 8.123 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 8948788
model size : 43.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.951380491256714
Epoch: 1, Steps: 7 | Train Loss: 2.232 Vali Loss: 1.151 Vali Acc: 0.667 Test Loss: 1.151 Test Acc: 0.667
Validation loss decreased (inf --> -0.666655).  Saving model ...
Epoch: 2 cost time: 2.629894256591797
Epoch: 2, Steps: 7 | Train Loss: 0.379 Vali Loss: 1.184 Vali Acc: 0.875 Test Loss: 1.184 Test Acc: 0.875
Validation loss decreased (-0.666655 --> -0.874988).  Saving model ...
Epoch: 3 cost time: 3.193260431289673
Epoch: 3, Steps: 7 | Train Loss: 0.039 Vali Loss: 1.466 Vali Acc: 0.903 Test Loss: 1.466 Test Acc: 0.903
Validation loss decreased (-0.874988 --> -0.902763).  Saving model ...
Epoch: 4 cost time: 3.0480778217315674
Epoch: 4, Steps: 7 | Train Loss: 0.179 Vali Loss: 1.202 Vali Acc: 0.917 Test Loss: 1.202 Test Acc: 0.917
Validation loss decreased (-0.902763 --> -0.916655).  Saving model ...
Epoch: 5 cost time: 3.172297239303589
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 3.013 Vali Acc: 0.903 Test Loss: 3.013 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.101762056350708
Epoch: 6, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.954 Vali Acc: 0.931 Test Loss: 0.954 Test Acc: 0.931
Validation loss decreased (-0.916655 --> -0.930546).  Saving model ...
Epoch: 7 cost time: 3.0696420669555664
Epoch: 7, Steps: 7 | Train Loss: 0.127 Vali Loss: 1.517 Vali Acc: 0.903 Test Loss: 1.517 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.72232985496521
Epoch: 8, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.882 Vali Acc: 0.944 Test Loss: 0.882 Test Acc: 0.944
Validation loss decreased (-0.930546 --> -0.944436).  Saving model ...
Epoch: 9 cost time: 2.7312734127044678
Epoch: 9, Steps: 7 | Train Loss: 0.423 Vali Loss: 2.433 Vali Acc: 0.861 Test Loss: 2.433 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.699918270111084
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.560 Vali Acc: 0.861 Test Loss: 2.560 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.921811580657959
Epoch: 11, Steps: 7 | Train Loss: 0.875 Vali Loss: 3.051 Vali Acc: 0.875 Test Loss: 3.051 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.626826524734497
Epoch: 12, Steps: 7 | Train Loss: 0.110 Vali Loss: 4.454 Vali Acc: 0.847 Test Loss: 4.454 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.505998134613037
Epoch: 13, Steps: 7 | Train Loss: 0.137 Vali Loss: 2.421 Vali Acc: 0.917 Test Loss: 2.421 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.492687940597534
Epoch: 14, Steps: 7 | Train Loss: 0.044 Vali Loss: 2.460 Vali Acc: 0.875 Test Loss: 2.460 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3595824241638184
Epoch: 15, Steps: 7 | Train Loss: 0.229 Vali Loss: 13.216 Vali Acc: 0.625 Test Loss: 13.216 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.250563383102417
Epoch: 16, Steps: 7 | Train Loss: 0.593 Vali Loss: 4.972 Vali Acc: 0.833 Test Loss: 4.972 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.0812978744506836
Epoch: 17, Steps: 7 | Train Loss: 1.341 Vali Loss: 4.723 Vali Acc: 0.847 Test Loss: 4.723 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.163397789001465
Epoch: 18, Steps: 7 | Train Loss: 0.462 Vali Loss: 6.966 Vali Acc: 0.847 Test Loss: 6.966 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 8948788
model size : 43.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.375388860702515
Epoch: 1, Steps: 7 | Train Loss: 2.204 Vali Loss: 1.108 Vali Acc: 0.667 Test Loss: 1.108 Test Acc: 0.667
Validation loss decreased (inf --> -0.666656).  Saving model ...
Epoch: 2 cost time: 2.6694326400756836
Epoch: 2, Steps: 7 | Train Loss: 0.405 Vali Loss: 0.998 Vali Acc: 0.875 Test Loss: 0.998 Test Acc: 0.875
Validation loss decreased (-0.666656 --> -0.874990).  Saving model ...
Epoch: 3 cost time: 2.7118797302246094
Epoch: 3, Steps: 7 | Train Loss: 0.066 Vali Loss: 1.682 Vali Acc: 0.861 Test Loss: 1.682 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.769606828689575
Epoch: 4, Steps: 7 | Train Loss: 0.074 Vali Loss: 1.440 Vali Acc: 0.875 Test Loss: 1.440 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.746534585952759
Epoch: 5, Steps: 7 | Train Loss: 0.150 Vali Loss: 2.294 Vali Acc: 0.903 Test Loss: 2.294 Test Acc: 0.903
Validation loss decreased (-0.874990 --> -0.902755).  Saving model ...
Epoch: 6 cost time: 2.9258413314819336
Epoch: 6, Steps: 7 | Train Loss: 0.642 Vali Loss: 0.518 Vali Acc: 0.958 Test Loss: 0.518 Test Acc: 0.958
Validation loss decreased (-0.902755 --> -0.958328).  Saving model ...
Epoch: 7 cost time: 2.7877700328826904
Epoch: 7, Steps: 7 | Train Loss: 0.225 Vali Loss: 0.955 Vali Acc: 0.944 Test Loss: 0.955 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0172019004821777
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.372 Vali Acc: 0.889 Test Loss: 2.372 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7007737159729004
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.039 Vali Acc: 0.861 Test Loss: 4.039 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.210123062133789
Epoch: 10, Steps: 7 | Train Loss: 0.224 Vali Loss: 3.827 Vali Acc: 0.847 Test Loss: 3.827 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1556413173675537
Epoch: 11, Steps: 7 | Train Loss: 0.285 Vali Loss: 1.267 Vali Acc: 0.889 Test Loss: 1.267 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0942819118499756
Epoch: 12, Steps: 7 | Train Loss: 1.200 Vali Loss: 1.024 Vali Acc: 0.931 Test Loss: 1.024 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9862072467803955
Epoch: 13, Steps: 7 | Train Loss: 0.035 Vali Loss: 4.610 Vali Acc: 0.792 Test Loss: 4.610 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.467844009399414
Epoch: 14, Steps: 7 | Train Loss: 1.471 Vali Loss: 5.475 Vali Acc: 0.875 Test Loss: 5.475 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.49471116065979
Epoch: 15, Steps: 7 | Train Loss: 0.298 Vali Loss: 4.113 Vali Acc: 0.861 Test Loss: 4.113 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9450397491455078
Epoch: 16, Steps: 7 | Train Loss: 0.975 Vali Loss: 6.200 Vali Acc: 0.792 Test Loss: 6.200 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 8948788
model size : 43.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.891833305358887
Epoch: 1, Steps: 7 | Train Loss: 2.233 Vali Loss: 1.027 Vali Acc: 0.722 Test Loss: 1.027 Test Acc: 0.722
Validation loss decreased (inf --> -0.722212).  Saving model ...
Epoch: 2 cost time: 2.322211265563965
Epoch: 2, Steps: 7 | Train Loss: 0.377 Vali Loss: 0.669 Vali Acc: 0.889 Test Loss: 0.669 Test Acc: 0.889
Validation loss decreased (-0.722212 --> -0.888882).  Saving model ...
Epoch: 3 cost time: 2.3203020095825195
Epoch: 3, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.620 Vali Acc: 0.833 Test Loss: 0.620 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1493353843688965
Epoch: 4, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.178 Vali Acc: 0.875 Test Loss: 1.178 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.027846097946167
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.744 Vali Acc: 0.889 Test Loss: 1.744 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.178633213043213
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.828 Vali Acc: 0.903 Test Loss: 0.828 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902769).  Saving model ...
Epoch: 7 cost time: 2.0616159439086914
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.735 Vali Acc: 0.847 Test Loss: 1.735 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5068438053131104
Epoch: 8, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.985 Vali Acc: 0.917 Test Loss: 0.985 Test Acc: 0.917
Validation loss decreased (-0.902769 --> -0.916657).  Saving model ...
Epoch: 9 cost time: 2.593141555786133
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.671 Vali Acc: 0.917 Test Loss: 0.671 Test Acc: 0.917
Validation loss decreased (-0.916657 --> -0.916660).  Saving model ...
Epoch: 10 cost time: 2.3482613563537598
Epoch: 10, Steps: 7 | Train Loss: 0.339 Vali Loss: 0.622 Vali Acc: 0.931 Test Loss: 0.622 Test Acc: 0.931
Validation loss decreased (-0.916660 --> -0.930549).  Saving model ...
Epoch: 11 cost time: 2.381845474243164
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.918 Vali Acc: 0.931 Test Loss: 0.918 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.655987501144409
Epoch: 12, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.605 Vali Acc: 0.944 Test Loss: 0.605 Test Acc: 0.944
Validation loss decreased (-0.930549 --> -0.944438).  Saving model ...
Epoch: 13 cost time: 2.510699510574341
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.917 Test Loss: 0.672 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5377297401428223
Epoch: 14, Steps: 7 | Train Loss: 0.142 Vali Loss: 0.683 Vali Acc: 0.931 Test Loss: 0.683 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3979599475860596
Epoch: 15, Steps: 7 | Train Loss: 0.131 Vali Loss: 1.889 Vali Acc: 0.903 Test Loss: 1.889 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3780553340911865
Epoch: 16, Steps: 7 | Train Loss: 0.379 Vali Loss: 4.831 Vali Acc: 0.833 Test Loss: 4.831 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1025049686431885
Epoch: 17, Steps: 7 | Train Loss: 0.991 Vali Loss: 4.873 Vali Acc: 0.792 Test Loss: 4.873 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.100229024887085
Epoch: 18, Steps: 7 | Train Loss: 1.323 Vali Loss: 6.097 Vali Acc: 0.875 Test Loss: 6.097 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8786048889160156
Epoch: 19, Steps: 7 | Train Loss: 0.550 Vali Loss: 3.982 Vali Acc: 0.819 Test Loss: 3.982 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8742446899414062
Epoch: 20, Steps: 7 | Train Loss: 0.689 Vali Loss: 1.237 Vali Acc: 0.931 Test Loss: 1.237 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.342409133911133
Epoch: 21, Steps: 7 | Train Loss: 0.436 Vali Loss: 1.723 Vali Acc: 0.903 Test Loss: 1.723 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.716385841369629
Epoch: 22, Steps: 7 | Train Loss: 0.361 Vali Loss: 3.089 Vali Acc: 0.917 Test Loss: 3.089 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 8948788
model size : 43.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.609389066696167
Epoch: 1, Steps: 7 | Train Loss: 2.213 Vali Loss: 0.680 Vali Acc: 0.792 Test Loss: 0.680 Test Acc: 0.792
Validation loss decreased (inf --> -0.791660).  Saving model ...
Epoch: 2 cost time: 3.3821287155151367
Epoch: 2, Steps: 7 | Train Loss: 0.226 Vali Loss: 0.537 Vali Acc: 0.931 Test Loss: 0.537 Test Acc: 0.931
Validation loss decreased (-0.791660 --> -0.930550).  Saving model ...
Epoch: 3 cost time: 3.1903486251831055
Epoch: 3, Steps: 7 | Train Loss: 0.249 Vali Loss: 3.069 Vali Acc: 0.750 Test Loss: 3.069 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.866295099258423
Epoch: 4, Steps: 7 | Train Loss: 0.613 Vali Loss: 0.988 Vali Acc: 0.917 Test Loss: 0.988 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9174129962921143
Epoch: 5, Steps: 7 | Train Loss: 0.418 Vali Loss: 0.861 Vali Acc: 0.917 Test Loss: 0.861 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.665179491043091
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.931 Test Loss: 0.468 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930551).  Saving model ...
Epoch: 7 cost time: 2.3242385387420654
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.187 Vali Acc: 0.917 Test Loss: 1.187 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.332292318344116
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 1.036 Vali Acc: 0.903 Test Loss: 1.036 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3425133228302
Epoch: 9, Steps: 7 | Train Loss: 0.399 Vali Loss: 0.510 Vali Acc: 0.903 Test Loss: 0.510 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.279148578643799
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.400 Vali Acc: 0.903 Test Loss: 0.400 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.423081398010254
Epoch: 11, Steps: 7 | Train Loss: 0.034 Vali Loss: 1.254 Vali Acc: 0.889 Test Loss: 1.254 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.488619565963745
Epoch: 12, Steps: 7 | Train Loss: 0.090 Vali Loss: 2.841 Vali Acc: 0.833 Test Loss: 2.841 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.8144428730010986
Epoch: 13, Steps: 7 | Train Loss: 0.084 Vali Loss: 8.075 Vali Acc: 0.750 Test Loss: 8.075 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.0086026191711426
Epoch: 14, Steps: 7 | Train Loss: 0.532 Vali Loss: 2.755 Vali Acc: 0.861 Test Loss: 2.755 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7138538360595703
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 4.668 Vali Acc: 0.778 Test Loss: 4.668 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5210793018341064
Epoch: 16, Steps: 7 | Train Loss: 0.402 Vali Loss: 9.018 Vali Acc: 0.806 Test Loss: 9.018 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 8424500
model size : 41.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.090738534927368
Epoch: 1, Steps: 7 | Train Loss: 2.184 Vali Loss: 0.680 Vali Acc: 0.792 Test Loss: 0.680 Test Acc: 0.792
Validation loss decreased (inf --> -0.791660).  Saving model ...
Epoch: 2 cost time: 2.51642107963562
Epoch: 2, Steps: 7 | Train Loss: 0.233 Vali Loss: 0.514 Vali Acc: 0.931 Test Loss: 0.514 Test Acc: 0.931
Validation loss decreased (-0.791660 --> -0.930550).  Saving model ...
Epoch: 3 cost time: 2.2403388023376465
Epoch: 3, Steps: 7 | Train Loss: 0.049 Vali Loss: 2.739 Vali Acc: 0.736 Test Loss: 2.739 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.460434913635254
Epoch: 4, Steps: 7 | Train Loss: 0.368 Vali Loss: 1.385 Vali Acc: 0.861 Test Loss: 1.385 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3825225830078125
Epoch: 5, Steps: 7 | Train Loss: 0.512 Vali Loss: 1.294 Vali Acc: 0.903 Test Loss: 1.294 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.581301689147949
Epoch: 6, Steps: 7 | Train Loss: 0.190 Vali Loss: 1.085 Vali Acc: 0.889 Test Loss: 1.085 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5653879642486572
Epoch: 7, Steps: 7 | Train Loss: 0.068 Vali Loss: 3.890 Vali Acc: 0.833 Test Loss: 3.890 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5759756565093994
Epoch: 8, Steps: 7 | Train Loss: 1.997 Vali Loss: 4.941 Vali Acc: 0.792 Test Loss: 4.941 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.590778112411499
Epoch: 9, Steps: 7 | Train Loss: 0.165 Vali Loss: 3.691 Vali Acc: 0.806 Test Loss: 3.691 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.7235360145568848
Epoch: 10, Steps: 7 | Train Loss: 0.300 Vali Loss: 1.278 Vali Acc: 0.931 Test Loss: 1.278 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.3067119121551514
Epoch: 11, Steps: 7 | Train Loss: 0.288 Vali Loss: 0.728 Vali Acc: 0.972 Test Loss: 0.728 Test Acc: 0.972
Validation loss decreased (-0.930550 --> -0.972215).  Saving model ...
Epoch: 12 cost time: 2.270167589187622
Epoch: 12, Steps: 7 | Train Loss: 0.062 Vali Loss: 1.913 Vali Acc: 0.875 Test Loss: 1.913 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.535524845123291
Epoch: 13, Steps: 7 | Train Loss: 0.267 Vali Loss: 3.291 Vali Acc: 0.833 Test Loss: 3.291 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.600404977798462
Epoch: 14, Steps: 7 | Train Loss: 0.779 Vali Loss: 2.001 Vali Acc: 0.889 Test Loss: 2.001 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.636045217514038
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.442 Vali Acc: 0.917 Test Loss: 2.442 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.830277442932129
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.204 Vali Acc: 0.903 Test Loss: 2.204 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.6400418281555176
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 10.473 Vali Acc: 0.819 Test Loss: 10.473 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.753983974456787
Epoch: 18, Steps: 7 | Train Loss: 0.139 Vali Loss: 9.848 Vali Acc: 0.819 Test Loss: 9.848 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.390110492706299
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.785 Vali Acc: 0.861 Test Loss: 5.785 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.671623945236206
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 6.468 Vali Acc: 0.903 Test Loss: 6.468 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.4863429069519043
Epoch: 21, Steps: 7 | Train Loss: 0.311 Vali Loss: 6.320 Vali Acc: 0.875 Test Loss: 6.320 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 8424500
model size : 41.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.327080965042114
Epoch: 1, Steps: 7 | Train Loss: 2.177 Vali Loss: 0.666 Vali Acc: 0.806 Test Loss: 0.666 Test Acc: 0.806
Validation loss decreased (inf --> -0.805549).  Saving model ...
Epoch: 2 cost time: 2.211258888244629
Epoch: 2, Steps: 7 | Train Loss: 0.224 Vali Loss: 0.414 Vali Acc: 0.917 Test Loss: 0.414 Test Acc: 0.917
Validation loss decreased (-0.805549 --> -0.916663).  Saving model ...
Epoch: 3 cost time: 2.3326995372772217
Epoch: 3, Steps: 7 | Train Loss: 0.131 Vali Loss: 2.703 Vali Acc: 0.819 Test Loss: 2.703 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3356621265411377
Epoch: 4, Steps: 7 | Train Loss: 0.476 Vali Loss: 1.048 Vali Acc: 0.931 Test Loss: 1.048 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930545).  Saving model ...
Epoch: 5 cost time: 2.5771663188934326
Epoch: 5, Steps: 7 | Train Loss: 0.219 Vali Loss: 1.261 Vali Acc: 0.889 Test Loss: 1.261 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.782787322998047
Epoch: 6, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.963 Vali Acc: 0.931 Test Loss: 0.963 Test Acc: 0.931
Validation loss decreased (-0.930545 --> -0.930546).  Saving model ...
Epoch: 7 cost time: 2.683333158493042
Epoch: 7, Steps: 7 | Train Loss: 0.069 Vali Loss: 1.769 Vali Acc: 0.875 Test Loss: 1.769 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7904438972473145
Epoch: 8, Steps: 7 | Train Loss: 0.653 Vali Loss: 2.371 Vali Acc: 0.875 Test Loss: 2.371 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.820272445678711
Epoch: 9, Steps: 7 | Train Loss: 0.141 Vali Loss: 1.506 Vali Acc: 0.875 Test Loss: 1.506 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.760859251022339
Epoch: 10, Steps: 7 | Train Loss: 0.186 Vali Loss: 1.970 Vali Acc: 0.889 Test Loss: 1.970 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.828662395477295
Epoch: 11, Steps: 7 | Train Loss: 0.524 Vali Loss: 1.624 Vali Acc: 0.861 Test Loss: 1.624 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.919193983078003
Epoch: 12, Steps: 7 | Train Loss: 0.116 Vali Loss: 1.479 Vali Acc: 0.875 Test Loss: 1.479 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.3073370456695557
Epoch: 13, Steps: 7 | Train Loss: 0.221 Vali Loss: 5.484 Vali Acc: 0.833 Test Loss: 5.484 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3343281745910645
Epoch: 14, Steps: 7 | Train Loss: 0.355 Vali Loss: 2.929 Vali Acc: 0.861 Test Loss: 2.929 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4578700065612793
Epoch: 15, Steps: 7 | Train Loss: 0.121 Vali Loss: 1.309 Vali Acc: 0.903 Test Loss: 1.309 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.401275634765625
Epoch: 16, Steps: 7 | Train Loss: 0.156 Vali Loss: 2.958 Vali Acc: 0.875 Test Loss: 2.958 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 8424500
model size : 41.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.50650954246521
Epoch: 1, Steps: 7 | Train Loss: 2.164 Vali Loss: 0.662 Vali Acc: 0.792 Test Loss: 0.662 Test Acc: 0.792
Validation loss decreased (inf --> -0.791660).  Saving model ...
Epoch: 2 cost time: 2.0294559001922607
Epoch: 2, Steps: 7 | Train Loss: 0.287 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
Validation loss decreased (-0.791660 --> -0.888885).  Saving model ...
Epoch: 3 cost time: 1.937990665435791
Epoch: 3, Steps: 7 | Train Loss: 0.201 Vali Loss: 2.003 Vali Acc: 0.708 Test Loss: 2.003 Test Acc: 0.708
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.084437847137451
Epoch: 4, Steps: 7 | Train Loss: 0.392 Vali Loss: 1.201 Vali Acc: 0.889 Test Loss: 1.201 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0142722129821777
Epoch: 5, Steps: 7 | Train Loss: 0.552 Vali Loss: 0.989 Vali Acc: 0.889 Test Loss: 0.989 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.369652271270752
Epoch: 6, Steps: 7 | Train Loss: 0.541 Vali Loss: 1.545 Vali Acc: 0.833 Test Loss: 1.545 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2695140838623047
Epoch: 7, Steps: 7 | Train Loss: 0.382 Vali Loss: 0.808 Vali Acc: 0.958 Test Loss: 0.808 Test Acc: 0.958
Validation loss decreased (-0.888885 --> -0.958325).  Saving model ...
Epoch: 8 cost time: 2.39485239982605
Epoch: 8, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.723 Vali Acc: 0.903 Test Loss: 0.723 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1203131675720215
Epoch: 9, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.687 Vali Acc: 0.944 Test Loss: 0.687 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.516054630279541
Epoch: 10, Steps: 7 | Train Loss: 0.332 Vali Loss: 2.585 Vali Acc: 0.806 Test Loss: 2.585 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.392453670501709
Epoch: 11, Steps: 7 | Train Loss: 0.483 Vali Loss: 2.659 Vali Acc: 0.889 Test Loss: 2.659 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1837079524993896
Epoch: 12, Steps: 7 | Train Loss: 0.656 Vali Loss: 1.010 Vali Acc: 0.958 Test Loss: 1.010 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4071552753448486
Epoch: 13, Steps: 7 | Train Loss: 0.079 Vali Loss: 3.350 Vali Acc: 0.847 Test Loss: 3.350 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.459470510482788
Epoch: 14, Steps: 7 | Train Loss: 0.227 Vali Loss: 6.848 Vali Acc: 0.750 Test Loss: 6.848 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3880815505981445
Epoch: 15, Steps: 7 | Train Loss: 0.673 Vali Loss: 2.430 Vali Acc: 0.889 Test Loss: 2.430 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4700024127960205
Epoch: 16, Steps: 7 | Train Loss: 0.076 Vali Loss: 6.373 Vali Acc: 0.778 Test Loss: 6.373 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.4440746307373047
Epoch: 17, Steps: 7 | Train Loss: 0.391 Vali Loss: 3.359 Vali Acc: 0.833 Test Loss: 3.359 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 8424500
model size : 41.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.097697019577026
Epoch: 1, Steps: 7 | Train Loss: 2.282 Vali Loss: 0.862 Vali Acc: 0.708 Test Loss: 0.862 Test Acc: 0.708
Validation loss decreased (inf --> -0.708325).  Saving model ...
Epoch: 2 cost time: 2.466069459915161
Epoch: 2, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.684 Vali Acc: 0.889 Test Loss: 0.684 Test Acc: 0.889
Validation loss decreased (-0.708325 --> -0.888882).  Saving model ...
Epoch: 3 cost time: 2.496471643447876
Epoch: 3, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.961 Vali Acc: 0.889 Test Loss: 0.961 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5385429859161377
Epoch: 4, Steps: 7 | Train Loss: 0.078 Vali Loss: 2.951 Vali Acc: 0.819 Test Loss: 2.951 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4908692836761475
Epoch: 5, Steps: 7 | Train Loss: 0.039 Vali Loss: 1.237 Vali Acc: 0.889 Test Loss: 1.237 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7060070037841797
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.917 Test Loss: 0.817 Test Acc: 0.917
Validation loss decreased (-0.888882 --> -0.916659).  Saving model ...
Epoch: 7 cost time: 2.647890567779541
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.159 Vali Acc: 0.903 Test Loss: 1.159 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.668466806411743
Epoch: 8, Steps: 7 | Train Loss: 0.039 Vali Loss: 1.147 Vali Acc: 0.917 Test Loss: 1.147 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.546602249145508
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.094 Vali Acc: 0.917 Test Loss: 1.094 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.663059711456299
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.917 Test Loss: 1.047 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.665334701538086
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.027 Vali Acc: 0.917 Test Loss: 1.027 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7723169326782227
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.917 Test Loss: 1.015 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.530698537826538
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.917 Test Loss: 1.007 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.43485426902771
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.002 Vali Acc: 0.917 Test Loss: 1.002 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.287517786026001
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.917 Test Loss: 1.000 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.6627254486083984
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.917 Test Loss: 0.999 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 8162356
model size : 40.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.8571860790252686
Epoch: 1, Steps: 7 | Train Loss: 2.278 Vali Loss: 0.810 Vali Acc: 0.750 Test Loss: 0.810 Test Acc: 0.750
Validation loss decreased (inf --> -0.749992).  Saving model ...
Epoch: 2 cost time: 2.7234549522399902
Epoch: 2, Steps: 7 | Train Loss: 0.202 Vali Loss: 0.593 Vali Acc: 0.903 Test Loss: 0.593 Test Acc: 0.903
Validation loss decreased (-0.749992 --> -0.902772).  Saving model ...
Epoch: 3 cost time: 2.5314812660217285
Epoch: 3, Steps: 7 | Train Loss: 0.017 Vali Loss: 1.005 Vali Acc: 0.903 Test Loss: 1.005 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5162572860717773
Epoch: 4, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 2.2410998344421387
Epoch: 5, Steps: 7 | Train Loss: 0.211 Vali Loss: 1.655 Vali Acc: 0.861 Test Loss: 1.655 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5283496379852295
Epoch: 6, Steps: 7 | Train Loss: 0.146 Vali Loss: 2.575 Vali Acc: 0.861 Test Loss: 2.575 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5256452560424805
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 2.355 Vali Acc: 0.889 Test Loss: 2.355 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2961654663085938
Epoch: 8, Steps: 7 | Train Loss: 0.215 Vali Loss: 1.753 Vali Acc: 0.875 Test Loss: 1.753 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8457648754119873
Epoch: 9, Steps: 7 | Train Loss: 0.062 Vali Loss: 5.587 Vali Acc: 0.847 Test Loss: 5.587 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7621147632598877
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.038 Vali Acc: 0.792 Test Loss: 7.038 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.8560891151428223
Epoch: 11, Steps: 7 | Train Loss: 0.175 Vali Loss: 6.632 Vali Acc: 0.806 Test Loss: 6.632 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.8644859790802
Epoch: 12, Steps: 7 | Train Loss: 0.237 Vali Loss: 2.029 Vali Acc: 0.847 Test Loss: 2.029 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.9561734199523926
Epoch: 13, Steps: 7 | Train Loss: 0.023 Vali Loss: 5.048 Vali Acc: 0.819 Test Loss: 5.048 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.990884780883789
Epoch: 14, Steps: 7 | Train Loss: 0.124 Vali Loss: 2.690 Vali Acc: 0.903 Test Loss: 2.690 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 8162356
model size : 40.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.449381589889526
Epoch: 1, Steps: 7 | Train Loss: 2.237 Vali Loss: 0.716 Vali Acc: 0.750 Test Loss: 0.716 Test Acc: 0.750
Validation loss decreased (inf --> -0.749993).  Saving model ...
Epoch: 2 cost time: 2.2709944248199463
Epoch: 2, Steps: 7 | Train Loss: 0.189 Vali Loss: 0.490 Vali Acc: 0.917 Test Loss: 0.490 Test Acc: 0.917
Validation loss decreased (-0.749993 --> -0.916662).  Saving model ...
Epoch: 3 cost time: 2.4173147678375244
Epoch: 3, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.650 Vali Acc: 0.917 Test Loss: 0.650 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.390127658843994
Epoch: 4, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.944 Vali Acc: 0.903 Test Loss: 0.944 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.343470335006714
Epoch: 5, Steps: 7 | Train Loss: 0.009 Vali Loss: 1.273 Vali Acc: 0.833 Test Loss: 1.273 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.157294750213623
Epoch: 6, Steps: 7 | Train Loss: 0.354 Vali Loss: 5.305 Vali Acc: 0.750 Test Loss: 5.305 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.221360445022583
Epoch: 7, Steps: 7 | Train Loss: 0.267 Vali Loss: 1.697 Vali Acc: 0.889 Test Loss: 1.697 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9470539093017578
Epoch: 8, Steps: 7 | Train Loss: 0.318 Vali Loss: 1.641 Vali Acc: 0.861 Test Loss: 1.641 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.3989675045013428
Epoch: 9, Steps: 7 | Train Loss: 0.232 Vali Loss: 1.623 Vali Acc: 0.875 Test Loss: 1.623 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1873137950897217
Epoch: 10, Steps: 7 | Train Loss: 0.264 Vali Loss: 6.584 Vali Acc: 0.819 Test Loss: 6.584 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.4609735012054443
Epoch: 11, Steps: 7 | Train Loss: 0.469 Vali Loss: 0.966 Vali Acc: 0.889 Test Loss: 0.966 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.308481454849243
Epoch: 12, Steps: 7 | Train Loss: 0.752 Vali Loss: 1.240 Vali Acc: 0.917 Test Loss: 1.240 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 8162356
model size : 40.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.323625326156616
Epoch: 1, Steps: 7 | Train Loss: 2.212 Vali Loss: 0.699 Vali Acc: 0.764 Test Loss: 0.699 Test Acc: 0.764
Validation loss decreased (inf --> -0.763882).  Saving model ...
Epoch: 2 cost time: 2.071714162826538
Epoch: 2, Steps: 7 | Train Loss: 0.322 Vali Loss: 0.459 Vali Acc: 0.847 Test Loss: 0.459 Test Acc: 0.847
Validation loss decreased (-0.763882 --> -0.847218).  Saving model ...
Epoch: 3 cost time: 2.118441581726074
Epoch: 3, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.413 Vali Acc: 0.903 Test Loss: 0.413 Test Acc: 0.903
Validation loss decreased (-0.847218 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 2.326455593109131
Epoch: 4, Steps: 7 | Train Loss: 0.022 Vali Loss: 2.883 Vali Acc: 0.806 Test Loss: 2.883 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1932106018066406
Epoch: 5, Steps: 7 | Train Loss: 0.325 Vali Loss: 0.762 Vali Acc: 0.903 Test Loss: 0.762 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.033203363418579
Epoch: 6, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.843 Vali Acc: 0.917 Test Loss: 0.843 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916658).  Saving model ...
Epoch: 7 cost time: 1.9351747035980225
Epoch: 7, Steps: 7 | Train Loss: 0.179 Vali Loss: 0.892 Vali Acc: 0.917 Test Loss: 0.892 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.323983907699585
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.132 Vali Acc: 0.875 Test Loss: 1.132 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.617924928665161
Epoch: 9, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.976 Vali Acc: 0.903 Test Loss: 0.976 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.156644821166992
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.861 Test Loss: 1.385 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.342440128326416
Epoch: 11, Steps: 7 | Train Loss: 0.051 Vali Loss: 1.206 Vali Acc: 0.861 Test Loss: 1.206 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.3680410385131836
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.021 Vali Acc: 0.875 Test Loss: 2.021 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.198850393295288
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.429 Vali Acc: 0.875 Test Loss: 1.429 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.223740816116333
Epoch: 14, Steps: 7 | Train Loss: 0.092 Vali Loss: 1.256 Vali Acc: 0.903 Test Loss: 1.256 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1775691509246826
Epoch: 15, Steps: 7 | Train Loss: 0.366 Vali Loss: 2.669 Vali Acc: 0.861 Test Loss: 2.669 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.3340201377868652
Epoch: 16, Steps: 7 | Train Loss: 0.212 Vali Loss: 0.875 Vali Acc: 0.917 Test Loss: 0.875 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 8162356
model size : 40.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.194437742233276
Epoch: 1, Steps: 7 | Train Loss: 2.298 Vali Loss: 0.602 Vali Acc: 0.806 Test Loss: 0.602 Test Acc: 0.806
Validation loss decreased (inf --> -0.805550).  Saving model ...
Epoch: 2 cost time: 2.789044141769409
Epoch: 2, Steps: 7 | Train Loss: 0.449 Vali Loss: 0.878 Vali Acc: 0.861 Test Loss: 0.878 Test Acc: 0.861
Validation loss decreased (-0.805550 --> -0.861102).  Saving model ...
Epoch: 3 cost time: 2.771153211593628
Epoch: 3, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.903 Test Loss: 0.672 Test Acc: 0.903
Validation loss decreased (-0.861102 --> -0.902771).  Saving model ...
Epoch: 4 cost time: 2.608990430831909
Epoch: 4, Steps: 7 | Train Loss: 0.145 Vali Loss: 1.829 Vali Acc: 0.861 Test Loss: 1.829 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6828527450561523
Epoch: 5, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.843 Vali Acc: 0.903 Test Loss: 0.843 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.489133596420288
Epoch: 6, Steps: 7 | Train Loss: 0.216 Vali Loss: 0.759 Vali Acc: 0.903 Test Loss: 0.759 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5294148921966553
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.917 Test Loss: 0.734 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916659).  Saving model ...
Epoch: 8 cost time: 2.3779802322387695
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.928 Vali Acc: 0.917 Test Loss: 0.928 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4703774452209473
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.931 Test Loss: 0.866 Test Acc: 0.931
Validation loss decreased (-0.916659 --> -0.930547).  Saving model ...
Epoch: 10 cost time: 2.6622557640075684
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.856 Vali Acc: 0.931 Test Loss: 0.856 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 11 cost time: 2.8091933727264404
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.931 Test Loss: 0.850 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 12 cost time: 2.6820390224456787
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.931 Test Loss: 0.848 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 13 cost time: 2.5830931663513184
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.931 Test Loss: 0.846 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 14 cost time: 3.0640110969543457
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.931 Test Loss: 0.846 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 15 cost time: 2.6642417907714844
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 16 cost time: 2.4089748859405518
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 17 cost time: 2.834089994430542
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 18 cost time: 3.004093647003174
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 19 cost time: 2.474761724472046
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 20 cost time: 2.7253761291503906
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 21 cost time: 2.957462787628174
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 22 cost time: 2.525209903717041
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 23 cost time: 2.8922438621520996
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 24 cost time: 2.8646957874298096
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 25 cost time: 2.934629440307617
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 26 cost time: 2.732307195663452
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 27 cost time: 2.851123332977295
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 28 cost time: 2.5407509803771973
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 29 cost time: 2.533771514892578
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 30 cost time: 2.848710060119629
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 31 cost time: 3.052034854888916
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 32 cost time: 3.0657193660736084
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 33 cost time: 2.6804909706115723
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 34 cost time: 2.8819386959075928
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 35 cost time: 2.873828172683716
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 36 cost time: 2.6867787837982178
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 37 cost time: 2.9799485206604004
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 38 cost time: 2.47735857963562
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 39 cost time: 2.4355223178863525
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 40 cost time: 2.635995864868164
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 41 cost time: 2.609975814819336
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 42 cost time: 2.4354000091552734
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 43 cost time: 2.4984352588653564
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 44 cost time: 2.6120052337646484
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 45 cost time: 2.4903759956359863
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 46 cost time: 2.949425220489502
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 47 cost time: 2.982464075088501
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 48 cost time: 2.5561673641204834
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 49 cost time: 2.630831718444824
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 50 cost time: 2.66755747795105
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 51 cost time: 2.6759743690490723
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 52 cost time: 2.5772078037261963
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 53 cost time: 2.579110622406006
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 54 cost time: 2.5395987033843994
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 55 cost time: 2.7586545944213867
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 56 cost time: 2.776573419570923
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 57 cost time: 2.5629119873046875
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 58 cost time: 2.3546905517578125
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 59 cost time: 2.6906557083129883
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 60 cost time: 2.46336030960083
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 61 cost time: 2.697667360305786
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 62 cost time: 2.6651790142059326
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 63 cost time: 2.7742583751678467
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 64 cost time: 2.3895633220672607
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 65 cost time: 2.712500810623169
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 66 cost time: 2.887022018432617
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 67 cost time: 2.9156696796417236
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 68 cost time: 2.8503024578094482
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 69 cost time: 2.538395404815674
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 70 cost time: 2.6728198528289795
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 71 cost time: 2.594902276992798
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 72 cost time: 2.6724793910980225
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 73 cost time: 2.5280141830444336
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 74 cost time: 2.6207356452941895
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 75 cost time: 2.3135733604431152
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 76 cost time: 2.75718092918396
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 77 cost time: 2.8991053104400635
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 78 cost time: 3.0219624042510986
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 79 cost time: 3.0256991386413574
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 80 cost time: 2.6342334747314453
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 81 cost time: 2.4628376960754395
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 82 cost time: 2.8025381565093994
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 83 cost time: 2.7937934398651123
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 84 cost time: 2.58219051361084
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 85 cost time: 2.311131238937378
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 86 cost time: 2.500558853149414
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 87 cost time: 2.7917208671569824
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 88 cost time: 2.6836116313934326
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 89 cost time: 2.6447017192840576
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 90 cost time: 2.176684617996216
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 91 cost time: 2.7102646827697754
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 92 cost time: 2.435939311981201
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 93 cost time: 2.370734691619873
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 94 cost time: 2.508133888244629
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 95 cost time: 2.800549268722534
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 96 cost time: 2.8676042556762695
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 97 cost time: 2.9262523651123047
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 98 cost time: 2.359503746032715
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 99 cost time: 2.6630477905273438
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
Epoch: 100 cost time: 2.8281359672546387
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.931 Test Loss: 0.845 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930547).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 8031284
model size : 40.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.618872404098511
Epoch: 1, Steps: 7 | Train Loss: 2.253 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
Validation loss decreased (inf --> -0.819439).  Saving model ...
Epoch: 2 cost time: 2.412693500518799
Epoch: 2, Steps: 7 | Train Loss: 0.410 Vali Loss: 0.755 Vali Acc: 0.861 Test Loss: 0.755 Test Acc: 0.861
Validation loss decreased (-0.819439 --> -0.861104).  Saving model ...
Epoch: 3 cost time: 2.318734884262085
Epoch: 3, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.455 Vali Acc: 0.931 Test Loss: 0.455 Test Acc: 0.931
Validation loss decreased (-0.861104 --> -0.930551).  Saving model ...
Epoch: 4 cost time: 2.3537566661834717
Epoch: 4, Steps: 7 | Train Loss: 0.099 Vali Loss: 1.865 Vali Acc: 0.861 Test Loss: 1.865 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3008317947387695
Epoch: 5, Steps: 7 | Train Loss: 0.211 Vali Loss: 0.421 Vali Acc: 0.972 Test Loss: 0.421 Test Acc: 0.972
Validation loss decreased (-0.930551 --> -0.972218).  Saving model ...
Epoch: 6 cost time: 2.49137020111084
Epoch: 6, Steps: 7 | Train Loss: 0.255 Vali Loss: 0.941 Vali Acc: 0.903 Test Loss: 0.941 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5383248329162598
Epoch: 7, Steps: 7 | Train Loss: 0.216 Vali Loss: 1.866 Vali Acc: 0.875 Test Loss: 1.866 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.57068133354187
Epoch: 8, Steps: 7 | Train Loss: 0.093 Vali Loss: 3.692 Vali Acc: 0.792 Test Loss: 3.692 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3498237133026123
Epoch: 9, Steps: 7 | Train Loss: 0.080 Vali Loss: 2.731 Vali Acc: 0.875 Test Loss: 2.731 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4696457386016846
Epoch: 10, Steps: 7 | Train Loss: 0.812 Vali Loss: 0.895 Vali Acc: 0.889 Test Loss: 0.895 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.302077293395996
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.285 Vali Acc: 0.861 Test Loss: 3.285 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.6147518157958984
Epoch: 12, Steps: 7 | Train Loss: 1.223 Vali Loss: 4.485 Vali Acc: 0.847 Test Loss: 4.485 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4694743156433105
Epoch: 13, Steps: 7 | Train Loss: 0.313 Vali Loss: 2.150 Vali Acc: 0.903 Test Loss: 2.150 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3440966606140137
Epoch: 14, Steps: 7 | Train Loss: 0.407 Vali Loss: 3.442 Vali Acc: 0.861 Test Loss: 3.442 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.5038206577301025
Epoch: 15, Steps: 7 | Train Loss: 0.467 Vali Loss: 1.777 Vali Acc: 0.889 Test Loss: 1.777 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 8031284
model size : 40.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.47544264793396
Epoch: 1, Steps: 7 | Train Loss: 2.237 Vali Loss: 0.529 Vali Acc: 0.819 Test Loss: 0.529 Test Acc: 0.819
Validation loss decreased (inf --> -0.819439).  Saving model ...
Epoch: 2 cost time: 2.1897335052490234
Epoch: 2, Steps: 7 | Train Loss: 0.348 Vali Loss: 0.660 Vali Acc: 0.903 Test Loss: 0.660 Test Acc: 0.903
Validation loss decreased (-0.819439 --> -0.902771).  Saving model ...
Epoch: 3 cost time: 2.281085729598999
Epoch: 3, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.280 Vali Acc: 0.958 Test Loss: 0.280 Test Acc: 0.958
Validation loss decreased (-0.902771 --> -0.958331).  Saving model ...
Epoch: 4 cost time: 2.6481096744537354
Epoch: 4, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.839 Vali Acc: 0.903 Test Loss: 0.839 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.378070831298828
Epoch: 5, Steps: 7 | Train Loss: 0.015 Vali Loss: 1.541 Vali Acc: 0.903 Test Loss: 1.541 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.331348180770874
Epoch: 6, Steps: 7 | Train Loss: 0.223 Vali Loss: 1.272 Vali Acc: 0.847 Test Loss: 1.272 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2521228790283203
Epoch: 7, Steps: 7 | Train Loss: 0.050 Vali Loss: 1.924 Vali Acc: 0.889 Test Loss: 1.924 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4118528366088867
Epoch: 8, Steps: 7 | Train Loss: 0.035 Vali Loss: 1.353 Vali Acc: 0.944 Test Loss: 1.353 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.151644229888916
Epoch: 9, Steps: 7 | Train Loss: 0.155 Vali Loss: 1.967 Vali Acc: 0.806 Test Loss: 1.967 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.304766893386841
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.317 Vali Acc: 0.889 Test Loss: 2.317 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5458431243896484
Epoch: 11, Steps: 7 | Train Loss: 0.028 Vali Loss: 2.347 Vali Acc: 0.903 Test Loss: 2.347 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3906209468841553
Epoch: 12, Steps: 7 | Train Loss: 0.011 Vali Loss: 6.591 Vali Acc: 0.778 Test Loss: 6.591 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6869618892669678
Epoch: 13, Steps: 7 | Train Loss: 0.187 Vali Loss: 4.689 Vali Acc: 0.833 Test Loss: 4.689 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 8031284
model size : 40.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.430127143859863
Epoch: 1, Steps: 7 | Train Loss: 2.162 Vali Loss: 0.617 Vali Acc: 0.778 Test Loss: 0.617 Test Acc: 0.778
Validation loss decreased (inf --> -0.777772).  Saving model ...
Epoch: 2 cost time: 2.116626262664795
Epoch: 2, Steps: 7 | Train Loss: 0.325 Vali Loss: 0.686 Vali Acc: 0.847 Test Loss: 0.686 Test Acc: 0.847
Validation loss decreased (-0.777772 --> -0.847215).  Saving model ...
Epoch: 3 cost time: 2.035215139389038
Epoch: 3, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.573 Vali Acc: 0.917 Test Loss: 0.573 Test Acc: 0.917
Validation loss decreased (-0.847215 --> -0.916661).  Saving model ...
Epoch: 4 cost time: 2.242751121520996
Epoch: 4, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.450 Vali Acc: 0.917 Test Loss: 0.450 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 5 cost time: 2.1183598041534424
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.917 Test Loss: 0.846 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9859919548034668
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.710 Vali Acc: 0.903 Test Loss: 0.710 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2513978481292725
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.101 Vali Acc: 0.917 Test Loss: 1.101 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0461270809173584
Epoch: 8, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.786 Vali Acc: 0.917 Test Loss: 0.786 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.120469570159912
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.903 Test Loss: 1.484 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0527074337005615
Epoch: 10, Steps: 7 | Train Loss: 0.184 Vali Loss: 1.533 Vali Acc: 0.889 Test Loss: 1.533 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9062342643737793
Epoch: 11, Steps: 7 | Train Loss: 0.164 Vali Loss: 3.073 Vali Acc: 0.889 Test Loss: 3.073 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8727586269378662
Epoch: 12, Steps: 7 | Train Loss: 0.319 Vali Loss: 2.374 Vali Acc: 0.861 Test Loss: 2.374 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.011246681213379
Epoch: 13, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.554 Vali Acc: 0.972 Test Loss: 0.554 Test Acc: 0.972
Validation loss decreased (-0.916662 --> -0.972217).  Saving model ...
Epoch: 14 cost time: 1.9596543312072754
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.626 Vali Acc: 0.833 Test Loss: 1.626 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8959567546844482
Epoch: 15, Steps: 7 | Train Loss: 0.353 Vali Loss: 3.256 Vali Acc: 0.833 Test Loss: 3.256 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0108482837677
Epoch: 16, Steps: 7 | Train Loss: 0.479 Vali Loss: 3.615 Vali Acc: 0.819 Test Loss: 3.615 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9865596294403076
Epoch: 17, Steps: 7 | Train Loss: 0.113 Vali Loss: 6.648 Vali Acc: 0.806 Test Loss: 6.648 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0378096103668213
Epoch: 18, Steps: 7 | Train Loss: 0.913 Vali Loss: 5.481 Vali Acc: 0.819 Test Loss: 5.481 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.092001438140869
Epoch: 19, Steps: 7 | Train Loss: 0.914 Vali Loss: 5.166 Vali Acc: 0.847 Test Loss: 5.166 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9020967483520508
Epoch: 20, Steps: 7 | Train Loss: 0.388 Vali Loss: 5.267 Vali Acc: 0.847 Test Loss: 5.267 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.232806921005249
Epoch: 21, Steps: 7 | Train Loss: 0.407 Vali Loss: 3.690 Vali Acc: 0.861 Test Loss: 3.690 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8981926441192627
Epoch: 22, Steps: 7 | Train Loss: 0.682 Vali Loss: 4.015 Vali Acc: 0.819 Test Loss: 4.015 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1231865882873535
Epoch: 23, Steps: 7 | Train Loss: 0.172 Vali Loss: 4.299 Vali Acc: 0.833 Test Loss: 4.299 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 8031284
model size : 40.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 5.090923070907593
Epoch: 1, Steps: 7 | Train Loss: 1.994 Vali Loss: 0.679 Vali Acc: 0.847 Test Loss: 0.679 Test Acc: 0.847
Validation loss decreased (inf --> -0.847215).  Saving model ...
Epoch: 2 cost time: 2.467512607574463
Epoch: 2, Steps: 7 | Train Loss: 0.112 Vali Loss: 1.020 Vali Acc: 0.833 Test Loss: 1.020 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.756591796875
Epoch: 3, Steps: 7 | Train Loss: 0.100 Vali Loss: 2.676 Vali Acc: 0.806 Test Loss: 2.676 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7834670543670654
Epoch: 4, Steps: 7 | Train Loss: 0.329 Vali Loss: 0.710 Vali Acc: 0.931 Test Loss: 0.710 Test Acc: 0.931
Validation loss decreased (-0.847215 --> -0.930548).  Saving model ...
Epoch: 5 cost time: 2.678341865539551
Epoch: 5, Steps: 7 | Train Loss: 0.276 Vali Loss: 1.271 Vali Acc: 0.889 Test Loss: 1.271 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.563613176345825
Epoch: 6, Steps: 7 | Train Loss: 0.136 Vali Loss: 1.244 Vali Acc: 0.889 Test Loss: 1.244 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6889545917510986
Epoch: 7, Steps: 7 | Train Loss: 0.694 Vali Loss: 2.035 Vali Acc: 0.861 Test Loss: 2.035 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2845101356506348
Epoch: 8, Steps: 7 | Train Loss: 0.311 Vali Loss: 2.388 Vali Acc: 0.847 Test Loss: 2.388 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3061630725860596
Epoch: 9, Steps: 7 | Train Loss: 0.352 Vali Loss: 1.241 Vali Acc: 0.903 Test Loss: 1.241 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4977216720581055
Epoch: 10, Steps: 7 | Train Loss: 0.078 Vali Loss: 2.080 Vali Acc: 0.889 Test Loss: 2.080 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6177291870117188
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.586 Vali Acc: 0.875 Test Loss: 3.586 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.732564687728882
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 2.915 Vali Acc: 0.875 Test Loss: 2.915 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.6713292598724365
Epoch: 13, Steps: 7 | Train Loss: 0.022 Vali Loss: 2.259 Vali Acc: 0.875 Test Loss: 2.259 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.76739239692688
Epoch: 14, Steps: 7 | Train Loss: 0.971 Vali Loss: 4.349 Vali Acc: 0.861 Test Loss: 4.349 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 7965748
model size : 40.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.64870548248291
Epoch: 1, Steps: 7 | Train Loss: 2.006 Vali Loss: 0.683 Vali Acc: 0.833 Test Loss: 0.683 Test Acc: 0.833
Validation loss decreased (inf --> -0.833326).  Saving model ...
Epoch: 2 cost time: 2.0811104774475098
Epoch: 2, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.837 Vali Acc: 0.847 Test Loss: 0.837 Test Acc: 0.847
Validation loss decreased (-0.833326 --> -0.847214).  Saving model ...
Epoch: 3 cost time: 2.666811943054199
Epoch: 3, Steps: 7 | Train Loss: 0.109 Vali Loss: 2.893 Vali Acc: 0.847 Test Loss: 2.893 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.657357931137085
Epoch: 4, Steps: 7 | Train Loss: 0.243 Vali Loss: 0.456 Vali Acc: 0.944 Test Loss: 0.456 Test Acc: 0.944
Validation loss decreased (-0.847214 --> -0.944440).  Saving model ...
Epoch: 5 cost time: 2.7927794456481934
Epoch: 5, Steps: 7 | Train Loss: 0.361 Vali Loss: 0.988 Vali Acc: 0.903 Test Loss: 0.988 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.308181047439575
Epoch: 6, Steps: 7 | Train Loss: 0.181 Vali Loss: 1.742 Vali Acc: 0.847 Test Loss: 1.742 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4607203006744385
Epoch: 7, Steps: 7 | Train Loss: 0.614 Vali Loss: 4.232 Vali Acc: 0.875 Test Loss: 4.232 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.731667995452881
Epoch: 8, Steps: 7 | Train Loss: 0.149 Vali Loss: 7.417 Vali Acc: 0.764 Test Loss: 7.417 Test Acc: 0.764
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.431870460510254
Epoch: 9, Steps: 7 | Train Loss: 0.913 Vali Loss: 3.618 Vali Acc: 0.889 Test Loss: 3.618 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2303316593170166
Epoch: 10, Steps: 7 | Train Loss: 0.114 Vali Loss: 4.082 Vali Acc: 0.847 Test Loss: 4.082 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.318618059158325
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 6.795 Vali Acc: 0.833 Test Loss: 6.795 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.393955707550049
Epoch: 12, Steps: 7 | Train Loss: 0.097 Vali Loss: 2.977 Vali Acc: 0.875 Test Loss: 2.977 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.338538408279419
Epoch: 13, Steps: 7 | Train Loss: 0.032 Vali Loss: 5.613 Vali Acc: 0.833 Test Loss: 5.613 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.8337645530700684
Epoch: 14, Steps: 7 | Train Loss: 0.073 Vali Loss: 4.989 Vali Acc: 0.861 Test Loss: 4.989 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 7965748
model size : 40.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.919665575027466
Epoch: 1, Steps: 7 | Train Loss: 1.977 Vali Loss: 0.629 Vali Acc: 0.833 Test Loss: 0.629 Test Acc: 0.833
Validation loss decreased (inf --> -0.833327).  Saving model ...
Epoch: 2 cost time: 2.646756649017334
Epoch: 2, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.734 Vali Acc: 0.861 Test Loss: 0.734 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861104).  Saving model ...
Epoch: 3 cost time: 2.4560468196868896
Epoch: 3, Steps: 7 | Train Loss: 0.332 Vali Loss: 1.172 Vali Acc: 0.889 Test Loss: 1.172 Test Acc: 0.889
Validation loss decreased (-0.861104 --> -0.888877).  Saving model ...
Epoch: 4 cost time: 2.5903055667877197
Epoch: 4, Steps: 7 | Train Loss: 0.132 Vali Loss: 2.384 Vali Acc: 0.917 Test Loss: 2.384 Test Acc: 0.917
Validation loss decreased (-0.888877 --> -0.916643).  Saving model ...
Epoch: 5 cost time: 2.256350517272949
Epoch: 5, Steps: 7 | Train Loss: 0.228 Vali Loss: 2.404 Vali Acc: 0.889 Test Loss: 2.404 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.275237798690796
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 2.289 Vali Acc: 0.847 Test Loss: 2.289 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6601362228393555
Epoch: 7, Steps: 7 | Train Loss: 0.090 Vali Loss: 3.686 Vali Acc: 0.833 Test Loss: 3.686 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7481095790863037
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.035 Vali Acc: 0.917 Test Loss: 2.035 Test Acc: 0.917
Validation loss decreased (-0.916643 --> -0.916646).  Saving model ...
Epoch: 9 cost time: 2.1941792964935303
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.031 Vali Acc: 0.861 Test Loss: 2.031 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1016786098480225
Epoch: 10, Steps: 7 | Train Loss: 0.109 Vali Loss: 2.043 Vali Acc: 0.889 Test Loss: 2.043 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.285405397415161
Epoch: 11, Steps: 7 | Train Loss: 0.144 Vali Loss: 5.145 Vali Acc: 0.778 Test Loss: 5.145 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4542043209075928
Epoch: 12, Steps: 7 | Train Loss: 0.155 Vali Loss: 2.026 Vali Acc: 0.931 Test Loss: 2.026 Test Acc: 0.931
Validation loss decreased (-0.916646 --> -0.930535).  Saving model ...
Epoch: 13 cost time: 2.343909740447998
Epoch: 13, Steps: 7 | Train Loss: 0.041 Vali Loss: 2.606 Vali Acc: 0.847 Test Loss: 2.606 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.312678813934326
Epoch: 14, Steps: 7 | Train Loss: 0.385 Vali Loss: 4.411 Vali Acc: 0.819 Test Loss: 4.411 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.274254083633423
Epoch: 15, Steps: 7 | Train Loss: 1.101 Vali Loss: 3.821 Vali Acc: 0.875 Test Loss: 3.821 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.814107656478882
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 7.376 Vali Acc: 0.764 Test Loss: 7.376 Test Acc: 0.764
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4451653957366943
Epoch: 17, Steps: 7 | Train Loss: 0.639 Vali Loss: 4.611 Vali Acc: 0.833 Test Loss: 4.611 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2843801975250244
Epoch: 18, Steps: 7 | Train Loss: 0.298 Vali Loss: 6.171 Vali Acc: 0.778 Test Loss: 6.171 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.6947872638702393
Epoch: 19, Steps: 7 | Train Loss: 0.069 Vali Loss: 12.336 Vali Acc: 0.750 Test Loss: 12.336 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.373676061630249
Epoch: 20, Steps: 7 | Train Loss: 0.425 Vali Loss: 8.706 Vali Acc: 0.778 Test Loss: 8.706 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3126142024993896
Epoch: 21, Steps: 7 | Train Loss: 0.741 Vali Loss: 6.167 Vali Acc: 0.833 Test Loss: 6.167 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.3433070182800293
Epoch: 22, Steps: 7 | Train Loss: 0.484 Vali Loss: 7.990 Vali Acc: 0.778 Test Loss: 7.990 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 7965748
model size : 40.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.531677722930908
Epoch: 1, Steps: 7 | Train Loss: 2.003 Vali Loss: 0.613 Vali Acc: 0.847 Test Loss: 0.613 Test Acc: 0.847
Validation loss decreased (inf --> -0.847216).  Saving model ...
Epoch: 2 cost time: 1.8760077953338623
Epoch: 2, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.515 Vali Acc: 0.889 Test Loss: 0.515 Test Acc: 0.889
Validation loss decreased (-0.847216 --> -0.888884).  Saving model ...
Epoch: 3 cost time: 2.003937005996704
Epoch: 3, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.891 Vali Acc: 0.917 Test Loss: 0.891 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916658).  Saving model ...
Epoch: 4 cost time: 1.9382317066192627
Epoch: 4, Steps: 7 | Train Loss: 0.058 Vali Loss: 1.636 Vali Acc: 0.889 Test Loss: 1.636 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9262940883636475
Epoch: 5, Steps: 7 | Train Loss: 0.054 Vali Loss: 1.780 Vali Acc: 0.875 Test Loss: 1.780 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1648545265197754
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 1.967 Vali Acc: 0.847 Test Loss: 1.967 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4040932655334473
Epoch: 7, Steps: 7 | Train Loss: 0.031 Vali Loss: 1.232 Vali Acc: 0.889 Test Loss: 1.232 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4429845809936523
Epoch: 8, Steps: 7 | Train Loss: 0.129 Vali Loss: 1.616 Vali Acc: 0.875 Test Loss: 1.616 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2893528938293457
Epoch: 9, Steps: 7 | Train Loss: 0.169 Vali Loss: 2.216 Vali Acc: 0.861 Test Loss: 2.216 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.122737169265747
Epoch: 10, Steps: 7 | Train Loss: 0.070 Vali Loss: 3.548 Vali Acc: 0.792 Test Loss: 3.548 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.1928234100341797
Epoch: 11, Steps: 7 | Train Loss: 0.113 Vali Loss: 1.592 Vali Acc: 0.917 Test Loss: 1.592 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.5045957565307617
Epoch: 12, Steps: 7 | Train Loss: 0.075 Vali Loss: 1.740 Vali Acc: 0.889 Test Loss: 1.740 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.7945711612701416
Epoch: 13, Steps: 7 | Train Loss: 0.141 Vali Loss: 2.733 Vali Acc: 0.847 Test Loss: 2.733 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 7965748
model size : 40.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.637768030166626
Epoch: 1, Steps: 7 | Train Loss: 2.182 Vali Loss: 0.929 Vali Acc: 0.778 Test Loss: 0.929 Test Acc: 0.778
Validation loss decreased (inf --> -0.777768).  Saving model ...
Epoch: 2 cost time: 2.333643913269043
Epoch: 2, Steps: 7 | Train Loss: 0.306 Vali Loss: 0.525 Vali Acc: 0.889 Test Loss: 0.525 Test Acc: 0.889
Validation loss decreased (-0.777768 --> -0.888884).  Saving model ...
Epoch: 3 cost time: 2.183070182800293
Epoch: 3, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.571 Vali Acc: 0.861 Test Loss: 0.571 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1112093925476074
Epoch: 4, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.673 Vali Acc: 0.889 Test Loss: 0.673 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6627781391143799
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 1.707 Vali Acc: 0.889 Test Loss: 1.707 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.870147943496704
Epoch: 6, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.979 Vali Acc: 0.875 Test Loss: 0.979 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8442747592926025
Epoch: 7, Steps: 7 | Train Loss: 0.063 Vali Loss: 1.264 Vali Acc: 0.847 Test Loss: 1.264 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9720077514648438
Epoch: 8, Steps: 7 | Train Loss: 0.227 Vali Loss: 3.050 Vali Acc: 0.875 Test Loss: 3.050 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.876190185546875
Epoch: 9, Steps: 7 | Train Loss: 0.167 Vali Loss: 3.136 Vali Acc: 0.875 Test Loss: 3.136 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.02082896232605
Epoch: 10, Steps: 7 | Train Loss: 0.064 Vali Loss: 4.081 Vali Acc: 0.792 Test Loss: 4.081 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9409756660461426
Epoch: 11, Steps: 7 | Train Loss: 0.164 Vali Loss: 3.785 Vali Acc: 0.847 Test Loss: 3.785 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.709296464920044
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.535 Vali Acc: 0.806 Test Loss: 3.535 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 4867636
model size : 23.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.428712844848633
Epoch: 1, Steps: 7 | Train Loss: 2.183 Vali Loss: 0.939 Vali Acc: 0.750 Test Loss: 0.939 Test Acc: 0.750
Validation loss decreased (inf --> -0.749991).  Saving model ...
Epoch: 2 cost time: 1.638749122619629
Epoch: 2, Steps: 7 | Train Loss: 0.315 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
Validation loss decreased (-0.749991 --> -0.874995).  Saving model ...
Epoch: 3 cost time: 1.6506035327911377
Epoch: 3, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874997).  Saving model ...
Epoch: 4 cost time: 1.8889689445495605
Epoch: 4, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.501 Vali Acc: 0.889 Test Loss: 0.501 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888884).  Saving model ...
Epoch: 5 cost time: 1.8103179931640625
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.945 Vali Acc: 0.903 Test Loss: 0.945 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902768).  Saving model ...
Epoch: 6 cost time: 1.6881036758422852
Epoch: 6, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.573 Vali Acc: 0.903 Test Loss: 0.573 Test Acc: 0.903
Validation loss decreased (-0.902768 --> -0.902772).  Saving model ...
Epoch: 7 cost time: 1.7688024044036865
Epoch: 7, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.591 Vali Acc: 0.917 Test Loss: 0.591 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916661).  Saving model ...
Epoch: 8 cost time: 2.0125362873077393
Epoch: 8, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.650 Vali Acc: 0.903 Test Loss: 0.650 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9068822860717773
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.889 Test Loss: 0.793 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6923611164093018
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 1.036 Vali Acc: 0.917 Test Loss: 1.036 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7520155906677246
Epoch: 11, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.881 Vali Acc: 0.903 Test Loss: 0.881 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6855247020721436
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.856 Vali Acc: 0.903 Test Loss: 0.856 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6272399425506592
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.230 Vali Acc: 0.875 Test Loss: 1.230 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.648111343383789
Epoch: 14, Steps: 7 | Train Loss: 0.059 Vali Loss: 1.780 Vali Acc: 0.917 Test Loss: 1.780 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5747182369232178
Epoch: 15, Steps: 7 | Train Loss: 0.104 Vali Loss: 2.304 Vali Acc: 0.861 Test Loss: 2.304 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6097450256347656
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.590 Vali Acc: 0.792 Test Loss: 3.590 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8524558544158936
Epoch: 17, Steps: 7 | Train Loss: 0.048 Vali Loss: 1.393 Vali Acc: 0.889 Test Loss: 1.393 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 4867636
model size : 23.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.257928371429443
Epoch: 1, Steps: 7 | Train Loss: 2.209 Vali Loss: 0.950 Vali Acc: 0.806 Test Loss: 0.950 Test Acc: 0.806
Validation loss decreased (inf --> -0.805546).  Saving model ...
Epoch: 2 cost time: 1.796060562133789
Epoch: 2, Steps: 7 | Train Loss: 0.340 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
Validation loss decreased (-0.805546 --> -0.861106).  Saving model ...
Epoch: 3 cost time: 1.6640019416809082
Epoch: 3, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888885).  Saving model ...
Epoch: 4 cost time: 1.6136248111724854
Epoch: 4, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.434 Vali Acc: 0.917 Test Loss: 0.434 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916662).  Saving model ...
Epoch: 5 cost time: 1.5263938903808594
Epoch: 5, Steps: 7 | Train Loss: 0.009 Vali Loss: 1.120 Vali Acc: 0.875 Test Loss: 1.120 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.878255844116211
Epoch: 6, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.310 Vali Acc: 0.958 Test Loss: 0.310 Test Acc: 0.958
Validation loss decreased (-0.916662 --> -0.958330).  Saving model ...
Epoch: 7 cost time: 1.594437837600708
Epoch: 7, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.524 Vali Acc: 0.944 Test Loss: 0.524 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.693359375
Epoch: 8, Steps: 7 | Train Loss: 0.421 Vali Loss: 1.957 Vali Acc: 0.847 Test Loss: 1.957 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.006977081298828
Epoch: 9, Steps: 7 | Train Loss: 0.022 Vali Loss: 2.928 Vali Acc: 0.819 Test Loss: 2.928 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7756099700927734
Epoch: 10, Steps: 7 | Train Loss: 0.317 Vali Loss: 3.023 Vali Acc: 0.847 Test Loss: 3.023 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8443610668182373
Epoch: 11, Steps: 7 | Train Loss: 0.251 Vali Loss: 1.157 Vali Acc: 0.931 Test Loss: 1.157 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.734010934829712
Epoch: 12, Steps: 7 | Train Loss: 0.081 Vali Loss: 1.349 Vali Acc: 0.931 Test Loss: 1.349 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7862555980682373
Epoch: 13, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.912 Vali Acc: 0.944 Test Loss: 0.912 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6626017093658447
Epoch: 14, Steps: 7 | Train Loss: 0.029 Vali Loss: 1.484 Vali Acc: 0.917 Test Loss: 1.484 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6002349853515625
Epoch: 15, Steps: 7 | Train Loss: 0.066 Vali Loss: 2.927 Vali Acc: 0.792 Test Loss: 2.927 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8977460861206055
Epoch: 16, Steps: 7 | Train Loss: 0.225 Vali Loss: 3.684 Vali Acc: 0.861 Test Loss: 3.684 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 4867636
model size : 23.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.991891860961914
Epoch: 1, Steps: 7 | Train Loss: 2.218 Vali Loss: 1.015 Vali Acc: 0.764 Test Loss: 1.015 Test Acc: 0.764
Validation loss decreased (inf --> -0.763879).  Saving model ...
Epoch: 2 cost time: 1.6975388526916504
Epoch: 2, Steps: 7 | Train Loss: 0.395 Vali Loss: 0.417 Vali Acc: 0.847 Test Loss: 0.417 Test Acc: 0.847
Validation loss decreased (-0.763879 --> -0.847218).  Saving model ...
Epoch: 3 cost time: 1.5796184539794922
Epoch: 3, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.618 Vali Acc: 0.833 Test Loss: 0.618 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8720271587371826
Epoch: 4, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.457 Vali Acc: 0.889 Test Loss: 0.457 Test Acc: 0.889
Validation loss decreased (-0.847218 --> -0.888884).  Saving model ...
Epoch: 5 cost time: 1.8450913429260254
Epoch: 5, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.414 Vali Acc: 0.931 Test Loss: 0.414 Test Acc: 0.931
Validation loss decreased (-0.888884 --> -0.930551).  Saving model ...
Epoch: 6 cost time: 1.5295464992523193
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.251 Vali Acc: 0.833 Test Loss: 1.251 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6816585063934326
Epoch: 7, Steps: 7 | Train Loss: 0.037 Vali Loss: 1.044 Vali Acc: 0.861 Test Loss: 1.044 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5478429794311523
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 1.045 Vali Acc: 0.889 Test Loss: 1.045 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7177636623382568
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.080 Vali Acc: 0.889 Test Loss: 1.080 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6332800388336182
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.770 Vali Acc: 0.833 Test Loss: 1.770 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9309446811676025
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.020 Vali Acc: 0.833 Test Loss: 2.020 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8370451927185059
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.936 Vali Acc: 0.833 Test Loss: 1.936 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.609889268875122
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.779 Vali Acc: 0.833 Test Loss: 1.779 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6211252212524414
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.688 Vali Acc: 0.833 Test Loss: 1.688 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6509716510772705
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.833 Test Loss: 1.637 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 4867636
model size : 23.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.254602909088135
Epoch: 1, Steps: 7 | Train Loss: 2.400 Vali Loss: 0.968 Vali Acc: 0.722 Test Loss: 0.968 Test Acc: 0.722
Validation loss decreased (inf --> -0.722213).  Saving model ...
Epoch: 2 cost time: 1.95845627784729
Epoch: 2, Steps: 7 | Train Loss: 0.209 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.722213 --> -0.916664).  Saving model ...
Epoch: 3 cost time: 1.6040222644805908
Epoch: 3, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.918 Vali Acc: 0.875 Test Loss: 0.918 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9691503047943115
Epoch: 4, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.669 Vali Acc: 0.903 Test Loss: 0.669 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0001235008239746
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.931 Test Loss: 0.663 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930549).  Saving model ...
Epoch: 6 cost time: 2.0092082023620605
Epoch: 6, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.742 Vali Acc: 0.931 Test Loss: 0.742 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.096428632736206
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.917 Vali Acc: 0.875 Test Loss: 0.917 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8811728954315186
Epoch: 8, Steps: 7 | Train Loss: 0.075 Vali Loss: 1.519 Vali Acc: 0.889 Test Loss: 1.519 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9035773277282715
Epoch: 9, Steps: 7 | Train Loss: 0.116 Vali Loss: 1.117 Vali Acc: 0.903 Test Loss: 1.117 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8781330585479736
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 1.064 Vali Acc: 0.889 Test Loss: 1.064 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8814611434936523
Epoch: 11, Steps: 7 | Train Loss: 0.224 Vali Loss: 1.119 Vali Acc: 0.917 Test Loss: 1.119 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.073455810546875
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.145 Vali Acc: 0.875 Test Loss: 2.145 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0883748531341553
Epoch: 13, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.772 Vali Acc: 0.931 Test Loss: 0.772 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8988409042358398
Epoch: 14, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.739 Vali Acc: 0.917 Test Loss: 0.739 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7581889629364014
Epoch: 15, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.754 Vali Acc: 0.903 Test Loss: 0.754 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 4343348
model size : 21.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.693761110305786
Epoch: 1, Steps: 7 | Train Loss: 2.398 Vali Loss: 0.960 Vali Acc: 0.694 Test Loss: 0.960 Test Acc: 0.694
Validation loss decreased (inf --> -0.694435).  Saving model ...
Epoch: 2 cost time: 2.0724291801452637
Epoch: 2, Steps: 7 | Train Loss: 0.219 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.694435 --> -0.916665).  Saving model ...
Epoch: 3 cost time: 1.7883341312408447
Epoch: 3, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.826 Vali Acc: 0.861 Test Loss: 0.826 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.773315668106079
Epoch: 4, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.763 Vali Acc: 0.889 Test Loss: 0.763 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7036008834838867
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.935 Vali Acc: 0.917 Test Loss: 0.935 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6200668811798096
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.604 Vali Acc: 0.944 Test Loss: 0.604 Test Acc: 0.944
Validation loss decreased (-0.916665 --> -0.944438).  Saving model ...
Epoch: 7 cost time: 1.7248713970184326
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.974 Vali Acc: 0.875 Test Loss: 0.974 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6585569381713867
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.747 Vali Acc: 0.903 Test Loss: 0.747 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8574926853179932
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.688 Vali Acc: 0.931 Test Loss: 0.688 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7636573314666748
Epoch: 10, Steps: 7 | Train Loss: 0.056 Vali Loss: 2.167 Vali Acc: 0.778 Test Loss: 2.167 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5241858959197998
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 1.142 Vali Acc: 0.819 Test Loss: 1.142 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0258851051330566
Epoch: 12, Steps: 7 | Train Loss: 0.329 Vali Loss: 4.425 Vali Acc: 0.806 Test Loss: 4.425 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8045563697814941
Epoch: 13, Steps: 7 | Train Loss: 0.322 Vali Loss: 1.780 Vali Acc: 0.819 Test Loss: 1.780 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.729053258895874
Epoch: 14, Steps: 7 | Train Loss: 0.195 Vali Loss: 1.244 Vali Acc: 0.889 Test Loss: 1.244 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7934982776641846
Epoch: 15, Steps: 7 | Train Loss: 0.025 Vali Loss: 3.002 Vali Acc: 0.903 Test Loss: 3.002 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6817896366119385
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 5.745 Vali Acc: 0.764 Test Loss: 5.745 Test Acc: 0.764
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 4343348
model size : 21.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.144746780395508
Epoch: 1, Steps: 7 | Train Loss: 2.352 Vali Loss: 0.956 Vali Acc: 0.694 Test Loss: 0.956 Test Acc: 0.694
Validation loss decreased (inf --> -0.694435).  Saving model ...
Epoch: 2 cost time: 1.6461679935455322
Epoch: 2, Steps: 7 | Train Loss: 0.272 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.694435 --> -0.944442).  Saving model ...
Epoch: 3 cost time: 1.6109235286712646
Epoch: 3, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.691 Vali Acc: 0.889 Test Loss: 0.691 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.547494649887085
Epoch: 4, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.525 Vali Acc: 0.889 Test Loss: 0.525 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5367324352264404
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.917 Test Loss: 0.581 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5300638675689697
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.794 Vali Acc: 0.917 Test Loss: 0.794 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9620544910430908
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.931 Test Loss: 0.568 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6995973587036133
Epoch: 8, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.457 Vali Acc: 0.931 Test Loss: 0.457 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7433404922485352
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.588 Vali Acc: 0.889 Test Loss: 0.588 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6529624462127686
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.276 Vali Acc: 0.972 Test Loss: 0.276 Test Acc: 0.972
Validation loss decreased (-0.944442 --> -0.972219).  Saving model ...
Epoch: 11 cost time: 1.637749433517456
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.556 Vali Acc: 0.875 Test Loss: 0.556 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5292253494262695
Epoch: 12, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.738 Vali Acc: 0.875 Test Loss: 0.738 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.565427303314209
Epoch: 13, Steps: 7 | Train Loss: 0.172 Vali Loss: 1.318 Vali Acc: 0.847 Test Loss: 1.318 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6668145656585693
Epoch: 14, Steps: 7 | Train Loss: 0.332 Vali Loss: 0.310 Vali Acc: 0.958 Test Loss: 0.310 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6100339889526367
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.166 Vali Acc: 0.861 Test Loss: 1.166 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6406004428863525
Epoch: 16, Steps: 7 | Train Loss: 0.082 Vali Loss: 3.526 Vali Acc: 0.778 Test Loss: 3.526 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7968924045562744
Epoch: 17, Steps: 7 | Train Loss: 0.431 Vali Loss: 1.334 Vali Acc: 0.847 Test Loss: 1.334 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5051724910736084
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.770 Vali Acc: 0.917 Test Loss: 0.770 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6163618564605713
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.468 Vali Acc: 0.903 Test Loss: 1.468 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6943471431732178
Epoch: 20, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.885 Vali Acc: 0.931 Test Loss: 0.885 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 4343348
model size : 21.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.554514169692993
Epoch: 1, Steps: 7 | Train Loss: 2.318 Vali Loss: 0.986 Vali Acc: 0.694 Test Loss: 0.986 Test Acc: 0.694
Validation loss decreased (inf --> -0.694435).  Saving model ...
Epoch: 2 cost time: 1.3326537609100342
Epoch: 2, Steps: 7 | Train Loss: 0.392 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
Validation loss decreased (-0.694435 --> -0.888885).  Saving model ...
Epoch: 3 cost time: 1.6432440280914307
Epoch: 3, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.397 Vali Acc: 0.931 Test Loss: 0.397 Test Acc: 0.931
Validation loss decreased (-0.888885 --> -0.930552).  Saving model ...
Epoch: 4 cost time: 1.6047863960266113
Epoch: 4, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.537 Vali Acc: 0.931 Test Loss: 0.537 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.663907766342163
Epoch: 5, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.820 Vali Acc: 0.917 Test Loss: 0.820 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5902354717254639
Epoch: 6, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.684 Vali Acc: 0.917 Test Loss: 0.684 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6558911800384521
Epoch: 7, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.800 Vali Acc: 0.889 Test Loss: 0.800 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.258913516998291
Epoch: 8, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.954 Vali Acc: 0.903 Test Loss: 0.954 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4991445541381836
Epoch: 9, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.753 Vali Acc: 0.903 Test Loss: 0.753 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4702606201171875
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.917 Test Loss: 0.762 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4362590312957764
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.917 Test Loss: 0.784 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5004918575286865
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.889 Test Loss: 0.843 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5984628200531006
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.889 Test Loss: 0.891 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 4343348
model size : 21.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.607822895050049
Epoch: 1, Steps: 7 | Train Loss: 2.260 Vali Loss: 0.824 Vali Acc: 0.750 Test Loss: 0.824 Test Acc: 0.750
Validation loss decreased (inf --> -0.749992).  Saving model ...
Epoch: 2 cost time: 1.807985544204712
Epoch: 2, Steps: 7 | Train Loss: 0.239 Vali Loss: 0.355 Vali Acc: 0.917 Test Loss: 0.355 Test Acc: 0.917
Validation loss decreased (-0.749992 --> -0.916663).  Saving model ...
Epoch: 3 cost time: 1.7049109935760498
Epoch: 3, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.356 Vali Acc: 0.917 Test Loss: 0.356 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7685794830322266
Epoch: 4, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.682 Vali Acc: 0.903 Test Loss: 0.682 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7094874382019043
Epoch: 5, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 1.5984933376312256
Epoch: 6, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 7 cost time: 1.8086693286895752
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 8 cost time: 1.8948125839233398
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8057301044464111
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.391 Vali Acc: 0.931 Test Loss: 0.391 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7551562786102295
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7802035808563232
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6963856220245361
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6500270366668701
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.834655523300171
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.573129415512085
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.0726780891418457
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.878272533416748
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 4081204
model size : 20.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.985333204269409
Epoch: 1, Steps: 7 | Train Loss: 2.263 Vali Loss: 0.827 Vali Acc: 0.750 Test Loss: 0.827 Test Acc: 0.750
Validation loss decreased (inf --> -0.749992).  Saving model ...
Epoch: 2 cost time: 1.8138251304626465
Epoch: 2, Steps: 7 | Train Loss: 0.233 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
Validation loss decreased (-0.749992 --> -0.916663).  Saving model ...
Epoch: 3 cost time: 1.8431296348571777
Epoch: 3, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.326 Vali Acc: 0.931 Test Loss: 0.326 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 4 cost time: 1.7585999965667725
Epoch: 4, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.655 Vali Acc: 0.903 Test Loss: 0.655 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6614208221435547
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.931 Vali Acc: 0.903 Test Loss: 0.931 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.650712013244629
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.944 Test Loss: 0.475 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944440).  Saving model ...
Epoch: 7 cost time: 1.5268275737762451
Epoch: 7, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.327 Vali Acc: 0.944 Test Loss: 0.327 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 8 cost time: 1.7767548561096191
Epoch: 8, Steps: 7 | Train Loss: 0.120 Vali Loss: 1.265 Vali Acc: 0.875 Test Loss: 1.265 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7408545017242432
Epoch: 9, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 1.9905214309692383
Epoch: 10, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.559 Vali Acc: 0.931 Test Loss: 0.559 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7963762283325195
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.423 Vali Acc: 0.847 Test Loss: 1.423 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8148703575134277
Epoch: 12, Steps: 7 | Train Loss: 0.304 Vali Loss: 3.012 Vali Acc: 0.736 Test Loss: 3.012 Test Acc: 0.736
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7416024208068848
Epoch: 13, Steps: 7 | Train Loss: 0.159 Vali Loss: 1.798 Vali Acc: 0.861 Test Loss: 1.798 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7831084728240967
Epoch: 14, Steps: 7 | Train Loss: 0.059 Vali Loss: 2.370 Vali Acc: 0.847 Test Loss: 2.370 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7987251281738281
Epoch: 15, Steps: 7 | Train Loss: 0.253 Vali Loss: 1.175 Vali Acc: 0.889 Test Loss: 1.175 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6637382507324219
Epoch: 16, Steps: 7 | Train Loss: 0.060 Vali Loss: 1.068 Vali Acc: 0.903 Test Loss: 1.068 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.726780891418457
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 2.623 Vali Acc: 0.819 Test Loss: 2.623 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8161976337432861
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 4.776 Vali Acc: 0.736 Test Loss: 4.776 Test Acc: 0.736
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.745502233505249
Epoch: 19, Steps: 7 | Train Loss: 0.102 Vali Loss: 3.130 Vali Acc: 0.833 Test Loss: 3.130 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 4081204
model size : 20.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7315826416015625
Epoch: 1, Steps: 7 | Train Loss: 2.278 Vali Loss: 0.850 Vali Acc: 0.750 Test Loss: 0.850 Test Acc: 0.750
Validation loss decreased (inf --> -0.749992).  Saving model ...
Epoch: 2 cost time: 1.5474951267242432
Epoch: 2, Steps: 7 | Train Loss: 0.245 Vali Loss: 0.311 Vali Acc: 0.931 Test Loss: 0.311 Test Acc: 0.931
Validation loss decreased (-0.749992 --> -0.930552).  Saving model ...
Epoch: 3 cost time: 1.4915757179260254
Epoch: 3, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.492180347442627
Epoch: 4, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.479 Vali Acc: 0.931 Test Loss: 0.479 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.738922357559204
Epoch: 5, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.997 Vali Acc: 0.889 Test Loss: 0.997 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5935933589935303
Epoch: 6, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.725 Vali Acc: 0.917 Test Loss: 0.725 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.818659782409668
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.903 Test Loss: 0.565 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5455877780914307
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.917 Test Loss: 0.517 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6306121349334717
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.931 Test Loss: 0.498 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.607051134109497
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.931 Test Loss: 0.482 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.523841381072998
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.931 Test Loss: 0.471 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.580991268157959
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.931 Test Loss: 0.463 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 4081204
model size : 20.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.675670623779297
Epoch: 1, Steps: 7 | Train Loss: 2.263 Vali Loss: 0.929 Vali Acc: 0.736 Test Loss: 0.929 Test Acc: 0.736
Validation loss decreased (inf --> -0.736102).  Saving model ...
Epoch: 2 cost time: 1.419142723083496
Epoch: 2, Steps: 7 | Train Loss: 0.282 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
Validation loss decreased (-0.736102 --> -0.902775).  Saving model ...
Epoch: 3 cost time: 1.5016436576843262
Epoch: 3, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.359 Vali Acc: 0.931 Test Loss: 0.359 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930552).  Saving model ...
Epoch: 4 cost time: 1.6559257507324219
Epoch: 4, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.462 Vali Acc: 0.903 Test Loss: 0.462 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4530870914459229
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.581 Vali Acc: 0.917 Test Loss: 0.581 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4870331287384033
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.931 Test Loss: 0.524 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4820940494537354
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.931 Test Loss: 0.490 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.558393955230713
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.931 Test Loss: 0.625 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6967377662658691
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.931 Test Loss: 0.699 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7109971046447754
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.931 Test Loss: 0.745 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7411773204803467
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.931 Test Loss: 0.722 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.604623794555664
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.931 Test Loss: 0.653 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6042015552520752
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.931 Test Loss: 0.619 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 4081204
model size : 20.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.151235342025757
Epoch: 1, Steps: 7 | Train Loss: 2.270 Vali Loss: 0.838 Vali Acc: 0.778 Test Loss: 0.838 Test Acc: 0.778
Validation loss decreased (inf --> -0.777769).  Saving model ...
Epoch: 2 cost time: 1.678776741027832
Epoch: 2, Steps: 7 | Train Loss: 0.182 Vali Loss: 0.829 Vali Acc: 0.819 Test Loss: 0.829 Test Acc: 0.819
Validation loss decreased (-0.777769 --> -0.819436).  Saving model ...
Epoch: 3 cost time: 1.8329882621765137
Epoch: 3, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.508 Vali Acc: 0.889 Test Loss: 0.508 Test Acc: 0.889
Validation loss decreased (-0.819436 --> -0.888884).  Saving model ...
Epoch: 4 cost time: 1.7468998432159424
Epoch: 4, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.577 Vali Acc: 0.889 Test Loss: 0.577 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6822705268859863
Epoch: 5, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.799 Vali Acc: 0.903 Test Loss: 0.799 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902770).  Saving model ...
Epoch: 6 cost time: 1.839174747467041
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.788 Vali Acc: 0.903 Test Loss: 0.788 Test Acc: 0.903
Validation loss decreased (-0.902770 --> -0.902770).  Saving model ...
Epoch: 7 cost time: 2.0663819313049316
Epoch: 7, Steps: 7 | Train Loss: 0.039 Vali Loss: 1.019 Vali Acc: 0.875 Test Loss: 1.019 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8735291957855225
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.031 Vali Acc: 0.917 Test Loss: 1.031 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916656).  Saving model ...
Epoch: 9 cost time: 1.7450809478759766
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.155 Vali Acc: 0.889 Test Loss: 1.155 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6110799312591553
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.116 Vali Acc: 0.889 Test Loss: 1.116 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7277326583862305
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.050 Vali Acc: 0.889 Test Loss: 1.050 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6313576698303223
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.002 Vali Acc: 0.903 Test Loss: 1.002 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8123903274536133
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.983 Vali Acc: 0.903 Test Loss: 0.983 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5981760025024414
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.974 Vali Acc: 0.903 Test Loss: 0.974 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.730769395828247
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.903 Test Loss: 0.969 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9546418190002441
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.966 Vali Acc: 0.903 Test Loss: 0.966 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7005205154418945
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.903 Test Loss: 0.965 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4793579578399658
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.964 Vali Acc: 0.903 Test Loss: 0.964 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 3950132
model size : 19.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.709754467010498
Epoch: 1, Steps: 7 | Train Loss: 2.290 Vali Loss: 0.839 Vali Acc: 0.792 Test Loss: 0.839 Test Acc: 0.792
Validation loss decreased (inf --> -0.791658).  Saving model ...
Epoch: 2 cost time: 1.5790176391601562
Epoch: 2, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.814 Vali Acc: 0.806 Test Loss: 0.814 Test Acc: 0.806
Validation loss decreased (-0.791658 --> -0.805547).  Saving model ...
Epoch: 3 cost time: 1.6928985118865967
Epoch: 3, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.632 Vali Acc: 0.889 Test Loss: 0.632 Test Acc: 0.889
Validation loss decreased (-0.805547 --> -0.888883).  Saving model ...
Epoch: 4 cost time: 1.7533962726593018
Epoch: 4, Steps: 7 | Train Loss: 0.163 Vali Loss: 0.985 Vali Acc: 0.819 Test Loss: 0.985 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.712794542312622
Epoch: 5, Steps: 7 | Train Loss: 0.143 Vali Loss: 1.255 Vali Acc: 0.875 Test Loss: 1.255 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6934711933135986
Epoch: 6, Steps: 7 | Train Loss: 0.039 Vali Loss: 1.603 Vali Acc: 0.847 Test Loss: 1.603 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7490999698638916
Epoch: 7, Steps: 7 | Train Loss: 0.090 Vali Loss: 1.298 Vali Acc: 0.875 Test Loss: 1.298 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4442651271820068
Epoch: 8, Steps: 7 | Train Loss: 0.055 Vali Loss: 1.938 Vali Acc: 0.861 Test Loss: 1.938 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5294189453125
Epoch: 9, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.723 Vali Acc: 0.917 Test Loss: 0.723 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916659).  Saving model ...
Epoch: 10 cost time: 1.6774017810821533
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.318 Vali Acc: 0.944 Test Loss: 0.318 Test Acc: 0.944
Validation loss decreased (-0.916659 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 1.624290943145752
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.810 Vali Acc: 0.889 Test Loss: 0.810 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7257637977600098
Epoch: 12, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.991 Vali Acc: 0.833 Test Loss: 0.991 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.791682481765747
Epoch: 13, Steps: 7 | Train Loss: 0.023 Vali Loss: 1.504 Vali Acc: 0.819 Test Loss: 1.504 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6308567523956299
Epoch: 14, Steps: 7 | Train Loss: 0.211 Vali Loss: 0.986 Vali Acc: 0.875 Test Loss: 0.986 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.58091139793396
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.917 Test Loss: 1.205 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.701237678527832
Epoch: 16, Steps: 7 | Train Loss: 0.120 Vali Loss: 2.006 Vali Acc: 0.833 Test Loss: 2.006 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6898722648620605
Epoch: 17, Steps: 7 | Train Loss: 0.254 Vali Loss: 1.774 Vali Acc: 0.889 Test Loss: 1.774 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6821696758270264
Epoch: 18, Steps: 7 | Train Loss: 0.314 Vali Loss: 3.557 Vali Acc: 0.875 Test Loss: 3.557 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5536110401153564
Epoch: 19, Steps: 7 | Train Loss: 0.630 Vali Loss: 6.060 Vali Acc: 0.819 Test Loss: 6.060 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.881251335144043
Epoch: 20, Steps: 7 | Train Loss: 0.078 Vali Loss: 2.389 Vali Acc: 0.819 Test Loss: 2.389 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 3950132
model size : 19.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.088808059692383
Epoch: 1, Steps: 7 | Train Loss: 2.258 Vali Loss: 0.857 Vali Acc: 0.806 Test Loss: 0.857 Test Acc: 0.806
Validation loss decreased (inf --> -0.805547).  Saving model ...
Epoch: 2 cost time: 1.5256092548370361
Epoch: 2, Steps: 7 | Train Loss: 0.200 Vali Loss: 0.873 Vali Acc: 0.778 Test Loss: 0.873 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6780786514282227
Epoch: 3, Steps: 7 | Train Loss: 0.080 Vali Loss: 1.288 Vali Acc: 0.833 Test Loss: 1.288 Test Acc: 0.833
Validation loss decreased (-0.805547 --> -0.833320).  Saving model ...
Epoch: 4 cost time: 1.542539119720459
Epoch: 4, Steps: 7 | Train Loss: 0.453 Vali Loss: 0.945 Vali Acc: 0.833 Test Loss: 0.945 Test Acc: 0.833
Validation loss decreased (-0.833320 --> -0.833324).  Saving model ...
Epoch: 5 cost time: 1.5165832042694092
Epoch: 5, Steps: 7 | Train Loss: 0.109 Vali Loss: 1.162 Vali Acc: 0.875 Test Loss: 1.162 Test Acc: 0.875
Validation loss decreased (-0.833324 --> -0.874988).  Saving model ...
Epoch: 6 cost time: 1.5062367916107178
Epoch: 6, Steps: 7 | Train Loss: 0.090 Vali Loss: 1.547 Vali Acc: 0.875 Test Loss: 1.547 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3972461223602295
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.862 Vali Acc: 0.917 Test Loss: 0.862 Test Acc: 0.917
Validation loss decreased (-0.874988 --> -0.916658).  Saving model ...
Epoch: 8 cost time: 1.490081787109375
Epoch: 8, Steps: 7 | Train Loss: 0.203 Vali Loss: 2.019 Vali Acc: 0.875 Test Loss: 2.019 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7117929458618164
Epoch: 9, Steps: 7 | Train Loss: 0.253 Vali Loss: 1.246 Vali Acc: 0.903 Test Loss: 1.246 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4353609085083008
Epoch: 10, Steps: 7 | Train Loss: 0.035 Vali Loss: 1.465 Vali Acc: 0.875 Test Loss: 1.465 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4767992496490479
Epoch: 11, Steps: 7 | Train Loss: 0.096 Vali Loss: 2.079 Vali Acc: 0.833 Test Loss: 2.079 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.495591163635254
Epoch: 12, Steps: 7 | Train Loss: 0.113 Vali Loss: 1.666 Vali Acc: 0.847 Test Loss: 1.666 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5640695095062256
Epoch: 13, Steps: 7 | Train Loss: 0.073 Vali Loss: 2.242 Vali Acc: 0.861 Test Loss: 2.242 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4716897010803223
Epoch: 14, Steps: 7 | Train Loss: 0.068 Vali Loss: 1.333 Vali Acc: 0.903 Test Loss: 1.333 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5109224319458008
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.944 Test Loss: 0.724 Test Acc: 0.944
Validation loss decreased (-0.916658 --> -0.944437).  Saving model ...
Epoch: 16 cost time: 1.4685275554656982
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 2.479 Vali Acc: 0.903 Test Loss: 2.479 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4057669639587402
Epoch: 17, Steps: 7 | Train Loss: 0.026 Vali Loss: 1.026 Vali Acc: 0.917 Test Loss: 1.026 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4678010940551758
Epoch: 18, Steps: 7 | Train Loss: 0.276 Vali Loss: 1.914 Vali Acc: 0.889 Test Loss: 1.914 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6490850448608398
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 3.961 Vali Acc: 0.833 Test Loss: 3.961 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5650699138641357
Epoch: 20, Steps: 7 | Train Loss: 0.264 Vali Loss: 4.055 Vali Acc: 0.861 Test Loss: 4.055 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5978493690490723
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.966 Vali Acc: 0.931 Test Loss: 1.966 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4402260780334473
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.629 Vali Acc: 0.917 Test Loss: 1.629 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3891627788543701
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.632 Vali Acc: 0.931 Test Loss: 1.632 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6361324787139893
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.413 Vali Acc: 0.931 Test Loss: 2.413 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6074068546295166
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 3.275 Vali Acc: 0.889 Test Loss: 3.275 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 3950132
model size : 19.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.574361562728882
Epoch: 1, Steps: 7 | Train Loss: 2.307 Vali Loss: 0.937 Vali Acc: 0.847 Test Loss: 0.937 Test Acc: 0.847
Validation loss decreased (inf --> -0.847213).  Saving model ...
Epoch: 2 cost time: 1.3978970050811768
Epoch: 2, Steps: 7 | Train Loss: 0.261 Vali Loss: 0.878 Vali Acc: 0.806 Test Loss: 0.878 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3131728172302246
Epoch: 3, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.547 Vali Acc: 0.903 Test Loss: 0.547 Test Acc: 0.903
Validation loss decreased (-0.847213 --> -0.902772).  Saving model ...
Epoch: 4 cost time: 1.3458564281463623
Epoch: 4, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.574 Vali Acc: 0.903 Test Loss: 0.574 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3885023593902588
Epoch: 5, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.533 Vali Acc: 0.917 Test Loss: 0.533 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916661).  Saving model ...
Epoch: 6 cost time: 1.5500679016113281
Epoch: 6, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.850 Vali Acc: 0.889 Test Loss: 0.850 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4513180255889893
Epoch: 7, Steps: 7 | Train Loss: 0.013 Vali Loss: 1.418 Vali Acc: 0.889 Test Loss: 1.418 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.50954008102417
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.725 Vali Acc: 0.833 Test Loss: 1.725 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3904709815979004
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.946 Vali Acc: 0.889 Test Loss: 0.946 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4779105186462402
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 1.202 Vali Acc: 0.861 Test Loss: 1.202 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3046543598175049
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.263 Vali Acc: 0.833 Test Loss: 2.263 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4801115989685059
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.653 Vali Acc: 0.903 Test Loss: 0.653 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4191946983337402
Epoch: 13, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 1.6183335781097412
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.517 Vali Acc: 0.889 Test Loss: 0.517 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4387075901031494
Epoch: 15, Steps: 7 | Train Loss: 0.259 Vali Loss: 0.838 Vali Acc: 0.889 Test Loss: 0.838 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5160391330718994
Epoch: 16, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.934 Vali Acc: 0.861 Test Loss: 0.934 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5174105167388916
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.769 Vali Acc: 0.917 Test Loss: 0.769 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3844578266143799
Epoch: 18, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.948 Vali Acc: 0.917 Test Loss: 0.948 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4777376651763916
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.260 Vali Acc: 0.889 Test Loss: 1.260 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5840988159179688
Epoch: 20, Steps: 7 | Train Loss: 0.365 Vali Loss: 0.858 Vali Acc: 0.889 Test Loss: 0.858 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3180952072143555
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.057 Vali Acc: 0.889 Test Loss: 1.057 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.32901930809021
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.875 Vali Acc: 0.903 Test Loss: 0.875 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4783332347869873
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.376 Vali Acc: 0.889 Test Loss: 1.376 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 3950132
model size : 19.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.027777194976807
Epoch: 1, Steps: 7 | Train Loss: 2.290 Vali Loss: 0.902 Vali Acc: 0.819 Test Loss: 0.902 Test Acc: 0.819
Validation loss decreased (inf --> -0.819435).  Saving model ...
Epoch: 2 cost time: 1.5819106101989746
Epoch: 2, Steps: 7 | Train Loss: 0.232 Vali Loss: 0.674 Vali Acc: 0.847 Test Loss: 0.674 Test Acc: 0.847
Validation loss decreased (-0.819435 --> -0.847215).  Saving model ...
Epoch: 3 cost time: 1.8786613941192627
Epoch: 3, Steps: 7 | Train Loss: 0.262 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874997).  Saving model ...
Epoch: 4 cost time: 1.780684471130371
Epoch: 4, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888885).  Saving model ...
Epoch: 5 cost time: 1.8270723819732666
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 6 cost time: 1.6550428867340088
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.8937149047851562
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.944 Test Loss: 0.321 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944441).  Saving model ...
Epoch: 8 cost time: 1.7434701919555664
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 1.6283385753631592
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.386 Vali Acc: 0.903 Test Loss: 0.386 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5362443923950195
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.903 Test Loss: 0.335 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.594667673110962
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.6423847675323486
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.5024771690368652
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.6456351280212402
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.627568006515503
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6295924186706543
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6104931831359863
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0366415977478027
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7821671962738037
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6096360683441162
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6117260456085205
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.747584581375122
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8682780265808105
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 3884596
model size : 19.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.6967551708221436
Epoch: 1, Steps: 7 | Train Loss: 2.293 Vali Loss: 0.886 Vali Acc: 0.819 Test Loss: 0.886 Test Acc: 0.819
Validation loss decreased (inf --> -0.819436).  Saving model ...
Epoch: 2 cost time: 1.6728429794311523
Epoch: 2, Steps: 7 | Train Loss: 0.247 Vali Loss: 0.582 Vali Acc: 0.847 Test Loss: 0.582 Test Acc: 0.847
Validation loss decreased (-0.819436 --> -0.847216).  Saving model ...
Epoch: 3 cost time: 1.6427886486053467
Epoch: 3, Steps: 7 | Train Loss: 0.289 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
Validation loss decreased (-0.847216 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 1.530118465423584
Epoch: 4, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.555 Vali Acc: 0.903 Test Loss: 0.555 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6443419456481934
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 1.5245418548583984
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7968027591705322
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.379 Vali Acc: 0.931 Test Loss: 0.379 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8577499389648438
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.526 Vali Acc: 0.903 Test Loss: 0.526 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8146297931671143
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.903 Test Loss: 0.454 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5914843082427979
Epoch: 10, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.445 Vali Acc: 0.903 Test Loss: 0.445 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7261343002319336
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.903 Test Loss: 0.577 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.598494529724121
Epoch: 12, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.643 Vali Acc: 0.889 Test Loss: 0.643 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5992014408111572
Epoch: 13, Steps: 7 | Train Loss: 0.086 Vali Loss: 1.280 Vali Acc: 0.833 Test Loss: 1.280 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7315993309020996
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.589 Vali Acc: 0.889 Test Loss: 0.589 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.960845947265625
Epoch: 15, Steps: 7 | Train Loss: 0.281 Vali Loss: 0.896 Vali Acc: 0.889 Test Loss: 0.896 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 3884596
model size : 19.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.205718755722046
Epoch: 1, Steps: 7 | Train Loss: 2.322 Vali Loss: 0.855 Vali Acc: 0.847 Test Loss: 0.855 Test Acc: 0.847
Validation loss decreased (inf --> -0.847214).  Saving model ...
Epoch: 2 cost time: 1.6250715255737305
Epoch: 2, Steps: 7 | Train Loss: 0.280 Vali Loss: 0.438 Vali Acc: 0.847 Test Loss: 0.438 Test Acc: 0.847
Validation loss decreased (-0.847214 --> -0.847218).  Saving model ...
Epoch: 3 cost time: 1.530477523803711
Epoch: 3, Steps: 7 | Train Loss: 0.260 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.847218 --> -0.916664).  Saving model ...
Epoch: 4 cost time: 1.6152527332305908
Epoch: 4, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.572 Vali Acc: 0.889 Test Loss: 0.572 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.746523141860962
Epoch: 5, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 1.568213701248169
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.931 Test Loss: 0.432 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5593786239624023
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.399 Vali Acc: 0.917 Test Loss: 0.399 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.690201759338379
Epoch: 8, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.690 Vali Acc: 0.917 Test Loss: 0.690 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7111306190490723
Epoch: 9, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.667 Vali Acc: 0.931 Test Loss: 0.667 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5135748386383057
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 1.564 Vali Acc: 0.806 Test Loss: 1.564 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6203887462615967
Epoch: 11, Steps: 7 | Train Loss: 0.158 Vali Loss: 1.218 Vali Acc: 0.917 Test Loss: 1.218 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7417008876800537
Epoch: 12, Steps: 7 | Train Loss: 0.128 Vali Loss: 1.176 Vali Acc: 0.972 Test Loss: 1.176 Test Acc: 0.972
Validation loss decreased (-0.944442 --> -0.972210).  Saving model ...
Epoch: 13 cost time: 1.7304327487945557
Epoch: 13, Steps: 7 | Train Loss: 0.333 Vali Loss: 2.925 Vali Acc: 0.806 Test Loss: 2.925 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5525944232940674
Epoch: 14, Steps: 7 | Train Loss: 0.181 Vali Loss: 0.402 Vali Acc: 0.931 Test Loss: 0.402 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6942832469940186
Epoch: 15, Steps: 7 | Train Loss: 0.205 Vali Loss: 0.917 Vali Acc: 0.903 Test Loss: 0.917 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.618318796157837
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 1.265 Vali Acc: 0.944 Test Loss: 1.265 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6884398460388184
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.521 Vali Acc: 0.958 Test Loss: 0.521 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5539307594299316
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.972 Test Loss: 0.373 Test Acc: 0.972
Validation loss decreased (-0.972210 --> -0.972218).  Saving model ...
Epoch: 19 cost time: 1.6706750392913818
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.360 Vali Acc: 0.958 Test Loss: 0.360 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5629701614379883
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.972 Test Loss: 0.347 Test Acc: 0.972
Validation loss decreased (-0.972218 --> -0.972219).  Saving model ...
Epoch: 21 cost time: 1.596864938735962
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.972 Test Loss: 0.339 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 22 cost time: 1.596170425415039
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.972 Test Loss: 0.338 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 23 cost time: 1.7767243385314941
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.972 Test Loss: 0.338 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 24 cost time: 1.5550487041473389
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.972 Test Loss: 0.338 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5989048480987549
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.972 Test Loss: 0.338 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5691583156585693
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.972 Test Loss: 0.338 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.57257080078125
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.972 Test Loss: 0.338 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7619526386260986
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.972 Test Loss: 0.337 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 29 cost time: 1.6133222579956055
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.972 Test Loss: 0.337 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 30 cost time: 1.6623551845550537
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.972 Test Loss: 0.337 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 31 cost time: 1.657182216644287
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.972 Test Loss: 0.337 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 32 cost time: 1.5925657749176025
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.972 Test Loss: 0.337 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 33 cost time: 1.4801180362701416
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.972 Test Loss: 0.337 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 34 cost time: 1.8071939945220947
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.972 Test Loss: 0.337 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 35 cost time: 1.6554985046386719
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.972 Test Loss: 0.337 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 36 cost time: 1.7492551803588867
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.972 Test Loss: 0.337 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 37 cost time: 1.8203296661376953
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.972 Test Loss: 0.336 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 38 cost time: 1.620065689086914
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.972 Test Loss: 0.336 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 39 cost time: 1.4693725109100342
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.972 Test Loss: 0.336 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 40 cost time: 1.8730449676513672
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.972 Test Loss: 0.336 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 41 cost time: 1.8346889019012451
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.972 Test Loss: 0.336 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 42 cost time: 1.7257881164550781
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.972 Test Loss: 0.336 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 43 cost time: 1.440631628036499
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.972 Test Loss: 0.336 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 44 cost time: 1.7003469467163086
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.972 Test Loss: 0.336 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 45 cost time: 1.5887651443481445
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.972 Test Loss: 0.336 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 46 cost time: 1.6761956214904785
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.972 Test Loss: 0.336 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 47 cost time: 1.826714277267456
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.972 Test Loss: 0.336 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 48 cost time: 1.7608163356781006
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.972 Test Loss: 0.336 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 49 cost time: 1.5959839820861816
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.972 Test Loss: 0.336 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 50 cost time: 1.8275558948516846
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.972 Test Loss: 0.336 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 51 cost time: 1.4460275173187256
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.972 Test Loss: 0.335 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 52 cost time: 1.3855671882629395
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.972 Test Loss: 0.335 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 53 cost time: 1.6077649593353271
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.972 Test Loss: 0.335 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 54 cost time: 1.4388489723205566
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.972 Test Loss: 0.335 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 55 cost time: 1.5042316913604736
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.972 Test Loss: 0.335 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 56 cost time: 1.4614417552947998
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.972 Test Loss: 0.335 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 57 cost time: 1.4045629501342773
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.972 Test Loss: 0.335 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 58 cost time: 1.538670539855957
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.972 Test Loss: 0.335 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 59 cost time: 1.7019460201263428
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.972 Test Loss: 0.335 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 60 cost time: 1.5449883937835693
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.972 Test Loss: 0.335 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 61 cost time: 1.498420000076294
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.972 Test Loss: 0.335 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 62 cost time: 1.7628674507141113
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.972 Test Loss: 0.335 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 63 cost time: 1.8538672924041748
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.972 Test Loss: 0.334 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 64 cost time: 1.5328521728515625
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.972 Test Loss: 0.334 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 65 cost time: 1.6675050258636475
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.972 Test Loss: 0.334 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 66 cost time: 1.4172754287719727
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.972 Test Loss: 0.334 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 67 cost time: 1.4016752243041992
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.972 Test Loss: 0.334 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 68 cost time: 1.4666242599487305
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.972 Test Loss: 0.334 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 69 cost time: 1.6369569301605225
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.972 Test Loss: 0.334 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 70 cost time: 1.5926826000213623
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.972 Test Loss: 0.334 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 71 cost time: 1.8239500522613525
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.972 Test Loss: 0.334 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 72 cost time: 1.6980421543121338
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.972 Test Loss: 0.334 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 73 cost time: 1.5443530082702637
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.972 Test Loss: 0.334 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 74 cost time: 1.665869951248169
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.972 Test Loss: 0.333 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 75 cost time: 1.6768875122070312
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.972 Test Loss: 0.333 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 76 cost time: 1.7356507778167725
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.972 Test Loss: 0.333 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 77 cost time: 1.535034418106079
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.972 Test Loss: 0.333 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 78 cost time: 1.606276512145996
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.972 Test Loss: 0.333 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 79 cost time: 1.5327811241149902
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.972 Test Loss: 0.333 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 80 cost time: 1.8551652431488037
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.972 Test Loss: 0.333 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 81 cost time: 1.7722420692443848
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.972 Test Loss: 0.333 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 82 cost time: 1.6612670421600342
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.972 Test Loss: 0.333 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 83 cost time: 1.6375455856323242
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.972 Test Loss: 0.333 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 84 cost time: 1.5639374256134033
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.972 Test Loss: 0.333 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 85 cost time: 1.5405666828155518
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.972 Test Loss: 0.333 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 86 cost time: 1.6142005920410156
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.972 Test Loss: 0.333 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 87 cost time: 1.5900952816009521
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.972 Test Loss: 0.333 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 88 cost time: 1.4670155048370361
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.972 Test Loss: 0.332 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 89 cost time: 1.824859380722046
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.972 Test Loss: 0.332 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 90 cost time: 1.7394037246704102
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.972 Test Loss: 0.332 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 91 cost time: 1.9765937328338623
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.972 Test Loss: 0.332 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 92 cost time: 1.7051959037780762
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.972 Test Loss: 0.332 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 93 cost time: 1.5959577560424805
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.972 Test Loss: 0.332 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 94 cost time: 1.545729398727417
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.972 Test Loss: 0.332 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 95 cost time: 1.787870168685913
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.972 Test Loss: 0.332 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 96 cost time: 1.490729808807373
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.972 Test Loss: 0.332 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 97 cost time: 1.403134822845459
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.972 Test Loss: 0.332 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 98 cost time: 1.548020362854004
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.972 Test Loss: 0.332 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 99 cost time: 1.5921037197113037
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.972 Test Loss: 0.332 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 100 cost time: 1.4455640316009521
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.972 Test Loss: 0.332 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 3884596
model size : 19.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.885481595993042
Epoch: 1, Steps: 7 | Train Loss: 2.362 Vali Loss: 0.910 Vali Acc: 0.819 Test Loss: 0.910 Test Acc: 0.819
Validation loss decreased (inf --> -0.819435).  Saving model ...
Epoch: 2 cost time: 1.3112058639526367
Epoch: 2, Steps: 7 | Train Loss: 0.365 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
Validation loss decreased (-0.819435 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 1.4407222270965576
Epoch: 3, Steps: 7 | Train Loss: 0.263 Vali Loss: 0.381 Vali Acc: 0.917 Test Loss: 0.381 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 1.4269382953643799
Epoch: 4, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.332 Vali Acc: 0.931 Test Loss: 0.332 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 5 cost time: 1.3122012615203857
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.875 Test Loss: 0.731 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.504992961883545
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.917 Test Loss: 0.650 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6627147197723389
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.917 Test Loss: 0.525 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4086229801177979
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.917 Test Loss: 0.504 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1927368640899658
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.903 Test Loss: 0.495 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4144461154937744
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.903 Test Loss: 0.439 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3947346210479736
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.903 Test Loss: 0.415 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2612438201904297
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.403 Vali Acc: 0.931 Test Loss: 0.403 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2445704936981201
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.397 Vali Acc: 0.931 Test Loss: 0.397 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4516541957855225
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.393 Vali Acc: 0.931 Test Loss: 0.393 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 3884596
model size : 19.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.387112379074097
Epoch: 1, Steps: 7 | Train Loss: 2.245 Vali Loss: 1.069 Vali Acc: 0.708 Test Loss: 1.069 Test Acc: 0.708
Validation loss decreased (inf --> -0.708323).  Saving model ...
Epoch: 2 cost time: 1.8547823429107666
Epoch: 2, Steps: 7 | Train Loss: 0.260 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
Validation loss decreased (-0.708323 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 1.8424677848815918
Epoch: 3, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.620 Vali Acc: 0.903 Test Loss: 0.620 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902772).  Saving model ...
Epoch: 4 cost time: 2.033008098602295
Epoch: 4, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.548 Vali Acc: 0.917 Test Loss: 0.548 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916661).  Saving model ...
Epoch: 5 cost time: 1.8515381813049316
Epoch: 5, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.644 Vali Acc: 0.903 Test Loss: 0.644 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6790575981140137
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.023 Vali Acc: 0.875 Test Loss: 1.023 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5985491275787354
Epoch: 7, Steps: 7 | Train Loss: 0.011 Vali Loss: 1.490 Vali Acc: 0.889 Test Loss: 1.490 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7863810062408447
Epoch: 8, Steps: 7 | Train Loss: 0.052 Vali Loss: 1.630 Vali Acc: 0.889 Test Loss: 1.630 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4218952655792236
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.875 Test Loss: 1.637 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3690416812896729
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.047 Vali Acc: 0.847 Test Loss: 2.047 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5250134468078613
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.452 Vali Acc: 0.819 Test Loss: 2.452 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.470106840133667
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 1.472 Vali Acc: 0.889 Test Loss: 1.472 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4925403594970703
Epoch: 13, Steps: 7 | Train Loss: 0.133 Vali Loss: 1.489 Vali Acc: 0.889 Test Loss: 1.489 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6096796989440918
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.861 Test Loss: 1.855 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 3851828
model size : 19.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.13828182220459
Epoch: 1, Steps: 7 | Train Loss: 2.201 Vali Loss: 1.032 Vali Acc: 0.722 Test Loss: 1.032 Test Acc: 0.722
Validation loss decreased (inf --> -0.722212).  Saving model ...
Epoch: 2 cost time: 1.6541171073913574
Epoch: 2, Steps: 7 | Train Loss: 0.269 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
Validation loss decreased (-0.722212 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 1.4125120639801025
Epoch: 3, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.562 Vali Acc: 0.903 Test Loss: 0.562 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902772).  Saving model ...
Epoch: 4 cost time: 1.6330146789550781
Epoch: 4, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.422 Vali Acc: 0.931 Test Loss: 0.422 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930551).  Saving model ...
Epoch: 5 cost time: 1.6877501010894775
Epoch: 5, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.561 Vali Acc: 0.903 Test Loss: 0.561 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5330390930175781
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.782 Vali Acc: 0.861 Test Loss: 0.782 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4930872917175293
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.833 Test Loss: 1.437 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6011850833892822
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.875 Test Loss: 1.791 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.703705072402954
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.901 Vali Acc: 0.875 Test Loss: 1.901 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3646752834320068
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.963 Vali Acc: 0.875 Test Loss: 1.963 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6893000602722168
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.990 Vali Acc: 0.875 Test Loss: 1.990 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.535778522491455
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.002 Vali Acc: 0.875 Test Loss: 2.002 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.57574462890625
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.006 Vali Acc: 0.875 Test Loss: 2.006 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5632743835449219
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 2.005 Vali Acc: 0.875 Test Loss: 2.005 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 3851828
model size : 19.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8082120418548584
Epoch: 1, Steps: 7 | Train Loss: 2.191 Vali Loss: 1.025 Vali Acc: 0.722 Test Loss: 1.025 Test Acc: 0.722
Validation loss decreased (inf --> -0.722212).  Saving model ...
Epoch: 2 cost time: 1.5405633449554443
Epoch: 2, Steps: 7 | Train Loss: 0.299 Vali Loss: 0.416 Vali Acc: 0.861 Test Loss: 0.416 Test Acc: 0.861
Validation loss decreased (-0.722212 --> -0.861107).  Saving model ...
Epoch: 3 cost time: 1.6935162544250488
Epoch: 3, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.687 Vali Acc: 0.903 Test Loss: 0.687 Test Acc: 0.903
Validation loss decreased (-0.861107 --> -0.902771).  Saving model ...
Epoch: 4 cost time: 1.4552054405212402
Epoch: 4, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.958 Test Loss: 0.240 Test Acc: 0.958
Validation loss decreased (-0.902771 --> -0.958331).  Saving model ...
Epoch: 5 cost time: 1.5375688076019287
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.726 Vali Acc: 0.917 Test Loss: 0.726 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3831768035888672
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.487 Vali Acc: 0.875 Test Loss: 1.487 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5554935932159424
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 1.660 Vali Acc: 0.806 Test Loss: 1.660 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.520458459854126
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.819 Test Loss: 1.297 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.654608964920044
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.055 Vali Acc: 0.903 Test Loss: 1.055 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6233983039855957
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.903 Test Loss: 1.590 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.55830979347229
Epoch: 11, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.837 Vali Acc: 0.931 Test Loss: 0.837 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5643532276153564
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.917 Test Loss: 0.517 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.465862512588501
Epoch: 13, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4472148418426514
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.917 Test Loss: 0.589 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3851828
model size : 19.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.7831199169158936
Epoch: 1, Steps: 7 | Train Loss: 2.200 Vali Loss: 1.011 Vali Acc: 0.708 Test Loss: 1.011 Test Acc: 0.708
Validation loss decreased (inf --> -0.708323).  Saving model ...
Epoch: 2 cost time: 1.4571044445037842
Epoch: 2, Steps: 7 | Train Loss: 0.362 Vali Loss: 0.453 Vali Acc: 0.861 Test Loss: 0.453 Test Acc: 0.861
Validation loss decreased (-0.708323 --> -0.861107).  Saving model ...
Epoch: 3 cost time: 1.539454460144043
Epoch: 3, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
Validation loss decreased (-0.861107 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 1.4650609493255615
Epoch: 4, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.425 Vali Acc: 0.931 Test Loss: 0.425 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930551).  Saving model ...
Epoch: 5 cost time: 1.4069440364837646
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.812 Vali Acc: 0.903 Test Loss: 0.812 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5143580436706543
Epoch: 6, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.651 Vali Acc: 0.889 Test Loss: 0.651 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6276135444641113
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 1.885 Vali Acc: 0.847 Test Loss: 1.885 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6267290115356445
Epoch: 8, Steps: 7 | Train Loss: 0.034 Vali Loss: 1.031 Vali Acc: 0.903 Test Loss: 1.031 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5699143409729004
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.534 Vali Acc: 0.958 Test Loss: 0.534 Test Acc: 0.958
Validation loss decreased (-0.930551 --> -0.958328).  Saving model ...
Epoch: 10 cost time: 1.4545636177062988
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.061 Vali Acc: 0.861 Test Loss: 1.061 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4223151206970215
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.118 Vali Acc: 0.903 Test Loss: 1.118 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.582721471786499
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.673 Vali Acc: 0.861 Test Loss: 1.673 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6415948867797852
Epoch: 13, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.615 Vali Acc: 0.917 Test Loss: 0.615 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.445913314819336
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.816 Vali Acc: 0.889 Test Loss: 1.816 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6726841926574707
Epoch: 15, Steps: 7 | Train Loss: 0.128 Vali Loss: 1.095 Vali Acc: 0.875 Test Loss: 1.095 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3137030601501465
Epoch: 16, Steps: 7 | Train Loss: 0.099 Vali Loss: 2.487 Vali Acc: 0.778 Test Loss: 2.487 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4831604957580566
Epoch: 17, Steps: 7 | Train Loss: 0.205 Vali Loss: 1.780 Vali Acc: 0.903 Test Loss: 1.780 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5220036506652832
Epoch: 18, Steps: 7 | Train Loss: 0.565 Vali Loss: 1.807 Vali Acc: 0.833 Test Loss: 1.807 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3772032260894775
Epoch: 19, Steps: 7 | Train Loss: 0.084 Vali Loss: 1.933 Vali Acc: 0.875 Test Loss: 1.933 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3851828
model size : 19.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.961707592010498
Epoch: 1, Steps: 7 | Train Loss: 2.414 Vali Loss: 1.212 Vali Acc: 0.694 Test Loss: 1.212 Test Acc: 0.694
Validation loss decreased (inf --> -0.694432).  Saving model ...
Epoch: 2 cost time: 1.286170244216919
Epoch: 2, Steps: 7 | Train Loss: 0.418 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
Validation loss decreased (-0.694432 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 1.3288719654083252
Epoch: 3, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.372 Vali Acc: 0.903 Test Loss: 0.372 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 1.3381259441375732
Epoch: 4, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 1.5176856517791748
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.448 Vali Acc: 0.889 Test Loss: 0.448 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4734923839569092
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.847 Test Loss: 0.812 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1805284023284912
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.875 Test Loss: 0.840 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3109707832336426
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.875 Test Loss: 0.858 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4004144668579102
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.875 Test Loss: 0.865 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4090862274169922
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.875 Test Loss: 0.864 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3566629886627197
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.861 Test Loss: 0.854 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2541890144348145
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.861 Test Loss: 0.838 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.428889513015747
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.861 Test Loss: 0.821 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6267564296722412
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.861 Test Loss: 0.805 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 2401076
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.66522216796875
Epoch: 1, Steps: 7 | Train Loss: 2.402 Vali Loss: 1.236 Vali Acc: 0.694 Test Loss: 1.236 Test Acc: 0.694
Validation loss decreased (inf --> -0.694432).  Saving model ...
Epoch: 2 cost time: 1.2676713466644287
Epoch: 2, Steps: 7 | Train Loss: 0.438 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
Validation loss decreased (-0.694432 --> -0.888885).  Saving model ...
Epoch: 3 cost time: 1.2952890396118164
Epoch: 3, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 1.2348880767822266
Epoch: 4, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.400 Vali Acc: 0.889 Test Loss: 0.400 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.299694299697876
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.474 Vali Acc: 0.889 Test Loss: 0.474 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5885744094848633
Epoch: 6, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.465 Vali Acc: 0.903 Test Loss: 0.465 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3610844612121582
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.436 Vali Acc: 0.903 Test Loss: 0.436 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.366074800491333
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.338 Vali Acc: 0.931 Test Loss: 0.338 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 1.3400187492370605
Epoch: 9, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4836935997009277
Epoch: 10, Steps: 7 | Train Loss: 0.010 Vali Loss: 1.345 Vali Acc: 0.806 Test Loss: 1.345 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6019575595855713
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.664 Vali Acc: 0.875 Test Loss: 0.664 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5120210647583008
Epoch: 12, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7112164497375488
Epoch: 13, Steps: 7 | Train Loss: 0.043 Vali Loss: 1.420 Vali Acc: 0.833 Test Loss: 1.420 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5981147289276123
Epoch: 14, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.710 Vali Acc: 0.819 Test Loss: 0.710 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.375823974609375
Epoch: 15, Steps: 7 | Train Loss: 0.038 Vali Loss: 1.282 Vali Acc: 0.847 Test Loss: 1.282 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3662142753601074
Epoch: 16, Steps: 7 | Train Loss: 0.039 Vali Loss: 1.420 Vali Acc: 0.889 Test Loss: 1.420 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5280795097351074
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.917 Test Loss: 1.013 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5135204792022705
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.917 Test Loss: 1.276 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2401076
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.67169189453125
Epoch: 1, Steps: 7 | Train Loss: 2.372 Vali Loss: 1.231 Vali Acc: 0.750 Test Loss: 1.231 Test Acc: 0.750
Validation loss decreased (inf --> -0.749988).  Saving model ...
Epoch: 2 cost time: 1.2744569778442383
Epoch: 2, Steps: 7 | Train Loss: 0.454 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
Validation loss decreased (-0.749988 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 1.1262860298156738
Epoch: 3, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916664).  Saving model ...
Epoch: 4 cost time: 1.1103923320770264
Epoch: 4, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 1.1743693351745605
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.399 Vali Acc: 0.917 Test Loss: 0.399 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.282728672027588
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.931 Test Loss: 0.289 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 1.0675625801086426
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.381427526473999
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4181854724884033
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3220226764678955
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1406307220458984
Epoch: 11, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.1718792915344238
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.2542028427124023
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.482 Vali Acc: 0.889 Test Loss: 0.482 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2812094688415527
Epoch: 14, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.437110185623169
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3708255290985107
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1950109004974365
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.167173147201538
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.875 Test Loss: 0.474 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1968703269958496
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.642 Vali Acc: 0.875 Test Loss: 0.642 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2386493682861328
Epoch: 20, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.612 Vali Acc: 0.889 Test Loss: 0.612 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2675225734710693
Epoch: 21, Steps: 7 | Train Loss: 0.112 Vali Loss: 1.645 Vali Acc: 0.833 Test Loss: 1.645 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.24591064453125
Epoch: 22, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.371 Vali Acc: 0.931 Test Loss: 0.371 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2401076
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8682730197906494
Epoch: 1, Steps: 7 | Train Loss: 2.344 Vali Loss: 1.311 Vali Acc: 0.736 Test Loss: 1.311 Test Acc: 0.736
Validation loss decreased (inf --> -0.736098).  Saving model ...
Epoch: 2 cost time: 1.2100260257720947
Epoch: 2, Steps: 7 | Train Loss: 0.548 Vali Loss: 0.344 Vali Acc: 0.903 Test Loss: 0.344 Test Acc: 0.903
Validation loss decreased (-0.736098 --> -0.902774).  Saving model ...
Epoch: 3 cost time: 1.2317214012145996
Epoch: 3, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4237933158874512
Epoch: 4, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.902774 --> -0.944442).  Saving model ...
Epoch: 5 cost time: 1.0648424625396729
Epoch: 5, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3210997581481934
Epoch: 6, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.413774013519287
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4268758296966553
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6317737102508545
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4512314796447754
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3171088695526123
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4055707454681396
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2782118320465088
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2973976135253906
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2401076
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.555403232574463
Epoch: 1, Steps: 7 | Train Loss: 2.398 Vali Loss: 1.202 Vali Acc: 0.667 Test Loss: 1.202 Test Acc: 0.667
Validation loss decreased (inf --> -0.666655).  Saving model ...
Epoch: 2 cost time: 1.502244234085083
Epoch: 2, Steps: 7 | Train Loss: 0.421 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.666655 --> -0.888886).  Saving model ...
Epoch: 3 cost time: 1.2732975482940674
Epoch: 3, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930553).  Saving model ...
Epoch: 4 cost time: 1.2779510021209717
Epoch: 4, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.550 Vali Acc: 0.903 Test Loss: 0.550 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4051532745361328
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.510 Vali Acc: 0.903 Test Loss: 0.510 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2892472743988037
Epoch: 6, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.477 Vali Acc: 0.917 Test Loss: 0.477 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3431518077850342
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.917 Test Loss: 0.478 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3385155200958252
Epoch: 8, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.491 Vali Acc: 0.917 Test Loss: 0.491 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2068586349487305
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.903 Test Loss: 0.676 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2345466613769531
Epoch: 10, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.440 Vali Acc: 0.917 Test Loss: 0.440 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3358559608459473
Epoch: 11, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.435 Vali Acc: 0.917 Test Loss: 0.435 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.23655104637146
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.903 Test Loss: 0.552 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2827088832855225
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.875 Test Loss: 0.873 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2138932
model size : 10.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6775224208831787
Epoch: 1, Steps: 7 | Train Loss: 2.389 Vali Loss: 1.217 Vali Acc: 0.736 Test Loss: 1.217 Test Acc: 0.736
Validation loss decreased (inf --> -0.736099).  Saving model ...
Epoch: 2 cost time: 1.2963571548461914
Epoch: 2, Steps: 7 | Train Loss: 0.423 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
Validation loss decreased (-0.736099 --> -0.902775).  Saving model ...
Epoch: 3 cost time: 1.2283167839050293
Epoch: 3, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 4 cost time: 1.351381778717041
Epoch: 4, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.510 Vali Acc: 0.903 Test Loss: 0.510 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.360388994216919
Epoch: 5, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.470 Vali Acc: 0.903 Test Loss: 0.470 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.239114761352539
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.688 Vali Acc: 0.889 Test Loss: 0.688 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.336341142654419
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.688 Vali Acc: 0.903 Test Loss: 0.688 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4136419296264648
Epoch: 8, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.623 Vali Acc: 0.917 Test Loss: 0.623 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.262253999710083
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.889 Test Loss: 0.740 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4671201705932617
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.515 Vali Acc: 0.917 Test Loss: 0.515 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4143171310424805
Epoch: 11, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.363 Vali Acc: 0.931 Test Loss: 0.363 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3520467281341553
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.889 Test Loss: 0.545 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.364114761352539
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.953 Vali Acc: 0.889 Test Loss: 0.953 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2138932
model size : 10.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.179483652114868
Epoch: 1, Steps: 7 | Train Loss: 2.384 Vali Loss: 1.229 Vali Acc: 0.750 Test Loss: 1.229 Test Acc: 0.750
Validation loss decreased (inf --> -0.749988).  Saving model ...
Epoch: 2 cost time: 1.127729892730713
Epoch: 2, Steps: 7 | Train Loss: 0.470 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
Validation loss decreased (-0.749988 --> -0.874997).  Saving model ...
Epoch: 3 cost time: 1.103879690170288
Epoch: 3, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 1.1311943531036377
Epoch: 4, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.365 Vali Acc: 0.917 Test Loss: 0.365 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 1.3321294784545898
Epoch: 5, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.426 Vali Acc: 0.917 Test Loss: 0.426 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3183419704437256
Epoch: 6, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.683 Vali Acc: 0.889 Test Loss: 0.683 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2228147983551025
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.903 Test Loss: 0.704 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1314830780029297
Epoch: 8, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.614 Vali Acc: 0.917 Test Loss: 0.614 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1805224418640137
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.903 Test Loss: 0.655 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1452455520629883
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.469 Vali Acc: 0.917 Test Loss: 0.469 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.234635353088379
Epoch: 11, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.469 Vali Acc: 0.931 Test Loss: 0.469 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930551).  Saving model ...
Epoch: 12 cost time: 1.142080307006836
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.903 Test Loss: 0.582 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3185348510742188
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.902 Vali Acc: 0.875 Test Loss: 0.902 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2514476776123047
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.477 Vali Acc: 0.931 Test Loss: 0.477 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.42415452003479
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.917 Test Loss: 0.482 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2985634803771973
Epoch: 16, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.537 Vali Acc: 0.917 Test Loss: 0.537 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1770968437194824
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.485 Vali Acc: 0.917 Test Loss: 0.485 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4517662525177002
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.931 Test Loss: 0.448 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 19 cost time: 1.2612760066986084
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.917 Test Loss: 0.463 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1687307357788086
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.917 Test Loss: 0.476 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2639474868774414
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.903 Test Loss: 0.483 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1623635292053223
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.903 Test Loss: 0.486 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1820449829101562
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.917 Test Loss: 0.485 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1981666088104248
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.917 Test Loss: 0.483 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1238930225372314
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.917 Test Loss: 0.481 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3250837326049805
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.917 Test Loss: 0.479 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0908899307250977
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.917 Test Loss: 0.478 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.126950740814209
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.917 Test Loss: 0.477 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2138932
model size : 10.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8427820205688477
Epoch: 1, Steps: 7 | Train Loss: 2.367 Vali Loss: 1.356 Vali Acc: 0.694 Test Loss: 1.356 Test Acc: 0.694
Validation loss decreased (inf --> -0.694431).  Saving model ...
Epoch: 2 cost time: 1.156287670135498
Epoch: 2, Steps: 7 | Train Loss: 0.577 Vali Loss: 0.359 Vali Acc: 0.847 Test Loss: 0.359 Test Acc: 0.847
Validation loss decreased (-0.694431 --> -0.847219).  Saving model ...
Epoch: 3 cost time: 1.1471576690673828
Epoch: 3, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
Validation loss decreased (-0.847219 --> -0.888887).  Saving model ...
Epoch: 4 cost time: 1.0357666015625
Epoch: 4, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.888887 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 1.13167142868042
Epoch: 5, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 1.0827486515045166
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.347 Vali Acc: 0.931 Test Loss: 0.347 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1554594039916992
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.370 Vali Acc: 0.931 Test Loss: 0.370 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1581017971038818
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.944 Test Loss: 0.374 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 1.2528107166290283
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.390 Vali Acc: 0.931 Test Loss: 0.390 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1414356231689453
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.861 Test Loss: 0.697 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0241589546203613
Epoch: 11, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.427 Vali Acc: 0.917 Test Loss: 0.427 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1578950881958008
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.401 Vali Acc: 0.931 Test Loss: 0.401 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2528247833251953
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.931 Test Loss: 0.398 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.132089614868164
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.931 Test Loss: 0.398 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1435613632202148
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.931 Test Loss: 0.398 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.143784523010254
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.931 Test Loss: 0.396 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1771183013916016
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.931 Test Loss: 0.392 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1718480587005615
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.931 Test Loss: 0.392 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2138932
model size : 10.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.437948226928711
Epoch: 1, Steps: 7 | Train Loss: 2.386 Vali Loss: 1.177 Vali Acc: 0.681 Test Loss: 1.177 Test Acc: 0.681
Validation loss decreased (inf --> -0.680544).  Saving model ...
Epoch: 2 cost time: 1.3277318477630615
Epoch: 2, Steps: 7 | Train Loss: 0.491 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.680544 --> -0.930553).  Saving model ...
Epoch: 3 cost time: 1.3217196464538574
Epoch: 3, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.276505947113037
Epoch: 4, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.476 Vali Acc: 0.903 Test Loss: 0.476 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.370802640914917
Epoch: 5, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 1.2741162776947021
Epoch: 6, Steps: 7 | Train Loss: 0.211 Vali Loss: 0.142 Vali Acc: 0.931 Test Loss: 0.142 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1637840270996094
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.986 Test Loss: 0.108 Test Acc: 0.986
Validation loss decreased (-0.944442 --> -0.986110).  Saving model ...
Epoch: 8 cost time: 1.2119948863983154
Epoch: 8, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.986 Test Loss: 0.112 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3897101879119873
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.986 Test Loss: 0.127 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3355631828308105
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2364211082458496
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.958 Test Loss: 0.134 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.325777292251587
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3484325408935547
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1482133865356445
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.16420316696167
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2026185989379883
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1743407249450684
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9861111111111112
model parameter : 2007860
model size : 10.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.404036045074463
Epoch: 1, Steps: 7 | Train Loss: 2.359 Vali Loss: 1.171 Vali Acc: 0.681 Test Loss: 1.171 Test Acc: 0.681
Validation loss decreased (inf --> -0.680544).  Saving model ...
Epoch: 2 cost time: 1.246541976928711
Epoch: 2, Steps: 7 | Train Loss: 0.511 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.680544 --> -0.930553).  Saving model ...
Epoch: 3 cost time: 1.2020623683929443
Epoch: 3, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4731462001800537
Epoch: 4, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.561 Vali Acc: 0.917 Test Loss: 0.561 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2858819961547852
Epoch: 5, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.167 Vali Acc: 0.931 Test Loss: 0.167 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 6 cost time: 1.1969454288482666
Epoch: 6, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.152 Vali Acc: 0.944 Test Loss: 0.152 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 7 cost time: 1.2374286651611328
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.958 Test Loss: 0.100 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 8 cost time: 1.0695860385894775
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.972 Test Loss: 0.088 Test Acc: 0.972
Validation loss decreased (-0.958332 --> -0.972221).  Saving model ...
Epoch: 9 cost time: 1.1943304538726807
Epoch: 9, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.128 Vali Acc: 0.958 Test Loss: 0.128 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3194942474365234
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.972 Test Loss: 0.085 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 11 cost time: 1.3490490913391113
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.972 Test Loss: 0.085 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2935829162597656
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.269279956817627
Epoch: 13, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0506033897399902
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2795767784118652
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.27805757522583
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3143067359924316
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3187642097473145
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2221426963806152
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0900297164916992
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 2007860
model size : 10.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2313668727874756
Epoch: 1, Steps: 7 | Train Loss: 2.326 Vali Loss: 1.180 Vali Acc: 0.792 Test Loss: 1.180 Test Acc: 0.792
Validation loss decreased (inf --> -0.791655).  Saving model ...
Epoch: 2 cost time: 1.2567358016967773
Epoch: 2, Steps: 7 | Train Loss: 0.532 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
Validation loss decreased (-0.791655 --> -0.902775).  Saving model ...
Epoch: 3 cost time: 1.2133772373199463
Epoch: 3, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4360406398773193
Epoch: 4, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.515 Vali Acc: 0.903 Test Loss: 0.515 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2150838375091553
Epoch: 5, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.902775 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 1.2876784801483154
Epoch: 6, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.441 Vali Acc: 0.931 Test Loss: 0.441 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1780250072479248
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.931 Test Loss: 0.332 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1868820190429688
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
Validation loss decreased (-0.944442 --> -0.972221).  Saving model ...
Epoch: 9 cost time: 1.1763360500335693
Epoch: 9, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2993659973144531
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.397578239440918
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2907710075378418
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.319 Vali Acc: 0.958 Test Loss: 0.319 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.267850399017334
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.958 Test Loss: 0.305 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2786610126495361
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.958 Test Loss: 0.291 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.469541072845459
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.958 Test Loss: 0.281 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3242895603179932
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.958 Test Loss: 0.273 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3089244365692139
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.958 Test Loss: 0.264 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2097675800323486
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.958 Test Loss: 0.259 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 2007860
model size : 10.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3574531078338623
Epoch: 1, Steps: 7 | Train Loss: 2.322 Vali Loss: 1.278 Vali Acc: 0.639 Test Loss: 1.278 Test Acc: 0.639
Validation loss decreased (inf --> -0.638876).  Saving model ...
Epoch: 2 cost time: 1.1367533206939697
Epoch: 2, Steps: 7 | Train Loss: 0.657 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.638876 --> -0.916664).  Saving model ...
Epoch: 3 cost time: 1.1892387866973877
Epoch: 3, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 4 cost time: 1.2082149982452393
Epoch: 4, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.460 Vali Acc: 0.861 Test Loss: 0.460 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0399317741394043
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.457 Vali Acc: 0.889 Test Loss: 0.457 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1666500568389893
Epoch: 6, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.420 Vali Acc: 0.903 Test Loss: 0.420 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1159107685089111
Epoch: 7, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.365 Vali Acc: 0.917 Test Loss: 0.365 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.200315237045288
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.931 Test Loss: 0.349 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 1.2706022262573242
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.931 Test Loss: 0.326 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 1.1044187545776367
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.316 Vali Acc: 0.931 Test Loss: 0.316 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 1.1004669666290283
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 1.3510174751281738
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.2047843933105469
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.931 Test Loss: 0.296 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.2245914936065674
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.1696257591247559
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.944 Test Loss: 0.292 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.297278642654419
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.181415319442749
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.2154200077056885
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.2490184307098389
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2305350303649902
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5443153381347656
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4599714279174805
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2256412506103516
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3457984924316406
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3506255149841309
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4587218761444092
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.548149824142456
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.931 Test Loss: 0.295 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.491948127746582
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.931 Test Loss: 0.295 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2007860
model size : 10.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.214795112609863
Epoch: 1, Steps: 7 | Train Loss: 2.367 Vali Loss: 1.248 Vali Acc: 0.667 Test Loss: 1.248 Test Acc: 0.667
Validation loss decreased (inf --> -0.666654).  Saving model ...
Epoch: 2 cost time: 1.151315689086914
Epoch: 2, Steps: 7 | Train Loss: 0.447 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
Validation loss decreased (-0.666654 --> -0.861107).  Saving model ...
Epoch: 3 cost time: 1.1803364753723145
Epoch: 3, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 4 cost time: 1.0867633819580078
Epoch: 4, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.536 Vali Acc: 0.889 Test Loss: 0.536 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888884).  Saving model ...
Epoch: 5 cost time: 1.175971508026123
Epoch: 5, Steps: 7 | Train Loss: 0.321 Vali Loss: 0.550 Vali Acc: 0.889 Test Loss: 0.550 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.240929126739502
Epoch: 6, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.698 Vali Acc: 0.875 Test Loss: 0.698 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.230447769165039
Epoch: 7, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.678 Vali Acc: 0.861 Test Loss: 0.678 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4222171306610107
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.889 Test Loss: 0.638 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.196321964263916
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.889 Test Loss: 0.611 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.178013801574707
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.903 Test Loss: 0.592 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902772).  Saving model ...
Epoch: 11 cost time: 1.1268136501312256
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.889 Test Loss: 0.582 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1698241233825684
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.889 Test Loss: 0.577 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1339187622070312
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.889 Test Loss: 0.572 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1611573696136475
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.889 Test Loss: 0.568 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2144742012023926
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.889 Test Loss: 0.565 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3336901664733887
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.889 Test Loss: 0.561 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2447419166564941
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.889 Test Loss: 0.557 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1831674575805664
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.889 Test Loss: 0.554 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4289195537567139
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.903 Test Loss: 0.551 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 20 cost time: 1.2484278678894043
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.903 Test Loss: 0.547 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 21 cost time: 1.3520395755767822
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.903 Test Loss: 0.544 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 22 cost time: 1.190375804901123
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.903 Test Loss: 0.542 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 23 cost time: 1.2051634788513184
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.903 Test Loss: 0.540 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 24 cost time: 1.1102948188781738
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.903 Test Loss: 0.537 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 25 cost time: 1.4709420204162598
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.903 Test Loss: 0.536 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 26 cost time: 1.1720504760742188
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.903 Test Loss: 0.535 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 27 cost time: 1.3045854568481445
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.903 Test Loss: 0.534 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 28 cost time: 1.25761079788208
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.903 Test Loss: 0.532 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 29 cost time: 1.2307705879211426
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.903 Test Loss: 0.530 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 30 cost time: 1.4155640602111816
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.903 Test Loss: 0.528 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 31 cost time: 1.187920331954956
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.903 Test Loss: 0.526 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 32 cost time: 1.052016258239746
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.903 Test Loss: 0.525 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 33 cost time: 1.1639463901519775
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.903 Test Loss: 0.524 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 34 cost time: 1.144460916519165
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.903 Test Loss: 0.522 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 35 cost time: 1.2641983032226562
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.903 Test Loss: 0.519 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 36 cost time: 1.2302746772766113
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.903 Test Loss: 0.518 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 37 cost time: 1.2182481288909912
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.917 Test Loss: 0.516 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916662).  Saving model ...
Epoch: 38 cost time: 1.235826015472412
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.917 Test Loss: 0.514 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 39 cost time: 1.2629263401031494
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.917 Test Loss: 0.513 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 40 cost time: 1.13582181930542
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.917 Test Loss: 0.512 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 41 cost time: 1.225294589996338
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.917 Test Loss: 0.511 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 42 cost time: 1.2893850803375244
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.917 Test Loss: 0.509 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 43 cost time: 1.229590892791748
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.917 Test Loss: 0.508 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 44 cost time: 1.2014007568359375
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.917 Test Loss: 0.507 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 45 cost time: 1.1333308219909668
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.917 Test Loss: 0.505 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 46 cost time: 1.2052338123321533
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.917 Test Loss: 0.504 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 47 cost time: 1.2544567584991455
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.917 Test Loss: 0.503 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 48 cost time: 1.1544702053070068
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.917 Test Loss: 0.502 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 49 cost time: 1.308051347732544
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.917 Test Loss: 0.501 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 50 cost time: 1.298377275466919
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.917 Test Loss: 0.500 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 51 cost time: 1.208369255065918
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.917 Test Loss: 0.499 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 52 cost time: 1.2155132293701172
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.917 Test Loss: 0.498 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 53 cost time: 1.3044781684875488
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.917 Test Loss: 0.496 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 54 cost time: 1.1136770248413086
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.917 Test Loss: 0.496 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 55 cost time: 1.3834295272827148
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.917 Test Loss: 0.496 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 56 cost time: 1.4039006233215332
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.917 Test Loss: 0.495 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 57 cost time: 1.4499685764312744
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.917 Test Loss: 0.493 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 58 cost time: 1.355517864227295
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.917 Test Loss: 0.492 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 59 cost time: 1.2091782093048096
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.917 Test Loss: 0.491 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 60 cost time: 1.4332356452941895
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.917 Test Loss: 0.490 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 61 cost time: 1.344705581665039
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.917 Test Loss: 0.489 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 62 cost time: 1.4638729095458984
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.917 Test Loss: 0.488 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 63 cost time: 1.3732428550720215
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.917 Test Loss: 0.488 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 64 cost time: 1.157616138458252
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.917 Test Loss: 0.487 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 65 cost time: 1.2750239372253418
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.917 Test Loss: 0.485 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 66 cost time: 1.2814981937408447
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.917 Test Loss: 0.484 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 67 cost time: 1.39054536819458
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.917 Test Loss: 0.483 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 68 cost time: 1.5469484329223633
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.917 Test Loss: 0.482 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 69 cost time: 1.3498237133026123
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.917 Test Loss: 0.481 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 70 cost time: 1.258460283279419
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.917 Test Loss: 0.480 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 71 cost time: 1.2335355281829834
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.917 Test Loss: 0.479 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 72 cost time: 1.4271411895751953
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.917 Test Loss: 0.478 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 73 cost time: 1.3415544033050537
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.917 Test Loss: 0.478 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 74 cost time: 1.5760796070098877
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.917 Test Loss: 0.478 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 75 cost time: 1.4672062397003174
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.917 Test Loss: 0.477 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 76 cost time: 1.4336645603179932
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.917 Test Loss: 0.476 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 77 cost time: 1.316216230392456
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.917 Test Loss: 0.476 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 78 cost time: 1.414959192276001
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.917 Test Loss: 0.475 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 79 cost time: 1.4296410083770752
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.917 Test Loss: 0.474 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 80 cost time: 1.3839111328125
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.917 Test Loss: 0.473 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 81 cost time: 1.3358800411224365
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.917 Test Loss: 0.472 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 82 cost time: 1.3530912399291992
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.917 Test Loss: 0.471 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 83 cost time: 1.357534408569336
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.917 Test Loss: 0.470 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 84 cost time: 1.313965082168579
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.917 Test Loss: 0.469 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 85 cost time: 1.4644052982330322
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.917 Test Loss: 0.468 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 86 cost time: 1.2967314720153809
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.917 Test Loss: 0.468 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 87 cost time: 1.3005092144012451
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.917 Test Loss: 0.467 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 88 cost time: 1.3190457820892334
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.917 Test Loss: 0.466 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 89 cost time: 1.3669006824493408
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.917 Test Loss: 0.466 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 90 cost time: 1.2270047664642334
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.917 Test Loss: 0.465 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 91 cost time: 1.0746443271636963
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.917 Test Loss: 0.465 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 92 cost time: 1.1262266635894775
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.917 Test Loss: 0.465 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 93 cost time: 1.3025193214416504
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.917 Test Loss: 0.464 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 94 cost time: 1.4528768062591553
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.917 Test Loss: 0.463 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 95 cost time: 1.4585416316986084
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.917 Test Loss: 0.463 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 96 cost time: 1.3690078258514404
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.917 Test Loss: 0.462 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 97 cost time: 1.275691270828247
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.917 Test Loss: 0.462 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 98 cost time: 1.2714707851409912
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.917 Test Loss: 0.461 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 99 cost time: 1.254892349243164
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.917 Test Loss: 0.460 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 100 cost time: 1.3375985622406006
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.917 Test Loss: 0.460 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1942324
model size : 9.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6774160861968994
Epoch: 1, Steps: 7 | Train Loss: 2.354 Vali Loss: 1.230 Vali Acc: 0.694 Test Loss: 1.230 Test Acc: 0.694
Validation loss decreased (inf --> -0.694432).  Saving model ...
Epoch: 2 cost time: 1.221790075302124
Epoch: 2, Steps: 7 | Train Loss: 0.457 Vali Loss: 0.365 Vali Acc: 0.875 Test Loss: 0.365 Test Acc: 0.875
Validation loss decreased (-0.694432 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 1.2140417098999023
Epoch: 3, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.407 Vali Acc: 0.903 Test Loss: 0.407 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 1.0963122844696045
Epoch: 4, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.466 Vali Acc: 0.903 Test Loss: 0.466 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1999633312225342
Epoch: 5, Steps: 7 | Train Loss: 0.272 Vali Loss: 0.360 Vali Acc: 0.917 Test Loss: 0.360 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 1.1527512073516846
Epoch: 6, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.474 Vali Acc: 0.889 Test Loss: 0.474 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.071676254272461
Epoch: 7, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.439 Vali Acc: 0.889 Test Loss: 0.439 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1146223545074463
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.362 Vali Acc: 0.917 Test Loss: 0.362 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0531420707702637
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.363 Vali Acc: 0.931 Test Loss: 0.363 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 1.175466537475586
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.931 Test Loss: 0.381 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.178077220916748
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.917 Test Loss: 0.407 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.145195722579956
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.917 Test Loss: 0.426 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2031996250152588
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.917 Test Loss: 0.437 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2616002559661865
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.917 Test Loss: 0.443 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4033312797546387
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.903 Test Loss: 0.446 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2626283168792725
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.903 Test Loss: 0.447 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3601200580596924
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.903 Test Loss: 0.447 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.284684181213379
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.903 Test Loss: 0.448 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4394185543060303
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.903 Test Loss: 0.446 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1942324
model size : 9.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.235053300857544
Epoch: 1, Steps: 7 | Train Loss: 2.319 Vali Loss: 1.258 Vali Acc: 0.708 Test Loss: 1.258 Test Acc: 0.708
Validation loss decreased (inf --> -0.708321).  Saving model ...
Epoch: 2 cost time: 1.1599082946777344
Epoch: 2, Steps: 7 | Train Loss: 0.464 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
Validation loss decreased (-0.708321 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 1.088587999343872
Epoch: 3, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.344 Vali Acc: 0.903 Test Loss: 0.344 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 1.0415928363800049
Epoch: 4, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.474 Vali Acc: 0.903 Test Loss: 0.474 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.018580436706543
Epoch: 5, Steps: 7 | Train Loss: 0.274 Vali Loss: 0.420 Vali Acc: 0.903 Test Loss: 0.420 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1107501983642578
Epoch: 6, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.587 Vali Acc: 0.889 Test Loss: 0.587 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2355663776397705
Epoch: 7, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.590 Vali Acc: 0.889 Test Loss: 0.590 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2647085189819336
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.903 Test Loss: 0.499 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1638169288635254
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.903 Test Loss: 0.461 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1736853122711182
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.903 Test Loss: 0.452 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.279780626296997
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.903 Test Loss: 0.455 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.23952317237854
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.903 Test Loss: 0.461 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2622318267822266
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.903 Test Loss: 0.465 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1942324
model size : 9.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.620668411254883
Epoch: 1, Steps: 7 | Train Loss: 2.328 Vali Loss: 1.287 Vali Acc: 0.778 Test Loss: 1.287 Test Acc: 0.778
Validation loss decreased (inf --> -0.777765).  Saving model ...
Epoch: 2 cost time: 1.2122571468353271
Epoch: 2, Steps: 7 | Train Loss: 0.568 Vali Loss: 0.354 Vali Acc: 0.847 Test Loss: 0.354 Test Acc: 0.847
Validation loss decreased (-0.777765 --> -0.847219).  Saving model ...
Epoch: 3 cost time: 0.9847066402435303
Epoch: 3, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
Validation loss decreased (-0.847219 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 1.1605548858642578
Epoch: 4, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.053328514099121
Epoch: 5, Steps: 7 | Train Loss: 0.143 Vali Loss: 0.289 Vali Acc: 0.944 Test Loss: 0.289 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 1.2047178745269775
Epoch: 6, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.443 Vali Acc: 0.889 Test Loss: 0.443 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1170306205749512
Epoch: 7, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0727171897888184
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.944 Test Loss: 0.339 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0123367309570312
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.438 Vali Acc: 0.917 Test Loss: 0.438 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1031622886657715
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.917 Test Loss: 0.531 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1413567066192627
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.384 Vali Acc: 0.944 Test Loss: 0.384 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0784435272216797
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.370 Vali Acc: 0.944 Test Loss: 0.370 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1009435653686523
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.380 Vali Acc: 0.944 Test Loss: 0.380 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1239068508148193
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.917 Test Loss: 0.510 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0760798454284668
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.370 Vali Acc: 0.944 Test Loss: 0.370 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1942324
model size : 9.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.832704782485962
Epoch: 1, Steps: 7 | Train Loss: 2.309 Vali Loss: 1.189 Vali Acc: 0.750 Test Loss: 1.189 Test Acc: 0.750
Validation loss decreased (inf --> -0.749988).  Saving model ...
Epoch: 2 cost time: 1.2768731117248535
Epoch: 2, Steps: 7 | Train Loss: 0.385 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
Validation loss decreased (-0.749988 --> -0.874997).  Saving model ...
Epoch: 3 cost time: 1.2751843929290771
Epoch: 3, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.540 Vali Acc: 0.889 Test Loss: 0.540 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888883).  Saving model ...
Epoch: 4 cost time: 1.2625315189361572
Epoch: 4, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.903 Test Loss: 0.567 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902772).  Saving model ...
Epoch: 5 cost time: 1.2446630001068115
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.917 Test Loss: 0.447 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916662).  Saving model ...
Epoch: 6 cost time: 1.2779502868652344
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.903 Test Loss: 0.447 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.211996078491211
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.917 Test Loss: 0.460 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2488617897033691
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.917 Test Loss: 0.466 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.212773323059082
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.917 Test Loss: 0.467 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2208137512207031
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.917 Test Loss: 0.464 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2581133842468262
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.917 Test Loss: 0.460 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3701653480529785
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.917 Test Loss: 0.457 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2485315799713135
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.454 Vali Acc: 0.917 Test Loss: 0.454 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2079031467437744
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.917 Test Loss: 0.451 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.278172492980957
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.917 Test Loss: 0.448 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1909556
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5716969966888428
Epoch: 1, Steps: 7 | Train Loss: 2.316 Vali Loss: 1.191 Vali Acc: 0.750 Test Loss: 1.191 Test Acc: 0.750
Validation loss decreased (inf --> -0.749988).  Saving model ...
Epoch: 2 cost time: 1.1540114879608154
Epoch: 2, Steps: 7 | Train Loss: 0.404 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.749988 --> -0.902775).  Saving model ...
Epoch: 3 cost time: 1.2682757377624512
Epoch: 3, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.593 Vali Acc: 0.903 Test Loss: 0.593 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1028566360473633
Epoch: 4, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.391 Vali Acc: 0.917 Test Loss: 0.391 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 1.1295890808105469
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.366 Vali Acc: 0.931 Test Loss: 0.366 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 1.4019598960876465
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.903 Test Loss: 0.409 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3759303092956543
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.903 Test Loss: 0.432 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1522693634033203
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.917 Test Loss: 0.443 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3511545658111572
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.917 Test Loss: 0.446 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2336454391479492
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.917 Test Loss: 0.445 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2118961811065674
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.442 Vali Acc: 0.917 Test Loss: 0.442 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1299962997436523
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.917 Test Loss: 0.438 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.212223768234253
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.917 Test Loss: 0.434 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3703110218048096
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.917 Test Loss: 0.429 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3611516952514648
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.917 Test Loss: 0.425 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1909556
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2913405895233154
Epoch: 1, Steps: 7 | Train Loss: 2.279 Vali Loss: 1.203 Vali Acc: 0.764 Test Loss: 1.203 Test Acc: 0.764
Validation loss decreased (inf --> -0.763877).  Saving model ...
Epoch: 2 cost time: 1.2281930446624756
Epoch: 2, Steps: 7 | Train Loss: 0.436 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.763877 --> -0.888886).  Saving model ...
Epoch: 3 cost time: 1.2966210842132568
Epoch: 3, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.405 Vali Acc: 0.889 Test Loss: 0.405 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1334881782531738
Epoch: 4, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.482 Vali Acc: 0.903 Test Loss: 0.482 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902773).  Saving model ...
Epoch: 5 cost time: 1.1522927284240723
Epoch: 5, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 1.233123540878296
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.2644741535186768
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.931 Test Loss: 0.338 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 1.252791404724121
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.931 Test Loss: 0.346 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2770681381225586
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.350 Vali Acc: 0.931 Test Loss: 0.350 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1420037746429443
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.353 Vali Acc: 0.931 Test Loss: 0.353 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2854056358337402
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.354 Vali Acc: 0.917 Test Loss: 0.354 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.231217622756958
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.353 Vali Acc: 0.917 Test Loss: 0.353 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3257644176483154
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.352 Vali Acc: 0.917 Test Loss: 0.352 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2146697044372559
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.351 Vali Acc: 0.917 Test Loss: 0.351 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1989693641662598
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.178464651107788
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2351133823394775
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.917 Test Loss: 0.347 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1909556
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5068418979644775
Epoch: 1, Steps: 7 | Train Loss: 2.290 Vali Loss: 1.279 Vali Acc: 0.778 Test Loss: 1.279 Test Acc: 0.778
Validation loss decreased (inf --> -0.777765).  Saving model ...
Epoch: 2 cost time: 1.1434731483459473
Epoch: 2, Steps: 7 | Train Loss: 0.562 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
Validation loss decreased (-0.777765 --> -0.874997).  Saving model ...
Epoch: 3 cost time: 1.14349365234375
Epoch: 3, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.335 Vali Acc: 0.903 Test Loss: 0.335 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 1.0927395820617676
Epoch: 4, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 1.2315709590911865
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.365 Vali Acc: 0.903 Test Loss: 0.365 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2532103061676025
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.397 Vali Acc: 0.917 Test Loss: 0.397 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.072033405303955
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.427 Vali Acc: 0.903 Test Loss: 0.427 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1303527355194092
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.889 Test Loss: 0.479 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2562150955200195
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.889 Test Loss: 0.478 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2336812019348145
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.903 Test Loss: 0.452 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3141438961029053
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.903 Test Loss: 0.432 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2312722206115723
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.903 Test Loss: 0.419 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3635411262512207
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.903 Test Loss: 0.409 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4572346210479736
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.401 Vali Acc: 0.903 Test Loss: 0.401 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1909556
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.919595718383789
Epoch: 1, Steps: 7 | Train Loss: 2.261 Vali Loss: 1.172 Vali Acc: 0.708 Test Loss: 1.172 Test Acc: 0.708
Validation loss decreased (inf --> -0.708322).  Saving model ...
Epoch: 2 cost time: 1.4302458763122559
Epoch: 2, Steps: 7 | Train Loss: 0.466 Vali Loss: 0.316 Vali Acc: 0.861 Test Loss: 0.316 Test Acc: 0.861
Validation loss decreased (-0.708322 --> -0.861108).  Saving model ...
Epoch: 3 cost time: 1.2453546524047852
Epoch: 3, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874997).  Saving model ...
Epoch: 4 cost time: 1.210662603378296
Epoch: 4, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.571 Vali Acc: 0.903 Test Loss: 0.571 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902772).  Saving model ...
Epoch: 5 cost time: 1.1877622604370117
Epoch: 5, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 1.219775915145874
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.353 Vali Acc: 0.917 Test Loss: 0.353 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1704680919647217
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.931 Test Loss: 0.177 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930554).  Saving model ...
Epoch: 8 cost time: 1.148407220840454
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.931 Test Loss: 0.165 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 9 cost time: 1.21004056930542
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.201730489730835
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2394745349884033
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1941816806793213
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.258249282836914
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2630956172943115
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3012287616729736
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.931 Test Loss: 0.171 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3153557777404785
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 1.4497323036193848
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 1.3235540390014648
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 1.2464780807495117
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 1.414903163909912
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 1.337294340133667
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 1.1599643230438232
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 1.178741693496704
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 1.3575351238250732
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 1.3435611724853516
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 1.3421804904937744
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 1.1603870391845703
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 1.2285432815551758
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 1.3136205673217773
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 1.4191677570343018
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 1.221259355545044
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.174595832824707
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3258709907531738
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.154407262802124
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.204566240310669
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2593650817871094
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3260071277618408
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2093768119812012
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.342116117477417
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.2353184223175049
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1893172
model size : 9.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.1214940547943115
Epoch: 1, Steps: 7 | Train Loss: 2.260 Vali Loss: 1.177 Vali Acc: 0.681 Test Loss: 1.177 Test Acc: 0.681
Validation loss decreased (inf --> -0.680544).  Saving model ...
Epoch: 2 cost time: 1.271479845046997
Epoch: 2, Steps: 7 | Train Loss: 0.485 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
Validation loss decreased (-0.680544 --> -0.944442).  Saving model ...
Epoch: 3 cost time: 1.2903976440429688
Epoch: 3, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2073602676391602
Epoch: 4, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.419 Vali Acc: 0.903 Test Loss: 0.419 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3513808250427246
Epoch: 5, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 1.1507923603057861
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2809803485870361
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.124 Vali Acc: 0.958 Test Loss: 0.124 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958332).  Saving model ...
Epoch: 8 cost time: 1.2511146068572998
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.120 Vali Acc: 0.958 Test Loss: 0.120 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 9 cost time: 1.4154267311096191
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3283014297485352
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.403733491897583
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.402724027633667
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.256544828414917
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2792229652404785
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2441425323486328
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2281951904296875
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2605392932891846
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5741932392120361
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1893172
model size : 9.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4166476726531982
Epoch: 1, Steps: 7 | Train Loss: 2.218 Vali Loss: 1.170 Vali Acc: 0.681 Test Loss: 1.170 Test Acc: 0.681
Validation loss decreased (inf --> -0.680544).  Saving model ...
Epoch: 2 cost time: 1.1808345317840576
Epoch: 2, Steps: 7 | Train Loss: 0.528 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.680544 --> -0.930553).  Saving model ...
Epoch: 3 cost time: 1.175140619277954
Epoch: 3, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 4 cost time: 1.0801033973693848
Epoch: 4, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.421 Vali Acc: 0.903 Test Loss: 0.421 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.193741798400879
Epoch: 5, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.150 Vali Acc: 0.944 Test Loss: 0.150 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 6 cost time: 1.192962408065796
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1865906715393066
Epoch: 7, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.148 Vali Acc: 0.944 Test Loss: 0.148 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 8 cost time: 1.1198186874389648
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0968267917633057
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0085525512695312
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 11 cost time: 1.1281394958496094
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 1.0886683464050293
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.137031078338623
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1612193584442139
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0734035968780518
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1784708499908447
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1048531532287598
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0312690734863281
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.21280837059021
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1671154499053955
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.179009199142456
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1893172
model size : 9.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2617368698120117
Epoch: 1, Steps: 7 | Train Loss: 2.231 Vali Loss: 1.280 Vali Acc: 0.681 Test Loss: 1.280 Test Acc: 0.681
Validation loss decreased (inf --> -0.680543).  Saving model ...
Epoch: 2 cost time: 1.0288581848144531
Epoch: 2, Steps: 7 | Train Loss: 0.659 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.680543 --> -0.902775).  Saving model ...
Epoch: 3 cost time: 1.170703649520874
Epoch: 3, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 4 cost time: 1.1829955577850342
Epoch: 4, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0659799575805664
Epoch: 5, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 1.1391935348510742
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0252771377563477
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 1.1307072639465332
Epoch: 8, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1582026481628418
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2292006015777588
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.12837815284729
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0936415195465088
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0344347953796387
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1629774570465088
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9831235408782959
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.248234748840332
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2497715950012207
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1893172
model size : 9.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.8078644275665283
Epoch: 1, Steps: 7 | Train Loss: 2.364 Vali Loss: 1.533 Vali Acc: 0.639 Test Loss: 1.533 Test Acc: 0.639
Validation loss decreased (inf --> -0.638874).  Saving model ...
Epoch: 2 cost time: 1.1362838745117188
Epoch: 2, Steps: 7 | Train Loss: 0.859 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
Validation loss decreased (-0.638874 --> -0.888885).  Saving model ...
Epoch: 3 cost time: 1.0981206893920898
Epoch: 3, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 4 cost time: 1.0739715099334717
Epoch: 4, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 1.1154506206512451
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0482981204986572
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2203779220581055
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1689722537994385
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2867672443389893
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0221829414367676
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.096942663192749
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.2679245471954346
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.9689931869506836
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.2042820453643799
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.2061867713928223
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2065045833587646
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0722038745880127
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.099747896194458
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2583072185516357
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.373835802078247
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1720850467681885
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.140352487564087
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3554213047027588
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1780967712402344
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1192372
model size : 5.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6032814979553223
Epoch: 1, Steps: 7 | Train Loss: 2.337 Vali Loss: 1.563 Vali Acc: 0.639 Test Loss: 1.563 Test Acc: 0.639
Validation loss decreased (inf --> -0.638873).  Saving model ...
Epoch: 2 cost time: 1.0388364791870117
Epoch: 2, Steps: 7 | Train Loss: 0.877 Vali Loss: 0.395 Vali Acc: 0.903 Test Loss: 0.395 Test Acc: 0.903
Validation loss decreased (-0.638873 --> -0.902774).  Saving model ...
Epoch: 3 cost time: 1.1127758026123047
Epoch: 3, Steps: 7 | Train Loss: 0.111 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.124007225036621
Epoch: 4, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2616543769836426
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 6 cost time: 1.2365365028381348
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.200174331665039
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.861 Test Loss: 0.338 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.450169324874878
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.0846920013427734
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.2077171802520752
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3866302967071533
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.242070198059082
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1744067668914795
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2369515895843506
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.172631025314331
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1303586959838867
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0585451126098633
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0622146129608154
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.2256646156311035
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.9639387130737305
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.2203807830810547
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.9982595443725586
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.1225848197937012
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 1.1365916728973389
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.985612154006958
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.0928139686584473
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.1346800327301025
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.1433861255645752
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.1060371398925781
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.0271844863891602
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.085573434829712
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.9504725933074951
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 1.0458881855010986
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.2063932418823242
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 1.0678985118865967
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3973369598388672
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1450002193450928
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2230520248413086
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1316912174224854
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1724178791046143
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.1373798847198486
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 1.2924108505249023
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 1.2487192153930664
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 1.1988284587860107
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 1.1943230628967285
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0909678936004639
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.254988193511963
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 1.2121903896331787
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 1.0974030494689941
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 1.0110211372375488
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 1.175041913986206
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.088817834854126
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0460970401763916
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 1.0984294414520264
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 1.1754732131958008
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 1.1920909881591797
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 1.234684705734253
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 1.1417856216430664
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.242375373840332
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.1603577136993408
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.2720065116882324
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.2607486248016357
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.2797050476074219
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.1496529579162598
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.2236249446868896
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.1813840866088867
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.1463844776153564
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 1.1943600177764893
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 1.1204864978790283
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 1.2104716300964355
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 1.314739465713501
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 72 cost time: 1.1387989521026611
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 73 cost time: 1.1339752674102783
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.233858585357666
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.3199057579040527
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.2327094078063965
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.3323493003845215
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.3698558807373047
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.3432457447052002
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 1.2883431911468506
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 1.3556923866271973
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 1.3650109767913818
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1192372
model size : 5.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6176013946533203
Epoch: 1, Steps: 7 | Train Loss: 2.347 Vali Loss: 1.601 Vali Acc: 0.694 Test Loss: 1.601 Test Acc: 0.694
Validation loss decreased (inf --> -0.694428).  Saving model ...
Epoch: 2 cost time: 1.0532786846160889
Epoch: 2, Steps: 7 | Train Loss: 0.904 Vali Loss: 0.395 Vali Acc: 0.903 Test Loss: 0.395 Test Acc: 0.903
Validation loss decreased (-0.694428 --> -0.902774).  Saving model ...
Epoch: 3 cost time: 1.2010791301727295
Epoch: 3, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.086601734161377
Epoch: 4, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 1.017638921737671
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 1.0305421352386475
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0897700786590576
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944443).  Saving model ...
Epoch: 8 cost time: 1.0344667434692383
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 9 cost time: 1.108102798461914
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 10 cost time: 1.3093664646148682
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.144404411315918
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.143420696258545
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1544513702392578
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.099482536315918
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0766043663024902
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.199988842010498
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.139352560043335
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.096386194229126
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.086348295211792
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1192372
model size : 5.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.493068218231201
Epoch: 1, Steps: 7 | Train Loss: 2.358 Vali Loss: 1.720 Vali Acc: 0.708 Test Loss: 1.720 Test Acc: 0.708
Validation loss decreased (inf --> -0.708316).  Saving model ...
Epoch: 2 cost time: 1.1105172634124756
Epoch: 2, Steps: 7 | Train Loss: 1.074 Vali Loss: 0.523 Vali Acc: 0.889 Test Loss: 0.523 Test Acc: 0.889
Validation loss decreased (-0.708316 --> -0.888884).  Saving model ...
Epoch: 3 cost time: 1.1493256092071533
Epoch: 3, Steps: 7 | Train Loss: 0.234 Vali Loss: 0.387 Vali Acc: 0.861 Test Loss: 0.387 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.282012939453125
Epoch: 4, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9999580383300781
Epoch: 5, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.888884 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 0.9955465793609619
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.931 Test Loss: 0.164 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.220418930053711
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3421072959899902
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1970493793487549
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1895370483398438
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3852248191833496
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5174667835235596
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2591066360473633
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2489030361175537
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2209155559539795
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1192372
model size : 5.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.351846694946289
Epoch: 1, Steps: 7 | Train Loss: 2.434 Vali Loss: 1.606 Vali Acc: 0.708 Test Loss: 1.606 Test Acc: 0.708
Validation loss decreased (inf --> -0.708317).  Saving model ...
Epoch: 2 cost time: 1.0307445526123047
Epoch: 2, Steps: 7 | Train Loss: 0.915 Vali Loss: 0.390 Vali Acc: 0.903 Test Loss: 0.390 Test Acc: 0.903
Validation loss decreased (-0.708317 --> -0.902774).  Saving model ...
Epoch: 3 cost time: 1.0062425136566162
Epoch: 3, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 1.2120065689086914
Epoch: 4, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 1.0895678997039795
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 1.0239758491516113
Epoch: 6, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 1.079118013381958
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9988260269165039
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2032966613769531
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2078089714050293
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.0771756172180176
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1418368816375732
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.276319980621338
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.037813663482666
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1303536891937256
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0886495113372803
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2257184982299805
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.178081750869751
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.14280366897583
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.875 Test Loss: 0.512 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.209723949432373
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1061300
model size : 5.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4638187885284424
Epoch: 1, Steps: 7 | Train Loss: 2.409 Vali Loss: 1.609 Vali Acc: 0.681 Test Loss: 1.609 Test Acc: 0.681
Validation loss decreased (inf --> -0.680539).  Saving model ...
Epoch: 2 cost time: 1.2117979526519775
Epoch: 2, Steps: 7 | Train Loss: 0.912 Vali Loss: 0.399 Vali Acc: 0.917 Test Loss: 0.399 Test Acc: 0.917
Validation loss decreased (-0.680539 --> -0.916663).  Saving model ...
Epoch: 3 cost time: 1.3569653034210205
Epoch: 3, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.284696340560913
Epoch: 4, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 1.359452724456787
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 1.0618109703063965
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 1.1411089897155762
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 1.1731295585632324
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1365373134613037
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1164584159851074
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0390167236328125
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0213425159454346
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.045407772064209
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0227558612823486
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0796234607696533
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.995063066482544
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.208336591720581
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1061300
model size : 5.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.40653395652771
Epoch: 1, Steps: 7 | Train Loss: 2.397 Vali Loss: 1.650 Vali Acc: 0.653 Test Loss: 1.650 Test Acc: 0.653
Validation loss decreased (inf --> -0.652761).  Saving model ...
Epoch: 2 cost time: 1.1605088710784912
Epoch: 2, Steps: 7 | Train Loss: 0.939 Vali Loss: 0.398 Vali Acc: 0.917 Test Loss: 0.398 Test Acc: 0.917
Validation loss decreased (-0.652761 --> -0.916663).  Saving model ...
Epoch: 3 cost time: 1.0873167514801025
Epoch: 3, Steps: 7 | Train Loss: 0.108 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 1.0068638324737549
Epoch: 4, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 1.167386531829834
Epoch: 5, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 0.998382568359375
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 1.0355677604675293
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 1.1108365058898926
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9400575160980225
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1846892833709717
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1663339138031006
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1562654972076416
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.072678804397583
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0649158954620361
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1470279693603516
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0752968788146973
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.089980125427246
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1061300
model size : 5.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.276139736175537
Epoch: 1, Steps: 7 | Train Loss: 2.395 Vali Loss: 1.765 Vali Acc: 0.611 Test Loss: 1.765 Test Acc: 0.611
Validation loss decreased (inf --> -0.611093).  Saving model ...
Epoch: 2 cost time: 1.113940954208374
Epoch: 2, Steps: 7 | Train Loss: 1.135 Vali Loss: 0.523 Vali Acc: 0.917 Test Loss: 0.523 Test Acc: 0.917
Validation loss decreased (-0.611093 --> -0.916661).  Saving model ...
Epoch: 3 cost time: 0.9840078353881836
Epoch: 3, Steps: 7 | Train Loss: 0.213 Vali Loss: 0.449 Vali Acc: 0.861 Test Loss: 0.449 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.015000820159912
Epoch: 4, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 0.9784657955169678
Epoch: 5, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 0.9958317279815674
Epoch: 6, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1659326553344727
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1212527751922607
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0953638553619385
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.994347095489502
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0498371124267578
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2499158382415771
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9991827011108398
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0307605266571045
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.101182460784912
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1061300
model size : 5.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3855843544006348
Epoch: 1, Steps: 7 | Train Loss: 2.567 Vali Loss: 1.728 Vali Acc: 0.667 Test Loss: 1.728 Test Acc: 0.667
Validation loss decreased (inf --> -0.666649).  Saving model ...
Epoch: 2 cost time: 1.1631343364715576
Epoch: 2, Steps: 7 | Train Loss: 0.911 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
Validation loss decreased (-0.666649 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 1.1539411544799805
Epoch: 3, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 0.9851748943328857
Epoch: 4, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 1.138798713684082
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.367 Vali Acc: 0.917 Test Loss: 0.367 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2811715602874756
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.1865355968475342
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 1.1483399868011475
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.128260612487793
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.213019609451294
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1311814785003662
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1429903507232666
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 1.2208166122436523
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 1.004035234451294
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 1.060075283050537
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.021921157836914
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.044198989868164
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.210174798965454
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.0932977199554443
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.067962884902954
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.0405738353729248
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.2275068759918213
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.041447639465332
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 1.0803611278533936
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.1510210037231445
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.2878167629241943
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.0975315570831299
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.1109035015106201
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.1498053073883057
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.109917163848877
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.1218130588531494
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.2360308170318604
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.9946112632751465
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.2161080837249756
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 1.1777420043945312
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4953749179840088
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1249210834503174
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 1.2206876277923584
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 1.1855709552764893
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 1.1472728252410889
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 1.1361229419708252
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 1.2451434135437012
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 1.1386134624481201
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 1.0892627239227295
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 1.1757736206054688
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 1.1671035289764404
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 1.1299304962158203
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1758034229278564
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 1.1551752090454102
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 1.133774757385254
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0839893817901611
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 1.0579659938812256
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 0.9986674785614014
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 1.1937980651855469
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9828414916992188
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.0122251510620117
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.170750379562378
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.0577738285064697
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.237166404724121
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 1.1686711311340332
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 1.0987589359283447
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 62 cost time: 1.1461470127105713
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 63 cost time: 1.160526990890503
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 1.2068803310394287
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 1.211202621459961
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 66 cost time: 1.1377947330474854
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 1.1320154666900635
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 1.066009759902954
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 1.2360930442810059
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 1.1240696907043457
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 1.1360752582550049
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 72 cost time: 1.1992113590240479
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 73 cost time: 1.1292576789855957
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 74 cost time: 1.123197317123413
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 75 cost time: 1.1642889976501465
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 76 cost time: 1.1497867107391357
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 77 cost time: 1.1940805912017822
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 78 cost time: 1.1757705211639404
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 79 cost time: 1.3119068145751953
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.2693889141082764
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.204920768737793
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.2419612407684326
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 1.1340725421905518
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 1.1170156002044678
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 1.3640940189361572
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 1.1537892818450928
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 1.2639286518096924
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 1.1411058902740479
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 995764
model size : 5.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.6664845943450928
Epoch: 1, Steps: 7 | Train Loss: 2.537 Vali Loss: 1.730 Vali Acc: 0.708 Test Loss: 1.730 Test Acc: 0.708
Validation loss decreased (inf --> -0.708316).  Saving model ...
Epoch: 2 cost time: 1.2824151515960693
Epoch: 2, Steps: 7 | Train Loss: 0.910 Vali Loss: 0.400 Vali Acc: 0.903 Test Loss: 0.400 Test Acc: 0.903
Validation loss decreased (-0.708316 --> -0.902774).  Saving model ...
Epoch: 3 cost time: 1.0272471904754639
Epoch: 3, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 1.2441744804382324
Epoch: 4, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.342 Vali Acc: 0.917 Test Loss: 0.342 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 1.0808160305023193
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.373 Vali Acc: 0.917 Test Loss: 0.373 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1391420364379883
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 1.0746104717254639
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.414289951324463
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.145315170288086
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0587148666381836
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1367506980895996
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1308174133300781
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1492621898651123
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2541377544403076
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0214381217956543
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9566566944122314
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 995764
model size : 5.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.804928779602051
Epoch: 1, Steps: 7 | Train Loss: 2.527 Vali Loss: 1.713 Vali Acc: 0.764 Test Loss: 1.713 Test Acc: 0.764
Validation loss decreased (inf --> -0.763872).  Saving model ...
Epoch: 2 cost time: 1.2993237972259521
Epoch: 2, Steps: 7 | Train Loss: 0.914 Vali Loss: 0.408 Vali Acc: 0.889 Test Loss: 0.408 Test Acc: 0.889
Validation loss decreased (-0.763872 --> -0.888885).  Saving model ...
Epoch: 3 cost time: 1.038262128829956
Epoch: 3, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 1.0123798847198486
Epoch: 4, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 0.9705624580383301
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1750428676605225
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 1.1041111946105957
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0596051216125488
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.171818733215332
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1904942989349365
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1813840866088867
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.064201831817627
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.1221578121185303
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.146658182144165
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.2967712879180908
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.0641200542449951
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.2902567386627197
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.9885177612304688
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.945934534072876
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.902350664138794
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.082690715789795
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.9946291446685791
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.0206077098846436
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.067568302154541
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.0077495574951172
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.1369528770446777
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 1.0446758270263672
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 1.062185287475586
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 1.0505540370941162
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 1.0450546741485596
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 1.1756477355957031
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 1.2490217685699463
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.9748382568359375
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 1.3882043361663818
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 1.167433500289917
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 1.1312854290008545
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 1.2235054969787598
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 1.2122228145599365
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 1.2587101459503174
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.265212059020996
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2446181774139404
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2566440105438232
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2517471313476562
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.3024358749389648
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.154069423675537
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.1901745796203613
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.2871508598327637
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.0815255641937256
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 995764
model size : 5.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.38999605178833
Epoch: 1, Steps: 7 | Train Loss: 2.455 Vali Loss: 1.769 Vali Acc: 0.722 Test Loss: 1.769 Test Acc: 0.722
Validation loss decreased (inf --> -0.722205).  Saving model ...
Epoch: 2 cost time: 0.9068725109100342
Epoch: 2, Steps: 7 | Train Loss: 1.074 Vali Loss: 0.558 Vali Acc: 0.806 Test Loss: 0.558 Test Acc: 0.806
Validation loss decreased (-0.722205 --> -0.805550).  Saving model ...
Epoch: 3 cost time: 0.9169442653656006
Epoch: 3, Steps: 7 | Train Loss: 0.197 Vali Loss: 0.311 Vali Acc: 0.861 Test Loss: 0.311 Test Acc: 0.861
Validation loss decreased (-0.805550 --> -0.861108).  Saving model ...
Epoch: 4 cost time: 0.9258236885070801
Epoch: 4, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.861108 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 0.9569647312164307
Epoch: 5, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 1.00710129737854
Epoch: 6, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9412734508514404
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.972280740737915
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9465107917785645
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.9104461669921875
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.8631594181060791
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9074695110321045
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9819953441619873
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9164190292358398
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.960918664932251
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.9384419918060303
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.103773832321167
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.0018014907836914
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.1723902225494385
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.1152174472808838
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.08309006690979
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.078871250152588
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.0435523986816406
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 1.0286614894866943
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2137868404388428
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.05141019821167
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.9850718975067139
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9621260166168213
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9350855350494385
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.9239909648895264
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.9714205265045166
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.9203031063079834
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.9550049304962158
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.9128906726837158
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.8876159191131592
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 1.009932518005371
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.8732955455780029
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.9582116603851318
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 1.0521864891052246
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9478549957275391
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2071304321289062
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0149271488189697
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.266995906829834
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.3395354747772217
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 1.335261344909668
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 1.2508952617645264
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 1.3414437770843506
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 1.3956713676452637
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.296022891998291
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 1.4150886535644531
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 1.3841018676757812
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.319889783859253
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.5273962020874023
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.5317575931549072
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 55 cost time: 1.3118202686309814
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2810883522033691
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 1.4262444972991943
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 1.4112541675567627
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 59 cost time: 1.1871044635772705
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.1641795635223389
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.075425386428833
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.2472193241119385
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 63 cost time: 1.1284029483795166
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 1.2289659976959229
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 65 cost time: 1.1024494171142578
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.404832363128662
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.2285487651824951
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.3486549854278564
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.473921298980713
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.392143726348877
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.2733380794525146
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.3410584926605225
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.195936918258667
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.325789213180542
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 995764
model size : 5.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 4.068430185317993
Epoch: 1, Steps: 7 | Train Loss: 2.387 Vali Loss: 1.630 Vali Acc: 0.597 Test Loss: 1.630 Test Acc: 0.597
Validation loss decreased (inf --> -0.597206).  Saving model ...
Epoch: 2 cost time: 1.1337671279907227
Epoch: 2, Steps: 7 | Train Loss: 0.896 Vali Loss: 0.411 Vali Acc: 0.903 Test Loss: 0.411 Test Acc: 0.903
Validation loss decreased (-0.597206 --> -0.902774).  Saving model ...
Epoch: 3 cost time: 1.0224812030792236
Epoch: 3, Steps: 7 | Train Loss: 0.143 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2353131771087646
Epoch: 4, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.372 Vali Acc: 0.917 Test Loss: 0.372 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 1.1219916343688965
Epoch: 5, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.383 Vali Acc: 0.917 Test Loss: 0.383 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1139609813690186
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.0750551223754883
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.078812599182129
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.1112534999847412
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.0718321800231934
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.0180764198303223
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2206473350524902
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0995512008666992
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1142973899841309
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.161773681640625
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.0102729797363281
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.0947353839874268
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.0641112327575684
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.2311043739318848
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.136871576309204
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.0735883712768555
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 1.1267521381378174
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1414086818695068
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0935745239257812
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.200989007949829
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.1056702136993408
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1190540790557861
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1209406852722168
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0738213062286377
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.082603931427002
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.257244348526001
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.177248477935791
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1825213432312012
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.385514736175537
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 1.5199813842773438
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.193037986755371
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 1.1861186027526855
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 1.0648949146270752
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0699548721313477
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 1.08854079246521
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 1.2814011573791504
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.130631923675537
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 1.2927589416503906
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 1.1295967102050781
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 1.116934061050415
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.166588544845581
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 1.4181585311889648
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 1.04313063621521
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 1.3186674118041992
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 1.20350980758667
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.144063949584961
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 1.3576204776763916
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.1089074611663818
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.2415697574615479
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.202402114868164
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 56 cost time: 1.2463538646697998
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 57 cost time: 1.1606214046478271
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 58 cost time: 1.2053985595703125
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.2085957527160645
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.167680025100708
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.0420351028442383
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 62 cost time: 1.0644028186798096
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.1080164909362793
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 64 cost time: 1.1384899616241455
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 65 cost time: 1.0876233577728271
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.3958280086517334
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 67 cost time: 1.5264286994934082
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 1.3127057552337646
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 1.21494460105896
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 1.1638717651367188
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 1.2376704216003418
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 72 cost time: 1.2338504791259766
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 73 cost time: 1.0877189636230469
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 74 cost time: 1.0833139419555664
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 75 cost time: 1.130493402481079
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 76 cost time: 1.1560161113739014
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 77 cost time: 1.3499929904937744
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.1624236106872559
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.136751413345337
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.0973589420318604
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.2266802787780762
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 1.0838401317596436
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.0656754970550537
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 1.2671363353729248
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 1.1733100414276123
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 1.2473516464233398
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 962996
model size : 4.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.41144061088562
Epoch: 1, Steps: 7 | Train Loss: 2.380 Vali Loss: 1.651 Vali Acc: 0.639 Test Loss: 1.651 Test Acc: 0.639
Validation loss decreased (inf --> -0.638872).  Saving model ...
Epoch: 2 cost time: 1.0343999862670898
Epoch: 2, Steps: 7 | Train Loss: 0.918 Vali Loss: 0.423 Vali Acc: 0.931 Test Loss: 0.423 Test Acc: 0.931
Validation loss decreased (-0.638872 --> -0.930551).  Saving model ...
Epoch: 3 cost time: 1.008523941040039
Epoch: 3, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0608360767364502
Epoch: 4, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.375 Vali Acc: 0.903 Test Loss: 0.375 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.098841905593872
Epoch: 5, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1700565814971924
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0504508018493652
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1262092590332031
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8883662223815918
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.9282400608062744
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.9959609508514404
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1819572448730469
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9942455291748047
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.994379997253418
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0389835834503174
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0862183570861816
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9749457836151123
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1344060897827148
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.112368106842041
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1137797832489014
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 962996
model size : 4.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.124631881713867
Epoch: 1, Steps: 7 | Train Loss: 2.348 Vali Loss: 1.641 Vali Acc: 0.681 Test Loss: 1.641 Test Acc: 0.681
Validation loss decreased (inf --> -0.680539).  Saving model ...
Epoch: 2 cost time: 0.974189043045044
Epoch: 2, Steps: 7 | Train Loss: 0.940 Vali Loss: 0.417 Vali Acc: 0.917 Test Loss: 0.417 Test Acc: 0.917
Validation loss decreased (-0.680539 --> -0.916662).  Saving model ...
Epoch: 3 cost time: 1.0130441188812256
Epoch: 3, Steps: 7 | Train Loss: 0.160 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9879786968231201
Epoch: 4, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9102725982666016
Epoch: 5, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 1.1056559085845947
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 0.8903059959411621
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.9358248710632324
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.979435920715332
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 1.100745439529419
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.0014402866363525
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.9551112651824951
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1854817867279053
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2662177085876465
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.087906837463379
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9415872097015381
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9969618320465088
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.032871961593628
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1641838550567627
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.034130334854126
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.084855556488037
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 962996
model size : 4.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4740474224090576
Epoch: 1, Steps: 7 | Train Loss: 2.357 Vali Loss: 1.745 Vali Acc: 0.597 Test Loss: 1.745 Test Acc: 0.597
Validation loss decreased (inf --> -0.597205).  Saving model ...
Epoch: 2 cost time: 0.99281907081604
Epoch: 2, Steps: 7 | Train Loss: 1.133 Vali Loss: 0.556 Vali Acc: 0.875 Test Loss: 0.556 Test Acc: 0.875
Validation loss decreased (-0.597205 --> -0.874994).  Saving model ...
Epoch: 3 cost time: 1.1759014129638672
Epoch: 3, Steps: 7 | Train Loss: 0.263 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.223609209060669
Epoch: 4, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 5 cost time: 1.1533753871917725
Epoch: 5, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 0.9843928813934326
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0045650005340576
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.099858283996582
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.0353100299835205
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9617197513580322
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0554454326629639
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.097092628479004
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0646343231201172
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.09702730178833
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.0500414371490479
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9617109298706055
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9363930225372314
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9788751602172852
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.007431983947754
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9594707489013672
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.03108811378479
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1554865837097168
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9190232753753662
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9779636859893799
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 962996
model size : 4.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4241440296173096
Epoch: 1, Steps: 7 | Train Loss: 2.461 Vali Loss: 1.591 Vali Acc: 0.681 Test Loss: 1.591 Test Acc: 0.681
Validation loss decreased (inf --> -0.680540).  Saving model ...
Epoch: 2 cost time: 1.0593664646148682
Epoch: 2, Steps: 7 | Train Loss: 0.875 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
Validation loss decreased (-0.680540 --> -0.874996).  Saving model ...
Epoch: 3 cost time: 1.0633294582366943
Epoch: 3, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916664).  Saving model ...
Epoch: 4 cost time: 1.153327465057373
Epoch: 4, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0255038738250732
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1772353649139404
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.343923807144165
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.1294143199920654
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.2220656871795654
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.147688388824463
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.0120172500610352
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.1640233993530273
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.077650785446167
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.0067577362060547
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.0762979984283447
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.0543346405029297
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2147634029388428
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0926547050476074
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1521196365356445
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0495343208312988
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0623323917388916
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9602019786834717
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.260462760925293
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 1.1568894386291504
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.1226046085357666
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.1931819915771484
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.0579266548156738
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.2079977989196777
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.131645917892456
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.9724123477935791
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0926132202148438
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.1084644794464111
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 1.1589775085449219
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 1.1064128875732422
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 1.1800191402435303
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 1.1633243560791016
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 1.0328443050384521
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 1.0648753643035889
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 1.0761895179748535
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 1.1338608264923096
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1063611507415771
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.132777214050293
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 1.0450685024261475
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 1.0088298320770264
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 1.2390613555908203
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 1.2733731269836426
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 1.0858526229858398
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 1.19461989402771
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.221470594406128
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 1.2520265579223633
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 51 cost time: 1.1766486167907715
Epoch: 51, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 52 cost time: 1.0609254837036133
Epoch: 52, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 53 cost time: 1.251988172531128
Epoch: 53, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 1.2091941833496094
Epoch: 54, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.2174022197723389
Epoch: 55, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.253281593322754
Epoch: 56, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.1925768852233887
Epoch: 57, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.3282690048217773
Epoch: 58, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.3354761600494385
Epoch: 59, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 60 cost time: 1.1447441577911377
Epoch: 60, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 61 cost time: 1.1424965858459473
Epoch: 61, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.204066276550293
Epoch: 62, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.0696485042572021
Epoch: 63, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.186286449432373
Epoch: 64, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.2229788303375244
Epoch: 65, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.1192505359649658
Epoch: 66, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.1695754528045654
Epoch: 67, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 68 cost time: 1.0624725818634033
Epoch: 68, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 69 cost time: 1.1685194969177246
Epoch: 69, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 70 cost time: 1.1855666637420654
Epoch: 70, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 71 cost time: 1.1316285133361816
Epoch: 71, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 72 cost time: 1.0047805309295654
Epoch: 72, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.1012370586395264
Epoch: 73, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.0368199348449707
Epoch: 74, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.1548271179199219
Epoch: 75, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.9558196067810059
Epoch: 76, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 77 cost time: 1.166600227355957
Epoch: 77, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 78 cost time: 1.1417930126190186
Epoch: 78, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 79 cost time: 1.1134281158447266
Epoch: 79, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 80 cost time: 1.2823073863983154
Epoch: 80, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 81 cost time: 1.3052639961242676
Epoch: 81, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 82 cost time: 1.0728743076324463
Epoch: 82, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 83 cost time: 1.2782652378082275
Epoch: 83, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 84 cost time: 1.1448159217834473
Epoch: 84, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 85 cost time: 1.2367887496948242
Epoch: 85, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 86 cost time: 1.1848626136779785
Epoch: 86, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 87 cost time: 1.1880757808685303
Epoch: 87, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 88 cost time: 1.324233055114746
Epoch: 88, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 89 cost time: 1.155078649520874
Epoch: 89, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 90 cost time: 1.2297327518463135
Epoch: 90, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 91 cost time: 1.282524585723877
Epoch: 91, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 92 cost time: 1.1724843978881836
Epoch: 92, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.1994776725769043
Epoch: 93, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 1.1395630836486816
Epoch: 94, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 1.033872127532959
Epoch: 95, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 1.1537647247314453
Epoch: 96, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 97 cost time: 1.1141729354858398
Epoch: 97, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 98 cost time: 1.1777126789093018
Epoch: 98, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 99 cost time: 0.9630074501037598
Epoch: 99, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 100 cost time: 1.1420962810516357
Epoch: 100, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 946612
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4089927673339844
Epoch: 1, Steps: 7 | Train Loss: 2.441 Vali Loss: 1.564 Vali Acc: 0.764 Test Loss: 1.564 Test Acc: 0.764
Validation loss decreased (inf --> -0.763873).  Saving model ...
Epoch: 2 cost time: 0.9523913860321045
Epoch: 2, Steps: 7 | Train Loss: 0.882 Vali Loss: 0.436 Vali Acc: 0.861 Test Loss: 0.436 Test Acc: 0.861
Validation loss decreased (-0.763873 --> -0.861107).  Saving model ...
Epoch: 3 cost time: 1.1493287086486816
Epoch: 3, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.861107 --> -0.916664).  Saving model ...
Epoch: 4 cost time: 1.114898681640625
Epoch: 4, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.133340835571289
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.283879280090332
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0757191181182861
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0929388999938965
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0349152088165283
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.904832124710083
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1575884819030762
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9741067886352539
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9428706169128418
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 946612
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.9103128910064697
Epoch: 1, Steps: 7 | Train Loss: 2.411 Vali Loss: 1.597 Vali Acc: 0.736 Test Loss: 1.597 Test Acc: 0.736
Validation loss decreased (inf --> -0.736095).  Saving model ...
Epoch: 2 cost time: 1.2475810050964355
Epoch: 2, Steps: 7 | Train Loss: 0.911 Vali Loss: 0.418 Vali Acc: 0.889 Test Loss: 0.418 Test Acc: 0.889
Validation loss decreased (-0.736095 --> -0.888885).  Saving model ...
Epoch: 3 cost time: 1.3656609058380127
Epoch: 3, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.888885 --> -0.930553).  Saving model ...
Epoch: 4 cost time: 1.0363142490386963
Epoch: 4, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 1.2945778369903564
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.064622163772583
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 1.3173038959503174
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 1.1389122009277344
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 1.3908817768096924
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3386690616607666
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.297558069229126
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2201552391052246
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2127790451049805
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.196199893951416
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2194843292236328
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1989881992340088
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1791341304779053
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1144895553588867
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 946612
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4482946395874023
Epoch: 1, Steps: 7 | Train Loss: 2.396 Vali Loss: 1.735 Vali Acc: 0.722 Test Loss: 1.735 Test Acc: 0.722
Validation loss decreased (inf --> -0.722205).  Saving model ...
Epoch: 2 cost time: 1.1577038764953613
Epoch: 2, Steps: 7 | Train Loss: 1.079 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
Validation loss decreased (-0.722205 --> -0.861106).  Saving model ...
Epoch: 3 cost time: 1.209367275238037
Epoch: 3, Steps: 7 | Train Loss: 0.191 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888885).  Saving model ...
Epoch: 4 cost time: 0.869215726852417
Epoch: 4, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 0.9036295413970947
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 1.2163796424865723
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 0.983060359954834
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 1.1995689868927002
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 9 cost time: 0.986459493637085
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0908739566802979
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8711059093475342
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9863507747650146
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1210525035858154
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0587477684020996
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0311057567596436
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9439444541931152
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.037599802017212
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0246086120605469
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 946612
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2991700172424316
Epoch: 1, Steps: 7 | Train Loss: 2.396 Vali Loss: 1.605 Vali Acc: 0.736 Test Loss: 1.605 Test Acc: 0.736
Validation loss decreased (inf --> -0.736095).  Saving model ...
Epoch: 2 cost time: 1.1334123611450195
Epoch: 2, Steps: 7 | Train Loss: 0.859 Vali Loss: 0.415 Vali Acc: 0.903 Test Loss: 0.415 Test Acc: 0.903
Validation loss decreased (-0.736095 --> -0.902774).  Saving model ...
Epoch: 3 cost time: 1.0296049118041992
Epoch: 3, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 4 cost time: 1.124828577041626
Epoch: 4, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.057366132736206
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0328898429870605
Epoch: 6, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1799185276031494
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1364834308624268
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0072612762451172
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.2318036556243896
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1877648830413818
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2330653667449951
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.110886812210083
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9859554767608643
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0013678073883057
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.149810791015625
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1425316333770752
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.023423433303833
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.204357385635376
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 938420
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1948678493499756
Epoch: 1, Steps: 7 | Train Loss: 2.417 Vali Loss: 1.625 Vali Acc: 0.722 Test Loss: 1.625 Test Acc: 0.722
Validation loss decreased (inf --> -0.722206).  Saving model ...
Epoch: 2 cost time: 1.03891921043396
Epoch: 2, Steps: 7 | Train Loss: 0.877 Vali Loss: 0.431 Vali Acc: 0.889 Test Loss: 0.431 Test Acc: 0.889
Validation loss decreased (-0.722206 --> -0.888885).  Saving model ...
Epoch: 3 cost time: 1.1285531520843506
Epoch: 3, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 1.0409603118896484
Epoch: 4, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1468966007232666
Epoch: 5, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0643742084503174
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.013002634048462
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.0679411888122559
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.034294843673706
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.9085369110107422
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9958441257476807
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.029175043106079
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.900230884552002
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9173190593719482
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0056955814361572
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9947018623352051
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9927382469177246
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0498871803283691
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1921360492706299
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 938420
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2481279373168945
Epoch: 1, Steps: 7 | Train Loss: 2.383 Vali Loss: 1.609 Vali Acc: 0.764 Test Loss: 1.609 Test Acc: 0.764
Validation loss decreased (inf --> -0.763873).  Saving model ...
Epoch: 2 cost time: 1.0765719413757324
Epoch: 2, Steps: 7 | Train Loss: 0.891 Vali Loss: 0.426 Vali Acc: 0.889 Test Loss: 0.426 Test Acc: 0.889
Validation loss decreased (-0.763873 --> -0.888885).  Saving model ...
Epoch: 3 cost time: 1.0574376583099365
Epoch: 3, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.342 Vali Acc: 0.917 Test Loss: 0.342 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 0.8989160060882568
Epoch: 4, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 1.026033639907837
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 0.9777126312255859
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958332).  Saving model ...
Epoch: 7 cost time: 0.8463761806488037
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 8 cost time: 0.894829273223877
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 9 cost time: 0.9902679920196533
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9818317890167236
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0617525577545166
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.89833664894104
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8459057807922363
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9212315082550049
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9803037643432617
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9146561622619629
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8882808685302734
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0646700859069824
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 938420
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0989644527435303
Epoch: 1, Steps: 7 | Train Loss: 2.415 Vali Loss: 1.722 Vali Acc: 0.611 Test Loss: 1.722 Test Acc: 0.611
Validation loss decreased (inf --> -0.611094).  Saving model ...
Epoch: 2 cost time: 0.8844778537750244
Epoch: 2, Steps: 7 | Train Loss: 1.081 Vali Loss: 0.569 Vali Acc: 0.861 Test Loss: 0.569 Test Acc: 0.861
Validation loss decreased (-0.611094 --> -0.861105).  Saving model ...
Epoch: 3 cost time: 0.9884815216064453
Epoch: 3, Steps: 7 | Train Loss: 0.196 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874997).  Saving model ...
Epoch: 4 cost time: 0.8758189678192139
Epoch: 4, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 5 cost time: 0.9680852890014648
Epoch: 5, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930554).  Saving model ...
Epoch: 6 cost time: 0.97129225730896
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.930554 --> -0.958332).  Saving model ...
Epoch: 7 cost time: 0.9118731021881104
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0056767463684082
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0136499404907227
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9630229473114014
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0330631732940674
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9554059505462646
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9352645874023438
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0492043495178223
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9280440807342529
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9895203113555908
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 938420
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1617472171783447
Epoch: 1, Steps: 7 | Train Loss: 2.637 Vali Loss: 2.119 Vali Acc: 0.319 Test Loss: 2.119 Test Acc: 0.319
Validation loss decreased (inf --> -0.319423).  Saving model ...
Epoch: 2 cost time: 0.9380209445953369
Epoch: 2, Steps: 7 | Train Loss: 1.452 Vali Loss: 0.947 Vali Acc: 0.792 Test Loss: 0.947 Test Acc: 0.792
Validation loss decreased (-0.319423 --> -0.791657).  Saving model ...
Epoch: 3 cost time: 1.1109681129455566
Epoch: 3, Steps: 7 | Train Loss: 0.455 Vali Loss: 0.427 Vali Acc: 0.861 Test Loss: 0.427 Test Acc: 0.861
Validation loss decreased (-0.791657 --> -0.861107).  Saving model ...
Epoch: 4 cost time: 0.952002763748169
Epoch: 4, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
Validation loss decreased (-0.861107 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 1.012458324432373
Epoch: 5, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.16200590133667
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0858588218688965
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.0395033359527588
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.9999539852142334
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.0550425052642822
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.9794466495513916
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.8828353881835938
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9118502140045166
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.050893783569336
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9144330024719238
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0392162799835205
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7609009742736816
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0060193538665771
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.889855146408081
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9393658638000488
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.921898603439331
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 594164
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.3158297538757324
Epoch: 1, Steps: 7 | Train Loss: 2.614 Vali Loss: 2.134 Vali Acc: 0.306 Test Loss: 2.134 Test Acc: 0.306
Validation loss decreased (inf --> -0.305534).  Saving model ...
Epoch: 2 cost time: 1.0839157104492188
Epoch: 2, Steps: 7 | Train Loss: 1.469 Vali Loss: 0.967 Vali Acc: 0.792 Test Loss: 0.967 Test Acc: 0.792
Validation loss decreased (-0.305534 --> -0.791657).  Saving model ...
Epoch: 3 cost time: 1.0268211364746094
Epoch: 3, Steps: 7 | Train Loss: 0.474 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
Validation loss decreased (-0.791657 --> -0.874996).  Saving model ...
Epoch: 4 cost time: 1.1071515083312988
Epoch: 4, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 1.1023390293121338
Epoch: 5, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0265815258026123
Epoch: 6, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.383 Vali Acc: 0.861 Test Loss: 0.383 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0562031269073486
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 0.9701893329620361
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.142143726348877
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2487220764160156
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.1427357196807861
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.09852933883667
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0354509353637695
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0505030155181885
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.253404140472412
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1210827827453613
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1753849983215332
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0916435718536377
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9455280303955078
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1301589012145996
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9787793159484863
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 594164
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.4668076038360596
Epoch: 1, Steps: 7 | Train Loss: 2.571 Vali Loss: 2.107 Vali Acc: 0.431 Test Loss: 2.107 Test Acc: 0.431
Validation loss decreased (inf --> -0.430534).  Saving model ...
Epoch: 2 cost time: 1.0347414016723633
Epoch: 2, Steps: 7 | Train Loss: 1.487 Vali Loss: 0.990 Vali Acc: 0.819 Test Loss: 0.990 Test Acc: 0.819
Validation loss decreased (-0.430534 --> -0.819435).  Saving model ...
Epoch: 3 cost time: 0.8511919975280762
Epoch: 3, Steps: 7 | Train Loss: 0.525 Vali Loss: 0.438 Vali Acc: 0.931 Test Loss: 0.438 Test Acc: 0.931
Validation loss decreased (-0.819435 --> -0.930551).  Saving model ...
Epoch: 4 cost time: 0.9389071464538574
Epoch: 4, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9429254531860352
Epoch: 5, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9646086692810059
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9535315036773682
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9247589111328125
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0357475280761719
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.047818660736084
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.930551 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.113813877105713
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.1108899116516113
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.0201425552368164
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8900237083435059
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.001983404159546
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0585365295410156
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0034222602844238
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1292798519134521
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1263067722320557
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8561983108520508
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9805965423583984
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9803876876831055
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 594164
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7898828983306885
Epoch: 1, Steps: 7 | Train Loss: 2.538 Vali Loss: 2.103 Vali Acc: 0.444 Test Loss: 2.103 Test Acc: 0.444
Validation loss decreased (inf --> -0.444423).  Saving model ...
Epoch: 2 cost time: 0.9523782730102539
Epoch: 2, Steps: 7 | Train Loss: 1.619 Vali Loss: 1.101 Vali Acc: 0.833 Test Loss: 1.101 Test Acc: 0.833
Validation loss decreased (-0.444423 --> -0.833322).  Saving model ...
Epoch: 3 cost time: 0.923729419708252
Epoch: 3, Steps: 7 | Train Loss: 0.660 Vali Loss: 0.541 Vali Acc: 0.889 Test Loss: 0.541 Test Acc: 0.889
Validation loss decreased (-0.833322 --> -0.888883).  Saving model ...
Epoch: 4 cost time: 0.8694767951965332
Epoch: 4, Steps: 7 | Train Loss: 0.247 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9266834259033203
Epoch: 5, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.348 Vali Acc: 0.861 Test Loss: 0.348 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8722095489501953
Epoch: 6, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 0.9571175575256348
Epoch: 7, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0185496807098389
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.052706241607666
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9555902481079102
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.169877290725708
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.8958072662353516
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0828099250793457
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0682132244110107
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.8766024112701416
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0524892807006836
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.010918140411377
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0781476497650146
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.8926224708557129
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.111297607421875
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0203838348388672
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8939406871795654
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9433555603027344
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0794856548309326
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.9652729034423828
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.9905002117156982
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0431642532348633
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9222626686096191
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0471010208129883
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.9486393928527832
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9197468757629395
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9841794967651367
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0927772521972656
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9483640193939209
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0651395320892334
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8902642726898193
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0469436645507812
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8501987457275391
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0305945873260498
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 594164
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2088067531585693
Epoch: 1, Steps: 7 | Train Loss: 2.361 Vali Loss: 1.932 Vali Acc: 0.583 Test Loss: 1.932 Test Acc: 0.583
Validation loss decreased (inf --> -0.583314).  Saving model ...
Epoch: 2 cost time: 1.0235390663146973
Epoch: 2, Steps: 7 | Train Loss: 1.298 Vali Loss: 0.840 Vali Acc: 0.819 Test Loss: 0.840 Test Acc: 0.819
Validation loss decreased (-0.583314 --> -0.819436).  Saving model ...
Epoch: 3 cost time: 0.9582877159118652
Epoch: 3, Steps: 7 | Train Loss: 0.416 Vali Loss: 0.427 Vali Acc: 0.847 Test Loss: 0.427 Test Acc: 0.847
Validation loss decreased (-0.819436 --> -0.847218).  Saving model ...
Epoch: 4 cost time: 1.0080678462982178
Epoch: 4, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
Validation loss decreased (-0.847218 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 1.01414155960083
Epoch: 5, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0817382335662842
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9659051895141602
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.0335371494293213
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.966073751449585
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9813940525054932
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0436391830444336
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0592246055603027
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1425554752349854
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0246059894561768
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0696680545806885
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9968564510345459
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.086479902267456
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 528628
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8860034942626953
Epoch: 1, Steps: 7 | Train Loss: 2.377 Vali Loss: 1.926 Vali Acc: 0.569 Test Loss: 1.926 Test Acc: 0.569
Validation loss decreased (inf --> -0.569425).  Saving model ...
Epoch: 2 cost time: 0.9175963401794434
Epoch: 2, Steps: 7 | Train Loss: 1.325 Vali Loss: 0.862 Vali Acc: 0.847 Test Loss: 0.862 Test Acc: 0.847
Validation loss decreased (-0.569425 --> -0.847214).  Saving model ...
Epoch: 3 cost time: 1.0578172206878662
Epoch: 3, Steps: 7 | Train Loss: 0.448 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
Validation loss decreased (-0.847214 --> -0.874996).  Saving model ...
Epoch: 4 cost time: 0.9481151103973389
Epoch: 4, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.360 Vali Acc: 0.917 Test Loss: 0.360 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 0.9192836284637451
Epoch: 5, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9420881271362305
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9386358261108398
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.0806779861450195
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.113335132598877
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8958351612091064
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1520819664001465
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9073138236999512
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.854295015335083
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.8959150314331055
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.9523191452026367
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.8677170276641846
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.2300801277160645
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9388461112976074
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9487483501434326
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9565525054931641
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9755158424377441
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9157509803771973
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9902193546295166
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0744986534118652
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.966355562210083
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9720370769500732
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 528628
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.114419937133789
Epoch: 1, Steps: 7 | Train Loss: 2.396 Vali Loss: 1.957 Vali Acc: 0.556 Test Loss: 1.957 Test Acc: 0.556
Validation loss decreased (inf --> -0.555536).  Saving model ...
Epoch: 2 cost time: 0.9528582096099854
Epoch: 2, Steps: 7 | Train Loss: 1.382 Vali Loss: 0.893 Vali Acc: 0.833 Test Loss: 0.893 Test Acc: 0.833
Validation loss decreased (-0.555536 --> -0.833324).  Saving model ...
Epoch: 3 cost time: 0.9250314235687256
Epoch: 3, Steps: 7 | Train Loss: 0.482 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
Validation loss decreased (-0.833324 --> -0.874996).  Saving model ...
Epoch: 4 cost time: 0.968576192855835
Epoch: 4, Steps: 7 | Train Loss: 0.157 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 0.9691951274871826
Epoch: 5, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 0.842602014541626
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8997933864593506
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 0.8868880271911621
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9435954093933105
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8339745998382568
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8983662128448486
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9351668357849121
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.059563398361206
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9714224338531494
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9091248512268066
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.9545114040374756
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.9915633201599121
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.1456856727600098
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.9636609554290771
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1630065441131592
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.027308702468872
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2502834796905518
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.130993366241455
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0796005725860596
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9943380355834961
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0528087615966797
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1948869228363037
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0705277919769287
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 528628
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2253758907318115
Epoch: 1, Steps: 7 | Train Loss: 2.390 Vali Loss: 2.007 Vali Acc: 0.472 Test Loss: 2.007 Test Acc: 0.472
Validation loss decreased (inf --> -0.472202).  Saving model ...
Epoch: 2 cost time: 0.9532105922698975
Epoch: 2, Steps: 7 | Train Loss: 1.503 Vali Loss: 1.027 Vali Acc: 0.764 Test Loss: 1.027 Test Acc: 0.764
Validation loss decreased (-0.472202 --> -0.763879).  Saving model ...
Epoch: 3 cost time: 0.925947904586792
Epoch: 3, Steps: 7 | Train Loss: 0.632 Vali Loss: 0.536 Vali Acc: 0.903 Test Loss: 0.536 Test Acc: 0.903
Validation loss decreased (-0.763879 --> -0.902772).  Saving model ...
Epoch: 4 cost time: 0.9925153255462646
Epoch: 4, Steps: 7 | Train Loss: 0.256 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9472362995147705
Epoch: 5, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 0.993873119354248
Epoch: 6, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 0.8868279457092285
Epoch: 7, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.0866727828979492
Epoch: 8, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.8525924682617188
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 1.0490775108337402
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9526093006134033
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.310 Vali Acc: 0.931 Test Loss: 0.310 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8909761905670166
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8810796737670898
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1204841136932373
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1459262371063232
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0896668434143066
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0380053520202637
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1620121002197266
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0668296813964844
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.931 Test Loss: 0.285 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 528628
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.327528238296509
Epoch: 1, Steps: 7 | Train Loss: 2.445 Vali Loss: 1.959 Vali Acc: 0.458 Test Loss: 1.959 Test Acc: 0.458
Validation loss decreased (inf --> -0.458314).  Saving model ...
Epoch: 2 cost time: 1.0754148960113525
Epoch: 2, Steps: 7 | Train Loss: 1.321 Vali Loss: 0.931 Vali Acc: 0.722 Test Loss: 0.931 Test Acc: 0.722
Validation loss decreased (-0.458314 --> -0.722213).  Saving model ...
Epoch: 3 cost time: 0.977649450302124
Epoch: 3, Steps: 7 | Train Loss: 0.430 Vali Loss: 0.460 Vali Acc: 0.847 Test Loss: 0.460 Test Acc: 0.847
Validation loss decreased (-0.722213 --> -0.847218).  Saving model ...
Epoch: 4 cost time: 0.9132940769195557
Epoch: 4, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
Validation loss decreased (-0.847218 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 1.1149554252624512
Epoch: 5, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0478506088256836
Epoch: 6, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.430 Vali Acc: 0.847 Test Loss: 0.430 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8971562385559082
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1589076519012451
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.8175332546234131
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.0173306465148926
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.8598132133483887
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.03566575050354
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8473262786865234
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.880479097366333
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0079119205474854
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9282369613647461
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9928891658782959
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9958088397979736
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9685544967651367
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.127608060836792
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9634602069854736
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.959120512008667
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2267286777496338
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 495860
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0985255241394043
Epoch: 1, Steps: 7 | Train Loss: 2.407 Vali Loss: 1.957 Vali Acc: 0.458 Test Loss: 1.957 Test Acc: 0.458
Validation loss decreased (inf --> -0.458314).  Saving model ...
Epoch: 2 cost time: 0.9102621078491211
Epoch: 2, Steps: 7 | Train Loss: 1.330 Vali Loss: 0.941 Vali Acc: 0.764 Test Loss: 0.941 Test Acc: 0.764
Validation loss decreased (-0.458314 --> -0.763879).  Saving model ...
Epoch: 3 cost time: 0.8667182922363281
Epoch: 3, Steps: 7 | Train Loss: 0.439 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
Validation loss decreased (-0.763879 --> -0.874995).  Saving model ...
Epoch: 4 cost time: 1.0452847480773926
Epoch: 4, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 0.9547641277313232
Epoch: 5, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9932396411895752
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.430 Vali Acc: 0.847 Test Loss: 0.430 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0507333278656006
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0040676593780518
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.10467529296875
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.9963364601135254
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1251823902130127
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.9049034118652344
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9838905334472656
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.030203104019165
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.062532901763916
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8545260429382324
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0053086280822754
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.916388750076294
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9530603885650635
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0116355419158936
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.053406000137329
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 495860
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2587532997131348
Epoch: 1, Steps: 7 | Train Loss: 2.377 Vali Loss: 1.922 Vali Acc: 0.528 Test Loss: 1.922 Test Acc: 0.528
Validation loss decreased (inf --> -0.527759).  Saving model ...
Epoch: 2 cost time: 0.9758782386779785
Epoch: 2, Steps: 7 | Train Loss: 1.382 Vali Loss: 0.936 Vali Acc: 0.778 Test Loss: 0.936 Test Acc: 0.778
Validation loss decreased (-0.527759 --> -0.777768).  Saving model ...
Epoch: 3 cost time: 0.9377400875091553
Epoch: 3, Steps: 7 | Train Loss: 0.479 Vali Loss: 0.456 Vali Acc: 0.903 Test Loss: 0.456 Test Acc: 0.903
Validation loss decreased (-0.777768 --> -0.902773).  Saving model ...
Epoch: 4 cost time: 0.8447120189666748
Epoch: 4, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 1.1294269561767578
Epoch: 5, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.005683183670044
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.909491777420044
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.289 Vali Acc: 0.931 Test Loss: 0.289 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 1.1763520240783691
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.134770154953003
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0541410446166992
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9919185638427734
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8902108669281006
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9395160675048828
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0365252494812012
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0194313526153564
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0228979587554932
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.025348424911499
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 495860
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.9497830867767334
Epoch: 1, Steps: 7 | Train Loss: 2.390 Vali Loss: 1.991 Vali Acc: 0.514 Test Loss: 1.991 Test Acc: 0.514
Validation loss decreased (inf --> -0.513869).  Saving model ...
Epoch: 2 cost time: 0.8693137168884277
Epoch: 2, Steps: 7 | Train Loss: 1.494 Vali Loss: 1.056 Vali Acc: 0.736 Test Loss: 1.056 Test Acc: 0.736
Validation loss decreased (-0.513869 --> -0.736101).  Saving model ...
Epoch: 3 cost time: 0.825493574142456
Epoch: 3, Steps: 7 | Train Loss: 0.624 Vali Loss: 0.541 Vali Acc: 0.875 Test Loss: 0.541 Test Acc: 0.875
Validation loss decreased (-0.736101 --> -0.874995).  Saving model ...
Epoch: 4 cost time: 0.9919247627258301
Epoch: 4, Steps: 7 | Train Loss: 0.232 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 5 cost time: 0.9493205547332764
Epoch: 5, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 0.9158651828765869
Epoch: 6, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0431156158447266
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 1.0061888694763184
Epoch: 8, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.8716583251953125
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7957873344421387
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.8293941020965576
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9653520584106445
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1003544330596924
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.0024449825286865
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0332012176513672
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.931 Test Loss: 0.285 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.9798076152801514
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.1713500022888184
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.0241987705230713
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9545092582702637
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0231719017028809
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.9358229637145996
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0510385036468506
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0856099128723145
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9481105804443359
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8728537559509277
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.8720195293426514
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.979778528213501
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.944 Test Loss: 0.283 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.93302321434021
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9942703247070312
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9998927116394043
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8593189716339111
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9793989658355713
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.931 Test Loss: 0.289 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8841292858123779
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8398430347442627
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0191471576690674
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8978381156921387
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 495860
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.81856107711792
Epoch: 1, Steps: 7 | Train Loss: 2.468 Vali Loss: 2.036 Vali Acc: 0.444 Test Loss: 2.036 Test Acc: 0.444
Validation loss decreased (inf --> -0.444424).  Saving model ...
Epoch: 2 cost time: 0.9205865859985352
Epoch: 2, Steps: 7 | Train Loss: 1.376 Vali Loss: 0.864 Vali Acc: 0.861 Test Loss: 0.864 Test Acc: 0.861
Validation loss decreased (-0.444424 --> -0.861102).  Saving model ...
Epoch: 3 cost time: 0.7346522808074951
Epoch: 3, Steps: 7 | Train Loss: 0.426 Vali Loss: 0.457 Vali Acc: 0.889 Test Loss: 0.457 Test Acc: 0.889
Validation loss decreased (-0.861102 --> -0.888884).  Saving model ...
Epoch: 4 cost time: 0.8651485443115234
Epoch: 4, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 0.9002254009246826
Epoch: 5, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.316 Vali Acc: 0.931 Test Loss: 0.316 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 0.9398221969604492
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9391384124755859
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9669055938720703
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.837665319442749
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9229297637939453
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9246337413787842
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9560396671295166
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0466969013214111
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9811532497406006
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0725219249725342
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 479476
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.5095860958099365
Epoch: 1, Steps: 7 | Train Loss: 2.436 Vali Loss: 2.051 Vali Acc: 0.417 Test Loss: 2.051 Test Acc: 0.417
Validation loss decreased (inf --> -0.416646).  Saving model ...
Epoch: 2 cost time: 1.1140031814575195
Epoch: 2, Steps: 7 | Train Loss: 1.380 Vali Loss: 0.890 Vali Acc: 0.861 Test Loss: 0.890 Test Acc: 0.861
Validation loss decreased (-0.416646 --> -0.861102).  Saving model ...
Epoch: 3 cost time: 1.1400139331817627
Epoch: 3, Steps: 7 | Train Loss: 0.434 Vali Loss: 0.480 Vali Acc: 0.875 Test Loss: 0.480 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874995).  Saving model ...
Epoch: 4 cost time: 1.0940065383911133
Epoch: 4, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.345 Vali Acc: 0.931 Test Loss: 0.345 Test Acc: 0.931
Validation loss decreased (-0.874995 --> -0.930552).  Saving model ...
Epoch: 5 cost time: 0.9680109024047852
Epoch: 5, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.321 Vali Acc: 0.931 Test Loss: 0.321 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 1.150073528289795
Epoch: 6, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.028226375579834
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2330713272094727
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9448158740997314
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.345 Vali Acc: 0.903 Test Loss: 0.345 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0501506328582764
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9579229354858398
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9355649948120117
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8617188930511475
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9570887088775635
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.048229455947876
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 479476
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.2624638080596924
Epoch: 1, Steps: 7 | Train Loss: 2.402 Vali Loss: 2.070 Vali Acc: 0.417 Test Loss: 2.070 Test Acc: 0.417
Validation loss decreased (inf --> -0.416646).  Saving model ...
Epoch: 2 cost time: 1.0255749225616455
Epoch: 2, Steps: 7 | Train Loss: 1.400 Vali Loss: 0.919 Vali Acc: 0.861 Test Loss: 0.919 Test Acc: 0.861
Validation loss decreased (-0.416646 --> -0.861102).  Saving model ...
Epoch: 3 cost time: 0.9336197376251221
Epoch: 3, Steps: 7 | Train Loss: 0.454 Vali Loss: 0.474 Vali Acc: 0.903 Test Loss: 0.474 Test Acc: 0.903
Validation loss decreased (-0.861102 --> -0.902773).  Saving model ...
Epoch: 4 cost time: 0.9238598346710205
Epoch: 4, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 0.9351279735565186
Epoch: 5, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 0.8899741172790527
Epoch: 6, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9395239353179932
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8815100193023682
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8747143745422363
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.834219217300415
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.8715939521789551
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.9075098037719727
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.8540670871734619
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.9703409671783447
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.970505952835083
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.0747485160827637
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9292173385620117
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9399065971374512
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.819180965423584
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9411196708679199
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7954084873199463
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9174723625183105
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.8662095069885254
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.8659999370574951
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 0.8110592365264893
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8925676345825195
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8595030307769775
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9498610496520996
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 29 cost time: 0.8729307651519775
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 0.9784235954284668
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 31 cost time: 0.9337131977081299
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 32 cost time: 0.849146842956543
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 1.0327231884002686
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9886529445648193
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 0.9042201042175293
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 36 cost time: 0.8993122577667236
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 37 cost time: 0.9146463871002197
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9394891262054443
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.898956298828125
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0191805362701416
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9820725917816162
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9171457290649414
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.9288902282714844
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8680427074432373
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.939753532409668
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.9396858215332031
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 479476
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1226398944854736
Epoch: 1, Steps: 7 | Train Loss: 2.449 Vali Loss: 2.108 Vali Acc: 0.444 Test Loss: 2.108 Test Acc: 0.444
Validation loss decreased (inf --> -0.444423).  Saving model ...
Epoch: 2 cost time: 0.8917586803436279
Epoch: 2, Steps: 7 | Train Loss: 1.560 Vali Loss: 1.044 Vali Acc: 0.819 Test Loss: 1.044 Test Acc: 0.819
Validation loss decreased (-0.444423 --> -0.819434).  Saving model ...
Epoch: 3 cost time: 0.9486865997314453
Epoch: 3, Steps: 7 | Train Loss: 0.626 Vali Loss: 0.565 Vali Acc: 0.875 Test Loss: 0.565 Test Acc: 0.875
Validation loss decreased (-0.819434 --> -0.874994).  Saving model ...
Epoch: 4 cost time: 0.7884302139282227
Epoch: 4, Steps: 7 | Train Loss: 0.224 Vali Loss: 0.386 Vali Acc: 0.903 Test Loss: 0.386 Test Acc: 0.903
Validation loss decreased (-0.874994 --> -0.902774).  Saving model ...
Epoch: 5 cost time: 0.945831298828125
Epoch: 5, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 6 cost time: 0.9070122241973877
Epoch: 6, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 0.9946146011352539
Epoch: 7, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 0.8418829441070557
Epoch: 8, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6578371524810791
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7320404052734375
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8065381050109863
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.934739351272583
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8468725681304932
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0113732814788818
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9378488063812256
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8734066486358643
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8465287685394287
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 479476
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1928470134735107
Epoch: 1, Steps: 7 | Train Loss: 2.438 Vali Loss: 1.958 Vali Acc: 0.556 Test Loss: 1.958 Test Acc: 0.556
Validation loss decreased (inf --> -0.555536).  Saving model ...
Epoch: 2 cost time: 1.076566457748413
Epoch: 2, Steps: 7 | Train Loss: 1.444 Vali Loss: 0.849 Vali Acc: 0.903 Test Loss: 0.849 Test Acc: 0.903
Validation loss decreased (-0.555536 --> -0.902769).  Saving model ...
Epoch: 3 cost time: 0.9601881504058838
Epoch: 3, Steps: 7 | Train Loss: 0.424 Vali Loss: 0.408 Vali Acc: 0.903 Test Loss: 0.408 Test Acc: 0.903
Validation loss decreased (-0.902769 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 0.9817790985107422
Epoch: 4, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 0.9062180519104004
Epoch: 5, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 0.9718823432922363
Epoch: 6, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9492878913879395
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9260752201080322
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8951058387756348
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8997654914855957
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0559518337249756
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.8860781192779541
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.9602499008178711
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.988966703414917
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.9000446796417236
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.9965386390686035
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.8968393802642822
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.8124029636383057
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.8094639778137207
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8799502849578857
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.8485012054443359
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.8155539035797119
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.7899906635284424
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.8533878326416016
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8986830711364746
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9469864368438721
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9509763717651367
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.8939478397369385
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.8213467597961426
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8742415904998779
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8557868003845215
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8215744495391846
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9263815879821777
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8874952793121338
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8405930995941162
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8587496280670166
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9009528160095215
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.7852747440338135
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 471284
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.089042901992798
Epoch: 1, Steps: 7 | Train Loss: 2.458 Vali Loss: 1.959 Vali Acc: 0.458 Test Loss: 1.959 Test Acc: 0.458
Validation loss decreased (inf --> -0.458314).  Saving model ...
Epoch: 2 cost time: 1.0912890434265137
Epoch: 2, Steps: 7 | Train Loss: 1.479 Vali Loss: 0.877 Vali Acc: 0.861 Test Loss: 0.877 Test Acc: 0.861
Validation loss decreased (-0.458314 --> -0.861102).  Saving model ...
Epoch: 3 cost time: 1.0500881671905518
Epoch: 3, Steps: 7 | Train Loss: 0.457 Vali Loss: 0.431 Vali Acc: 0.889 Test Loss: 0.431 Test Acc: 0.889
Validation loss decreased (-0.861102 --> -0.888885).  Saving model ...
Epoch: 4 cost time: 0.9973466396331787
Epoch: 4, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 0.9630956649780273
Epoch: 5, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0410563945770264
Epoch: 6, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 1.0491995811462402
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9810521602630615
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.914222002029419
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.9776968955993652
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.9536917209625244
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.9748187065124512
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1137549877166748
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9531803131103516
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9604392051696777
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9469578266143799
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8876962661743164
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0113894939422607
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9594004154205322
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8980789184570312
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0484287738800049
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 471284
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.249429225921631
Epoch: 1, Steps: 7 | Train Loss: 2.447 Vali Loss: 1.940 Vali Acc: 0.542 Test Loss: 1.940 Test Acc: 0.542
Validation loss decreased (inf --> -0.541647).  Saving model ...
Epoch: 2 cost time: 0.7832722663879395
Epoch: 2, Steps: 7 | Train Loss: 1.525 Vali Loss: 0.891 Vali Acc: 0.889 Test Loss: 0.891 Test Acc: 0.889
Validation loss decreased (-0.541647 --> -0.888880).  Saving model ...
Epoch: 3 cost time: 0.9548883438110352
Epoch: 3, Steps: 7 | Train Loss: 0.495 Vali Loss: 0.418 Vali Acc: 0.931 Test Loss: 0.418 Test Acc: 0.931
Validation loss decreased (-0.888880 --> -0.930551).  Saving model ...
Epoch: 4 cost time: 0.969294548034668
Epoch: 4, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9465444087982178
Epoch: 5, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9996447563171387
Epoch: 6, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 1.0181982517242432
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9321103096008301
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.0329341888427734
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.2014906406402588
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.0665626525878906
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.86734938621521
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0347676277160645
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.12662672996521
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1158154010772705
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.062018871307373
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.9993233680725098
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9206974506378174
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.060600757598877
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.9449994564056396
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.8245620727539062
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.9608910083770752
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.9593150615692139
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.9099485874176025
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0371575355529785
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9543287754058838
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.08815336227417
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.9868230819702148
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.0297603607177734
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.0794198513031006
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.9689438343048096
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.9285860061645508
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 1.0830137729644775
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.9341230392456055
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1633555889129639
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.083066463470459
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1143107414245605
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.039289951324463
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9688174724578857
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9390854835510254
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0076515674591064
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0180556774139404
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.0437049865722656
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 471284
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.055551052093506
Epoch: 1, Steps: 7 | Train Loss: 2.399 Vali Loss: 1.976 Vali Acc: 0.556 Test Loss: 1.976 Test Acc: 0.556
Validation loss decreased (inf --> -0.555536).  Saving model ...
Epoch: 2 cost time: 0.9124395847320557
Epoch: 2, Steps: 7 | Train Loss: 1.611 Vali Loss: 1.016 Vali Acc: 0.889 Test Loss: 1.016 Test Acc: 0.889
Validation loss decreased (-0.555536 --> -0.888879).  Saving model ...
Epoch: 3 cost time: 0.8360588550567627
Epoch: 3, Steps: 7 | Train Loss: 0.634 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8288397789001465
Epoch: 4, Steps: 7 | Train Loss: 0.200 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888885).  Saving model ...
Epoch: 5 cost time: 0.907625675201416
Epoch: 5, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 0.7790827751159668
Epoch: 6, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7850141525268555
Epoch: 7, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 0.846177339553833
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.7557196617126465
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.8121705055236816
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8425023555755615
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8369150161743164
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8702266216278076
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9695801734924316
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8752632141113281
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8707995414733887
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8448667526245117
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7582216262817383
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9611461162567139
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 471284
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0929126739501953
Epoch: 1, Steps: 7 | Train Loss: 2.379 Vali Loss: 1.872 Vali Acc: 0.417 Test Loss: 1.872 Test Acc: 0.417
Validation loss decreased (inf --> -0.416648).  Saving model ...
Epoch: 2 cost time: 0.9610848426818848
Epoch: 2, Steps: 7 | Train Loss: 1.357 Vali Loss: 0.830 Vali Acc: 0.806 Test Loss: 0.830 Test Acc: 0.806
Validation loss decreased (-0.416648 --> -0.805547).  Saving model ...
Epoch: 3 cost time: 0.9404799938201904
Epoch: 3, Steps: 7 | Train Loss: 0.443 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
Validation loss decreased (-0.805547 --> -0.874996).  Saving model ...
Epoch: 4 cost time: 0.9182074069976807
Epoch: 4, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.375 Vali Acc: 0.861 Test Loss: 0.375 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8866746425628662
Epoch: 5, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 6 cost time: 0.8391592502593994
Epoch: 6, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 0.8554387092590332
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8755533695220947
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.8754956722259521
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9240972995758057
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7799677848815918
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9636039733886719
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9207923412322998
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8180243968963623
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9899888038635254
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9193418025970459
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0074238777160645
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8902177810668945
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 467188
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.787353754043579
Epoch: 1, Steps: 7 | Train Loss: 2.383 Vali Loss: 1.877 Vali Acc: 0.444 Test Loss: 1.877 Test Acc: 0.444
Validation loss decreased (inf --> -0.444426).  Saving model ...
Epoch: 2 cost time: 0.9357254505157471
Epoch: 2, Steps: 7 | Train Loss: 1.371 Vali Loss: 0.843 Vali Acc: 0.806 Test Loss: 0.843 Test Acc: 0.806
Validation loss decreased (-0.444426 --> -0.805547).  Saving model ...
Epoch: 3 cost time: 0.9020993709564209
Epoch: 3, Steps: 7 | Train Loss: 0.476 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
Validation loss decreased (-0.805547 --> -0.874996).  Saving model ...
Epoch: 4 cost time: 0.925330638885498
Epoch: 4, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 5 cost time: 0.888190746307373
Epoch: 5, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 6 cost time: 1.0362648963928223
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 0.9482438564300537
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.808800458908081
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.955960750579834
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9850928783416748
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0176072120666504
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9030489921569824
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9781301021575928
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1038501262664795
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9421539306640625
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.909684419631958
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.8987622261047363
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.065234661102295
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.9571561813354492
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.995873212814331
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9717795848846436
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0628998279571533
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9063858985900879
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0905675888061523
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0950472354888916
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9723851680755615
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8664395809173584
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.942352294921875
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 467188
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.0632803440093994
Epoch: 1, Steps: 7 | Train Loss: 2.396 Vali Loss: 1.880 Vali Acc: 0.444 Test Loss: 1.880 Test Acc: 0.444
Validation loss decreased (inf --> -0.444426).  Saving model ...
Epoch: 2 cost time: 0.9256236553192139
Epoch: 2, Steps: 7 | Train Loss: 1.424 Vali Loss: 0.845 Vali Acc: 0.861 Test Loss: 0.845 Test Acc: 0.861
Validation loss decreased (-0.444426 --> -0.861103).  Saving model ...
Epoch: 3 cost time: 0.8376743793487549
Epoch: 3, Steps: 7 | Train Loss: 0.512 Vali Loss: 0.405 Vali Acc: 0.903 Test Loss: 0.405 Test Acc: 0.903
Validation loss decreased (-0.861103 --> -0.902774).  Saving model ...
Epoch: 4 cost time: 0.872805118560791
Epoch: 4, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 5 cost time: 0.8673787117004395
Epoch: 5, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 1.0298314094543457
Epoch: 6, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 0.9991724491119385
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 0.9594645500183105
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 1.039919137954712
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8397676944732666
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0212934017181396
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0349094867706299
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.0217816829681396
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.9350342750549316
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.054572582244873
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.954240083694458
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0266659259796143
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.042912483215332
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9879477024078369
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1276912689208984
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0670907497406006
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.0149626731872559
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9963555335998535
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.8953256607055664
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 0.9229109287261963
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 0.9086461067199707
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9225130081176758
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9545879364013672
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8489274978637695
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8839812278747559
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0101468563079834
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8883140087127686
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9179508686065674
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8896729946136475
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8761754035949707
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 467188
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.935387134552002
Epoch: 1, Steps: 7 | Train Loss: 2.405 Vali Loss: 1.971 Vali Acc: 0.514 Test Loss: 1.971 Test Acc: 0.514
Validation loss decreased (inf --> -0.513869).  Saving model ...
Epoch: 2 cost time: 0.8226816654205322
Epoch: 2, Steps: 7 | Train Loss: 1.547 Vali Loss: 0.994 Vali Acc: 0.833 Test Loss: 0.994 Test Acc: 0.833
Validation loss decreased (-0.513869 --> -0.833323).  Saving model ...
Epoch: 3 cost time: 0.8158359527587891
Epoch: 3, Steps: 7 | Train Loss: 0.648 Vali Loss: 0.529 Vali Acc: 0.861 Test Loss: 0.529 Test Acc: 0.861
Validation loss decreased (-0.833323 --> -0.861106).  Saving model ...
Epoch: 4 cost time: 1.0101141929626465
Epoch: 4, Steps: 7 | Train Loss: 0.228 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 5 cost time: 0.880469560623169
Epoch: 5, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 6 cost time: 0.819068193435669
Epoch: 6, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 0.8410313129425049
Epoch: 7, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9054069519042969
Epoch: 8, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.8382494449615479
Epoch: 9, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.8319199085235596
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.8093373775482178
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.9723300933837891
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8691346645355225
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0076332092285156
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.930849552154541
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8920297622680664
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9066300392150879
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8212945461273193
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9080829620361328
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8874123096466064
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9034171104431152
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ETSformer_UEA_ftM_sl1197_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 467188
model size : 2.40MB
